// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_unified_memory(struct futhark_context_config *cfg, int flag);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s);
const char *futhark_context_config_get_program(struct futhark_context_config *cfg);
void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_bool_1d;
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0);
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data);
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_00764e1f7379f14f22282d21712a8514;
struct futhark_opaque_5797e930517e531e6d939a24b1db07bd;
struct futhark_opaque_tup2_f64_f64;
struct futhark_opaque_tup2_i64_i64;
struct futhark_opaque_arr1d_tup2_f64_f64;
struct futhark_opaque_arr1d_tup2_i64_i64;
struct futhark_opaque_collisionTable;
struct futhark_opaque_dbcHandler_double;
struct futhark_opaque_flushedData_double;
struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb;
struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763;
struct futhark_opaque_2f462154888958ab775ddc32a175f568;
int futhark_free_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj);
int futhark_store_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj, void **p, size_t *n);
struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *futhark_restore_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const void *p);
int futhark_new_opaque_00764e1f7379f14f22282d21712a8514_degrees(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out);
int futhark_destruct_opaque_00764e1f7379f14f22282d21712a8514_degrees(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj);
int futhark_new_opaque_00764e1f7379f14f22282d21712a8514_radians(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out);
int futhark_destruct_opaque_00764e1f7379f14f22282d21712a8514_radians(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj);
int futhark_variant_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *v);
int futhark_free_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj);
int futhark_store_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj, void **p, size_t *n);
struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *futhark_restore_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const void *p);
int futhark_new_opaque_5797e930517e531e6d939a24b1db07bd_euclidean(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out);
int futhark_destruct_opaque_5797e930517e531e6d939a24b1db07bd_euclidean(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj);
int futhark_new_opaque_5797e930517e531e6d939a24b1db07bd_haversine(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out);
int futhark_destruct_opaque_5797e930517e531e6d939a24b1db07bd_haversine(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj);
int futhark_variant_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *v);
int futhark_free_opaque_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 *obj);
int futhark_store_opaque_tup2_f64_f64(struct futhark_context *ctx, const struct futhark_opaque_tup2_f64_f64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_f64_f64 *futhark_restore_opaque_tup2_f64_f64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_f64_f64_0(struct futhark_context *ctx, double *out, const struct futhark_opaque_tup2_f64_f64 *obj);
int futhark_project_opaque_tup2_f64_f64_1(struct futhark_context *ctx, double *out, const struct futhark_opaque_tup2_f64_f64 *obj);
int futhark_new_opaque_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 **out, const double f_0, const double f_1);
int futhark_free_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_store_opaque_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_i64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_i64_i64 *futhark_restore_opaque_tup2_i64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_i64_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_project_opaque_tup2_i64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_new_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, const int64_t f_0, const int64_t f_1);
int futhark_free_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 *obj);
int futhark_store_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_f64_f64 *futhark_restore_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_f64_f64_0(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj);
int futhark_project_opaque_arr1d_tup2_f64_f64_1(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj);
int futhark_zip_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_f64_1d *f_0, const struct futhark_f64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 **out, struct futhark_opaque_arr1d_tup2_f64_f64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 *arr);
int futhark_free_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_store_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_i64_i64 *futhark_restore_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_i64_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_project_opaque_arr1d_tup2_i64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_zip_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, struct futhark_opaque_arr1d_tup2_i64_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *arr);
int futhark_free_opaque_collisionTable(struct futhark_context *ctx, struct futhark_opaque_collisionTable *obj);
int futhark_store_opaque_collisionTable(struct futhark_context *ctx, const struct futhark_opaque_collisionTable *obj, void **p, size_t *n);
struct futhark_opaque_collisionTable *futhark_restore_opaque_collisionTable(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_collisionTable_chain_id(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_collisionTable *obj);
int futhark_project_opaque_collisionTable_ncc(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_collisionTable *obj);
int futhark_project_opaque_collisionTable_replaceWith(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_collisionTable *obj);
int futhark_new_opaque_collisionTable(struct futhark_context *ctx, struct futhark_opaque_collisionTable **out, const struct futhark_i64_1d *f_chain_id, const int64_t f_ncc, const struct futhark_i64_1d *f_replaceWith);
int futhark_free_opaque_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double *obj);
int futhark_store_opaque_dbcHandler_double(struct futhark_context *ctx, const struct futhark_opaque_dbcHandler_double *obj, void **p, size_t *n);
struct futhark_opaque_dbcHandler_double *futhark_restore_opaque_dbcHandler_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_dbcHandler_double_chain_collisions(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_project_opaque_dbcHandler_double_clBase(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_project_opaque_dbcHandler_double_clProc(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_project_opaque_dbcHandler_double_current_partition(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_project_opaque_dbcHandler_double_toFlush_dat(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_project_opaque_dbcHandler_double_toFlush_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_dbcHandler_double *obj);
int futhark_new_opaque_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *f_chain_collisions, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *f_clBase, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *f_clProc, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *f_current_partition, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_toFlush_dat, const struct futhark_i64_1d *f_toFlush_ids);
int futhark_free_opaque_flushedData_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double *obj);
int futhark_store_opaque_flushedData_double(struct futhark_context *ctx, const struct futhark_opaque_flushedData_double *obj, void **p, size_t *n);
struct futhark_opaque_flushedData_double *futhark_restore_opaque_flushedData_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_flushedData_double_chain_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_flushedData_double *obj);
int futhark_project_opaque_flushedData_double_n(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_flushedData_double *obj);
int futhark_project_opaque_flushedData_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_flushedData_double *obj);
int futhark_project_opaque_flushedData_double_ys(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_flushedData_double *obj);
int futhark_new_opaque_flushedData_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double **out, const struct futhark_i64_1d *f_chain_ids, const int64_t f_n, const struct futhark_f64_1d *f_xs, const struct futhark_f64_1d *f_ys);
int futhark_free_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_store_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj, void **p, size_t *n);
struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *futhark_restore_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_angle_t(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_dist_t(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_eps(struct futhark_context *ctx, double *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_m_size(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_maxs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_minPts(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_mins(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_part_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_radius(struct futhark_context *ctx, double *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_step_per_dim(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_total_partitions(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj);
int futhark_new_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb **out, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *f_angle_t, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *f_dist_t, const double f_eps, const int64_t f_m_sizze, const struct futhark_f64_1d *f_maxs, const int64_t f_minPts, const struct futhark_f64_1d *f_mins, const struct futhark_i64_1d *f_part_per_dim, const double f_radius, const struct futhark_f64_1d *f_step_per_dim, const int64_t f_total_partitions);
int futhark_free_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_store_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj, void **p, size_t *n);
struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *futhark_restore_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buff_isCore(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buffered_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buffered_pts(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_chainOffs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_cur_part_id(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_cur_part_order(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_isPartVisited(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_next_offs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_offs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_relevantParts(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj);
int futhark_new_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 **out, const struct futhark_bool_1d *f_buff_isCore, const struct futhark_i64_1d *f_buffered_ids, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_buffered_pts, const int64_t f_chainOffs, const int64_t f_cur_part_id, const int64_t f_cur_part_order, const struct futhark_bool_1d *f_isPartVisited, const int64_t f_next_offs, const int64_t f_offs, const struct futhark_i64_1d *f_relevantParts);
int futhark_free_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_store_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj, void **p, size_t *n);
struct futhark_opaque_2f462154888958ab775ddc32a175f568 *futhark_restore_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_chain_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_dat(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isCore(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isMargin(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isNeighbourVisited(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isTightMargin(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_max_coord(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_min_coord(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_neighbours(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_part_id(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj);
int futhark_new_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 **out, const struct futhark_i64_1d *f_chain_ids, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_dat, const struct futhark_bool_1d *f_isCore, const struct futhark_bool_1d *f_isMargin, const struct futhark_bool_1d *f_isNeighbourVisited, const struct futhark_bool_1d *f_isTightMargin, const struct futhark_f64_1d *f_max_coord, const struct futhark_f64_1d *f_min_coord, const struct futhark_i64_1d *f_neighbours, const int64_t f_part_id);

// Entry points
int futhark_entry_add_next_partition_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_do_DBSCAN_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const int64_t in1, const bool in2);
int futhark_entry_flush_dat_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const bool in1);
int futhark_entry_make_collisions_compact_double(struct futhark_context *ctx, struct futhark_opaque_collisionTable **out0, const struct futhark_opaque_dbcHandler_double *in0);
int futhark_entry_mk_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const double in0, const double in1, const double in2, const double in3, const int64_t in4, const int64_t in5, const bool in6, const bool in7, const double in8, const double in9, const int64_t in10, const int64_t in11);
int futhark_entry_next_partition_to_read_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_opaque_dbcHandler_double *in0);
int futhark_entry_rectify_cluster_ids_double(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_opaque_collisionTable *in1, const int64_t in2);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>


#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
};
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    struct memblock_device counters_mem_83127;
    struct memblock_device counters_mem_83131;
    struct memblock_device counters_mem_83201;
    struct memblock_device counters_mem_83624;
    struct memblock_device counters_mem_84155;
    struct memblock_device counters_mem_84329;
    struct memblock_device counters_mem_84504;
    struct memblock_device counters_mem_84929;
    struct memblock_device counters_mem_85210;
    struct memblock_device counters_mem_85249;
    struct memblock_device counters_mem_86537;
    struct memblock_device counters_mem_86668;
    struct memblock_device counters_mem_86747;
    struct memblock_device counters_mem_86782;
    struct memblock_device global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335;
};
struct tuning_params {
    int dummy;
    int64_t *add_next_partition_doublezisegmap_num_tblocks_69323;
    int64_t *add_next_partition_doublezisegmap_num_tblocks_69339;
    int64_t *add_next_partition_doublezisegmap_num_tblocks_70742;
    int64_t *add_next_partition_doublezisegmap_num_tblocks_70758;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_67951;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_68212;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_69321;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_69337;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_70270;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_70740;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_70756;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_70764;
    int64_t *add_next_partition_doublezisegmap_tblock_sizze_70841;
    int64_t *add_next_partition_doublezisegred_num_tblocks_68195;
    int64_t *add_next_partition_doublezisegred_num_tblocks_69807;
    int64_t *add_next_partition_doublezisegred_tblock_sizze_68193;
    int64_t *add_next_partition_doublezisegred_tblock_sizze_69805;
    int64_t *add_next_partition_doublezisegscan_num_tblocks_66893;
    int64_t *add_next_partition_doublezisegscan_num_tblocks_68502;
    int64_t *add_next_partition_doublezisegscan_num_tblocks_69329;
    int64_t *add_next_partition_doublezisegscan_num_tblocks_70732;
    int64_t *add_next_partition_doublezisegscan_num_tblocks_70748;
    int64_t *add_next_partition_doublezisegscan_tblock_sizze_66891;
    int64_t *add_next_partition_doublezisegscan_tblock_sizze_68500;
    int64_t *add_next_partition_doublezisegscan_tblock_sizze_69327;
    int64_t *add_next_partition_doublezisegscan_tblock_sizze_70730;
    int64_t *add_next_partition_doublezisegscan_tblock_sizze_70746;
    int64_t *add_next_partition_doublezisuff_intra_par_2;
    int64_t *add_next_partition_doublezisuff_outer_par_1;
    int64_t *add_next_partition_doublezisuff_outer_par_3;
    int64_t *add_next_partition_doublezisuff_outer_screma_0;
    int64_t *add_next_partition_doublezitile_sizze_78071;
    int64_t *add_next_partition_doublezitile_sizze_78475;
    int64_t *builtinzhiota_i64zitblock_sizze_83308;
    int64_t *builtinzhreplicate_boolzitblock_sizze_84478;
    int64_t *builtinzhreplicate_f64zitblock_sizze_83384;
    int64_t *builtinzhreplicate_i32zitblock_sizze_83201;
    int64_t *builtinzhreplicate_i64zitblock_sizze_83341;
    int64_t *builtinzhreplicate_i8zitblock_sizze_83175;
    int64_t *do_DBSCAN_doublezihist_L2_84268;
    int64_t *do_DBSCAN_doublezihist_L_84215;
    int64_t *do_DBSCAN_doubleziseghist_num_tblocks_75445;
    int64_t *do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75088;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75104;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75120;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75136;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75152;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75160;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75200;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75439;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75471;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75505;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75540;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_75914;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_76327;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_76641;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_77093;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_77109;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_77721;
    int64_t *do_DBSCAN_doublezisegmap_num_tblocks_77729;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75086;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75102;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75118;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75134;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75150;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75158;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75166;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75198;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75219;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75330;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75437;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75469;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75503;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75538;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75729;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75838;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75864;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_75912;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_76325;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_76639;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77091;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77107;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77319;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77621;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77719;
    int64_t *do_DBSCAN_doublezisegmap_tblock_sizze_77727;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_75477;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_75511;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_75671;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_75820;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_77255;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_77557;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_77735;
    int64_t *do_DBSCAN_doublezisegred_num_tblocks_77745;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_75475;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_75509;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_75669;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_75818;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_77253;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_77555;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_77733;
    int64_t *do_DBSCAN_doublezisegred_tblock_sizze_77743;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75078;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75094;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75110;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75126;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75142;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75190;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75429;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75461;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75487;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75495;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75522;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75530;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75830;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75904;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_75951;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_76211;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_76335;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_76542;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_76649;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_76959;
    int64_t *do_DBSCAN_doublezisegscan_num_tblocks_77099;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75076;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75092;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75108;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75124;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75140;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75188;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75427;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75459;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75485;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75493;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75520;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75528;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75828;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75902;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_75949;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_76209;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_76333;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_76540;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_76647;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_76957;
    int64_t *do_DBSCAN_doublezisegscan_tblock_sizze_77097;
    int64_t *do_DBSCAN_doublezisuff_outer_par_0;
    int64_t *do_DBSCAN_doublezisuff_outer_par_2;
    int64_t *do_DBSCAN_doublezisuff_outer_par_4;
    int64_t *do_DBSCAN_doublezisuff_outer_par_6;
    int64_t *do_DBSCAN_doublezisuff_outer_par_7;
    int64_t *do_DBSCAN_doublezisuff_outer_par_8;
    int64_t *do_DBSCAN_doublezisuff_outer_screma_1;
    int64_t *do_DBSCAN_doublezisuff_outer_screma_3;
    int64_t *do_DBSCAN_doublezisuff_outer_screma_5;
    int64_t *do_DBSCAN_doublezitblock_sizze_84156;
    int64_t *do_DBSCAN_doublezitblock_sizze_84176;
    int64_t *do_DBSCAN_doublezitile_sizze_78071;
    int64_t *do_DBSCAN_doublezitile_sizze_78491;
    int64_t *do_DBSCAN_doublezitile_sizze_78846;
    int64_t *do_DBSCAN_doublezitile_sizze_79201;
    int64_t *do_DBSCAN_doublezitile_sizze_79484;
    int64_t *do_DBSCAN_doublezitile_sizze_79767;
    int64_t *do_DBSCAN_doublezitile_sizze_80149;
    int64_t *do_DBSCAN_doublezitile_sizze_80531;
    int64_t *do_DBSCAN_doublezitile_sizze_80972;
    int64_t *get_num_neighbours_against_11932zisegmap_tblock_sizze_74579;
    int64_t *get_num_neighbours_against_11932zisegred_num_tblocks_74523;
    int64_t *get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    int64_t *get_num_neighbours_against_11932zisuff_outer_par_0;
    int64_t *get_num_neighbours_against_11932zitile_sizze_78071;
    int64_t *get_num_neighbours_against_11935zisegmap_tblock_sizze_74845;
    int64_t *get_num_neighbours_against_11935zisegred_num_tblocks_74789;
    int64_t *get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    int64_t *get_num_neighbours_against_11935zisuff_outer_par_0;
    int64_t *get_num_neighbours_against_11935zitile_sizze_78071;
    int64_t *make_collisions_compact_doublezisegmap_num_tblocks_70981;
    int64_t *make_collisions_compact_doublezisegmap_num_tblocks_72134;
    int64_t *make_collisions_compact_doublezisegmap_num_tblocks_72858;
    int64_t *make_collisions_compact_doublezisegmap_num_tblocks_74396;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_70979;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_71122;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_72132;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_72201;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_72856;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_72938;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_73167;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_73685;
    int64_t *make_collisions_compact_doublezisegmap_tblock_sizze_74394;
    int64_t *make_collisions_compact_doublezisegred_num_tblocks_70903;
    int64_t *make_collisions_compact_doublezisegred_tblock_sizze_70901;
    int64_t *make_collisions_compact_doublezisegscan_num_tblocks_74386;
    int64_t *make_collisions_compact_doublezisegscan_tblock_sizze_74384;
    int64_t *make_collisions_compact_doublezisuff_intra_par_0;
    int64_t *make_collisions_compact_doublezisuff_intra_par_1;
    int64_t *make_collisions_compact_doublezitblock_sizze_83384;
    int64_t *make_collisions_compact_doublezitblock_sizze_83404;
    int64_t *make_collisions_compact_doublezitblock_sizze_83527;
    int64_t *make_collisions_compact_doublezitblock_sizze_83550;
    int64_t *next_partition_to_read_doublezisegmap_num_tblocks_66885;
    int64_t *next_partition_to_read_doublezisegmap_tblock_sizze_66883;
    int64_t *next_partition_to_read_doublezisegred_num_tblocks_66865;
    int64_t *next_partition_to_read_doublezisegred_tblock_sizze_66863;
    int64_t *next_partition_to_read_doublezisegscan_num_tblocks_66875;
    int64_t *next_partition_to_read_doublezisegscan_tblock_sizze_66873;
    int64_t *rectify_cluster_ids_doublezisegmap_tblock_sizze_74934;
    int64_t *rectify_cluster_ids_doublezisegmap_tblock_sizze_75038;
};
static const int num_tuning_params = 206;
static const char *tuning_param_names[] = {"add_next_partition_double.segmap_num_tblocks_69323", "add_next_partition_double.segmap_num_tblocks_69339", "add_next_partition_double.segmap_num_tblocks_70742", "add_next_partition_double.segmap_num_tblocks_70758", "add_next_partition_double.segmap_tblock_size_67951", "add_next_partition_double.segmap_tblock_size_68212", "add_next_partition_double.segmap_tblock_size_69321", "add_next_partition_double.segmap_tblock_size_69337", "add_next_partition_double.segmap_tblock_size_70270", "add_next_partition_double.segmap_tblock_size_70740", "add_next_partition_double.segmap_tblock_size_70756", "add_next_partition_double.segmap_tblock_size_70764", "add_next_partition_double.segmap_tblock_size_70841", "add_next_partition_double.segred_num_tblocks_68195", "add_next_partition_double.segred_num_tblocks_69807", "add_next_partition_double.segred_tblock_size_68193", "add_next_partition_double.segred_tblock_size_69805", "add_next_partition_double.segscan_num_tblocks_66893", "add_next_partition_double.segscan_num_tblocks_68502", "add_next_partition_double.segscan_num_tblocks_69329", "add_next_partition_double.segscan_num_tblocks_70732", "add_next_partition_double.segscan_num_tblocks_70748", "add_next_partition_double.segscan_tblock_size_66891", "add_next_partition_double.segscan_tblock_size_68500", "add_next_partition_double.segscan_tblock_size_69327", "add_next_partition_double.segscan_tblock_size_70730", "add_next_partition_double.segscan_tblock_size_70746", "add_next_partition_double.suff_intra_par_2", "add_next_partition_double.suff_outer_par_1", "add_next_partition_double.suff_outer_par_3", "add_next_partition_double.suff_outer_screma_0", "add_next_partition_double.tile_size_78071", "add_next_partition_double.tile_size_78475", "builtin#iota_i64.tblock_size_83308", "builtin#replicate_bool.tblock_size_84478", "builtin#replicate_f64.tblock_size_83384", "builtin#replicate_i32.tblock_size_83201", "builtin#replicate_i64.tblock_size_83341", "builtin#replicate_i8.tblock_size_83175", "do_DBSCAN_double.hist_L2_84268", "do_DBSCAN_double.hist_L_84215", "do_DBSCAN_double.seghist_num_tblocks_75445", "do_DBSCAN_double.seghist_tblock_size_75443", "do_DBSCAN_double.segmap_num_tblocks_75088", "do_DBSCAN_double.segmap_num_tblocks_75104", "do_DBSCAN_double.segmap_num_tblocks_75120", "do_DBSCAN_double.segmap_num_tblocks_75136", "do_DBSCAN_double.segmap_num_tblocks_75152", "do_DBSCAN_double.segmap_num_tblocks_75160", "do_DBSCAN_double.segmap_num_tblocks_75200", "do_DBSCAN_double.segmap_num_tblocks_75439", "do_DBSCAN_double.segmap_num_tblocks_75471", "do_DBSCAN_double.segmap_num_tblocks_75505", "do_DBSCAN_double.segmap_num_tblocks_75540", "do_DBSCAN_double.segmap_num_tblocks_75914", "do_DBSCAN_double.segmap_num_tblocks_76327", "do_DBSCAN_double.segmap_num_tblocks_76641", "do_DBSCAN_double.segmap_num_tblocks_77093", "do_DBSCAN_double.segmap_num_tblocks_77109", "do_DBSCAN_double.segmap_num_tblocks_77721", "do_DBSCAN_double.segmap_num_tblocks_77729", "do_DBSCAN_double.segmap_tblock_size_75086", "do_DBSCAN_double.segmap_tblock_size_75102", "do_DBSCAN_double.segmap_tblock_size_75118", "do_DBSCAN_double.segmap_tblock_size_75134", "do_DBSCAN_double.segmap_tblock_size_75150", "do_DBSCAN_double.segmap_tblock_size_75158", "do_DBSCAN_double.segmap_tblock_size_75166", "do_DBSCAN_double.segmap_tblock_size_75198", "do_DBSCAN_double.segmap_tblock_size_75219", "do_DBSCAN_double.segmap_tblock_size_75330", "do_DBSCAN_double.segmap_tblock_size_75437", "do_DBSCAN_double.segmap_tblock_size_75469", "do_DBSCAN_double.segmap_tblock_size_75503", "do_DBSCAN_double.segmap_tblock_size_75538", "do_DBSCAN_double.segmap_tblock_size_75729", "do_DBSCAN_double.segmap_tblock_size_75838", "do_DBSCAN_double.segmap_tblock_size_75864", "do_DBSCAN_double.segmap_tblock_size_75912", "do_DBSCAN_double.segmap_tblock_size_76325", "do_DBSCAN_double.segmap_tblock_size_76639", "do_DBSCAN_double.segmap_tblock_size_77091", "do_DBSCAN_double.segmap_tblock_size_77107", "do_DBSCAN_double.segmap_tblock_size_77319", "do_DBSCAN_double.segmap_tblock_size_77621", "do_DBSCAN_double.segmap_tblock_size_77719", "do_DBSCAN_double.segmap_tblock_size_77727", "do_DBSCAN_double.segred_num_tblocks_75477", "do_DBSCAN_double.segred_num_tblocks_75511", "do_DBSCAN_double.segred_num_tblocks_75671", "do_DBSCAN_double.segred_num_tblocks_75820", "do_DBSCAN_double.segred_num_tblocks_77255", "do_DBSCAN_double.segred_num_tblocks_77557", "do_DBSCAN_double.segred_num_tblocks_77735", "do_DBSCAN_double.segred_num_tblocks_77745", "do_DBSCAN_double.segred_tblock_size_75475", "do_DBSCAN_double.segred_tblock_size_75509", "do_DBSCAN_double.segred_tblock_size_75669", "do_DBSCAN_double.segred_tblock_size_75818", "do_DBSCAN_double.segred_tblock_size_77253", "do_DBSCAN_double.segred_tblock_size_77555", "do_DBSCAN_double.segred_tblock_size_77733", "do_DBSCAN_double.segred_tblock_size_77743", "do_DBSCAN_double.segscan_num_tblocks_75078", "do_DBSCAN_double.segscan_num_tblocks_75094", "do_DBSCAN_double.segscan_num_tblocks_75110", "do_DBSCAN_double.segscan_num_tblocks_75126", "do_DBSCAN_double.segscan_num_tblocks_75142", "do_DBSCAN_double.segscan_num_tblocks_75190", "do_DBSCAN_double.segscan_num_tblocks_75429", "do_DBSCAN_double.segscan_num_tblocks_75461", "do_DBSCAN_double.segscan_num_tblocks_75487", "do_DBSCAN_double.segscan_num_tblocks_75495", "do_DBSCAN_double.segscan_num_tblocks_75522", "do_DBSCAN_double.segscan_num_tblocks_75530", "do_DBSCAN_double.segscan_num_tblocks_75830", "do_DBSCAN_double.segscan_num_tblocks_75904", "do_DBSCAN_double.segscan_num_tblocks_75951", "do_DBSCAN_double.segscan_num_tblocks_76211", "do_DBSCAN_double.segscan_num_tblocks_76335", "do_DBSCAN_double.segscan_num_tblocks_76542", "do_DBSCAN_double.segscan_num_tblocks_76649", "do_DBSCAN_double.segscan_num_tblocks_76959", "do_DBSCAN_double.segscan_num_tblocks_77099", "do_DBSCAN_double.segscan_tblock_size_75076", "do_DBSCAN_double.segscan_tblock_size_75092", "do_DBSCAN_double.segscan_tblock_size_75108", "do_DBSCAN_double.segscan_tblock_size_75124", "do_DBSCAN_double.segscan_tblock_size_75140", "do_DBSCAN_double.segscan_tblock_size_75188", "do_DBSCAN_double.segscan_tblock_size_75427", "do_DBSCAN_double.segscan_tblock_size_75459", "do_DBSCAN_double.segscan_tblock_size_75485", "do_DBSCAN_double.segscan_tblock_size_75493", "do_DBSCAN_double.segscan_tblock_size_75520", "do_DBSCAN_double.segscan_tblock_size_75528", "do_DBSCAN_double.segscan_tblock_size_75828", "do_DBSCAN_double.segscan_tblock_size_75902", "do_DBSCAN_double.segscan_tblock_size_75949", "do_DBSCAN_double.segscan_tblock_size_76209", "do_DBSCAN_double.segscan_tblock_size_76333", "do_DBSCAN_double.segscan_tblock_size_76540", "do_DBSCAN_double.segscan_tblock_size_76647", "do_DBSCAN_double.segscan_tblock_size_76957", "do_DBSCAN_double.segscan_tblock_size_77097", "do_DBSCAN_double.suff_outer_par_0", "do_DBSCAN_double.suff_outer_par_2", "do_DBSCAN_double.suff_outer_par_4", "do_DBSCAN_double.suff_outer_par_6", "do_DBSCAN_double.suff_outer_par_7", "do_DBSCAN_double.suff_outer_par_8", "do_DBSCAN_double.suff_outer_screma_1", "do_DBSCAN_double.suff_outer_screma_3", "do_DBSCAN_double.suff_outer_screma_5", "do_DBSCAN_double.tblock_size_84156", "do_DBSCAN_double.tblock_size_84176", "do_DBSCAN_double.tile_size_78071", "do_DBSCAN_double.tile_size_78491", "do_DBSCAN_double.tile_size_78846", "do_DBSCAN_double.tile_size_79201", "do_DBSCAN_double.tile_size_79484", "do_DBSCAN_double.tile_size_79767", "do_DBSCAN_double.tile_size_80149", "do_DBSCAN_double.tile_size_80531", "do_DBSCAN_double.tile_size_80972", "get_num_neighbours_against_11932.segmap_tblock_size_74579", "get_num_neighbours_against_11932.segred_num_tblocks_74523", "get_num_neighbours_against_11932.segred_tblock_size_74521", "get_num_neighbours_against_11932.suff_outer_par_0", "get_num_neighbours_against_11932.tile_size_78071", "get_num_neighbours_against_11935.segmap_tblock_size_74845", "get_num_neighbours_against_11935.segred_num_tblocks_74789",
                                           "get_num_neighbours_against_11935.segred_tblock_size_74787", "get_num_neighbours_against_11935.suff_outer_par_0", "get_num_neighbours_against_11935.tile_size_78071", "make_collisions_compact_double.segmap_num_tblocks_70981", "make_collisions_compact_double.segmap_num_tblocks_72134", "make_collisions_compact_double.segmap_num_tblocks_72858", "make_collisions_compact_double.segmap_num_tblocks_74396", "make_collisions_compact_double.segmap_tblock_size_70979", "make_collisions_compact_double.segmap_tblock_size_71122", "make_collisions_compact_double.segmap_tblock_size_72132", "make_collisions_compact_double.segmap_tblock_size_72201", "make_collisions_compact_double.segmap_tblock_size_72856", "make_collisions_compact_double.segmap_tblock_size_72938", "make_collisions_compact_double.segmap_tblock_size_73167", "make_collisions_compact_double.segmap_tblock_size_73685", "make_collisions_compact_double.segmap_tblock_size_74394", "make_collisions_compact_double.segred_num_tblocks_70903", "make_collisions_compact_double.segred_tblock_size_70901", "make_collisions_compact_double.segscan_num_tblocks_74386", "make_collisions_compact_double.segscan_tblock_size_74384", "make_collisions_compact_double.suff_intra_par_0", "make_collisions_compact_double.suff_intra_par_1", "make_collisions_compact_double.tblock_size_83384", "make_collisions_compact_double.tblock_size_83404", "make_collisions_compact_double.tblock_size_83527", "make_collisions_compact_double.tblock_size_83550", "next_partition_to_read_double.segmap_num_tblocks_66885", "next_partition_to_read_double.segmap_tblock_size_66883", "next_partition_to_read_double.segred_num_tblocks_66865", "next_partition_to_read_double.segred_tblock_size_66863", "next_partition_to_read_double.segscan_num_tblocks_66875", "next_partition_to_read_double.segscan_tblock_size_66873", "rectify_cluster_ids_double.segmap_tblock_size_74934", "rectify_cluster_ids_double.segmap_tblock_size_75038", NULL};
static const char *tuning_param_vars[] = {"add_next_partition_doublezisegmap_num_tblocks_69323", "add_next_partition_doublezisegmap_num_tblocks_69339", "add_next_partition_doublezisegmap_num_tblocks_70742", "add_next_partition_doublezisegmap_num_tblocks_70758", "add_next_partition_doublezisegmap_tblock_sizze_67951", "add_next_partition_doublezisegmap_tblock_sizze_68212", "add_next_partition_doublezisegmap_tblock_sizze_69321", "add_next_partition_doublezisegmap_tblock_sizze_69337", "add_next_partition_doublezisegmap_tblock_sizze_70270", "add_next_partition_doublezisegmap_tblock_sizze_70740", "add_next_partition_doublezisegmap_tblock_sizze_70756", "add_next_partition_doublezisegmap_tblock_sizze_70764", "add_next_partition_doublezisegmap_tblock_sizze_70841", "add_next_partition_doublezisegred_num_tblocks_68195", "add_next_partition_doublezisegred_num_tblocks_69807", "add_next_partition_doublezisegred_tblock_sizze_68193", "add_next_partition_doublezisegred_tblock_sizze_69805", "add_next_partition_doublezisegscan_num_tblocks_66893", "add_next_partition_doublezisegscan_num_tblocks_68502", "add_next_partition_doublezisegscan_num_tblocks_69329", "add_next_partition_doublezisegscan_num_tblocks_70732", "add_next_partition_doublezisegscan_num_tblocks_70748", "add_next_partition_doublezisegscan_tblock_sizze_66891", "add_next_partition_doublezisegscan_tblock_sizze_68500", "add_next_partition_doublezisegscan_tblock_sizze_69327", "add_next_partition_doublezisegscan_tblock_sizze_70730", "add_next_partition_doublezisegscan_tblock_sizze_70746", "add_next_partition_doublezisuff_intra_par_2", "add_next_partition_doublezisuff_outer_par_1", "add_next_partition_doublezisuff_outer_par_3", "add_next_partition_doublezisuff_outer_screma_0", "add_next_partition_doublezitile_sizze_78071", "add_next_partition_doublezitile_sizze_78475", "builtinzhiota_i64zitblock_sizze_83308", "builtinzhreplicate_boolzitblock_sizze_84478", "builtinzhreplicate_f64zitblock_sizze_83384", "builtinzhreplicate_i32zitblock_sizze_83201", "builtinzhreplicate_i64zitblock_sizze_83341", "builtinzhreplicate_i8zitblock_sizze_83175", "do_DBSCAN_doublezihist_L2_84268", "do_DBSCAN_doublezihist_L_84215", "do_DBSCAN_doubleziseghist_num_tblocks_75445", "do_DBSCAN_doubleziseghist_tblock_sizze_75443", "do_DBSCAN_doublezisegmap_num_tblocks_75088", "do_DBSCAN_doublezisegmap_num_tblocks_75104", "do_DBSCAN_doublezisegmap_num_tblocks_75120", "do_DBSCAN_doublezisegmap_num_tblocks_75136", "do_DBSCAN_doublezisegmap_num_tblocks_75152", "do_DBSCAN_doublezisegmap_num_tblocks_75160", "do_DBSCAN_doublezisegmap_num_tblocks_75200", "do_DBSCAN_doublezisegmap_num_tblocks_75439", "do_DBSCAN_doublezisegmap_num_tblocks_75471", "do_DBSCAN_doublezisegmap_num_tblocks_75505", "do_DBSCAN_doublezisegmap_num_tblocks_75540", "do_DBSCAN_doublezisegmap_num_tblocks_75914", "do_DBSCAN_doublezisegmap_num_tblocks_76327", "do_DBSCAN_doublezisegmap_num_tblocks_76641", "do_DBSCAN_doublezisegmap_num_tblocks_77093", "do_DBSCAN_doublezisegmap_num_tblocks_77109", "do_DBSCAN_doublezisegmap_num_tblocks_77721", "do_DBSCAN_doublezisegmap_num_tblocks_77729", "do_DBSCAN_doublezisegmap_tblock_sizze_75086", "do_DBSCAN_doublezisegmap_tblock_sizze_75102", "do_DBSCAN_doublezisegmap_tblock_sizze_75118", "do_DBSCAN_doublezisegmap_tblock_sizze_75134", "do_DBSCAN_doublezisegmap_tblock_sizze_75150", "do_DBSCAN_doublezisegmap_tblock_sizze_75158", "do_DBSCAN_doublezisegmap_tblock_sizze_75166", "do_DBSCAN_doublezisegmap_tblock_sizze_75198", "do_DBSCAN_doublezisegmap_tblock_sizze_75219", "do_DBSCAN_doublezisegmap_tblock_sizze_75330", "do_DBSCAN_doublezisegmap_tblock_sizze_75437", "do_DBSCAN_doublezisegmap_tblock_sizze_75469", "do_DBSCAN_doublezisegmap_tblock_sizze_75503", "do_DBSCAN_doublezisegmap_tblock_sizze_75538", "do_DBSCAN_doublezisegmap_tblock_sizze_75729", "do_DBSCAN_doublezisegmap_tblock_sizze_75838", "do_DBSCAN_doublezisegmap_tblock_sizze_75864", "do_DBSCAN_doublezisegmap_tblock_sizze_75912", "do_DBSCAN_doublezisegmap_tblock_sizze_76325", "do_DBSCAN_doublezisegmap_tblock_sizze_76639", "do_DBSCAN_doublezisegmap_tblock_sizze_77091", "do_DBSCAN_doublezisegmap_tblock_sizze_77107", "do_DBSCAN_doublezisegmap_tblock_sizze_77319", "do_DBSCAN_doublezisegmap_tblock_sizze_77621", "do_DBSCAN_doublezisegmap_tblock_sizze_77719", "do_DBSCAN_doublezisegmap_tblock_sizze_77727", "do_DBSCAN_doublezisegred_num_tblocks_75477", "do_DBSCAN_doublezisegred_num_tblocks_75511", "do_DBSCAN_doublezisegred_num_tblocks_75671", "do_DBSCAN_doublezisegred_num_tblocks_75820", "do_DBSCAN_doublezisegred_num_tblocks_77255", "do_DBSCAN_doublezisegred_num_tblocks_77557", "do_DBSCAN_doublezisegred_num_tblocks_77735", "do_DBSCAN_doublezisegred_num_tblocks_77745", "do_DBSCAN_doublezisegred_tblock_sizze_75475", "do_DBSCAN_doublezisegred_tblock_sizze_75509", "do_DBSCAN_doublezisegred_tblock_sizze_75669", "do_DBSCAN_doublezisegred_tblock_sizze_75818", "do_DBSCAN_doublezisegred_tblock_sizze_77253", "do_DBSCAN_doublezisegred_tblock_sizze_77555", "do_DBSCAN_doublezisegred_tblock_sizze_77733", "do_DBSCAN_doublezisegred_tblock_sizze_77743", "do_DBSCAN_doublezisegscan_num_tblocks_75078", "do_DBSCAN_doublezisegscan_num_tblocks_75094", "do_DBSCAN_doublezisegscan_num_tblocks_75110", "do_DBSCAN_doublezisegscan_num_tblocks_75126", "do_DBSCAN_doublezisegscan_num_tblocks_75142", "do_DBSCAN_doublezisegscan_num_tblocks_75190", "do_DBSCAN_doublezisegscan_num_tblocks_75429", "do_DBSCAN_doublezisegscan_num_tblocks_75461", "do_DBSCAN_doublezisegscan_num_tblocks_75487", "do_DBSCAN_doublezisegscan_num_tblocks_75495", "do_DBSCAN_doublezisegscan_num_tblocks_75522", "do_DBSCAN_doublezisegscan_num_tblocks_75530", "do_DBSCAN_doublezisegscan_num_tblocks_75830", "do_DBSCAN_doublezisegscan_num_tblocks_75904", "do_DBSCAN_doublezisegscan_num_tblocks_75951", "do_DBSCAN_doublezisegscan_num_tblocks_76211", "do_DBSCAN_doublezisegscan_num_tblocks_76335", "do_DBSCAN_doublezisegscan_num_tblocks_76542", "do_DBSCAN_doublezisegscan_num_tblocks_76649", "do_DBSCAN_doublezisegscan_num_tblocks_76959", "do_DBSCAN_doublezisegscan_num_tblocks_77099", "do_DBSCAN_doublezisegscan_tblock_sizze_75076", "do_DBSCAN_doublezisegscan_tblock_sizze_75092", "do_DBSCAN_doublezisegscan_tblock_sizze_75108", "do_DBSCAN_doublezisegscan_tblock_sizze_75124", "do_DBSCAN_doublezisegscan_tblock_sizze_75140", "do_DBSCAN_doublezisegscan_tblock_sizze_75188", "do_DBSCAN_doublezisegscan_tblock_sizze_75427", "do_DBSCAN_doublezisegscan_tblock_sizze_75459", "do_DBSCAN_doublezisegscan_tblock_sizze_75485", "do_DBSCAN_doublezisegscan_tblock_sizze_75493", "do_DBSCAN_doublezisegscan_tblock_sizze_75520", "do_DBSCAN_doublezisegscan_tblock_sizze_75528", "do_DBSCAN_doublezisegscan_tblock_sizze_75828", "do_DBSCAN_doublezisegscan_tblock_sizze_75902", "do_DBSCAN_doublezisegscan_tblock_sizze_75949", "do_DBSCAN_doublezisegscan_tblock_sizze_76209", "do_DBSCAN_doublezisegscan_tblock_sizze_76333", "do_DBSCAN_doublezisegscan_tblock_sizze_76540", "do_DBSCAN_doublezisegscan_tblock_sizze_76647", "do_DBSCAN_doublezisegscan_tblock_sizze_76957", "do_DBSCAN_doublezisegscan_tblock_sizze_77097", "do_DBSCAN_doublezisuff_outer_par_0", "do_DBSCAN_doublezisuff_outer_par_2", "do_DBSCAN_doublezisuff_outer_par_4", "do_DBSCAN_doublezisuff_outer_par_6", "do_DBSCAN_doublezisuff_outer_par_7", "do_DBSCAN_doublezisuff_outer_par_8", "do_DBSCAN_doublezisuff_outer_screma_1", "do_DBSCAN_doublezisuff_outer_screma_3", "do_DBSCAN_doublezisuff_outer_screma_5", "do_DBSCAN_doublezitblock_sizze_84156", "do_DBSCAN_doublezitblock_sizze_84176", "do_DBSCAN_doublezitile_sizze_78071", "do_DBSCAN_doublezitile_sizze_78491", "do_DBSCAN_doublezitile_sizze_78846", "do_DBSCAN_doublezitile_sizze_79201", "do_DBSCAN_doublezitile_sizze_79484", "do_DBSCAN_doublezitile_sizze_79767", "do_DBSCAN_doublezitile_sizze_80149", "do_DBSCAN_doublezitile_sizze_80531", "do_DBSCAN_doublezitile_sizze_80972", "get_num_neighbours_against_11932zisegmap_tblock_sizze_74579", "get_num_neighbours_against_11932zisegred_num_tblocks_74523",
                                          "get_num_neighbours_against_11932zisegred_tblock_sizze_74521", "get_num_neighbours_against_11932zisuff_outer_par_0", "get_num_neighbours_against_11932zitile_sizze_78071", "get_num_neighbours_against_11935zisegmap_tblock_sizze_74845", "get_num_neighbours_against_11935zisegred_num_tblocks_74789", "get_num_neighbours_against_11935zisegred_tblock_sizze_74787", "get_num_neighbours_against_11935zisuff_outer_par_0", "get_num_neighbours_against_11935zitile_sizze_78071", "make_collisions_compact_doublezisegmap_num_tblocks_70981", "make_collisions_compact_doublezisegmap_num_tblocks_72134", "make_collisions_compact_doublezisegmap_num_tblocks_72858", "make_collisions_compact_doublezisegmap_num_tblocks_74396", "make_collisions_compact_doublezisegmap_tblock_sizze_70979", "make_collisions_compact_doublezisegmap_tblock_sizze_71122", "make_collisions_compact_doublezisegmap_tblock_sizze_72132", "make_collisions_compact_doublezisegmap_tblock_sizze_72201", "make_collisions_compact_doublezisegmap_tblock_sizze_72856", "make_collisions_compact_doublezisegmap_tblock_sizze_72938", "make_collisions_compact_doublezisegmap_tblock_sizze_73167", "make_collisions_compact_doublezisegmap_tblock_sizze_73685", "make_collisions_compact_doublezisegmap_tblock_sizze_74394", "make_collisions_compact_doublezisegred_num_tblocks_70903", "make_collisions_compact_doublezisegred_tblock_sizze_70901", "make_collisions_compact_doublezisegscan_num_tblocks_74386", "make_collisions_compact_doublezisegscan_tblock_sizze_74384", "make_collisions_compact_doublezisuff_intra_par_0", "make_collisions_compact_doublezisuff_intra_par_1", "make_collisions_compact_doublezitblock_sizze_83384", "make_collisions_compact_doublezitblock_sizze_83404", "make_collisions_compact_doublezitblock_sizze_83527", "make_collisions_compact_doublezitblock_sizze_83550", "next_partition_to_read_doublezisegmap_num_tblocks_66885", "next_partition_to_read_doublezisegmap_tblock_sizze_66883", "next_partition_to_read_doublezisegred_num_tblocks_66865", "next_partition_to_read_doublezisegred_tblock_sizze_66863", "next_partition_to_read_doublezisegscan_num_tblocks_66875", "next_partition_to_read_doublezisegscan_tblock_sizze_66873", "rectify_cluster_ids_doublezisegmap_tblock_sizze_74934", "rectify_cluster_ids_doublezisegmap_tblock_sizze_75038", NULL};
static const char *tuning_param_classes[] = {"grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, !add_next_partition_double.suff_outer_par_1 !add_next_partition_double.suff_outer_screma_0)", "threshold(def, !add_next_partition_double.suff_outer_screma_0)", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "cache", "shared_memory", "grid_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(def, )", "threshold(def, !do_DBSCAN_double.suff_outer_screma_1)", "threshold(def, !do_DBSCAN_double.suff_outer_screma_3)", "threshold(def, !do_DBSCAN_double.suff_outer_screma_5)", "threshold(def, )", "threshold(def, )", "threshold(def, )", "threshold(def, )", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "threshold(def, )", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "threshold(def, )", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "threshold(32, )", "threshold(32, !make_collisions_compact_double.suff_intra_par_0)", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", NULL};
static int64_t tuning_param_defaults[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
static const int max_failure_args = 3;
static const int f64_required = 1;
static const char *gpu_program[] = {"#define FUTHARK_CUDA\n// start of prelude.cu\n\n#define SCALAR_FUN_ATTR __device__ static inline\n#define FUTHARK_FUN_ATTR __device__ static\n#define FUTHARK_F64_ENABLED\n\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\n\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\n\nstatic inline __device__ int get_tblock_id(int d) {\n  switch (d) {\n  case 0: return blockIdx.x;\n  case 1: return blockIdx.y;\n  case 2: return blockIdx.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_num_tblocks(int d) {\n  switch(d) {\n  case 0: return gridDim.x;\n  case 1: return gridDim.y;\n  case 2: return gridDim.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x + blockIdx.x * blockDim.x;\n    case 1: return threadIdx.y + blockIdx.y * blockDim.y;\n    case 2: return threadIdx.z + blockIdx.z * blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x;\n    case 1: return threadIdx.y;\n    case 2: return threadIdx.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_size(int d) {\n  switch (d) {\n    case 0: return blockDim.x;\n    case 1: return blockDim.y;\n    case 2: return blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_size(int d) {\n  switch (d) {\n    case 0: return gridDim.x * blockDim.x;\n    case 1: return gridDim.y * blockDim.y;\n    case 2: return gridDim.z * blockDim.z;\n    default: return 0;\n  }\n}\n\n\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline __device__ void barrier(int x) {\n  __syncthreads();\n}\nstatic inline __device__ void mem_fence_local() {\n  __threadfence_block();\n}\nstatic inline __device__ void mem_fence_global", "() {\n  __threadfence();\n}\n\nstatic inline __device__ void barrier_local() {\n  __syncthreads();\n}\n\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ unsigned char shared_mem[];\n\n#define SHARED_MEM_PARAM\n#define FUTHARK_KERNEL extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define FUTHARK_KERNEL_SIZED(a,b,c) extern \"C\" __global__ __launch_bounds__(a*b*c)\n\n// End of prelude.cu\n// Start of half.h.\n\n// Conversion functions are from http://half.sourceforge.net/, but\n// translated to C.\n//\n// Copyright (c) 2012-2021 Christian Rau\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n#ifndef __OPENCL_VERSION__\n#define __constant\n#endif\n\n__constant static const uint16_t base_table[512] = {\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0", "000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,\n  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,\n  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8",
                                    "000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,\n  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,\n  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };\n\n__constant static const unsigned char shift_table[512] = {\n  24, 24, 24, 24, 24, 24,", " 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2", "4, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };\n\n__constant static const uint32_t mantissa_table[2048] = {\n  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,\n  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,\n  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,\n  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,\n  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,\n  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,\n  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,\n  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,\n  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,\n  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x37",
                                    "1B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,\n  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,\n  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,\n  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,\n  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,\n  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,\n  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,\n  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,\n  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,\n  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,\n  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,\n  0x", "37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,\n  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,\n  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,\n  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,\n  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,\n  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,\n  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,\n  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,\n  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,\n  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,\n  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x", "37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,\n  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,\n  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,\n  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,\n  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,\n  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,\n  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,\n  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,\n  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,\n  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,\n  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x",
                                    "38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,\n  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,\n  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,\n  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,\n  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,\n  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,\n  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,\n  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,\n  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,\n  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,\n  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x", "384BC000,\n  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,\n  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,\n  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,\n  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,\n  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,\n  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,\n  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,\n  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,\n  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,\n  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,\n  0x38740000, 0x38744000, 0x38748000, 0x3874C000, ", "0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,\n  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,\n  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,\n  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,\n  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,\n  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,\n  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,\n  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,\n  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,\n  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,\n  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, ",
                                    "0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,\n  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,\n  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,\n  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,\n  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,\n  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,\n  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,\n  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,\n  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,\n  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,\n  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, ", "0x3823C000, 0x3823E000,\n  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,\n  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,\n  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,\n  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,\n  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,\n  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,\n  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,\n  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,\n  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,\n  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,\n  0x38380000, 0x38382000, 0x38384000", ", 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,\n  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,\n  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,\n  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,\n  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,\n  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,\n  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,\n  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,\n  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,\n  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,\n  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000",
                                    ", 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,\n  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,\n  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,\n  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,\n  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,\n  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,\n  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,\n  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,\n  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,\n  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,\n  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000", ", 0x3861A000, 0x3861C000, 0x3861E000,\n  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,\n  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,\n  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,\n  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,\n  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,\n  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,\n  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,\n  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,\n  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,\n  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,\n  0x38760000, 0x387620", "00, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,\n  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,\n  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,\n  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,\n  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };\n__constant static const uint32_t exponent_table[64] = {\n  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,\n  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,\n  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,\n  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };\n__constant static const unsigned short offset_table[64] = {\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1",
                                    "024, 1024, 1024, 1024, 1024, 1024,\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };\n\nSCALAR_FUN_ATTR uint16_t float2halfbits(float value) {\n  union { float x; uint32_t y; } u;\n  u.x = value;\n  uint32_t bits = u.y;\n\n  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;\n\n  return hbits;\n}\n\nSCALAR_FUN_ATTR float halfbits2float(uint16_t value) {\n  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];\n\n  union { uint32_t x; float y; } u;\n  u.x = bits;\n  return u.y;\n}\n\nSCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {\n  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;\n  if(fabs > 0x7C00 || tabs > 0x7C00) {\n    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);\n  }\n  if(from == to || !(fabs|tabs)) {\n    return to;\n  }\n  if(!fabs) {\n    return (to&0x8000)+1;\n  }\n  unsigned int out =\n    from +\n    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)\n    - 1;\n  return out;\n}\n\n// End of half.h.\n// Start of scalar.h.\n\n// Implementation of the primitive scalar operations.  Very\n// repetitive.  This code is inserted directly into both CUDA and\n// OpenCL programs, as well as the CPU code, so it has some #ifdefs to\n// work everywhere.  Some operations are defined as macros because\n// this allows us to use them as constant expressions in things like\n// array sizes and static initialisers.\n\n// Some of the #ifdefs are because OpenCL uses type-generic functions\n// for some operations (e.g. sqrt), while C and CUDA sensibly use\n// distinct functions for different precisions (e.g. sqrtf() and\n// sqrt()).  This is quite annoying.  Due to C's unfortunate casting\n// rules, it is also really easy to accidentally implement\n// floating-point functions in the wrong precision, so be careful.\n\n/", "/ Double-precision definitions are only included if the preprocessor\n// macro FUTHARK_F64_ENABLED is set.\n\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);\n\nSCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {\n  return x * y;\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  // This strange pattern is used to prevent the ISPC compiler from\n  // causing SIGFPEs and bogus results on divisions where inactive lanes\n  // have 0-valued divisors. It ensures that any inactive lane instead\n  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  uint", "8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALA",
                                    "R_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t q = x / ys;\n  int8_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t q = x / ys;\n  int16_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n  int32_t q = x / ys;\n  int32_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t q = x / ys;\n  int64_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y)", " {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int32_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) ", "{\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  ",
                                    "foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\n#else\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  return", " y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t q = x / y;\n  int8_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t q = x / y;\n  int16_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t q = x / y;\n  int32_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t q = x / y;\n  int64_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t r = ", "x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t ",
                                    "y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {\n  return (uint8_t)(x << y);\n}\n\nS", "CALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {\n  return (uint16_t)(x << y);\n}\n\nSCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult64(uint64_t x, uint64", "_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {\n  uint8_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {\n  uint16_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {\n  uint32_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {\n  uint64_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x",
                                    ") {\n  return x;\n}\n\nSCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {\n  return x;\n}\n\n#define sext_i8_i8(x) ((int8_t) (int8_t) (x))\n#define sext_i8_i16(x) ((int16_t) (int8_t) (x))\n#define sext_i8_i32(x) ((int32_t) (int8_t) (x))\n#define sext_i8_i64(x) ((int64_t) (int8_t) (x))\n#define sext_i16_i8(x) ((int8_t) (int16_t) (x))\n#define sext_i16_i16(x) ((int16_t) (int16_t) (x))\n#define sext_i16_i32(x) ((int32_t) (int16_t) (x))\n#define sext_i16_i64(x) ((int64_t) (int16_t) (x))\n#define sext_i32_i8(x) ((int8_t) (int32_t) (x))\n#define sext_i32_i16(x) ((int16_t) (int32_t) (x))\n#define sext_i32_i32(x) ((int32_t) (int32_t) (x))\n#define sext_i32_i64(x) ((int64_t) (int32_t) (x))\n#define sext_i64_i8(x) ((int8_t) (int64_t) (x))\n#define sext_i64_i16(x) ((int16_t) (int64_t) (x))\n#define sext_i64_i32(x) ((int32_t) (int64_t) (x))\n#define sext_i64_i64(x) ((int64_t) (int64_t) (x))\n#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))\n#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))\n#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))\n#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))\n#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))\n#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))\n#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))\n#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))\n#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))\n#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))\n#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))\n#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))\n#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))\n#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))\n#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))\n#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))\n\nSCALAR_FUN_ATTR int8_t abs8(int8_t x) {\n  return (int8_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int16_t abs16(int16_t x) {\n  return (int16_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int32_t abs32(int32_t x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR int64_t abs64(int64_t x) {\n#if defined(__OPENCL_VER", "SION__) || defined(ISPC)\n  return abs(x);\n#else\n  return llabs(x);\n#endif\n}\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return __popc(zext_i8_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return __popc(zext_i16_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return __popc(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return __popcll(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return m", "ul_hi(a, b); }\n#elif defined(__CUDA_ARCH__)\nSCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }\nSCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }\n#elif ISPC\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 = al * bl;\n  uint64_t p2 = al * bh;\n  uint64_t p3 = ah * bl;\n  uint64_t p4 = ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\nSCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR int",
                                    "32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 =  al * bl;\n  int64_t  p2 = al * bh;\n  int64_t  p3 = ah * bl;\n  uint64_t p4 =  ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\n\n#else // Not OpenCL, ISPC, or CUDA, but plain C.\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }\nSCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t ", "a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }\n#else // Not OpenCL\n\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return clz(x);\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return __clz(zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return __clz(zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  retur", "n __clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return __clzll(x);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return count_leading_zeros((int32_t)(uint8_t)x)-24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return count_leading_zeros((int32_t)(uint16_t)x)-16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return count_leading_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return count_leading_zeros(x);\n}\n\n#else // Not OpenCL, ISPC or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_clz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int i = 0;\n  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int i = 0;\n  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int i = 0;\n  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int i = 0;\n  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 8 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 16 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 32 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int y = __ffsll(x);\n  return y == 0 ? 64 : y - 1",
                                    ";\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return count_trailing_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return count_trailing_zeros(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);\n}\n#endif\n\nSCALAR_FUN_ATTR float fdiv32(float x, float y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR float fadd32(float x, float y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR float fsub32(float x, float y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR float fmul32(float x, float y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt32(float x, float y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple32(float x, float y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {\n  return (float) x;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, f", "loat y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return pow(x, y);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float a, float b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\n#else // Not OpenCL, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return powf(x, y);\n}\n#endif\n\nSCALAR_FUN_ATTR bool futrts_isnan32(float x) {\n  return isnan(x);\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite32(float x) {\n  return !isnan(x) && !futrts_isinf32(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return isinf(x);\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  };\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {", "\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f32_bool(float x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR float btof_bool_f32(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinh(x);\n}\n\nSC",
                                    "ALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fma(a, b, c);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return futrts_log32(x) / log(2.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return futrts_log32(x) / log(10.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;\n  float y = 1.0f + x;\n  float z = y - 1.0f;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform float cbrtf(uniform float);\nSCALAR_FUN_ATTR float futrts_cbrt32(float", " x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return (exp(x)+exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return (exp(x)-exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return futrts_sinh32(x)/futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  float f = x+sqrt(x*x-1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  float f = x+sqrt(x*x+1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  float f = (1+x)/(1-x);\n  if(futrts_isfinite32(f)) return log(f)/2.0f;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {\n    x = abs(x);\n    y = abs(y);\n    float a;\n    float b;\n    if (x >= y){\n        a = x;\n        b = y;\n    } else {\n        a = y;\n        b = x;\n    }\n    if(b == 0){\n      return a;\n    }\n\n    int e;\n    float an;\n    float bn;\n    an = frexp (a, &e);\n    bn = ldexp (b, - e);\n    float cn;\n    cn = sqrt (an * an + bn * bn);\n    return ldexp (cn, e);\n  } else {\n    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;\n    else return x + y;\n  }\n\n}\n\nextern \"C\" unmasked uniform float tgammaf(", "uniform float x);\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = tgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = lgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erff(uniform float x);\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erff(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erfcf(uniform float x);\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erfcf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform float nextafterf(uniform float x, uniform float y);\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  float res;\n  foreach_active (i) {\n    uniform float r = nextafterf(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  int32_t xb = futrts_to_bits32(x);\n  int32_t yb = futrts_to_bits32(y);\n  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futr",
                                    "ts_fma32(float a, float b, float c) {\n  return a * b + c;\n}\n\n#else // Not OpenCL or ISPC, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return logf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1pf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return expf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  re", "turn rintf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floorf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceilf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafterf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexpf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysignf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fmaf(a, b, c);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  return intbits(x);\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  return floatbits(x);\n}\n#else\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  union {\n    float f;\n    int32_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  union {\n    int32_t f;\n    float t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\nSCALAR_FUN_ATTR float fsignum32(float x) {\n  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf64(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite64(float x) {\n  return !isnan(x) && !futrts_isinf64(x);\n}\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}", "\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double a, double b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return futrts_log64(x)/log(2.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return futrts_log64(x)/log(10.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;\n  double y = 1.0d + x;\n  double z = y - 1.0d;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform double cbrt(uniform double);\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(dou",
                                    "ble x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return (exp(x)+exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return (exp(x)-exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return futrts_sinh64(x)/futrts_cosh64(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  double f = x+sqrt(x*x-1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  double f = x+sqrt(x*x+1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  double f = (1.0d+x)/(1.0d-x);\n  if(futrts_isfinite64(f)) return log(f)/2.0d;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nextern \"C\" unmasked uniform double hypot(uniform double x, uniform double y);\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = hypot(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double tgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = tgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double lgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = lgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erf(uniform double x);\nSCALAR_FUN_ATTR do", "uble futrts_erf64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erfc(uniform double x);\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erfc(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform double nextafter(uniform float x, uniform double y);\nSCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = nextafter(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int", "16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0.0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1.0 : 0.0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  int64_t res;\n  foreach_active (i) {\n    uniform double tmp = extract(x, i);\n    uniform int64_t r = *((uniform int64_t* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  double res;\n  foreach_active (i) {\n    uniform int64_t tmp = extract(x, i);\n    uniform double r = *((uniform double* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {\n  int64_t xb = futrts_to_bits64(x);\n  int64_t yb = futrts_to_bits64(y);\n  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#e",
                                    "lse\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double x, double y) {\n  return pow(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(double x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  r", "eturn tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erf64(double x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return fma(a, b, c);\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf64(double x) {\n  return isinf(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x", ") {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1 : 0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  union {\n    double f;\n    int64_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  union {\n    int64_t f;\n    double t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n#ifdef __OPENCL_VERSION__\n  return mix(v0, v1, t);\n#else\n  return v0 + (v1 - v0) * t;\n#endif\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n#ifdef __OPENCL_VERSION__\n  return mad(a, b, c);\n#else\n  return a * b + c;\n#endif\n}\n\nSCALAR",
                                    "_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#endif\n\n#endif\n\n// End of scalar.h.\n// Start of scalar_f16.h.\n\n// Half-precision is emulated if needed (e.g. in straight C) with the\n// native type used if possible.  The emulation works by typedef'ing\n// 'float' to 'f16', and then implementing all operations on single\n// precision.  To cut down on duplication, we use the same code for\n// those Futhark functions that require just operators or casts.  The\n// in-memory representation for arrays will still be 16 bits even\n// under emulation, so the compiler will have to be careful when\n// generating reads or writes.\n\n#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))\n#define EMULATE_F16\n#endif\n\n#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)\n#pragma OPENCL EXTENSION cl_khr_fp16 : enable\n#endif\n\n#ifdef EMULATE_F16\n\n// Note that the half-precision storage format is still 16 bits - the\n// compiler will have to be real careful!\ntypedef float f16;\n\n#elif ISPC\ntypedef float16 f16;\n\n#else\n\n#ifdef __CUDA_ARCH__\n#include <cuda_fp16.h>\n#endif\n\ntypedef half f16;\n\n#endif\n\n// Some of these functions convert to single precision because half\n// precision versions are not available.\n\nSCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {\n  return (f16) x;\n}\n\nSCALAR", "_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {\n  return (int8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {\n  return (int16_t) x;\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {\n  return (int32_t) x;\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {\n  return (int64_t) x;\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {\n  return (uint8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {\n  return (uint16_t) x;\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {\n  return (uint32_t) x;\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {\n  return (uint64_t) x;\n}\n\nSCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {\n  return x != (f16)0;\n}\n\nSCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifndef EMULATE_F16\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return isnan((float)x);\n}\n\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#elif ISPC\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#else // Assuming CUDA.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 ", "x, f16 y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return powf(x, y);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf16(float x) {\n  return !futrts_isnan16(x) && futrts_isnan16(x - x);\n}\nSCALAR_FUN_ATTR bool futrts_isfinite16(float x) {\n  return !futrts_isnan16(x) && !futrts_isinf16(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return isinf((float)x);\n}\n#endif\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return e",
                                    "rf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fma(a, b, c);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log16(x) / log(2.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log16(x) / log(10.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;\n  f16 y = 1.0f16 + x;\n  f16 z = y - 1.0f16;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return (float16)sqrt((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return (float16)cos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return (float16)sin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return (float16)tan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return (float16)acos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return (float16)asin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return (float16)atan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  retu", "rn (exp(x)+exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return (exp(x)-exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_sinh16(x)/futrts_cosh16(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x-1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x+1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  float16 f = (1+x)/(1-x);\n  if(futrts_isfinite16(f)) return log(f)/2.0f16;\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return (float16)atan2((float)x, (float)y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return (float16)futrts_hypot32((float)x, (float)y);\n}\n\nextern \"C\" unmasked uniform float tgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)tgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)lgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  f16 res = (f16)futrts_cbrt32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  f16 res = (f16)futrts_erf32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  f16 res = (f16)futrts_erfc32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return x - y * (float16)trunc((float) (x/y));\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return (float16)round((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return (float16)floor((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return (float16)ceil((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrt", "s_nextafter16(f16 x, f16 y) {\n  return (float16)futrts_nextafter32((float)x, (float) y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\n#else // Assume CUDA.\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return hlog(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return hlog2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return hlog10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return (f16)log1pf((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return hsqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return hexp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return hcos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return hsin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f1",
                                    "6 x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rintf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return hfloor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return hceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fmaf(a, b, c);\n}\n\n#endif\n\n// The CUDA __half type cannot be put in unions for some reason, so we\n// use bespoke conversion functions instead.\n#ifdef __CUDA_ARCH__\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return __half_as_ushort(x);\n}\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return __ushort_as_half(x);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  varying int16_t y = *((varying int16_t * uniform)&x);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  varying f16 y = *((varying f16 * uniform)&x);\n  return y;\n}\n#else\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  union {\n    f16 f;\n    int16_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  union {\n    int16_t f;\n    f16 t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\n#else // No native f16 - emulate.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs32(x);\n}\n\nSC", "ALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return fpow32(x, y);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return futrts_isnan32(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return futrts_isinf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_log32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log2_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log10_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return futrts_log1p_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return futrts_sqrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return futrts_cbrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return futrts_exp32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return futrts_cos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return futrts_sin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return futrts_tan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return futrts_acos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return futrts_asin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return futrts_atan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return futrts_sinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_tanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return futrts_acosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return futrts_asinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return futrts_atanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return futrts_atan2_32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return futrts_hypot32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return futrts_gamma32(x);\n}\n\nSCA", "LAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return futrts_lgamma32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return futrts_erf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return futrts_erfc32(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return futrts_round32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return futrts_floor32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return futrts_ceil32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return futrts_lerp32(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return futrts_mad32(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return futrts_fma32(a, b, c);\n}\n\n// Even when we are using an OpenCL that does not support cl_khr_fp16,\n// it must still support vload_half for actually creating a\n// half-precision number, which can then be efficiently converted to a\n// float.  Similarly for vstore_half.\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  int16_t y;\n  // Violating strict aliasing here.\n  vstore_half((float)x, 0, (half*)&y);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return (f16)vload_half(0, (half*)&x);\n}\n\n#else\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return (int16_t)float2halfbits(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return halfbits2float((uint16_t)x);\n}\n\nSCALAR_FUN_ATTR f16 fsignum16(f16 x) {\n  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#endif\n\n#endif\n\nSCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {\n  retu",
                                    "rn x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {\n  return (f16) x;\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {\n  return (double) x;\n}\n\n#if ISPC\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) ((float)x);\n}\n#else\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) x;\n}\n#endif\n#endif\n\n\n// End of scalar_f16.h.\n// Start of atomics.h\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32", "_t *p, uint32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x);\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#el", "se\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  float ret;\n  asm volatile(\"atom.global.add.f32 %0,[%1],%2;\":\"=f\"(ret):\"l\"(p),\"f\"(x):\"memory\");\n  return ret;\n#elif defined(__opencl_c_ext_fp32_global_atomic_add)\n  // use hardware-supported atomic addition on some Intel GPUs\n  return atomic_fetch_add_explicit((volatile __global atomic_float*)p,\n                                   x,\n                                   memory_order_relaxed);\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f32)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f32(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  float old = x;\n  float ret;\n  while ((old=atomic_xchg(p, ret=atomic_xchg(p, 0.0f)+old))!=0.0f);\n  return ret;\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_shared((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile",
                                    " __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, ", "int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR uint", "64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x);\n\n#ifdef FUTHARK_F64_ENABLED\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x);\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x);\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val) {\n#if defined(F",
                                    "UTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  double ret;\n  asm volatile(\"atom.global.add.f64 %0,[%1],%2;\":\"=d\"(ret):\"l\"(p),\"d\"(x):\"memory\");\n  return ret;\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f64)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f64(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  union {int64_t i; double f;} old;\n  union {int64_t i; double f;} ret;\n  old.f = x;\n  while (1) {\n    ret.i = atom_xchg((volatile __global int64_t*)p, (int64_t)0);\n    ret.f += old.f;\n    old.i = atom_xchg((volatile __global int64_t*)p, ret.i);\n    if (old.i == 0) {\n      break;\n    }\n  }\n  return ret.f;\n#endif\n}\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  u", "nion { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do ", "{\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(v",
                                    "olatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n#endif // defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\n// End of atomics.h\n// Start of transpose.cl\n\n#define GEN_TRANSPOSE_KERNELS(NAME, ELEM_TYPE)                          \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_PER_THREAD, 1)\\\nvoid map_transpose_##NAME(SHARED_MEM_PARAM                              \\\n                          __global ELEM_TYPE *dst_mem,                  \\\n                          int64_t dst_offset,                           \\\n                          __global ELEM_TYPE *src_mem,                  \\\n                          int64_t src_offset,                           \\\n                          int32_t num_arrays,                           \\\n                          int32_t x_elems,                              \\\n                          int32_t y_elems,                              \\\n                          int32_t mulx,                                 \\\n                          int32_t muly,                                 \\\n                          int32_t repeat_1,                             \\\n                          int32_t repeat_2) {                           \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_g", "lobal_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = global_id_0;                                    \\\n      int32_t y_index = tblock_id_1 * TR_TILE_DIM + get_local_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_in", "dex + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_height(SHARED_MEM_PARAM                 \\\n                                                __global ELEM_TYPE *dst_mem, \\\n                                                int64_t dst_offset,     \\\n                                                __global ELEM_TYPE *src_mem, \\\n                                                int64_t src_offset,     \\\n                                                int32_t num_arrays,     \\\n                                                int32_t x_elems,        \\\n                                                int32_t y_elems,        \\\n                                                int32_t mulx,           \\\n                                                int32_t muly,           \\\n                                                int32_t repeat_1,       \\\n ",
                                    "                                               int32_t repeat_2) {     \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index =                                                 \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n        get_local_id(0) +                                               \\\n        get_local_id(1)%mulx * TR_BLOCK_DIM;                            \\\n      int32_t y_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(1)/mulx; \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(0)/mulx;      \\\n      y_index =                                                         \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n", "        get_local_id(1) +                                               \\\n        (get_local_id(0)%mulx) * TR_BLOCK_DIM;                          \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n      if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_width(SHARED_MEM_PARAM                  \\\n                                      __global ELEM_TYPE *dst_mem,      \\\n                                      int64_t dst_offset,               \\\n                                      __global ELEM_TYPE *src_mem,      \\\n                                      int64_t src_offset,               \\\n                                      int32_t num_arrays,               \\\n                                      int32_t x_elems,                  \\\n                                      int32_t y_elems,                  \\\n                                      int32_t mulx,                     \\\n                                      int32_t muly,                     \\\n                                      int32_t repeat_1,                 \\\n  ", "                                    int32_t repeat_2) {               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(0)/muly; \\\n      int32_t y_index =                                                 \\\n        tblock_id_1 * TR_BLOCK_DIM * muly +                             \\\n        get_local_id(1) + (get_local_id(0)%muly) * TR_BLOCK_DIM;        \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM * muly +                     \\\n        get_local_id(0) + (get_local_id(1)%muly) * TR_BLOCK_DIM;        \\\n      y_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(1)/muly;      \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n ",
                                    "     if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_num_tblocks(2) * get_local_size(2);            \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_num_tblocks(1) * get_local_size(1);              \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*TR_BLOCK_DIM, 1, 1)                   \\\nvoid map_transpose_##NAME##_small(SHARED_MEM_PARAM                       \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int32_t num_arrays,                   \\\n                                  int32_t x_elems,                      \\\n                                  int32_t y_elems,                      \\\n                                  int32_t mulx,                         \\\n                                  int32_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  ", "int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = global_id_0/(y_elems * x_elems) * y_elems * x_elems; \\\n      int32_t x_index = (global_id_0 % (y_elems * x_elems))/y_elems;    \\\n      int32_t y_index = global_id_0%y_elems;                            \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      int32_t index_out = x_index * y_elems + y_index;                  \\\n      if (global_id_0 < x_elems * y_elems * num_arrays) {               \\\n        dst_mem[odata_offset + index_out] = src_mem[idata_offset + index_in]; \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_", "PER_THREAD, 1)\\\nvoid map_transpose_##NAME##_large(SHARED_MEM_PARAM                      \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int64_t num_arrays,                   \\\n                                  int64_t x_elems,                      \\\n                                  int64_t y_elems,                      \\\n                                  int64_t mulx,                         \\\n                                  int64_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;             \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int64_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int64_t odata_offset = dst_offset + our_array_offset;             \\\n      int64_t idata_offset = src_offset + our_array_offset;             \\\n      int64_t x_index = global_id_0;                                    \\\n      int64_t y_index = tblock_id_1 * TR_TILE_DIM + get_loc",
                                    "al_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                      ", "                             \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n\nGEN_TRANSPOSE_KERNELS(1b, uint8_t)\nGEN_TRANSPOSE_KERNELS(2b, uint16_t)\nGEN_TRANSPOSE_KERNELS(4b, uint32_t)\nGEN_TRANSPOSE_KERNELS(8b, uint64_t)\n\n// End of transpose.cl\n// Start of copy.cl\n\n#define GEN_COPY_KERNEL(NAME, ELEM_TYPE) \\\nFUTHARK_KERNEL void lmad_copy_##NAME(SHARED_MEM_PARAM                   \\\n                               __global ELEM_TYPE *dst_mem,             \\\n                               int64_t dst_offset,                      \\\n                               __global ELEM_TYPE *src_mem,             \\\n                               int64_t src_offset,                      \\\n                               int64_t n,                               \\\n                               int r,                                   \\\n                               int64_t shape0, int64_t dst_stride0, int64_t src_stride0, \\\n                               int64_t shape1, int64_t dst_stride1, int64_t src_stride1, \\\n                               int64_t shape2, int64_t dst_stride2, int64_t src_stride2, \\\n                               int64_t shape3, int64_t dst_stride3, int64_t src_stride3, \\\n                               int64_t shape4, int64_t dst_stride4, int64_t src_stride4, \\\n                               int64_t shape5, int64_t dst_stride5, int64_t src_stride5, \\\n                               int64_t shape6, int64_t dst_stride6, int64_t src_stride6, \\\n                               int64_t shape7, int64_t dst_stride7, int64_t src_stride7) { \\\n  int64_t gtid = get_global_id(0);                                      \\\n  int64_t remainder = gtid;                                             \\\n                                             ", "                           \\\n  if (gtid >= n) {                                                      \\\n    return;                                                             \\\n  }                                                                     \\\n                                                                        \\\n  if (r > 0) {                                                          \\\n    int64_t i = remainder % shape0;                                     \\\n    dst_offset += i * dst_stride0;                                      \\\n    src_offset += i * src_stride0;                                      \\\n    remainder /= shape0;                                                \\\n  }                                                                     \\\n  if (r > 1) {                                                          \\\n    int64_t i = remainder % shape1;                                     \\\n    dst_offset += i * dst_stride1;                                      \\\n    src_offset += i * src_stride1;                                      \\\n    remainder /= shape1;                                                \\\n  }                                                                     \\\n  if (r > 2) {                                                          \\\n    int64_t i = remainder % shape2;                                     \\\n    dst_offset += i * dst_stride2;                                      \\\n    src_offset += i * src_stride2;                                      \\\n    remainder /= shape2;                                                \\\n  }                                                                     \\\n  if (r > 3) {                                                          \\\n    int64_t i = remainder % shape3;                                     \\\n    dst_offset += i * dst_stride3;                                      \\\n    src_offset += i * src_stride3;                                      \\\n    remainder /= shape3;                       ",
                                    "                         \\\n  }                                                                     \\\n  if (r > 4) {                                                          \\\n    int64_t i = remainder % shape4;                                     \\\n    dst_offset += i * dst_stride4;                                      \\\n    src_offset += i * src_stride4;                                      \\\n    remainder /= shape4;                                                \\\n  }                                                                     \\\n  if (r > 5) {                                                          \\\n    int64_t i = remainder % shape5;                                     \\\n    dst_offset += i * dst_stride5;                                      \\\n    src_offset += i * src_stride5;                                      \\\n    remainder /= shape5;                                                \\\n  }                                                                     \\\n  if (r > 6) {                                                          \\\n    int64_t i = remainder % shape6;                                     \\\n    dst_offset += i * dst_stride6;                                      \\\n    src_offset += i * src_stride6;                                      \\\n    remainder /= shape6;                                                \\\n  }                                                                     \\\n  if (r > 7) {                                                          \\\n    int64_t i = remainder % shape7;                                     \\\n    dst_offset += i * dst_stride7;                                      \\\n    src_offset += i * src_stride7;                                      \\\n    remainder /= shape7;                                                \\\n  }                                                                     \\\n                                                                        \\\n  dst_mem[dst_offset] = src_mem[src_offset];     ", "                       \\\n}\n\nGEN_COPY_KERNEL(1b, uint8_t)\nGEN_COPY_KERNEL(2b, uint16_t)\nGEN_COPY_KERNEL(4b, uint32_t)\nGEN_COPY_KERNEL(8b, uint64_t)\n\n// End of copy.cl\n\nFUTHARK_FUN_ATTR void futrts_lifted_lambda_11636(bool *out_prim_out_0, int64_t c1_48767, int64_t p1_48768, int64_t c2_48769, int64_t p2_48770);\nFUTHARK_FUN_ATTR void futrts_lifted_normalizze_11537(int64_t *out_prim_out_0, int64_t *out_prim_out_1, int64_t *out_prim_out_2, int64_t *out_prim_out_3, int64_t *out_prim_out_4, int64_t slo_49016, int64_t shi_49017, int64_t tlo_49018, int64_t thi_49019, int64_t count_49020);\n\nFUTHARK_FUN_ATTR void futrts_lifted_lambda_11636(bool *out_prim_out_0, int64_t c1_48767, int64_t p1_48768, int64_t c2_48769, int64_t p2_48770)\n{\n    bool prim_out_83117;\n    bool cond_48771 = slt64(c1_48767, c2_48769);\n    bool cond_48773 = c1_48767 == c2_48769;\n    bool lifted_lambda_res_f_res_t_res_48775 = sle64(p1_48768, p2_48770);\n    bool x_51932 = cond_48773 && lifted_lambda_res_f_res_t_res_48775;\n    bool x_51930 = !cond_48771;\n    bool y_51931 = x_51930 && x_51932;\n    bool lifted_lambda_res_48772 = cond_48771 || y_51931;\n    \n    prim_out_83117 = lifted_lambda_res_48772;\n    *out_prim_out_0 = prim_out_83117;\n}\nFUTHARK_FUN_ATTR void futrts_lifted_normalizze_11537(int64_t *out_prim_out_0, int64_t *out_prim_out_1, int64_t *out_prim_out_2, int64_t *out_prim_out_3, int64_t *out_prim_out_4, int64_t slo_49016, int64_t shi_49017, int64_t tlo_49018, int64_t thi_49019, int64_t count_49020)\n{\n    int64_t prim_out_83117;\n    int64_t prim_out_83118;\n    int64_t prim_out_83119;\n    int64_t prim_out_83120;\n    int64_t prim_out_83121;\n    int64_t min_arg1_49023 = add64(slo_49016, count_49020);\n    int64_t min_res_52015 = smin64(shi_49017, min_arg1_49023);\n    int64_t min_arg1_49027 = add64(tlo_49018, count_49020);\n    int64_t min_res_52018 = smin64(thi_49019, min_arg1_49027);\n    int64_t zp_lhs_49031 = sub64(min_res_52015, slo_49016);\n    int64_t zp_rhs_49033 = sub64(min_res_52018, tlo_49018);\n  ", "  int64_t zm_lhs_49035 = add64(zp_lhs_49031, zp_rhs_49033);\n    int64_t slack_49037 = sub64(zm_lhs_49035, count_49020);\n    int64_t min_res_52021 = smin64(zp_lhs_49031, slack_49037);\n    int64_t min_res_52024 = smin64(zp_rhs_49033, min_res_52021);\n    int64_t max_arg1_49047 = sub64(min_res_52015, min_res_52024);\n    int64_t max_res_52027 = smax64(slo_49016, max_arg1_49047);\n    int64_t max_arg1_49051 = sub64(min_res_52018, min_res_52024);\n    int64_t max_res_52030 = smax64(tlo_49018, max_arg1_49051);\n    int64_t zm_rhs_49055 = sub64(max_res_52027, slo_49016);\n    int64_t zm_lhs_49057 = sub64(count_49020, zm_rhs_49055);\n    int64_t zm_rhs_49059 = sub64(max_res_52030, tlo_49018);\n    int64_t count_49061 = sub64(zm_lhs_49057, zm_rhs_49059);\n    \n    prim_out_83117 = max_res_52027;\n    prim_out_83118 = min_res_52015;\n    prim_out_83119 = max_res_52030;\n    prim_out_83120 = min_res_52018;\n    prim_out_83121 = count_49061;\n    *out_prim_out_0 = prim_out_83117;\n    *out_prim_out_1 = prim_out_83118;\n    *out_prim_out_2 = prim_out_83119;\n    *out_prim_out_3 = prim_out_83120;\n    *out_prim_out_4 = prim_out_83121;\n}\n\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83369_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83369(__global int *global_failure, __global unsigned char *clBase_mem_81932, __global unsigned char *mem_81975)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83371;\n    int32_t tblock_sizze_83374;\n    int32_t wave_sizze_83373;\n    int32_t block_id_83372;\n    int32_t global_tid_83370;\n    int64_t tid_83369;\n    double x_81774;\n    \n    local_tid_83371 = get_local_id(0);\n    tblock_sizze_83374 = get_local_size(0);\n    wave_sizze_83373 = LOCKSTEP_WIDTH;\n    block_id_83372 = get_tblock_id(0);\n    global_tid_83370 = block_id_83372 * tblock_sizze_83374 + local_tid_83371;\n    tid_83369 = sext_i32_i64(global_tid_83370);\n    x_81774 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n    ((__global double *) mem_81975)[(int64_t) 0",
                                    "] = x_81774;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83395_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83395(__global int *global_failure, __global unsigned char *clBase_mem_81930, __global unsigned char *mem_81978)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83397;\n    int32_t tblock_sizze_83400;\n    int32_t wave_sizze_83399;\n    int32_t block_id_83398;\n    int32_t global_tid_83396;\n    int64_t tid_83395;\n    double x_81778;\n    \n    local_tid_83397 = get_local_id(0);\n    tblock_sizze_83400 = get_local_size(0);\n    wave_sizze_83399 = LOCKSTEP_WIDTH;\n    block_id_83398 = get_tblock_id(0);\n    global_tid_83396 = block_id_83398 * tblock_sizze_83400 + local_tid_83397;\n    tid_83395 = sext_i32_i64(global_tid_83396);\n    x_81778 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n    ((__global double *) mem_81978)[(int64_t) 0] = x_81778;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83401_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83401(__global int *global_failure, __global unsigned char *clBase_mem_81932, __global unsigned char *mem_81981)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83403;\n    int32_t tblock_sizze_83406;\n    int32_t wave_sizze_83405;\n    int32_t block_id_83404;\n    int32_t global_tid_83402;\n    int64_t tid_83401;\n    double x_81782;\n    \n    local_tid_83403 = get_local_id(0);\n    tblock_sizze_83406 = get_local_size(0);\n    wave_sizze_83405 = LOCKSTEP_WIDTH;\n    block_id_83404 = get_tblock_id(0);\n    global_tid_83402 = block_id_83404 * tblock_sizze_83406 + local_tid_83403;\n    tid_83401 = sext_i32_i64(global_tid_83402);\n    x_81782 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n    ((__global double *) mem_81981)[(int64_t) 0] = x_81782;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83407_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83407(_", "_global int *global_failure, __global unsigned char *clBase_mem_81930, __global unsigned char *mem_81984)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83409;\n    int32_t tblock_sizze_83412;\n    int32_t wave_sizze_83411;\n    int32_t block_id_83410;\n    int32_t global_tid_83408;\n    int64_t tid_83407;\n    double x_81786;\n    \n    local_tid_83409 = get_local_id(0);\n    tblock_sizze_83412 = get_local_size(0);\n    wave_sizze_83411 = LOCKSTEP_WIDTH;\n    block_id_83410 = get_tblock_id(0);\n    global_tid_83408 = block_id_83410 * tblock_sizze_83412 + local_tid_83409;\n    tid_83407 = sext_i32_i64(global_tid_83408);\n    x_81786 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n    ((__global double *) mem_81984)[(int64_t) 0] = x_81786;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83413_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83413(__global int *global_failure, __global unsigned char *clBase_mem_81932, __global unsigned char *mem_81987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83415;\n    int32_t tblock_sizze_83418;\n    int32_t wave_sizze_83417;\n    int32_t block_id_83416;\n    int32_t global_tid_83414;\n    int64_t tid_83413;\n    double x_81790;\n    \n    local_tid_83415 = get_local_id(0);\n    tblock_sizze_83418 = get_local_size(0);\n    wave_sizze_83417 = LOCKSTEP_WIDTH;\n    block_id_83416 = get_tblock_id(0);\n    global_tid_83414 = block_id_83416 * tblock_sizze_83418 + local_tid_83415;\n    tid_83413 = sext_i32_i64(global_tid_83414);\n    x_81790 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n    ((__global double *) mem_81987)[(int64_t) 0] = x_81790;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83419_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83419(__global int *global_failure, __global unsigned char *clBase_mem_81932, __global unsigned char *mem_81990)\n{\n    if (*global_failure >= 0)\n        return;\n    \n   ", " int32_t local_tid_83421;\n    int32_t tblock_sizze_83424;\n    int32_t wave_sizze_83423;\n    int32_t block_id_83422;\n    int32_t global_tid_83420;\n    int64_t tid_83419;\n    double x_81794;\n    \n    local_tid_83421 = get_local_id(0);\n    tblock_sizze_83424 = get_local_size(0);\n    wave_sizze_83423 = LOCKSTEP_WIDTH;\n    block_id_83422 = get_tblock_id(0);\n    global_tid_83420 = block_id_83422 * tblock_sizze_83424 + local_tid_83421;\n    tid_83419 = sext_i32_i64(global_tid_83420);\n    x_81794 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n    ((__global double *) mem_81990)[(int64_t) 0] = x_81794;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezigpuseq_83426_dim1, 1, 1)\nvoid add_next_partition_doublezigpuseq_83426(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t new_id_36801, unsigned char loop_not_taken_60498_bits, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *mem_81997, __global unsigned char *mem_81998, __global unsigned char *mem_81999, __global unsigned char *mem_82000, __global unsigned char *mem_82001, __global unsigned char *mem_82002, __global unsigned char *mem_82003, __global unsigned char *mem_82004)\n{\n    bool loop_not_taken_60498 = loop_not_taken_60498_bits;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83428;\n    int32_t tblock_sizze_83431;\n    int32_t wave_sizze_83430;\n    int32_t block_id_83429;\n    int32_t global_tid_83427;\n    int64_t tid_83426;\n    int64_t zv_rhs_81561;\n    bool zzero_81564;\n    bool nonzzero_81567;\n    bool nonzzero_cert_81570;\n    int64_t x_id_81573;\n    int64_t y_id_81576;\n    bool cond_81579;\n    int64_t zp_lhs_81583;\n    int64_t zm_lhs_81587;\n    int64_t nleft_t_res_81590;\n    int64_t nleft_81594;\n    bool cond_t_res_81597;\n    bool x_81601;\n    int64_t zt_lhs_81604;\n    int64_t zp_lhs_81608;\n    int64_t zm",
                                    "_lhs_81612;\n    int64_t nld_t_res_81615;\n    int64_t nld_81619;\n    int64_t ndown_81623;\n    int64_t zl_rhs_81626;\n    bool cond_81630;\n    bool x_81634;\n    int64_t nrd_t_res_81637;\n    int64_t nrd_81641;\n    int64_t nright_t_res_81644;\n    int64_t nright_81648;\n    int64_t zm_lhs_81652;\n    int64_t zl_rhs_81655;\n    bool cond_t_res_81659;\n    bool x_81663;\n    int64_t zt_lhs_81666;\n    int64_t zp_lhs_81670;\n    int64_t zp_lhs_81674;\n    int64_t nru_t_res_81677;\n    int64_t nru_81681;\n    int64_t zm_lhs_81683;\n    int64_t zl_rhs_81686;\n    bool cond_81690;\n    int64_t nup_81694;\n    bool x_81698;\n    int64_t nlu_t_res_81701;\n    int64_t nlu_81705;\n    bool cond_81718;\n    double minC_81727;\n    bool cond_81730;\n    double minC_81739;\n    bool cond_81743;\n    double maxC_81753;\n    bool cond_81757;\n    double maxC_81766;\n    bool protect_assert_disj_81769;\n    bool nonzzero_cert_81772;\n    \n    local_tid_83428 = get_local_id(0);\n    tblock_sizze_83431 = get_local_size(0);\n    wave_sizze_83430 = LOCKSTEP_WIDTH;\n    block_id_83429 = get_tblock_id(0);\n    global_tid_83427 = block_id_83429 * tblock_sizze_83431 + local_tid_83428;\n    tid_83426 = sext_i32_i64(global_tid_83427);\n    zv_rhs_81561 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n    zzero_81564 = zv_rhs_81561 == (int64_t) 0;\n    nonzzero_81567 = !zzero_81564;\n    if (!nonzzero_81567) {\n        {\n            if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                ;\n            }\n            return;\n        }\n    }\n    x_id_81573 = smod64(new_id_36801, zv_rhs_81561);\n    y_id_81576 = sdiv64(new_id_36801, zv_rhs_81561);\n    cond_81579 = slt64((int64_t) 0, x_id_81573);\n    zp_lhs_81583 = mul64(zv_rhs_81561, y_id_81576);\n    zm_lhs_81587 = add64(x_id_81573, zp_lhs_81583);\n    nleft_t_res_81590 = sub64(zm_lhs_81587, (int64_t) 1);\n    if (cond_81579) {\n        nleft_81594 = nleft_t_res_81590;\n    } else {\n        nleft_81594 = (int64_t) -1;\n    }\n    cond_t_res_81597 = slt64((int64_t) 0", ", y_id_81576);\n    x_81601 = cond_81579 && cond_t_res_81597;\n    zt_lhs_81604 = sub64(y_id_81576, (int64_t) 1);\n    zp_lhs_81608 = mul64(zv_rhs_81561, zt_lhs_81604);\n    zm_lhs_81612 = add64(x_id_81573, zp_lhs_81608);\n    nld_t_res_81615 = sub64(zm_lhs_81612, (int64_t) 1);\n    if (x_81601) {\n        nld_81619 = nld_t_res_81615;\n    } else {\n        nld_81619 = (int64_t) -1;\n    }\n    if (cond_t_res_81597) {\n        ndown_81623 = zm_lhs_81612;\n    } else {\n        ndown_81623 = (int64_t) -1;\n    }\n    zl_rhs_81626 = sub64(zv_rhs_81561, (int64_t) 1);\n    cond_81630 = slt64(x_id_81573, zl_rhs_81626);\n    x_81634 = cond_t_res_81597 && cond_81630;\n    nrd_t_res_81637 = add64((int64_t) 1, zm_lhs_81612);\n    if (x_81634) {\n        nrd_81641 = nrd_t_res_81637;\n    } else {\n        nrd_81641 = (int64_t) -1;\n    }\n    nright_t_res_81644 = add64((int64_t) 1, zm_lhs_81587);\n    if (cond_81630) {\n        nright_81648 = nright_t_res_81644;\n    } else {\n        nright_81648 = (int64_t) -1;\n    }\n    if (cond_81630) {\n        int64_t x_81651 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 1];\n        \n        zm_lhs_81652 = x_81651;\n    } else {\n        zm_lhs_81652 = (int64_t) 0;\n    }\n    zl_rhs_81655 = sub64(zm_lhs_81652, (int64_t) 1);\n    cond_t_res_81659 = slt64(y_id_81576, zl_rhs_81655);\n    x_81663 = cond_81630 && cond_t_res_81659;\n    zt_lhs_81666 = add64((int64_t) 1, y_id_81576);\n    zp_lhs_81670 = mul64(zv_rhs_81561, zt_lhs_81666);\n    zp_lhs_81674 = add64(x_id_81573, zp_lhs_81670);\n    nru_t_res_81677 = add64((int64_t) 1, zp_lhs_81674);\n    if (x_81663) {\n        nru_81681 = nru_t_res_81677;\n    } else {\n        nru_81681 = (int64_t) -1;\n    }\n    zm_lhs_81683 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 1];\n    zl_rhs_81686 = sub64(zm_lhs_81683, (int64_t) 1);\n    cond_81690 = slt64(y_id_81576, zl_rhs_81686);\n    if (cond_81690) {\n        nup_81694 = zp_lhs_81674;\n    } else {\n        nup_81694 = (int64_t) -1;\n    }\n    x_81698 = cond_81579 && cond_81690;\n    ", "nlu_t_res_81701 = sub64(zp_lhs_81674, (int64_t) 1);\n    if (x_81698) {\n        nlu_81705 = nlu_t_res_81701;\n    } else {\n        nlu_81705 = (int64_t) -1;\n    }\n    ((__global int64_t *) mem_81997)[(int64_t) 0] = nleft_81594;\n    ((__global int64_t *) mem_81997)[(int64_t) 1] = nld_81619;\n    ((__global int64_t *) mem_81997)[(int64_t) 2] = ndown_81623;\n    ((__global int64_t *) mem_81997)[(int64_t) 3] = nrd_81641;\n    ((__global int64_t *) mem_81997)[(int64_t) 4] = nright_81648;\n    ((__global int64_t *) mem_81997)[(int64_t) 5] = nru_81681;\n    ((__global int64_t *) mem_81997)[(int64_t) 6] = nup_81694;\n    ((__global int64_t *) mem_81997)[(int64_t) 7] = nlu_81705;\n    cond_81718 = x_id_81573 == (int64_t) 0;\n    if (cond_81718) {\n        minC_81727 = -INFINITY;\n    } else {\n        double times_arg1_81721;\n        double i64_res_81723;\n        double zt_res_81724;\n        double plus_arg0_81725;\n        double zp_res_81726;\n        \n        times_arg1_81721 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n        i64_res_81723 = sitofp_i64_f64(x_id_81573);\n        zt_res_81724 = times_arg1_81721 * i64_res_81723;\n        plus_arg0_81725 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n        zp_res_81726 = zt_res_81724 + plus_arg0_81725;\n        minC_81727 = zp_res_81726;\n    }\n    cond_81730 = y_id_81576 == (int64_t) 0;\n    if (cond_81730) {\n        minC_81739 = -INFINITY;\n    } else {\n        double times_arg1_81733;\n        double i64_res_81735;\n        double zt_res_81736;\n        double plus_arg0_81737;\n        double zp_res_81738;\n        \n        times_arg1_81733 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n        i64_res_81735 = sitofp_i64_f64(y_id_81576);\n        zt_res_81736 = times_arg1_81733 * i64_res_81735;\n        plus_arg0_81737 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n        zp_res_81738 = zt_res_81736 + plus_arg0_81737;\n        minC_81739 = zp_res_81738;\n    }\n    cond_81743 = x_id_81573 == zl_rhs_81626;\n    if (c",
                                    "ond_81743) {\n        maxC_81753 = INFINITY;\n    } else {\n        double times_arg1_81746;\n        int64_t from_i64_arg0_81748;\n        double i64_res_81749;\n        double zt_res_81750;\n        double plus_arg0_81751;\n        double zp_res_81752;\n        \n        times_arg1_81746 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n        from_i64_arg0_81748 = add64((int64_t) 1, x_id_81573);\n        i64_res_81749 = sitofp_i64_f64(from_i64_arg0_81748);\n        zt_res_81750 = times_arg1_81746 * i64_res_81749;\n        plus_arg0_81751 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n        zp_res_81752 = zt_res_81750 + plus_arg0_81751;\n        maxC_81753 = zp_res_81752;\n    }\n    cond_81757 = y_id_81576 == zl_rhs_81686;\n    if (cond_81757) {\n        maxC_81766 = INFINITY;\n    } else {\n        double times_arg1_81760;\n        double i64_res_81762;\n        double zt_res_81763;\n        double plus_arg0_81764;\n        double zp_res_81765;\n        \n        times_arg1_81760 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n        i64_res_81762 = sitofp_i64_f64(zt_lhs_81666);\n        zt_res_81763 = times_arg1_81760 * i64_res_81762;\n        plus_arg0_81764 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n        zp_res_81765 = zt_res_81763 + plus_arg0_81764;\n        maxC_81766 = zp_res_81765;\n    }\n    protect_assert_disj_81769 = loop_not_taken_60498 || nonzzero_81567;\n    if (!protect_assert_disj_81769) {\n        {\n            if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                ;\n            }\n            return;\n        }\n    }\n    ((__global double *) mem_81998)[(int64_t) 0] = minC_81727;\n    ((__global double *) mem_81998)[(int64_t) 1] = minC_81739;\n    ((__global double *) mem_81999)[(int64_t) 0] = maxC_81753;\n    ((__global double *) mem_81999)[(int64_t) 1] = maxC_81766;\n    ((__global int64_t *) mem_82000)[(int64_t) 0] = zv_rhs_81561;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 8; i_0++) {\n        ((__global int64_t *) mem_82", "001)[i_0] = ((__global int64_t *) mem_81997)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global double *) mem_82003)[i_0] = ((__global double *) mem_81998)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global double *) mem_82004)[i_0] = ((__global double *) mem_81999)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_69035_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_69035(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t part_no_36754, __global unsigned char *clProc_mem_81937, __global unsigned char *mem_82001, __global unsigned char *mem_82006)\n{\n    #define segmap_tblock_sizze_69031 (add_next_partition_doublezisegmap_69035zisegmap_tblock_sizze_69031)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83582;\n    int32_t tblock_sizze_83585;\n    int32_t wave_sizze_83584;\n    int32_t block_id_83583;\n    int32_t global_tid_83581;\n    int64_t phys_tid_69035;\n    int64_t global_tid_83586;\n    int64_t slice_83587;\n    int64_t gtid_69034;\n    int64_t remnant_83588;\n    \n    local_tid_83582 = get_local_id(0);\n    tblock_sizze_83585 = get_local_size(0);\n    wave_sizze_83584 = LOCKSTEP_WIDTH;\n    block_id_83583 = get_tblock_id(0);\n    global_tid_83581 = block_id_83583 * tblock_sizze_83585 + local_tid_83582;\n    phys_tid_69035 = sext_i32_i64(global_tid_83581);\n    global_tid_83586 = sext_i32_i64(block_id_83583) * segmap_tblock_sizze_69031 + sext_i32_i64(local_tid_83582);\n    slice_83587 = (int64_t) 8;\n    gtid_69034 = global_tid_83586;\n    remnant_83588 = global_tid_83586 - gtid_69034;\n    if (slt64(gtid_69034, (int64_t) 8)) {\n        int64_t eta_p_69036;\n        bool cond_69037;\n        bool lifted_lambda_res_69038;\n        \n        eta_p_69036 = ((__global int64_t *) mem_82001)[gtid_69034];\n        cond_69037 = sle64((int64_t) 0, eta_p_69036);\n        if (cond_69037) {\n            bo", "ol y_69039;\n            bool bounds_check_69040;\n            bool index_certs_69041;\n            bool lifted_lambda_res_t_res_69042;\n            \n            y_69039 = slt64(eta_p_69036, part_no_36754);\n            bounds_check_69040 = cond_69037 && y_69039;\n            if (!bounds_check_69040) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                        global_failure_args[0] = (int64_t) eta_p_69036;\n                        global_failure_args[1] = (int64_t) part_no_36754;\n                        ;\n                    }\n                    return;\n                }\n            }\n            lifted_lambda_res_t_res_69042 = ((__global bool *) clProc_mem_81937)[eta_p_69036];\n            lifted_lambda_res_69038 = lifted_lambda_res_t_res_69042;\n        } else {\n            lifted_lambda_res_69038 = 0;\n        }\n        ((__global bool *) mem_82006)[gtid_69034] = lifted_lambda_res_69038;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69031\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_69064_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_69064(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36767, double clBase_36773, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82008, __global unsigned char *mem_82010, __global unsigned char *mem_82011)\n{\n    #define segmap_tblock_sizze_69059 (add_next_partition_doublezisegmap_69064zisegmap_tblock_sizze_69059)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83663;\n    int32_t tblock_sizze_83666;\n    int32_t wave_sizze_83665;\n    int32_t block_id_83664;\n    int32_t global_",
                                    "tid_83662;\n    int64_t phys_tid_69064;\n    int64_t global_tid_83667;\n    int64_t slice_83668;\n    int64_t gtid_69063;\n    int64_t remnant_83669;\n    \n    local_tid_83663 = get_local_id(0);\n    tblock_sizze_83666 = get_local_size(0);\n    wave_sizze_83665 = LOCKSTEP_WIDTH;\n    block_id_83664 = get_tblock_id(0);\n    global_tid_83662 = block_id_83664 * tblock_sizze_83666 + local_tid_83663;\n    phys_tid_69064 = sext_i32_i64(global_tid_83662);\n    global_tid_83667 = sext_i32_i64(block_id_83664) * segmap_tblock_sizze_69059 + sext_i32_i64(local_tid_83663);\n    slice_83668 = (int64_t) 8;\n    gtid_69063 = global_tid_83667;\n    remnant_83669 = global_tid_83667 - gtid_69063;\n    if (slt64(gtid_69063, (int64_t) 8)) {\n        bool defunc_0_reduce_res_69066;\n        int64_t lifted_lambda_res_69067;\n        bool cond_69068;\n        int64_t defunc_0_f_res_69069;\n        bool defunc_0_f_res_69070;\n        int64_t defunc_0_f_res_69298;\n        \n        defunc_0_reduce_res_69066 = ((__global bool *) mem_82008)[gtid_69063];\n        if (defunc_0_reduce_res_69066) {\n            lifted_lambda_res_69067 = (int64_t) -1;\n        } else {\n            int64_t eta_p_69065 = ((__global int64_t *) mem_82001)[gtid_69063];\n            \n            lifted_lambda_res_69067 = eta_p_69065;\n        }\n        cond_69068 = slt64(lifted_lambda_res_69067, (int64_t) 0);\n        if (cond_69068) {\n            defunc_0_f_res_69069 = (int64_t) -1;\n        } else {\n            defunc_0_f_res_69069 = lifted_lambda_res_69067;\n        }\n        if (cond_69068) {\n            defunc_0_f_res_69070 = 0;\n        } else {\n            int64_t zv_rhs_69071;\n            bool zzero_69072;\n            bool nonzzero_69073;\n            bool nonzzero_cert_69074;\n            int64_t nxid_69075;\n            int64_t nyid_69076;\n            double times_arg1_69077;\n            double i64_res_69078;\n            double zt_res_69079;\n            double plus_arg0_69080;\n            double zp_res_69081;\n            double times_arg1_69082;", "\n            double i64_res_69083;\n            double zt_res_69084;\n            double plus_arg0_69085;\n            double zp_res_69086;\n            double zp_res_69087;\n            double zp_res_69088;\n            double zt_res_69089;\n            double zt_res_69090;\n            double zt_res_69091;\n            double zt_res_69092;\n            double zs_res_69093;\n            double zs_res_69094;\n            double zs_res_69095;\n            double zs_res_69096;\n            double d_haversine_res_69097;\n            double d_haversine_res_69098;\n            double d_haversine_res_69099;\n            double d_haversine_res_69100;\n            double cos_res_69101;\n            double cos_res_69102;\n            bool defunc_0_reduce_res_69103;\n            bool redout_81496;\n            \n            zv_rhs_69071 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n            zzero_69072 = zv_rhs_69071 == (int64_t) 0;\n            nonzzero_69073 = !zzero_69072;\n            if (!nonzzero_69073) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                        ;\n                    }\n                    return;\n                }\n            }\n            nxid_69075 = smod64(lifted_lambda_res_69067, zv_rhs_69071);\n            nyid_69076 = sdiv64(lifted_lambda_res_69067, zv_rhs_69071);\n            times_arg1_69077 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n            i64_res_69078 = sitofp_i64_f64(nxid_69075);\n            zt_res_69079 = times_arg1_69077 * i64_res_69078;\n            plus_arg0_69080 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n            zp_res_69081 = zt_res_69079 + plus_arg0_69080;\n            times_arg1_69082 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n            i64_res_69083 = sitofp_i64_f64(nyid_69076);\n            zt_res_69084 = times_arg1_69082 * i64_res_69083;\n            plus_arg0_69085 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n            zp_r", "es_69086 = zt_res_69084 + plus_arg0_69085;\n            zp_res_69087 = times_arg1_69077 + zp_res_69081;\n            zp_res_69088 = times_arg1_69082 + zp_res_69086;\n            zt_res_69089 = 3.141592653589793 * zp_res_69081;\n            zt_res_69090 = 3.141592653589793 * zp_res_69087;\n            zt_res_69091 = 3.141592653589793 * zp_res_69086;\n            zt_res_69092 = 3.141592653589793 * zp_res_69088;\n            zs_res_69093 = zt_res_69089 / 180.0;\n            zs_res_69094 = zt_res_69090 / 180.0;\n            zs_res_69095 = zt_res_69091 / 180.0;\n            zs_res_69096 = zt_res_69092 / 180.0;\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_69097 = zp_res_69081;\n            } else {\n                d_haversine_res_69097 = zs_res_69093;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_69098 = zp_res_69087;\n            } else {\n                d_haversine_res_69098 = zs_res_69094;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_69099 = zp_res_69086;\n            } else {\n                d_haversine_res_69099 = zs_res_69095;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_69100 = zp_res_69088;\n            } else {\n                d_haversine_res_69100 = zs_res_69096;\n            }\n            cos_res_69101 = futrts_cos64(d_haversine_res_69097);\n            cos_res_69102 = futrts_cos64(d_haversine_res_69098);\n            redout_81496 = 0;\n            for (int64_t i_81497 = 0; i_81497 < n_new_36762; i_81497++) {\n                double eta_p_69104;\n                double eta_p_69105;\n                bool zgze_res_69106;\n                bool zlze_res_69107;\n                bool x_69108;\n                double dist_res_69109;\n                bool zlze_res_69138;\n                double dist_res_69139;\n                bool zlze_res_69168;\n                bool x_69169;\n                bool y_69170;\n                boo",
                                    "l cond_t_res_69171;\n                bool x_69172;\n                bool zgze_res_69173;\n                bool zlze_res_69174;\n                bool x_69175;\n                double dist_res_69176;\n                bool zlze_res_69202;\n                double dist_res_69203;\n                bool zlze_res_69229;\n                bool x_69230;\n                bool y_69231;\n                bool cond_f_res_t_res_69232;\n                bool x_69233;\n                bool x_69234;\n                bool y_69235;\n                bool cond_69236;\n                bool zlze_res_69237;\n                double corn_x_69238;\n                bool zlze_res_69239;\n                double corn_y_69240;\n                double dist_res_69241;\n                bool zlze_res_69291;\n                bool x_69292;\n                bool y_69293;\n                bool is_pt_marginal_res_69294;\n                bool defunc_0_op_res_69297;\n                bool redout_tmp_83670;\n                \n                eta_p_69104 = ((__global double *) new_xs_mem_81952)[i_81497];\n                eta_p_69105 = ((__global double *) new_ys_mem_81953)[i_81497];\n                zgze_res_69106 = zp_res_69086 <= eta_p_69105;\n                zlze_res_69107 = eta_p_69105 <= zp_res_69088;\n                x_69108 = zgze_res_69106 && zlze_res_69107;\n                if (clBase_36766 == (int8_t) 0) {\n                    bool zeze_res_69110;\n                    double d_euclidean_res_69111;\n                    \n                    zeze_res_69110 = eta_p_69104 == zp_res_69081;\n                    if (zeze_res_69110) {\n                        double zm_res_69112;\n                        double abs_res_69113;\n                        \n                        zm_res_69112 = eta_p_69105 - eta_p_69105;\n                        abs_res_69113 = fabs64(zm_res_69112);\n                        d_euclidean_res_69111 = abs_res_69113;\n                    } else {\n                        double zm_res_69114;\n                        double abs_res_691", "15;\n                        \n                        zm_res_69114 = eta_p_69104 - zp_res_69081;\n                        abs_res_69115 = fabs64(zm_res_69114);\n                        d_euclidean_res_69111 = abs_res_69115;\n                    }\n                    dist_res_69109 = d_euclidean_res_69111;\n                } else {\n                    double d_haversine_res_69116;\n                    double d_haversine_res_69117;\n                    double d_haversine_res_69118;\n                    double zm_res_69123;\n                    double cos_res_69124;\n                    double zm_res_69125;\n                    double cos_res_69126;\n                    double zt_res_69127;\n                    double zm_res_69128;\n                    double zm_res_69129;\n                    double zt_res_69130;\n                    double zp_res_69131;\n                    double zs_res_69132;\n                    double min_res_69133;\n                    double zt_res_69134;\n                    double zm_res_69135;\n                    double acos_res_69136;\n                    double zt_res_69137;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_69116 = eta_p_69104;\n                        d_haversine_res_69117 = eta_p_69105;\n                        d_haversine_res_69118 = eta_p_69105;\n                    } else {\n                        double zt_res_69119;\n                        double zs_res_69120;\n                        double zt_res_69121;\n                        double zs_res_69122;\n                        \n                        zt_res_69119 = 3.141592653589793 * eta_p_69104;\n                        zs_res_69120 = zt_res_69119 / 180.0;\n                        zt_res_69121 = 3.141592653589793 * eta_p_69105;\n                        zs_res_69122 = zt_res_69121 / 180.0;\n                        d_haversine_res_69116 = zs_res_69120;\n                        d_haversine_res_69117 = zs_res_69122;\n                    ", "    d_haversine_res_69118 = zs_res_69122;\n                    }\n                    zm_res_69123 = d_haversine_res_69116 - d_haversine_res_69097;\n                    cos_res_69124 = futrts_cos64(zm_res_69123);\n                    zm_res_69125 = 1.0 - cos_res_69124;\n                    cos_res_69126 = futrts_cos64(d_haversine_res_69116);\n                    zt_res_69127 = cos_res_69101 * cos_res_69126;\n                    zm_res_69128 = d_haversine_res_69117 - d_haversine_res_69118;\n                    zm_res_69129 = 1.0 - zm_res_69128;\n                    zt_res_69130 = zt_res_69127 * zm_res_69129;\n                    zp_res_69131 = zm_res_69125 + zt_res_69130;\n                    zs_res_69132 = zp_res_69131 / 2.0;\n                    min_res_69133 = fmin64(1.0, zs_res_69132);\n                    zt_res_69134 = 2.0 * min_res_69133;\n                    zm_res_69135 = 1.0 - zt_res_69134;\n                    acos_res_69136 = futrts_acos64(zm_res_69135);\n                    zt_res_69137 = clBase_36773 * acos_res_69136;\n                    dist_res_69109 = zt_res_69137;\n                }\n                zlze_res_69138 = dist_res_69109 <= clBase_36767;\n                if (clBase_36766 == (int8_t) 0) {\n                    bool zeze_res_69140;\n                    double d_euclidean_res_69141;\n                    \n                    zeze_res_69140 = eta_p_69104 == zp_res_69087;\n                    if (zeze_res_69140) {\n                        double zm_res_69142;\n                        double abs_res_69143;\n                        \n                        zm_res_69142 = eta_p_69105 - eta_p_69105;\n                        abs_res_69143 = fabs64(zm_res_69142);\n                        d_euclidean_res_69141 = abs_res_69143;\n                    } else {\n                        double zm_res_69144;\n                        double abs_res_69145;\n                        \n                        zm_res_69144 = eta_p_69104 - zp_res_69087;\n                        abs_res_69145 = fabs64",
                                    "(zm_res_69144);\n                        d_euclidean_res_69141 = abs_res_69145;\n                    }\n                    dist_res_69139 = d_euclidean_res_69141;\n                } else {\n                    double d_haversine_res_69146;\n                    double d_haversine_res_69147;\n                    double d_haversine_res_69148;\n                    double zm_res_69153;\n                    double cos_res_69154;\n                    double zm_res_69155;\n                    double cos_res_69156;\n                    double zt_res_69157;\n                    double zm_res_69158;\n                    double zm_res_69159;\n                    double zt_res_69160;\n                    double zp_res_69161;\n                    double zs_res_69162;\n                    double min_res_69163;\n                    double zt_res_69164;\n                    double zm_res_69165;\n                    double acos_res_69166;\n                    double zt_res_69167;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_69146 = eta_p_69104;\n                        d_haversine_res_69147 = eta_p_69105;\n                        d_haversine_res_69148 = eta_p_69105;\n                    } else {\n                        double zt_res_69149;\n                        double zs_res_69150;\n                        double zt_res_69151;\n                        double zs_res_69152;\n                        \n                        zt_res_69149 = 3.141592653589793 * eta_p_69104;\n                        zs_res_69150 = zt_res_69149 / 180.0;\n                        zt_res_69151 = 3.141592653589793 * eta_p_69105;\n                        zs_res_69152 = zt_res_69151 / 180.0;\n                        d_haversine_res_69146 = zs_res_69150;\n                        d_haversine_res_69147 = zs_res_69152;\n                        d_haversine_res_69148 = zs_res_69152;\n                    }\n                    zm_res_69153 = d_haversine_res_69146 - d_haversine_res_690", "98;\n                    cos_res_69154 = futrts_cos64(zm_res_69153);\n                    zm_res_69155 = 1.0 - cos_res_69154;\n                    cos_res_69156 = futrts_cos64(d_haversine_res_69146);\n                    zt_res_69157 = cos_res_69102 * cos_res_69156;\n                    zm_res_69158 = d_haversine_res_69147 - d_haversine_res_69148;\n                    zm_res_69159 = 1.0 - zm_res_69158;\n                    zt_res_69160 = zt_res_69157 * zm_res_69159;\n                    zp_res_69161 = zm_res_69155 + zt_res_69160;\n                    zs_res_69162 = zp_res_69161 / 2.0;\n                    min_res_69163 = fmin64(1.0, zs_res_69162);\n                    zt_res_69164 = 2.0 * min_res_69163;\n                    zm_res_69165 = 1.0 - zt_res_69164;\n                    acos_res_69166 = futrts_acos64(zm_res_69165);\n                    zt_res_69167 = clBase_36773 * acos_res_69166;\n                    dist_res_69139 = zt_res_69167;\n                }\n                zlze_res_69168 = dist_res_69139 <= clBase_36767;\n                x_69169 = !zlze_res_69138;\n                y_69170 = zlze_res_69168 && x_69169;\n                cond_t_res_69171 = zlze_res_69138 || y_69170;\n                x_69172 = x_69108 && cond_t_res_69171;\n                zgze_res_69173 = zp_res_69081 <= eta_p_69104;\n                zlze_res_69174 = eta_p_69104 <= zp_res_69087;\n                x_69175 = zgze_res_69173 && zlze_res_69174;\n                if (clBase_36766 == (int8_t) 0) {\n                    double zm_res_69177;\n                    double abs_res_69178;\n                    \n                    zm_res_69177 = eta_p_69105 - zp_res_69086;\n                    abs_res_69178 = fabs64(zm_res_69177);\n                    dist_res_69176 = abs_res_69178;\n                } else {\n                    double d_haversine_res_69179;\n                    double d_haversine_res_69180;\n                    double d_haversine_res_69181;\n                    double zm_res_69186;\n                    double cos_res_69", "187;\n                    double zm_res_69188;\n                    double cos_res_69189;\n                    double cos_res_69190;\n                    double zt_res_69191;\n                    double zm_res_69192;\n                    double zm_res_69193;\n                    double zt_res_69194;\n                    double zp_res_69195;\n                    double zs_res_69196;\n                    double min_res_69197;\n                    double zt_res_69198;\n                    double zm_res_69199;\n                    double acos_res_69200;\n                    double zt_res_69201;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_69179 = eta_p_69104;\n                        d_haversine_res_69180 = eta_p_69105;\n                        d_haversine_res_69181 = eta_p_69104;\n                    } else {\n                        double zt_res_69182;\n                        double zs_res_69183;\n                        double zt_res_69184;\n                        double zs_res_69185;\n                        \n                        zt_res_69182 = 3.141592653589793 * eta_p_69104;\n                        zs_res_69183 = zt_res_69182 / 180.0;\n                        zt_res_69184 = 3.141592653589793 * eta_p_69105;\n                        zs_res_69185 = zt_res_69184 / 180.0;\n                        d_haversine_res_69179 = zs_res_69183;\n                        d_haversine_res_69180 = zs_res_69185;\n                        d_haversine_res_69181 = zs_res_69183;\n                    }\n                    zm_res_69186 = d_haversine_res_69179 - d_haversine_res_69181;\n                    cos_res_69187 = futrts_cos64(zm_res_69186);\n                    zm_res_69188 = 1.0 - cos_res_69187;\n                    cos_res_69189 = futrts_cos64(d_haversine_res_69181);\n                    cos_res_69190 = futrts_cos64(d_haversine_res_69179);\n                    zt_res_69191 = cos_res_69189 * cos_res_69190;\n                    zm_res_69192 = d",
                                    "_haversine_res_69180 - d_haversine_res_69099;\n                    zm_res_69193 = 1.0 - zm_res_69192;\n                    zt_res_69194 = zt_res_69191 * zm_res_69193;\n                    zp_res_69195 = zm_res_69188 + zt_res_69194;\n                    zs_res_69196 = zp_res_69195 / 2.0;\n                    min_res_69197 = fmin64(1.0, zs_res_69196);\n                    zt_res_69198 = 2.0 * min_res_69197;\n                    zm_res_69199 = 1.0 - zt_res_69198;\n                    acos_res_69200 = futrts_acos64(zm_res_69199);\n                    zt_res_69201 = clBase_36773 * acos_res_69200;\n                    dist_res_69176 = zt_res_69201;\n                }\n                zlze_res_69202 = dist_res_69176 <= clBase_36767;\n                if (clBase_36766 == (int8_t) 0) {\n                    double zm_res_69204;\n                    double abs_res_69205;\n                    \n                    zm_res_69204 = eta_p_69105 - zp_res_69088;\n                    abs_res_69205 = fabs64(zm_res_69204);\n                    dist_res_69203 = abs_res_69205;\n                } else {\n                    double d_haversine_res_69206;\n                    double d_haversine_res_69207;\n                    double d_haversine_res_69208;\n                    double zm_res_69213;\n                    double cos_res_69214;\n                    double zm_res_69215;\n                    double cos_res_69216;\n                    double cos_res_69217;\n                    double zt_res_69218;\n                    double zm_res_69219;\n                    double zm_res_69220;\n                    double zt_res_69221;\n                    double zp_res_69222;\n                    double zs_res_69223;\n                    double min_res_69224;\n                    double zt_res_69225;\n                    double zm_res_69226;\n                    double acos_res_69227;\n                    double zt_res_69228;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_r", "es_69206 = eta_p_69104;\n                        d_haversine_res_69207 = eta_p_69105;\n                        d_haversine_res_69208 = eta_p_69104;\n                    } else {\n                        double zt_res_69209;\n                        double zs_res_69210;\n                        double zt_res_69211;\n                        double zs_res_69212;\n                        \n                        zt_res_69209 = 3.141592653589793 * eta_p_69104;\n                        zs_res_69210 = zt_res_69209 / 180.0;\n                        zt_res_69211 = 3.141592653589793 * eta_p_69105;\n                        zs_res_69212 = zt_res_69211 / 180.0;\n                        d_haversine_res_69206 = zs_res_69210;\n                        d_haversine_res_69207 = zs_res_69212;\n                        d_haversine_res_69208 = zs_res_69210;\n                    }\n                    zm_res_69213 = d_haversine_res_69206 - d_haversine_res_69208;\n                    cos_res_69214 = futrts_cos64(zm_res_69213);\n                    zm_res_69215 = 1.0 - cos_res_69214;\n                    cos_res_69216 = futrts_cos64(d_haversine_res_69208);\n                    cos_res_69217 = futrts_cos64(d_haversine_res_69206);\n                    zt_res_69218 = cos_res_69216 * cos_res_69217;\n                    zm_res_69219 = d_haversine_res_69207 - d_haversine_res_69100;\n                    zm_res_69220 = 1.0 - zm_res_69219;\n                    zt_res_69221 = zt_res_69218 * zm_res_69220;\n                    zp_res_69222 = zm_res_69215 + zt_res_69221;\n                    zs_res_69223 = zp_res_69222 / 2.0;\n                    min_res_69224 = fmin64(1.0, zs_res_69223);\n                    zt_res_69225 = 2.0 * min_res_69224;\n                    zm_res_69226 = 1.0 - zt_res_69225;\n                    acos_res_69227 = futrts_acos64(zm_res_69226);\n                    zt_res_69228 = clBase_36773 * acos_res_69227;\n                    dist_res_69203 = zt_res_69228;\n                }\n                zlze_res_69229 = dist", "_res_69203 <= clBase_36767;\n                x_69230 = !zlze_res_69202;\n                y_69231 = zlze_res_69229 && x_69230;\n                cond_f_res_t_res_69232 = zlze_res_69202 || y_69231;\n                x_69233 = x_69175 && cond_f_res_t_res_69232;\n                x_69234 = !x_69172;\n                y_69235 = x_69233 && x_69234;\n                cond_69236 = x_69172 || y_69235;\n                zlze_res_69237 = eta_p_69104 <= zp_res_69081;\n                if (zlze_res_69237) {\n                    corn_x_69238 = zp_res_69081;\n                } else {\n                    corn_x_69238 = zp_res_69087;\n                }\n                zlze_res_69239 = eta_p_69105 <= zp_res_69086;\n                if (zlze_res_69239) {\n                    corn_y_69240 = zp_res_69086;\n                } else {\n                    corn_y_69240 = zp_res_69088;\n                }\n                if (clBase_36766 == (int8_t) 0) {\n                    bool eq_x_y_69242;\n                    bool eq_x_zz_69243;\n                    bool p_and_eq_x_y_69244;\n                    bool not_p_69245;\n                    bool p_and_eq_x_y_69246;\n                    bool zeze_res_69247;\n                    double d_euclidean_res_69248;\n                    \n                    eq_x_y_69242 = eta_p_69104 == zp_res_69081;\n                    eq_x_zz_69243 = eta_p_69104 == zp_res_69087;\n                    p_and_eq_x_y_69244 = zlze_res_69237 && eq_x_y_69242;\n                    not_p_69245 = !zlze_res_69237;\n                    p_and_eq_x_y_69246 = eq_x_zz_69243 && not_p_69245;\n                    zeze_res_69247 = p_and_eq_x_y_69244 || p_and_eq_x_y_69246;\n                    if (zeze_res_69247) {\n                        double zm_res_69249;\n                        double abs_res_69250;\n                        \n                        zm_res_69249 = eta_p_69105 - corn_y_69240;\n                        abs_res_69250 = fabs64(zm_res_69249);\n                        d_euclidean_res_69248 = abs_res_69250;\n            ",
                                    "        } else {\n                        bool eq_x_y_69251;\n                        bool eq_x_zz_69252;\n                        bool p_and_eq_x_y_69253;\n                        bool not_p_69254;\n                        bool p_and_eq_x_y_69255;\n                        bool zeze_res_69256;\n                        double d_euclidean_res_f_res_69257;\n                        \n                        eq_x_y_69251 = eta_p_69105 == zp_res_69086;\n                        eq_x_zz_69252 = eta_p_69105 == zp_res_69088;\n                        p_and_eq_x_y_69253 = zlze_res_69239 && eq_x_y_69251;\n                        not_p_69254 = !zlze_res_69239;\n                        p_and_eq_x_y_69255 = eq_x_zz_69252 && not_p_69254;\n                        zeze_res_69256 = p_and_eq_x_y_69253 || p_and_eq_x_y_69255;\n                        if (zeze_res_69256) {\n                            double zm_res_69258;\n                            double abs_res_69259;\n                            \n                            zm_res_69258 = eta_p_69104 - corn_x_69238;\n                            abs_res_69259 = fabs64(zm_res_69258);\n                            d_euclidean_res_f_res_69257 = abs_res_69259;\n                        } else {\n                            double zm_res_69260;\n                            double zm_res_69261;\n                            double hypot_res_69262;\n                            \n                            zm_res_69260 = eta_p_69105 - corn_y_69240;\n                            zm_res_69261 = eta_p_69104 - corn_x_69238;\n                            hypot_res_69262 = futrts_hypot64(zm_res_69261, zm_res_69260);\n                            d_euclidean_res_f_res_69257 = hypot_res_69262;\n                        }\n                        d_euclidean_res_69248 = d_euclidean_res_f_res_69257;\n                    }\n                    dist_res_69241 = d_euclidean_res_69248;\n                } else {\n                    double d_haversine_res_69263;\n                    double d_haversi", "ne_res_69264;\n                    double d_haversine_res_69265;\n                    double d_haversine_res_69266;\n                    double zm_res_69275;\n                    double cos_res_69276;\n                    double zm_res_69277;\n                    double cos_res_69278;\n                    double cos_res_69279;\n                    double zt_res_69280;\n                    double zm_res_69281;\n                    double zm_res_69282;\n                    double zt_res_69283;\n                    double zp_res_69284;\n                    double zs_res_69285;\n                    double min_res_69286;\n                    double zt_res_69287;\n                    double zm_res_69288;\n                    double acos_res_69289;\n                    double zt_res_69290;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_69263 = eta_p_69104;\n                        d_haversine_res_69264 = eta_p_69105;\n                        d_haversine_res_69265 = corn_x_69238;\n                        d_haversine_res_69266 = corn_y_69240;\n                    } else {\n                        double zt_res_69267;\n                        double zs_res_69268;\n                        double zt_res_69269;\n                        double zs_res_69270;\n                        double zt_res_69271;\n                        double zs_res_69272;\n                        double zt_res_69273;\n                        double zs_res_69274;\n                        \n                        zt_res_69267 = 3.141592653589793 * eta_p_69104;\n                        zs_res_69268 = zt_res_69267 / 180.0;\n                        zt_res_69269 = 3.141592653589793 * eta_p_69105;\n                        zs_res_69270 = zt_res_69269 / 180.0;\n                        zt_res_69271 = 3.141592653589793 * corn_x_69238;\n                        zs_res_69272 = zt_res_69271 / 180.0;\n                        zt_res_69273 = 3.141592653589793 * corn_y_69240;\n                ", "        zs_res_69274 = zt_res_69273 / 180.0;\n                        d_haversine_res_69263 = zs_res_69268;\n                        d_haversine_res_69264 = zs_res_69270;\n                        d_haversine_res_69265 = zs_res_69272;\n                        d_haversine_res_69266 = zs_res_69274;\n                    }\n                    zm_res_69275 = d_haversine_res_69263 - d_haversine_res_69265;\n                    cos_res_69276 = futrts_cos64(zm_res_69275);\n                    zm_res_69277 = 1.0 - cos_res_69276;\n                    cos_res_69278 = futrts_cos64(d_haversine_res_69265);\n                    cos_res_69279 = futrts_cos64(d_haversine_res_69263);\n                    zt_res_69280 = cos_res_69278 * cos_res_69279;\n                    zm_res_69281 = d_haversine_res_69264 - d_haversine_res_69266;\n                    zm_res_69282 = 1.0 - zm_res_69281;\n                    zt_res_69283 = zt_res_69280 * zm_res_69282;\n                    zp_res_69284 = zm_res_69277 + zt_res_69283;\n                    zs_res_69285 = zp_res_69284 / 2.0;\n                    min_res_69286 = fmin64(1.0, zs_res_69285);\n                    zt_res_69287 = 2.0 * min_res_69286;\n                    zm_res_69288 = 1.0 - zt_res_69287;\n                    acos_res_69289 = futrts_acos64(zm_res_69288);\n                    zt_res_69290 = clBase_36773 * acos_res_69289;\n                    dist_res_69241 = zt_res_69290;\n                }\n                zlze_res_69291 = dist_res_69241 <= clBase_36767;\n                x_69292 = !cond_69236;\n                y_69293 = zlze_res_69291 && x_69292;\n                is_pt_marginal_res_69294 = cond_69236 || y_69293;\n                defunc_0_op_res_69297 = is_pt_marginal_res_69294 || redout_81496;\n                redout_tmp_83670 = defunc_0_op_res_69297;\n                redout_81496 = redout_tmp_83670;\n            }\n            defunc_0_reduce_res_69103 = redout_81496;\n            defunc_0_f_res_69070 = defunc_0_reduce_res_69103;\n        }\n        defunc_0_f_res_6",
                                    "9298 = btoi_bool_i64(defunc_0_f_res_69070);\n        ((__global int64_t *) mem_82010)[gtid_69063] = defunc_0_f_res_69298;\n        ((__global int64_t *) mem_82011)[gtid_69063] = defunc_0_f_res_69069;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_69059\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_69319_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_69319(__global int *global_failure, int64_t m_f_res_59848, int64_t num_tblocks_69324, int32_t virt_num_tblocks_83775, __global unsigned char *ext_mem_82066, __global unsigned char *ext_mem_82067, __global unsigned char *ext_mem_82068, __global unsigned char *mem_82070)\n{\n    #define segmap_tblock_sizze_69322 (add_next_partition_doublezisegmap_69319zisegmap_tblock_sizze_69322)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83777;\n    int32_t tblock_sizze_83780;\n    int32_t wave_sizze_83779;\n    int32_t block_id_83778;\n    int32_t global_tid_83776;\n    int64_t phys_tid_69319;\n    int32_t phys_tblock_id_83781;\n    int32_t iterations_83782;\n    \n    local_tid_83777 = get_local_id(0);\n    tblock_sizze_83780 = get_local_size(0);\n    wave_sizze_83779 = LOCKSTEP_WIDTH;\n    block_id_83778 = get_tblock_id(0);\n    global_tid_83776 = block_id_83778 * tblock_sizze_83780 + local_tid_83777;\n    phys_tid_69319 = sext_i32_i64(global_tid_83776);\n    phys_tblock_id_83781 = get_tblock_id(0);\n    iterations_83782 = sdiv_up32(virt_num_tblocks_83775 - phys_tblock_id_83781, sext_i64_i32(num_tblocks_69324));\n    for (int32_t i_83783 = 0; i_83783 < iterations_83782; i_83783++) {\n        int32_t virt_tblock_id_83784;\n        int64_t global_tid_83785;\n        int64_t slice_83786;\n        int64_t write_i_69318;\n        int64_t remnant_83787;\n        \n        virt_tblock_id_83784 = phys_tblock_id_83781 + i_83783 * sext_i64_i32(num_tblocks_69324);\n        global_tid_83785 = sext_i32_i64(virt_tblock_id_83784) * segmap_tblock_sizze_69322 + sext_i32_i64(local_tid_83777);\n        slice_83786 = (int6", "4_t) 8;\n        write_i_69318 = global_tid_83785;\n        remnant_83787 = global_tid_83785 - write_i_69318;\n        if (slt64(write_i_69318, (int64_t) 8)) {\n            int64_t eta_p_64017;\n            int64_t write_value_64019;\n            bool cond_64020;\n            int64_t lifted_lambda_res_64021;\n            \n            eta_p_64017 = ((__global int64_t *) ext_mem_82067)[write_i_69318];\n            write_value_64019 = ((__global int64_t *) ext_mem_82066)[write_i_69318];\n            cond_64020 = eta_p_64017 == (int64_t) 1;\n            if (cond_64020) {\n                int64_t eta_p_64018;\n                int64_t lifted_lambda_res_t_res_66348;\n                \n                eta_p_64018 = ((__global int64_t *) ext_mem_82068)[write_i_69318];\n                lifted_lambda_res_t_res_66348 = sub64(eta_p_64018, (int64_t) 1);\n                lifted_lambda_res_64021 = lifted_lambda_res_t_res_66348;\n            } else {\n                lifted_lambda_res_64021 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64021) && slt64(lifted_lambda_res_64021, m_f_res_59848)) {\n                ((__global int64_t *) mem_82070)[lifted_lambda_res_64021] = write_value_64019;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_69322\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_69335_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_69335(__global int *global_failure, int64_t dz2083U_36759, int64_t conc_tmp_59874, int64_t m_59900, int64_t num_tblocks_69340, int32_t virt_num_tblocks_84090, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_82070, __global unsigned char *mem_82076, __global unsigned char *mem_82078, __global unsigned char *mem_82080)\n{\n    #define segmap_tblock_sizze_69338 (add_next_partition_doublezisegmap_69335zisegmap_tblock_sizze_69338)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_", "84092;\n    int32_t tblock_sizze_84095;\n    int32_t wave_sizze_84094;\n    int32_t block_id_84093;\n    int32_t global_tid_84091;\n    int64_t phys_tid_69335;\n    int32_t phys_tblock_id_84096;\n    int32_t iterations_84097;\n    \n    local_tid_84092 = get_local_id(0);\n    tblock_sizze_84095 = get_local_size(0);\n    wave_sizze_84094 = LOCKSTEP_WIDTH;\n    block_id_84093 = get_tblock_id(0);\n    global_tid_84091 = block_id_84093 * tblock_sizze_84095 + local_tid_84092;\n    phys_tid_69335 = sext_i32_i64(global_tid_84091);\n    phys_tblock_id_84096 = get_tblock_id(0);\n    iterations_84097 = sdiv_up32(virt_num_tblocks_84090 - phys_tblock_id_84096, sext_i64_i32(num_tblocks_69340));\n    for (int32_t i_84098 = 0; i_84098 < iterations_84097; i_84098++) {\n        int32_t virt_tblock_id_84099;\n        int64_t global_tid_84100;\n        int64_t slice_84101;\n        int64_t write_i_69334;\n        int64_t remnant_84102;\n        \n        virt_tblock_id_84099 = phys_tblock_id_84096 + i_84098 * sext_i64_i32(num_tblocks_69340);\n        global_tid_84100 = sext_i32_i64(virt_tblock_id_84099) * segmap_tblock_sizze_69338 + sext_i32_i64(local_tid_84092);\n        slice_84101 = conc_tmp_59874;\n        write_i_69334 = global_tid_84100;\n        remnant_84102 = global_tid_84100 - write_i_69334;\n        if (slt64(write_i_69334, conc_tmp_59874)) {\n            int64_t eta_p_63999;\n            bool index_concat_cmp_77758;\n            int64_t index_concat_branch_77762;\n            bool cond_64002;\n            int64_t lifted_lambda_res_64003;\n            \n            eta_p_63999 = ((__global int64_t *) mem_82078)[write_i_69334];\n            index_concat_cmp_77758 = sle64(dz2083U_36759, write_i_69334);\n            if (index_concat_cmp_77758) {\n                int64_t index_concat_i_77759;\n                int64_t index_concat_77760;\n                \n                index_concat_i_77759 = sub64(write_i_69334, dz2083U_36759);\n                index_concat_77760 = ((__global int64_t *) mem_82070)[index_concat_i_77759",
                                    "];\n                index_concat_branch_77762 = index_concat_77760;\n            } else {\n                int64_t index_concat_77761 = ((__global int64_t *) clProc_mem_81938)[write_i_69334];\n                \n                index_concat_branch_77762 = index_concat_77761;\n            }\n            cond_64002 = eta_p_63999 == (int64_t) 1;\n            if (cond_64002) {\n                int64_t eta_p_64000;\n                int64_t lifted_lambda_res_t_res_66350;\n                \n                eta_p_64000 = ((__global int64_t *) mem_82076)[write_i_69334];\n                lifted_lambda_res_t_res_66350 = sub64(eta_p_64000, (int64_t) 1);\n                lifted_lambda_res_64003 = lifted_lambda_res_t_res_66350;\n            } else {\n                lifted_lambda_res_64003 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64003) && slt64(lifted_lambda_res_64003, m_59900)) {\n                ((__global int64_t *) mem_82080)[lifted_lambda_res_64003] = index_concat_branch_77762;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_69338\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_70504_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_70504(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36767, double clBase_36773, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *ext_mem_82110, __global unsigned char *mem_82112)\n{\n    #define segmap_tblock_sizze_70500 (add_next_partition_doublezisegmap_70504zisegmap_tblock_sizze_70500)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84195;\n    int", "32_t tblock_sizze_84198;\n    int32_t wave_sizze_84197;\n    int32_t block_id_84196;\n    int32_t global_tid_84194;\n    int64_t phys_tid_70504;\n    int64_t global_tid_84199;\n    int64_t slice_84200;\n    int64_t gtid_70503;\n    int64_t remnant_84201;\n    \n    local_tid_84195 = get_local_id(0);\n    tblock_sizze_84198 = get_local_size(0);\n    wave_sizze_84197 = LOCKSTEP_WIDTH;\n    block_id_84196 = get_tblock_id(0);\n    global_tid_84194 = block_id_84196 * tblock_sizze_84198 + local_tid_84195;\n    phys_tid_70504 = sext_i32_i64(global_tid_84194);\n    global_tid_84199 = sext_i32_i64(block_id_84196) * segmap_tblock_sizze_70500 + sext_i32_i64(local_tid_84195);\n    slice_84200 = n_new_36762;\n    gtid_70503 = global_tid_84199;\n    remnant_84201 = global_tid_84199 - gtid_70503;\n    if (slt64(gtid_70503, n_new_36762)) {\n        bool eta_p_70505;\n        bool defunc_0_f_res_70508;\n        \n        eta_p_70505 = ((__global bool *) ext_mem_82110)[gtid_70503];\n        if (eta_p_70505) {\n            double eta_p_70506;\n            double eta_p_70507;\n            bool defunc_0_reduce_res_70509;\n            bool redout_81502;\n            \n            eta_p_70506 = ((__global double *) new_xs_mem_81952)[gtid_70503];\n            eta_p_70507 = ((__global double *) new_ys_mem_81953)[gtid_70503];\n            redout_81502 = 0;\n            for (int64_t i_81503 = 0; i_81503 < (int64_t) 8; i_81503++) {\n                int64_t eta_p_70510;\n                bool cond_70511;\n                bool defunc_0_f_res_70512;\n                bool defunc_0_op_res_70728;\n                bool redout_tmp_84202;\n                \n                eta_p_70510 = ((__global int64_t *) mem_82001)[i_81503];\n                cond_70511 = slt64(eta_p_70510, (int64_t) 0);\n                if (cond_70511) {\n                    defunc_0_f_res_70512 = 0;\n                } else {\n                    int64_t zv_rhs_70513;\n                    bool zzero_70514;\n                    bool nonzzero_70515;\n                    bool nonzzer", "o_cert_70516;\n                    int64_t nxid_70517;\n                    int64_t nyid_70518;\n                    double times_arg1_70519;\n                    double i64_res_70520;\n                    double zt_res_70521;\n                    double plus_arg0_70522;\n                    double zp_res_70523;\n                    double times_arg1_70524;\n                    double i64_res_70525;\n                    double zt_res_70526;\n                    double plus_arg0_70527;\n                    double zp_res_70528;\n                    double zp_res_70529;\n                    double zp_res_70530;\n                    bool zgze_res_70531;\n                    bool zlze_res_70532;\n                    bool x_70533;\n                    double zt_res_70534;\n                    double zt_res_70535;\n                    double dist_res_70536;\n                    bool zlze_res_70567;\n                    double dist_res_70568;\n                    bool zlze_res_70599;\n                    bool x_70600;\n                    bool y_70601;\n                    bool cond_t_res_70602;\n                    bool x_70603;\n                    bool zgze_res_70604;\n                    bool zlze_res_70605;\n                    bool x_70606;\n                    double dist_res_70607;\n                    bool zlze_res_70634;\n                    double dist_res_70635;\n                    bool zlze_res_70662;\n                    bool x_70663;\n                    bool y_70664;\n                    bool cond_f_res_t_res_70665;\n                    bool x_70666;\n                    bool x_70667;\n                    bool y_70668;\n                    bool cond_70669;\n                    bool zlze_res_70670;\n                    double corn_x_70671;\n                    bool zlze_res_70672;\n                    double corn_y_70673;\n                    double dist_res_70674;\n                    bool zlze_res_70722;\n                    bool x_70723;\n                    bool y_70724;\n                    bool is_pt_",
                                    "marginal_res_70725;\n                    \n                    zv_rhs_70513 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n                    zzero_70514 = zv_rhs_70513 == (int64_t) 0;\n                    nonzzero_70515 = !zzero_70514;\n                    if (!nonzzero_70515) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                                ;\n                            }\n                            return;\n                        }\n                    }\n                    nxid_70517 = smod64(eta_p_70510, zv_rhs_70513);\n                    nyid_70518 = sdiv64(eta_p_70510, zv_rhs_70513);\n                    times_arg1_70519 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n                    i64_res_70520 = sitofp_i64_f64(nxid_70517);\n                    zt_res_70521 = times_arg1_70519 * i64_res_70520;\n                    plus_arg0_70522 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n                    zp_res_70523 = zt_res_70521 + plus_arg0_70522;\n                    times_arg1_70524 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n                    i64_res_70525 = sitofp_i64_f64(nyid_70518);\n                    zt_res_70526 = times_arg1_70524 * i64_res_70525;\n                    plus_arg0_70527 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n                    zp_res_70528 = zt_res_70526 + plus_arg0_70527;\n                    zp_res_70529 = times_arg1_70519 + zp_res_70523;\n                    zp_res_70530 = times_arg1_70524 + zp_res_70528;\n                    zgze_res_70531 = zp_res_70528 <= eta_p_70507;\n                    zlze_res_70532 = eta_p_70507 <= zp_res_70530;\n                    x_70533 = zgze_res_70531 && zlze_res_70532;\n                    zt_res_70534 = 3.141592653589793 * eta_p_70506;\n                    zt_res_70535 = 3.141592653589793 * eta_p_70507;\n                    if (clBase_36766 == (int8_t) 0) {\n                        ", "bool zeze_res_70537;\n                        double d_euclidean_res_70538;\n                        \n                        zeze_res_70537 = eta_p_70506 == zp_res_70523;\n                        if (zeze_res_70537) {\n                            double zm_res_70539;\n                            double abs_res_70540;\n                            \n                            zm_res_70539 = eta_p_70507 - eta_p_70507;\n                            abs_res_70540 = fabs64(zm_res_70539);\n                            d_euclidean_res_70538 = abs_res_70540;\n                        } else {\n                            double zm_res_70541;\n                            double abs_res_70542;\n                            \n                            zm_res_70541 = eta_p_70506 - zp_res_70523;\n                            abs_res_70542 = fabs64(zm_res_70541);\n                            d_euclidean_res_70538 = abs_res_70542;\n                        }\n                        dist_res_70536 = d_euclidean_res_70538;\n                    } else {\n                        double d_haversine_res_70543;\n                        double d_haversine_res_70544;\n                        double d_haversine_res_70545;\n                        double d_haversine_res_70546;\n                        double zm_res_70551;\n                        double cos_res_70552;\n                        double zm_res_70553;\n                        double cos_res_70554;\n                        double cos_res_70555;\n                        double zt_res_70556;\n                        double zm_res_70557;\n                        double zm_res_70558;\n                        double zt_res_70559;\n                        double zp_res_70560;\n                        double zs_res_70561;\n                        double min_res_70562;\n                        double zt_res_70563;\n                        double zm_res_70564;\n                        double acos_res_70565;\n                        double zt_res_70566;\n                        \n  ", "                      if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_70543 = eta_p_70506;\n                            d_haversine_res_70544 = eta_p_70507;\n                            d_haversine_res_70545 = zp_res_70523;\n                            d_haversine_res_70546 = eta_p_70507;\n                        } else {\n                            double zs_res_70547;\n                            double zs_res_70548;\n                            double zt_res_70549;\n                            double zs_res_70550;\n                            \n                            zs_res_70547 = zt_res_70534 / 180.0;\n                            zs_res_70548 = zt_res_70535 / 180.0;\n                            zt_res_70549 = 3.141592653589793 * zp_res_70523;\n                            zs_res_70550 = zt_res_70549 / 180.0;\n                            d_haversine_res_70543 = zs_res_70547;\n                            d_haversine_res_70544 = zs_res_70548;\n                            d_haversine_res_70545 = zs_res_70550;\n                            d_haversine_res_70546 = zs_res_70548;\n                        }\n                        zm_res_70551 = d_haversine_res_70543 - d_haversine_res_70545;\n                        cos_res_70552 = futrts_cos64(zm_res_70551);\n                        zm_res_70553 = 1.0 - cos_res_70552;\n                        cos_res_70554 = futrts_cos64(d_haversine_res_70545);\n                        cos_res_70555 = futrts_cos64(d_haversine_res_70543);\n                        zt_res_70556 = cos_res_70554 * cos_res_70555;\n                        zm_res_70557 = d_haversine_res_70544 - d_haversine_res_70546;\n                        zm_res_70558 = 1.0 - zm_res_70557;\n                        zt_res_70559 = zt_res_70556 * zm_res_70558;\n                        zp_res_70560 = zm_res_70553 + zt_res_70559;\n                        zs_res_70561 = zp_res_70560 / 2.0;\n                        min_res_70562 = fmin64(1.0, zs_res_70561);\n                  ",
                                    "      zt_res_70563 = 2.0 * min_res_70562;\n                        zm_res_70564 = 1.0 - zt_res_70563;\n                        acos_res_70565 = futrts_acos64(zm_res_70564);\n                        zt_res_70566 = clBase_36773 * acos_res_70565;\n                        dist_res_70536 = zt_res_70566;\n                    }\n                    zlze_res_70567 = dist_res_70536 <= clBase_36767;\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool zeze_res_70569;\n                        double d_euclidean_res_70570;\n                        \n                        zeze_res_70569 = eta_p_70506 == zp_res_70529;\n                        if (zeze_res_70569) {\n                            double zm_res_70571;\n                            double abs_res_70572;\n                            \n                            zm_res_70571 = eta_p_70507 - eta_p_70507;\n                            abs_res_70572 = fabs64(zm_res_70571);\n                            d_euclidean_res_70570 = abs_res_70572;\n                        } else {\n                            double zm_res_70573;\n                            double abs_res_70574;\n                            \n                            zm_res_70573 = eta_p_70506 - zp_res_70529;\n                            abs_res_70574 = fabs64(zm_res_70573);\n                            d_euclidean_res_70570 = abs_res_70574;\n                        }\n                        dist_res_70568 = d_euclidean_res_70570;\n                    } else {\n                        double d_haversine_res_70575;\n                        double d_haversine_res_70576;\n                        double d_haversine_res_70577;\n                        double d_haversine_res_70578;\n                        double zm_res_70583;\n                        double cos_res_70584;\n                        double zm_res_70585;\n                        double cos_res_70586;\n                        double cos_res_70587;\n                        double zt_res_70588;\n               ", "         double zm_res_70589;\n                        double zm_res_70590;\n                        double zt_res_70591;\n                        double zp_res_70592;\n                        double zs_res_70593;\n                        double min_res_70594;\n                        double zt_res_70595;\n                        double zm_res_70596;\n                        double acos_res_70597;\n                        double zt_res_70598;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_70575 = eta_p_70506;\n                            d_haversine_res_70576 = eta_p_70507;\n                            d_haversine_res_70577 = zp_res_70529;\n                            d_haversine_res_70578 = eta_p_70507;\n                        } else {\n                            double zs_res_70579;\n                            double zs_res_70580;\n                            double zt_res_70581;\n                            double zs_res_70582;\n                            \n                            zs_res_70579 = zt_res_70534 / 180.0;\n                            zs_res_70580 = zt_res_70535 / 180.0;\n                            zt_res_70581 = 3.141592653589793 * zp_res_70529;\n                            zs_res_70582 = zt_res_70581 / 180.0;\n                            d_haversine_res_70575 = zs_res_70579;\n                            d_haversine_res_70576 = zs_res_70580;\n                            d_haversine_res_70577 = zs_res_70582;\n                            d_haversine_res_70578 = zs_res_70580;\n                        }\n                        zm_res_70583 = d_haversine_res_70575 - d_haversine_res_70577;\n                        cos_res_70584 = futrts_cos64(zm_res_70583);\n                        zm_res_70585 = 1.0 - cos_res_70584;\n                        cos_res_70586 = futrts_cos64(d_haversine_res_70577);\n                        cos_res_70587 = futrts_cos64(d_haversine_res_70575);\n                        zt_res", "_70588 = cos_res_70586 * cos_res_70587;\n                        zm_res_70589 = d_haversine_res_70576 - d_haversine_res_70578;\n                        zm_res_70590 = 1.0 - zm_res_70589;\n                        zt_res_70591 = zt_res_70588 * zm_res_70590;\n                        zp_res_70592 = zm_res_70585 + zt_res_70591;\n                        zs_res_70593 = zp_res_70592 / 2.0;\n                        min_res_70594 = fmin64(1.0, zs_res_70593);\n                        zt_res_70595 = 2.0 * min_res_70594;\n                        zm_res_70596 = 1.0 - zt_res_70595;\n                        acos_res_70597 = futrts_acos64(zm_res_70596);\n                        zt_res_70598 = clBase_36773 * acos_res_70597;\n                        dist_res_70568 = zt_res_70598;\n                    }\n                    zlze_res_70599 = dist_res_70568 <= clBase_36767;\n                    x_70600 = !zlze_res_70567;\n                    y_70601 = zlze_res_70599 && x_70600;\n                    cond_t_res_70602 = zlze_res_70567 || y_70601;\n                    x_70603 = x_70533 && cond_t_res_70602;\n                    zgze_res_70604 = zp_res_70523 <= eta_p_70506;\n                    zlze_res_70605 = eta_p_70506 <= zp_res_70529;\n                    x_70606 = zgze_res_70604 && zlze_res_70605;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_70608;\n                        double abs_res_70609;\n                        \n                        zm_res_70608 = eta_p_70507 - zp_res_70528;\n                        abs_res_70609 = fabs64(zm_res_70608);\n                        dist_res_70607 = abs_res_70609;\n                    } else {\n                        double d_haversine_res_70610;\n                        double d_haversine_res_70611;\n                        double d_haversine_res_70612;\n                        double d_haversine_res_70613;\n                        double zm_res_70618;\n                        double cos_res_70619;\n                        double z",
                                    "m_res_70620;\n                        double cos_res_70621;\n                        double cos_res_70622;\n                        double zt_res_70623;\n                        double zm_res_70624;\n                        double zm_res_70625;\n                        double zt_res_70626;\n                        double zp_res_70627;\n                        double zs_res_70628;\n                        double min_res_70629;\n                        double zt_res_70630;\n                        double zm_res_70631;\n                        double acos_res_70632;\n                        double zt_res_70633;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_70610 = eta_p_70506;\n                            d_haversine_res_70611 = eta_p_70507;\n                            d_haversine_res_70612 = eta_p_70506;\n                            d_haversine_res_70613 = zp_res_70528;\n                        } else {\n                            double zs_res_70614;\n                            double zs_res_70615;\n                            double zt_res_70616;\n                            double zs_res_70617;\n                            \n                            zs_res_70614 = zt_res_70534 / 180.0;\n                            zs_res_70615 = zt_res_70535 / 180.0;\n                            zt_res_70616 = 3.141592653589793 * zp_res_70528;\n                            zs_res_70617 = zt_res_70616 / 180.0;\n                            d_haversine_res_70610 = zs_res_70614;\n                            d_haversine_res_70611 = zs_res_70615;\n                            d_haversine_res_70612 = zs_res_70614;\n                            d_haversine_res_70613 = zs_res_70617;\n                        }\n                        zm_res_70618 = d_haversine_res_70610 - d_haversine_res_70612;\n                        cos_res_70619 = futrts_cos64(zm_res_70618);\n                        zm_res_70620 = 1.0 - cos_res_70619;\n                   ", "     cos_res_70621 = futrts_cos64(d_haversine_res_70612);\n                        cos_res_70622 = futrts_cos64(d_haversine_res_70610);\n                        zt_res_70623 = cos_res_70621 * cos_res_70622;\n                        zm_res_70624 = d_haversine_res_70611 - d_haversine_res_70613;\n                        zm_res_70625 = 1.0 - zm_res_70624;\n                        zt_res_70626 = zt_res_70623 * zm_res_70625;\n                        zp_res_70627 = zm_res_70620 + zt_res_70626;\n                        zs_res_70628 = zp_res_70627 / 2.0;\n                        min_res_70629 = fmin64(1.0, zs_res_70628);\n                        zt_res_70630 = 2.0 * min_res_70629;\n                        zm_res_70631 = 1.0 - zt_res_70630;\n                        acos_res_70632 = futrts_acos64(zm_res_70631);\n                        zt_res_70633 = clBase_36773 * acos_res_70632;\n                        dist_res_70607 = zt_res_70633;\n                    }\n                    zlze_res_70634 = dist_res_70607 <= clBase_36767;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_70636;\n                        double abs_res_70637;\n                        \n                        zm_res_70636 = eta_p_70507 - zp_res_70530;\n                        abs_res_70637 = fabs64(zm_res_70636);\n                        dist_res_70635 = abs_res_70637;\n                    } else {\n                        double d_haversine_res_70638;\n                        double d_haversine_res_70639;\n                        double d_haversine_res_70640;\n                        double d_haversine_res_70641;\n                        double zm_res_70646;\n                        double cos_res_70647;\n                        double zm_res_70648;\n                        double cos_res_70649;\n                        double cos_res_70650;\n                        double zt_res_70651;\n                        double zm_res_70652;\n                        double zm_res_70653;\n                    ", "    double zt_res_70654;\n                        double zp_res_70655;\n                        double zs_res_70656;\n                        double min_res_70657;\n                        double zt_res_70658;\n                        double zm_res_70659;\n                        double acos_res_70660;\n                        double zt_res_70661;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_70638 = eta_p_70506;\n                            d_haversine_res_70639 = eta_p_70507;\n                            d_haversine_res_70640 = eta_p_70506;\n                            d_haversine_res_70641 = zp_res_70530;\n                        } else {\n                            double zs_res_70642;\n                            double zs_res_70643;\n                            double zt_res_70644;\n                            double zs_res_70645;\n                            \n                            zs_res_70642 = zt_res_70534 / 180.0;\n                            zs_res_70643 = zt_res_70535 / 180.0;\n                            zt_res_70644 = 3.141592653589793 * zp_res_70530;\n                            zs_res_70645 = zt_res_70644 / 180.0;\n                            d_haversine_res_70638 = zs_res_70642;\n                            d_haversine_res_70639 = zs_res_70643;\n                            d_haversine_res_70640 = zs_res_70642;\n                            d_haversine_res_70641 = zs_res_70645;\n                        }\n                        zm_res_70646 = d_haversine_res_70638 - d_haversine_res_70640;\n                        cos_res_70647 = futrts_cos64(zm_res_70646);\n                        zm_res_70648 = 1.0 - cos_res_70647;\n                        cos_res_70649 = futrts_cos64(d_haversine_res_70640);\n                        cos_res_70650 = futrts_cos64(d_haversine_res_70638);\n                        zt_res_70651 = cos_res_70649 * cos_res_70650;\n                        zm_res_70652 = d_haversine_res_",
                                    "70639 - d_haversine_res_70641;\n                        zm_res_70653 = 1.0 - zm_res_70652;\n                        zt_res_70654 = zt_res_70651 * zm_res_70653;\n                        zp_res_70655 = zm_res_70648 + zt_res_70654;\n                        zs_res_70656 = zp_res_70655 / 2.0;\n                        min_res_70657 = fmin64(1.0, zs_res_70656);\n                        zt_res_70658 = 2.0 * min_res_70657;\n                        zm_res_70659 = 1.0 - zt_res_70658;\n                        acos_res_70660 = futrts_acos64(zm_res_70659);\n                        zt_res_70661 = clBase_36773 * acos_res_70660;\n                        dist_res_70635 = zt_res_70661;\n                    }\n                    zlze_res_70662 = dist_res_70635 <= clBase_36767;\n                    x_70663 = !zlze_res_70634;\n                    y_70664 = zlze_res_70662 && x_70663;\n                    cond_f_res_t_res_70665 = zlze_res_70634 || y_70664;\n                    x_70666 = x_70606 && cond_f_res_t_res_70665;\n                    x_70667 = !x_70603;\n                    y_70668 = x_70666 && x_70667;\n                    cond_70669 = x_70603 || y_70668;\n                    zlze_res_70670 = eta_p_70506 <= zp_res_70523;\n                    if (zlze_res_70670) {\n                        corn_x_70671 = zp_res_70523;\n                    } else {\n                        corn_x_70671 = zp_res_70529;\n                    }\n                    zlze_res_70672 = eta_p_70507 <= zp_res_70528;\n                    if (zlze_res_70672) {\n                        corn_y_70673 = zp_res_70528;\n                    } else {\n                        corn_y_70673 = zp_res_70530;\n                    }\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool eq_x_y_70675;\n                        bool eq_x_zz_70676;\n                        bool p_and_eq_x_y_70677;\n                        bool not_p_70678;\n                        bool p_and_eq_x_y_70679;\n                        bool zeze_res_70680;\n   ", "                     double d_euclidean_res_70681;\n                        \n                        eq_x_y_70675 = eta_p_70506 == zp_res_70523;\n                        eq_x_zz_70676 = eta_p_70506 == zp_res_70529;\n                        p_and_eq_x_y_70677 = zlze_res_70670 && eq_x_y_70675;\n                        not_p_70678 = !zlze_res_70670;\n                        p_and_eq_x_y_70679 = eq_x_zz_70676 && not_p_70678;\n                        zeze_res_70680 = p_and_eq_x_y_70677 || p_and_eq_x_y_70679;\n                        if (zeze_res_70680) {\n                            double zm_res_70682;\n                            double abs_res_70683;\n                            \n                            zm_res_70682 = eta_p_70507 - corn_y_70673;\n                            abs_res_70683 = fabs64(zm_res_70682);\n                            d_euclidean_res_70681 = abs_res_70683;\n                        } else {\n                            bool eq_x_y_70684;\n                            bool eq_x_zz_70685;\n                            bool p_and_eq_x_y_70686;\n                            bool not_p_70687;\n                            bool p_and_eq_x_y_70688;\n                            bool zeze_res_70689;\n                            double d_euclidean_res_f_res_70690;\n                            \n                            eq_x_y_70684 = eta_p_70507 == zp_res_70528;\n                            eq_x_zz_70685 = eta_p_70507 == zp_res_70530;\n                            p_and_eq_x_y_70686 = zlze_res_70672 && eq_x_y_70684;\n                            not_p_70687 = !zlze_res_70672;\n                            p_and_eq_x_y_70688 = eq_x_zz_70685 && not_p_70687;\n                            zeze_res_70689 = p_and_eq_x_y_70686 || p_and_eq_x_y_70688;\n                            if (zeze_res_70689) {\n                                double zm_res_70691;\n                                double abs_res_70692;\n                                \n                                zm_res_70691 = eta_p_705", "06 - corn_x_70671;\n                                abs_res_70692 = fabs64(zm_res_70691);\n                                d_euclidean_res_f_res_70690 = abs_res_70692;\n                            } else {\n                                double zm_res_70693;\n                                double zm_res_70694;\n                                double hypot_res_70695;\n                                \n                                zm_res_70693 = eta_p_70507 - corn_y_70673;\n                                zm_res_70694 = eta_p_70506 - corn_x_70671;\n                                hypot_res_70695 = futrts_hypot64(zm_res_70694, zm_res_70693);\n                                d_euclidean_res_f_res_70690 = hypot_res_70695;\n                            }\n                            d_euclidean_res_70681 = d_euclidean_res_f_res_70690;\n                        }\n                        dist_res_70674 = d_euclidean_res_70681;\n                    } else {\n                        double d_haversine_res_70696;\n                        double d_haversine_res_70697;\n                        double d_haversine_res_70698;\n                        double d_haversine_res_70699;\n                        double zm_res_70706;\n                        double cos_res_70707;\n                        double zm_res_70708;\n                        double cos_res_70709;\n                        double cos_res_70710;\n                        double zt_res_70711;\n                        double zm_res_70712;\n                        double zm_res_70713;\n                        double zt_res_70714;\n                        double zp_res_70715;\n                        double zs_res_70716;\n                        double min_res_70717;\n                        double zt_res_70718;\n                        double zm_res_70719;\n                        double acos_res_70720;\n                        double zt_res_70721;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                        ",
                                    "    d_haversine_res_70696 = eta_p_70506;\n                            d_haversine_res_70697 = eta_p_70507;\n                            d_haversine_res_70698 = corn_x_70671;\n                            d_haversine_res_70699 = corn_y_70673;\n                        } else {\n                            double zs_res_70700;\n                            double zs_res_70701;\n                            double zt_res_70702;\n                            double zs_res_70703;\n                            double zt_res_70704;\n                            double zs_res_70705;\n                            \n                            zs_res_70700 = zt_res_70534 / 180.0;\n                            zs_res_70701 = zt_res_70535 / 180.0;\n                            zt_res_70702 = 3.141592653589793 * corn_x_70671;\n                            zs_res_70703 = zt_res_70702 / 180.0;\n                            zt_res_70704 = 3.141592653589793 * corn_y_70673;\n                            zs_res_70705 = zt_res_70704 / 180.0;\n                            d_haversine_res_70696 = zs_res_70700;\n                            d_haversine_res_70697 = zs_res_70701;\n                            d_haversine_res_70698 = zs_res_70703;\n                            d_haversine_res_70699 = zs_res_70705;\n                        }\n                        zm_res_70706 = d_haversine_res_70696 - d_haversine_res_70698;\n                        cos_res_70707 = futrts_cos64(zm_res_70706);\n                        zm_res_70708 = 1.0 - cos_res_70707;\n                        cos_res_70709 = futrts_cos64(d_haversine_res_70698);\n                        cos_res_70710 = futrts_cos64(d_haversine_res_70696);\n                        zt_res_70711 = cos_res_70709 * cos_res_70710;\n                        zm_res_70712 = d_haversine_res_70697 - d_haversine_res_70699;\n                        zm_res_70713 = 1.0 - zm_res_70712;\n                        zt_res_70714 = zt_res_70711 * zm_res_70713;\n                        zp_res_70715 = zm_res_70708", " + zt_res_70714;\n                        zs_res_70716 = zp_res_70715 / 2.0;\n                        min_res_70717 = fmin64(1.0, zs_res_70716);\n                        zt_res_70718 = 2.0 * min_res_70717;\n                        zm_res_70719 = 1.0 - zt_res_70718;\n                        acos_res_70720 = futrts_acos64(zm_res_70719);\n                        zt_res_70721 = clBase_36773 * acos_res_70720;\n                        dist_res_70674 = zt_res_70721;\n                    }\n                    zlze_res_70722 = dist_res_70674 <= clBase_36767;\n                    x_70723 = !cond_70669;\n                    y_70724 = zlze_res_70722 && x_70723;\n                    is_pt_marginal_res_70725 = cond_70669 || y_70724;\n                    defunc_0_f_res_70512 = is_pt_marginal_res_70725;\n                }\n                defunc_0_op_res_70728 = defunc_0_f_res_70512 || redout_81502;\n                redout_tmp_84202 = defunc_0_op_res_70728;\n                redout_81502 = redout_tmp_84202;\n            }\n            defunc_0_reduce_res_70509 = redout_81502;\n            defunc_0_f_res_70508 = defunc_0_reduce_res_70509;\n        } else {\n            defunc_0_f_res_70508 = 0;\n        }\n        ((__global bool *) mem_82112)[gtid_70503] = defunc_0_f_res_70508;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70500\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_70738_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_70738(__global int *global_failure, int64_t n_old_36753, int64_t y_60421, int64_t num_tblocks_70743, int32_t virt_num_tblocks_83356, __global unsigned char *current_partition_mem_81939, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *current_partition_mem_81942, __global unsigned char *mem_81961, __global unsigned char *mem_81963, __global unsigned char *mem_81965, __global unsigned char *mem_81967, __global unsigned char *mem_81969, __global unsigned char *mem_81970, _", "_global unsigned char *mem_81972)\n{\n    #define segmap_tblock_sizze_70741 (add_next_partition_doublezisegmap_70738zisegmap_tblock_sizze_70741)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83358;\n    int32_t tblock_sizze_83361;\n    int32_t wave_sizze_83360;\n    int32_t block_id_83359;\n    int32_t global_tid_83357;\n    int64_t phys_tid_70738;\n    int32_t phys_tblock_id_83362;\n    int32_t iterations_83363;\n    \n    local_tid_83358 = get_local_id(0);\n    tblock_sizze_83361 = get_local_size(0);\n    wave_sizze_83360 = LOCKSTEP_WIDTH;\n    block_id_83359 = get_tblock_id(0);\n    global_tid_83357 = block_id_83359 * tblock_sizze_83361 + local_tid_83358;\n    phys_tid_70738 = sext_i32_i64(global_tid_83357);\n    phys_tblock_id_83362 = get_tblock_id(0);\n    iterations_83363 = sdiv_up32(virt_num_tblocks_83356 - phys_tblock_id_83362, sext_i64_i32(num_tblocks_70743));\n    for (int32_t i_83364 = 0; i_83364 < iterations_83363; i_83364++) {\n        int32_t virt_tblock_id_83365;\n        int64_t global_tid_83366;\n        int64_t slice_83367;\n        int64_t write_i_70737;\n        int64_t remnant_83368;\n        \n        virt_tblock_id_83365 = phys_tblock_id_83362 + i_83364 * sext_i64_i32(num_tblocks_70743);\n        global_tid_83366 = sext_i32_i64(virt_tblock_id_83365) * segmap_tblock_sizze_70741 + sext_i32_i64(local_tid_83358);\n        slice_83367 = n_old_36753;\n        write_i_70737 = global_tid_83366;\n        remnant_83368 = global_tid_83366 - write_i_70737;\n        if (slt64(write_i_70737, n_old_36753)) {\n            int64_t c_60427;\n            int64_t offset_60428;\n            int64_t offset_60429;\n            double v_60430;\n            double v_60431;\n            bool v_60432;\n            int64_t v_60433;\n            bool is_this_one_60435;\n            bool is_this_one_60436;\n            int64_t this_offset_60437;\n            int64_t total_res_60438;\n            int64_t this_offset_60439;\n            int64_t total_res_60440;\n            \n            c_604",
                                    "27 = ((__global int64_t *) mem_81965)[write_i_70737];\n            offset_60428 = ((__global int64_t *) mem_81961)[write_i_70737];\n            offset_60429 = ((__global int64_t *) mem_81963)[write_i_70737];\n            v_60430 = ((__global double *) current_partition_mem_81940)[write_i_70737];\n            v_60431 = ((__global double *) current_partition_mem_81941)[write_i_70737];\n            v_60432 = ((__global bool *) current_partition_mem_81942)[write_i_70737];\n            v_60433 = ((__global int64_t *) current_partition_mem_81939)[write_i_70737];\n            is_this_one_60435 = c_60427 == (int64_t) 0;\n            is_this_one_60436 = c_60427 == (int64_t) 1;\n            this_offset_60437 = y_60421 + offset_60429;\n            if (is_this_one_60436) {\n                total_res_60438 = this_offset_60437;\n            } else {\n                total_res_60438 = (int64_t) -1;\n            }\n            this_offset_60439 = (int64_t) -1 + offset_60428;\n            if (is_this_one_60435) {\n                total_res_60440 = this_offset_60439;\n            } else {\n                total_res_60440 = total_res_60438;\n            }\n            if (sle64((int64_t) 0, total_res_60440) && slt64(total_res_60440, n_old_36753)) {\n                ((__global double *) mem_81967)[total_res_60440] = v_60430;\n            }\n            if (sle64((int64_t) 0, total_res_60440) && slt64(total_res_60440, n_old_36753)) {\n                ((__global double *) mem_81969)[total_res_60440] = v_60431;\n            }\n            if (sle64((int64_t) 0, total_res_60440) && slt64(total_res_60440, n_old_36753)) {\n                ((__global bool *) mem_81970)[total_res_60440] = v_60432;\n            }\n            if (sle64((int64_t) 0, total_res_60440) && slt64(total_res_60440, n_old_36753)) {\n                ((__global int64_t *) mem_81972)[total_res_60440] = v_60433;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_", "sizze_70741\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_70754_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_70754(__global int *global_failure, int64_t dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, int64_t y_60750, int64_t num_tblocks_70759, int32_t virt_num_tblocks_84203, __global unsigned char *mem_81993, __global unsigned char *mem_82115, __global unsigned char *mem_82117, __global unsigned char *mem_82119)\n{\n    #define segmap_tblock_sizze_70757 (add_next_partition_doublezisegmap_70754zisegmap_tblock_sizze_70757)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84205;\n    int32_t tblock_sizze_84208;\n    int32_t wave_sizze_84207;\n    int32_t block_id_84206;\n    int32_t global_tid_84204;\n    int64_t phys_tid_70754;\n    int32_t phys_tblock_id_84209;\n    int32_t iterations_84210;\n    \n    local_tid_84205 = get_local_id(0);\n    tblock_sizze_84208 = get_local_size(0);\n    wave_sizze_84207 = LOCKSTEP_WIDTH;\n    block_id_84206 = get_tblock_id(0);\n    global_tid_84204 = block_id_84206 * tblock_sizze_84208 + local_tid_84205;\n    phys_tid_70754 = sext_i32_i64(global_tid_84204);\n    phys_tblock_id_84209 = get_tblock_id(0);\n    iterations_84210 = sdiv_up32(virt_num_tblocks_84203 - phys_tblock_id_84209, sext_i64_i32(num_tblocks_70759));\n    for (int32_t i_84211 = 0; i_84211 < iterations_84210; i_84211++) {\n        int32_t virt_tblock_id_84212;\n        int64_t global_tid_84213;\n        int64_t slice_84214;\n        int64_t write_i_70753;\n        int64_t remnant_84215;\n        \n        virt_tblock_id_84212 = phys_tblock_id_84209 + i_84211 * sext_i64_i32(num_tblocks_70759);\n        global_tid_84213 = sext_i32_i64(virt_tblock_id_84212) * segmap_tblock_sizze_70757 + sext_i32_i64(local_tid_84205);\n        slice_84214 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n        write_i_70753 = global_tid_84213;\n        remnant_84215 = global_tid_84213 - write_i_70753;\n        if (slt64(write_i_70753, dzlz7bUZLzpZRz20U", "dz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {\n            int64_t c_60753;\n            int64_t offset_60754;\n            int64_t offset_60755;\n            bool is_this_one_60758;\n            bool is_this_one_60759;\n            int64_t this_offset_60760;\n            int64_t total_res_60761;\n            int64_t this_offset_60762;\n            int64_t total_res_60763;\n            \n            c_60753 = ((__global int64_t *) mem_82119)[write_i_70753];\n            offset_60754 = ((__global int64_t *) mem_82115)[write_i_70753];\n            offset_60755 = ((__global int64_t *) mem_82117)[write_i_70753];\n            is_this_one_60758 = c_60753 == (int64_t) 0;\n            is_this_one_60759 = c_60753 == (int64_t) 1;\n            this_offset_60760 = y_60750 + offset_60755;\n            if (is_this_one_60759) {\n                total_res_60761 = this_offset_60760;\n            } else {\n                total_res_60761 = (int64_t) -1;\n            }\n            this_offset_60762 = (int64_t) -1 + offset_60754;\n            if (is_this_one_60758) {\n                total_res_60763 = this_offset_60762;\n            } else {\n                total_res_60763 = total_res_60761;\n            }\n            if (sle64((int64_t) 0, total_res_60763) && slt64(total_res_60763, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {\n                ((__global int64_t *) mem_81993)[total_res_60763] = write_i_70753;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_70757\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_70807_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_70807(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2080U_36756, int64_t dz2081U_36757, int64_t dz2082U_36758, int64_t dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, int64_t conc_tmp_60489, int64_t conc_tmp_60490, int64_t partition_sizze_60747, __glo",
                                    "bal unsigned char *clProc_mem_81933, __global unsigned char *clProc_mem_81934, __global unsigned char *clProc_mem_81935, __global unsigned char *clProc_mem_81936, __global unsigned char *mem_81967, __global unsigned char *mem_81969, __global unsigned char *mem_81970, __global unsigned char *mem_81972, __global unsigned char *mem_81993, __global unsigned char *mem_82123, __global unsigned char *mem_82125, __global unsigned char *mem_82126, __global unsigned char *mem_82128)\n{\n    #define segmap_tblock_sizze_70800 (add_next_partition_doublezisegmap_70807zisegmap_tblock_sizze_70800)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84218;\n    int32_t tblock_sizze_84221;\n    int32_t wave_sizze_84220;\n    int32_t block_id_84219;\n    int32_t global_tid_84217;\n    int64_t phys_tid_70807;\n    int64_t global_tid_84222;\n    int64_t slice_84223;\n    int64_t gtid_70806;\n    int64_t remnant_84224;\n    \n    local_tid_84218 = get_local_id(0);\n    tblock_sizze_84221 = get_local_size(0);\n    wave_sizze_84220 = LOCKSTEP_WIDTH;\n    block_id_84219 = get_tblock_id(0);\n    global_tid_84217 = block_id_84219 * tblock_sizze_84221 + local_tid_84218;\n    phys_tid_70807 = sext_i32_i64(global_tid_84217);\n    global_tid_84222 = sext_i32_i64(block_id_84219) * segmap_tblock_sizze_70800 + sext_i32_i64(local_tid_84218);\n    slice_84223 = partition_sizze_60747;\n    gtid_70806 = global_tid_84222;\n    remnant_84224 = global_tid_84222 - gtid_70806;\n    if (slt64(gtid_70806, partition_sizze_60747)) {\n        int64_t eta_p_70808;\n        bool x_70809;\n        bool y_70810;\n        bool bounds_check_70811;\n        bool index_certs_70812;\n        bool y_70822;\n        bool bounds_check_70823;\n        bool index_certs_70824;\n        bool y_70830;\n        bool bounds_check_70831;\n        bool index_certs_70832;\n        bool index_concat_cmp_70813;\n        double index_concat_branch_70814;\n        double index_concat_branch_70818;\n        bool index_concat_cmp_70825;\n        bool index_c", "oncat_branch_70826;\n        bool index_concat_cmp_70833;\n        int64_t index_concat_branch_70834;\n        \n        eta_p_70808 = ((__global int64_t *) mem_81993)[gtid_70806];\n        x_70809 = sle64((int64_t) 0, eta_p_70808);\n        y_70810 = slt64(eta_p_70808, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);\n        bounds_check_70811 = x_70809 && y_70810;\n        if (!bounds_check_70811) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_70808;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n                    ;\n                }\n                return;\n            }\n        }\n        y_70822 = slt64(eta_p_70808, conc_tmp_60489);\n        bounds_check_70823 = x_70809 && y_70822;\n        if (!bounds_check_70823) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_70808;\n                    global_failure_args[1] = (int64_t) conc_tmp_60489;\n                    ;\n                }\n                return;\n            }\n        }\n        y_70830 = slt64(eta_p_70808, conc_tmp_60490);\n        bounds_check_70831 = x_70809 && y_70830;\n        if (!bounds_check_70831) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_70808;\n                    global_failure_args[1] = (int64_t) conc_tmp_60490;\n                    ;\n                }\n                return;\n            }\n        }\n        index_concat_cmp_70813 = sle64(dz2082U_36758, eta_p_70808);\n        if (index_concat_cmp_70813) {\n            int64_t index_concat_i_70815;\n            double index_concat_70816;\n            \n            index_concat_i_70815 = sub64(eta_p_70808, dz2082U_36758);\n            index_concat_70816 = ((__g", "lobal double *) mem_81967)[index_concat_i_70815];\n            index_concat_branch_70814 = index_concat_70816;\n        } else {\n            double index_concat_70817 = ((__global double *) clProc_mem_81935)[eta_p_70808];\n            \n            index_concat_branch_70814 = index_concat_70817;\n        }\n        if (index_concat_cmp_70813) {\n            int64_t index_concat_i_70819;\n            double index_concat_70820;\n            \n            index_concat_i_70819 = sub64(eta_p_70808, dz2082U_36758);\n            index_concat_70820 = ((__global double *) mem_81969)[index_concat_i_70819];\n            index_concat_branch_70818 = index_concat_70820;\n        } else {\n            double index_concat_70821 = ((__global double *) clProc_mem_81936)[eta_p_70808];\n            \n            index_concat_branch_70818 = index_concat_70821;\n        }\n        index_concat_cmp_70825 = sle64(dz2080U_36756, eta_p_70808);\n        if (index_concat_cmp_70825) {\n            int64_t index_concat_i_70827;\n            bool index_concat_70828;\n            \n            index_concat_i_70827 = sub64(eta_p_70808, dz2080U_36756);\n            index_concat_70828 = ((__global bool *) mem_81970)[index_concat_i_70827];\n            index_concat_branch_70826 = index_concat_70828;\n        } else {\n            bool index_concat_70829 = ((__global bool *) clProc_mem_81933)[eta_p_70808];\n            \n            index_concat_branch_70826 = index_concat_70829;\n        }\n        index_concat_cmp_70833 = sle64(dz2081U_36757, eta_p_70808);\n        if (index_concat_cmp_70833) {\n            int64_t index_concat_i_70835;\n            int64_t index_concat_70836;\n            \n            index_concat_i_70835 = sub64(eta_p_70808, dz2081U_36757);\n            index_concat_70836 = ((__global int64_t *) mem_81972)[index_concat_i_70835];\n            index_concat_branch_70834 = index_concat_70836;\n        } else {\n            int64_t index_concat_70837 = ((__global int64_t *) clProc_mem_81934)[eta_p_70808];\n            \n      ",
                                    "      index_concat_branch_70834 = index_concat_70837;\n        }\n        ((__global double *) mem_82123)[gtid_70806] = index_concat_branch_70814;\n        ((__global double *) mem_82125)[gtid_70806] = index_concat_branch_70818;\n        ((__global bool *) mem_82126)[gtid_70806] = index_concat_branch_70826;\n        ((__global int64_t *) mem_82128)[gtid_70806] = index_concat_branch_70834;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_70800\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_70875_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_70875(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2081U_36757, int64_t dz2082U_36758, int64_t j_m_i_60456, int64_t dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, int64_t conc_tmp_60490, int64_t partition_sizze_60747, int64_t j_m_i_60776, __global unsigned char *clProc_mem_81934, __global unsigned char *clProc_mem_81935, __global unsigned char *clProc_mem_81936, __global unsigned char *mem_81967, __global unsigned char *mem_81969, __global unsigned char *mem_81972, __global unsigned char *mem_81993, __global unsigned char *mem_82137, __global unsigned char *mem_82139, __global unsigned char *mem_82141)\n{\n    #define segmap_tblock_sizze_70869 (add_next_partition_doublezisegmap_70875zisegmap_tblock_sizze_70869)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84227;\n    int32_t tblock_sizze_84230;\n    int32_t wave_sizze_84229;\n    int32_t block_id_84228;\n    int32_t global_tid_84226;\n    int64_t phys_tid_70875;\n    int64_t global_tid_84231;\n    int64_t slice_84232;\n    int64_t gtid_70874;\n    int64_t remnant_84233;\n    \n    local_tid_84227 = get_local_id(0);\n    tblock_sizze_84230 = get_local_size(0);\n    wave_sizze_84229 = LOCKSTEP_WIDTH;\n    block_id_84228 = get_tblock_id(0);\n    global_tid_84226 = block_id_84228 * tblock_sizze_84230 + local_tid_84227;\n    phys_tid_70875 = sext_i32_i64(global_tid_84226);\n    ", "global_tid_84231 = sext_i32_i64(block_id_84228) * segmap_tblock_sizze_70869 + sext_i32_i64(local_tid_84227);\n    slice_84232 = j_m_i_60776;\n    gtid_70874 = global_tid_84231;\n    remnant_84233 = global_tid_84231 - gtid_70874;\n    if (slt64(gtid_70874, j_m_i_60776)) {\n        int64_t slice_77752;\n        int64_t eta_p_70876;\n        bool x_70877;\n        bool y_70878;\n        bool bounds_check_70879;\n        bool index_certs_70880;\n        bool y_70890;\n        bool bounds_check_70891;\n        bool index_certs_70892;\n        bool index_concat_cmp_70881;\n        double index_concat_branch_70882;\n        double index_concat_branch_70886;\n        bool index_concat_cmp_70893;\n        int64_t index_concat_branch_70894;\n        \n        slice_77752 = partition_sizze_60747 + gtid_70874;\n        eta_p_70876 = ((__global int64_t *) mem_81993)[slice_77752];\n        x_70877 = sle64((int64_t) 0, eta_p_70876);\n        y_70878 = slt64(eta_p_70876, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);\n        bounds_check_70879 = x_70877 && y_70878;\n        if (!bounds_check_70879) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_70876;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n                    ;\n                }\n                return;\n            }\n        }\n        y_70890 = slt64(eta_p_70876, conc_tmp_60490);\n        bounds_check_70891 = x_70877 && y_70890;\n        if (!bounds_check_70891) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_70876;\n                    global_failure_args[1] = (int64_t) conc_tmp_60490;\n                    ;\n                }\n                return;\n            }\n        }\n        index_concat_cmp_70881 = sle64(dz2082U_36758, eta_p_70876);\n        if (inde", "x_concat_cmp_70881) {\n            int64_t index_concat_i_70883;\n            double index_concat_70884;\n            \n            index_concat_i_70883 = sub64(eta_p_70876, dz2082U_36758);\n            index_concat_70884 = ((__global double *) mem_81967)[index_concat_i_70883];\n            index_concat_branch_70882 = index_concat_70884;\n        } else {\n            double index_concat_70885 = ((__global double *) clProc_mem_81935)[eta_p_70876];\n            \n            index_concat_branch_70882 = index_concat_70885;\n        }\n        if (index_concat_cmp_70881) {\n            int64_t index_concat_i_70887;\n            double index_concat_70888;\n            \n            index_concat_i_70887 = sub64(eta_p_70876, dz2082U_36758);\n            index_concat_70888 = ((__global double *) mem_81969)[index_concat_i_70887];\n            index_concat_branch_70886 = index_concat_70888;\n        } else {\n            double index_concat_70889 = ((__global double *) clProc_mem_81936)[eta_p_70876];\n            \n            index_concat_branch_70886 = index_concat_70889;\n        }\n        index_concat_cmp_70893 = sle64(dz2081U_36757, eta_p_70876);\n        if (index_concat_cmp_70893) {\n            int64_t index_concat_i_70895;\n            int64_t index_concat_70896;\n            \n            index_concat_i_70895 = sub64(eta_p_70876, dz2081U_36757);\n            index_concat_70896 = ((__global int64_t *) mem_81972)[index_concat_i_70895];\n            index_concat_branch_70894 = index_concat_70896;\n        } else {\n            int64_t index_concat_70897 = ((__global int64_t *) clProc_mem_81934)[eta_p_70876];\n            \n            index_concat_branch_70894 = index_concat_70897;\n        }\n        ((__global double *) mem_82137)[j_m_i_60456 + gtid_70874] = index_concat_branch_70882;\n        ((__global double *) mem_82139)[j_m_i_60456 + gtid_70874] = index_concat_branch_70886;\n        ((__global int64_t *) mem_82141)[j_m_i_60456 + gtid_70874] = index_concat_branch_70894;\n    }\n    \n  error_0:\n    ret",
                                    "urn;\n    #undef segmap_tblock_sizze_70869\n}\nFUTHARK_KERNEL\nvoid add_next_partition_doublezisegmap_intrablock_68780(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t part_no_36754, int64_t dz2083U_36759, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36767, double clBase_36773, int64_t computed_tblock_sizze_68510, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *clProc_mem_81937, __global unsigned char *clProc_mem_81938, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82013, __global unsigned char *mem_82014, __global unsigned char *mem_82015)\n{\n    volatile __local unsigned char *red_arr_mem_83576_backing_1 = &shared_mem[0];\n    const int64_t red_arr_mem_83576_backing_1_offset = 0 + (n_new_36762 + srem64((int64_t) 8 - srem64(n_new_36762, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_mem_83572_backing_0 = &shared_mem[red_arr_mem_83576_backing_1_offset];\n    const int64_t red_arr_mem_83572_backing_0_offset = red_arr_mem_83576_backing_1_offset + (dz2083U_36759 + srem64((int64_t) 8 - srem64(dz2083U_36759, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83560;\n    int32_t tblock_sizze_83563;\n    int32_t wave_sizze_83562;\n    int32_t block_id_83561;\n    int32_t global_tid_83559;\n    int64_t phys_tblock_id_68780;\n    int64_t slice_83565;\n    int64_t ltid_pre_83564;\n    int64_t remnant_83566;\n    int64_t slice_83568;\n    int64_t ltid_pre_83567;\n    int64_t remnant_83569;\n    int64_t slice_83570;\n    int64_t gtid_68779;\n    int64_t rem", "nant_83571;\n    int64_t eta_p_68781;\n    bool cond_68782;\n    bool lifted_lambda_res_68783;\n    bool defunc_0_reduce_res_68788;\n    int64_t phys_tid_68790;\n    __local unsigned char *red_arr_mem_83572;\n    int64_t gtid_68789;\n    int32_t offset_83574;\n    int32_t skip_waves_83575;\n    bool eta_p_68791;\n    bool eta_p_68792;\n    int64_t lifted_lambda_res_68796;\n    bool cond_68797;\n    int64_t defunc_0_f_res_68798;\n    bool defunc_0_f_res_68799;\n    int64_t defunc_0_f_res_69029;\n    \n    local_tid_83560 = get_local_id(0);\n    tblock_sizze_83563 = get_local_size(0);\n    wave_sizze_83562 = LOCKSTEP_WIDTH;\n    block_id_83561 = get_tblock_id(0);\n    global_tid_83559 = block_id_83561 * tblock_sizze_83563 + local_tid_83560;\n    phys_tblock_id_68780 = sext_i32_i64(block_id_83561);\n    slice_83565 = dz2083U_36759;\n    ltid_pre_83564 = sext_i32_i64(local_tid_83560);\n    remnant_83566 = sext_i32_i64(local_tid_83560) - ltid_pre_83564;\n    slice_83568 = n_new_36762;\n    ltid_pre_83567 = sext_i32_i64(local_tid_83560);\n    remnant_83569 = sext_i32_i64(local_tid_83560) - ltid_pre_83567;\n    slice_83570 = (int64_t) 8;\n    gtid_68779 = sext_i32_i64(block_id_83561);\n    remnant_83571 = sext_i32_i64(block_id_83561) - gtid_68779;\n    eta_p_68781 = ((__global int64_t *) mem_82001)[gtid_68779];\n    cond_68782 = sle64((int64_t) 0, eta_p_68781);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_68782) {\n        bool y_68784;\n        bool bounds_check_68785;\n        bool index_certs_68786;\n        bool lifted_lambda_res_t_res_68787;\n        \n        y_68784 = slt64(eta_p_68781, part_no_36754);\n        bounds_check_68785 = cond_68782 && y_68784;\n        if (!bounds_check_68785) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_68781;\n                    global_failure_args[1] = (int64_t) part_no_36754;\n                    ;\n                }\n                local_failure = 1;\n                ", "goto error_1;\n            }\n        }\n        lifted_lambda_res_t_res_68787 = ((__global bool *) clProc_mem_81937)[eta_p_68781];\n        lifted_lambda_res_68783 = lifted_lambda_res_t_res_68787;\n    } else {\n        lifted_lambda_res_68783 = 0;\n    }\n    phys_tid_68790 = sext_i32_i64(local_tid_83560);\n    red_arr_mem_83572 = (__local unsigned char *) red_arr_mem_83572_backing_0;\n    gtid_68789 = sext_i32_i64(sext_i64_i32(ltid_pre_83564));\n    if (slt64(gtid_68789, dz2083U_36759)) {\n        int64_t eta_p_68794;\n        bool lifted_lambda_res_68795;\n        \n        eta_p_68794 = ((__global int64_t *) clProc_mem_81938)[gtid_68789];\n        lifted_lambda_res_68795 = eta_p_68794 == eta_p_68781;\n        ((__local bool *) red_arr_mem_83572)[gtid_68789] = lifted_lambda_res_68795;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_83575 = 1;\n    offset_83574 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_83560, sext_i64_i32(dz2083U_36759))) {\n            eta_p_68791 = ((__local bool *) red_arr_mem_83572)[sext_i32_i64(local_tid_83560 + offset_83574)];\n        }\n    }\n    offset_83574 = 1;\n    while (slt32(offset_83574, wave_sizze_83562)) {\n        if (slt32(local_tid_83560 + offset_83574, sext_i64_i32(dz2083U_36759)) && ((local_tid_83560 - squot32(local_tid_83560, wave_sizze_83562) * wave_sizze_83562) & (2 * offset_83574 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_68792 = ((volatile __local bool *) red_arr_mem_83572)[sext_i32_i64(local_tid_83560 + offset_83574)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_68793 = eta_p_68791 || eta_p_68792;\n                \n                eta_p_68791 = defunc_0_op_res_68793;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_mem_83572)[",
                                    "sext_i32_i64(local_tid_83560)] = eta_p_68791;\n            }\n        }\n        offset_83574 *= 2;\n    }\n    while (slt32(skip_waves_83575, squot32(sext_i64_i32(computed_tblock_sizze_68510) + wave_sizze_83562 - 1, wave_sizze_83562))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_83574 = skip_waves_83575 * wave_sizze_83562;\n        if (slt32(local_tid_83560 + offset_83574, sext_i64_i32(dz2083U_36759)) && ((local_tid_83560 - squot32(local_tid_83560, wave_sizze_83562) * wave_sizze_83562) == 0 && (squot32(local_tid_83560, wave_sizze_83562) & (2 * skip_waves_83575 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_68792 = ((__local bool *) red_arr_mem_83572)[sext_i32_i64(local_tid_83560 + offset_83574)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_68793 = eta_p_68791 || eta_p_68792;\n                \n                eta_p_68791 = defunc_0_op_res_68793;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_mem_83572)[sext_i32_i64(local_tid_83560)] = eta_p_68791;\n            }\n        }\n        skip_waves_83575 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // Save result of reduction.\n    {\n        defunc_0_reduce_res_68788 = ((__local bool *) red_arr_mem_83572)[(int64_t) 0];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (defunc_0_reduce_res_68788) {\n        lifted_lambda_res_68796 = (int64_t) -1;\n    } else {\n        lifted_lambda_res_68796 = eta_p_68781;\n    }\n    cond_68797 = slt64(lifted_lambda_res_68796, (int64_t) 0);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_68797) {\n        defunc_0_f_res_68798 = (int64_t) -1;\n    } else {\n        defunc_0_f_res_68798 = lifted_lambda_res_68796;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_68797) {\n        defunc_0_f_res_68799 = 0;\n    } else {\n        int64_t zv_rhs_68800;\n        bool zzero_", "68801;\n        bool nonzzero_68802;\n        bool nonzzero_cert_68803;\n        int64_t nxid_68804;\n        int64_t nyid_68805;\n        double times_arg1_68806;\n        double i64_res_68807;\n        double zt_res_68808;\n        double plus_arg0_68809;\n        double zp_res_68810;\n        double times_arg1_68811;\n        double i64_res_68812;\n        double zt_res_68813;\n        double plus_arg0_68814;\n        double zp_res_68815;\n        double zp_res_68816;\n        double zp_res_68817;\n        double zt_res_68818;\n        double zt_res_68819;\n        double zt_res_68820;\n        double zt_res_68821;\n        double zs_res_68822;\n        double zs_res_68823;\n        double zs_res_68824;\n        double zs_res_68825;\n        double d_haversine_res_68826;\n        double d_haversine_res_68827;\n        double d_haversine_res_68828;\n        double d_haversine_res_68829;\n        double cos_res_68830;\n        double cos_res_68831;\n        bool defunc_0_reduce_res_68832;\n        int64_t phys_tid_68834;\n        __local unsigned char *red_arr_mem_83576;\n        int64_t gtid_68833;\n        int32_t offset_83578;\n        int32_t skip_waves_83579;\n        bool eta_p_68835;\n        bool eta_p_68836;\n        \n        zv_rhs_68800 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n        zzero_68801 = zv_rhs_68800 == (int64_t) 0;\n        nonzzero_68802 = !zzero_68801;\n        if (!nonzzero_68802) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    ;\n                }\n                local_failure = 1;\n                goto error_8;\n            }\n        }\n        nxid_68804 = smod64(lifted_lambda_res_68796, zv_rhs_68800);\n        nyid_68805 = sdiv64(lifted_lambda_res_68796, zv_rhs_68800);\n        times_arg1_68806 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n        i64_res_68807 = sitofp_i64_f64(nxid_68804);\n        zt_res_68808 = times_arg1_68806 * i64_res_68807;\n        plus_arg0_68809 = ((__global double *) ", "clBase_mem_81930)[(int64_t) 0];\n        zp_res_68810 = zt_res_68808 + plus_arg0_68809;\n        times_arg1_68811 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n        i64_res_68812 = sitofp_i64_f64(nyid_68805);\n        zt_res_68813 = times_arg1_68811 * i64_res_68812;\n        plus_arg0_68814 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n        zp_res_68815 = zt_res_68813 + plus_arg0_68814;\n        zp_res_68816 = times_arg1_68806 + zp_res_68810;\n        zp_res_68817 = times_arg1_68811 + zp_res_68815;\n        zt_res_68818 = 3.141592653589793 * zp_res_68810;\n        zt_res_68819 = 3.141592653589793 * zp_res_68816;\n        zt_res_68820 = 3.141592653589793 * zp_res_68815;\n        zt_res_68821 = 3.141592653589793 * zp_res_68817;\n        zs_res_68822 = zt_res_68818 / 180.0;\n        zs_res_68823 = zt_res_68819 / 180.0;\n        zs_res_68824 = zt_res_68820 / 180.0;\n        zs_res_68825 = zt_res_68821 / 180.0;\n        \n      error_8:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (clBase_36765 == (int8_t) 1) {\n            d_haversine_res_68826 = zp_res_68810;\n        } else {\n            d_haversine_res_68826 = zs_res_68822;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (clBase_36765 == (int8_t) 1) {\n            d_haversine_res_68827 = zp_res_68816;\n        } else {\n            d_haversine_res_68827 = zs_res_68823;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (clBase_36765 == (int8_t) 1) {\n            d_haversine_res_68828 = zp_res_68815;\n        } else {\n            d_haversine_res_68828 = zs_res_68824;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (clBase_36765 == (int8_t) 1) {\n            d_haversine_res_68829 = zp_res_68817;\n        } else {\n            d_haversine_res_68829 = zs_res_68825;\n        }\n        cos_res_68830 = futrts_cos64(d_haversine_res_68826);\n        cos_res_68831 = futrts_cos64(d_haversine_res_68827);\n        phy",
                                    "s_tid_68834 = sext_i32_i64(local_tid_83560);\n        red_arr_mem_83576 = (__local unsigned char *) red_arr_mem_83576_backing_1;\n        gtid_68833 = sext_i32_i64(sext_i64_i32(ltid_pre_83567));\n        if (slt64(gtid_68833, n_new_36762)) {\n            double eta_p_68838;\n            double eta_p_68839;\n            bool zgze_res_68840;\n            bool zlze_res_68841;\n            bool x_68842;\n            double dist_res_68843;\n            bool zlze_res_68872;\n            double dist_res_68873;\n            bool zlze_res_68902;\n            bool x_68903;\n            bool y_68904;\n            bool cond_t_res_68905;\n            bool x_68906;\n            bool zgze_res_68907;\n            bool zlze_res_68908;\n            bool x_68909;\n            double dist_res_68910;\n            bool zlze_res_68936;\n            double dist_res_68937;\n            bool zlze_res_68963;\n            bool x_68964;\n            bool y_68965;\n            bool cond_f_res_t_res_68966;\n            bool x_68967;\n            bool x_68968;\n            bool y_68969;\n            bool cond_68970;\n            bool zlze_res_68971;\n            double corn_x_68972;\n            bool zlze_res_68973;\n            double corn_y_68974;\n            double dist_res_68975;\n            bool zlze_res_69025;\n            bool x_69026;\n            bool y_69027;\n            bool is_pt_marginal_res_69028;\n            \n            eta_p_68838 = ((__global double *) new_xs_mem_81952)[gtid_68833];\n            eta_p_68839 = ((__global double *) new_ys_mem_81953)[gtid_68833];\n            zgze_res_68840 = zp_res_68815 <= eta_p_68839;\n            zlze_res_68841 = eta_p_68839 <= zp_res_68817;\n            x_68842 = zgze_res_68840 && zlze_res_68841;\n            if (clBase_36766 == (int8_t) 0) {\n                bool zeze_res_68844;\n                double d_euclidean_res_68845;\n                \n                zeze_res_68844 = eta_p_68838 == zp_res_68810;\n                if (zeze_res_68844) {\n                    double zm_res_68846;\n     ", "               double abs_res_68847;\n                    \n                    zm_res_68846 = eta_p_68839 - eta_p_68839;\n                    abs_res_68847 = fabs64(zm_res_68846);\n                    d_euclidean_res_68845 = abs_res_68847;\n                } else {\n                    double zm_res_68848;\n                    double abs_res_68849;\n                    \n                    zm_res_68848 = eta_p_68838 - zp_res_68810;\n                    abs_res_68849 = fabs64(zm_res_68848);\n                    d_euclidean_res_68845 = abs_res_68849;\n                }\n                dist_res_68843 = d_euclidean_res_68845;\n            } else {\n                double d_haversine_res_68850;\n                double d_haversine_res_68851;\n                double d_haversine_res_68852;\n                double zm_res_68857;\n                double cos_res_68858;\n                double zm_res_68859;\n                double cos_res_68860;\n                double zt_res_68861;\n                double zm_res_68862;\n                double zm_res_68863;\n                double zt_res_68864;\n                double zp_res_68865;\n                double zs_res_68866;\n                double min_res_68867;\n                double zt_res_68868;\n                double zm_res_68869;\n                double acos_res_68870;\n                double zt_res_68871;\n                \n                if (clBase_36765 == (int8_t) 1) {\n                    d_haversine_res_68850 = eta_p_68838;\n                    d_haversine_res_68851 = eta_p_68839;\n                    d_haversine_res_68852 = eta_p_68839;\n                } else {\n                    double zt_res_68853;\n                    double zs_res_68854;\n                    double zt_res_68855;\n                    double zs_res_68856;\n                    \n                    zt_res_68853 = 3.141592653589793 * eta_p_68838;\n                    zs_res_68854 = zt_res_68853 / 180.0;\n                    zt_res_68855 = 3.141592653589793 * eta_p_68839;\n                    ", "zs_res_68856 = zt_res_68855 / 180.0;\n                    d_haversine_res_68850 = zs_res_68854;\n                    d_haversine_res_68851 = zs_res_68856;\n                    d_haversine_res_68852 = zs_res_68856;\n                }\n                zm_res_68857 = d_haversine_res_68850 - d_haversine_res_68826;\n                cos_res_68858 = futrts_cos64(zm_res_68857);\n                zm_res_68859 = 1.0 - cos_res_68858;\n                cos_res_68860 = futrts_cos64(d_haversine_res_68850);\n                zt_res_68861 = cos_res_68830 * cos_res_68860;\n                zm_res_68862 = d_haversine_res_68851 - d_haversine_res_68852;\n                zm_res_68863 = 1.0 - zm_res_68862;\n                zt_res_68864 = zt_res_68861 * zm_res_68863;\n                zp_res_68865 = zm_res_68859 + zt_res_68864;\n                zs_res_68866 = zp_res_68865 / 2.0;\n                min_res_68867 = fmin64(1.0, zs_res_68866);\n                zt_res_68868 = 2.0 * min_res_68867;\n                zm_res_68869 = 1.0 - zt_res_68868;\n                acos_res_68870 = futrts_acos64(zm_res_68869);\n                zt_res_68871 = clBase_36773 * acos_res_68870;\n                dist_res_68843 = zt_res_68871;\n            }\n            zlze_res_68872 = dist_res_68843 <= clBase_36767;\n            if (clBase_36766 == (int8_t) 0) {\n                bool zeze_res_68874;\n                double d_euclidean_res_68875;\n                \n                zeze_res_68874 = eta_p_68838 == zp_res_68816;\n                if (zeze_res_68874) {\n                    double zm_res_68876;\n                    double abs_res_68877;\n                    \n                    zm_res_68876 = eta_p_68839 - eta_p_68839;\n                    abs_res_68877 = fabs64(zm_res_68876);\n                    d_euclidean_res_68875 = abs_res_68877;\n                } else {\n                    double zm_res_68878;\n                    double abs_res_68879;\n                    \n                    zm_res_68878 = eta_p_68838 - zp_res_68816;\n                    a",
                                    "bs_res_68879 = fabs64(zm_res_68878);\n                    d_euclidean_res_68875 = abs_res_68879;\n                }\n                dist_res_68873 = d_euclidean_res_68875;\n            } else {\n                double d_haversine_res_68880;\n                double d_haversine_res_68881;\n                double d_haversine_res_68882;\n                double zm_res_68887;\n                double cos_res_68888;\n                double zm_res_68889;\n                double cos_res_68890;\n                double zt_res_68891;\n                double zm_res_68892;\n                double zm_res_68893;\n                double zt_res_68894;\n                double zp_res_68895;\n                double zs_res_68896;\n                double min_res_68897;\n                double zt_res_68898;\n                double zm_res_68899;\n                double acos_res_68900;\n                double zt_res_68901;\n                \n                if (clBase_36765 == (int8_t) 1) {\n                    d_haversine_res_68880 = eta_p_68838;\n                    d_haversine_res_68881 = eta_p_68839;\n                    d_haversine_res_68882 = eta_p_68839;\n                } else {\n                    double zt_res_68883;\n                    double zs_res_68884;\n                    double zt_res_68885;\n                    double zs_res_68886;\n                    \n                    zt_res_68883 = 3.141592653589793 * eta_p_68838;\n                    zs_res_68884 = zt_res_68883 / 180.0;\n                    zt_res_68885 = 3.141592653589793 * eta_p_68839;\n                    zs_res_68886 = zt_res_68885 / 180.0;\n                    d_haversine_res_68880 = zs_res_68884;\n                    d_haversine_res_68881 = zs_res_68886;\n                    d_haversine_res_68882 = zs_res_68886;\n                }\n                zm_res_68887 = d_haversine_res_68880 - d_haversine_res_68827;\n                cos_res_68888 = futrts_cos64(zm_res_68887);\n                zm_res_68889 = 1.0 - cos_res_68888;\n                cos_res_68890 =", " futrts_cos64(d_haversine_res_68880);\n                zt_res_68891 = cos_res_68831 * cos_res_68890;\n                zm_res_68892 = d_haversine_res_68881 - d_haversine_res_68882;\n                zm_res_68893 = 1.0 - zm_res_68892;\n                zt_res_68894 = zt_res_68891 * zm_res_68893;\n                zp_res_68895 = zm_res_68889 + zt_res_68894;\n                zs_res_68896 = zp_res_68895 / 2.0;\n                min_res_68897 = fmin64(1.0, zs_res_68896);\n                zt_res_68898 = 2.0 * min_res_68897;\n                zm_res_68899 = 1.0 - zt_res_68898;\n                acos_res_68900 = futrts_acos64(zm_res_68899);\n                zt_res_68901 = clBase_36773 * acos_res_68900;\n                dist_res_68873 = zt_res_68901;\n            }\n            zlze_res_68902 = dist_res_68873 <= clBase_36767;\n            x_68903 = !zlze_res_68872;\n            y_68904 = zlze_res_68902 && x_68903;\n            cond_t_res_68905 = zlze_res_68872 || y_68904;\n            x_68906 = x_68842 && cond_t_res_68905;\n            zgze_res_68907 = zp_res_68810 <= eta_p_68838;\n            zlze_res_68908 = eta_p_68838 <= zp_res_68816;\n            x_68909 = zgze_res_68907 && zlze_res_68908;\n            if (clBase_36766 == (int8_t) 0) {\n                double zm_res_68911;\n                double abs_res_68912;\n                \n                zm_res_68911 = eta_p_68839 - zp_res_68815;\n                abs_res_68912 = fabs64(zm_res_68911);\n                dist_res_68910 = abs_res_68912;\n            } else {\n                double d_haversine_res_68913;\n                double d_haversine_res_68914;\n                double d_haversine_res_68915;\n                double zm_res_68920;\n                double cos_res_68921;\n                double zm_res_68922;\n                double cos_res_68923;\n                double cos_res_68924;\n                double zt_res_68925;\n                double zm_res_68926;\n                double zm_res_68927;\n                double zt_res_68928;\n                double zp_res", "_68929;\n                double zs_res_68930;\n                double min_res_68931;\n                double zt_res_68932;\n                double zm_res_68933;\n                double acos_res_68934;\n                double zt_res_68935;\n                \n                if (clBase_36765 == (int8_t) 1) {\n                    d_haversine_res_68913 = eta_p_68838;\n                    d_haversine_res_68914 = eta_p_68839;\n                    d_haversine_res_68915 = eta_p_68838;\n                } else {\n                    double zt_res_68916;\n                    double zs_res_68917;\n                    double zt_res_68918;\n                    double zs_res_68919;\n                    \n                    zt_res_68916 = 3.141592653589793 * eta_p_68838;\n                    zs_res_68917 = zt_res_68916 / 180.0;\n                    zt_res_68918 = 3.141592653589793 * eta_p_68839;\n                    zs_res_68919 = zt_res_68918 / 180.0;\n                    d_haversine_res_68913 = zs_res_68917;\n                    d_haversine_res_68914 = zs_res_68919;\n                    d_haversine_res_68915 = zs_res_68917;\n                }\n                zm_res_68920 = d_haversine_res_68913 - d_haversine_res_68915;\n                cos_res_68921 = futrts_cos64(zm_res_68920);\n                zm_res_68922 = 1.0 - cos_res_68921;\n                cos_res_68923 = futrts_cos64(d_haversine_res_68915);\n                cos_res_68924 = futrts_cos64(d_haversine_res_68913);\n                zt_res_68925 = cos_res_68923 * cos_res_68924;\n                zm_res_68926 = d_haversine_res_68914 - d_haversine_res_68828;\n                zm_res_68927 = 1.0 - zm_res_68926;\n                zt_res_68928 = zt_res_68925 * zm_res_68927;\n                zp_res_68929 = zm_res_68922 + zt_res_68928;\n                zs_res_68930 = zp_res_68929 / 2.0;\n                min_res_68931 = fmin64(1.0, zs_res_68930);\n                zt_res_68932 = 2.0 * min_res_68931;\n                zm_res_68933 = 1.0 - zt_res_68932;\n                acos_res_",
                                    "68934 = futrts_acos64(zm_res_68933);\n                zt_res_68935 = clBase_36773 * acos_res_68934;\n                dist_res_68910 = zt_res_68935;\n            }\n            zlze_res_68936 = dist_res_68910 <= clBase_36767;\n            if (clBase_36766 == (int8_t) 0) {\n                double zm_res_68938;\n                double abs_res_68939;\n                \n                zm_res_68938 = eta_p_68839 - zp_res_68817;\n                abs_res_68939 = fabs64(zm_res_68938);\n                dist_res_68937 = abs_res_68939;\n            } else {\n                double d_haversine_res_68940;\n                double d_haversine_res_68941;\n                double d_haversine_res_68942;\n                double zm_res_68947;\n                double cos_res_68948;\n                double zm_res_68949;\n                double cos_res_68950;\n                double cos_res_68951;\n                double zt_res_68952;\n                double zm_res_68953;\n                double zm_res_68954;\n                double zt_res_68955;\n                double zp_res_68956;\n                double zs_res_68957;\n                double min_res_68958;\n                double zt_res_68959;\n                double zm_res_68960;\n                double acos_res_68961;\n                double zt_res_68962;\n                \n                if (clBase_36765 == (int8_t) 1) {\n                    d_haversine_res_68940 = eta_p_68838;\n                    d_haversine_res_68941 = eta_p_68839;\n                    d_haversine_res_68942 = eta_p_68838;\n                } else {\n                    double zt_res_68943;\n                    double zs_res_68944;\n                    double zt_res_68945;\n                    double zs_res_68946;\n                    \n                    zt_res_68943 = 3.141592653589793 * eta_p_68838;\n                    zs_res_68944 = zt_res_68943 / 180.0;\n                    zt_res_68945 = 3.141592653589793 * eta_p_68839;\n                    zs_res_68946 = zt_res_68945 / 180.0;\n                    d_hav", "ersine_res_68940 = zs_res_68944;\n                    d_haversine_res_68941 = zs_res_68946;\n                    d_haversine_res_68942 = zs_res_68944;\n                }\n                zm_res_68947 = d_haversine_res_68940 - d_haversine_res_68942;\n                cos_res_68948 = futrts_cos64(zm_res_68947);\n                zm_res_68949 = 1.0 - cos_res_68948;\n                cos_res_68950 = futrts_cos64(d_haversine_res_68942);\n                cos_res_68951 = futrts_cos64(d_haversine_res_68940);\n                zt_res_68952 = cos_res_68950 * cos_res_68951;\n                zm_res_68953 = d_haversine_res_68941 - d_haversine_res_68829;\n                zm_res_68954 = 1.0 - zm_res_68953;\n                zt_res_68955 = zt_res_68952 * zm_res_68954;\n                zp_res_68956 = zm_res_68949 + zt_res_68955;\n                zs_res_68957 = zp_res_68956 / 2.0;\n                min_res_68958 = fmin64(1.0, zs_res_68957);\n                zt_res_68959 = 2.0 * min_res_68958;\n                zm_res_68960 = 1.0 - zt_res_68959;\n                acos_res_68961 = futrts_acos64(zm_res_68960);\n                zt_res_68962 = clBase_36773 * acos_res_68961;\n                dist_res_68937 = zt_res_68962;\n            }\n            zlze_res_68963 = dist_res_68937 <= clBase_36767;\n            x_68964 = !zlze_res_68936;\n            y_68965 = zlze_res_68963 && x_68964;\n            cond_f_res_t_res_68966 = zlze_res_68936 || y_68965;\n            x_68967 = x_68909 && cond_f_res_t_res_68966;\n            x_68968 = !x_68906;\n            y_68969 = x_68967 && x_68968;\n            cond_68970 = x_68906 || y_68969;\n            zlze_res_68971 = eta_p_68838 <= zp_res_68810;\n            if (zlze_res_68971) {\n                corn_x_68972 = zp_res_68810;\n            } else {\n                corn_x_68972 = zp_res_68816;\n            }\n            zlze_res_68973 = eta_p_68839 <= zp_res_68815;\n            if (zlze_res_68973) {\n                corn_y_68974 = zp_res_68815;\n            } else {\n                corn_y_68974 = z", "p_res_68817;\n            }\n            if (clBase_36766 == (int8_t) 0) {\n                bool eq_x_y_68976;\n                bool eq_x_zz_68977;\n                bool p_and_eq_x_y_68978;\n                bool not_p_68979;\n                bool p_and_eq_x_y_68980;\n                bool zeze_res_68981;\n                double d_euclidean_res_68982;\n                \n                eq_x_y_68976 = eta_p_68838 == zp_res_68810;\n                eq_x_zz_68977 = eta_p_68838 == zp_res_68816;\n                p_and_eq_x_y_68978 = zlze_res_68971 && eq_x_y_68976;\n                not_p_68979 = !zlze_res_68971;\n                p_and_eq_x_y_68980 = eq_x_zz_68977 && not_p_68979;\n                zeze_res_68981 = p_and_eq_x_y_68978 || p_and_eq_x_y_68980;\n                if (zeze_res_68981) {\n                    double zm_res_68983;\n                    double abs_res_68984;\n                    \n                    zm_res_68983 = eta_p_68839 - corn_y_68974;\n                    abs_res_68984 = fabs64(zm_res_68983);\n                    d_euclidean_res_68982 = abs_res_68984;\n                } else {\n                    bool eq_x_y_68985;\n                    bool eq_x_zz_68986;\n                    bool p_and_eq_x_y_68987;\n                    bool not_p_68988;\n                    bool p_and_eq_x_y_68989;\n                    bool zeze_res_68990;\n                    double d_euclidean_res_f_res_68991;\n                    \n                    eq_x_y_68985 = eta_p_68839 == zp_res_68815;\n                    eq_x_zz_68986 = eta_p_68839 == zp_res_68817;\n                    p_and_eq_x_y_68987 = zlze_res_68973 && eq_x_y_68985;\n                    not_p_68988 = !zlze_res_68973;\n                    p_and_eq_x_y_68989 = eq_x_zz_68986 && not_p_68988;\n                    zeze_res_68990 = p_and_eq_x_y_68987 || p_and_eq_x_y_68989;\n                    if (zeze_res_68990) {\n                        double zm_res_68992;\n                        double abs_res_68993;\n                        \n                        zm_r",
                                    "es_68992 = eta_p_68838 - corn_x_68972;\n                        abs_res_68993 = fabs64(zm_res_68992);\n                        d_euclidean_res_f_res_68991 = abs_res_68993;\n                    } else {\n                        double zm_res_68994;\n                        double zm_res_68995;\n                        double hypot_res_68996;\n                        \n                        zm_res_68994 = eta_p_68839 - corn_y_68974;\n                        zm_res_68995 = eta_p_68838 - corn_x_68972;\n                        hypot_res_68996 = futrts_hypot64(zm_res_68995, zm_res_68994);\n                        d_euclidean_res_f_res_68991 = hypot_res_68996;\n                    }\n                    d_euclidean_res_68982 = d_euclidean_res_f_res_68991;\n                }\n                dist_res_68975 = d_euclidean_res_68982;\n            } else {\n                double d_haversine_res_68997;\n                double d_haversine_res_68998;\n                double d_haversine_res_68999;\n                double d_haversine_res_69000;\n                double zm_res_69009;\n                double cos_res_69010;\n                double zm_res_69011;\n                double cos_res_69012;\n                double cos_res_69013;\n                double zt_res_69014;\n                double zm_res_69015;\n                double zm_res_69016;\n                double zt_res_69017;\n                double zp_res_69018;\n                double zs_res_69019;\n                double min_res_69020;\n                double zt_res_69021;\n                double zm_res_69022;\n                double acos_res_69023;\n                double zt_res_69024;\n                \n                if (clBase_36765 == (int8_t) 1) {\n                    d_haversine_res_68997 = eta_p_68838;\n                    d_haversine_res_68998 = eta_p_68839;\n                    d_haversine_res_68999 = corn_x_68972;\n                    d_haversine_res_69000 = corn_y_68974;\n                } else {\n                    double zt_res_69001;\n            ", "        double zs_res_69002;\n                    double zt_res_69003;\n                    double zs_res_69004;\n                    double zt_res_69005;\n                    double zs_res_69006;\n                    double zt_res_69007;\n                    double zs_res_69008;\n                    \n                    zt_res_69001 = 3.141592653589793 * eta_p_68838;\n                    zs_res_69002 = zt_res_69001 / 180.0;\n                    zt_res_69003 = 3.141592653589793 * eta_p_68839;\n                    zs_res_69004 = zt_res_69003 / 180.0;\n                    zt_res_69005 = 3.141592653589793 * corn_x_68972;\n                    zs_res_69006 = zt_res_69005 / 180.0;\n                    zt_res_69007 = 3.141592653589793 * corn_y_68974;\n                    zs_res_69008 = zt_res_69007 / 180.0;\n                    d_haversine_res_68997 = zs_res_69002;\n                    d_haversine_res_68998 = zs_res_69004;\n                    d_haversine_res_68999 = zs_res_69006;\n                    d_haversine_res_69000 = zs_res_69008;\n                }\n                zm_res_69009 = d_haversine_res_68997 - d_haversine_res_68999;\n                cos_res_69010 = futrts_cos64(zm_res_69009);\n                zm_res_69011 = 1.0 - cos_res_69010;\n                cos_res_69012 = futrts_cos64(d_haversine_res_68999);\n                cos_res_69013 = futrts_cos64(d_haversine_res_68997);\n                zt_res_69014 = cos_res_69012 * cos_res_69013;\n                zm_res_69015 = d_haversine_res_68998 - d_haversine_res_69000;\n                zm_res_69016 = 1.0 - zm_res_69015;\n                zt_res_69017 = zt_res_69014 * zm_res_69016;\n                zp_res_69018 = zm_res_69011 + zt_res_69017;\n                zs_res_69019 = zp_res_69018 / 2.0;\n                min_res_69020 = fmin64(1.0, zs_res_69019);\n                zt_res_69021 = 2.0 * min_res_69020;\n                zm_res_69022 = 1.0 - zt_res_69021;\n                acos_res_69023 = futrts_acos64(zm_res_69022);\n                zt_res_69024 = clBase_", "36773 * acos_res_69023;\n                dist_res_68975 = zt_res_69024;\n            }\n            zlze_res_69025 = dist_res_68975 <= clBase_36767;\n            x_69026 = !cond_68970;\n            y_69027 = zlze_res_69025 && x_69026;\n            is_pt_marginal_res_69028 = cond_68970 || y_69027;\n            ((__local bool *) red_arr_mem_83576)[gtid_68833] = is_pt_marginal_res_69028;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_83579 = 1;\n        offset_83578 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_83560, sext_i64_i32(n_new_36762))) {\n                eta_p_68835 = ((__local bool *) red_arr_mem_83576)[sext_i32_i64(local_tid_83560 + offset_83578)];\n            }\n        }\n        offset_83578 = 1;\n        while (slt32(offset_83578, wave_sizze_83562)) {\n            if (slt32(local_tid_83560 + offset_83578, sext_i64_i32(n_new_36762)) && ((local_tid_83560 - squot32(local_tid_83560, wave_sizze_83562) * wave_sizze_83562) & (2 * offset_83578 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_68836 = ((volatile __local bool *) red_arr_mem_83576)[sext_i32_i64(local_tid_83560 + offset_83578)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_68837 = eta_p_68835 || eta_p_68836;\n                    \n                    eta_p_68835 = defunc_0_op_res_68837;\n                }\n                // write result of operation\n                {\n                    ((volatile __local bool *) red_arr_mem_83576)[sext_i32_i64(local_tid_83560)] = eta_p_68835;\n                }\n            }\n            offset_83578 *= 2;\n        }\n        while (slt32(skip_waves_83579, squot32(sext_i64_i32(computed_tblock_sizze_68510) + wave_sizze_83562 - 1, wave_sizze_83562))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_83578 = skip_waves_83579 * wave_sizze_83562;\n            if (slt32(local_tid",
                                    "_83560 + offset_83578, sext_i64_i32(n_new_36762)) && ((local_tid_83560 - squot32(local_tid_83560, wave_sizze_83562) * wave_sizze_83562) == 0 && (squot32(local_tid_83560, wave_sizze_83562) & (2 * skip_waves_83579 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_68836 = ((__local bool *) red_arr_mem_83576)[sext_i32_i64(local_tid_83560 + offset_83578)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_68837 = eta_p_68835 || eta_p_68836;\n                    \n                    eta_p_68835 = defunc_0_op_res_68837;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_mem_83576)[sext_i32_i64(local_tid_83560)] = eta_p_68835;\n                }\n            }\n            skip_waves_83579 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Save result of reduction.\n        {\n            defunc_0_reduce_res_68832 = ((__local bool *) red_arr_mem_83576)[(int64_t) 0];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        defunc_0_f_res_68799 = defunc_0_reduce_res_68832;\n    }\n    defunc_0_f_res_69029 = btoi_bool_i64(defunc_0_f_res_68799);\n    if (local_tid_83560 == 0) {\n        ((__global int64_t *) mem_82013)[gtid_68779] = defunc_0_f_res_69029;\n    }\n    if (local_tid_83560 == 0) {\n        ((__global int64_t *) mem_82014)[gtid_68779] = defunc_0_f_res_68798;\n    }\n    if (local_tid_83560 == 0) {\n        ((__global bool *) mem_82015)[gtid_68779] = lifted_lambda_res_68783;\n    }\n    \n  error_16:\n    return;\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_intrablock_78070_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_intrablock_78070(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t part_no_36754, int64_t dz2083U_36759, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase", "_36766, double clBase_36767, double clBase_36773, int64_t num_whole_tiles_78087, int64_t residual_input_78168, unsigned char cond_78169_bits, int64_t binop_x_78179, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *clProc_mem_81937, __global unsigned char *clProc_mem_81938, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82051, __global unsigned char *mem_82052, __global unsigned char *mem_82053)\n{\n    bool cond_78169 = cond_78169_bits;\n    \n    #define tile_sizze_78072 (add_next_partition_doublezisegmap_intrablock_78070zitile_sizze_78072)\n    #define ldim_78073 (add_next_partition_doublezisegmap_intrablock_78070zildim_78073)\n    #define bytes_82028 (add_next_partition_doublezisegmap_intrablock_78070zibytes_82028)\n    \n    volatile __local unsigned char *color_83087_backing_0 = &shared_mem[0];\n    const int64_t color_83087_backing_0_offset = 0 + (bytes_82028 + srem64((int64_t) 8 - srem64(bytes_82028, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83539;\n    int32_t tblock_sizze_83542;\n    int32_t wave_sizze_83541;\n    int32_t block_id_83540;\n    int32_t global_tid_83538;\n    int64_t gid_flat_78070;\n    int64_t slice_83544;\n    int64_t ltid_pre_83543;\n    int64_t remnant_83545;\n    int64_t slice_83546;\n    int64_t gid_78069;\n    int64_t remnant_83547;\n    __local unsigned char *color_83087;\n    int64_t binop_x_78080;\n    int64_t mem_82023[1];\n    int64_t ltid_flat_78075;\n    int64_t ltid_78074;\n    int64_t gtid_78081;\n    bool cond_78082;\n    int64_t pre_78083;\n    bool mem_82026[1];\n    int64_t ltid_flat_78089;\n    int64_t ltid_78088;", "\n    bool ext_mem_82033[1];\n    bool mem_param_82027[1];\n    bool mem_82038[1];\n    bool ext_mem_82039[1];\n    int64_t mem_82043[1];\n    int64_t mem_82047[1];\n    bool mem_82050[1];\n    int64_t ltid_flat_78212;\n    int64_t ltid_78211;\n    int64_t gtid_78222;\n    bool cond_78224;\n    int64_t postlude_78225;\n    int64_t postlude_78226;\n    bool postlude_78227;\n    \n    local_tid_83539 = get_local_id(0);\n    tblock_sizze_83542 = get_local_size(0);\n    wave_sizze_83541 = LOCKSTEP_WIDTH;\n    block_id_83540 = get_tblock_id(0);\n    global_tid_83538 = block_id_83540 * tblock_sizze_83542 + local_tid_83539;\n    gid_flat_78070 = sext_i32_i64(block_id_83540);\n    slice_83544 = tile_sizze_78072;\n    ltid_pre_83543 = sext_i32_i64(local_tid_83539);\n    remnant_83545 = sext_i32_i64(local_tid_83539) - ltid_pre_83543;\n    slice_83546 = ldim_78073;\n    gid_78069 = sext_i32_i64(block_id_83540);\n    remnant_83547 = sext_i32_i64(block_id_83540) - gid_78069;\n    color_83087 = (__local unsigned char *) color_83087_backing_0;\n    binop_x_78080 = gid_78069 * tile_sizze_78072;\n    ltid_flat_78075 = sext_i32_i64(local_tid_83539);\n    ltid_78074 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n    gtid_78081 = ltid_78074 + binop_x_78080;\n    cond_78082 = slt64(gtid_78081, (int64_t) 8);\n    if (cond_78082) {\n        int64_t eta_p_78084 = ((__global int64_t *) mem_82001)[gtid_78081];\n        \n        pre_78083 = eta_p_78084;\n    } else {\n        pre_78083 = (int64_t) 0;\n    }\n    mem_82023[(int64_t) 0] = pre_78083;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78089 = sext_i32_i64(local_tid_83539);\n    ltid_78088 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n    mem_82026[(int64_t) 0] = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_1 = 0; i_1 < 1; i_1++)\n        mem_param_82027[i_1] = mem_82026[i_1];\n    for (int64_t tile_id_78095 = 0; tile_id_78095 < num_whole_tiles_78087; tile_id_78095++) {\n        int64_t binop_x_78138;\n        int64_t ltid_flat_78137",
                                    ";\n        int64_t ltid_78136;\n        int64_t j_78139;\n        bool cond_78143;\n        int64_t pre1d_78144;\n        bool mem_82032[1];\n        int64_t ltid_flat_78149;\n        int64_t ltid_78148;\n        int64_t gtid_78151;\n        bool acc_78153;\n        bool cond_78154;\n        bool acc_78155;\n        bool mem_param_tmp_83548[1];\n        \n        binop_x_78138 = tile_sizze_78072 * tile_id_78095;\n        ltid_flat_78137 = sext_i32_i64(local_tid_83539);\n        ltid_78136 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n        j_78139 = ltid_78136 + binop_x_78138;\n        cond_78143 = slt64(j_78139, dz2083U_36759);\n        if (cond_78143) {\n            int64_t tile_elem_78145 = ((__global int64_t *) clProc_mem_81938)[j_78139];\n            \n            pre1d_78144 = tile_elem_78145;\n        } else {\n            pre1d_78144 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83087)[ltid_78136] = pre1d_78144;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78149 = sext_i32_i64(local_tid_83539);\n        ltid_78148 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n        gtid_78151 = binop_x_78080 + ltid_78148;\n        acc_78153 = mem_param_82027[(int64_t) 0];\n        cond_78154 = slt64(gtid_78151, (int64_t) 8);\n        if (cond_78154) {\n            int64_t eta_p_78152;\n            bool x_78156;\n            bool redout_81490;\n            \n            eta_p_78152 = mem_82023[(int64_t) 0];\n            redout_81490 = acc_78153;\n            for (int64_t i_81491 = 0; i_81491 < tile_sizze_78072; i_81491++) {\n                int64_t eta_p_78157;\n                bool lifted_lambda_res_78158;\n                bool defunc_0_op_res_78161;\n                bool redout_tmp_83550;\n                \n                eta_p_78157 = ((__local int64_t *) color_83087)[i_81491];\n                lifted_lambda_res_78158 = eta_p_78157 == eta_p_78152;\n                defunc_0_op_res_78161 = lifted_lambda_res_78158 || redout_81490;\n                redout_tmp_83550 = defunc_0_op_res_78161;", "\n                redout_81490 = redout_tmp_83550;\n            }\n            x_78156 = redout_81490;\n            acc_78155 = x_78156;\n        } else {\n            acc_78155 = acc_78153;\n        }\n        mem_82032[(int64_t) 0] = acc_78155;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_2 = 0; i_2 < 1; i_2++)\n            mem_param_tmp_83548[i_2] = mem_82032[i_2];\n        for (int32_t i_3 = 0; i_3 < 1; i_3++)\n            mem_param_82027[i_3] = mem_param_tmp_83548[i_3];\n    }\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        ext_mem_82033[i_4] = mem_param_82027[i_4];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_78169) {\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            ext_mem_82039[i_5] = ext_mem_82033[i_5];\n    } else {\n        int64_t ltid_flat_78171;\n        int64_t ltid_78170;\n        int64_t j_78180;\n        bool cond_78184;\n        int64_t pre1d_78185;\n        int64_t ltid_flat_78191;\n        int64_t ltid_78190;\n        int64_t gtid_78198;\n        bool acc_78200;\n        bool cond_78201;\n        bool acc_78202;\n        \n        ltid_flat_78171 = sext_i32_i64(local_tid_83539);\n        ltid_78170 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n        j_78180 = ltid_78170 + binop_x_78179;\n        cond_78184 = slt64(j_78180, dz2083U_36759);\n        if (cond_78184) {\n            int64_t tile_elem_78186 = ((__global int64_t *) clProc_mem_81938)[j_78180];\n            \n            pre1d_78185 = tile_elem_78186;\n        } else {\n            pre1d_78185 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83087)[ltid_78170] = pre1d_78185;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78191 = sext_i32_i64(local_tid_83539);\n        ltid_78190 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n        gtid_78198 = binop_x_78080 + ltid_78190;\n        acc_78200 = ext_mem_82033[(int64_t) 0];\n        cond_78201 = slt64(gtid_78198, (int64_t) 8);\n        if (cond_78201) {\n            int64_t eta_p_78199;\n            bool x_78203;\n            bool ", "redout_81492;\n            \n            eta_p_78199 = mem_82023[(int64_t) 0];\n            redout_81492 = acc_78200;\n            for (int64_t i_81493 = 0; i_81493 < residual_input_78168; i_81493++) {\n                int64_t eta_p_78204;\n                bool lifted_lambda_res_78205;\n                bool defunc_0_op_res_78208;\n                bool redout_tmp_83551;\n                \n                eta_p_78204 = ((__local int64_t *) color_83087)[i_81493];\n                lifted_lambda_res_78205 = eta_p_78204 == eta_p_78199;\n                defunc_0_op_res_78208 = lifted_lambda_res_78205 || redout_81492;\n                redout_tmp_83551 = defunc_0_op_res_78208;\n                redout_81492 = redout_tmp_83551;\n            }\n            x_78203 = redout_81492;\n            acc_78202 = x_78203;\n        } else {\n            acc_78202 = acc_78200;\n        }\n        mem_82038[(int64_t) 0] = acc_78202;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            ext_mem_82039[i_6] = mem_82038[i_6];\n    }\n    ltid_flat_78212 = sext_i32_i64(local_tid_83539);\n    ltid_78211 = sext_i32_i64(sext_i64_i32(ltid_pre_83543));\n    gtid_78222 = binop_x_78080 + ltid_78211;\n    cond_78224 = slt64(gtid_78222, (int64_t) 8);\n    if (cond_78224) {\n        bool defunc_0_reduce_res_78223;\n        int64_t eta_p_78228;\n        bool cond_78229;\n        bool lifted_lambda_res_78230;\n        int64_t lifted_lambda_res_78235;\n        bool cond_78236;\n        int64_t defunc_0_f_res_78237;\n        bool defunc_0_f_res_78238;\n        int64_t defunc_0_f_res_78466;\n        \n        defunc_0_reduce_res_78223 = ext_mem_82039[(int64_t) 0];\n        eta_p_78228 = mem_82023[(int64_t) 0];\n        cond_78229 = sle64((int64_t) 0, eta_p_78228);\n        if (cond_78229) {\n            bool y_78231;\n            bool bounds_check_78232;\n            bool index_certs_78233;\n            bool lifted_lambda_res_t_res_78234;\n            \n            y_78231 = slt64(eta_p_78228, part_no_36754);\n    ",
                                    "        bounds_check_78232 = cond_78229 && y_78231;\n            if (!bounds_check_78232) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                        global_failure_args[0] = (int64_t) eta_p_78228;\n                        global_failure_args[1] = (int64_t) part_no_36754;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_8;\n                }\n            }\n            lifted_lambda_res_t_res_78234 = ((__global bool *) clProc_mem_81937)[eta_p_78228];\n            lifted_lambda_res_78230 = lifted_lambda_res_t_res_78234;\n        } else {\n            lifted_lambda_res_78230 = 0;\n        }\n        if (defunc_0_reduce_res_78223) {\n            lifted_lambda_res_78235 = (int64_t) -1;\n        } else {\n            lifted_lambda_res_78235 = eta_p_78228;\n        }\n        cond_78236 = slt64(lifted_lambda_res_78235, (int64_t) 0);\n        if (cond_78236) {\n            defunc_0_f_res_78237 = (int64_t) -1;\n        } else {\n            defunc_0_f_res_78237 = lifted_lambda_res_78235;\n        }\n        if (cond_78236) {\n            defunc_0_f_res_78238 = 0;\n        } else {\n            int64_t zv_rhs_78239;\n            bool zzero_78240;\n            bool nonzzero_78241;\n            bool nonzzero_cert_78242;\n            int64_t nxid_78243;\n            int64_t nyid_78244;\n            double times_arg1_78245;\n            double i64_res_78246;\n            double zt_res_78247;\n            double plus_arg0_78248;\n            double zp_res_78249;\n            double times_arg1_78250;\n            double i64_res_78251;\n            double zt_res_78252;\n            double plus_arg0_78253;\n            double zp_res_78254;\n            double zp_res_78255;\n            double zp_res_78256;\n            double zt_res_78257;\n            double zt_res_78258;\n            double zt_res_78259;\n            double zt_res_78260;\n            double zs_res_78261;\n            double zs_", "res_78262;\n            double zs_res_78263;\n            double zs_res_78264;\n            double d_haversine_res_78265;\n            double d_haversine_res_78266;\n            double d_haversine_res_78267;\n            double d_haversine_res_78268;\n            double cos_res_78269;\n            double cos_res_78270;\n            bool defunc_0_reduce_res_78271;\n            bool redout_81494;\n            \n            zv_rhs_78239 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n            zzero_78240 = zv_rhs_78239 == (int64_t) 0;\n            nonzzero_78241 = !zzero_78240;\n            if (!nonzzero_78241) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_8;\n                }\n            }\n            nxid_78243 = smod64(lifted_lambda_res_78235, zv_rhs_78239);\n            nyid_78244 = sdiv64(lifted_lambda_res_78235, zv_rhs_78239);\n            times_arg1_78245 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n            i64_res_78246 = sitofp_i64_f64(nxid_78243);\n            zt_res_78247 = times_arg1_78245 * i64_res_78246;\n            plus_arg0_78248 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n            zp_res_78249 = zt_res_78247 + plus_arg0_78248;\n            times_arg1_78250 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n            i64_res_78251 = sitofp_i64_f64(nyid_78244);\n            zt_res_78252 = times_arg1_78250 * i64_res_78251;\n            plus_arg0_78253 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n            zp_res_78254 = zt_res_78252 + plus_arg0_78253;\n            zp_res_78255 = times_arg1_78245 + zp_res_78249;\n            zp_res_78256 = times_arg1_78250 + zp_res_78254;\n            zt_res_78257 = 3.141592653589793 * zp_res_78249;\n            zt_res_78258 = 3.141592653589793 * zp_res_78255;\n            zt_res_78259 = 3.141592653589793 * zp_res_78254;", "\n            zt_res_78260 = 3.141592653589793 * zp_res_78256;\n            zs_res_78261 = zt_res_78257 / 180.0;\n            zs_res_78262 = zt_res_78258 / 180.0;\n            zs_res_78263 = zt_res_78259 / 180.0;\n            zs_res_78264 = zt_res_78260 / 180.0;\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_78265 = zp_res_78249;\n            } else {\n                d_haversine_res_78265 = zs_res_78261;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_78266 = zp_res_78255;\n            } else {\n                d_haversine_res_78266 = zs_res_78262;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_78267 = zp_res_78254;\n            } else {\n                d_haversine_res_78267 = zs_res_78263;\n            }\n            if (clBase_36765 == (int8_t) 1) {\n                d_haversine_res_78268 = zp_res_78256;\n            } else {\n                d_haversine_res_78268 = zs_res_78264;\n            }\n            cos_res_78269 = futrts_cos64(d_haversine_res_78265);\n            cos_res_78270 = futrts_cos64(d_haversine_res_78266);\n            redout_81494 = 0;\n            for (int64_t i_81495 = 0; i_81495 < n_new_36762; i_81495++) {\n                double eta_p_78272;\n                double eta_p_78273;\n                bool zgze_res_78274;\n                bool zlze_res_78275;\n                bool x_78276;\n                double dist_res_78277;\n                bool zlze_res_78306;\n                double dist_res_78307;\n                bool zlze_res_78336;\n                bool x_78337;\n                bool y_78338;\n                bool cond_t_res_78339;\n                bool x_78340;\n                bool zgze_res_78341;\n                bool zlze_res_78342;\n                bool x_78343;\n                double dist_res_78344;\n                bool zlze_res_78370;\n                double dist_res_78371;\n                bool zlze_res_78397;\n                bool x_78398;\n         ",
                                    "       bool y_78399;\n                bool cond_f_res_t_res_78400;\n                bool x_78401;\n                bool x_78402;\n                bool y_78403;\n                bool cond_78404;\n                bool zlze_res_78405;\n                double corn_x_78406;\n                bool zlze_res_78407;\n                double corn_y_78408;\n                double dist_res_78409;\n                bool zlze_res_78459;\n                bool x_78460;\n                bool y_78461;\n                bool is_pt_marginal_res_78462;\n                bool defunc_0_op_res_78465;\n                bool redout_tmp_83552;\n                \n                eta_p_78272 = ((__global double *) new_xs_mem_81952)[i_81495];\n                eta_p_78273 = ((__global double *) new_ys_mem_81953)[i_81495];\n                zgze_res_78274 = zp_res_78254 <= eta_p_78273;\n                zlze_res_78275 = eta_p_78273 <= zp_res_78256;\n                x_78276 = zgze_res_78274 && zlze_res_78275;\n                if (clBase_36766 == (int8_t) 0) {\n                    bool zeze_res_78278;\n                    double d_euclidean_res_78279;\n                    \n                    zeze_res_78278 = eta_p_78272 == zp_res_78249;\n                    if (zeze_res_78278) {\n                        double zm_res_78280;\n                        double abs_res_78281;\n                        \n                        zm_res_78280 = eta_p_78273 - eta_p_78273;\n                        abs_res_78281 = fabs64(zm_res_78280);\n                        d_euclidean_res_78279 = abs_res_78281;\n                    } else {\n                        double zm_res_78282;\n                        double abs_res_78283;\n                        \n                        zm_res_78282 = eta_p_78272 - zp_res_78249;\n                        abs_res_78283 = fabs64(zm_res_78282);\n                        d_euclidean_res_78279 = abs_res_78283;\n                    }\n                    dist_res_78277 = d_euclidean_res_78279;\n                } else {\n                 ", "   double d_haversine_res_78284;\n                    double d_haversine_res_78285;\n                    double d_haversine_res_78286;\n                    double zm_res_78291;\n                    double cos_res_78292;\n                    double zm_res_78293;\n                    double cos_res_78294;\n                    double zt_res_78295;\n                    double zm_res_78296;\n                    double zm_res_78297;\n                    double zt_res_78298;\n                    double zp_res_78299;\n                    double zs_res_78300;\n                    double min_res_78301;\n                    double zt_res_78302;\n                    double zm_res_78303;\n                    double acos_res_78304;\n                    double zt_res_78305;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_78284 = eta_p_78272;\n                        d_haversine_res_78285 = eta_p_78273;\n                        d_haversine_res_78286 = eta_p_78273;\n                    } else {\n                        double zt_res_78287;\n                        double zs_res_78288;\n                        double zt_res_78289;\n                        double zs_res_78290;\n                        \n                        zt_res_78287 = 3.141592653589793 * eta_p_78272;\n                        zs_res_78288 = zt_res_78287 / 180.0;\n                        zt_res_78289 = 3.141592653589793 * eta_p_78273;\n                        zs_res_78290 = zt_res_78289 / 180.0;\n                        d_haversine_res_78284 = zs_res_78288;\n                        d_haversine_res_78285 = zs_res_78290;\n                        d_haversine_res_78286 = zs_res_78290;\n                    }\n                    zm_res_78291 = d_haversine_res_78284 - d_haversine_res_78265;\n                    cos_res_78292 = futrts_cos64(zm_res_78291);\n                    zm_res_78293 = 1.0 - cos_res_78292;\n                    cos_res_78294 = futrts_cos64(d_haversine_res_78284);\n      ", "              zt_res_78295 = cos_res_78269 * cos_res_78294;\n                    zm_res_78296 = d_haversine_res_78285 - d_haversine_res_78286;\n                    zm_res_78297 = 1.0 - zm_res_78296;\n                    zt_res_78298 = zt_res_78295 * zm_res_78297;\n                    zp_res_78299 = zm_res_78293 + zt_res_78298;\n                    zs_res_78300 = zp_res_78299 / 2.0;\n                    min_res_78301 = fmin64(1.0, zs_res_78300);\n                    zt_res_78302 = 2.0 * min_res_78301;\n                    zm_res_78303 = 1.0 - zt_res_78302;\n                    acos_res_78304 = futrts_acos64(zm_res_78303);\n                    zt_res_78305 = clBase_36773 * acos_res_78304;\n                    dist_res_78277 = zt_res_78305;\n                }\n                zlze_res_78306 = dist_res_78277 <= clBase_36767;\n                if (clBase_36766 == (int8_t) 0) {\n                    bool zeze_res_78308;\n                    double d_euclidean_res_78309;\n                    \n                    zeze_res_78308 = eta_p_78272 == zp_res_78255;\n                    if (zeze_res_78308) {\n                        double zm_res_78310;\n                        double abs_res_78311;\n                        \n                        zm_res_78310 = eta_p_78273 - eta_p_78273;\n                        abs_res_78311 = fabs64(zm_res_78310);\n                        d_euclidean_res_78309 = abs_res_78311;\n                    } else {\n                        double zm_res_78312;\n                        double abs_res_78313;\n                        \n                        zm_res_78312 = eta_p_78272 - zp_res_78255;\n                        abs_res_78313 = fabs64(zm_res_78312);\n                        d_euclidean_res_78309 = abs_res_78313;\n                    }\n                    dist_res_78307 = d_euclidean_res_78309;\n                } else {\n                    double d_haversine_res_78314;\n                    double d_haversine_res_78315;\n                    double d_haversine_res_78316;\n         ",
                                    "           double zm_res_78321;\n                    double cos_res_78322;\n                    double zm_res_78323;\n                    double cos_res_78324;\n                    double zt_res_78325;\n                    double zm_res_78326;\n                    double zm_res_78327;\n                    double zt_res_78328;\n                    double zp_res_78329;\n                    double zs_res_78330;\n                    double min_res_78331;\n                    double zt_res_78332;\n                    double zm_res_78333;\n                    double acos_res_78334;\n                    double zt_res_78335;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_78314 = eta_p_78272;\n                        d_haversine_res_78315 = eta_p_78273;\n                        d_haversine_res_78316 = eta_p_78273;\n                    } else {\n                        double zt_res_78317;\n                        double zs_res_78318;\n                        double zt_res_78319;\n                        double zs_res_78320;\n                        \n                        zt_res_78317 = 3.141592653589793 * eta_p_78272;\n                        zs_res_78318 = zt_res_78317 / 180.0;\n                        zt_res_78319 = 3.141592653589793 * eta_p_78273;\n                        zs_res_78320 = zt_res_78319 / 180.0;\n                        d_haversine_res_78314 = zs_res_78318;\n                        d_haversine_res_78315 = zs_res_78320;\n                        d_haversine_res_78316 = zs_res_78320;\n                    }\n                    zm_res_78321 = d_haversine_res_78314 - d_haversine_res_78266;\n                    cos_res_78322 = futrts_cos64(zm_res_78321);\n                    zm_res_78323 = 1.0 - cos_res_78322;\n                    cos_res_78324 = futrts_cos64(d_haversine_res_78314);\n                    zt_res_78325 = cos_res_78270 * cos_res_78324;\n                    zm_res_78326 = d_haversine_res_78315 - d_haversine_res_78316;\n", "                    zm_res_78327 = 1.0 - zm_res_78326;\n                    zt_res_78328 = zt_res_78325 * zm_res_78327;\n                    zp_res_78329 = zm_res_78323 + zt_res_78328;\n                    zs_res_78330 = zp_res_78329 / 2.0;\n                    min_res_78331 = fmin64(1.0, zs_res_78330);\n                    zt_res_78332 = 2.0 * min_res_78331;\n                    zm_res_78333 = 1.0 - zt_res_78332;\n                    acos_res_78334 = futrts_acos64(zm_res_78333);\n                    zt_res_78335 = clBase_36773 * acos_res_78334;\n                    dist_res_78307 = zt_res_78335;\n                }\n                zlze_res_78336 = dist_res_78307 <= clBase_36767;\n                x_78337 = !zlze_res_78306;\n                y_78338 = zlze_res_78336 && x_78337;\n                cond_t_res_78339 = zlze_res_78306 || y_78338;\n                x_78340 = x_78276 && cond_t_res_78339;\n                zgze_res_78341 = zp_res_78249 <= eta_p_78272;\n                zlze_res_78342 = eta_p_78272 <= zp_res_78255;\n                x_78343 = zgze_res_78341 && zlze_res_78342;\n                if (clBase_36766 == (int8_t) 0) {\n                    double zm_res_78345;\n                    double abs_res_78346;\n                    \n                    zm_res_78345 = eta_p_78273 - zp_res_78254;\n                    abs_res_78346 = fabs64(zm_res_78345);\n                    dist_res_78344 = abs_res_78346;\n                } else {\n                    double d_haversine_res_78347;\n                    double d_haversine_res_78348;\n                    double d_haversine_res_78349;\n                    double zm_res_78354;\n                    double cos_res_78355;\n                    double zm_res_78356;\n                    double cos_res_78357;\n                    double cos_res_78358;\n                    double zt_res_78359;\n                    double zm_res_78360;\n                    double zm_res_78361;\n                    double zt_res_78362;\n                    double zp_res_78363;\n          ", "          double zs_res_78364;\n                    double min_res_78365;\n                    double zt_res_78366;\n                    double zm_res_78367;\n                    double acos_res_78368;\n                    double zt_res_78369;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_78347 = eta_p_78272;\n                        d_haversine_res_78348 = eta_p_78273;\n                        d_haversine_res_78349 = eta_p_78272;\n                    } else {\n                        double zt_res_78350;\n                        double zs_res_78351;\n                        double zt_res_78352;\n                        double zs_res_78353;\n                        \n                        zt_res_78350 = 3.141592653589793 * eta_p_78272;\n                        zs_res_78351 = zt_res_78350 / 180.0;\n                        zt_res_78352 = 3.141592653589793 * eta_p_78273;\n                        zs_res_78353 = zt_res_78352 / 180.0;\n                        d_haversine_res_78347 = zs_res_78351;\n                        d_haversine_res_78348 = zs_res_78353;\n                        d_haversine_res_78349 = zs_res_78351;\n                    }\n                    zm_res_78354 = d_haversine_res_78347 - d_haversine_res_78349;\n                    cos_res_78355 = futrts_cos64(zm_res_78354);\n                    zm_res_78356 = 1.0 - cos_res_78355;\n                    cos_res_78357 = futrts_cos64(d_haversine_res_78349);\n                    cos_res_78358 = futrts_cos64(d_haversine_res_78347);\n                    zt_res_78359 = cos_res_78357 * cos_res_78358;\n                    zm_res_78360 = d_haversine_res_78348 - d_haversine_res_78267;\n                    zm_res_78361 = 1.0 - zm_res_78360;\n                    zt_res_78362 = zt_res_78359 * zm_res_78361;\n                    zp_res_78363 = zm_res_78356 + zt_res_78362;\n                    zs_res_78364 = zp_res_78363 / 2.0;\n                    min_res_78365 = fmin64(1.0, zs_res_78364)",
                                    ";\n                    zt_res_78366 = 2.0 * min_res_78365;\n                    zm_res_78367 = 1.0 - zt_res_78366;\n                    acos_res_78368 = futrts_acos64(zm_res_78367);\n                    zt_res_78369 = clBase_36773 * acos_res_78368;\n                    dist_res_78344 = zt_res_78369;\n                }\n                zlze_res_78370 = dist_res_78344 <= clBase_36767;\n                if (clBase_36766 == (int8_t) 0) {\n                    double zm_res_78372;\n                    double abs_res_78373;\n                    \n                    zm_res_78372 = eta_p_78273 - zp_res_78256;\n                    abs_res_78373 = fabs64(zm_res_78372);\n                    dist_res_78371 = abs_res_78373;\n                } else {\n                    double d_haversine_res_78374;\n                    double d_haversine_res_78375;\n                    double d_haversine_res_78376;\n                    double zm_res_78381;\n                    double cos_res_78382;\n                    double zm_res_78383;\n                    double cos_res_78384;\n                    double cos_res_78385;\n                    double zt_res_78386;\n                    double zm_res_78387;\n                    double zm_res_78388;\n                    double zt_res_78389;\n                    double zp_res_78390;\n                    double zs_res_78391;\n                    double min_res_78392;\n                    double zt_res_78393;\n                    double zm_res_78394;\n                    double acos_res_78395;\n                    double zt_res_78396;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_78374 = eta_p_78272;\n                        d_haversine_res_78375 = eta_p_78273;\n                        d_haversine_res_78376 = eta_p_78272;\n                    } else {\n                        double zt_res_78377;\n                        double zs_res_78378;\n                        double zt_res_78379;\n                        double zs_r", "es_78380;\n                        \n                        zt_res_78377 = 3.141592653589793 * eta_p_78272;\n                        zs_res_78378 = zt_res_78377 / 180.0;\n                        zt_res_78379 = 3.141592653589793 * eta_p_78273;\n                        zs_res_78380 = zt_res_78379 / 180.0;\n                        d_haversine_res_78374 = zs_res_78378;\n                        d_haversine_res_78375 = zs_res_78380;\n                        d_haversine_res_78376 = zs_res_78378;\n                    }\n                    zm_res_78381 = d_haversine_res_78374 - d_haversine_res_78376;\n                    cos_res_78382 = futrts_cos64(zm_res_78381);\n                    zm_res_78383 = 1.0 - cos_res_78382;\n                    cos_res_78384 = futrts_cos64(d_haversine_res_78376);\n                    cos_res_78385 = futrts_cos64(d_haversine_res_78374);\n                    zt_res_78386 = cos_res_78384 * cos_res_78385;\n                    zm_res_78387 = d_haversine_res_78375 - d_haversine_res_78268;\n                    zm_res_78388 = 1.0 - zm_res_78387;\n                    zt_res_78389 = zt_res_78386 * zm_res_78388;\n                    zp_res_78390 = zm_res_78383 + zt_res_78389;\n                    zs_res_78391 = zp_res_78390 / 2.0;\n                    min_res_78392 = fmin64(1.0, zs_res_78391);\n                    zt_res_78393 = 2.0 * min_res_78392;\n                    zm_res_78394 = 1.0 - zt_res_78393;\n                    acos_res_78395 = futrts_acos64(zm_res_78394);\n                    zt_res_78396 = clBase_36773 * acos_res_78395;\n                    dist_res_78371 = zt_res_78396;\n                }\n                zlze_res_78397 = dist_res_78371 <= clBase_36767;\n                x_78398 = !zlze_res_78370;\n                y_78399 = zlze_res_78397 && x_78398;\n                cond_f_res_t_res_78400 = zlze_res_78370 || y_78399;\n                x_78401 = x_78343 && cond_f_res_t_res_78400;\n                x_78402 = !x_78340;\n                y_78403 = x_78401 && x_78402;\n          ", "      cond_78404 = x_78340 || y_78403;\n                zlze_res_78405 = eta_p_78272 <= zp_res_78249;\n                if (zlze_res_78405) {\n                    corn_x_78406 = zp_res_78249;\n                } else {\n                    corn_x_78406 = zp_res_78255;\n                }\n                zlze_res_78407 = eta_p_78273 <= zp_res_78254;\n                if (zlze_res_78407) {\n                    corn_y_78408 = zp_res_78254;\n                } else {\n                    corn_y_78408 = zp_res_78256;\n                }\n                if (clBase_36766 == (int8_t) 0) {\n                    bool eq_x_y_78410;\n                    bool eq_x_zz_78411;\n                    bool p_and_eq_x_y_78412;\n                    bool not_p_78413;\n                    bool p_and_eq_x_y_78414;\n                    bool zeze_res_78415;\n                    double d_euclidean_res_78416;\n                    \n                    eq_x_y_78410 = eta_p_78272 == zp_res_78249;\n                    eq_x_zz_78411 = eta_p_78272 == zp_res_78255;\n                    p_and_eq_x_y_78412 = zlze_res_78405 && eq_x_y_78410;\n                    not_p_78413 = !zlze_res_78405;\n                    p_and_eq_x_y_78414 = eq_x_zz_78411 && not_p_78413;\n                    zeze_res_78415 = p_and_eq_x_y_78412 || p_and_eq_x_y_78414;\n                    if (zeze_res_78415) {\n                        double zm_res_78417;\n                        double abs_res_78418;\n                        \n                        zm_res_78417 = eta_p_78273 - corn_y_78408;\n                        abs_res_78418 = fabs64(zm_res_78417);\n                        d_euclidean_res_78416 = abs_res_78418;\n                    } else {\n                        bool eq_x_y_78419;\n                        bool eq_x_zz_78420;\n                        bool p_and_eq_x_y_78421;\n                        bool not_p_78422;\n                        bool p_and_eq_x_y_78423;\n                        bool zeze_res_78424;\n                        double d_euclidean_res_f_res_784",
                                    "25;\n                        \n                        eq_x_y_78419 = eta_p_78273 == zp_res_78254;\n                        eq_x_zz_78420 = eta_p_78273 == zp_res_78256;\n                        p_and_eq_x_y_78421 = zlze_res_78407 && eq_x_y_78419;\n                        not_p_78422 = !zlze_res_78407;\n                        p_and_eq_x_y_78423 = eq_x_zz_78420 && not_p_78422;\n                        zeze_res_78424 = p_and_eq_x_y_78421 || p_and_eq_x_y_78423;\n                        if (zeze_res_78424) {\n                            double zm_res_78426;\n                            double abs_res_78427;\n                            \n                            zm_res_78426 = eta_p_78272 - corn_x_78406;\n                            abs_res_78427 = fabs64(zm_res_78426);\n                            d_euclidean_res_f_res_78425 = abs_res_78427;\n                        } else {\n                            double zm_res_78428;\n                            double zm_res_78429;\n                            double hypot_res_78430;\n                            \n                            zm_res_78428 = eta_p_78273 - corn_y_78408;\n                            zm_res_78429 = eta_p_78272 - corn_x_78406;\n                            hypot_res_78430 = futrts_hypot64(zm_res_78429, zm_res_78428);\n                            d_euclidean_res_f_res_78425 = hypot_res_78430;\n                        }\n                        d_euclidean_res_78416 = d_euclidean_res_f_res_78425;\n                    }\n                    dist_res_78409 = d_euclidean_res_78416;\n                } else {\n                    double d_haversine_res_78431;\n                    double d_haversine_res_78432;\n                    double d_haversine_res_78433;\n                    double d_haversine_res_78434;\n                    double zm_res_78443;\n                    double cos_res_78444;\n                    double zm_res_78445;\n                    double cos_res_78446;\n                    double cos_res_78447;\n                    dou", "ble zt_res_78448;\n                    double zm_res_78449;\n                    double zm_res_78450;\n                    double zt_res_78451;\n                    double zp_res_78452;\n                    double zs_res_78453;\n                    double min_res_78454;\n                    double zt_res_78455;\n                    double zm_res_78456;\n                    double acos_res_78457;\n                    double zt_res_78458;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_78431 = eta_p_78272;\n                        d_haversine_res_78432 = eta_p_78273;\n                        d_haversine_res_78433 = corn_x_78406;\n                        d_haversine_res_78434 = corn_y_78408;\n                    } else {\n                        double zt_res_78435;\n                        double zs_res_78436;\n                        double zt_res_78437;\n                        double zs_res_78438;\n                        double zt_res_78439;\n                        double zs_res_78440;\n                        double zt_res_78441;\n                        double zs_res_78442;\n                        \n                        zt_res_78435 = 3.141592653589793 * eta_p_78272;\n                        zs_res_78436 = zt_res_78435 / 180.0;\n                        zt_res_78437 = 3.141592653589793 * eta_p_78273;\n                        zs_res_78438 = zt_res_78437 / 180.0;\n                        zt_res_78439 = 3.141592653589793 * corn_x_78406;\n                        zs_res_78440 = zt_res_78439 / 180.0;\n                        zt_res_78441 = 3.141592653589793 * corn_y_78408;\n                        zs_res_78442 = zt_res_78441 / 180.0;\n                        d_haversine_res_78431 = zs_res_78436;\n                        d_haversine_res_78432 = zs_res_78438;\n                        d_haversine_res_78433 = zs_res_78440;\n                        d_haversine_res_78434 = zs_res_78442;\n                    }\n                    zm_res_784", "43 = d_haversine_res_78431 - d_haversine_res_78433;\n                    cos_res_78444 = futrts_cos64(zm_res_78443);\n                    zm_res_78445 = 1.0 - cos_res_78444;\n                    cos_res_78446 = futrts_cos64(d_haversine_res_78433);\n                    cos_res_78447 = futrts_cos64(d_haversine_res_78431);\n                    zt_res_78448 = cos_res_78446 * cos_res_78447;\n                    zm_res_78449 = d_haversine_res_78432 - d_haversine_res_78434;\n                    zm_res_78450 = 1.0 - zm_res_78449;\n                    zt_res_78451 = zt_res_78448 * zm_res_78450;\n                    zp_res_78452 = zm_res_78445 + zt_res_78451;\n                    zs_res_78453 = zp_res_78452 / 2.0;\n                    min_res_78454 = fmin64(1.0, zs_res_78453);\n                    zt_res_78455 = 2.0 * min_res_78454;\n                    zm_res_78456 = 1.0 - zt_res_78455;\n                    acos_res_78457 = futrts_acos64(zm_res_78456);\n                    zt_res_78458 = clBase_36773 * acos_res_78457;\n                    dist_res_78409 = zt_res_78458;\n                }\n                zlze_res_78459 = dist_res_78409 <= clBase_36767;\n                x_78460 = !cond_78404;\n                y_78461 = zlze_res_78459 && x_78460;\n                is_pt_marginal_res_78462 = cond_78404 || y_78461;\n                defunc_0_op_res_78465 = is_pt_marginal_res_78462 || redout_81494;\n                redout_tmp_83552 = defunc_0_op_res_78465;\n                redout_81494 = redout_tmp_83552;\n            }\n            defunc_0_reduce_res_78271 = redout_81494;\n            defunc_0_f_res_78238 = defunc_0_reduce_res_78271;\n        }\n        defunc_0_f_res_78466 = btoi_bool_i64(defunc_0_f_res_78238);\n        postlude_78225 = defunc_0_f_res_78466;\n        postlude_78226 = defunc_0_f_res_78237;\n        postlude_78227 = lifted_lambda_res_78230;\n    } else {\n        postlude_78225 = (int64_t) 0;\n        postlude_78226 = (int64_t) 0;\n        postlude_78227 = 0;\n    }\n    mem_82043[(int64_t) 0] = postl",
                                    "ude_78225;\n    mem_82047[(int64_t) 0] = postlude_78226;\n    mem_82050[(int64_t) 0] = postlude_78227;\n    \n  error_8:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540), (int64_t) 8)) {\n        int64_t tmp_83553 = mem_82043[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82051)[sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540)] = tmp_83553;\n    }\n    if (slt64(sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540), (int64_t) 8)) {\n        int64_t tmp_83554 = mem_82047[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82052)[sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540)] = tmp_83554;\n    }\n    if (slt64(sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540), (int64_t) 8)) {\n        bool tmp_83555 = mem_82050[(int64_t) 0];\n        \n        ((__global bool *) mem_82053)[sext_i32_i64(local_tid_83539) + tile_sizze_78072 * sext_i32_i64(block_id_83540)] = tmp_83555;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_78072\n    #undef ldim_78073\n    #undef bytes_82028\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegmap_intrablock_78474_dim1, 1, 1)\nvoid add_next_partition_doublezisegmap_intrablock_78474(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36773, double zt_res_59476, int64_t ldim_78477, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82109)\n{\n    #define tile_sizze_78476 (add_next_partition_doublezisegmap_intrablock_78474zitile_sizze_78476", ")\n    #define num_whole_tiles_78497 (add_next_partition_doublezisegmap_intrablock_78474zinum_whole_tiles_78497)\n    #define residual_input_79224 (add_next_partition_doublezisegmap_intrablock_78474ziresidual_input_79224)\n    #define cond_79225 (add_next_partition_doublezisegmap_intrablock_78474zicond_79225)\n    #define binop_x_79235 (add_next_partition_doublezisegmap_intrablock_78474zibinop_x_79235)\n    #define bytes_82097 (add_next_partition_doublezisegmap_intrablock_78474zibytes_82097)\n    \n    volatile __local unsigned char *color_83088_backing_0 = &shared_mem[0];\n    const int64_t color_83088_backing_0_offset = 0 + (bytes_82097 + srem64((int64_t) 8 - srem64(bytes_82097, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_84106;\n    int32_t tblock_sizze_84109;\n    int32_t wave_sizze_84108;\n    int32_t block_id_84107;\n    int32_t global_tid_84105;\n    int64_t gid_flat_78474;\n    int64_t slice_84111;\n    int64_t ltid_pre_84110;\n    int64_t remnant_84112;\n    int64_t slice_84113;\n    int64_t gid_78473;\n    int64_t remnant_84114;\n    __local unsigned char *color_83088;\n    int64_t binop_x_78486;\n    double mem_82088[1];\n    double mem_82092[1];\n    int64_t ltid_flat_78479;\n    int64_t ltid_78478;\n    int64_t gtid_78487;\n    bool cond_78488;\n    double pre_78489;\n    double pre_78490;\n    bool mem_82095[1];\n    int64_t ltid_flat_78499;\n    int64_t ltid_78498;\n    bool ext_mem_82102[1];\n    bool mem_param_82096[1];\n    bool mem_82107[1];\n    bool ext_mem_82108[1];\n    \n    local_tid_84106 = get_local_id(0);\n    tblock_sizze_84109 = get_local_size(0);\n    wave_sizze_84108 = LOCKSTEP_WIDTH;\n    block_id_84107 = get_tblock_id(0);\n    global_tid_84105 = block_id_84107 * tblock_sizze_84109 + local_tid_84106;\n    gid_flat_78474 = sext_i32_i64(b", "lock_id_84107);\n    slice_84111 = tile_sizze_78476;\n    ltid_pre_84110 = sext_i32_i64(local_tid_84106);\n    remnant_84112 = sext_i32_i64(local_tid_84106) - ltid_pre_84110;\n    slice_84113 = ldim_78477;\n    gid_78473 = sext_i32_i64(block_id_84107);\n    remnant_84114 = sext_i32_i64(block_id_84107) - gid_78473;\n    color_83088 = (__local unsigned char *) color_83088_backing_0;\n    binop_x_78486 = gid_78473 * tile_sizze_78476;\n    ltid_flat_78479 = sext_i32_i64(local_tid_84106);\n    ltid_78478 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n    gtid_78487 = ltid_78478 + binop_x_78486;\n    cond_78488 = slt64(gtid_78487, n_new_36762);\n    if (cond_78488) {\n        double eta_p_78491;\n        double eta_p_78492;\n        \n        eta_p_78491 = ((__global double *) new_xs_mem_81952)[gtid_78487];\n        eta_p_78492 = ((__global double *) new_ys_mem_81953)[gtid_78487];\n        pre_78489 = eta_p_78491;\n        pre_78490 = eta_p_78492;\n    } else {\n        pre_78489 = 0.0;\n        pre_78490 = 0.0;\n    }\n    mem_82088[(int64_t) 0] = pre_78489;\n    mem_82092[(int64_t) 0] = pre_78490;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78499 = sext_i32_i64(local_tid_84106);\n    ltid_78498 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n    mem_82095[(int64_t) 0] = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_1 = 0; i_1 < 1; i_1++)\n        mem_param_82096[i_1] = mem_82095[i_1];\n    for (int64_t tile_id_78505 = 0; tile_id_78505 < num_whole_tiles_78497; tile_id_78505++) {\n        int64_t binop_x_78764;\n        int64_t ltid_flat_78763;\n        int64_t ltid_78762;\n        int64_t j_78765;\n        bool cond_78770;\n        int64_t pre1d_78771;\n        bool mem_82101[1];\n        int64_t ltid_flat_78776;\n        int64_t ltid_78775;\n        int64_t gtid_78778;\n        bool acc_78781;\n        bool cond_78782;\n        bool acc_78783;\n        bool mem_param_tmp_84115[1];\n        \n        binop_x_78764 = tile_sizze_78476 * tile_id_78505;\n        ltid_flat_78",
                                    "763 = sext_i32_i64(local_tid_84106);\n        ltid_78762 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n        j_78765 = ltid_78762 + binop_x_78764;\n        cond_78770 = slt64(j_78765, (int64_t) 8);\n        if (cond_78770) {\n            int64_t tile_elem_78772 = ((__global int64_t *) mem_82001)[j_78765];\n            \n            pre1d_78771 = tile_elem_78772;\n        } else {\n            pre1d_78771 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83088)[ltid_78762] = pre1d_78771;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78776 = sext_i32_i64(local_tid_84106);\n        ltid_78775 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n        gtid_78778 = binop_x_78486 + ltid_78775;\n        acc_78781 = mem_param_82096[(int64_t) 0];\n        cond_78782 = slt64(gtid_78778, n_new_36762);\n        if (cond_78782) {\n            double eta_p_78779;\n            double eta_p_78780;\n            bool x_78784;\n            bool redout_81498;\n            \n            eta_p_78779 = mem_82088[(int64_t) 0];\n            eta_p_78780 = mem_82092[(int64_t) 0];\n            redout_81498 = acc_78781;\n            for (int64_t i_81499 = 0; i_81499 < tile_sizze_78476; i_81499++) {\n                int64_t eta_p_78785;\n                bool cond_78786;\n                bool defunc_0_f_res_78787;\n                bool defunc_0_op_res_79003;\n                bool redout_tmp_84117;\n                \n                eta_p_78785 = ((__local int64_t *) color_83088)[i_81499];\n                cond_78786 = slt64(eta_p_78785, (int64_t) 0);\n                if (cond_78786) {\n                    defunc_0_f_res_78787 = 0;\n                } else {\n                    int64_t zv_rhs_78788;\n                    bool zzero_78789;\n                    bool nonzzero_78790;\n                    bool nonzzero_cert_78791;\n                    int64_t nxid_78792;\n                    int64_t nyid_78793;\n                    double times_arg1_78794;\n                    double i64_res_78795;\n                    double ", "zt_res_78796;\n                    double plus_arg0_78797;\n                    double zp_res_78798;\n                    double times_arg1_78799;\n                    double i64_res_78800;\n                    double zt_res_78801;\n                    double plus_arg0_78802;\n                    double zp_res_78803;\n                    double zp_res_78804;\n                    double zp_res_78805;\n                    bool zgze_res_78806;\n                    bool zlze_res_78807;\n                    bool x_78808;\n                    double zt_res_78809;\n                    double zt_res_78810;\n                    double dist_res_78811;\n                    bool zlze_res_78842;\n                    double dist_res_78843;\n                    bool zlze_res_78874;\n                    bool x_78875;\n                    bool y_78876;\n                    bool cond_t_res_78877;\n                    bool x_78878;\n                    bool zgze_res_78879;\n                    bool zlze_res_78880;\n                    bool x_78881;\n                    double dist_res_78882;\n                    bool zlze_res_78909;\n                    double dist_res_78910;\n                    bool zlze_res_78937;\n                    bool x_78938;\n                    bool y_78939;\n                    bool cond_f_res_t_res_78940;\n                    bool x_78941;\n                    bool x_78942;\n                    bool y_78943;\n                    bool cond_78944;\n                    bool zlze_res_78945;\n                    double corn_x_78946;\n                    bool zlze_res_78947;\n                    double corn_y_78948;\n                    double dist_res_78949;\n                    bool zlze_res_78997;\n                    bool x_78998;\n                    bool y_78999;\n                    bool is_pt_marginal_res_79000;\n                    \n                    zv_rhs_78788 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n                    zzero_78789 = zv_rhs_78788 == (int64_t) 0;\n               ", "     nonzzero_78790 = !zzero_78789;\n                    if (!nonzzero_78790) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_4;\n                        }\n                    }\n                    nxid_78792 = smod64(eta_p_78785, zv_rhs_78788);\n                    nyid_78793 = sdiv64(eta_p_78785, zv_rhs_78788);\n                    times_arg1_78794 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n                    i64_res_78795 = sitofp_i64_f64(nxid_78792);\n                    zt_res_78796 = times_arg1_78794 * i64_res_78795;\n                    plus_arg0_78797 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n                    zp_res_78798 = zt_res_78796 + plus_arg0_78797;\n                    times_arg1_78799 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n                    i64_res_78800 = sitofp_i64_f64(nyid_78793);\n                    zt_res_78801 = times_arg1_78799 * i64_res_78800;\n                    plus_arg0_78802 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n                    zp_res_78803 = zt_res_78801 + plus_arg0_78802;\n                    zp_res_78804 = times_arg1_78794 + zp_res_78798;\n                    zp_res_78805 = times_arg1_78799 + zp_res_78803;\n                    zgze_res_78806 = zp_res_78803 <= eta_p_78780;\n                    zlze_res_78807 = eta_p_78780 <= zp_res_78805;\n                    x_78808 = zgze_res_78806 && zlze_res_78807;\n                    zt_res_78809 = 3.141592653589793 * eta_p_78779;\n                    zt_res_78810 = 3.141592653589793 * eta_p_78780;\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool zeze_res_78812;\n                        double d_euclidean_res_78813;\n                        \n                        zeze_res_78812 = eta_p_78779 ==",
                                    " zp_res_78798;\n                        if (zeze_res_78812) {\n                            double zm_res_78814;\n                            double abs_res_78815;\n                            \n                            zm_res_78814 = eta_p_78780 - eta_p_78780;\n                            abs_res_78815 = fabs64(zm_res_78814);\n                            d_euclidean_res_78813 = abs_res_78815;\n                        } else {\n                            double zm_res_78816;\n                            double abs_res_78817;\n                            \n                            zm_res_78816 = eta_p_78779 - zp_res_78798;\n                            abs_res_78817 = fabs64(zm_res_78816);\n                            d_euclidean_res_78813 = abs_res_78817;\n                        }\n                        dist_res_78811 = d_euclidean_res_78813;\n                    } else {\n                        double d_haversine_res_78818;\n                        double d_haversine_res_78819;\n                        double d_haversine_res_78820;\n                        double d_haversine_res_78821;\n                        double zm_res_78826;\n                        double cos_res_78827;\n                        double zm_res_78828;\n                        double cos_res_78829;\n                        double cos_res_78830;\n                        double zt_res_78831;\n                        double zm_res_78832;\n                        double zm_res_78833;\n                        double zt_res_78834;\n                        double zp_res_78835;\n                        double zs_res_78836;\n                        double min_res_78837;\n                        double zt_res_78838;\n                        double zm_res_78839;\n                        double acos_res_78840;\n                        double zt_res_78841;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_78818 = eta_p_78779;\n                            d_have", "rsine_res_78819 = eta_p_78780;\n                            d_haversine_res_78820 = zp_res_78798;\n                            d_haversine_res_78821 = eta_p_78780;\n                        } else {\n                            double zs_res_78822;\n                            double zs_res_78823;\n                            double zt_res_78824;\n                            double zs_res_78825;\n                            \n                            zs_res_78822 = zt_res_78809 / 180.0;\n                            zs_res_78823 = zt_res_78810 / 180.0;\n                            zt_res_78824 = 3.141592653589793 * zp_res_78798;\n                            zs_res_78825 = zt_res_78824 / 180.0;\n                            d_haversine_res_78818 = zs_res_78822;\n                            d_haversine_res_78819 = zs_res_78823;\n                            d_haversine_res_78820 = zs_res_78825;\n                            d_haversine_res_78821 = zs_res_78823;\n                        }\n                        zm_res_78826 = d_haversine_res_78818 - d_haversine_res_78820;\n                        cos_res_78827 = futrts_cos64(zm_res_78826);\n                        zm_res_78828 = 1.0 - cos_res_78827;\n                        cos_res_78829 = futrts_cos64(d_haversine_res_78820);\n                        cos_res_78830 = futrts_cos64(d_haversine_res_78818);\n                        zt_res_78831 = cos_res_78829 * cos_res_78830;\n                        zm_res_78832 = d_haversine_res_78819 - d_haversine_res_78821;\n                        zm_res_78833 = 1.0 - zm_res_78832;\n                        zt_res_78834 = zt_res_78831 * zm_res_78833;\n                        zp_res_78835 = zm_res_78828 + zt_res_78834;\n                        zs_res_78836 = zp_res_78835 / 2.0;\n                        min_res_78837 = fmin64(1.0, zs_res_78836);\n                        zt_res_78838 = 2.0 * min_res_78837;\n                        zm_res_78839 = 1.0 - zt_res_78838;\n                        acos_res_78840 = futrts_acos64", "(zm_res_78839);\n                        zt_res_78841 = clBase_36773 * acos_res_78840;\n                        dist_res_78811 = zt_res_78841;\n                    }\n                    zlze_res_78842 = dist_res_78811 <= zt_res_59476;\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool zeze_res_78844;\n                        double d_euclidean_res_78845;\n                        \n                        zeze_res_78844 = eta_p_78779 == zp_res_78804;\n                        if (zeze_res_78844) {\n                            double zm_res_78846;\n                            double abs_res_78847;\n                            \n                            zm_res_78846 = eta_p_78780 - eta_p_78780;\n                            abs_res_78847 = fabs64(zm_res_78846);\n                            d_euclidean_res_78845 = abs_res_78847;\n                        } else {\n                            double zm_res_78848;\n                            double abs_res_78849;\n                            \n                            zm_res_78848 = eta_p_78779 - zp_res_78804;\n                            abs_res_78849 = fabs64(zm_res_78848);\n                            d_euclidean_res_78845 = abs_res_78849;\n                        }\n                        dist_res_78843 = d_euclidean_res_78845;\n                    } else {\n                        double d_haversine_res_78850;\n                        double d_haversine_res_78851;\n                        double d_haversine_res_78852;\n                        double d_haversine_res_78853;\n                        double zm_res_78858;\n                        double cos_res_78859;\n                        double zm_res_78860;\n                        double cos_res_78861;\n                        double cos_res_78862;\n                        double zt_res_78863;\n                        double zm_res_78864;\n                        double zm_res_78865;\n                        double zt_res_78866;\n                        double zp_r",
                                    "es_78867;\n                        double zs_res_78868;\n                        double min_res_78869;\n                        double zt_res_78870;\n                        double zm_res_78871;\n                        double acos_res_78872;\n                        double zt_res_78873;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_78850 = eta_p_78779;\n                            d_haversine_res_78851 = eta_p_78780;\n                            d_haversine_res_78852 = zp_res_78804;\n                            d_haversine_res_78853 = eta_p_78780;\n                        } else {\n                            double zs_res_78854;\n                            double zs_res_78855;\n                            double zt_res_78856;\n                            double zs_res_78857;\n                            \n                            zs_res_78854 = zt_res_78809 / 180.0;\n                            zs_res_78855 = zt_res_78810 / 180.0;\n                            zt_res_78856 = 3.141592653589793 * zp_res_78804;\n                            zs_res_78857 = zt_res_78856 / 180.0;\n                            d_haversine_res_78850 = zs_res_78854;\n                            d_haversine_res_78851 = zs_res_78855;\n                            d_haversine_res_78852 = zs_res_78857;\n                            d_haversine_res_78853 = zs_res_78855;\n                        }\n                        zm_res_78858 = d_haversine_res_78850 - d_haversine_res_78852;\n                        cos_res_78859 = futrts_cos64(zm_res_78858);\n                        zm_res_78860 = 1.0 - cos_res_78859;\n                        cos_res_78861 = futrts_cos64(d_haversine_res_78852);\n                        cos_res_78862 = futrts_cos64(d_haversine_res_78850);\n                        zt_res_78863 = cos_res_78861 * cos_res_78862;\n                        zm_res_78864 = d_haversine_res_78851 - d_haversine_res_78853;\n                        zm_re", "s_78865 = 1.0 - zm_res_78864;\n                        zt_res_78866 = zt_res_78863 * zm_res_78865;\n                        zp_res_78867 = zm_res_78860 + zt_res_78866;\n                        zs_res_78868 = zp_res_78867 / 2.0;\n                        min_res_78869 = fmin64(1.0, zs_res_78868);\n                        zt_res_78870 = 2.0 * min_res_78869;\n                        zm_res_78871 = 1.0 - zt_res_78870;\n                        acos_res_78872 = futrts_acos64(zm_res_78871);\n                        zt_res_78873 = clBase_36773 * acos_res_78872;\n                        dist_res_78843 = zt_res_78873;\n                    }\n                    zlze_res_78874 = dist_res_78843 <= zt_res_59476;\n                    x_78875 = !zlze_res_78842;\n                    y_78876 = zlze_res_78874 && x_78875;\n                    cond_t_res_78877 = zlze_res_78842 || y_78876;\n                    x_78878 = x_78808 && cond_t_res_78877;\n                    zgze_res_78879 = zp_res_78798 <= eta_p_78779;\n                    zlze_res_78880 = eta_p_78779 <= zp_res_78804;\n                    x_78881 = zgze_res_78879 && zlze_res_78880;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_78883;\n                        double abs_res_78884;\n                        \n                        zm_res_78883 = eta_p_78780 - zp_res_78803;\n                        abs_res_78884 = fabs64(zm_res_78883);\n                        dist_res_78882 = abs_res_78884;\n                    } else {\n                        double d_haversine_res_78885;\n                        double d_haversine_res_78886;\n                        double d_haversine_res_78887;\n                        double d_haversine_res_78888;\n                        double zm_res_78893;\n                        double cos_res_78894;\n                        double zm_res_78895;\n                        double cos_res_78896;\n                        double cos_res_78897;\n                        double zt_res_78898;\n     ", "                   double zm_res_78899;\n                        double zm_res_78900;\n                        double zt_res_78901;\n                        double zp_res_78902;\n                        double zs_res_78903;\n                        double min_res_78904;\n                        double zt_res_78905;\n                        double zm_res_78906;\n                        double acos_res_78907;\n                        double zt_res_78908;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_78885 = eta_p_78779;\n                            d_haversine_res_78886 = eta_p_78780;\n                            d_haversine_res_78887 = eta_p_78779;\n                            d_haversine_res_78888 = zp_res_78803;\n                        } else {\n                            double zs_res_78889;\n                            double zs_res_78890;\n                            double zt_res_78891;\n                            double zs_res_78892;\n                            \n                            zs_res_78889 = zt_res_78809 / 180.0;\n                            zs_res_78890 = zt_res_78810 / 180.0;\n                            zt_res_78891 = 3.141592653589793 * zp_res_78803;\n                            zs_res_78892 = zt_res_78891 / 180.0;\n                            d_haversine_res_78885 = zs_res_78889;\n                            d_haversine_res_78886 = zs_res_78890;\n                            d_haversine_res_78887 = zs_res_78889;\n                            d_haversine_res_78888 = zs_res_78892;\n                        }\n                        zm_res_78893 = d_haversine_res_78885 - d_haversine_res_78887;\n                        cos_res_78894 = futrts_cos64(zm_res_78893);\n                        zm_res_78895 = 1.0 - cos_res_78894;\n                        cos_res_78896 = futrts_cos64(d_haversine_res_78887);\n                        cos_res_78897 = futrts_cos64(d_haversine_res_78885);\n                    ",
                                    "    zt_res_78898 = cos_res_78896 * cos_res_78897;\n                        zm_res_78899 = d_haversine_res_78886 - d_haversine_res_78888;\n                        zm_res_78900 = 1.0 - zm_res_78899;\n                        zt_res_78901 = zt_res_78898 * zm_res_78900;\n                        zp_res_78902 = zm_res_78895 + zt_res_78901;\n                        zs_res_78903 = zp_res_78902 / 2.0;\n                        min_res_78904 = fmin64(1.0, zs_res_78903);\n                        zt_res_78905 = 2.0 * min_res_78904;\n                        zm_res_78906 = 1.0 - zt_res_78905;\n                        acos_res_78907 = futrts_acos64(zm_res_78906);\n                        zt_res_78908 = clBase_36773 * acos_res_78907;\n                        dist_res_78882 = zt_res_78908;\n                    }\n                    zlze_res_78909 = dist_res_78882 <= zt_res_59476;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_78911;\n                        double abs_res_78912;\n                        \n                        zm_res_78911 = eta_p_78780 - zp_res_78805;\n                        abs_res_78912 = fabs64(zm_res_78911);\n                        dist_res_78910 = abs_res_78912;\n                    } else {\n                        double d_haversine_res_78913;\n                        double d_haversine_res_78914;\n                        double d_haversine_res_78915;\n                        double d_haversine_res_78916;\n                        double zm_res_78921;\n                        double cos_res_78922;\n                        double zm_res_78923;\n                        double cos_res_78924;\n                        double cos_res_78925;\n                        double zt_res_78926;\n                        double zm_res_78927;\n                        double zm_res_78928;\n                        double zt_res_78929;\n                        double zp_res_78930;\n                        double zs_res_78931;\n                        double min_res_7", "8932;\n                        double zt_res_78933;\n                        double zm_res_78934;\n                        double acos_res_78935;\n                        double zt_res_78936;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_78913 = eta_p_78779;\n                            d_haversine_res_78914 = eta_p_78780;\n                            d_haversine_res_78915 = eta_p_78779;\n                            d_haversine_res_78916 = zp_res_78805;\n                        } else {\n                            double zs_res_78917;\n                            double zs_res_78918;\n                            double zt_res_78919;\n                            double zs_res_78920;\n                            \n                            zs_res_78917 = zt_res_78809 / 180.0;\n                            zs_res_78918 = zt_res_78810 / 180.0;\n                            zt_res_78919 = 3.141592653589793 * zp_res_78805;\n                            zs_res_78920 = zt_res_78919 / 180.0;\n                            d_haversine_res_78913 = zs_res_78917;\n                            d_haversine_res_78914 = zs_res_78918;\n                            d_haversine_res_78915 = zs_res_78917;\n                            d_haversine_res_78916 = zs_res_78920;\n                        }\n                        zm_res_78921 = d_haversine_res_78913 - d_haversine_res_78915;\n                        cos_res_78922 = futrts_cos64(zm_res_78921);\n                        zm_res_78923 = 1.0 - cos_res_78922;\n                        cos_res_78924 = futrts_cos64(d_haversine_res_78915);\n                        cos_res_78925 = futrts_cos64(d_haversine_res_78913);\n                        zt_res_78926 = cos_res_78924 * cos_res_78925;\n                        zm_res_78927 = d_haversine_res_78914 - d_haversine_res_78916;\n                        zm_res_78928 = 1.0 - zm_res_78927;\n                        zt_res_78929 = zt_res_78926 * zm_res_7892", "8;\n                        zp_res_78930 = zm_res_78923 + zt_res_78929;\n                        zs_res_78931 = zp_res_78930 / 2.0;\n                        min_res_78932 = fmin64(1.0, zs_res_78931);\n                        zt_res_78933 = 2.0 * min_res_78932;\n                        zm_res_78934 = 1.0 - zt_res_78933;\n                        acos_res_78935 = futrts_acos64(zm_res_78934);\n                        zt_res_78936 = clBase_36773 * acos_res_78935;\n                        dist_res_78910 = zt_res_78936;\n                    }\n                    zlze_res_78937 = dist_res_78910 <= zt_res_59476;\n                    x_78938 = !zlze_res_78909;\n                    y_78939 = zlze_res_78937 && x_78938;\n                    cond_f_res_t_res_78940 = zlze_res_78909 || y_78939;\n                    x_78941 = x_78881 && cond_f_res_t_res_78940;\n                    x_78942 = !x_78878;\n                    y_78943 = x_78941 && x_78942;\n                    cond_78944 = x_78878 || y_78943;\n                    zlze_res_78945 = eta_p_78779 <= zp_res_78798;\n                    if (zlze_res_78945) {\n                        corn_x_78946 = zp_res_78798;\n                    } else {\n                        corn_x_78946 = zp_res_78804;\n                    }\n                    zlze_res_78947 = eta_p_78780 <= zp_res_78803;\n                    if (zlze_res_78947) {\n                        corn_y_78948 = zp_res_78803;\n                    } else {\n                        corn_y_78948 = zp_res_78805;\n                    }\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool eq_x_y_78950;\n                        bool eq_x_zz_78951;\n                        bool p_and_eq_x_y_78952;\n                        bool not_p_78953;\n                        bool p_and_eq_x_y_78954;\n                        bool zeze_res_78955;\n                        double d_euclidean_res_78956;\n                        \n                        eq_x_y_78950 = eta_p_78779 == zp_res_78798;\n           ",
                                    "             eq_x_zz_78951 = eta_p_78779 == zp_res_78804;\n                        p_and_eq_x_y_78952 = zlze_res_78945 && eq_x_y_78950;\n                        not_p_78953 = !zlze_res_78945;\n                        p_and_eq_x_y_78954 = eq_x_zz_78951 && not_p_78953;\n                        zeze_res_78955 = p_and_eq_x_y_78952 || p_and_eq_x_y_78954;\n                        if (zeze_res_78955) {\n                            double zm_res_78957;\n                            double abs_res_78958;\n                            \n                            zm_res_78957 = eta_p_78780 - corn_y_78948;\n                            abs_res_78958 = fabs64(zm_res_78957);\n                            d_euclidean_res_78956 = abs_res_78958;\n                        } else {\n                            bool eq_x_y_78959;\n                            bool eq_x_zz_78960;\n                            bool p_and_eq_x_y_78961;\n                            bool not_p_78962;\n                            bool p_and_eq_x_y_78963;\n                            bool zeze_res_78964;\n                            double d_euclidean_res_f_res_78965;\n                            \n                            eq_x_y_78959 = eta_p_78780 == zp_res_78803;\n                            eq_x_zz_78960 = eta_p_78780 == zp_res_78805;\n                            p_and_eq_x_y_78961 = zlze_res_78947 && eq_x_y_78959;\n                            not_p_78962 = !zlze_res_78947;\n                            p_and_eq_x_y_78963 = eq_x_zz_78960 && not_p_78962;\n                            zeze_res_78964 = p_and_eq_x_y_78961 || p_and_eq_x_y_78963;\n                            if (zeze_res_78964) {\n                                double zm_res_78966;\n                                double abs_res_78967;\n                                \n                                zm_res_78966 = eta_p_78779 - corn_x_78946;\n                                abs_res_78967 = fabs64(zm_res_78966);\n                                d_euclidean_res_f_res_78965 = abs_", "res_78967;\n                            } else {\n                                double zm_res_78968;\n                                double zm_res_78969;\n                                double hypot_res_78970;\n                                \n                                zm_res_78968 = eta_p_78780 - corn_y_78948;\n                                zm_res_78969 = eta_p_78779 - corn_x_78946;\n                                hypot_res_78970 = futrts_hypot64(zm_res_78969, zm_res_78968);\n                                d_euclidean_res_f_res_78965 = hypot_res_78970;\n                            }\n                            d_euclidean_res_78956 = d_euclidean_res_f_res_78965;\n                        }\n                        dist_res_78949 = d_euclidean_res_78956;\n                    } else {\n                        double d_haversine_res_78971;\n                        double d_haversine_res_78972;\n                        double d_haversine_res_78973;\n                        double d_haversine_res_78974;\n                        double zm_res_78981;\n                        double cos_res_78982;\n                        double zm_res_78983;\n                        double cos_res_78984;\n                        double cos_res_78985;\n                        double zt_res_78986;\n                        double zm_res_78987;\n                        double zm_res_78988;\n                        double zt_res_78989;\n                        double zp_res_78990;\n                        double zs_res_78991;\n                        double min_res_78992;\n                        double zt_res_78993;\n                        double zm_res_78994;\n                        double acos_res_78995;\n                        double zt_res_78996;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_78971 = eta_p_78779;\n                            d_haversine_res_78972 = eta_p_78780;\n                            d_haversine_res_78973", " = corn_x_78946;\n                            d_haversine_res_78974 = corn_y_78948;\n                        } else {\n                            double zs_res_78975;\n                            double zs_res_78976;\n                            double zt_res_78977;\n                            double zs_res_78978;\n                            double zt_res_78979;\n                            double zs_res_78980;\n                            \n                            zs_res_78975 = zt_res_78809 / 180.0;\n                            zs_res_78976 = zt_res_78810 / 180.0;\n                            zt_res_78977 = 3.141592653589793 * corn_x_78946;\n                            zs_res_78978 = zt_res_78977 / 180.0;\n                            zt_res_78979 = 3.141592653589793 * corn_y_78948;\n                            zs_res_78980 = zt_res_78979 / 180.0;\n                            d_haversine_res_78971 = zs_res_78975;\n                            d_haversine_res_78972 = zs_res_78976;\n                            d_haversine_res_78973 = zs_res_78978;\n                            d_haversine_res_78974 = zs_res_78980;\n                        }\n                        zm_res_78981 = d_haversine_res_78971 - d_haversine_res_78973;\n                        cos_res_78982 = futrts_cos64(zm_res_78981);\n                        zm_res_78983 = 1.0 - cos_res_78982;\n                        cos_res_78984 = futrts_cos64(d_haversine_res_78973);\n                        cos_res_78985 = futrts_cos64(d_haversine_res_78971);\n                        zt_res_78986 = cos_res_78984 * cos_res_78985;\n                        zm_res_78987 = d_haversine_res_78972 - d_haversine_res_78974;\n                        zm_res_78988 = 1.0 - zm_res_78987;\n                        zt_res_78989 = zt_res_78986 * zm_res_78988;\n                        zp_res_78990 = zm_res_78983 + zt_res_78989;\n                        zs_res_78991 = zp_res_78990 / 2.0;\n                        min_res_78992 = fmin64(1.0, zs_res_78991);\n            ",
                                    "            zt_res_78993 = 2.0 * min_res_78992;\n                        zm_res_78994 = 1.0 - zt_res_78993;\n                        acos_res_78995 = futrts_acos64(zm_res_78994);\n                        zt_res_78996 = clBase_36773 * acos_res_78995;\n                        dist_res_78949 = zt_res_78996;\n                    }\n                    zlze_res_78997 = dist_res_78949 <= zt_res_59476;\n                    x_78998 = !cond_78944;\n                    y_78999 = zlze_res_78997 && x_78998;\n                    is_pt_marginal_res_79000 = cond_78944 || y_78999;\n                    defunc_0_f_res_78787 = is_pt_marginal_res_79000;\n                }\n                defunc_0_op_res_79003 = defunc_0_f_res_78787 || redout_81498;\n                redout_tmp_84117 = defunc_0_op_res_79003;\n                redout_81498 = redout_tmp_84117;\n            }\n            x_78784 = redout_81498;\n            acc_78783 = x_78784;\n        } else {\n            acc_78783 = acc_78781;\n        }\n        mem_82101[(int64_t) 0] = acc_78783;\n        \n      error_4:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_2 = 0; i_2 < 1; i_2++)\n            mem_param_tmp_84115[i_2] = mem_82101[i_2];\n        for (int32_t i_3 = 0; i_3 < 1; i_3++)\n            mem_param_82096[i_3] = mem_param_tmp_84115[i_3];\n    }\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        ext_mem_82102[i_4] = mem_param_82096[i_4];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_79225) {\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            ext_mem_82108[i_5] = ext_mem_82102[i_5];\n    } else {\n        int64_t ltid_flat_79227;\n        int64_t ltid_79226;\n        int64_t j_79236;\n        bool cond_79241;\n        int64_t pre1d_79242;\n        int64_t ltid_flat_79248;\n        int64_t ltid_79247;\n        int64_t gtid_79255;\n        bool acc_79258;\n        bool cond_79259;\n        bool acc_79260;\n        \n        ltid_flat_79227 = sext_i32_i64(loca", "l_tid_84106);\n        ltid_79226 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n        j_79236 = ltid_79226 + binop_x_79235;\n        cond_79241 = slt64(j_79236, (int64_t) 8);\n        if (cond_79241) {\n            int64_t tile_elem_79243 = ((__global int64_t *) mem_82001)[j_79236];\n            \n            pre1d_79242 = tile_elem_79243;\n        } else {\n            pre1d_79242 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83088)[ltid_79226] = pre1d_79242;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79248 = sext_i32_i64(local_tid_84106);\n        ltid_79247 = sext_i32_i64(sext_i64_i32(ltid_pre_84110));\n        gtid_79255 = binop_x_78486 + ltid_79247;\n        acc_79258 = ext_mem_82102[(int64_t) 0];\n        cond_79259 = slt64(gtid_79255, n_new_36762);\n        if (cond_79259) {\n            double eta_p_79256;\n            double eta_p_79257;\n            bool x_79261;\n            bool redout_81500;\n            \n            eta_p_79256 = mem_82088[(int64_t) 0];\n            eta_p_79257 = mem_82092[(int64_t) 0];\n            redout_81500 = acc_79258;\n            for (int64_t i_81501 = 0; i_81501 < residual_input_79224; i_81501++) {\n                int64_t eta_p_79262;\n                bool cond_79263;\n                bool defunc_0_f_res_79264;\n                bool defunc_0_op_res_79480;\n                bool redout_tmp_84118;\n                \n                eta_p_79262 = ((__local int64_t *) color_83088)[i_81501];\n                cond_79263 = slt64(eta_p_79262, (int64_t) 0);\n                if (cond_79263) {\n                    defunc_0_f_res_79264 = 0;\n                } else {\n                    int64_t zv_rhs_79265;\n                    bool zzero_79266;\n                    bool nonzzero_79267;\n                    bool nonzzero_cert_79268;\n                    int64_t nxid_79269;\n                    int64_t nyid_79270;\n                    double times_arg1_79271;\n                    double i64_res_79272;\n                    double zt_res_79273;\n       ", "             double plus_arg0_79274;\n                    double zp_res_79275;\n                    double times_arg1_79276;\n                    double i64_res_79277;\n                    double zt_res_79278;\n                    double plus_arg0_79279;\n                    double zp_res_79280;\n                    double zp_res_79281;\n                    double zp_res_79282;\n                    bool zgze_res_79283;\n                    bool zlze_res_79284;\n                    bool x_79285;\n                    double zt_res_79286;\n                    double zt_res_79287;\n                    double dist_res_79288;\n                    bool zlze_res_79319;\n                    double dist_res_79320;\n                    bool zlze_res_79351;\n                    bool x_79352;\n                    bool y_79353;\n                    bool cond_t_res_79354;\n                    bool x_79355;\n                    bool zgze_res_79356;\n                    bool zlze_res_79357;\n                    bool x_79358;\n                    double dist_res_79359;\n                    bool zlze_res_79386;\n                    double dist_res_79387;\n                    bool zlze_res_79414;\n                    bool x_79415;\n                    bool y_79416;\n                    bool cond_f_res_t_res_79417;\n                    bool x_79418;\n                    bool x_79419;\n                    bool y_79420;\n                    bool cond_79421;\n                    bool zlze_res_79422;\n                    double corn_x_79423;\n                    bool zlze_res_79424;\n                    double corn_y_79425;\n                    double dist_res_79426;\n                    bool zlze_res_79474;\n                    bool x_79475;\n                    bool y_79476;\n                    bool is_pt_marginal_res_79477;\n                    \n                    zv_rhs_79265 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n                    zzero_79266 = zv_rhs_79265 == (int64_t) 0;\n                    nonzzero_79267 =",
                                    " !zzero_79266;\n                    if (!nonzzero_79267) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_7;\n                        }\n                    }\n                    nxid_79269 = smod64(eta_p_79262, zv_rhs_79265);\n                    nyid_79270 = sdiv64(eta_p_79262, zv_rhs_79265);\n                    times_arg1_79271 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n                    i64_res_79272 = sitofp_i64_f64(nxid_79269);\n                    zt_res_79273 = times_arg1_79271 * i64_res_79272;\n                    plus_arg0_79274 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n                    zp_res_79275 = zt_res_79273 + plus_arg0_79274;\n                    times_arg1_79276 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n                    i64_res_79277 = sitofp_i64_f64(nyid_79270);\n                    zt_res_79278 = times_arg1_79276 * i64_res_79277;\n                    plus_arg0_79279 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n                    zp_res_79280 = zt_res_79278 + plus_arg0_79279;\n                    zp_res_79281 = times_arg1_79271 + zp_res_79275;\n                    zp_res_79282 = times_arg1_79276 + zp_res_79280;\n                    zgze_res_79283 = zp_res_79280 <= eta_p_79257;\n                    zlze_res_79284 = eta_p_79257 <= zp_res_79282;\n                    x_79285 = zgze_res_79283 && zlze_res_79284;\n                    zt_res_79286 = 3.141592653589793 * eta_p_79256;\n                    zt_res_79287 = 3.141592653589793 * eta_p_79257;\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool zeze_res_79289;\n                        double d_euclidean_res_79290;\n                        \n                        zeze_res_79289 = eta_p_79256 == zp_res_79275;\n      ", "                  if (zeze_res_79289) {\n                            double zm_res_79291;\n                            double abs_res_79292;\n                            \n                            zm_res_79291 = eta_p_79257 - eta_p_79257;\n                            abs_res_79292 = fabs64(zm_res_79291);\n                            d_euclidean_res_79290 = abs_res_79292;\n                        } else {\n                            double zm_res_79293;\n                            double abs_res_79294;\n                            \n                            zm_res_79293 = eta_p_79256 - zp_res_79275;\n                            abs_res_79294 = fabs64(zm_res_79293);\n                            d_euclidean_res_79290 = abs_res_79294;\n                        }\n                        dist_res_79288 = d_euclidean_res_79290;\n                    } else {\n                        double d_haversine_res_79295;\n                        double d_haversine_res_79296;\n                        double d_haversine_res_79297;\n                        double d_haversine_res_79298;\n                        double zm_res_79303;\n                        double cos_res_79304;\n                        double zm_res_79305;\n                        double cos_res_79306;\n                        double cos_res_79307;\n                        double zt_res_79308;\n                        double zm_res_79309;\n                        double zm_res_79310;\n                        double zt_res_79311;\n                        double zp_res_79312;\n                        double zs_res_79313;\n                        double min_res_79314;\n                        double zt_res_79315;\n                        double zm_res_79316;\n                        double acos_res_79317;\n                        double zt_res_79318;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_79295 = eta_p_79256;\n                            d_haversine_res_79296 = eta", "_p_79257;\n                            d_haversine_res_79297 = zp_res_79275;\n                            d_haversine_res_79298 = eta_p_79257;\n                        } else {\n                            double zs_res_79299;\n                            double zs_res_79300;\n                            double zt_res_79301;\n                            double zs_res_79302;\n                            \n                            zs_res_79299 = zt_res_79286 / 180.0;\n                            zs_res_79300 = zt_res_79287 / 180.0;\n                            zt_res_79301 = 3.141592653589793 * zp_res_79275;\n                            zs_res_79302 = zt_res_79301 / 180.0;\n                            d_haversine_res_79295 = zs_res_79299;\n                            d_haversine_res_79296 = zs_res_79300;\n                            d_haversine_res_79297 = zs_res_79302;\n                            d_haversine_res_79298 = zs_res_79300;\n                        }\n                        zm_res_79303 = d_haversine_res_79295 - d_haversine_res_79297;\n                        cos_res_79304 = futrts_cos64(zm_res_79303);\n                        zm_res_79305 = 1.0 - cos_res_79304;\n                        cos_res_79306 = futrts_cos64(d_haversine_res_79297);\n                        cos_res_79307 = futrts_cos64(d_haversine_res_79295);\n                        zt_res_79308 = cos_res_79306 * cos_res_79307;\n                        zm_res_79309 = d_haversine_res_79296 - d_haversine_res_79298;\n                        zm_res_79310 = 1.0 - zm_res_79309;\n                        zt_res_79311 = zt_res_79308 * zm_res_79310;\n                        zp_res_79312 = zm_res_79305 + zt_res_79311;\n                        zs_res_79313 = zp_res_79312 / 2.0;\n                        min_res_79314 = fmin64(1.0, zs_res_79313);\n                        zt_res_79315 = 2.0 * min_res_79314;\n                        zm_res_79316 = 1.0 - zt_res_79315;\n                        acos_res_79317 = futrts_acos64(zm_res_79316);\n     ",
                                    "                   zt_res_79318 = clBase_36773 * acos_res_79317;\n                        dist_res_79288 = zt_res_79318;\n                    }\n                    zlze_res_79319 = dist_res_79288 <= zt_res_59476;\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool zeze_res_79321;\n                        double d_euclidean_res_79322;\n                        \n                        zeze_res_79321 = eta_p_79256 == zp_res_79281;\n                        if (zeze_res_79321) {\n                            double zm_res_79323;\n                            double abs_res_79324;\n                            \n                            zm_res_79323 = eta_p_79257 - eta_p_79257;\n                            abs_res_79324 = fabs64(zm_res_79323);\n                            d_euclidean_res_79322 = abs_res_79324;\n                        } else {\n                            double zm_res_79325;\n                            double abs_res_79326;\n                            \n                            zm_res_79325 = eta_p_79256 - zp_res_79281;\n                            abs_res_79326 = fabs64(zm_res_79325);\n                            d_euclidean_res_79322 = abs_res_79326;\n                        }\n                        dist_res_79320 = d_euclidean_res_79322;\n                    } else {\n                        double d_haversine_res_79327;\n                        double d_haversine_res_79328;\n                        double d_haversine_res_79329;\n                        double d_haversine_res_79330;\n                        double zm_res_79335;\n                        double cos_res_79336;\n                        double zm_res_79337;\n                        double cos_res_79338;\n                        double cos_res_79339;\n                        double zt_res_79340;\n                        double zm_res_79341;\n                        double zm_res_79342;\n                        double zt_res_79343;\n                        double zp_res_79344;\n           ", "             double zs_res_79345;\n                        double min_res_79346;\n                        double zt_res_79347;\n                        double zm_res_79348;\n                        double acos_res_79349;\n                        double zt_res_79350;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_79327 = eta_p_79256;\n                            d_haversine_res_79328 = eta_p_79257;\n                            d_haversine_res_79329 = zp_res_79281;\n                            d_haversine_res_79330 = eta_p_79257;\n                        } else {\n                            double zs_res_79331;\n                            double zs_res_79332;\n                            double zt_res_79333;\n                            double zs_res_79334;\n                            \n                            zs_res_79331 = zt_res_79286 / 180.0;\n                            zs_res_79332 = zt_res_79287 / 180.0;\n                            zt_res_79333 = 3.141592653589793 * zp_res_79281;\n                            zs_res_79334 = zt_res_79333 / 180.0;\n                            d_haversine_res_79327 = zs_res_79331;\n                            d_haversine_res_79328 = zs_res_79332;\n                            d_haversine_res_79329 = zs_res_79334;\n                            d_haversine_res_79330 = zs_res_79332;\n                        }\n                        zm_res_79335 = d_haversine_res_79327 - d_haversine_res_79329;\n                        cos_res_79336 = futrts_cos64(zm_res_79335);\n                        zm_res_79337 = 1.0 - cos_res_79336;\n                        cos_res_79338 = futrts_cos64(d_haversine_res_79329);\n                        cos_res_79339 = futrts_cos64(d_haversine_res_79327);\n                        zt_res_79340 = cos_res_79338 * cos_res_79339;\n                        zm_res_79341 = d_haversine_res_79328 - d_haversine_res_79330;\n                        zm_res_79342 = 1.0 - zm_re", "s_79341;\n                        zt_res_79343 = zt_res_79340 * zm_res_79342;\n                        zp_res_79344 = zm_res_79337 + zt_res_79343;\n                        zs_res_79345 = zp_res_79344 / 2.0;\n                        min_res_79346 = fmin64(1.0, zs_res_79345);\n                        zt_res_79347 = 2.0 * min_res_79346;\n                        zm_res_79348 = 1.0 - zt_res_79347;\n                        acos_res_79349 = futrts_acos64(zm_res_79348);\n                        zt_res_79350 = clBase_36773 * acos_res_79349;\n                        dist_res_79320 = zt_res_79350;\n                    }\n                    zlze_res_79351 = dist_res_79320 <= zt_res_59476;\n                    x_79352 = !zlze_res_79319;\n                    y_79353 = zlze_res_79351 && x_79352;\n                    cond_t_res_79354 = zlze_res_79319 || y_79353;\n                    x_79355 = x_79285 && cond_t_res_79354;\n                    zgze_res_79356 = zp_res_79275 <= eta_p_79256;\n                    zlze_res_79357 = eta_p_79256 <= zp_res_79281;\n                    x_79358 = zgze_res_79356 && zlze_res_79357;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_79360;\n                        double abs_res_79361;\n                        \n                        zm_res_79360 = eta_p_79257 - zp_res_79280;\n                        abs_res_79361 = fabs64(zm_res_79360);\n                        dist_res_79359 = abs_res_79361;\n                    } else {\n                        double d_haversine_res_79362;\n                        double d_haversine_res_79363;\n                        double d_haversine_res_79364;\n                        double d_haversine_res_79365;\n                        double zm_res_79370;\n                        double cos_res_79371;\n                        double zm_res_79372;\n                        double cos_res_79373;\n                        double cos_res_79374;\n                        double zt_res_79375;\n                        do",
                                    "uble zm_res_79376;\n                        double zm_res_79377;\n                        double zt_res_79378;\n                        double zp_res_79379;\n                        double zs_res_79380;\n                        double min_res_79381;\n                        double zt_res_79382;\n                        double zm_res_79383;\n                        double acos_res_79384;\n                        double zt_res_79385;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_79362 = eta_p_79256;\n                            d_haversine_res_79363 = eta_p_79257;\n                            d_haversine_res_79364 = eta_p_79256;\n                            d_haversine_res_79365 = zp_res_79280;\n                        } else {\n                            double zs_res_79366;\n                            double zs_res_79367;\n                            double zt_res_79368;\n                            double zs_res_79369;\n                            \n                            zs_res_79366 = zt_res_79286 / 180.0;\n                            zs_res_79367 = zt_res_79287 / 180.0;\n                            zt_res_79368 = 3.141592653589793 * zp_res_79280;\n                            zs_res_79369 = zt_res_79368 / 180.0;\n                            d_haversine_res_79362 = zs_res_79366;\n                            d_haversine_res_79363 = zs_res_79367;\n                            d_haversine_res_79364 = zs_res_79366;\n                            d_haversine_res_79365 = zs_res_79369;\n                        }\n                        zm_res_79370 = d_haversine_res_79362 - d_haversine_res_79364;\n                        cos_res_79371 = futrts_cos64(zm_res_79370);\n                        zm_res_79372 = 1.0 - cos_res_79371;\n                        cos_res_79373 = futrts_cos64(d_haversine_res_79364);\n                        cos_res_79374 = futrts_cos64(d_haversine_res_79362);\n                        zt_res_79375 = co", "s_res_79373 * cos_res_79374;\n                        zm_res_79376 = d_haversine_res_79363 - d_haversine_res_79365;\n                        zm_res_79377 = 1.0 - zm_res_79376;\n                        zt_res_79378 = zt_res_79375 * zm_res_79377;\n                        zp_res_79379 = zm_res_79372 + zt_res_79378;\n                        zs_res_79380 = zp_res_79379 / 2.0;\n                        min_res_79381 = fmin64(1.0, zs_res_79380);\n                        zt_res_79382 = 2.0 * min_res_79381;\n                        zm_res_79383 = 1.0 - zt_res_79382;\n                        acos_res_79384 = futrts_acos64(zm_res_79383);\n                        zt_res_79385 = clBase_36773 * acos_res_79384;\n                        dist_res_79359 = zt_res_79385;\n                    }\n                    zlze_res_79386 = dist_res_79359 <= zt_res_59476;\n                    if (clBase_36766 == (int8_t) 0) {\n                        double zm_res_79388;\n                        double abs_res_79389;\n                        \n                        zm_res_79388 = eta_p_79257 - zp_res_79282;\n                        abs_res_79389 = fabs64(zm_res_79388);\n                        dist_res_79387 = abs_res_79389;\n                    } else {\n                        double d_haversine_res_79390;\n                        double d_haversine_res_79391;\n                        double d_haversine_res_79392;\n                        double d_haversine_res_79393;\n                        double zm_res_79398;\n                        double cos_res_79399;\n                        double zm_res_79400;\n                        double cos_res_79401;\n                        double cos_res_79402;\n                        double zt_res_79403;\n                        double zm_res_79404;\n                        double zm_res_79405;\n                        double zt_res_79406;\n                        double zp_res_79407;\n                        double zs_res_79408;\n                        double min_res_79409;\n               ", "         double zt_res_79410;\n                        double zm_res_79411;\n                        double acos_res_79412;\n                        double zt_res_79413;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_79390 = eta_p_79256;\n                            d_haversine_res_79391 = eta_p_79257;\n                            d_haversine_res_79392 = eta_p_79256;\n                            d_haversine_res_79393 = zp_res_79282;\n                        } else {\n                            double zs_res_79394;\n                            double zs_res_79395;\n                            double zt_res_79396;\n                            double zs_res_79397;\n                            \n                            zs_res_79394 = zt_res_79286 / 180.0;\n                            zs_res_79395 = zt_res_79287 / 180.0;\n                            zt_res_79396 = 3.141592653589793 * zp_res_79282;\n                            zs_res_79397 = zt_res_79396 / 180.0;\n                            d_haversine_res_79390 = zs_res_79394;\n                            d_haversine_res_79391 = zs_res_79395;\n                            d_haversine_res_79392 = zs_res_79394;\n                            d_haversine_res_79393 = zs_res_79397;\n                        }\n                        zm_res_79398 = d_haversine_res_79390 - d_haversine_res_79392;\n                        cos_res_79399 = futrts_cos64(zm_res_79398);\n                        zm_res_79400 = 1.0 - cos_res_79399;\n                        cos_res_79401 = futrts_cos64(d_haversine_res_79392);\n                        cos_res_79402 = futrts_cos64(d_haversine_res_79390);\n                        zt_res_79403 = cos_res_79401 * cos_res_79402;\n                        zm_res_79404 = d_haversine_res_79391 - d_haversine_res_79393;\n                        zm_res_79405 = 1.0 - zm_res_79404;\n                        zt_res_79406 = zt_res_79403 * zm_res_79405;\n                  ",
                                    "      zp_res_79407 = zm_res_79400 + zt_res_79406;\n                        zs_res_79408 = zp_res_79407 / 2.0;\n                        min_res_79409 = fmin64(1.0, zs_res_79408);\n                        zt_res_79410 = 2.0 * min_res_79409;\n                        zm_res_79411 = 1.0 - zt_res_79410;\n                        acos_res_79412 = futrts_acos64(zm_res_79411);\n                        zt_res_79413 = clBase_36773 * acos_res_79412;\n                        dist_res_79387 = zt_res_79413;\n                    }\n                    zlze_res_79414 = dist_res_79387 <= zt_res_59476;\n                    x_79415 = !zlze_res_79386;\n                    y_79416 = zlze_res_79414 && x_79415;\n                    cond_f_res_t_res_79417 = zlze_res_79386 || y_79416;\n                    x_79418 = x_79358 && cond_f_res_t_res_79417;\n                    x_79419 = !x_79355;\n                    y_79420 = x_79418 && x_79419;\n                    cond_79421 = x_79355 || y_79420;\n                    zlze_res_79422 = eta_p_79256 <= zp_res_79275;\n                    if (zlze_res_79422) {\n                        corn_x_79423 = zp_res_79275;\n                    } else {\n                        corn_x_79423 = zp_res_79281;\n                    }\n                    zlze_res_79424 = eta_p_79257 <= zp_res_79280;\n                    if (zlze_res_79424) {\n                        corn_y_79425 = zp_res_79280;\n                    } else {\n                        corn_y_79425 = zp_res_79282;\n                    }\n                    if (clBase_36766 == (int8_t) 0) {\n                        bool eq_x_y_79427;\n                        bool eq_x_zz_79428;\n                        bool p_and_eq_x_y_79429;\n                        bool not_p_79430;\n                        bool p_and_eq_x_y_79431;\n                        bool zeze_res_79432;\n                        double d_euclidean_res_79433;\n                        \n                        eq_x_y_79427 = eta_p_79256 == zp_res_79275;\n                        eq_x_zz_", "79428 = eta_p_79256 == zp_res_79281;\n                        p_and_eq_x_y_79429 = zlze_res_79422 && eq_x_y_79427;\n                        not_p_79430 = !zlze_res_79422;\n                        p_and_eq_x_y_79431 = eq_x_zz_79428 && not_p_79430;\n                        zeze_res_79432 = p_and_eq_x_y_79429 || p_and_eq_x_y_79431;\n                        if (zeze_res_79432) {\n                            double zm_res_79434;\n                            double abs_res_79435;\n                            \n                            zm_res_79434 = eta_p_79257 - corn_y_79425;\n                            abs_res_79435 = fabs64(zm_res_79434);\n                            d_euclidean_res_79433 = abs_res_79435;\n                        } else {\n                            bool eq_x_y_79436;\n                            bool eq_x_zz_79437;\n                            bool p_and_eq_x_y_79438;\n                            bool not_p_79439;\n                            bool p_and_eq_x_y_79440;\n                            bool zeze_res_79441;\n                            double d_euclidean_res_f_res_79442;\n                            \n                            eq_x_y_79436 = eta_p_79257 == zp_res_79280;\n                            eq_x_zz_79437 = eta_p_79257 == zp_res_79282;\n                            p_and_eq_x_y_79438 = zlze_res_79424 && eq_x_y_79436;\n                            not_p_79439 = !zlze_res_79424;\n                            p_and_eq_x_y_79440 = eq_x_zz_79437 && not_p_79439;\n                            zeze_res_79441 = p_and_eq_x_y_79438 || p_and_eq_x_y_79440;\n                            if (zeze_res_79441) {\n                                double zm_res_79443;\n                                double abs_res_79444;\n                                \n                                zm_res_79443 = eta_p_79256 - corn_x_79423;\n                                abs_res_79444 = fabs64(zm_res_79443);\n                                d_euclidean_res_f_res_79442 = abs_res_79444;\n          ", "                  } else {\n                                double zm_res_79445;\n                                double zm_res_79446;\n                                double hypot_res_79447;\n                                \n                                zm_res_79445 = eta_p_79257 - corn_y_79425;\n                                zm_res_79446 = eta_p_79256 - corn_x_79423;\n                                hypot_res_79447 = futrts_hypot64(zm_res_79446, zm_res_79445);\n                                d_euclidean_res_f_res_79442 = hypot_res_79447;\n                            }\n                            d_euclidean_res_79433 = d_euclidean_res_f_res_79442;\n                        }\n                        dist_res_79426 = d_euclidean_res_79433;\n                    } else {\n                        double d_haversine_res_79448;\n                        double d_haversine_res_79449;\n                        double d_haversine_res_79450;\n                        double d_haversine_res_79451;\n                        double zm_res_79458;\n                        double cos_res_79459;\n                        double zm_res_79460;\n                        double cos_res_79461;\n                        double cos_res_79462;\n                        double zt_res_79463;\n                        double zm_res_79464;\n                        double zm_res_79465;\n                        double zt_res_79466;\n                        double zp_res_79467;\n                        double zs_res_79468;\n                        double min_res_79469;\n                        double zt_res_79470;\n                        double zm_res_79471;\n                        double acos_res_79472;\n                        double zt_res_79473;\n                        \n                        if (clBase_36765 == (int8_t) 1) {\n                            d_haversine_res_79448 = eta_p_79256;\n                            d_haversine_res_79449 = eta_p_79257;\n                            d_haversine_res_79450 = corn_x_79423;\n    ",
                                    "                        d_haversine_res_79451 = corn_y_79425;\n                        } else {\n                            double zs_res_79452;\n                            double zs_res_79453;\n                            double zt_res_79454;\n                            double zs_res_79455;\n                            double zt_res_79456;\n                            double zs_res_79457;\n                            \n                            zs_res_79452 = zt_res_79286 / 180.0;\n                            zs_res_79453 = zt_res_79287 / 180.0;\n                            zt_res_79454 = 3.141592653589793 * corn_x_79423;\n                            zs_res_79455 = zt_res_79454 / 180.0;\n                            zt_res_79456 = 3.141592653589793 * corn_y_79425;\n                            zs_res_79457 = zt_res_79456 / 180.0;\n                            d_haversine_res_79448 = zs_res_79452;\n                            d_haversine_res_79449 = zs_res_79453;\n                            d_haversine_res_79450 = zs_res_79455;\n                            d_haversine_res_79451 = zs_res_79457;\n                        }\n                        zm_res_79458 = d_haversine_res_79448 - d_haversine_res_79450;\n                        cos_res_79459 = futrts_cos64(zm_res_79458);\n                        zm_res_79460 = 1.0 - cos_res_79459;\n                        cos_res_79461 = futrts_cos64(d_haversine_res_79450);\n                        cos_res_79462 = futrts_cos64(d_haversine_res_79448);\n                        zt_res_79463 = cos_res_79461 * cos_res_79462;\n                        zm_res_79464 = d_haversine_res_79449 - d_haversine_res_79451;\n                        zm_res_79465 = 1.0 - zm_res_79464;\n                        zt_res_79466 = zt_res_79463 * zm_res_79465;\n                        zp_res_79467 = zm_res_79460 + zt_res_79466;\n                        zs_res_79468 = zp_res_79467 / 2.0;\n                        min_res_79469 = fmin64(1.0, zs_res_79468);\n                        zt_res_79", "470 = 2.0 * min_res_79469;\n                        zm_res_79471 = 1.0 - zt_res_79470;\n                        acos_res_79472 = futrts_acos64(zm_res_79471);\n                        zt_res_79473 = clBase_36773 * acos_res_79472;\n                        dist_res_79426 = zt_res_79473;\n                    }\n                    zlze_res_79474 = dist_res_79426 <= zt_res_59476;\n                    x_79475 = !cond_79421;\n                    y_79476 = zlze_res_79474 && x_79475;\n                    is_pt_marginal_res_79477 = cond_79421 || y_79476;\n                    defunc_0_f_res_79264 = is_pt_marginal_res_79477;\n                }\n                defunc_0_op_res_79480 = defunc_0_f_res_79264 || redout_81500;\n                redout_tmp_84118 = defunc_0_op_res_79480;\n                redout_81500 = redout_tmp_84118;\n            }\n            x_79261 = redout_81500;\n            acc_79260 = x_79261;\n        } else {\n            acc_79260 = acc_79258;\n        }\n        mem_82107[(int64_t) 0] = acc_79260;\n        \n      error_7:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            ext_mem_82108[i_6] = mem_82107[i_6];\n    }\n    if (slt64(sext_i32_i64(local_tid_84106) + tile_sizze_78476 * sext_i32_i64(block_id_84107), n_new_36762)) {\n        bool tmp_84119 = ext_mem_82108[(int64_t) 0];\n        \n        ((__global bool *) mem_82109)[sext_i32_i64(local_tid_84106) + tile_sizze_78476 * sext_i32_i64(block_id_84107)] = tmp_84119;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_78476\n    #undef num_whole_tiles_78497\n    #undef residual_input_79224\n    #undef cond_79225\n    #undef binop_x_79235\n    #undef bytes_82097\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegred_large_69051_dim1, 1, 1)\nvoid add_next_partition_doublezisegred_large_69051(__global int *global_failure, int64_t dz2083U_36759, int64_t num_tblocks_69046, int64_t blocks_per_segment_83618, i", "nt64_t q_83619, int64_t num_virtblocks_83620, int64_t threads_per_segment_83621, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_82001, __global unsigned char *mem_82008, __global unsigned char *segred_tmp_mem_83622, __global unsigned char *counters_mem_83624)\n{\n    #define segred_tblock_sizze_69045 (add_next_partition_doublezisegred_large_69051zisegred_tblock_sizze_69045)\n    #define chunk_sizze_83589 (add_next_partition_doublezisegred_large_69051zichunk_sizze_83589)\n    \n    volatile __local unsigned char *sync_arr_mem_83633_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_83633_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_83631_backing_0 = &shared_mem[sync_arr_mem_83633_backing_1_offset];\n    const int64_t red_arr_bool_mem_83631_backing_0_offset = sync_arr_mem_83633_backing_1_offset + (segred_tblock_sizze_69045 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_69045, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83627;\n    int32_t tblock_sizze_83630;\n    int32_t wave_sizze_83629;\n    int32_t block_id_83628;\n    int32_t global_tid_83626;\n    int64_t phys_tid_69051;\n    __local unsigned char *red_arr_bool_mem_83631;\n    __local unsigned char *sync_arr_mem_83633;\n    int32_t phys_tblock_id_83635;\n    int32_t iterations_83636;\n    \n    local_tid_83627 = get_local_id(0);\n    tblock_sizze_83630 = get_local_size(0);\n    wave_sizze_83629 = LOCKSTEP_WIDTH;\n    block_id_83628 = get_tblock_id(0);\n    global_tid_83626 = block_id_83628 * tblock_sizze_83630 + local_tid_83627;\n    phys_tid_69051 = sext_i32_i64(global_tid_83626);\n    red_arr_bool_mem_83631 = (__local unsigned char *) red_arr_bool_mem_83631_backing_0;\n    sync_arr_mem_83633 = (__local unsigned char *) sync_arr_mem_83633_backing_1;\n    phys_tblock_id_83635 = get_tblock_id(0);\n    iterations_83636 = sdiv_up32(sext_i64_i32(num_virtblocks_83620) - phys_tblock_id_83635, sext_i64_i32(num_tblock",
                                    "s_69046));\n    for (int32_t i_83637 = 0; i_83637 < iterations_83636; i_83637++) {\n        int32_t virt_tblock_id_83638;\n        int64_t flat_segment_id_83639;\n        int64_t global_tid_83640;\n        int64_t slice_83641;\n        int64_t gtid_69049;\n        int64_t remnant_83642;\n        int64_t gtid_69050;\n        bool eta_p_block_res_acc_83643;\n        bool eta_p_69052;\n        bool eta_p_69053;\n        int64_t tblock_id_in_segment_83647;\n        int64_t block_base_offset_83648;\n        int32_t offset_83651;\n        int32_t skip_waves_83652;\n        bool eta_p_83644;\n        bool eta_p_83645;\n        \n        virt_tblock_id_83638 = phys_tblock_id_83635 + i_83637 * sext_i64_i32(num_tblocks_69046);\n        flat_segment_id_83639 = squot64(sext_i32_i64(virt_tblock_id_83638), blocks_per_segment_83618);\n        global_tid_83640 = srem64(sext_i32_i64(virt_tblock_id_83638) * segred_tblock_sizze_69045 + sext_i32_i64(local_tid_83627), threads_per_segment_83621);\n        slice_83641 = (int64_t) 8;\n        gtid_69049 = flat_segment_id_83639;\n        remnant_83642 = flat_segment_id_83639 - gtid_69049;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_83643 = 0;\n        }\n        tblock_id_in_segment_83647 = squot64(global_tid_83640, segred_tblock_sizze_69045);\n        block_base_offset_83648 = tblock_id_in_segment_83647 * q_83619 * segred_tblock_sizze_69045;\n        for (int64_t i_83649 = 0; i_83649 < q_83619; i_83649++) {\n            int64_t block_offset_83650 = block_base_offset_83648 + i_83649 * segred_tblock_sizze_69045;\n            \n            gtid_69050 = global_tid_83640 + threads_per_segment_83621 * i_83649;\n            if (slt64(gtid_69050, dz2083U_36759)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t eta_p_69055 = ((__global int64_t *) mem_82001)[gtid_69049];\n                        int64_t eta_p_69056 =", " ((__global int64_t *) clProc_mem_81938)[gtid_69050];\n                        bool lifted_lambda_res_69057 = eta_p_69056 == eta_p_69055;\n                        \n                        // load accumulator(s)\n                        {\n                            eta_p_69052 = eta_p_block_res_acc_83643;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_69053 = lifted_lambda_res_69057;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            bool defunc_0_op_res_69054 = eta_p_69052 || eta_p_69053;\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_83643 = defunc_0_op_res_69054;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_block_res_acc_83643;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_83652 = 1;\n        offset_83651 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_83627, sext_i64_i32(segred_tblock_sizze_69045))) {\n                eta_p_83644 = ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83651)];\n            }\n        }\n        offset_83651 = 1;\n        while (slt32(offset_83651, wave_sizze_83629)) {\n            if (slt32(local_tid_83627 + offset_83651, sext_i64_i32(segred_tblock_sizze_69045)) && ((local_tid_83627 - squot32(local_tid_83627, wave_sizze_83629) * wave_sizze_83629) & (2 * offset_83651 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_83645 ", "= ((volatile __local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83651)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_83646 = eta_p_83644 || eta_p_83645;\n                    \n                    eta_p_83644 = defunc_0_op_res_83646;\n                }\n                // write result of operation\n                {\n                    ((volatile __local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_83644;\n                }\n            }\n            offset_83651 *= 2;\n        }\n        while (slt32(skip_waves_83652, squot32(sext_i64_i32(segred_tblock_sizze_69045) + wave_sizze_83629 - 1, wave_sizze_83629))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_83651 = skip_waves_83652 * wave_sizze_83629;\n            if (slt32(local_tid_83627 + offset_83651, sext_i64_i32(segred_tblock_sizze_69045)) && ((local_tid_83627 - squot32(local_tid_83627, wave_sizze_83629) * wave_sizze_83629) == 0 && (squot32(local_tid_83627, wave_sizze_83629) & (2 * skip_waves_83652 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_83645 = ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83651)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_83646 = eta_p_83644 || eta_p_83645;\n                    \n                    eta_p_83644 = defunc_0_op_res_83646;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_83644;\n                }\n            }\n            skip_waves_83652 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_83627) == (in",
                                    "t64_t) 0) {\n                eta_p_block_res_acc_83643 = eta_p_83644;\n            } else {\n                eta_p_block_res_acc_83643 = 0;\n            }\n        }\n        if (blocks_per_segment_83618 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_83627 == 0) {\n                    ((__global bool *) mem_82008)[gtid_69049] = eta_p_block_res_acc_83643;\n                }\n            }\n        } else {\n            int32_t old_counter_83653;\n            bool is_last_block_83654;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_83627 == 0) {\n                    ((__global bool *) segred_tmp_mem_83622)[sext_i32_i64(virt_tblock_id_83638)] = eta_p_block_res_acc_83643;\n                    mem_fence_global();\n                    old_counter_83653 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83624)[srem64(flat_segment_id_83639, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_83633)[(int64_t) 0] = old_counter_83653 == sext_i64_i32(blocks_per_segment_83618 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_83654 = ((__local bool *) sync_arr_mem_83633)[(int64_t) 0];\n            if (is_last_block_83654) {\n                if (local_tid_83627 == 0) {\n                    old_counter_83653 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83624)[srem64(flat_segment_id_83639, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_83618));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_83655 = sdiv_up64(blocks_per_segment_83618, segred_tblock_sizze_69045);\n                    \n                    eta_p_69052 = 0;\n                    for (int64_t i_83656 = 0; i_83656 < read_per_thread", "_83655; i_83656++) {\n                        int64_t block_res_id_83657 = sext_i32_i64(local_tid_83627) * read_per_thread_83655 + i_83656;\n                        int64_t index_of_block_res_83658 = flat_segment_id_83639 * blocks_per_segment_83618 + block_res_id_83657;\n                        \n                        if (slt64(block_res_id_83657, blocks_per_segment_83618)) {\n                            eta_p_69053 = ((__global bool *) segred_tmp_mem_83622)[index_of_block_res_83658];\n                            \n                            bool defunc_0_op_res_69054 = eta_p_69052 || eta_p_69053;\n                            \n                            eta_p_69052 = defunc_0_op_res_69054;\n                        }\n                    }\n                }\n                ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_69052;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_83659;\n                    int32_t skip_waves_83660 = 1;\n                    bool eta_p_83644;\n                    bool eta_p_83645;\n                    \n                    offset_83659 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_83627, sext_i64_i32(segred_tblock_sizze_69045))) {\n                            eta_p_83644 = ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83659)];\n                        }\n                    }\n                    offset_83659 = 1;\n                    while (slt32(offset_83659, wave_sizze_83629)) {\n                        if (slt32(local_tid_83627 + offset_83659, sext_i64_i32(segred_tblock_sizze_69045)) && ((local_tid_83627 - squot32(local_tid_83627, wave_sizze_83629) * wave_sizze_83629) & (2 * offset_83659 - 1)) == 0) {\n                            // read array element\n                            {\n                 ", "               eta_p_83645 = ((volatile __local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83659)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_83646 = eta_p_83644 || eta_p_83645;\n                                \n                                eta_p_83644 = defunc_0_op_res_83646;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_83644;\n                            }\n                        }\n                        offset_83659 *= 2;\n                    }\n                    while (slt32(skip_waves_83660, squot32(sext_i64_i32(segred_tblock_sizze_69045) + wave_sizze_83629 - 1, wave_sizze_83629))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_83659 = skip_waves_83660 * wave_sizze_83629;\n                        if (slt32(local_tid_83627 + offset_83659, sext_i64_i32(segred_tblock_sizze_69045)) && ((local_tid_83627 - squot32(local_tid_83627, wave_sizze_83629) * wave_sizze_83629) == 0 && (squot32(local_tid_83627, wave_sizze_83629) & (2 * skip_waves_83660 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_83645 = ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627 + offset_83659)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_83646 = eta_p_83644 || eta_p_83645;\n                                \n                                eta_p_83644 = defunc_0_op_res_83646;\n                            }\n                            // write result of operation\n                            {",
                                    "\n                                ((__local bool *) red_arr_bool_mem_83631)[sext_i32_i64(local_tid_83627)] = eta_p_83644;\n                            }\n                        }\n                        skip_waves_83660 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_83627 == 0) {\n                            ((__global bool *) mem_82008)[gtid_69049] = eta_p_83644;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_69045\n    #undef chunk_sizze_83589\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegred_large_70044_dim1, 1, 1)\nvoid add_next_partition_doublezisegred_large_70044(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36773, double zt_res_59476, int64_t num_tblocks_70039, int64_t blocks_per_segment_84149, int64_t q_84150, int64_t num_virtblocks_84151, int64_t threads_per_segment_84152, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82083, __global unsigned char *segred_tmp_mem_84153, __global unsigned char *counters_mem_84155)\n{\n    #define segred_tblock_sizze_70038 (add_next_partition_doublezisegred_large_70044zisegred_tblock_sizze_70038)\n    #define chunk_sizze_84120 (add_next_partition_doublezisegred_large_70044zichunk_sizze_84120)\n    \n    volatile __local unsigned char *sync_arr_mem_84164_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_84164_backing_1_offset = 0 + 8;\n    volatile __local u", "nsigned char *red_arr_bool_mem_84162_backing_0 = &shared_mem[sync_arr_mem_84164_backing_1_offset];\n    const int64_t red_arr_bool_mem_84162_backing_0_offset = sync_arr_mem_84164_backing_1_offset + (segred_tblock_sizze_70038 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_70038, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_84158;\n    int32_t tblock_sizze_84161;\n    int32_t wave_sizze_84160;\n    int32_t block_id_84159;\n    int32_t global_tid_84157;\n    int64_t phys_tid_70044;\n    __local unsigned char *red_arr_bool_mem_84162;\n    __local unsigned char *sync_arr_mem_84164;\n    int32_t phys_tblock_id_84166;\n    int32_t iterations_84167;\n    \n    local_tid_84158 = get_local_id(0);\n    tblock_sizze_84161 = get_local_size(0);\n    wave_sizze_84160 = LOCKSTEP_WIDTH;\n    block_id_84159 = get_tblock_id(0);\n    global_tid_84157 = block_id_84159 * tblock_sizze_84161 + local_tid_84158;\n    phys_tid_70044 = sext_i32_i64(global_tid_84157);\n    red_arr_bool_mem_84162 = (__local unsigned char *) red_arr_bool_mem_84162_backing_0;\n    sync_arr_mem_84164 = (__local unsigned char *) sync_arr_mem_84164_backing_1;\n    phys_tblock_id_84166 = get_tblock_id(0);\n    iterations_84167 = sdiv_up32(sext_i64_i32(num_virtblocks_84151) - phys_tblock_id_84166, sext_i64_i32(num_tblocks_70039));\n    for (int32_t i_84168 = 0; i_84168 < iterations_84167; i_84168++) {\n        int32_t virt_tblock_id_84169;\n        int64_t flat_segment_id_84170;\n        int64_t global_tid_84171;\n        int64_t slice_84172;\n        int64_t gtid_70042;\n        int64_t remnant_84173;\n        int64_t gtid_70043;\n        bool eta_p_block_res_acc_84174;\n        bool eta_p_70045;\n        bool eta_p_70046;\n        int64_t tblock_id_in_segment_84178;\n        int64_t block_base_offset_84179;\n ", "       int32_t offset_84182;\n        int32_t skip_waves_84183;\n        bool eta_p_84175;\n        bool eta_p_84176;\n        \n        virt_tblock_id_84169 = phys_tblock_id_84166 + i_84168 * sext_i64_i32(num_tblocks_70039);\n        flat_segment_id_84170 = squot64(sext_i32_i64(virt_tblock_id_84169), blocks_per_segment_84149);\n        global_tid_84171 = srem64(sext_i32_i64(virt_tblock_id_84169) * segred_tblock_sizze_70038 + sext_i32_i64(local_tid_84158), threads_per_segment_84152);\n        slice_84172 = n_new_36762;\n        gtid_70042 = flat_segment_id_84170;\n        remnant_84173 = flat_segment_id_84170 - gtid_70042;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_84174 = 0;\n        }\n        tblock_id_in_segment_84178 = squot64(global_tid_84171, segred_tblock_sizze_70038);\n        block_base_offset_84179 = tblock_id_in_segment_84178 * q_84150 * segred_tblock_sizze_70038;\n        for (int64_t i_84180 = 0; i_84180 < q_84150; i_84180++) {\n            int64_t block_offset_84181 = block_base_offset_84179 + i_84180 * segred_tblock_sizze_70038;\n            \n            gtid_70043 = global_tid_84171 + threads_per_segment_84152 * i_84180;\n            if (slt64(gtid_70043, (int64_t) 8)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t eta_p_70050 = ((__global int64_t *) mem_82001)[gtid_70043];\n                        bool cond_70051 = slt64(eta_p_70050, (int64_t) 0);\n                        bool defunc_0_f_res_70052;\n                        \n                        if (cond_70051) {\n                            defunc_0_f_res_70052 = 0;\n                        } else {\n                            int64_t zv_rhs_70053 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n                            bool zzero_70054 = zv_rhs_70053 == (int64_t) 0;\n                            bool nonzzero_70055 = !zzero_70054;\n         ",
                                    "                   bool nonzzero_cert_70056;\n                            \n                            if (!nonzzero_70055) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                                        ;\n                                    }\n                                    local_failure = 1;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            double eta_p_70048 = ((__global double *) new_xs_mem_81952)[gtid_70042];\n                            double eta_p_70049 = ((__global double *) new_ys_mem_81953)[gtid_70042];\n                            int64_t nxid_70057 = smod64(eta_p_70050, zv_rhs_70053);\n                            int64_t nyid_70058 = sdiv64(eta_p_70050, zv_rhs_70053);\n                            double times_arg1_70059 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n                            double i64_res_70060 = sitofp_i64_f64(nxid_70057);\n                            double zt_res_70061 = times_arg1_70059 * i64_res_70060;\n                            double plus_arg0_70062 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n                            double zp_res_70063 = zt_res_70061 + plus_arg0_70062;\n                            double times_arg1_70064 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n                            double i64_res_70065 = sitofp_i64_f64(nyid_70058);\n                            double zt_res_70066 = times_arg1_70064 * i64_res_70065;\n                            double plus_arg0_70067 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n                            double zp_res_70068 = zt_res_70066 + plus_arg0_70067;\n                            double zp_res_70069 = times_arg1_70059 + zp_res_70063;\n                            double zp_res_70070 = times_arg1_70064 + zp_res_70068;\n            ", "                bool zgze_res_70071 = zp_res_70068 <= eta_p_70049;\n                            bool zlze_res_70072 = eta_p_70049 <= zp_res_70070;\n                            bool x_70073 = zgze_res_70071 && zlze_res_70072;\n                            double zt_res_70074 = 3.141592653589793 * eta_p_70048;\n                            double zt_res_70075 = 3.141592653589793 * eta_p_70049;\n                            double dist_res_70076;\n                            \n                            if (clBase_36766 == (int8_t) 0) {\n                                bool zeze_res_70077 = eta_p_70048 == zp_res_70063;\n                                double d_euclidean_res_70078;\n                                \n                                if (zeze_res_70077) {\n                                    double zm_res_70079 = eta_p_70049 - eta_p_70049;\n                                    double abs_res_70080 = fabs64(zm_res_70079);\n                                    \n                                    d_euclidean_res_70078 = abs_res_70080;\n                                } else {\n                                    double zm_res_70081 = eta_p_70048 - zp_res_70063;\n                                    double abs_res_70082 = fabs64(zm_res_70081);\n                                    \n                                    d_euclidean_res_70078 = abs_res_70082;\n                                }\n                                dist_res_70076 = d_euclidean_res_70078;\n                            } else {\n                                double d_haversine_res_70083;\n                                double d_haversine_res_70084;\n                                double d_haversine_res_70085;\n                                double d_haversine_res_70086;\n                                \n                                if (clBase_36765 == (int8_t) 1) {\n                                    d_haversine_res_70083 = eta_p_70048;\n                                    d_haversine_res_70084 = eta_p_70049;\n   ", "                                 d_haversine_res_70085 = zp_res_70063;\n                                    d_haversine_res_70086 = eta_p_70049;\n                                } else {\n                                    double zs_res_70087 = zt_res_70074 / 180.0;\n                                    double zs_res_70088 = zt_res_70075 / 180.0;\n                                    double zt_res_70089 = 3.141592653589793 * zp_res_70063;\n                                    double zs_res_70090 = zt_res_70089 / 180.0;\n                                    \n                                    d_haversine_res_70083 = zs_res_70087;\n                                    d_haversine_res_70084 = zs_res_70088;\n                                    d_haversine_res_70085 = zs_res_70090;\n                                    d_haversine_res_70086 = zs_res_70088;\n                                }\n                                \n                                double zm_res_70091 = d_haversine_res_70083 - d_haversine_res_70085;\n                                double cos_res_70092 = futrts_cos64(zm_res_70091);\n                                double zm_res_70093 = 1.0 - cos_res_70092;\n                                double cos_res_70094 = futrts_cos64(d_haversine_res_70085);\n                                double cos_res_70095 = futrts_cos64(d_haversine_res_70083);\n                                double zt_res_70096 = cos_res_70094 * cos_res_70095;\n                                double zm_res_70097 = d_haversine_res_70084 - d_haversine_res_70086;\n                                double zm_res_70098 = 1.0 - zm_res_70097;\n                                double zt_res_70099 = zt_res_70096 * zm_res_70098;\n                                double zp_res_70100 = zm_res_70093 + zt_res_70099;\n                                double zs_res_70101 = zp_res_70100 / 2.0;\n                                double min_res_70102 = fmin64(1.0, zs_res_70101);\n                                double zt_res_70103 = 2.0 ",
                                    "* min_res_70102;\n                                double zm_res_70104 = 1.0 - zt_res_70103;\n                                double acos_res_70105 = futrts_acos64(zm_res_70104);\n                                double zt_res_70106 = clBase_36773 * acos_res_70105;\n                                \n                                dist_res_70076 = zt_res_70106;\n                            }\n                            \n                            bool zlze_res_70107 = dist_res_70076 <= zt_res_59476;\n                            double dist_res_70108;\n                            \n                            if (clBase_36766 == (int8_t) 0) {\n                                bool zeze_res_70109 = eta_p_70048 == zp_res_70069;\n                                double d_euclidean_res_70110;\n                                \n                                if (zeze_res_70109) {\n                                    double zm_res_70111 = eta_p_70049 - eta_p_70049;\n                                    double abs_res_70112 = fabs64(zm_res_70111);\n                                    \n                                    d_euclidean_res_70110 = abs_res_70112;\n                                } else {\n                                    double zm_res_70113 = eta_p_70048 - zp_res_70069;\n                                    double abs_res_70114 = fabs64(zm_res_70113);\n                                    \n                                    d_euclidean_res_70110 = abs_res_70114;\n                                }\n                                dist_res_70108 = d_euclidean_res_70110;\n                            } else {\n                                double d_haversine_res_70115;\n                                double d_haversine_res_70116;\n                                double d_haversine_res_70117;\n                                double d_haversine_res_70118;\n                                \n                                if (clBase_36765 == (int8_t) 1) {\n                                    d_ha", "versine_res_70115 = eta_p_70048;\n                                    d_haversine_res_70116 = eta_p_70049;\n                                    d_haversine_res_70117 = zp_res_70069;\n                                    d_haversine_res_70118 = eta_p_70049;\n                                } else {\n                                    double zs_res_70119 = zt_res_70074 / 180.0;\n                                    double zs_res_70120 = zt_res_70075 / 180.0;\n                                    double zt_res_70121 = 3.141592653589793 * zp_res_70069;\n                                    double zs_res_70122 = zt_res_70121 / 180.0;\n                                    \n                                    d_haversine_res_70115 = zs_res_70119;\n                                    d_haversine_res_70116 = zs_res_70120;\n                                    d_haversine_res_70117 = zs_res_70122;\n                                    d_haversine_res_70118 = zs_res_70120;\n                                }\n                                \n                                double zm_res_70123 = d_haversine_res_70115 - d_haversine_res_70117;\n                                double cos_res_70124 = futrts_cos64(zm_res_70123);\n                                double zm_res_70125 = 1.0 - cos_res_70124;\n                                double cos_res_70126 = futrts_cos64(d_haversine_res_70117);\n                                double cos_res_70127 = futrts_cos64(d_haversine_res_70115);\n                                double zt_res_70128 = cos_res_70126 * cos_res_70127;\n                                double zm_res_70129 = d_haversine_res_70116 - d_haversine_res_70118;\n                                double zm_res_70130 = 1.0 - zm_res_70129;\n                                double zt_res_70131 = zt_res_70128 * zm_res_70130;\n                                double zp_res_70132 = zm_res_70125 + zt_res_70131;\n                                double zs_res_70133 = zp_res_70132 / 2.0;\n                               ", " double min_res_70134 = fmin64(1.0, zs_res_70133);\n                                double zt_res_70135 = 2.0 * min_res_70134;\n                                double zm_res_70136 = 1.0 - zt_res_70135;\n                                double acos_res_70137 = futrts_acos64(zm_res_70136);\n                                double zt_res_70138 = clBase_36773 * acos_res_70137;\n                                \n                                dist_res_70108 = zt_res_70138;\n                            }\n                            \n                            bool zlze_res_70139 = dist_res_70108 <= zt_res_59476;\n                            bool x_70140 = !zlze_res_70107;\n                            bool y_70141 = zlze_res_70139 && x_70140;\n                            bool cond_t_res_70142 = zlze_res_70107 || y_70141;\n                            bool x_70143 = x_70073 && cond_t_res_70142;\n                            bool zgze_res_70144 = zp_res_70063 <= eta_p_70048;\n                            bool zlze_res_70145 = eta_p_70048 <= zp_res_70069;\n                            bool x_70146 = zgze_res_70144 && zlze_res_70145;\n                            double dist_res_70147;\n                            \n                            if (clBase_36766 == (int8_t) 0) {\n                                double zm_res_70148 = eta_p_70049 - zp_res_70068;\n                                double abs_res_70149 = fabs64(zm_res_70148);\n                                \n                                dist_res_70147 = abs_res_70149;\n                            } else {\n                                double d_haversine_res_70150;\n                                double d_haversine_res_70151;\n                                double d_haversine_res_70152;\n                                double d_haversine_res_70153;\n                                \n                                if (clBase_36765 == (int8_t) 1) {\n                                    d_haversine_res_70150 = eta_p_70048;\n                      ",
                                    "              d_haversine_res_70151 = eta_p_70049;\n                                    d_haversine_res_70152 = eta_p_70048;\n                                    d_haversine_res_70153 = zp_res_70068;\n                                } else {\n                                    double zs_res_70154 = zt_res_70074 / 180.0;\n                                    double zs_res_70155 = zt_res_70075 / 180.0;\n                                    double zt_res_70156 = 3.141592653589793 * zp_res_70068;\n                                    double zs_res_70157 = zt_res_70156 / 180.0;\n                                    \n                                    d_haversine_res_70150 = zs_res_70154;\n                                    d_haversine_res_70151 = zs_res_70155;\n                                    d_haversine_res_70152 = zs_res_70154;\n                                    d_haversine_res_70153 = zs_res_70157;\n                                }\n                                \n                                double zm_res_70158 = d_haversine_res_70150 - d_haversine_res_70152;\n                                double cos_res_70159 = futrts_cos64(zm_res_70158);\n                                double zm_res_70160 = 1.0 - cos_res_70159;\n                                double cos_res_70161 = futrts_cos64(d_haversine_res_70152);\n                                double cos_res_70162 = futrts_cos64(d_haversine_res_70150);\n                                double zt_res_70163 = cos_res_70161 * cos_res_70162;\n                                double zm_res_70164 = d_haversine_res_70151 - d_haversine_res_70153;\n                                double zm_res_70165 = 1.0 - zm_res_70164;\n                                double zt_res_70166 = zt_res_70163 * zm_res_70165;\n                                double zp_res_70167 = zm_res_70160 + zt_res_70166;\n                                double zs_res_70168 = zp_res_70167 / 2.0;\n                                double min_res_70169 = fmin64(1.0, zs_res_70168);\n    ", "                            double zt_res_70170 = 2.0 * min_res_70169;\n                                double zm_res_70171 = 1.0 - zt_res_70170;\n                                double acos_res_70172 = futrts_acos64(zm_res_70171);\n                                double zt_res_70173 = clBase_36773 * acos_res_70172;\n                                \n                                dist_res_70147 = zt_res_70173;\n                            }\n                            \n                            bool zlze_res_70174 = dist_res_70147 <= zt_res_59476;\n                            double dist_res_70175;\n                            \n                            if (clBase_36766 == (int8_t) 0) {\n                                double zm_res_70176 = eta_p_70049 - zp_res_70070;\n                                double abs_res_70177 = fabs64(zm_res_70176);\n                                \n                                dist_res_70175 = abs_res_70177;\n                            } else {\n                                double d_haversine_res_70178;\n                                double d_haversine_res_70179;\n                                double d_haversine_res_70180;\n                                double d_haversine_res_70181;\n                                \n                                if (clBase_36765 == (int8_t) 1) {\n                                    d_haversine_res_70178 = eta_p_70048;\n                                    d_haversine_res_70179 = eta_p_70049;\n                                    d_haversine_res_70180 = eta_p_70048;\n                                    d_haversine_res_70181 = zp_res_70070;\n                                } else {\n                                    double zs_res_70182 = zt_res_70074 / 180.0;\n                                    double zs_res_70183 = zt_res_70075 / 180.0;\n                                    double zt_res_70184 = 3.141592653589793 * zp_res_70070;\n                                    double zs_res_70185 = zt_res_70184 / 180.0;\n", "                                    \n                                    d_haversine_res_70178 = zs_res_70182;\n                                    d_haversine_res_70179 = zs_res_70183;\n                                    d_haversine_res_70180 = zs_res_70182;\n                                    d_haversine_res_70181 = zs_res_70185;\n                                }\n                                \n                                double zm_res_70186 = d_haversine_res_70178 - d_haversine_res_70180;\n                                double cos_res_70187 = futrts_cos64(zm_res_70186);\n                                double zm_res_70188 = 1.0 - cos_res_70187;\n                                double cos_res_70189 = futrts_cos64(d_haversine_res_70180);\n                                double cos_res_70190 = futrts_cos64(d_haversine_res_70178);\n                                double zt_res_70191 = cos_res_70189 * cos_res_70190;\n                                double zm_res_70192 = d_haversine_res_70179 - d_haversine_res_70181;\n                                double zm_res_70193 = 1.0 - zm_res_70192;\n                                double zt_res_70194 = zt_res_70191 * zm_res_70193;\n                                double zp_res_70195 = zm_res_70188 + zt_res_70194;\n                                double zs_res_70196 = zp_res_70195 / 2.0;\n                                double min_res_70197 = fmin64(1.0, zs_res_70196);\n                                double zt_res_70198 = 2.0 * min_res_70197;\n                                double zm_res_70199 = 1.0 - zt_res_70198;\n                                double acos_res_70200 = futrts_acos64(zm_res_70199);\n                                double zt_res_70201 = clBase_36773 * acos_res_70200;\n                                \n                                dist_res_70175 = zt_res_70201;\n                            }\n                            \n                            bool zlze_res_70202 = dist_res_70175 <= zt_res_59476;\n                   ",
                                    "         bool x_70203 = !zlze_res_70174;\n                            bool y_70204 = zlze_res_70202 && x_70203;\n                            bool cond_f_res_t_res_70205 = zlze_res_70174 || y_70204;\n                            bool x_70206 = x_70146 && cond_f_res_t_res_70205;\n                            bool x_70207 = !x_70143;\n                            bool y_70208 = x_70206 && x_70207;\n                            bool cond_70209 = x_70143 || y_70208;\n                            bool zlze_res_70210 = eta_p_70048 <= zp_res_70063;\n                            double corn_x_70211;\n                            \n                            if (zlze_res_70210) {\n                                corn_x_70211 = zp_res_70063;\n                            } else {\n                                corn_x_70211 = zp_res_70069;\n                            }\n                            \n                            bool zlze_res_70212 = eta_p_70049 <= zp_res_70068;\n                            double corn_y_70213;\n                            \n                            if (zlze_res_70212) {\n                                corn_y_70213 = zp_res_70068;\n                            } else {\n                                corn_y_70213 = zp_res_70070;\n                            }\n                            \n                            double dist_res_70214;\n                            \n                            if (clBase_36766 == (int8_t) 0) {\n                                bool eq_x_y_70215 = eta_p_70048 == zp_res_70063;\n                                bool eq_x_zz_70216 = eta_p_70048 == zp_res_70069;\n                                bool p_and_eq_x_y_70217 = zlze_res_70210 && eq_x_y_70215;\n                                bool not_p_70218 = !zlze_res_70210;\n                                bool p_and_eq_x_y_70219 = eq_x_zz_70216 && not_p_70218;\n                                bool zeze_res_70220 = p_and_eq_x_y_70217 || p_and_eq_x_y_70219;\n                                double d_euclid", "ean_res_70221;\n                                \n                                if (zeze_res_70220) {\n                                    double zm_res_70222 = eta_p_70049 - corn_y_70213;\n                                    double abs_res_70223 = fabs64(zm_res_70222);\n                                    \n                                    d_euclidean_res_70221 = abs_res_70223;\n                                } else {\n                                    bool eq_x_y_70224 = eta_p_70049 == zp_res_70068;\n                                    bool eq_x_zz_70225 = eta_p_70049 == zp_res_70070;\n                                    bool p_and_eq_x_y_70226 = zlze_res_70212 && eq_x_y_70224;\n                                    bool not_p_70227 = !zlze_res_70212;\n                                    bool p_and_eq_x_y_70228 = eq_x_zz_70225 && not_p_70227;\n                                    bool zeze_res_70229 = p_and_eq_x_y_70226 || p_and_eq_x_y_70228;\n                                    double d_euclidean_res_f_res_70230;\n                                    \n                                    if (zeze_res_70229) {\n                                        double zm_res_70231 = eta_p_70048 - corn_x_70211;\n                                        double abs_res_70232 = fabs64(zm_res_70231);\n                                        \n                                        d_euclidean_res_f_res_70230 = abs_res_70232;\n                                    } else {\n                                        double zm_res_70233 = eta_p_70049 - corn_y_70213;\n                                        double zm_res_70234 = eta_p_70048 - corn_x_70211;\n                                        double hypot_res_70235 = futrts_hypot64(zm_res_70234, zm_res_70233);\n                                        \n                                        d_euclidean_res_f_res_70230 = hypot_res_70235;\n                                    }\n                                    d_euclidean_res_70221 = d_euclidean_res_f_res", "_70230;\n                                }\n                                dist_res_70214 = d_euclidean_res_70221;\n                            } else {\n                                double d_haversine_res_70236;\n                                double d_haversine_res_70237;\n                                double d_haversine_res_70238;\n                                double d_haversine_res_70239;\n                                \n                                if (clBase_36765 == (int8_t) 1) {\n                                    d_haversine_res_70236 = eta_p_70048;\n                                    d_haversine_res_70237 = eta_p_70049;\n                                    d_haversine_res_70238 = corn_x_70211;\n                                    d_haversine_res_70239 = corn_y_70213;\n                                } else {\n                                    double zs_res_70240 = zt_res_70074 / 180.0;\n                                    double zs_res_70241 = zt_res_70075 / 180.0;\n                                    double zt_res_70242 = 3.141592653589793 * corn_x_70211;\n                                    double zs_res_70243 = zt_res_70242 / 180.0;\n                                    double zt_res_70244 = 3.141592653589793 * corn_y_70213;\n                                    double zs_res_70245 = zt_res_70244 / 180.0;\n                                    \n                                    d_haversine_res_70236 = zs_res_70240;\n                                    d_haversine_res_70237 = zs_res_70241;\n                                    d_haversine_res_70238 = zs_res_70243;\n                                    d_haversine_res_70239 = zs_res_70245;\n                                }\n                                \n                                double zm_res_70246 = d_haversine_res_70236 - d_haversine_res_70238;\n                                double cos_res_70247 = futrts_cos64(zm_res_70246);\n                                double zm_res_70248 = 1.0 - cos_res_70247;\n    ",
                                    "                            double cos_res_70249 = futrts_cos64(d_haversine_res_70238);\n                                double cos_res_70250 = futrts_cos64(d_haversine_res_70236);\n                                double zt_res_70251 = cos_res_70249 * cos_res_70250;\n                                double zm_res_70252 = d_haversine_res_70237 - d_haversine_res_70239;\n                                double zm_res_70253 = 1.0 - zm_res_70252;\n                                double zt_res_70254 = zt_res_70251 * zm_res_70253;\n                                double zp_res_70255 = zm_res_70248 + zt_res_70254;\n                                double zs_res_70256 = zp_res_70255 / 2.0;\n                                double min_res_70257 = fmin64(1.0, zs_res_70256);\n                                double zt_res_70258 = 2.0 * min_res_70257;\n                                double zm_res_70259 = 1.0 - zt_res_70258;\n                                double acos_res_70260 = futrts_acos64(zm_res_70259);\n                                double zt_res_70261 = clBase_36773 * acos_res_70260;\n                                \n                                dist_res_70214 = zt_res_70261;\n                            }\n                            \n                            bool zlze_res_70262 = dist_res_70214 <= zt_res_59476;\n                            bool x_70263 = !cond_70209;\n                            bool y_70264 = zlze_res_70262 && x_70263;\n                            bool is_pt_marginal_res_70265 = cond_70209 || y_70264;\n                            \n                            defunc_0_f_res_70052 = is_pt_marginal_res_70265;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_70045 = eta_p_block_res_acc_84174;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_70046 = defunc_0_f_res_70052;\n                        }\n           ", "             // apply reduction operator(s)\n                        {\n                            bool defunc_0_op_res_70047 = eta_p_70045 || eta_p_70046;\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_84174 = defunc_0_op_res_70047;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_block_res_acc_84174;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_84183 = 1;\n        offset_84182 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_84158, sext_i64_i32(segred_tblock_sizze_70038))) {\n                eta_p_84175 = ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84182)];\n            }\n        }\n        offset_84182 = 1;\n        while (slt32(offset_84182, wave_sizze_84160)) {\n            if (slt32(local_tid_84158 + offset_84182, sext_i64_i32(segred_tblock_sizze_70038)) && ((local_tid_84158 - squot32(local_tid_84158, wave_sizze_84160) * wave_sizze_84160) & (2 * offset_84182 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_84176 = ((volatile __local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84182)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_84177 = eta_p_84175 || eta_p_84176;\n                    \n                    eta_p_84175 = defunc_0_op_res_84177;\n                }\n                // write result of operatio", "n\n                {\n                    ((volatile __local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_84175;\n                }\n            }\n            offset_84182 *= 2;\n        }\n        while (slt32(skip_waves_84183, squot32(sext_i64_i32(segred_tblock_sizze_70038) + wave_sizze_84160 - 1, wave_sizze_84160))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_84182 = skip_waves_84183 * wave_sizze_84160;\n            if (slt32(local_tid_84158 + offset_84182, sext_i64_i32(segred_tblock_sizze_70038)) && ((local_tid_84158 - squot32(local_tid_84158, wave_sizze_84160) * wave_sizze_84160) == 0 && (squot32(local_tid_84158, wave_sizze_84160) & (2 * skip_waves_84183 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_84176 = ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84182)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_84177 = eta_p_84175 || eta_p_84176;\n                    \n                    eta_p_84175 = defunc_0_op_res_84177;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_84175;\n                }\n            }\n            skip_waves_84183 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_84158) == (int64_t) 0) {\n                eta_p_block_res_acc_84174 = eta_p_84175;\n            } else {\n                eta_p_block_res_acc_84174 = 0;\n            }\n        }\n        if (blocks_per_segment_84149 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_84158 == 0) {\n                    ((__global bool *) mem_82083)[gtid_70",
                                    "042] = eta_p_block_res_acc_84174;\n                }\n            }\n        } else {\n            int32_t old_counter_84184;\n            bool is_last_block_84185;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_84158 == 0) {\n                    ((__global bool *) segred_tmp_mem_84153)[sext_i32_i64(virt_tblock_id_84169)] = eta_p_block_res_acc_84174;\n                    mem_fence_global();\n                    old_counter_84184 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84155)[srem64(flat_segment_id_84170, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_84164)[(int64_t) 0] = old_counter_84184 == sext_i64_i32(blocks_per_segment_84149 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_84185 = ((__local bool *) sync_arr_mem_84164)[(int64_t) 0];\n            if (is_last_block_84185) {\n                if (local_tid_84158 == 0) {\n                    old_counter_84184 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84155)[srem64(flat_segment_id_84170, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_84149));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_84186 = sdiv_up64(blocks_per_segment_84149, segred_tblock_sizze_70038);\n                    \n                    eta_p_70045 = 0;\n                    for (int64_t i_84187 = 0; i_84187 < read_per_thread_84186; i_84187++) {\n                        int64_t block_res_id_84188 = sext_i32_i64(local_tid_84158) * read_per_thread_84186 + i_84187;\n                        int64_t index_of_block_res_84189 = flat_segment_id_84170 * blocks_per_segment_84149 + block_res_id_84188;\n                        \n                        if (slt64(block_res_id_84188, blocks_per_segment_84149)) {\n                    ", "        eta_p_70046 = ((__global bool *) segred_tmp_mem_84153)[index_of_block_res_84189];\n                            \n                            bool defunc_0_op_res_70047 = eta_p_70045 || eta_p_70046;\n                            \n                            eta_p_70045 = defunc_0_op_res_70047;\n                        }\n                    }\n                }\n                ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_70045;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_84190;\n                    int32_t skip_waves_84191 = 1;\n                    bool eta_p_84175;\n                    bool eta_p_84176;\n                    \n                    offset_84190 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_84158, sext_i64_i32(segred_tblock_sizze_70038))) {\n                            eta_p_84175 = ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84190)];\n                        }\n                    }\n                    offset_84190 = 1;\n                    while (slt32(offset_84190, wave_sizze_84160)) {\n                        if (slt32(local_tid_84158 + offset_84190, sext_i64_i32(segred_tblock_sizze_70038)) && ((local_tid_84158 - squot32(local_tid_84158, wave_sizze_84160) * wave_sizze_84160) & (2 * offset_84190 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_84176 = ((volatile __local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84190)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_84177 = eta_p_84175 || eta_p_84176;\n                                \n                               ", " eta_p_84175 = defunc_0_op_res_84177;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_84175;\n                            }\n                        }\n                        offset_84190 *= 2;\n                    }\n                    while (slt32(skip_waves_84191, squot32(sext_i64_i32(segred_tblock_sizze_70038) + wave_sizze_84160 - 1, wave_sizze_84160))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_84190 = skip_waves_84191 * wave_sizze_84160;\n                        if (slt32(local_tid_84158 + offset_84190, sext_i64_i32(segred_tblock_sizze_70038)) && ((local_tid_84158 - squot32(local_tid_84158, wave_sizze_84160) * wave_sizze_84160) == 0 && (squot32(local_tid_84158, wave_sizze_84160) & (2 * skip_waves_84191 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_84176 = ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158 + offset_84190)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_84177 = eta_p_84175 || eta_p_84176;\n                                \n                                eta_p_84175 = defunc_0_op_res_84177;\n                            }\n                            // write result of operation\n                            {\n                                ((__local bool *) red_arr_bool_mem_84162)[sext_i32_i64(local_tid_84158)] = eta_p_84175;\n                            }\n                        }\n                        skip_waves_84191 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n               ",
                                    "         if (local_tid_84158 == 0) {\n                            ((__global bool *) mem_82083)[gtid_70042] = eta_p_84175;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_70038\n    #undef chunk_sizze_84120\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegred_small_69051_dim1, 1, 1)\nvoid add_next_partition_doublezisegred_small_69051(__global int *global_failure, int64_t dz2083U_36759, int64_t num_tblocks_69046, int64_t segment_sizze_nonzzero_83590, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_82001, __global unsigned char *mem_82008)\n{\n    #define segred_tblock_sizze_69045 (add_next_partition_doublezisegred_small_69051zisegred_tblock_sizze_69045)\n    \n    volatile __local unsigned char *red_arr_bool_mem_83597_backing_0 = &shared_mem[0];\n    const int64_t red_arr_bool_mem_83597_backing_0_offset = 0 + (segred_tblock_sizze_69045 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_69045, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83593;\n    int32_t tblock_sizze_83596;\n    int32_t wave_sizze_83595;\n    int32_t block_id_83594;\n    int32_t global_tid_83592;\n    int64_t phys_tid_69051;\n    __local unsigned char *red_arr_bool_mem_83597;\n    int32_t phys_tblock_id_83599;\n    int32_t iterations_83600;\n    \n    local_tid_83593 = get_local_id(0);\n    tblock_sizze_83596 = get_local_size(0);\n    wave_sizze_83595 = LOCKSTEP_WIDTH;\n    block_id_83594 = get_tblock_id(0);\n    global_tid_83592 = block_id_83594 * tblock_sizze_83596 + local_tid_83593;\n    phys_tid_69051 = sext_i32_i64(global_tid_83592);\n    red_arr_bool_mem_83597 = (__local unsigned char *) red_arr_bool_mem_83597_backing_0;\n    phys_tblock_id_83599 = get_tblock_id(0);\n    iterations_83600 = sdiv_up32(sext_i64_i32(sdiv_up64((int64_t) 8, squot64(segred_tblock_sizze_69045", ", segment_sizze_nonzzero_83590))) - phys_tblock_id_83599, sext_i64_i32(num_tblocks_69046));\n    for (int32_t i_83601 = 0; i_83601 < iterations_83600; i_83601++) {\n        int32_t virt_tblock_id_83602;\n        int64_t slice_83603;\n        int64_t gtid_69049;\n        int64_t remnant_83604;\n        int64_t gtid_69050;\n        \n        virt_tblock_id_83602 = phys_tblock_id_83599 + i_83601 * sext_i64_i32(num_tblocks_69046);\n        slice_83603 = (int64_t) 8;\n        gtid_69049 = squot64(sext_i32_i64(local_tid_83593), segment_sizze_nonzzero_83590) + sext_i32_i64(virt_tblock_id_83602) * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590);\n        remnant_83604 = squot64(sext_i32_i64(local_tid_83593), segment_sizze_nonzzero_83590) + sext_i32_i64(virt_tblock_id_83602) * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590) - gtid_69049;\n        gtid_69050 = srem64(sext_i32_i64(local_tid_83593), dz2083U_36759);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, dz2083U_36759) && (slt64(gtid_69049, (int64_t) 8) && slt64(sext_i32_i64(local_tid_83593), dz2083U_36759 * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590)))) {\n                // apply map function\n                {\n                    int64_t eta_p_69055 = ((__global int64_t *) mem_82001)[gtid_69049];\n                    int64_t eta_p_69056 = ((__global int64_t *) clProc_mem_81938)[gtid_69050];\n                    bool lifted_lambda_res_69057 = eta_p_69056 == eta_p_69055;\n                    \n                    // save results to be reduced\n                    {\n                        ((__local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = lifted_lambda_res_69057;\n                    }\n                }\n            } else {\n                ((__local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, dz2083U_36759)", ") {\n            // perform segmented scan to imitate reduction\n            {\n                bool eta_p_69052;\n                bool eta_p_69053;\n                bool eta_p_83605;\n                bool eta_p_83606;\n                bool ltid_in_bounds_83608 = slt64(sext_i32_i64(local_tid_83593), dz2083U_36759 * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590));\n                int32_t skip_threads_83609;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_83608) {\n                        eta_p_69053 = ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)];\n                        if ((local_tid_83593 - squot32(local_tid_83593, 32) * 32) == 0) {\n                            eta_p_69052 = eta_p_69053;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83609 = 1;\n                    while (slt32(skip_threads_83609, 32)) {\n                        bool thread_active_83610 = sle32(skip_threads_83609, local_tid_83593 - squot32(local_tid_83593, 32) * 32) && ltid_in_bounds_83608;\n                        \n                        if (thread_active_83610) {\n                            // read operands\n                            {\n                                eta_p_69052 = ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593) - sext_i32_i64(skip_threads_83609)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_83611 = slt64(srem64(sext_i32_i64(local_tid_83593), dz2083U_36759), sext_i32_i64(local_tid_83593) - sext_i32_i64(local_tid_83593 - skip_threads_83609));\n                            \n                            if (thread_active_83610 && inactive_83611) {\n                                eta_",
                                    "p_69052 = eta_p_69053;\n                            }\n                            if (thread_active_83610) {\n                                if (!inactive_83611) {\n                                    bool defunc_0_op_res_69054 = eta_p_69052 || eta_p_69053;\n                                    \n                                    eta_p_69052 = defunc_0_op_res_69054;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_83595, skip_threads_83609)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83610) {\n                            // write result\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = eta_p_69052;\n                                eta_p_69053 = eta_p_69052;\n                            }\n                        }\n                        if (sle32(wave_sizze_83595, skip_threads_83609)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83609 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_83593 - squot32(local_tid_83593, 32) * 32) == 31 && ltid_in_bounds_83608) {\n                        ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(squot32(local_tid_83593, 32))] = eta_p_69052;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_83612;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(lo", "cal_tid_83593, 32) == 0 && ltid_in_bounds_83608) {\n                            eta_p_83606 = ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)];\n                            if ((local_tid_83593 - squot32(local_tid_83593, 32) * 32) == 0) {\n                                eta_p_83605 = eta_p_83606;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_83612 = 1;\n                        while (slt32(skip_threads_83612, 32)) {\n                            bool thread_active_83613 = sle32(skip_threads_83612, local_tid_83593 - squot32(local_tid_83593, 32) * 32) && (squot32(local_tid_83593, 32) == 0 && ltid_in_bounds_83608);\n                            \n                            if (thread_active_83613) {\n                                // read operands\n                                {\n                                    eta_p_83605 = ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593) - sext_i32_i64(skip_threads_83612)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_83614 = slt64(srem64(sext_i32_i64(local_tid_83593 * 32 + 32 - 1), dz2083U_36759), sext_i32_i64(local_tid_83593 * 32 + 32 - 1) - sext_i32_i64((local_tid_83593 - skip_threads_83612) * 32 + 32 - 1));\n                                \n                                if (thread_active_83613 && inactive_83614) {\n                                    eta_p_83605 = eta_p_83606;\n                                }\n                                if (thread_active_83613) {\n                                    if (!inactive_83614) {\n                                        bool defunc_0_op_res_83607 = eta_p_83605 || eta_p_83606;\n                                        \n         ", "                               eta_p_83605 = defunc_0_op_res_83607;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_83595, skip_threads_83612)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_83613) {\n                                // write result\n                                {\n                                    ((volatile __local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = eta_p_83605;\n                                    eta_p_83606 = eta_p_83605;\n                                }\n                            }\n                            if (sle32(wave_sizze_83595, skip_threads_83612)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_83612 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_83615 = squot32(local_tid_83593, 32) == 0 || !ltid_in_bounds_83608;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_83615) {\n                            eta_p_69053 = eta_p_69052;\n                            eta_p_69052 = ((__local bool *) red_arr_bool_mem_83597)[sext_i32_i64(squot32(local_tid_83593, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_83616 = slt64(srem64(sext_i32_i64(local_tid_83593), dz2083U_36759), sext_i32_i64(local_tid_83593) - sext_i32_i64(squot32(local_tid_83593, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_83615) {\n                           ",
                                    " if (inactive_83616) {\n                                eta_p_69052 = eta_p_69053;\n                            }\n                        }\n                        if (!no_carry_in_83615) {\n                            if (!inactive_83616) {\n                                bool defunc_0_op_res_69054 = eta_p_69052 || eta_p_69053;\n                                \n                                eta_p_69052 = defunc_0_op_res_69054;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_83615) {\n                            ((__local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = eta_p_69052;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_83593, 32) == 0 && ltid_in_bounds_83608) {\n                        ((__local bool *) red_arr_bool_mem_83597)[sext_i32_i64(local_tid_83593)] = eta_p_69053;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_83602) * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590) + sext_i32_i64(local_tid_83593), (int64_t) 8) && slt64(sext_i32_i64(local_tid_83593), squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590))) {\n                bool tmp_83617 = ((__local bool *) red_arr_bool_mem_83597)[(sext_i32_i64(local_tid_83593) + (int64_t) 1) * segment_sizze_nonzzero_83590 - (int64_t) 1];\n                \n                ((__global bool *) mem_82008)[sext_i32_i64(virt_tblock_id_83602) * squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590) + sext_i32_i64(local_tid_83593)] = tmp_83617;\n            }\n      ", "  }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_69045\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegred_small_70044_dim1, 1, 1)\nvoid add_next_partition_doublezisegred_small_70044(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36773, double zt_res_59476, int64_t num_tblocks_70039, int64_t segment_sizze_nonzzero_84121, __global unsigned char *clBase_mem_81930, __global unsigned char *clBase_mem_81931, __global unsigned char *clBase_mem_81932, __global unsigned char *new_xs_mem_81952, __global unsigned char *new_ys_mem_81953, __global unsigned char *mem_82001, __global unsigned char *mem_82083)\n{\n    #define segred_tblock_sizze_70038 (add_next_partition_doublezisegred_small_70044zisegred_tblock_sizze_70038)\n    \n    volatile __local unsigned char *red_arr_bool_mem_84128_backing_0 = &shared_mem[0];\n    const int64_t red_arr_bool_mem_84128_backing_0_offset = 0 + (segred_tblock_sizze_70038 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_70038, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_84124;\n    int32_t tblock_sizze_84127;\n    int32_t wave_sizze_84126;\n    int32_t block_id_84125;\n    int32_t global_tid_84123;\n    int64_t phys_tid_70044;\n    __local unsigned char *red_arr_bool_mem_84128;\n    int32_t phys_tblock_id_84130;\n    int32_t iterations_84131;\n    \n    local_tid_84124 = get_local_id(0);\n    tblock_sizze_84127 = get_local_size(0);\n    wave_sizze_84126 = LOCKSTEP_WIDTH;\n    block_id_84125 = get_tblock_id(0);\n    global_tid_84123 = block_id_84125 * tblock_sizze_84127 + local_tid", "_84124;\n    phys_tid_70044 = sext_i32_i64(global_tid_84123);\n    red_arr_bool_mem_84128 = (__local unsigned char *) red_arr_bool_mem_84128_backing_0;\n    phys_tblock_id_84130 = get_tblock_id(0);\n    iterations_84131 = sdiv_up32(sext_i64_i32(sdiv_up64(n_new_36762, squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121))) - phys_tblock_id_84130, sext_i64_i32(num_tblocks_70039));\n    for (int32_t i_84132 = 0; i_84132 < iterations_84131; i_84132++) {\n        int32_t virt_tblock_id_84133;\n        int64_t slice_84134;\n        int64_t gtid_70042;\n        int64_t remnant_84135;\n        int64_t gtid_70043;\n        \n        virt_tblock_id_84133 = phys_tblock_id_84130 + i_84132 * sext_i64_i32(num_tblocks_70039);\n        slice_84134 = n_new_36762;\n        gtid_70042 = squot64(sext_i32_i64(local_tid_84124), segment_sizze_nonzzero_84121) + sext_i32_i64(virt_tblock_id_84133) * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121);\n        remnant_84135 = squot64(sext_i32_i64(local_tid_84124), segment_sizze_nonzzero_84121) + sext_i32_i64(virt_tblock_id_84133) * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121) - gtid_70042;\n        gtid_70043 = srem64(sext_i32_i64(local_tid_84124), (int64_t) 8);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, (int64_t) 8) && (slt64(gtid_70042, n_new_36762) && slt64(sext_i32_i64(local_tid_84124), (int64_t) 8 * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121)))) {\n                // apply map function\n                {\n                    int64_t eta_p_70050 = ((__global int64_t *) mem_82001)[gtid_70043];\n                    bool cond_70051 = slt64(eta_p_70050, (int64_t) 0);\n                    bool defunc_0_f_res_70052;\n                    \n                    if (cond_70051) {\n                        defunc_0_f_res_70052 = 0;\n                    } else {\n                        int64_t zv_rhs_70053 = ((__global int64_t *) clBase_mem_81931)[(int64_t) 0];\n     ",
                                    "                   bool zzero_70054 = zv_rhs_70053 == (int64_t) 0;\n                        bool nonzzero_70055 = !zzero_70054;\n                        bool nonzzero_cert_70056;\n                        \n                        if (!nonzzero_70055) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        \n                        double eta_p_70048 = ((__global double *) new_xs_mem_81952)[gtid_70042];\n                        double eta_p_70049 = ((__global double *) new_ys_mem_81953)[gtid_70042];\n                        int64_t nxid_70057 = smod64(eta_p_70050, zv_rhs_70053);\n                        int64_t nyid_70058 = sdiv64(eta_p_70050, zv_rhs_70053);\n                        double times_arg1_70059 = ((__global double *) clBase_mem_81932)[(int64_t) 0];\n                        double i64_res_70060 = sitofp_i64_f64(nxid_70057);\n                        double zt_res_70061 = times_arg1_70059 * i64_res_70060;\n                        double plus_arg0_70062 = ((__global double *) clBase_mem_81930)[(int64_t) 0];\n                        double zp_res_70063 = zt_res_70061 + plus_arg0_70062;\n                        double times_arg1_70064 = ((__global double *) clBase_mem_81932)[(int64_t) 1];\n                        double i64_res_70065 = sitofp_i64_f64(nyid_70058);\n                        double zt_res_70066 = times_arg1_70064 * i64_res_70065;\n                        double plus_arg0_70067 = ((__global double *) clBase_mem_81930)[(int64_t) 1];\n                        double zp_res_70068 = zt_res_70066 + plus_arg0_70067;\n                        double zp_res_70069 = times_arg1_70059 + zp_res_70063;\n                        double zp_res_70070 = times_arg1_70064 + zp", "_res_70068;\n                        bool zgze_res_70071 = zp_res_70068 <= eta_p_70049;\n                        bool zlze_res_70072 = eta_p_70049 <= zp_res_70070;\n                        bool x_70073 = zgze_res_70071 && zlze_res_70072;\n                        double zt_res_70074 = 3.141592653589793 * eta_p_70048;\n                        double zt_res_70075 = 3.141592653589793 * eta_p_70049;\n                        double dist_res_70076;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            bool zeze_res_70077 = eta_p_70048 == zp_res_70063;\n                            double d_euclidean_res_70078;\n                            \n                            if (zeze_res_70077) {\n                                double zm_res_70079 = eta_p_70049 - eta_p_70049;\n                                double abs_res_70080 = fabs64(zm_res_70079);\n                                \n                                d_euclidean_res_70078 = abs_res_70080;\n                            } else {\n                                double zm_res_70081 = eta_p_70048 - zp_res_70063;\n                                double abs_res_70082 = fabs64(zm_res_70081);\n                                \n                                d_euclidean_res_70078 = abs_res_70082;\n                            }\n                            dist_res_70076 = d_euclidean_res_70078;\n                        } else {\n                            double d_haversine_res_70083;\n                            double d_haversine_res_70084;\n                            double d_haversine_res_70085;\n                            double d_haversine_res_70086;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_70083 = eta_p_70048;\n                                d_haversine_res_70084 = eta_p_70049;\n                                d_haversine_res_70085 = zp_res_70063;\n                                d_hav", "ersine_res_70086 = eta_p_70049;\n                            } else {\n                                double zs_res_70087 = zt_res_70074 / 180.0;\n                                double zs_res_70088 = zt_res_70075 / 180.0;\n                                double zt_res_70089 = 3.141592653589793 * zp_res_70063;\n                                double zs_res_70090 = zt_res_70089 / 180.0;\n                                \n                                d_haversine_res_70083 = zs_res_70087;\n                                d_haversine_res_70084 = zs_res_70088;\n                                d_haversine_res_70085 = zs_res_70090;\n                                d_haversine_res_70086 = zs_res_70088;\n                            }\n                            \n                            double zm_res_70091 = d_haversine_res_70083 - d_haversine_res_70085;\n                            double cos_res_70092 = futrts_cos64(zm_res_70091);\n                            double zm_res_70093 = 1.0 - cos_res_70092;\n                            double cos_res_70094 = futrts_cos64(d_haversine_res_70085);\n                            double cos_res_70095 = futrts_cos64(d_haversine_res_70083);\n                            double zt_res_70096 = cos_res_70094 * cos_res_70095;\n                            double zm_res_70097 = d_haversine_res_70084 - d_haversine_res_70086;\n                            double zm_res_70098 = 1.0 - zm_res_70097;\n                            double zt_res_70099 = zt_res_70096 * zm_res_70098;\n                            double zp_res_70100 = zm_res_70093 + zt_res_70099;\n                            double zs_res_70101 = zp_res_70100 / 2.0;\n                            double min_res_70102 = fmin64(1.0, zs_res_70101);\n                            double zt_res_70103 = 2.0 * min_res_70102;\n                            double zm_res_70104 = 1.0 - zt_res_70103;\n                            double acos_res_70105 = futrts_acos64(zm_res_70104);\n                            double zt_res_70",
                                    "106 = clBase_36773 * acos_res_70105;\n                            \n                            dist_res_70076 = zt_res_70106;\n                        }\n                        \n                        bool zlze_res_70107 = dist_res_70076 <= zt_res_59476;\n                        double dist_res_70108;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            bool zeze_res_70109 = eta_p_70048 == zp_res_70069;\n                            double d_euclidean_res_70110;\n                            \n                            if (zeze_res_70109) {\n                                double zm_res_70111 = eta_p_70049 - eta_p_70049;\n                                double abs_res_70112 = fabs64(zm_res_70111);\n                                \n                                d_euclidean_res_70110 = abs_res_70112;\n                            } else {\n                                double zm_res_70113 = eta_p_70048 - zp_res_70069;\n                                double abs_res_70114 = fabs64(zm_res_70113);\n                                \n                                d_euclidean_res_70110 = abs_res_70114;\n                            }\n                            dist_res_70108 = d_euclidean_res_70110;\n                        } else {\n                            double d_haversine_res_70115;\n                            double d_haversine_res_70116;\n                            double d_haversine_res_70117;\n                            double d_haversine_res_70118;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_70115 = eta_p_70048;\n                                d_haversine_res_70116 = eta_p_70049;\n                                d_haversine_res_70117 = zp_res_70069;\n                                d_haversine_res_70118 = eta_p_70049;\n                            } else {\n                                double zs_res_70119 = zt_res_70074 / 1", "80.0;\n                                double zs_res_70120 = zt_res_70075 / 180.0;\n                                double zt_res_70121 = 3.141592653589793 * zp_res_70069;\n                                double zs_res_70122 = zt_res_70121 / 180.0;\n                                \n                                d_haversine_res_70115 = zs_res_70119;\n                                d_haversine_res_70116 = zs_res_70120;\n                                d_haversine_res_70117 = zs_res_70122;\n                                d_haversine_res_70118 = zs_res_70120;\n                            }\n                            \n                            double zm_res_70123 = d_haversine_res_70115 - d_haversine_res_70117;\n                            double cos_res_70124 = futrts_cos64(zm_res_70123);\n                            double zm_res_70125 = 1.0 - cos_res_70124;\n                            double cos_res_70126 = futrts_cos64(d_haversine_res_70117);\n                            double cos_res_70127 = futrts_cos64(d_haversine_res_70115);\n                            double zt_res_70128 = cos_res_70126 * cos_res_70127;\n                            double zm_res_70129 = d_haversine_res_70116 - d_haversine_res_70118;\n                            double zm_res_70130 = 1.0 - zm_res_70129;\n                            double zt_res_70131 = zt_res_70128 * zm_res_70130;\n                            double zp_res_70132 = zm_res_70125 + zt_res_70131;\n                            double zs_res_70133 = zp_res_70132 / 2.0;\n                            double min_res_70134 = fmin64(1.0, zs_res_70133);\n                            double zt_res_70135 = 2.0 * min_res_70134;\n                            double zm_res_70136 = 1.0 - zt_res_70135;\n                            double acos_res_70137 = futrts_acos64(zm_res_70136);\n                            double zt_res_70138 = clBase_36773 * acos_res_70137;\n                            \n                            dist_res_70108 = zt_res_70138;\n              ", "          }\n                        \n                        bool zlze_res_70139 = dist_res_70108 <= zt_res_59476;\n                        bool x_70140 = !zlze_res_70107;\n                        bool y_70141 = zlze_res_70139 && x_70140;\n                        bool cond_t_res_70142 = zlze_res_70107 || y_70141;\n                        bool x_70143 = x_70073 && cond_t_res_70142;\n                        bool zgze_res_70144 = zp_res_70063 <= eta_p_70048;\n                        bool zlze_res_70145 = eta_p_70048 <= zp_res_70069;\n                        bool x_70146 = zgze_res_70144 && zlze_res_70145;\n                        double dist_res_70147;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            double zm_res_70148 = eta_p_70049 - zp_res_70068;\n                            double abs_res_70149 = fabs64(zm_res_70148);\n                            \n                            dist_res_70147 = abs_res_70149;\n                        } else {\n                            double d_haversine_res_70150;\n                            double d_haversine_res_70151;\n                            double d_haversine_res_70152;\n                            double d_haversine_res_70153;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_70150 = eta_p_70048;\n                                d_haversine_res_70151 = eta_p_70049;\n                                d_haversine_res_70152 = eta_p_70048;\n                                d_haversine_res_70153 = zp_res_70068;\n                            } else {\n                                double zs_res_70154 = zt_res_70074 / 180.0;\n                                double zs_res_70155 = zt_res_70075 / 180.0;\n                                double zt_res_70156 = 3.141592653589793 * zp_res_70068;\n                                double zs_res_70157 = zt_res_70156 / 180.0;\n                                \n        ",
                                    "                        d_haversine_res_70150 = zs_res_70154;\n                                d_haversine_res_70151 = zs_res_70155;\n                                d_haversine_res_70152 = zs_res_70154;\n                                d_haversine_res_70153 = zs_res_70157;\n                            }\n                            \n                            double zm_res_70158 = d_haversine_res_70150 - d_haversine_res_70152;\n                            double cos_res_70159 = futrts_cos64(zm_res_70158);\n                            double zm_res_70160 = 1.0 - cos_res_70159;\n                            double cos_res_70161 = futrts_cos64(d_haversine_res_70152);\n                            double cos_res_70162 = futrts_cos64(d_haversine_res_70150);\n                            double zt_res_70163 = cos_res_70161 * cos_res_70162;\n                            double zm_res_70164 = d_haversine_res_70151 - d_haversine_res_70153;\n                            double zm_res_70165 = 1.0 - zm_res_70164;\n                            double zt_res_70166 = zt_res_70163 * zm_res_70165;\n                            double zp_res_70167 = zm_res_70160 + zt_res_70166;\n                            double zs_res_70168 = zp_res_70167 / 2.0;\n                            double min_res_70169 = fmin64(1.0, zs_res_70168);\n                            double zt_res_70170 = 2.0 * min_res_70169;\n                            double zm_res_70171 = 1.0 - zt_res_70170;\n                            double acos_res_70172 = futrts_acos64(zm_res_70171);\n                            double zt_res_70173 = clBase_36773 * acos_res_70172;\n                            \n                            dist_res_70147 = zt_res_70173;\n                        }\n                        \n                        bool zlze_res_70174 = dist_res_70147 <= zt_res_59476;\n                        double dist_res_70175;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            double zm_res_", "70176 = eta_p_70049 - zp_res_70070;\n                            double abs_res_70177 = fabs64(zm_res_70176);\n                            \n                            dist_res_70175 = abs_res_70177;\n                        } else {\n                            double d_haversine_res_70178;\n                            double d_haversine_res_70179;\n                            double d_haversine_res_70180;\n                            double d_haversine_res_70181;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_70178 = eta_p_70048;\n                                d_haversine_res_70179 = eta_p_70049;\n                                d_haversine_res_70180 = eta_p_70048;\n                                d_haversine_res_70181 = zp_res_70070;\n                            } else {\n                                double zs_res_70182 = zt_res_70074 / 180.0;\n                                double zs_res_70183 = zt_res_70075 / 180.0;\n                                double zt_res_70184 = 3.141592653589793 * zp_res_70070;\n                                double zs_res_70185 = zt_res_70184 / 180.0;\n                                \n                                d_haversine_res_70178 = zs_res_70182;\n                                d_haversine_res_70179 = zs_res_70183;\n                                d_haversine_res_70180 = zs_res_70182;\n                                d_haversine_res_70181 = zs_res_70185;\n                            }\n                            \n                            double zm_res_70186 = d_haversine_res_70178 - d_haversine_res_70180;\n                            double cos_res_70187 = futrts_cos64(zm_res_70186);\n                            double zm_res_70188 = 1.0 - cos_res_70187;\n                            double cos_res_70189 = futrts_cos64(d_haversine_res_70180);\n                            double cos_res_70190 = futrts_cos64(d_haversine_res_70178);\n                     ", "       double zt_res_70191 = cos_res_70189 * cos_res_70190;\n                            double zm_res_70192 = d_haversine_res_70179 - d_haversine_res_70181;\n                            double zm_res_70193 = 1.0 - zm_res_70192;\n                            double zt_res_70194 = zt_res_70191 * zm_res_70193;\n                            double zp_res_70195 = zm_res_70188 + zt_res_70194;\n                            double zs_res_70196 = zp_res_70195 / 2.0;\n                            double min_res_70197 = fmin64(1.0, zs_res_70196);\n                            double zt_res_70198 = 2.0 * min_res_70197;\n                            double zm_res_70199 = 1.0 - zt_res_70198;\n                            double acos_res_70200 = futrts_acos64(zm_res_70199);\n                            double zt_res_70201 = clBase_36773 * acos_res_70200;\n                            \n                            dist_res_70175 = zt_res_70201;\n                        }\n                        \n                        bool zlze_res_70202 = dist_res_70175 <= zt_res_59476;\n                        bool x_70203 = !zlze_res_70174;\n                        bool y_70204 = zlze_res_70202 && x_70203;\n                        bool cond_f_res_t_res_70205 = zlze_res_70174 || y_70204;\n                        bool x_70206 = x_70146 && cond_f_res_t_res_70205;\n                        bool x_70207 = !x_70143;\n                        bool y_70208 = x_70206 && x_70207;\n                        bool cond_70209 = x_70143 || y_70208;\n                        bool zlze_res_70210 = eta_p_70048 <= zp_res_70063;\n                        double corn_x_70211;\n                        \n                        if (zlze_res_70210) {\n                            corn_x_70211 = zp_res_70063;\n                        } else {\n                            corn_x_70211 = zp_res_70069;\n                        }\n                        \n                        bool zlze_res_70212 = eta_p_70049 <= zp_res_70068;\n                        double corn_",
                                    "y_70213;\n                        \n                        if (zlze_res_70212) {\n                            corn_y_70213 = zp_res_70068;\n                        } else {\n                            corn_y_70213 = zp_res_70070;\n                        }\n                        \n                        double dist_res_70214;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            bool eq_x_y_70215 = eta_p_70048 == zp_res_70063;\n                            bool eq_x_zz_70216 = eta_p_70048 == zp_res_70069;\n                            bool p_and_eq_x_y_70217 = zlze_res_70210 && eq_x_y_70215;\n                            bool not_p_70218 = !zlze_res_70210;\n                            bool p_and_eq_x_y_70219 = eq_x_zz_70216 && not_p_70218;\n                            bool zeze_res_70220 = p_and_eq_x_y_70217 || p_and_eq_x_y_70219;\n                            double d_euclidean_res_70221;\n                            \n                            if (zeze_res_70220) {\n                                double zm_res_70222 = eta_p_70049 - corn_y_70213;\n                                double abs_res_70223 = fabs64(zm_res_70222);\n                                \n                                d_euclidean_res_70221 = abs_res_70223;\n                            } else {\n                                bool eq_x_y_70224 = eta_p_70049 == zp_res_70068;\n                                bool eq_x_zz_70225 = eta_p_70049 == zp_res_70070;\n                                bool p_and_eq_x_y_70226 = zlze_res_70212 && eq_x_y_70224;\n                                bool not_p_70227 = !zlze_res_70212;\n                                bool p_and_eq_x_y_70228 = eq_x_zz_70225 && not_p_70227;\n                                bool zeze_res_70229 = p_and_eq_x_y_70226 || p_and_eq_x_y_70228;\n                                double d_euclidean_res_f_res_70230;\n                                \n                                if (zeze_res_70229) {\n              ", "                      double zm_res_70231 = eta_p_70048 - corn_x_70211;\n                                    double abs_res_70232 = fabs64(zm_res_70231);\n                                    \n                                    d_euclidean_res_f_res_70230 = abs_res_70232;\n                                } else {\n                                    double zm_res_70233 = eta_p_70049 - corn_y_70213;\n                                    double zm_res_70234 = eta_p_70048 - corn_x_70211;\n                                    double hypot_res_70235 = futrts_hypot64(zm_res_70234, zm_res_70233);\n                                    \n                                    d_euclidean_res_f_res_70230 = hypot_res_70235;\n                                }\n                                d_euclidean_res_70221 = d_euclidean_res_f_res_70230;\n                            }\n                            dist_res_70214 = d_euclidean_res_70221;\n                        } else {\n                            double d_haversine_res_70236;\n                            double d_haversine_res_70237;\n                            double d_haversine_res_70238;\n                            double d_haversine_res_70239;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_70236 = eta_p_70048;\n                                d_haversine_res_70237 = eta_p_70049;\n                                d_haversine_res_70238 = corn_x_70211;\n                                d_haversine_res_70239 = corn_y_70213;\n                            } else {\n                                double zs_res_70240 = zt_res_70074 / 180.0;\n                                double zs_res_70241 = zt_res_70075 / 180.0;\n                                double zt_res_70242 = 3.141592653589793 * corn_x_70211;\n                                double zs_res_70243 = zt_res_70242 / 180.0;\n                                double zt_res_70244 = 3.141592653589793 * corn_y_70213;", "\n                                double zs_res_70245 = zt_res_70244 / 180.0;\n                                \n                                d_haversine_res_70236 = zs_res_70240;\n                                d_haversine_res_70237 = zs_res_70241;\n                                d_haversine_res_70238 = zs_res_70243;\n                                d_haversine_res_70239 = zs_res_70245;\n                            }\n                            \n                            double zm_res_70246 = d_haversine_res_70236 - d_haversine_res_70238;\n                            double cos_res_70247 = futrts_cos64(zm_res_70246);\n                            double zm_res_70248 = 1.0 - cos_res_70247;\n                            double cos_res_70249 = futrts_cos64(d_haversine_res_70238);\n                            double cos_res_70250 = futrts_cos64(d_haversine_res_70236);\n                            double zt_res_70251 = cos_res_70249 * cos_res_70250;\n                            double zm_res_70252 = d_haversine_res_70237 - d_haversine_res_70239;\n                            double zm_res_70253 = 1.0 - zm_res_70252;\n                            double zt_res_70254 = zt_res_70251 * zm_res_70253;\n                            double zp_res_70255 = zm_res_70248 + zt_res_70254;\n                            double zs_res_70256 = zp_res_70255 / 2.0;\n                            double min_res_70257 = fmin64(1.0, zs_res_70256);\n                            double zt_res_70258 = 2.0 * min_res_70257;\n                            double zm_res_70259 = 1.0 - zt_res_70258;\n                            double acos_res_70260 = futrts_acos64(zm_res_70259);\n                            double zt_res_70261 = clBase_36773 * acos_res_70260;\n                            \n                            dist_res_70214 = zt_res_70261;\n                        }\n                        \n                        bool zlze_res_70262 = dist_res_70214 <= zt_res_59476;\n                        bool x_70263 = !cond_70209;\n  ",
                                    "                      bool y_70264 = zlze_res_70262 && x_70263;\n                        bool is_pt_marginal_res_70265 = cond_70209 || y_70264;\n                        \n                        defunc_0_f_res_70052 = is_pt_marginal_res_70265;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = defunc_0_f_res_70052;\n                    }\n                }\n            } else {\n                ((__local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = 0;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, (int64_t) 8)) {\n            // perform segmented scan to imitate reduction\n            {\n                bool eta_p_70045;\n                bool eta_p_70046;\n                bool eta_p_84136;\n                bool eta_p_84137;\n                bool ltid_in_bounds_84139 = slt64(sext_i32_i64(local_tid_84124), (int64_t) 8 * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121));\n                int32_t skip_threads_84140;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_84139) {\n                        eta_p_70046 = ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)];\n                        if ((local_tid_84124 - squot32(local_tid_84124, 32) * 32) == 0) {\n                            eta_p_70045 = eta_p_70046;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84140 = 1;\n                    while (slt32(skip_threads_84140, 32)) {\n                        bool thread_active_84141 = sle32(skip_threads_84140, local_tid_84124 - squot32(loca", "l_tid_84124, 32) * 32) && ltid_in_bounds_84139;\n                        \n                        if (thread_active_84141) {\n                            // read operands\n                            {\n                                eta_p_70045 = ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124) - sext_i32_i64(skip_threads_84140)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_84142 = slt64(srem64(sext_i32_i64(local_tid_84124), (int64_t) 8), sext_i32_i64(local_tid_84124) - sext_i32_i64(local_tid_84124 - skip_threads_84140));\n                            \n                            if (thread_active_84141 && inactive_84142) {\n                                eta_p_70045 = eta_p_70046;\n                            }\n                            if (thread_active_84141) {\n                                if (!inactive_84142) {\n                                    bool defunc_0_op_res_70047 = eta_p_70045 || eta_p_70046;\n                                    \n                                    eta_p_70045 = defunc_0_op_res_70047;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_84126, skip_threads_84140)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84141) {\n                            // write result\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = eta_p_70045;\n                                eta_p_70046 = eta_p_70045;\n                            }\n                        }\n                        if (sle32(wave_sizze_84126, skip_threads_84140)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads", "_84140 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_84124 - squot32(local_tid_84124, 32) * 32) == 31 && ltid_in_bounds_84139) {\n                        ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(squot32(local_tid_84124, 32))] = eta_p_70045;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_84143;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_84124, 32) == 0 && ltid_in_bounds_84139) {\n                            eta_p_84137 = ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)];\n                            if ((local_tid_84124 - squot32(local_tid_84124, 32) * 32) == 0) {\n                                eta_p_84136 = eta_p_84137;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_84143 = 1;\n                        while (slt32(skip_threads_84143, 32)) {\n                            bool thread_active_84144 = sle32(skip_threads_84143, local_tid_84124 - squot32(local_tid_84124, 32) * 32) && (squot32(local_tid_84124, 32) == 0 && ltid_in_bounds_84139);\n                            \n                            if (thread_active_84144) {\n                                // read operands\n                                {\n                                    eta_p_84136 = ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124) - sext_i32_i64(skip_threads_84143)];\n                                }\n   ",
                                    "                         }\n                            // perform operation\n                            {\n                                bool inactive_84145 = slt64(srem64(sext_i32_i64(local_tid_84124 * 32 + 32 - 1), (int64_t) 8), sext_i32_i64(local_tid_84124 * 32 + 32 - 1) - sext_i32_i64((local_tid_84124 - skip_threads_84143) * 32 + 32 - 1));\n                                \n                                if (thread_active_84144 && inactive_84145) {\n                                    eta_p_84136 = eta_p_84137;\n                                }\n                                if (thread_active_84144) {\n                                    if (!inactive_84145) {\n                                        bool defunc_0_op_res_84138 = eta_p_84136 || eta_p_84137;\n                                        \n                                        eta_p_84136 = defunc_0_op_res_84138;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_84126, skip_threads_84143)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_84144) {\n                                // write result\n                                {\n                                    ((volatile __local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = eta_p_84136;\n                                    eta_p_84137 = eta_p_84136;\n                                }\n                            }\n                            if (sle32(wave_sizze_84126, skip_threads_84143)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_84143 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_84146 = squot32(local_tid_84124, 32) == 0 || !ltid_in_bou", "nds_84139;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_84146) {\n                            eta_p_70046 = eta_p_70045;\n                            eta_p_70045 = ((__local bool *) red_arr_bool_mem_84128)[sext_i32_i64(squot32(local_tid_84124, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_84147 = slt64(srem64(sext_i32_i64(local_tid_84124), (int64_t) 8), sext_i32_i64(local_tid_84124) - sext_i32_i64(squot32(local_tid_84124, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_84146) {\n                            if (inactive_84147) {\n                                eta_p_70045 = eta_p_70046;\n                            }\n                        }\n                        if (!no_carry_in_84146) {\n                            if (!inactive_84147) {\n                                bool defunc_0_op_res_70047 = eta_p_70045 || eta_p_70046;\n                                \n                                eta_p_70045 = defunc_0_op_res_70047;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_84146) {\n                            ((__local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = eta_p_70045;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_84124, 32) == 0 && ltid_in_bounds_84139) {\n                        ((__local bool *) red_arr_bool_mem_84128)[sext_i32_i64(local_tid_84124)] = eta_p_70046;\n                    }\n                }\n                barr", "ier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_84133) * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121) + sext_i32_i64(local_tid_84124), n_new_36762) && slt64(sext_i32_i64(local_tid_84124), squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121))) {\n                bool tmp_84148 = ((__local bool *) red_arr_bool_mem_84128)[(sext_i32_i64(local_tid_84124) + (int64_t) 1) * segment_sizze_nonzzero_84121 - (int64_t) 1];\n                \n                ((__global bool *) mem_82083)[sext_i32_i64(virt_tblock_id_84133) * squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121) + sext_i32_i64(local_tid_84124)] = tmp_84148;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_70038\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegscan_69309_dim1, 1, 1)\nvoid add_next_partition_doublezisegscan_69309(__global int *global_failure, int64_t num_tblocks_69305, int64_t num_virt_blocks_83678, int64_t num_virt_threads_83679, __global unsigned char *ext_mem_82056, __global unsigned char *mem_82059, __global unsigned char *status_flags_mem_83680, __global unsigned char *aggregates_mem_83682, __global unsigned char *incprefixes_mem_83684, __global unsigned char *global_dynid_mem_83686)\n{\n    #define segscan_tblock_sizze_69304 (add_next_partition_doublezisegscan_69309zisegscan_tblock_sizze_69304)\n    #define chunk_sizze_83677 (add_next_partition_doublezisegscan_69309zichunk_sizze_83677)\n    \n    volatile __local unsigned char *local_mem_83696_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83696_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69304), chunk_sizze_83677 * segscan_tblock_sizze_69304 * (int64_t) 8) + srem64((int64_t) 8 - ",
                                    "srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69304), chunk_sizze_83677 * segscan_tblock_sizze_69304 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83689;\n    int32_t tblock_sizze_83692;\n    int32_t wave_sizze_83691;\n    int32_t block_id_83690;\n    int32_t global_tid_83688;\n    int64_t phys_tid_69309;\n    int32_t chunk_sizze_32b_83693;\n    int64_t byte_offsets_83694;\n    int64_t warp_byte_offset_83695;\n    __local unsigned char *local_mem_83696;\n    int64_t trans_arr_len_83697;\n    int64_t phys_block_id_83703;\n    int64_t virtloop_bound_83704;\n    \n    local_tid_83689 = get_local_id(0);\n    tblock_sizze_83692 = get_local_size(0);\n    wave_sizze_83691 = LOCKSTEP_WIDTH;\n    block_id_83690 = get_tblock_id(0);\n    global_tid_83688 = block_id_83690 * tblock_sizze_83692 + local_tid_83689;\n    phys_tid_69309 = sext_i32_i64(global_tid_83688);\n    chunk_sizze_32b_83693 = sext_i64_i32(chunk_sizze_83677);\n    byte_offsets_83694 = segscan_tblock_sizze_69304 * (int64_t) 8;\n    warp_byte_offset_83695 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83696 = (__local unsigned char *) local_mem_83696_backing_0;\n    trans_arr_len_83697 = chunk_sizze_83677 * segscan_tblock_sizze_69304;\n    phys_block_id_83703 = get_tblock_id(0);\n    virtloop_bound_83704 = sdiv_up64(num_virt_blocks_83678 - phys_block_id_83703, num_tblocks_69305);\n    for (int64_t virtloop_i_83705 = 0; virtloop_i_83705 < virtloop_bound_83704; virtloop_i_83705++) {\n        int64_t dynamic_id_83706;\n        int64_t block_offset_83707;\n        int64_t sgm_idx_83708;\n        int32_t boundary_83709;\n        int32_t segsizze_compact_83710;\n        int64_t private_mem_83711[chunk_sizze_83677];\n        int64_t thd_offset_83713;\n        int64_t acc_83729;\n        int64_t prefix_83739;\n        bool block_new_sgm_83740;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n", "            if (local_tid_83689 == 0) {\n                dynamic_id_83706 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83686)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83696)[(int64_t) 0] = dynamic_id_83706;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83706 == num_virt_blocks_83678 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83686)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83706 = ((__local int32_t *) local_mem_83696)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83707 = dynamic_id_83706 * chunk_sizze_83677 * segscan_tblock_sizze_69304;\n        sgm_idx_83708 = smod64(block_offset_83707, (int64_t) 8);\n        boundary_83709 = sext_i64_i32(smin64(chunk_sizze_83677 * segscan_tblock_sizze_69304, (int64_t) 8 - sgm_idx_83708));\n        segsizze_compact_83710 = sext_i64_i32(smin64(chunk_sizze_83677 * segscan_tblock_sizze_69304, (int64_t) 8));\n        thd_offset_83713 = block_offset_83707 + sext_i32_i64(local_tid_83689);\n        // Load and map\n        {\n            for (int64_t i_83714 = 0; i_83714 < chunk_sizze_83677; i_83714++) {\n                int64_t virt_tid_83715 = thd_offset_83713 + i_83714 * segscan_tblock_sizze_69304;\n                int64_t slice_83716 = (int64_t) 8;\n                int64_t gtid_69308 = virt_tid_83715;\n                int64_t remnant_83717 = virt_tid_83715 - gtid_69308;\n                \n                if (slt64(virt_tid_83715, (int64_t) 8)) {\n                    int64_t x_69313 = ((__global int64_t *) ext_mem_82056)[gtid_69308];\n                    \n                    private_mem_83711[i_83714] = x_69313;\n                } else {\n                    private_me", "m_83711[i_83714] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83718 = 0; i_83718 < chunk_sizze_83677; i_83718++) {\n                int64_t sharedIdx_83719 = sext_i32_i64(local_tid_83689) + i_83718 * segscan_tblock_sizze_69304;\n                int64_t tmp_83720 = private_mem_83711[i_83718];\n                \n                ((__local int64_t *) local_mem_83696)[sharedIdx_83719] = tmp_83720;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83721 = 0; i_83721 < chunk_sizze_83677; i_83721++) {\n                int64_t sharedIdx_83722 = sext_i32_i64(local_tid_83689) * chunk_sizze_83677 + i_83721;\n                int64_t tmp_83723 = ((__local int64_t *) local_mem_83696)[sharedIdx_83722];\n                \n                private_mem_83711[i_83721] = tmp_83723;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83724 = 0; i_83724 < chunk_sizze_83677 - (int64_t) 1; i_83724++) {\n                int64_t eta_p_69310;\n                int64_t eta_p_69311;\n                \n                eta_p_69310 = private_mem_83711[i_83724];\n                eta_p_69311 = private_mem_83711[i_83724 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_69312 = add64(eta_p_69310, eta_p_69311);\n                \n                private_mem_83711[i_83724 + (int64_t) 1] = defunc_0_op_res_69312;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83725 = private_mem_83711[chunk_sizze_83677 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = tmp_83725;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83726;\n            int64_t eta_p_83727;\n            int64_t eta_p_83730",
                                    ";\n            int64_t eta_p_83731;\n            bool ltid_in_bounds_83733 = slt64(sext_i32_i64(local_tid_83689), num_virt_threads_83679);\n            int32_t skip_threads_83734;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83733) {\n                    eta_p_83727 = ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)];\n                    if ((local_tid_83689 - squot32(local_tid_83689, 32) * 32) == 0) {\n                        eta_p_83726 = eta_p_83727;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83734 = 1;\n                while (slt32(skip_threads_83734, 32)) {\n                    bool thread_active_83735 = sle32(skip_threads_83734, local_tid_83689 - squot32(local_tid_83689, 32) * 32) && ltid_in_bounds_83733;\n                    \n                    if (thread_active_83735) {\n                        // read operands\n                        {\n                            eta_p_83726 = ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689) - sext_i32_i64(skip_threads_83734)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83735) {\n                            int64_t defunc_0_op_res_83728 = add64(eta_p_83726, eta_p_83727);\n                            \n                            eta_p_83726 = defunc_0_op_res_83728;\n                        }\n                    }\n                    if (sle32(wave_sizze_83691, skip_threads_83734)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83735) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = eta_p_83726;\n              ", "              eta_p_83727 = eta_p_83726;\n                        }\n                    }\n                    if (sle32(wave_sizze_83691, skip_threads_83734)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83734 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83689 - squot32(local_tid_83689, 32) * 32) == 31 && ltid_in_bounds_83733) {\n                    ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(squot32(local_tid_83689, 32))] = eta_p_83726;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83736;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83689, 32) == 0 && ltid_in_bounds_83733) {\n                        eta_p_83731 = ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)];\n                        if ((local_tid_83689 - squot32(local_tid_83689, 32) * 32) == 0) {\n                            eta_p_83730 = eta_p_83731;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83736 = 1;\n                    while (slt32(skip_threads_83736, 32)) {\n                        bool thread_active_83737 = sle32(skip_threads_83736, local_tid_83689 - squot32(local_tid_83689, 32) * 32) && (squot32(local_tid_83689, 32) == 0 && ltid_in_bounds_83733);\n                        \n                        if (thread_active_83737) {\n                            // read operands\n                            {\n                                eta_p_83730 = ((volatile __local int64_t ", "*) local_mem_83696)[sext_i32_i64(local_tid_83689) - sext_i32_i64(skip_threads_83736)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83737) {\n                                int64_t defunc_0_op_res_83732 = add64(eta_p_83730, eta_p_83731);\n                                \n                                eta_p_83730 = defunc_0_op_res_83732;\n                            }\n                        }\n                        if (sle32(wave_sizze_83691, skip_threads_83736)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83737) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = eta_p_83730;\n                                eta_p_83731 = eta_p_83730;\n                            }\n                        }\n                        if (sle32(wave_sizze_83691, skip_threads_83736)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83736 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83738 = squot32(local_tid_83689, 32) == 0 || !ltid_in_bounds_83733;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83738) {\n                        eta_p_83727 = eta_p_83726;\n                        eta_p_83726 = ((__local int64_t *) local_mem_83696)[sext_i32_i64(squot32(local_tid_83689, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83738) {\n                        int64_",
                                    "t defunc_0_op_res_83728 = add64(eta_p_83726, eta_p_83727);\n                        \n                        eta_p_83726 = defunc_0_op_res_83728;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83738) {\n                        ((__local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = eta_p_83726;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83689, 32) == 0 && ltid_in_bounds_83733) {\n                    ((__local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = eta_p_83727;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83689 == 0) {\n                acc_83729 = ((__local int64_t *) local_mem_83696)[segscan_tblock_sizze_69304 - (int64_t) 1];\n            } else {\n                acc_83729 = ((__local int64_t *) local_mem_83696)[sext_i32_i64(local_tid_83689) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83739 = (int64_t) 0;\n        block_new_sgm_83740 = sgm_idx_83708 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83740 && local_tid_83689 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83684)[dynamic_id_83706] = acc_83729;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83680)[dynamic_id_83706] = (int8_t) 2;\n                acc_83729 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83740 && slt32(local_tid_83689, wave_sizze_83691)) {\n                if (local_tid_83689 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83682)[dynamic_id_83706] = acc_83729;\n                    mem_fence_global();\n                    ((volatil", "e __global int8_t *) status_flags_mem_83680)[dynamic_id_83706] = (int8_t) 1;\n                    \n                    int8_t tmp_83741 = ((volatile __global int8_t *) status_flags_mem_83680)[dynamic_id_83706 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83696)[(int64_t) 0] = tmp_83741;\n                }\n                mem_fence_local();\n                \n                int8_t status_83742 = ((__local int8_t *) local_mem_83696)[(int64_t) 0];\n                \n                if (status_83742 == (int8_t) 2) {\n                    if (local_tid_83689 == 0) {\n                        prefix_83739 = ((volatile __global int64_t *) incprefixes_mem_83684)[dynamic_id_83706 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83743 = sext_i64_i32(dynamic_id_83706 - sext_i32_i64(wave_sizze_83691));\n                    \n                    while (slt32(wave_sizze_83691 * -1, readOffset_83743)) {\n                        int32_t read_i_83744 = readOffset_83743 + local_tid_83689;\n                        int64_t aggr_83745 = (int64_t) 0;\n                        int8_t flag_83746 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83744)) {\n                            flag_83746 = ((volatile __global int8_t *) status_flags_mem_83680)[sext_i32_i64(read_i_83744)];\n                            if (flag_83746 == (int8_t) 2) {\n                                aggr_83745 = ((volatile __global int64_t *) incprefixes_mem_83684)[sext_i32_i64(read_i_83744)];\n                            } else if (flag_83746 == (int8_t) 1) {\n                                aggr_83745 = ((volatile __global int64_t *) aggregates_mem_83682)[sext_i32_i64(read_i_83744)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83696)[(int64_t) 4 + sext_i32_i64(local_tid_83689)] = aggr_83745;\n                        ((__local int8_t *) loc", "al_mem_83696)[sext_i32_i64(local_tid_83689)] = flag_83746;\n                        flag_83746 = ((__local int8_t *) local_mem_83696)[sext_i32_i64(wave_sizze_83691) - (int64_t) 1];\n                        if (slt8(flag_83746, (int8_t) 2)) {\n                            int8_t flg_x_83750;\n                            int8_t flg_y_83751;\n                            int64_t eta_p_83747;\n                            int64_t eta_p_83748;\n                            int32_t skip_threads_83752;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83751 = ((volatile __local int8_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)];\n                                eta_p_83748 = ((volatile __local int64_t *) local_mem_83696)[(int64_t) 4 + sext_i32_i64(local_tid_83689)];\n                                if ((local_tid_83689 - squot32(local_tid_83689, 32) * 32) == 0) {\n                                    eta_p_83747 = eta_p_83748;\n                                    flg_x_83750 = flg_y_83751;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83752 = 1;\n                                while (slt32(skip_threads_83752, 32)) {\n                                    if (sle32(skip_threads_83752, local_tid_83689 - squot32(local_tid_83689, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83750 = ((volatile __local int8_t *) local_mem_83696)[sext_i32_i64(local_tid_83689) - sext_i32_i64(skip_threads_83752)];\n                                            eta_p_83747 = ((volatile __local int64_t *) local_mem_83696)[(int64_t) 4 + (sext_i32_i64(local_tid_83689) - sext_i32_i64(skip_threads_83752))];\n                          ",
                                    "              }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83751 == (int8_t) 2 || flg_y_83751 == (int8_t) 0) {\n                                                flg_x_83750 = flg_y_83751;\n                                                eta_p_83747 = eta_p_83748;\n                                            } else {\n                                                int64_t defunc_0_op_res_83749 = add64(eta_p_83747, eta_p_83748);\n                                                \n                                                eta_p_83747 = defunc_0_op_res_83749;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83696)[sext_i32_i64(local_tid_83689)] = flg_x_83750;\n                                            flg_y_83751 = flg_x_83750;\n                                            ((volatile __local int64_t *) local_mem_83696)[(int64_t) 4 + sext_i32_i64(local_tid_83689)] = eta_p_83747;\n                                            eta_p_83748 = eta_p_83747;\n                                        }\n                                    }\n                                    skip_threads_83752 *= 2;\n                                }\n                            }\n                        }\n                        flag_83746 = ((__local int8_t *) local_mem_83696)[sext_i32_i64(wave_sizze_83691) - (int64_t) 1];\n                        aggr_83745 = ((__local int64_t *) local_mem_83696)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83691) - (int64_t) 1)];\n                        if (flag_83746 == (int8_t) 2) {\n                            readOffset_83743 = wave_sizze_83691 * -1;\n                        } else if (flag_83746 == (int8_t) 1) {\n                            rea", "dOffset_83743 -= wave_sizze_83691;\n                        }\n                        if (slt8((int8_t) 0, flag_83746)) {\n                            int64_t eta_p_83753 = aggr_83745;\n                            int64_t eta_p_83754 = prefix_83739;\n                            int64_t defunc_0_op_res_83755 = add64(eta_p_83753, eta_p_83754);\n                            \n                            prefix_83739 = defunc_0_op_res_83755;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83689 == 0) {\n                    if (boundary_83709 == sext_i64_i32(segscan_tblock_sizze_69304 * chunk_sizze_83677)) {\n                        int64_t eta_p_83756 = prefix_83739;\n                        int64_t eta_p_83757 = acc_83729;\n                        int64_t defunc_0_op_res_83758 = add64(eta_p_83756, eta_p_83757);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83684)[dynamic_id_83706] = defunc_0_op_res_83758;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83680)[dynamic_id_83706] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83696)[(int64_t) 4] = prefix_83739;\n                    acc_83729 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83706 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83739 = ((__local int64_t *) local_mem_83696)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83759;\n            int64_t eta_p_83760;\n            int64_t eta_p_83762 = prefix_83739;\n            int64_t eta_p_83763 = acc_83729;\n            \n            if (slt32(local_tid_83689 * chunk_sizze_32b_83693, boundary_83709) && !block_new_sgm_83740) {\n                int64_t defunc_0_op_res_837", "64 = add64(eta_p_83762, eta_p_83763);\n                \n                eta_p_83759 = defunc_0_op_res_83764;\n            } else {\n                eta_p_83759 = acc_83729;\n            }\n            \n            int32_t stopping_point_83765 = segsizze_compact_83710 - srem32(local_tid_83689 * chunk_sizze_32b_83693 - 1 + segsizze_compact_83710 - boundary_83709, segsizze_compact_83710);\n            \n            for (int64_t i_83766 = 0; i_83766 < chunk_sizze_83677; i_83766++) {\n                if (slt32(sext_i64_i32(i_83766), stopping_point_83765 - 1)) {\n                    eta_p_83760 = private_mem_83711[i_83766];\n                    \n                    int64_t defunc_0_op_res_83761 = add64(eta_p_83759, eta_p_83760);\n                    \n                    private_mem_83711[i_83766] = defunc_0_op_res_83761;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83767 = 0; i_83767 < chunk_sizze_83677; i_83767++) {\n                int64_t sharedIdx_83768 = sext_i32_i64(local_tid_83689) * chunk_sizze_83677 + i_83767;\n                int64_t tmp_83769 = private_mem_83711[i_83767];\n                \n                ((__local int64_t *) local_mem_83696)[sharedIdx_83768] = tmp_83769;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83770 = 0; i_83770 < chunk_sizze_83677; i_83770++) {\n                int64_t flat_idx_83771 = thd_offset_83713 + i_83770 * segscan_tblock_sizze_69304;\n                int64_t slice_83772 = (int64_t) 8;\n                int64_t gtid_69308 = flat_idx_83771;\n                int64_t remnant_83773 = flat_idx_83771 - gtid_69308;\n                \n                if (slt64(flat_idx_83771, (int64_t) 8)) {\n                    int64_t tmp_83774 = ((__local int64_t *) local_mem_83696)[flat_idx_83771 - block_offset_83707];\n                    \n                    ((__global int64_t *) mem_82059)[gtid_69308] = tmp_83774;\n   ",
                                    "             }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_69304\n    #undef chunk_sizze_83677\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegscan_69333_dim1, 1, 1)\nvoid add_next_partition_doublezisegscan_69333(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t part_no_36754, int64_t dz2083U_36759, int64_t conc_tmp_59874, int64_t num_tblocks_69330, int64_t num_virt_blocks_83794, int64_t num_virt_threads_83795, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_81958, __global unsigned char *mem_82070, __global unsigned char *mem_82076, __global unsigned char *mem_82078, __global unsigned char *status_flags_mem_83796, __global unsigned char *aggregates_mem_83798, __global unsigned char *incprefixes_mem_83800, __global unsigned char *global_dynid_mem_83802)\n{\n    #define segscan_tblock_sizze_69328 (add_next_partition_doublezisegscan_69333zisegscan_tblock_sizze_69328)\n    #define chunk_sizze_83793 (add_next_partition_doublezisegscan_69333zichunk_sizze_83793)\n    \n    volatile __local unsigned char *local_mem_83812_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83812_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69328), chunk_sizze_83793 * segscan_tblock_sizze_69328 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69328), chunk_sizze_83793 * segscan_tblock_sizze_69328 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83805;\n    int32_t tblock_sizze_83808;\n    int32_t wave_sizze_83807;\n    int32_t block_id_83806;\n    int32_t global_tid_83804;\n    int64", "_t phys_tid_69333;\n    int32_t chunk_sizze_32b_83809;\n    int64_t byte_offsets_83810;\n    int64_t warp_byte_offset_83811;\n    __local unsigned char *local_mem_83812;\n    int64_t trans_arr_len_83813;\n    int64_t phys_block_id_83819;\n    int64_t virtloop_bound_83820;\n    \n    local_tid_83805 = get_local_id(0);\n    tblock_sizze_83808 = get_local_size(0);\n    wave_sizze_83807 = LOCKSTEP_WIDTH;\n    block_id_83806 = get_tblock_id(0);\n    global_tid_83804 = block_id_83806 * tblock_sizze_83808 + local_tid_83805;\n    phys_tid_69333 = sext_i32_i64(global_tid_83804);\n    chunk_sizze_32b_83809 = sext_i64_i32(chunk_sizze_83793);\n    byte_offsets_83810 = segscan_tblock_sizze_69328 * (int64_t) 8;\n    warp_byte_offset_83811 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83812 = (__local unsigned char *) local_mem_83812_backing_0;\n    trans_arr_len_83813 = chunk_sizze_83793 * segscan_tblock_sizze_69328;\n    phys_block_id_83819 = get_tblock_id(0);\n    virtloop_bound_83820 = sdiv_up64(num_virt_blocks_83794 - phys_block_id_83819, num_tblocks_69330);\n    for (int64_t virtloop_i_83821 = 0; virtloop_i_83821 < virtloop_bound_83820; virtloop_i_83821++) {\n        int64_t dynamic_id_83822;\n        int64_t block_offset_83823;\n        int64_t sgm_idx_83824;\n        int32_t boundary_83825;\n        int32_t segsizze_compact_83826;\n        int64_t private_mem_83827[chunk_sizze_83793];\n        int64_t thd_offset_83829;\n        int64_t acc_83845;\n        int64_t prefix_83855;\n        bool block_new_sgm_83856;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83805 == 0) {\n                dynamic_id_83822 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83802)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83812)[(int64_t) 0] = dynamic_id_83822;\n                }\n                // First thread in l", "ast (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83822 == num_virt_blocks_83794 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83802)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83822 = ((__local int32_t *) local_mem_83812)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83823 = dynamic_id_83822 * chunk_sizze_83793 * segscan_tblock_sizze_69328;\n        sgm_idx_83824 = smod64(block_offset_83823, conc_tmp_59874);\n        boundary_83825 = sext_i64_i32(smin64(chunk_sizze_83793 * segscan_tblock_sizze_69328, conc_tmp_59874 - sgm_idx_83824));\n        segsizze_compact_83826 = sext_i64_i32(smin64(chunk_sizze_83793 * segscan_tblock_sizze_69328, conc_tmp_59874));\n        thd_offset_83829 = block_offset_83823 + sext_i32_i64(local_tid_83805);\n        // Load and map\n        {\n            for (int64_t i_83830 = 0; i_83830 < chunk_sizze_83793; i_83830++) {\n                int64_t virt_tid_83831 = thd_offset_83829 + i_83830 * segscan_tblock_sizze_69328;\n                int64_t slice_83832 = conc_tmp_59874;\n                int64_t gtid_69332 = virt_tid_83831;\n                int64_t remnant_83833 = virt_tid_83831 - gtid_69332;\n                \n                if (slt64(virt_tid_83831, conc_tmp_59874)) {\n                    bool index_concat_cmp_77764 = sle64(dz2083U_36759, gtid_69332);\n                    int64_t index_concat_branch_77768;\n                    \n                    if (index_concat_cmp_77764) {\n                        int64_t index_concat_i_77765 = sub64(gtid_69332, dz2083U_36759);\n                        int64_t index_concat_77766 = ((__global int64_t *) mem_82070)[index_concat_i_77765];\n                        \n                        index_concat_branch_77768 = index_concat_77766;\n                    } else {\n                        int64_t index_concat_77767 = ((__g",
                                    "lobal int64_t *) clProc_mem_81938)[gtid_69332];\n                        \n                        index_concat_branch_77768 = index_concat_77767;\n                    }\n                    \n                    bool x_64008 = sle64((int64_t) 0, index_concat_branch_77768);\n                    bool y_64009 = slt64(index_concat_branch_77768, part_no_36754);\n                    bool bounds_check_64010 = x_64008 && y_64009;\n                    bool index_certs_64011;\n                    \n                    if (!bounds_check_64010) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 8) == -1) {\n                                global_failure_args[0] = (int64_t) index_concat_branch_77768;\n                                global_failure_args[1] = (int64_t) part_no_36754;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    bool tmp_64012 = ((__global bool *) mem_81958)[index_concat_branch_77768];\n                    bool lifted_lambda_res_64013 = !tmp_64012;\n                    int64_t defunc_0_f_res_64014 = btoi_bool_i64(lifted_lambda_res_64013);\n                    \n                    ((__global int64_t *) mem_82078)[gtid_69332] = defunc_0_f_res_64014;\n                    private_mem_83827[i_83830] = defunc_0_f_res_64014;\n                } else {\n                    private_mem_83827[i_83830] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83834 = 0; i_83834 < chunk_sizze_83793; i_83834++) {\n                int64_t sharedIdx_83835 = sext_i32_i64(local_tid_83805) + i_83834 * segscan_tblock_sizze_69328;\n             ", "   int64_t tmp_83836 = private_mem_83827[i_83834];\n                \n                ((__local int64_t *) local_mem_83812)[sharedIdx_83835] = tmp_83836;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83837 = 0; i_83837 < chunk_sizze_83793; i_83837++) {\n                int64_t sharedIdx_83838 = sext_i32_i64(local_tid_83805) * chunk_sizze_83793 + i_83837;\n                int64_t tmp_83839 = ((__local int64_t *) local_mem_83812)[sharedIdx_83838];\n                \n                private_mem_83827[i_83837] = tmp_83839;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83840 = 0; i_83840 < chunk_sizze_83793 - (int64_t) 1; i_83840++) {\n                int64_t eta_p_59887;\n                int64_t eta_p_59888;\n                \n                eta_p_59887 = private_mem_83827[i_83840];\n                eta_p_59888 = private_mem_83827[i_83840 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_59889 = add64(eta_p_59887, eta_p_59888);\n                \n                private_mem_83827[i_83840 + (int64_t) 1] = defunc_0_op_res_59889;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83841 = private_mem_83827[chunk_sizze_83793 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = tmp_83841;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83842;\n            int64_t eta_p_83843;\n            int64_t eta_p_83846;\n            int64_t eta_p_83847;\n            bool ltid_in_bounds_83849 = slt64(sext_i32_i64(local_tid_83805), num_virt_threads_83795);\n            int32_t skip_threads_83850;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83849) {\n                    eta_p_83843 = ((volatile __local int64_t *) loca", "l_mem_83812)[sext_i32_i64(local_tid_83805)];\n                    if ((local_tid_83805 - squot32(local_tid_83805, 32) * 32) == 0) {\n                        eta_p_83842 = eta_p_83843;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83850 = 1;\n                while (slt32(skip_threads_83850, 32)) {\n                    bool thread_active_83851 = sle32(skip_threads_83850, local_tid_83805 - squot32(local_tid_83805, 32) * 32) && ltid_in_bounds_83849;\n                    \n                    if (thread_active_83851) {\n                        // read operands\n                        {\n                            eta_p_83842 = ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805) - sext_i32_i64(skip_threads_83850)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83851) {\n                            int64_t defunc_0_op_res_83844 = add64(eta_p_83842, eta_p_83843);\n                            \n                            eta_p_83842 = defunc_0_op_res_83844;\n                        }\n                    }\n                    if (sle32(wave_sizze_83807, skip_threads_83850)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83851) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = eta_p_83842;\n                            eta_p_83843 = eta_p_83842;\n                        }\n                    }\n                    if (sle32(wave_sizze_83807, skip_threads_83850)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83850 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n     ",
                                    "       // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83805 - squot32(local_tid_83805, 32) * 32) == 31 && ltid_in_bounds_83849) {\n                    ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(squot32(local_tid_83805, 32))] = eta_p_83842;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83852;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83805, 32) == 0 && ltid_in_bounds_83849) {\n                        eta_p_83847 = ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)];\n                        if ((local_tid_83805 - squot32(local_tid_83805, 32) * 32) == 0) {\n                            eta_p_83846 = eta_p_83847;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83852 = 1;\n                    while (slt32(skip_threads_83852, 32)) {\n                        bool thread_active_83853 = sle32(skip_threads_83852, local_tid_83805 - squot32(local_tid_83805, 32) * 32) && (squot32(local_tid_83805, 32) == 0 && ltid_in_bounds_83849);\n                        \n                        if (thread_active_83853) {\n                            // read operands\n                            {\n                                eta_p_83846 = ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805) - sext_i32_i64(skip_threads_83852)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83853) {\n                                int64_t defunc_0_op_res_83848 = add64(eta_p_83846, eta_p_83", "847);\n                                \n                                eta_p_83846 = defunc_0_op_res_83848;\n                            }\n                        }\n                        if (sle32(wave_sizze_83807, skip_threads_83852)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83853) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = eta_p_83846;\n                                eta_p_83847 = eta_p_83846;\n                            }\n                        }\n                        if (sle32(wave_sizze_83807, skip_threads_83852)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83852 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83854 = squot32(local_tid_83805, 32) == 0 || !ltid_in_bounds_83849;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83854) {\n                        eta_p_83843 = eta_p_83842;\n                        eta_p_83842 = ((__local int64_t *) local_mem_83812)[sext_i32_i64(squot32(local_tid_83805, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83854) {\n                        int64_t defunc_0_op_res_83844 = add64(eta_p_83842, eta_p_83843);\n                        \n                        eta_p_83842 = defunc_0_op_res_83844;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83854) {\n                        ((__local int64_t *) local_mem_83812)[sext_i32_i6", "4(local_tid_83805)] = eta_p_83842;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83805, 32) == 0 && ltid_in_bounds_83849) {\n                    ((__local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = eta_p_83843;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83805 == 0) {\n                acc_83845 = ((__local int64_t *) local_mem_83812)[segscan_tblock_sizze_69328 - (int64_t) 1];\n            } else {\n                acc_83845 = ((__local int64_t *) local_mem_83812)[sext_i32_i64(local_tid_83805) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83855 = (int64_t) 0;\n        block_new_sgm_83856 = sgm_idx_83824 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83856 && local_tid_83805 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83800)[dynamic_id_83822] = acc_83845;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83796)[dynamic_id_83822] = (int8_t) 2;\n                acc_83845 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83856 && slt32(local_tid_83805, wave_sizze_83807)) {\n                if (local_tid_83805 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83798)[dynamic_id_83822] = acc_83845;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83796)[dynamic_id_83822] = (int8_t) 1;\n                    \n                    int8_t tmp_83857 = ((volatile __global int8_t *) status_flags_mem_83796)[dynamic_id_83822 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83812)[(int64_t) 0] = tmp_83857;\n                }\n     ",
                                    "           mem_fence_local();\n                \n                int8_t status_83858 = ((__local int8_t *) local_mem_83812)[(int64_t) 0];\n                \n                if (status_83858 == (int8_t) 2) {\n                    if (local_tid_83805 == 0) {\n                        prefix_83855 = ((volatile __global int64_t *) incprefixes_mem_83800)[dynamic_id_83822 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83859 = sext_i64_i32(dynamic_id_83822 - sext_i32_i64(wave_sizze_83807));\n                    \n                    while (slt32(wave_sizze_83807 * -1, readOffset_83859)) {\n                        int32_t read_i_83860 = readOffset_83859 + local_tid_83805;\n                        int64_t aggr_83861 = (int64_t) 0;\n                        int8_t flag_83862 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83860)) {\n                            flag_83862 = ((volatile __global int8_t *) status_flags_mem_83796)[sext_i32_i64(read_i_83860)];\n                            if (flag_83862 == (int8_t) 2) {\n                                aggr_83861 = ((volatile __global int64_t *) incprefixes_mem_83800)[sext_i32_i64(read_i_83860)];\n                            } else if (flag_83862 == (int8_t) 1) {\n                                aggr_83861 = ((volatile __global int64_t *) aggregates_mem_83798)[sext_i32_i64(read_i_83860)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83812)[(int64_t) 4 + sext_i32_i64(local_tid_83805)] = aggr_83861;\n                        ((__local int8_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = flag_83862;\n                        flag_83862 = ((__local int8_t *) local_mem_83812)[sext_i32_i64(wave_sizze_83807) - (int64_t) 1];\n                        if (slt8(flag_83862, (int8_t) 2)) {\n                            int8_t flg_x_83866;\n                            int8_t flg_y_83867;\n                        ", "    int64_t eta_p_83863;\n                            int64_t eta_p_83864;\n                            int32_t skip_threads_83868;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83867 = ((volatile __local int8_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)];\n                                eta_p_83864 = ((volatile __local int64_t *) local_mem_83812)[(int64_t) 4 + sext_i32_i64(local_tid_83805)];\n                                if ((local_tid_83805 - squot32(local_tid_83805, 32) * 32) == 0) {\n                                    eta_p_83863 = eta_p_83864;\n                                    flg_x_83866 = flg_y_83867;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83868 = 1;\n                                while (slt32(skip_threads_83868, 32)) {\n                                    if (sle32(skip_threads_83868, local_tid_83805 - squot32(local_tid_83805, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83866 = ((volatile __local int8_t *) local_mem_83812)[sext_i32_i64(local_tid_83805) - sext_i32_i64(skip_threads_83868)];\n                                            eta_p_83863 = ((volatile __local int64_t *) local_mem_83812)[(int64_t) 4 + (sext_i32_i64(local_tid_83805) - sext_i32_i64(skip_threads_83868))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83867 == (int8_t) 2 || flg_y_83867 == (int8_t) 0) {\n                                                flg_x_83866 = flg_y_83867;\n                                                eta_p_83863 ", "= eta_p_83864;\n                                            } else {\n                                                int64_t defunc_0_op_res_83865 = add64(eta_p_83863, eta_p_83864);\n                                                \n                                                eta_p_83863 = defunc_0_op_res_83865;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83812)[sext_i32_i64(local_tid_83805)] = flg_x_83866;\n                                            flg_y_83867 = flg_x_83866;\n                                            ((volatile __local int64_t *) local_mem_83812)[(int64_t) 4 + sext_i32_i64(local_tid_83805)] = eta_p_83863;\n                                            eta_p_83864 = eta_p_83863;\n                                        }\n                                    }\n                                    skip_threads_83868 *= 2;\n                                }\n                            }\n                        }\n                        flag_83862 = ((__local int8_t *) local_mem_83812)[sext_i32_i64(wave_sizze_83807) - (int64_t) 1];\n                        aggr_83861 = ((__local int64_t *) local_mem_83812)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83807) - (int64_t) 1)];\n                        if (flag_83862 == (int8_t) 2) {\n                            readOffset_83859 = wave_sizze_83807 * -1;\n                        } else if (flag_83862 == (int8_t) 1) {\n                            readOffset_83859 -= wave_sizze_83807;\n                        }\n                        if (slt8((int8_t) 0, flag_83862)) {\n                            int64_t eta_p_83869 = aggr_83861;\n                            int64_t eta_p_83870 = prefix_83855;\n                            int64_t defunc_0_op_res_83871 = add64(eta_p_83869, eta_p_83870);\n                    ",
                                    "        \n                            prefix_83855 = defunc_0_op_res_83871;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83805 == 0) {\n                    if (boundary_83825 == sext_i64_i32(segscan_tblock_sizze_69328 * chunk_sizze_83793)) {\n                        int64_t eta_p_83872 = prefix_83855;\n                        int64_t eta_p_83873 = acc_83845;\n                        int64_t defunc_0_op_res_83874 = add64(eta_p_83872, eta_p_83873);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83800)[dynamic_id_83822] = defunc_0_op_res_83874;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83796)[dynamic_id_83822] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83812)[(int64_t) 4] = prefix_83855;\n                    acc_83845 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83822 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83855 = ((__local int64_t *) local_mem_83812)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83875;\n            int64_t eta_p_83876;\n            int64_t eta_p_83878 = prefix_83855;\n            int64_t eta_p_83879 = acc_83845;\n            \n            if (slt32(local_tid_83805 * chunk_sizze_32b_83809, boundary_83825) && !block_new_sgm_83856) {\n                int64_t defunc_0_op_res_83880 = add64(eta_p_83878, eta_p_83879);\n                \n                eta_p_83875 = defunc_0_op_res_83880;\n            } else {\n                eta_p_83875 = acc_83845;\n            }\n            \n            int32_t stopping_point_83881 = segsizze_compact_83826 - srem32(local_tid_83805 * chunk_sizze_32b_83809 - 1 + segsizze_compact_83826 - boundary_83825, s", "egsizze_compact_83826);\n            \n            for (int64_t i_83882 = 0; i_83882 < chunk_sizze_83793; i_83882++) {\n                if (slt32(sext_i64_i32(i_83882), stopping_point_83881 - 1)) {\n                    eta_p_83876 = private_mem_83827[i_83882];\n                    \n                    int64_t defunc_0_op_res_83877 = add64(eta_p_83875, eta_p_83876);\n                    \n                    private_mem_83827[i_83882] = defunc_0_op_res_83877;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83883 = 0; i_83883 < chunk_sizze_83793; i_83883++) {\n                int64_t sharedIdx_83884 = sext_i32_i64(local_tid_83805) * chunk_sizze_83793 + i_83883;\n                int64_t tmp_83885 = private_mem_83827[i_83883];\n                \n                ((__local int64_t *) local_mem_83812)[sharedIdx_83884] = tmp_83885;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83886 = 0; i_83886 < chunk_sizze_83793; i_83886++) {\n                int64_t flat_idx_83887 = thd_offset_83829 + i_83886 * segscan_tblock_sizze_69328;\n                int64_t slice_83888 = conc_tmp_59874;\n                int64_t gtid_69332 = flat_idx_83887;\n                int64_t remnant_83889 = flat_idx_83887 - gtid_69332;\n                \n                if (slt64(flat_idx_83887, conc_tmp_59874)) {\n                    int64_t tmp_83890 = ((__local int64_t *) local_mem_83812)[flat_idx_83887 - block_offset_83823];\n                    \n                    ((__global int64_t *) mem_82076)[gtid_69332] = tmp_83890;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_69328\n    #undef chunk_sizze_83793\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegscan_70736_dim1, 1, 1)\nvoid add_next_partition_doublezisegscan_70736(__global int *global_failure, int64_t n_old_36753,", " int64_t num_tblocks_70733, int64_t num_virt_blocks_83168, int64_t num_virt_threads_83169, __global unsigned char *current_partition_mem_81943, __global unsigned char *mem_81961, __global unsigned char *mem_81963, __global unsigned char *mem_81965, __global unsigned char *status_flags_mem_83170, __global unsigned char *aggregates_mem_83192, __global unsigned char *incprefixes_mem_83194, __global unsigned char *aggregates_mem_83196, __global unsigned char *incprefixes_mem_83198, __global unsigned char *global_dynid_mem_83200)\n{\n    #define segscan_tblock_sizze_70731 (add_next_partition_doublezisegscan_70736zisegscan_tblock_sizze_70731)\n    #define chunk_sizze_83167 (add_next_partition_doublezisegscan_70736zichunk_sizze_83167)\n    \n    volatile __local unsigned char *local_mem_83232_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83232_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70731, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70731), smax64(chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8, chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70731, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70731), smax64(chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8, chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83223;\n    int32_t tblock_sizze_83226;\n    int32_t wave_sizze_83225;\n    int32_t block_id_83224;\n    int32_t global_tid_83222;\n    int64_t phys_tid_70736;\n    int32_t chunk_sizze_32b_83227;\n    int64_t byte_offsets_83228;\n    int64_t byte_offsets_83229;\n    int64_t warp_byte_offset_83230;\n    int64_t warp_byte_offset_83231;\n    __local unsigned char *local_mem_83232;\n    int64_t trans_arr_len_83233;\n    int64_t",
                                    " phys_block_id_83242;\n    int64_t virtloop_bound_83243;\n    \n    local_tid_83223 = get_local_id(0);\n    tblock_sizze_83226 = get_local_size(0);\n    wave_sizze_83225 = LOCKSTEP_WIDTH;\n    block_id_83224 = get_tblock_id(0);\n    global_tid_83222 = block_id_83224 * tblock_sizze_83226 + local_tid_83223;\n    phys_tid_70736 = sext_i32_i64(global_tid_83222);\n    chunk_sizze_32b_83227 = sext_i64_i32(chunk_sizze_83167);\n    byte_offsets_83228 = segscan_tblock_sizze_70731 * (int64_t) 8;\n    byte_offsets_83229 = sdiv_up64(byte_offsets_83228, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_70731 * (int64_t) 8;\n    warp_byte_offset_83230 = (int64_t) 288;\n    warp_byte_offset_83231 = sdiv_up64(warp_byte_offset_83230, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83232 = (__local unsigned char *) local_mem_83232_backing_0;\n    trans_arr_len_83233 = chunk_sizze_83167 * segscan_tblock_sizze_70731;\n    phys_block_id_83242 = get_tblock_id(0);\n    virtloop_bound_83243 = sdiv_up64(num_virt_blocks_83168 - phys_block_id_83242, num_tblocks_70733);\n    for (int64_t virtloop_i_83244 = 0; virtloop_i_83244 < virtloop_bound_83243; virtloop_i_83244++) {\n        int64_t dynamic_id_83245;\n        int64_t block_offset_83246;\n        int64_t sgm_idx_83247;\n        int32_t boundary_83248;\n        int32_t segsizze_compact_83249;\n        int64_t private_mem_83250[chunk_sizze_83167];\n        int64_t private_mem_83252[chunk_sizze_83167];\n        int64_t thd_offset_83254;\n        int64_t acc_83280;\n        int64_t acc_83281;\n        int64_t prefix_83294;\n        int64_t prefix_83295;\n        bool block_new_sgm_83296;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83223 == 0) {\n                dynamic_id_83245 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83200)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n           ", "         ((__local int64_t *) local_mem_83232)[(int64_t) 0] = dynamic_id_83245;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83245 == num_virt_blocks_83168 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83200)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83245 = ((__local int32_t *) local_mem_83232)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83246 = dynamic_id_83245 * chunk_sizze_83167 * segscan_tblock_sizze_70731;\n        sgm_idx_83247 = smod64(block_offset_83246, n_old_36753);\n        boundary_83248 = sext_i64_i32(smin64(chunk_sizze_83167 * segscan_tblock_sizze_70731, n_old_36753 - sgm_idx_83247));\n        segsizze_compact_83249 = sext_i64_i32(smin64(chunk_sizze_83167 * segscan_tblock_sizze_70731, n_old_36753));\n        thd_offset_83254 = block_offset_83246 + sext_i32_i64(local_tid_83223);\n        // Load and map\n        {\n            for (int64_t i_83255 = 0; i_83255 < chunk_sizze_83167; i_83255++) {\n                int64_t virt_tid_83256 = thd_offset_83254 + i_83255 * segscan_tblock_sizze_70731;\n                int64_t slice_83257 = n_old_36753;\n                int64_t gtid_70735 = virt_tid_83256;\n                int64_t remnant_83258 = virt_tid_83256 - gtid_70735;\n                \n                if (slt64(virt_tid_83256, n_old_36753)) {\n                    bool x_63985 = ((__global bool *) current_partition_mem_81943)[gtid_70735];\n                    bool cond_neg_63986 = !x_63985;\n                    int64_t defunc_0_lifted_pzq_res_63987 = btoi_bool_i64(cond_neg_63986);\n                    bool is_i_63988 = defunc_0_lifted_pzq_res_63987 == (int64_t) 0;\n                    int64_t part_res_63989 = btoi_bool_i64(is_i_63988);\n                    int64_t part_res_63990;\n                    int64_t part_r", "es_63991;\n                    \n                    if (is_i_63988) {\n                        part_res_63990 = (int64_t) 0;\n                        part_res_63991 = (int64_t) 0;\n                    } else {\n                        bool is_i_63992 = defunc_0_lifted_pzq_res_63987 == (int64_t) 1;\n                        int64_t part_res_63993;\n                        \n                        if (is_i_63992) {\n                            part_res_63993 = (int64_t) 1;\n                        } else {\n                            part_res_63993 = (int64_t) 2;\n                        }\n                        \n                        int64_t part_res_63994 = btoi_bool_i64(is_i_63992);\n                        \n                        part_res_63990 = part_res_63993;\n                        part_res_63991 = part_res_63994;\n                    }\n                    ((__global int64_t *) mem_81965)[gtid_70735] = part_res_63990;\n                    private_mem_83250[i_83255] = part_res_63989;\n                    private_mem_83252[i_83255] = part_res_63991;\n                } else {\n                    private_mem_83250[i_83255] = (int64_t) 0;\n                    private_mem_83252[i_83255] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83259 = 0; i_83259 < chunk_sizze_83167; i_83259++) {\n                int64_t sharedIdx_83260 = sext_i32_i64(local_tid_83223) + i_83259 * segscan_tblock_sizze_70731;\n                int64_t tmp_83261 = private_mem_83250[i_83259];\n                \n                ((__local int64_t *) local_mem_83232)[sharedIdx_83260] = tmp_83261;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83262 = 0; i_83262 < chunk_sizze_83167; i_83262++) {\n                int64_t sharedIdx_83263 = sext_i32_i64(local_tid_83223) * chunk_sizze_83167 + i_83262;\n                int64_t tmp_83264 = ((__local int64_t *) local_mem_83232)",
                                    "[sharedIdx_83263];\n                \n                private_mem_83250[i_83262] = tmp_83264;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83265 = 0; i_83265 < chunk_sizze_83167; i_83265++) {\n                int64_t sharedIdx_83266 = sext_i32_i64(local_tid_83223) + i_83265 * segscan_tblock_sizze_70731;\n                int64_t tmp_83267 = private_mem_83252[i_83265];\n                \n                ((__local int64_t *) local_mem_83232)[sharedIdx_83266] = tmp_83267;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83268 = 0; i_83268 < chunk_sizze_83167; i_83268++) {\n                int64_t sharedIdx_83269 = sext_i32_i64(local_tid_83223) * chunk_sizze_83167 + i_83268;\n                int64_t tmp_83270 = ((__local int64_t *) local_mem_83232)[sharedIdx_83269];\n                \n                private_mem_83252[i_83268] = tmp_83270;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83271 = 0; i_83271 < chunk_sizze_83167 - (int64_t) 1; i_83271++) {\n                int64_t x_60404;\n                int64_t y_60406;\n                \n                x_60404 = private_mem_83250[i_83271];\n                y_60406 = private_mem_83250[i_83271 + (int64_t) 1];\n                \n                int64_t x_60405;\n                int64_t y_60407;\n                \n                x_60405 = private_mem_83252[i_83271];\n                y_60407 = private_mem_83252[i_83271 + (int64_t) 1];\n                \n                int64_t zz_60408 = x_60404 + y_60406;\n                int64_t zz_60409 = x_60405 + y_60407;\n                \n                private_mem_83250[i_83271 + (int64_t) 1] = zz_60408;\n                private_mem_83252[i_83271 + (int64_t) 1] = zz_60409;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83272 = private_mem_83250[chunk_sizze_83167 - (int64_t) 1];\n            \n            ", "((__local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = tmp_83272;\n            \n            int64_t tmp_83273 = private_mem_83252[chunk_sizze_83167 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = tmp_83273;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t x_83274;\n            int64_t x_83275;\n            int64_t y_83276;\n            int64_t y_83277;\n            int64_t x_83282;\n            int64_t x_83283;\n            int64_t y_83284;\n            int64_t y_83285;\n            bool ltid_in_bounds_83288 = slt64(sext_i32_i64(local_tid_83223), num_virt_threads_83169);\n            int32_t skip_threads_83289;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83288) {\n                    y_83276 = ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)];\n                    y_83277 = ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)];\n                    if ((local_tid_83223 - squot32(local_tid_83223, 32) * 32) == 0) {\n                        x_83274 = y_83276;\n                        x_83275 = y_83277;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83289 = 1;\n                while (slt32(skip_threads_83289, 32)) {\n                    bool thread_active_83290 = sle32(skip_threads_83289, local_tid_83223 - squot32(local_tid_83223, 32) * 32) && ltid_in_bounds_83288;\n                    \n                    if (thread_active_83290) {\n                        // read operands\n                        {\n                            x_83274 = ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_t", "hreads_83289)];\n                            x_83275 = ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + (sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83289))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83290) {\n                            int64_t zz_83278 = x_83274 + y_83276;\n                            int64_t zz_83279 = x_83275 + y_83277;\n                            \n                            x_83274 = zz_83278;\n                            x_83275 = zz_83279;\n                        }\n                    }\n                    if (sle32(wave_sizze_83225, skip_threads_83289)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83290) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = x_83274;\n                            y_83276 = x_83274;\n                            ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = x_83275;\n                            y_83277 = x_83275;\n                        }\n                    }\n                    if (sle32(wave_sizze_83225, skip_threads_83289)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83289 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83223 - squot32(local_tid_83223, 32) * 32) == 31 && ltid_in_bounds_83288) {\n                    ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(squot32(local_tid_83223, 32))] = x_83274;\n                    ((volatile __local int64_t *) local_mem_",
                                    "83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(squot32(local_tid_83223, 32))] = x_83275;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83291;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83223, 32) == 0 && ltid_in_bounds_83288) {\n                        y_83284 = ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)];\n                        y_83285 = ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)];\n                        if ((local_tid_83223 - squot32(local_tid_83223, 32) * 32) == 0) {\n                            x_83282 = y_83284;\n                            x_83283 = y_83285;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83291 = 1;\n                    while (slt32(skip_threads_83291, 32)) {\n                        bool thread_active_83292 = sle32(skip_threads_83291, local_tid_83223 - squot32(local_tid_83223, 32) * 32) && (squot32(local_tid_83223, 32) == 0 && ltid_in_bounds_83288);\n                        \n                        if (thread_active_83292) {\n                            // read operands\n                            {\n                                x_83282 = ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83291)];\n                                x_83283 = ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + (sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83291))];\n                            }\n                        }\n                        // perform ope", "ration\n                        {\n                            if (thread_active_83292) {\n                                int64_t zz_83286 = x_83282 + y_83284;\n                                int64_t zz_83287 = x_83283 + y_83285;\n                                \n                                x_83282 = zz_83286;\n                                x_83283 = zz_83287;\n                            }\n                        }\n                        if (sle32(wave_sizze_83225, skip_threads_83291)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83292) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = x_83282;\n                                y_83284 = x_83282;\n                                ((volatile __local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = x_83283;\n                                y_83285 = x_83283;\n                            }\n                        }\n                        if (sle32(wave_sizze_83225, skip_threads_83291)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83291 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83293 = squot32(local_tid_83223, 32) == 0 || !ltid_in_bounds_83288;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83293) {\n                        y_83276 = x_83274;\n                        y_83277 = x_83275;\n                        x_83274 = ((__local int64_t *) local_mem_83232)[sext_i32_i64(squot32(local_tid_83223, 32)) - (int64_t) 1];\n                        x_83275 = ((__lo", "cal int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_83223, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83293) {\n                        int64_t zz_83278 = x_83274 + y_83276;\n                        int64_t zz_83279 = x_83275 + y_83277;\n                        \n                        x_83274 = zz_83278;\n                        x_83275 = zz_83279;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83293) {\n                        ((__local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = x_83274;\n                        ((__local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = x_83275;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83223, 32) == 0 && ltid_in_bounds_83288) {\n                    ((__local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = y_83276;\n                    ((__local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = y_83277;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83223 == 0) {\n                acc_83280 = ((__local int64_t *) local_mem_83232)[segscan_tblock_sizze_70731 - (int64_t) 1];\n                acc_83281 = ((__local int64_t *) local_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + (segscan_tblock_sizze_70731 - (int64_t) 1)];\n            } else {\n                acc_83280 = ((__local int64_t *) local_mem_83232)[sext_i32_i64(local_tid_83223) - (int64_t) 1];\n                acc_83281 = ((__local int64_t *) loca",
                                    "l_mem_83232)[squot64(byte_offsets_83228, (int64_t) 8) + (sext_i32_i64(local_tid_83223) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83294 = (int64_t) 0;\n        prefix_83295 = (int64_t) 0;\n        block_new_sgm_83296 = sgm_idx_83247 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83296 && local_tid_83223 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83194)[dynamic_id_83245] = acc_83280;\n                ((volatile __global int64_t *) incprefixes_mem_83198)[dynamic_id_83245] = acc_83281;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83170)[dynamic_id_83245] = (int8_t) 2;\n                acc_83280 = (int64_t) 0;\n                acc_83281 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83296 && slt32(local_tid_83223, wave_sizze_83225)) {\n                if (local_tid_83223 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83192)[dynamic_id_83245] = acc_83280;\n                    ((volatile __global int64_t *) aggregates_mem_83196)[dynamic_id_83245] = acc_83281;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83170)[dynamic_id_83245] = (int8_t) 1;\n                    \n                    int8_t tmp_83297 = ((volatile __global int8_t *) status_flags_mem_83170)[dynamic_id_83245 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83232)[(int64_t) 0] = tmp_83297;\n                }\n                mem_fence_local();\n                \n                int8_t status_83298 = ((__local int8_t *) local_mem_83232)[(int64_t) 0];\n                \n                if (status_83298 == (int8_t) 2) {\n                    if (local_tid_83223 == 0) {\n                        prefix_83294 = ((volatile __global int64_t *) incprefixes_mem_83194)[dynamic_id_83245 - (int64_t) 1];\n                   ", "     prefix_83295 = ((volatile __global int64_t *) incprefixes_mem_83198)[dynamic_id_83245 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83299 = sext_i64_i32(dynamic_id_83245 - sext_i32_i64(wave_sizze_83225));\n                    \n                    while (slt32(wave_sizze_83225 * -1, readOffset_83299)) {\n                        int32_t read_i_83300 = readOffset_83299 + local_tid_83223;\n                        int64_t aggr_83301 = (int64_t) 0;\n                        int64_t aggr_83302 = (int64_t) 0;\n                        int8_t flag_83303 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83300)) {\n                            flag_83303 = ((volatile __global int8_t *) status_flags_mem_83170)[sext_i32_i64(read_i_83300)];\n                            if (flag_83303 == (int8_t) 2) {\n                                aggr_83301 = ((volatile __global int64_t *) incprefixes_mem_83194)[sext_i32_i64(read_i_83300)];\n                                aggr_83302 = ((volatile __global int64_t *) incprefixes_mem_83198)[sext_i32_i64(read_i_83300)];\n                            } else if (flag_83303 == (int8_t) 1) {\n                                aggr_83301 = ((volatile __global int64_t *) aggregates_mem_83192)[sext_i32_i64(read_i_83300)];\n                                aggr_83302 = ((volatile __global int64_t *) aggregates_mem_83196)[sext_i32_i64(read_i_83300)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83232)[(int64_t) 4 + sext_i32_i64(local_tid_83223)] = aggr_83301;\n                        ((__local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = aggr_83302;\n                        ((__local int8_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = flag_83303;\n                        flag_83303 = ((__local int8_t *) local_mem_83232)[sext_i32_i64(wave_sizze_83225)", " - (int64_t) 1];\n                        if (slt8(flag_83303, (int8_t) 2)) {\n                            int8_t flg_x_83310;\n                            int8_t flg_y_83311;\n                            int64_t x_83304;\n                            int64_t x_83305;\n                            int64_t y_83306;\n                            int64_t y_83307;\n                            int32_t skip_threads_83312;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83311 = ((volatile __local int8_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)];\n                                y_83306 = ((volatile __local int64_t *) local_mem_83232)[(int64_t) 4 + sext_i32_i64(local_tid_83223)];\n                                y_83307 = ((volatile __local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8) + sext_i32_i64(local_tid_83223)];\n                                if ((local_tid_83223 - squot32(local_tid_83223, 32) * 32) == 0) {\n                                    x_83304 = y_83306;\n                                    x_83305 = y_83307;\n                                    flg_x_83310 = flg_y_83311;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83312 = 1;\n                                while (slt32(skip_threads_83312, 32)) {\n                                    if (sle32(skip_threads_83312, local_tid_83223 - squot32(local_tid_83223, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83310 = ((volatile __local int8_t *) local_mem_83232)[sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83312)];\n                                            x_83304 = ((volatile __local int64_t *) ",
                                    "local_mem_83232)[(int64_t) 4 + (sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83312))];\n                                            x_83305 = ((volatile __local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8) + (sext_i32_i64(local_tid_83223) - sext_i32_i64(skip_threads_83312))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83311 == (int8_t) 2 || flg_y_83311 == (int8_t) 0) {\n                                                flg_x_83310 = flg_y_83311;\n                                                x_83304 = y_83306;\n                                                x_83305 = y_83307;\n                                            } else {\n                                                int64_t zz_83308 = x_83304 + y_83306;\n                                                int64_t zz_83309 = x_83305 + y_83307;\n                                                \n                                                x_83304 = zz_83308;\n                                                x_83305 = zz_83309;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83232)[sext_i32_i64(local_tid_83223)] = flg_x_83310;\n                                            flg_y_83311 = flg_x_83310;\n                                            ((volatile __local int64_t *) local_mem_83232)[(int64_t) 4 + sext_i32_i64(local_tid_83223)] = x_83304;\n                                            y_83306 = x_83304;\n                                            ((volatile __local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8) + sext_i32_i64(local_tid_83223)] = x_83305;\n                              ", "              y_83307 = x_83305;\n                                        }\n                                    }\n                                    skip_threads_83312 *= 2;\n                                }\n                            }\n                        }\n                        flag_83303 = ((__local int8_t *) local_mem_83232)[sext_i32_i64(wave_sizze_83225) - (int64_t) 1];\n                        aggr_83301 = ((__local int64_t *) local_mem_83232)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83225) - (int64_t) 1)];\n                        aggr_83302 = ((__local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8) + (sext_i32_i64(wave_sizze_83225) - (int64_t) 1)];\n                        if (flag_83303 == (int8_t) 2) {\n                            readOffset_83299 = wave_sizze_83225 * -1;\n                        } else if (flag_83303 == (int8_t) 1) {\n                            readOffset_83299 -= wave_sizze_83225;\n                        }\n                        if (slt8((int8_t) 0, flag_83303)) {\n                            int64_t x_83313 = aggr_83301;\n                            int64_t x_83314 = aggr_83302;\n                            int64_t y_83315 = prefix_83294;\n                            int64_t y_83316 = prefix_83295;\n                            int64_t zz_83317 = x_83313 + y_83315;\n                            int64_t zz_83318 = x_83314 + y_83316;\n                            \n                            prefix_83294 = zz_83317;\n                            prefix_83295 = zz_83318;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83223 == 0) {\n                    if (boundary_83248 == sext_i64_i32(segscan_tblock_sizze_70731 * chunk_sizze_83167)) {\n                        int64_t x_83319 = prefix_83294;\n                        int64_t x_83320 = prefix_83295;\n                        int64_t y_83321 = acc_83280;\n                        int64_t y_8332", "2 = acc_83281;\n                        int64_t zz_83323 = x_83319 + y_83321;\n                        int64_t zz_83324 = x_83320 + y_83322;\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83194)[dynamic_id_83245] = zz_83323;\n                        ((volatile __global int64_t *) incprefixes_mem_83198)[dynamic_id_83245] = zz_83324;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83170)[dynamic_id_83245] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83232)[(int64_t) 4] = prefix_83294;\n                    ((__local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8)] = prefix_83295;\n                    acc_83280 = (int64_t) 0;\n                    acc_83281 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83245 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83294 = ((__local int64_t *) local_mem_83232)[(int64_t) 4];\n                prefix_83295 = ((__local int64_t *) local_mem_83232)[squot64(warp_byte_offset_83230, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t x_83325;\n            int64_t y_83327;\n            int64_t x_83331 = prefix_83294;\n            int64_t y_83333 = acc_83280;\n            int64_t x_83326;\n            int64_t y_83328;\n            int64_t x_83332 = prefix_83295;\n            int64_t y_83334 = acc_83281;\n            \n            if (slt32(local_tid_83223 * chunk_sizze_32b_83227, boundary_83248) && !block_new_sgm_83296) {\n                int64_t zz_83335 = x_83331 + y_83333;\n                int64_t zz_83336 = x_83332 + y_83334;\n                \n                x_83325 = zz_83335;\n                x_83326 = zz_83336;\n            } else {\n                x_83325 = acc_83280;\n                x_83326 = acc_83281;\n         ",
                                    "   }\n            \n            int32_t stopping_point_83337 = segsizze_compact_83249 - srem32(local_tid_83223 * chunk_sizze_32b_83227 - 1 + segsizze_compact_83249 - boundary_83248, segsizze_compact_83249);\n            \n            for (int64_t i_83338 = 0; i_83338 < chunk_sizze_83167; i_83338++) {\n                if (slt32(sext_i64_i32(i_83338), stopping_point_83337 - 1)) {\n                    y_83327 = private_mem_83250[i_83338];\n                    y_83328 = private_mem_83252[i_83338];\n                    \n                    int64_t zz_83329 = x_83325 + y_83327;\n                    int64_t zz_83330 = x_83326 + y_83328;\n                    \n                    private_mem_83250[i_83338] = zz_83329;\n                    private_mem_83252[i_83338] = zz_83330;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83339 = 0; i_83339 < chunk_sizze_83167; i_83339++) {\n                int64_t sharedIdx_83340 = sext_i32_i64(local_tid_83223) * chunk_sizze_83167 + i_83339;\n                int64_t tmp_83341 = private_mem_83250[i_83339];\n                \n                ((__local int64_t *) local_mem_83232)[sharedIdx_83340] = tmp_83341;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83342 = 0; i_83342 < chunk_sizze_83167; i_83342++) {\n                int64_t flat_idx_83343 = thd_offset_83254 + i_83342 * segscan_tblock_sizze_70731;\n                int64_t slice_83344 = n_old_36753;\n                int64_t gtid_70735 = flat_idx_83343;\n                int64_t remnant_83345 = flat_idx_83343 - gtid_70735;\n                \n                if (slt64(flat_idx_83343, n_old_36753)) {\n                    int64_t tmp_83346 = ((__local int64_t *) local_mem_83232)[flat_idx_83343 - block_offset_83246];\n                    \n                    ((__global int64_t *) mem_81961)[gtid_70735] = tmp_83346;\n                }\n            }\n            barrier", "(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83347 = 0; i_83347 < chunk_sizze_83167; i_83347++) {\n                int64_t sharedIdx_83348 = sext_i32_i64(local_tid_83223) * chunk_sizze_83167 + i_83347;\n                int64_t tmp_83349 = private_mem_83252[i_83347];\n                \n                ((__local int64_t *) local_mem_83232)[sharedIdx_83348] = tmp_83349;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83350 = 0; i_83350 < chunk_sizze_83167; i_83350++) {\n                int64_t flat_idx_83351 = thd_offset_83254 + i_83350 * segscan_tblock_sizze_70731;\n                int64_t slice_83352 = n_old_36753;\n                int64_t gtid_70735 = flat_idx_83351;\n                int64_t remnant_83353 = flat_idx_83351 - gtid_70735;\n                \n                if (slt64(flat_idx_83351, n_old_36753)) {\n                    int64_t tmp_83354 = ((__local int64_t *) local_mem_83232)[flat_idx_83351 - block_offset_83246];\n                    \n                    ((__global int64_t *) mem_81963)[gtid_70735] = tmp_83354;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_70731\n    #undef chunk_sizze_83167\n}\nFUTHARK_KERNEL_SIZED(add_next_partition_doublezisegscan_70752_dim1, 1, 1)\nvoid add_next_partition_doublezisegscan_70752(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2082U_36758, int64_t dz2083U_36759, int8_t clBase_36765, int8_t clBase_36766, double clBase_36773, double zt_res_59476, int64_t dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, unsigned char cond_60493_bits, int64_t num_tblocks_70749, int64_t num_virt_blocks_83896, int64_t num_virt_threads_83897, __global unsigned char *clProc_mem_81935, __global unsigned char *clProc_mem_81936, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_81967, __global unsigned char *mem_81969, __global unsig", "ned char *ext_mem_81976, __global unsigned char *ext_mem_81979, __global unsigned char *ext_mem_81982, __global unsigned char *ext_mem_81985, __global unsigned char *ext_mem_81988, __global unsigned char *ext_mem_81991, __global unsigned char *mem_82000, __global unsigned char *mem_82115, __global unsigned char *mem_82117, __global unsigned char *mem_82119, __global unsigned char *status_flags_mem_83898, __global unsigned char *aggregates_mem_83900, __global unsigned char *incprefixes_mem_83902, __global unsigned char *aggregates_mem_83904, __global unsigned char *incprefixes_mem_83906, __global unsigned char *global_dynid_mem_83908)\n{\n    bool cond_60493 = cond_60493_bits;\n    \n    #define segscan_tblock_sizze_70747 (add_next_partition_doublezisegscan_70752zisegscan_tblock_sizze_70747)\n    #define chunk_sizze_83895 (add_next_partition_doublezisegscan_70752zichunk_sizze_83895)\n    \n    volatile __local unsigned char *local_mem_83920_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83920_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70747, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70747), smax64(chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8, chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70747, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70747), smax64(chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8, chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83911;\n    int32_t tblock_sizze_83914;\n    int32_t wave_sizze_83913;\n    int32",
                                    "_t block_id_83912;\n    int32_t global_tid_83910;\n    int64_t phys_tid_70752;\n    int32_t chunk_sizze_32b_83915;\n    int64_t byte_offsets_83916;\n    int64_t byte_offsets_83917;\n    int64_t warp_byte_offset_83918;\n    int64_t warp_byte_offset_83919;\n    __local unsigned char *local_mem_83920;\n    int64_t trans_arr_len_83921;\n    int64_t phys_block_id_83930;\n    int64_t virtloop_bound_83931;\n    \n    local_tid_83911 = get_local_id(0);\n    tblock_sizze_83914 = get_local_size(0);\n    wave_sizze_83913 = LOCKSTEP_WIDTH;\n    block_id_83912 = get_tblock_id(0);\n    global_tid_83910 = block_id_83912 * tblock_sizze_83914 + local_tid_83911;\n    phys_tid_70752 = sext_i32_i64(global_tid_83910);\n    chunk_sizze_32b_83915 = sext_i64_i32(chunk_sizze_83895);\n    byte_offsets_83916 = segscan_tblock_sizze_70747 * (int64_t) 8;\n    byte_offsets_83917 = sdiv_up64(byte_offsets_83916, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_70747 * (int64_t) 8;\n    warp_byte_offset_83918 = (int64_t) 288;\n    warp_byte_offset_83919 = sdiv_up64(warp_byte_offset_83918, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83920 = (__local unsigned char *) local_mem_83920_backing_0;\n    trans_arr_len_83921 = chunk_sizze_83895 * segscan_tblock_sizze_70747;\n    phys_block_id_83930 = get_tblock_id(0);\n    virtloop_bound_83931 = sdiv_up64(num_virt_blocks_83896 - phys_block_id_83930, num_tblocks_70749);\n    for (int64_t virtloop_i_83932 = 0; virtloop_i_83932 < virtloop_bound_83931; virtloop_i_83932++) {\n        int64_t dynamic_id_83933;\n        int64_t block_offset_83934;\n        int64_t sgm_idx_83935;\n        int32_t boundary_83936;\n        int32_t segsizze_compact_83937;\n        int64_t private_mem_83938[chunk_sizze_83895];\n        int64_t private_mem_83940[chunk_sizze_83895];\n        int64_t thd_offset_83942;\n        int64_t acc_83971;\n        int64_t acc_83972;\n        int64_t prefix_83985;\n        int64_t prefix_83986;\n        bool block_new_sgm_83987;", "\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83911 == 0) {\n                dynamic_id_83933 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83908)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83920)[(int64_t) 0] = dynamic_id_83933;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83933 == num_virt_blocks_83896 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83908)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83933 = ((__local int32_t *) local_mem_83920)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83934 = dynamic_id_83933 * chunk_sizze_83895 * segscan_tblock_sizze_70747;\n        sgm_idx_83935 = smod64(block_offset_83934, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);\n        boundary_83936 = sext_i64_i32(smin64(chunk_sizze_83895 * segscan_tblock_sizze_70747, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470 - sgm_idx_83935));\n        segsizze_compact_83937 = sext_i64_i32(smin64(chunk_sizze_83895 * segscan_tblock_sizze_70747, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470));\n        thd_offset_83942 = block_offset_83934 + sext_i32_i64(local_tid_83911);\n        // Load and map\n        {\n            for (int64_t i_83943 = 0; i_83943 < chunk_sizze_83895; i_83943++) {\n                int64_t virt_tid_83944 = thd_offset_83942 + i_83943 * segscan_tblock_sizze_70747;\n                int64_t slice_83945 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n                int64_t gtid_70751 = virt_tid_83944;\n                int64_t remnant_83946 = virt_tid_83944 - gtid_70751;\n                \n   ", "             if (slt64(virt_tid_83944, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {\n                    int64_t zv_rhs_81798 = ((__global int64_t *) mem_82000)[(int64_t) 0];\n                    double times_arg1_81799 = ((__global double *) ext_mem_81976)[(int64_t) 0];\n                    double plus_arg0_81800 = ((__global double *) ext_mem_81979)[(int64_t) 0];\n                    double times_arg1_81801 = ((__global double *) ext_mem_81982)[(int64_t) 0];\n                    double plus_arg0_81802 = ((__global double *) ext_mem_81985)[(int64_t) 0];\n                    double plus_arg1_81803 = ((__global double *) ext_mem_81988)[(int64_t) 0];\n                    double plus_arg1_81804 = ((__global double *) ext_mem_81991)[(int64_t) 0];\n                    bool index_concat_cmp_63772 = sle64(dz2082U_36758, gtid_70751);\n                    double index_concat_branch_63773;\n                    \n                    if (index_concat_cmp_63772) {\n                        int64_t index_concat_i_66671 = sub64(gtid_70751, dz2082U_36758);\n                        double index_concat_66672 = ((__global double *) mem_81967)[index_concat_i_66671];\n                        \n                        index_concat_branch_63773 = index_concat_66672;\n                    } else {\n                        double index_concat_63776 = ((__global double *) clProc_mem_81935)[gtid_70751];\n                        \n                        index_concat_branch_63773 = index_concat_63776;\n                    }\n                    \n                    double index_concat_branch_63777;\n                    \n                    if (index_concat_cmp_63772) {\n                        int64_t index_concat_i_66673 = sub64(gtid_70751, dz2082U_36758);\n                        double index_concat_66674 = ((__global double *) mem_81969)[index_concat_i_66673];\n                        \n                        index_concat_branch_63777 = index_concat_66674;\n                    } else {\n             ",
                                    "           double index_concat_63780 = ((__global double *) clProc_mem_81936)[gtid_70751];\n                        \n                        index_concat_branch_63777 = index_concat_63780;\n                    }\n                    \n                    double zt_res_63781 = 3.141592653589793 * index_concat_branch_63773;\n                    double zt_res_63782 = 3.141592653589793 * index_concat_branch_63777;\n                    double zs_res_63783 = zt_res_63781 / 180.0;\n                    double zs_res_63784 = zt_res_63782 / 180.0;\n                    double d_haversine_res_63785;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_63785 = index_concat_branch_63773;\n                    } else {\n                        d_haversine_res_63785 = zs_res_63783;\n                    }\n                    \n                    double d_haversine_res_63786;\n                    \n                    if (clBase_36765 == (int8_t) 1) {\n                        d_haversine_res_63786 = index_concat_branch_63777;\n                    } else {\n                        d_haversine_res_63786 = zs_res_63784;\n                    }\n                    \n                    double cos_res_63787 = futrts_cos64(d_haversine_res_63785);\n                    double zm_res_63788 = d_haversine_res_63786 - d_haversine_res_63786;\n                    double zm_res_63789 = d_haversine_res_63785 - d_haversine_res_63785;\n                    double zm_res_63790 = 1.0 - zm_res_63788;\n                    double cos_res_63791 = futrts_cos64(zm_res_63789);\n                    double zt_res_63792 = cos_res_63787 * cos_res_63787;\n                    double zm_res_63793 = 1.0 - cos_res_63791;\n                    bool isNearAnyRelevant_63794;\n                    int64_t isNearAnyRelevant_63795;\n                    bool isNearAnyRelevant_63796;\n                    bool loop_while_63797;\n                    int64_t curPart_i_63798;\n                    bool is", "Near_63799;\n                    \n                    loop_while_63797 = cond_60493;\n                    curPart_i_63798 = (int64_t) 0;\n                    isNear_63799 = 0;\n                    while (loop_while_63797) {\n                        bool x_63800 = sle64((int64_t) 0, curPart_i_63798);\n                        bool y_63801 = slt64(curPart_i_63798, dz2083U_36759);\n                        bool bounds_check_63802 = x_63800 && y_63801;\n                        bool index_certs_63803;\n                        \n                        if (!bounds_check_63802) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                                    global_failure_args[0] = (int64_t) curPart_i_63798;\n                                    global_failure_args[1] = (int64_t) dz2083U_36759;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t curPart_63804 = ((__global int64_t *) clProc_mem_81938)[curPart_i_63798];\n                        int64_t cur_xid_63805 = smod64(curPart_63804, zv_rhs_81798);\n                        int64_t cur_yid_63806 = sdiv64(curPart_63804, zv_rhs_81798);\n                        double i64_res_63807 = sitofp_i64_f64(cur_xid_63805);\n                        double zt_res_63808 = i64_res_63807 * times_arg1_81799;\n                        double zp_res_63809 = zt_res_63808 + plus_arg0_81800;\n                        double i64_res_63810 = sitofp_i64_f64(cur_yid_63806);\n                        double zt_res_63811 = i64_res_63810 * times_arg1_81801;\n                        double zp_res_63812 = zt_res_63811 + plus_arg0_81802;\n                        double zp_res_63813 = zp_res_63809 + plus_arg1_81803;\n                        double zp_res_63814 = zp_res_63812", " + plus_arg1_81804;\n                        bool zgze_res_63815 = zp_res_63812 <= index_concat_branch_63777;\n                        bool zlze_res_63816 = index_concat_branch_63777 <= zp_res_63814;\n                        bool x_63817 = zgze_res_63815 && zlze_res_63816;\n                        double dist_res_63818;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            bool zeze_res_66677 = index_concat_branch_63773 == zp_res_63809;\n                            double d_euclidean_res_66678;\n                            \n                            if (zeze_res_66677) {\n                                double zm_res_66679 = index_concat_branch_63777 - index_concat_branch_63777;\n                                double abs_res_66680 = fabs64(zm_res_66679);\n                                \n                                d_euclidean_res_66678 = abs_res_66680;\n                            } else {\n                                double zm_res_66681 = index_concat_branch_63773 - zp_res_63809;\n                                double abs_res_66682 = fabs64(zm_res_66681);\n                                \n                                d_euclidean_res_66678 = abs_res_66682;\n                            }\n                            dist_res_63818 = d_euclidean_res_66678;\n                        } else {\n                            double d_haversine_res_63825;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_63825 = zp_res_63809;\n                            } else {\n                                double zt_res_63826 = 3.141592653589793 * zp_res_63809;\n                                double zs_res_63827 = zt_res_63826 / 180.0;\n                                \n                                d_haversine_res_63825 = zs_res_63827;\n                            }\n                            \n                            double zm_res_63828 = d_",
                                    "haversine_res_63785 - d_haversine_res_63825;\n                            double cos_res_63829 = futrts_cos64(zm_res_63828);\n                            double zm_res_63830 = 1.0 - cos_res_63829;\n                            double cos_res_63831 = futrts_cos64(d_haversine_res_63825);\n                            double zt_res_63832 = cos_res_63787 * cos_res_63831;\n                            double zt_res_63833 = zm_res_63790 * zt_res_63832;\n                            double zp_res_63834 = zm_res_63830 + zt_res_63833;\n                            double zs_res_63835 = zp_res_63834 / 2.0;\n                            double min_res_63836 = fmin64(1.0, zs_res_63835);\n                            double zt_res_63837 = 2.0 * min_res_63836;\n                            double zm_res_63838 = 1.0 - zt_res_63837;\n                            double acos_res_63839 = futrts_acos64(zm_res_63838);\n                            double zt_res_63840 = clBase_36773 * acos_res_63839;\n                            \n                            dist_res_63818 = zt_res_63840;\n                        }\n                        \n                        bool zlze_res_63841 = dist_res_63818 <= zt_res_59476;\n                        double dist_res_63842;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            bool zeze_res_66685 = index_concat_branch_63773 == zp_res_63813;\n                            double d_euclidean_res_66686;\n                            \n                            if (zeze_res_66685) {\n                                double zm_res_66687 = index_concat_branch_63777 - index_concat_branch_63777;\n                                double abs_res_66688 = fabs64(zm_res_66687);\n                                \n                                d_euclidean_res_66686 = abs_res_66688;\n                            } else {\n                                double zm_res_66689 = index_concat_branch_63773 - zp_res_63813;\n                           ", "     double abs_res_66690 = fabs64(zm_res_66689);\n                                \n                                d_euclidean_res_66686 = abs_res_66690;\n                            }\n                            dist_res_63842 = d_euclidean_res_66686;\n                        } else {\n                            double d_haversine_res_63849;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_63849 = zp_res_63813;\n                            } else {\n                                double zt_res_63850 = 3.141592653589793 * zp_res_63813;\n                                double zs_res_63851 = zt_res_63850 / 180.0;\n                                \n                                d_haversine_res_63849 = zs_res_63851;\n                            }\n                            \n                            double zm_res_63852 = d_haversine_res_63785 - d_haversine_res_63849;\n                            double cos_res_63853 = futrts_cos64(zm_res_63852);\n                            double zm_res_63854 = 1.0 - cos_res_63853;\n                            double cos_res_63855 = futrts_cos64(d_haversine_res_63849);\n                            double zt_res_63856 = cos_res_63787 * cos_res_63855;\n                            double zt_res_63857 = zm_res_63790 * zt_res_63856;\n                            double zp_res_63858 = zm_res_63854 + zt_res_63857;\n                            double zs_res_63859 = zp_res_63858 / 2.0;\n                            double min_res_63860 = fmin64(1.0, zs_res_63859);\n                            double zt_res_63861 = 2.0 * min_res_63860;\n                            double zm_res_63862 = 1.0 - zt_res_63861;\n                            double acos_res_63863 = futrts_acos64(zm_res_63862);\n                            double zt_res_63864 = clBase_36773 * acos_res_63863;\n                            \n                            dist_res_63842 = zt_res_63864;\n                    ", "    }\n                        \n                        bool zlze_res_63865 = dist_res_63842 <= zt_res_59476;\n                        bool x_63866 = !zlze_res_63841;\n                        bool y_63867 = zlze_res_63865 && x_63866;\n                        bool cond_t_res_63868 = zlze_res_63841 || y_63867;\n                        bool x_63869 = x_63817 && cond_t_res_63868;\n                        bool zgze_res_63870 = zp_res_63809 <= index_concat_branch_63773;\n                        bool zlze_res_63871 = index_concat_branch_63773 <= zp_res_63813;\n                        bool x_63872 = zgze_res_63870 && zlze_res_63871;\n                        double dist_res_63873;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            double zm_res_66691 = index_concat_branch_63777 - zp_res_63812;\n                            double abs_res_66692 = fabs64(zm_res_66691);\n                            \n                            dist_res_63873 = abs_res_66692;\n                        } else {\n                            double d_haversine_res_63876;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_63876 = zp_res_63812;\n                            } else {\n                                double zt_res_63877 = 3.141592653589793 * zp_res_63812;\n                                double zs_res_63878 = zt_res_63877 / 180.0;\n                                \n                                d_haversine_res_63876 = zs_res_63878;\n                            }\n                            \n                            double zm_res_63879 = d_haversine_res_63786 - d_haversine_res_63876;\n                            double zm_res_63880 = 1.0 - zm_res_63879;\n                            double zt_res_63881 = zt_res_63792 * zm_res_63880;\n                            double zp_res_63882 = zm_res_63793 + zt_res_63881;\n                            double zs_res_63883 = z",
                                    "p_res_63882 / 2.0;\n                            double min_res_63884 = fmin64(1.0, zs_res_63883);\n                            double zt_res_63885 = 2.0 * min_res_63884;\n                            double zm_res_63886 = 1.0 - zt_res_63885;\n                            double acos_res_63887 = futrts_acos64(zm_res_63886);\n                            double zt_res_63888 = clBase_36773 * acos_res_63887;\n                            \n                            dist_res_63873 = zt_res_63888;\n                        }\n                        \n                        bool zlze_res_63889 = dist_res_63873 <= zt_res_59476;\n                        double dist_res_63890;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n                            double zm_res_66693 = index_concat_branch_63777 - zp_res_63814;\n                            double abs_res_66694 = fabs64(zm_res_66693);\n                            \n                            dist_res_63890 = abs_res_66694;\n                        } else {\n                            double d_haversine_res_63893;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_63893 = zp_res_63814;\n                            } else {\n                                double zt_res_63894 = 3.141592653589793 * zp_res_63814;\n                                double zs_res_63895 = zt_res_63894 / 180.0;\n                                \n                                d_haversine_res_63893 = zs_res_63895;\n                            }\n                            \n                            double zm_res_63896 = d_haversine_res_63786 - d_haversine_res_63893;\n                            double zm_res_63897 = 1.0 - zm_res_63896;\n                            double zt_res_63898 = zt_res_63792 * zm_res_63897;\n                            double zp_res_63899 = zm_res_63793 + zt_res_63898;\n                            double zs_res_63900 = zp_res_63", "899 / 2.0;\n                            double min_res_63901 = fmin64(1.0, zs_res_63900);\n                            double zt_res_63902 = 2.0 * min_res_63901;\n                            double zm_res_63903 = 1.0 - zt_res_63902;\n                            double acos_res_63904 = futrts_acos64(zm_res_63903);\n                            double zt_res_63905 = clBase_36773 * acos_res_63904;\n                            \n                            dist_res_63890 = zt_res_63905;\n                        }\n                        \n                        bool zlze_res_63906 = dist_res_63890 <= zt_res_59476;\n                        bool x_63907 = !zlze_res_63889;\n                        bool y_63908 = zlze_res_63906 && x_63907;\n                        bool cond_f_res_t_res_63909 = zlze_res_63889 || y_63908;\n                        bool x_63910 = x_63872 && cond_f_res_t_res_63909;\n                        bool x_63911 = !x_63869;\n                        bool y_63912 = x_63910 && x_63911;\n                        bool cond_63913 = x_63869 || y_63912;\n                        bool zlze_res_63914 = index_concat_branch_63773 <= zp_res_63809;\n                        double corn_x_63915;\n                        \n                        if (zlze_res_63914) {\n                            corn_x_63915 = zp_res_63809;\n                        } else {\n                            corn_x_63915 = zp_res_63813;\n                        }\n                        \n                        bool zlze_res_63916 = index_concat_branch_63777 <= zp_res_63812;\n                        double corn_y_63917;\n                        \n                        if (zlze_res_63916) {\n                            corn_y_63917 = zp_res_63812;\n                        } else {\n                            corn_y_63917 = zp_res_63814;\n                        }\n                        \n                        double dist_res_63918;\n                        \n                        if (clBase_36766 == (int8_t) 0) {\n        ", "                    bool eq_x_y_66699 = index_concat_branch_63773 == zp_res_63809;\n                            bool eq_x_zz_66700 = index_concat_branch_63773 == zp_res_63813;\n                            bool p_and_eq_x_y_66701 = zlze_res_63914 && eq_x_y_66699;\n                            bool not_p_66702 = !zlze_res_63914;\n                            bool p_and_eq_x_y_66703 = eq_x_zz_66700 && not_p_66702;\n                            bool zeze_res_66704 = p_and_eq_x_y_66701 || p_and_eq_x_y_66703;\n                            double d_euclidean_res_66705;\n                            \n                            if (zeze_res_66704) {\n                                double zm_res_66706 = index_concat_branch_63777 - corn_y_63917;\n                                double abs_res_66707 = fabs64(zm_res_66706);\n                                \n                                d_euclidean_res_66705 = abs_res_66707;\n                            } else {\n                                bool eq_x_y_66708 = index_concat_branch_63777 == zp_res_63812;\n                                bool eq_x_zz_66709 = index_concat_branch_63777 == zp_res_63814;\n                                bool p_and_eq_x_y_66710 = zlze_res_63916 && eq_x_y_66708;\n                                bool not_p_66711 = !zlze_res_63916;\n                                bool p_and_eq_x_y_66712 = eq_x_zz_66709 && not_p_66711;\n                                bool zeze_res_66713 = p_and_eq_x_y_66710 || p_and_eq_x_y_66712;\n                                double d_euclidean_res_f_res_66714;\n                                \n                                if (zeze_res_66713) {\n                                    double zm_res_66715 = index_concat_branch_63773 - corn_x_63915;\n                                    double abs_res_66716 = fabs64(zm_res_66715);\n                                    \n                                    d_euclidean_res_f_res_66714 = abs_res_66716;\n                                } else {\n                    ",
                                    "                double zm_res_66717 = index_concat_branch_63777 - corn_y_63917;\n                                    double zm_res_66718 = index_concat_branch_63773 - corn_x_63915;\n                                    double hypot_res_66719 = futrts_hypot64(zm_res_66718, zm_res_66717);\n                                    \n                                    d_euclidean_res_f_res_66714 = hypot_res_66719;\n                                }\n                                d_euclidean_res_66705 = d_euclidean_res_f_res_66714;\n                            }\n                            dist_res_63918 = d_euclidean_res_66705;\n                        } else {\n                            double d_haversine_res_63940;\n                            double d_haversine_res_63941;\n                            \n                            if (clBase_36765 == (int8_t) 1) {\n                                d_haversine_res_63940 = corn_x_63915;\n                                d_haversine_res_63941 = corn_y_63917;\n                            } else {\n                                double zt_res_63942 = 3.141592653589793 * corn_x_63915;\n                                double zs_res_63943 = zt_res_63942 / 180.0;\n                                double zt_res_63944 = 3.141592653589793 * corn_y_63917;\n                                double zs_res_63945 = zt_res_63944 / 180.0;\n                                \n                                d_haversine_res_63940 = zs_res_63943;\n                                d_haversine_res_63941 = zs_res_63945;\n                            }\n                            \n                            double zm_res_63946 = d_haversine_res_63785 - d_haversine_res_63940;\n                            double cos_res_63947 = futrts_cos64(zm_res_63946);\n                            double zm_res_63948 = 1.0 - cos_res_63947;\n                            double cos_res_63949 = futrts_cos64(d_haversine_res_63940);\n                            double zt_res_63950 = cos_res_63787 * ", "cos_res_63949;\n                            double zm_res_63951 = d_haversine_res_63786 - d_haversine_res_63941;\n                            double zm_res_63952 = 1.0 - zm_res_63951;\n                            double zt_res_63953 = zt_res_63950 * zm_res_63952;\n                            double zp_res_63954 = zm_res_63948 + zt_res_63953;\n                            double zs_res_63955 = zp_res_63954 / 2.0;\n                            double min_res_63956 = fmin64(1.0, zs_res_63955);\n                            double zt_res_63957 = 2.0 * min_res_63956;\n                            double zm_res_63958 = 1.0 - zt_res_63957;\n                            double acos_res_63959 = futrts_acos64(zm_res_63958);\n                            double zt_res_63960 = clBase_36773 * acos_res_63959;\n                            \n                            dist_res_63918 = zt_res_63960;\n                        }\n                        \n                        bool zlze_res_63961 = dist_res_63918 <= zt_res_59476;\n                        bool x_63962 = !cond_63913;\n                        bool y_63963 = zlze_res_63961 && x_63962;\n                        bool is_pt_marginal_res_63964 = cond_63913 || y_63963;\n                        int64_t tmp_63965 = add64((int64_t) 1, curPart_i_63798);\n                        bool cond_63966 = slt64(tmp_63965, dz2083U_36759);\n                        bool loop_cond_t_res_63967 = !is_pt_marginal_res_63964;\n                        bool x_63968 = cond_63966 && loop_cond_t_res_63967;\n                        bool loop_while_tmp_83947 = x_63968;\n                        int64_t curPart_i_tmp_83948 = tmp_63965;\n                        bool isNear_tmp_83949 = is_pt_marginal_res_63964;\n                        \n                        loop_while_63797 = loop_while_tmp_83947;\n                        curPart_i_63798 = curPart_i_tmp_83948;\n                        isNear_63799 = isNear_tmp_83949;\n                    }\n                    isNearAnyRelevant_63794 = loop_", "while_63797;\n                    isNearAnyRelevant_63795 = curPart_i_63798;\n                    isNearAnyRelevant_63796 = isNear_63799;\n                    \n                    bool cond_neg_63970 = !isNearAnyRelevant_63796;\n                    int64_t defunc_0_lifted_pzq_res_63971 = btoi_bool_i64(cond_neg_63970);\n                    bool is_i_63972 = defunc_0_lifted_pzq_res_63971 == (int64_t) 0;\n                    int64_t part_res_63973 = btoi_bool_i64(is_i_63972);\n                    int64_t part_res_63974;\n                    int64_t part_res_63975;\n                    \n                    if (is_i_63972) {\n                        part_res_63974 = (int64_t) 0;\n                        part_res_63975 = (int64_t) 0;\n                    } else {\n                        bool is_i_63976 = defunc_0_lifted_pzq_res_63971 == (int64_t) 1;\n                        int64_t part_res_63977;\n                        \n                        if (is_i_63976) {\n                            part_res_63977 = (int64_t) 1;\n                        } else {\n                            part_res_63977 = (int64_t) 2;\n                        }\n                        \n                        int64_t part_res_63978 = btoi_bool_i64(is_i_63976);\n                        \n                        part_res_63974 = part_res_63977;\n                        part_res_63975 = part_res_63978;\n                    }\n                    ((__global int64_t *) mem_82119)[gtid_70751] = part_res_63974;\n                    private_mem_83938[i_83943] = part_res_63973;\n                    private_mem_83940[i_83943] = part_res_63975;\n                } else {\n                    private_mem_83938[i_83943] = (int64_t) 0;\n                    private_mem_83940[i_83943] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n          ",
                                    "  for (int64_t i_83950 = 0; i_83950 < chunk_sizze_83895; i_83950++) {\n                int64_t sharedIdx_83951 = sext_i32_i64(local_tid_83911) + i_83950 * segscan_tblock_sizze_70747;\n                int64_t tmp_83952 = private_mem_83938[i_83950];\n                \n                ((__local int64_t *) local_mem_83920)[sharedIdx_83951] = tmp_83952;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83953 = 0; i_83953 < chunk_sizze_83895; i_83953++) {\n                int64_t sharedIdx_83954 = sext_i32_i64(local_tid_83911) * chunk_sizze_83895 + i_83953;\n                int64_t tmp_83955 = ((__local int64_t *) local_mem_83920)[sharedIdx_83954];\n                \n                private_mem_83938[i_83953] = tmp_83955;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83956 = 0; i_83956 < chunk_sizze_83895; i_83956++) {\n                int64_t sharedIdx_83957 = sext_i32_i64(local_tid_83911) + i_83956 * segscan_tblock_sizze_70747;\n                int64_t tmp_83958 = private_mem_83940[i_83956];\n                \n                ((__local int64_t *) local_mem_83920)[sharedIdx_83957] = tmp_83958;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83959 = 0; i_83959 < chunk_sizze_83895; i_83959++) {\n                int64_t sharedIdx_83960 = sext_i32_i64(local_tid_83911) * chunk_sizze_83895 + i_83959;\n                int64_t tmp_83961 = ((__local int64_t *) local_mem_83920)[sharedIdx_83960];\n                \n                private_mem_83940[i_83959] = tmp_83961;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83962 = 0; i_83962 < chunk_sizze_83895 - (int64_t) 1; i_83962++) {\n                int64_t x_60736;\n                int64_t y_60738;\n                \n                x_60736 = private_mem_83938[i_83962];\n                y_60738 = private_mem_83938[i_83962 + (int64_t) 1];\n                \n             ", "   int64_t x_60737;\n                int64_t y_60739;\n                \n                x_60737 = private_mem_83940[i_83962];\n                y_60739 = private_mem_83940[i_83962 + (int64_t) 1];\n                \n                int64_t zz_60740 = x_60736 + y_60738;\n                int64_t zz_60741 = x_60737 + y_60739;\n                \n                private_mem_83938[i_83962 + (int64_t) 1] = zz_60740;\n                private_mem_83940[i_83962 + (int64_t) 1] = zz_60741;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83963 = private_mem_83938[chunk_sizze_83895 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = tmp_83963;\n            \n            int64_t tmp_83964 = private_mem_83940[chunk_sizze_83895 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = tmp_83964;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t x_83965;\n            int64_t x_83966;\n            int64_t y_83967;\n            int64_t y_83968;\n            int64_t x_83973;\n            int64_t x_83974;\n            int64_t y_83975;\n            int64_t y_83976;\n            bool ltid_in_bounds_83979 = slt64(sext_i32_i64(local_tid_83911), num_virt_threads_83897);\n            int32_t skip_threads_83980;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83979) {\n                    y_83967 = ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)];\n                    y_83968 = ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)];\n                    if ((local_tid_83911 - squot32(local_tid_83911, 32) * 32) == 0) {\n                        x_83965 = y_83967;\n                        x_8396", "6 = y_83968;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83980 = 1;\n                while (slt32(skip_threads_83980, 32)) {\n                    bool thread_active_83981 = sle32(skip_threads_83980, local_tid_83911 - squot32(local_tid_83911, 32) * 32) && ltid_in_bounds_83979;\n                    \n                    if (thread_active_83981) {\n                        // read operands\n                        {\n                            x_83965 = ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_83980)];\n                            x_83966 = ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + (sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_83980))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83981) {\n                            int64_t zz_83969 = x_83965 + y_83967;\n                            int64_t zz_83970 = x_83966 + y_83968;\n                            \n                            x_83965 = zz_83969;\n                            x_83966 = zz_83970;\n                        }\n                    }\n                    if (sle32(wave_sizze_83913, skip_threads_83980)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83981) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = x_83965;\n                            y_83967 = x_83965;\n                            ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = x_83966;\n                            y_83968 = x_83966;\n                        }\n    ",
                                    "                }\n                    if (sle32(wave_sizze_83913, skip_threads_83980)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83980 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83911 - squot32(local_tid_83911, 32) * 32) == 31 && ltid_in_bounds_83979) {\n                    ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(squot32(local_tid_83911, 32))] = x_83965;\n                    ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(squot32(local_tid_83911, 32))] = x_83966;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83982;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83911, 32) == 0 && ltid_in_bounds_83979) {\n                        y_83975 = ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)];\n                        y_83976 = ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)];\n                        if ((local_tid_83911 - squot32(local_tid_83911, 32) * 32) == 0) {\n                            x_83973 = y_83975;\n                            x_83974 = y_83976;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83982 = 1;\n                    while (slt32(skip_threads_83982, 32)) {\n                        bool thread_active_83983 = sle32(skip_threads_83982, local_tid_83911 - squot32(local_tid_83911, 32) * 32) && (squ", "ot32(local_tid_83911, 32) == 0 && ltid_in_bounds_83979);\n                        \n                        if (thread_active_83983) {\n                            // read operands\n                            {\n                                x_83973 = ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_83982)];\n                                x_83974 = ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + (sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_83982))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83983) {\n                                int64_t zz_83977 = x_83973 + y_83975;\n                                int64_t zz_83978 = x_83974 + y_83976;\n                                \n                                x_83973 = zz_83977;\n                                x_83974 = zz_83978;\n                            }\n                        }\n                        if (sle32(wave_sizze_83913, skip_threads_83982)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83983) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = x_83973;\n                                y_83975 = x_83973;\n                                ((volatile __local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = x_83974;\n                                y_83976 = x_83974;\n                            }\n                        }\n                        if (sle32(wave_sizze_83913, skip_threads_83982)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threa", "ds_83982 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83984 = squot32(local_tid_83911, 32) == 0 || !ltid_in_bounds_83979;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83984) {\n                        y_83967 = x_83965;\n                        y_83968 = x_83966;\n                        x_83965 = ((__local int64_t *) local_mem_83920)[sext_i32_i64(squot32(local_tid_83911, 32)) - (int64_t) 1];\n                        x_83966 = ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_83911, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83984) {\n                        int64_t zz_83969 = x_83965 + y_83967;\n                        int64_t zz_83970 = x_83966 + y_83968;\n                        \n                        x_83965 = zz_83969;\n                        x_83966 = zz_83970;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83984) {\n                        ((__local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = x_83965;\n                        ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = x_83966;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83911, 32) == 0 && ltid_in_bounds_83979) {\n                    ((__local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = y_83967;\n                    ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (in",
                                    "t64_t) 8) + sext_i32_i64(local_tid_83911)] = y_83968;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83911 == 0) {\n                acc_83971 = ((__local int64_t *) local_mem_83920)[segscan_tblock_sizze_70747 - (int64_t) 1];\n                acc_83972 = ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + (segscan_tblock_sizze_70747 - (int64_t) 1)];\n            } else {\n                acc_83971 = ((__local int64_t *) local_mem_83920)[sext_i32_i64(local_tid_83911) - (int64_t) 1];\n                acc_83972 = ((__local int64_t *) local_mem_83920)[squot64(byte_offsets_83916, (int64_t) 8) + (sext_i32_i64(local_tid_83911) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83985 = (int64_t) 0;\n        prefix_83986 = (int64_t) 0;\n        block_new_sgm_83987 = sgm_idx_83935 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83987 && local_tid_83911 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83902)[dynamic_id_83933] = acc_83971;\n                ((volatile __global int64_t *) incprefixes_mem_83906)[dynamic_id_83933] = acc_83972;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83898)[dynamic_id_83933] = (int8_t) 2;\n                acc_83971 = (int64_t) 0;\n                acc_83972 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83987 && slt32(local_tid_83911, wave_sizze_83913)) {\n                if (local_tid_83911 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83900)[dynamic_id_83933] = acc_83971;\n                    ((volatile __global int64_t *) aggregates_mem_83904)[dynamic_id_83933] = acc_83972;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83898)[dynamic_id_83933] = (int8_t) 1;\n                    ", "\n                    int8_t tmp_83988 = ((volatile __global int8_t *) status_flags_mem_83898)[dynamic_id_83933 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83920)[(int64_t) 0] = tmp_83988;\n                }\n                mem_fence_local();\n                \n                int8_t status_83989 = ((__local int8_t *) local_mem_83920)[(int64_t) 0];\n                \n                if (status_83989 == (int8_t) 2) {\n                    if (local_tid_83911 == 0) {\n                        prefix_83985 = ((volatile __global int64_t *) incprefixes_mem_83902)[dynamic_id_83933 - (int64_t) 1];\n                        prefix_83986 = ((volatile __global int64_t *) incprefixes_mem_83906)[dynamic_id_83933 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83990 = sext_i64_i32(dynamic_id_83933 - sext_i32_i64(wave_sizze_83913));\n                    \n                    while (slt32(wave_sizze_83913 * -1, readOffset_83990)) {\n                        int32_t read_i_83991 = readOffset_83990 + local_tid_83911;\n                        int64_t aggr_83992 = (int64_t) 0;\n                        int64_t aggr_83993 = (int64_t) 0;\n                        int8_t flag_83994 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83991)) {\n                            flag_83994 = ((volatile __global int8_t *) status_flags_mem_83898)[sext_i32_i64(read_i_83991)];\n                            if (flag_83994 == (int8_t) 2) {\n                                aggr_83992 = ((volatile __global int64_t *) incprefixes_mem_83902)[sext_i32_i64(read_i_83991)];\n                                aggr_83993 = ((volatile __global int64_t *) incprefixes_mem_83906)[sext_i32_i64(read_i_83991)];\n                            } else if (flag_83994 == (int8_t) 1) {\n                                aggr_83992 = ((volatile __global int64_t *) aggregates_mem_83900)[sext_i32_i64(read_i_83991)];\n         ", "                       aggr_83993 = ((volatile __global int64_t *) aggregates_mem_83904)[sext_i32_i64(read_i_83991)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83920)[(int64_t) 4 + sext_i32_i64(local_tid_83911)] = aggr_83992;\n                        ((__local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = aggr_83993;\n                        ((__local int8_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = flag_83994;\n                        flag_83994 = ((__local int8_t *) local_mem_83920)[sext_i32_i64(wave_sizze_83913) - (int64_t) 1];\n                        if (slt8(flag_83994, (int8_t) 2)) {\n                            int8_t flg_x_84001;\n                            int8_t flg_y_84002;\n                            int64_t x_83995;\n                            int64_t x_83996;\n                            int64_t y_83997;\n                            int64_t y_83998;\n                            int32_t skip_threads_84003;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84002 = ((volatile __local int8_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)];\n                                y_83997 = ((volatile __local int64_t *) local_mem_83920)[(int64_t) 4 + sext_i32_i64(local_tid_83911)];\n                                y_83998 = ((volatile __local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8) + sext_i32_i64(local_tid_83911)];\n                                if ((local_tid_83911 - squot32(local_tid_83911, 32) * 32) == 0) {\n                                    x_83995 = y_83997;\n                                    x_83996 = y_83998;\n                                    flg_x_84001 = flg_y_84002;\n                                }\n                            }\n                            // in-block scan (hopef",
                                    "ully no barriers needed)\n                            {\n                                skip_threads_84003 = 1;\n                                while (slt32(skip_threads_84003, 32)) {\n                                    if (sle32(skip_threads_84003, local_tid_83911 - squot32(local_tid_83911, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_84001 = ((volatile __local int8_t *) local_mem_83920)[sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_84003)];\n                                            x_83995 = ((volatile __local int64_t *) local_mem_83920)[(int64_t) 4 + (sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_84003))];\n                                            x_83996 = ((volatile __local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8) + (sext_i32_i64(local_tid_83911) - sext_i32_i64(skip_threads_84003))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84002 == (int8_t) 2 || flg_y_84002 == (int8_t) 0) {\n                                                flg_x_84001 = flg_y_84002;\n                                                x_83995 = y_83997;\n                                                x_83996 = y_83998;\n                                            } else {\n                                                int64_t zz_83999 = x_83995 + y_83997;\n                                                int64_t zz_84000 = x_83996 + y_83998;\n                                                \n                                                x_83995 = zz_83999;\n                                                x_83996 = zz_84000;\n                                            }\n                                        }\n                                        // write result\n          ", "                              {\n                                            ((volatile __local int8_t *) local_mem_83920)[sext_i32_i64(local_tid_83911)] = flg_x_84001;\n                                            flg_y_84002 = flg_x_84001;\n                                            ((volatile __local int64_t *) local_mem_83920)[(int64_t) 4 + sext_i32_i64(local_tid_83911)] = x_83995;\n                                            y_83997 = x_83995;\n                                            ((volatile __local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8) + sext_i32_i64(local_tid_83911)] = x_83996;\n                                            y_83998 = x_83996;\n                                        }\n                                    }\n                                    skip_threads_84003 *= 2;\n                                }\n                            }\n                        }\n                        flag_83994 = ((__local int8_t *) local_mem_83920)[sext_i32_i64(wave_sizze_83913) - (int64_t) 1];\n                        aggr_83992 = ((__local int64_t *) local_mem_83920)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83913) - (int64_t) 1)];\n                        aggr_83993 = ((__local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8) + (sext_i32_i64(wave_sizze_83913) - (int64_t) 1)];\n                        if (flag_83994 == (int8_t) 2) {\n                            readOffset_83990 = wave_sizze_83913 * -1;\n                        } else if (flag_83994 == (int8_t) 1) {\n                            readOffset_83990 -= wave_sizze_83913;\n                        }\n                        if (slt8((int8_t) 0, flag_83994)) {\n                            int64_t x_84004 = aggr_83992;\n                            int64_t x_84005 = aggr_83993;\n                            int64_t y_84006 = prefix_83985;\n                            int64_t y_84007 = prefix_83986;\n                            int64_t zz_84008 = x_84004 + y_84006;\n    ", "                        int64_t zz_84009 = x_84005 + y_84007;\n                            \n                            prefix_83985 = zz_84008;\n                            prefix_83986 = zz_84009;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83911 == 0) {\n                    if (boundary_83936 == sext_i64_i32(segscan_tblock_sizze_70747 * chunk_sizze_83895)) {\n                        int64_t x_84010 = prefix_83985;\n                        int64_t x_84011 = prefix_83986;\n                        int64_t y_84012 = acc_83971;\n                        int64_t y_84013 = acc_83972;\n                        int64_t zz_84014 = x_84010 + y_84012;\n                        int64_t zz_84015 = x_84011 + y_84013;\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83902)[dynamic_id_83933] = zz_84014;\n                        ((volatile __global int64_t *) incprefixes_mem_83906)[dynamic_id_83933] = zz_84015;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83898)[dynamic_id_83933] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83920)[(int64_t) 4] = prefix_83985;\n                    ((__local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8)] = prefix_83986;\n                    acc_83971 = (int64_t) 0;\n                    acc_83972 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83933 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83985 = ((__local int64_t *) local_mem_83920)[(int64_t) 4];\n                prefix_83986 = ((__local int64_t *) local_mem_83920)[squot64(warp_byte_offset_83918, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t x_84016;\n            int64_",
                                    "t y_84018;\n            int64_t x_84022 = prefix_83985;\n            int64_t y_84024 = acc_83971;\n            int64_t x_84017;\n            int64_t y_84019;\n            int64_t x_84023 = prefix_83986;\n            int64_t y_84025 = acc_83972;\n            \n            if (slt32(local_tid_83911 * chunk_sizze_32b_83915, boundary_83936) && !block_new_sgm_83987) {\n                int64_t zz_84026 = x_84022 + y_84024;\n                int64_t zz_84027 = x_84023 + y_84025;\n                \n                x_84016 = zz_84026;\n                x_84017 = zz_84027;\n            } else {\n                x_84016 = acc_83971;\n                x_84017 = acc_83972;\n            }\n            \n            int32_t stopping_point_84028 = segsizze_compact_83937 - srem32(local_tid_83911 * chunk_sizze_32b_83915 - 1 + segsizze_compact_83937 - boundary_83936, segsizze_compact_83937);\n            \n            for (int64_t i_84029 = 0; i_84029 < chunk_sizze_83895; i_84029++) {\n                if (slt32(sext_i64_i32(i_84029), stopping_point_84028 - 1)) {\n                    y_84018 = private_mem_83938[i_84029];\n                    y_84019 = private_mem_83940[i_84029];\n                    \n                    int64_t zz_84020 = x_84016 + y_84018;\n                    int64_t zz_84021 = x_84017 + y_84019;\n                    \n                    private_mem_83938[i_84029] = zz_84020;\n                    private_mem_83940[i_84029] = zz_84021;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84030 = 0; i_84030 < chunk_sizze_83895; i_84030++) {\n                int64_t sharedIdx_84031 = sext_i32_i64(local_tid_83911) * chunk_sizze_83895 + i_84030;\n                int64_t tmp_84032 = private_mem_83938[i_84030];\n                \n                ((__local int64_t *) local_mem_83920)[sharedIdx_84031] = tmp_84032;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84033 ", "= 0; i_84033 < chunk_sizze_83895; i_84033++) {\n                int64_t flat_idx_84034 = thd_offset_83942 + i_84033 * segscan_tblock_sizze_70747;\n                int64_t slice_84035 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n                int64_t gtid_70751 = flat_idx_84034;\n                int64_t remnant_84036 = flat_idx_84034 - gtid_70751;\n                \n                if (slt64(flat_idx_84034, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {\n                    int64_t tmp_84037 = ((__local int64_t *) local_mem_83920)[flat_idx_84034 - block_offset_83934];\n                    \n                    ((__global int64_t *) mem_82115)[gtid_70751] = tmp_84037;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84038 = 0; i_84038 < chunk_sizze_83895; i_84038++) {\n                int64_t sharedIdx_84039 = sext_i32_i64(local_tid_83911) * chunk_sizze_83895 + i_84038;\n                int64_t tmp_84040 = private_mem_83940[i_84038];\n                \n                ((__local int64_t *) local_mem_83920)[sharedIdx_84039] = tmp_84040;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84041 = 0; i_84041 < chunk_sizze_83895; i_84041++) {\n                int64_t flat_idx_84042 = thd_offset_83942 + i_84041 * segscan_tblock_sizze_70747;\n                int64_t slice_84043 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;\n                int64_t gtid_70751 = flat_idx_84042;\n                int64_t remnant_84044 = flat_idx_84042 - gtid_70751;\n                \n                if (slt64(flat_idx_84042, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {\n                    int64_t tmp_84045 = ((__local int64_t *) local_mem_83920)[flat_idx_84042 - block_offset_83934];\n                    \n                    ((__global int64_t *) mem_82117)[gtid_70751] = tmp_84045;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n       ", " }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_70747\n    #undef chunk_sizze_83895\n}\nFUTHARK_KERNEL\nvoid builtinzhiota_i64ziiota_i64_83304(int64_t n_83300, int64_t x_83301, int64_t s_83302, int64_t virt_num_tblocks_83309, int64_t num_tblocks_83310, __global unsigned char *mem_83299)\n{\n    int32_t iota_ltid_83305;\n    int32_t tblock_sizze_83307;\n    int32_t iota_gid_83306;\n    int32_t iota_gtid_83304;\n    int32_t phys_tblock_id_83311;\n    int32_t iterations_83312;\n    \n    iota_ltid_83305 = get_local_id(0);\n    tblock_sizze_83307 = get_local_size(0);\n    iota_gid_83306 = get_tblock_id(0);\n    iota_gtid_83304 = iota_gid_83306 * tblock_sizze_83307 + iota_ltid_83305;\n    phys_tblock_id_83311 = get_tblock_id(0);\n    iterations_83312 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83309) - phys_tblock_id_83311, sext_i64_i32(num_tblocks_83310));\n    for (int32_t i_83313 = 0; i_83313 < iterations_83312; i_83313++) {\n        int32_t virt_tblock_id_83314;\n        int64_t global_tid_83315;\n        \n        virt_tblock_id_83314 = phys_tblock_id_83311 + i_83313 * sext_i64_i32(num_tblocks_83310);\n        global_tid_83315 = sext_i32_i64(virt_tblock_id_83314) * sext_i32_i64(tblock_sizze_83307) + sext_i32_i64(iota_ltid_83305);\n        if (slt64(global_tid_83315, n_83300)) {\n            ((__global int64_t *) mem_83299)[global_tid_83315] = add64(mul64(global_tid_83315, s_83302), x_83301);\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_boolzireplicate_84474(int64_t num_elems_84470, unsigned char val_84471_bits, int64_t replicate_n_84473, int64_t virt_num_tblocks_84479, int64_t num_tblocks_84480, __global unsigned char *mem_84469)\n{\n    bool val_84471 = val_84471_bits;\n    int32_t replicate_ltid_84475;\n    int32_t tblock_sizze_84477;\n    int32_t replicate_gid_84476;\n    int32_t replicate_gtid_84474;\n    int32_t phys_tblock_id_84481;\n    int32_t iterations_84482;\n    \n    rep",
                                    "licate_ltid_84475 = get_local_id(0);\n    tblock_sizze_84477 = get_local_size(0);\n    replicate_gid_84476 = get_tblock_id(0);\n    replicate_gtid_84474 = replicate_gid_84476 * tblock_sizze_84477 + replicate_ltid_84475;\n    phys_tblock_id_84481 = get_tblock_id(0);\n    iterations_84482 = sdiv_up32(sext_i64_i32(virt_num_tblocks_84479) - phys_tblock_id_84481, sext_i64_i32(num_tblocks_84480));\n    for (int32_t i_84483 = 0; i_84483 < iterations_84482; i_84483++) {\n        int32_t virt_tblock_id_84484;\n        int64_t global_tid_84485;\n        int64_t slice_84487;\n        int64_t rep_i_84486;\n        int64_t remnant_84488;\n        \n        virt_tblock_id_84484 = phys_tblock_id_84481 + i_84483 * sext_i64_i32(num_tblocks_84480);\n        global_tid_84485 = sext_i32_i64(virt_tblock_id_84484) * sext_i32_i64(tblock_sizze_84477) + sext_i32_i64(replicate_ltid_84475);\n        slice_84487 = num_elems_84470;\n        rep_i_84486 = global_tid_84485;\n        remnant_84488 = global_tid_84485 - rep_i_84486;\n        if (slt64(global_tid_84485, replicate_n_84473)) {\n            ((__global bool *) mem_84469)[rep_i_84486] = val_84471;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f64zireplicate_83380(int64_t num_elems_83376, double val_83377, int64_t replicate_n_83379, int64_t virt_num_tblocks_83385, int64_t num_tblocks_83386, __global unsigned char *mem_83375)\n{\n    int32_t replicate_ltid_83381;\n    int32_t tblock_sizze_83383;\n    int32_t replicate_gid_83382;\n    int32_t replicate_gtid_83380;\n    int32_t phys_tblock_id_83387;\n    int32_t iterations_83388;\n    \n    replicate_ltid_83381 = get_local_id(0);\n    tblock_sizze_83383 = get_local_size(0);\n    replicate_gid_83382 = get_tblock_id(0);\n    replicate_gtid_83380 = replicate_gid_83382 * tblock_sizze_83383 + replicate_ltid_83381;\n    phys_tblock_id_83387 = get_tblock_id(0);\n    iterations_83388 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83385) - ", "phys_tblock_id_83387, sext_i64_i32(num_tblocks_83386));\n    for (int32_t i_83389 = 0; i_83389 < iterations_83388; i_83389++) {\n        int32_t virt_tblock_id_83390;\n        int64_t global_tid_83391;\n        int64_t slice_83393;\n        int64_t rep_i_83392;\n        int64_t remnant_83394;\n        \n        virt_tblock_id_83390 = phys_tblock_id_83387 + i_83389 * sext_i64_i32(num_tblocks_83386);\n        global_tid_83391 = sext_i32_i64(virt_tblock_id_83390) * sext_i32_i64(tblock_sizze_83383) + sext_i32_i64(replicate_ltid_83381);\n        slice_83393 = num_elems_83376;\n        rep_i_83392 = global_tid_83391;\n        remnant_83394 = global_tid_83391 - rep_i_83392;\n        if (slt64(global_tid_83391, replicate_n_83379)) {\n            ((__global double *) mem_83375)[rep_i_83392] = val_83377;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i32zireplicate_83197(int64_t num_elems_83193, int32_t val_83194, int64_t replicate_n_83196, int64_t virt_num_tblocks_83202, int64_t num_tblocks_83203, __global unsigned char *mem_83192)\n{\n    int32_t replicate_ltid_83198;\n    int32_t tblock_sizze_83200;\n    int32_t replicate_gid_83199;\n    int32_t replicate_gtid_83197;\n    int32_t phys_tblock_id_83204;\n    int32_t iterations_83205;\n    \n    replicate_ltid_83198 = get_local_id(0);\n    tblock_sizze_83200 = get_local_size(0);\n    replicate_gid_83199 = get_tblock_id(0);\n    replicate_gtid_83197 = replicate_gid_83199 * tblock_sizze_83200 + replicate_ltid_83198;\n    phys_tblock_id_83204 = get_tblock_id(0);\n    iterations_83205 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83202) - phys_tblock_id_83204, sext_i64_i32(num_tblocks_83203));\n    for (int32_t i_83206 = 0; i_83206 < iterations_83205; i_83206++) {\n        int32_t virt_tblock_id_83207;\n        int64_t global_tid_83208;\n        int64_t slice_83210;\n        int64_t rep_i_83209;\n        int64_t remnant_83211;\n        \n        virt_tblock_id_83207 = phy", "s_tblock_id_83204 + i_83206 * sext_i64_i32(num_tblocks_83203);\n        global_tid_83208 = sext_i32_i64(virt_tblock_id_83207) * sext_i32_i64(tblock_sizze_83200) + sext_i32_i64(replicate_ltid_83198);\n        slice_83210 = num_elems_83193;\n        rep_i_83209 = global_tid_83208;\n        remnant_83211 = global_tid_83208 - rep_i_83209;\n        if (slt64(global_tid_83208, replicate_n_83196)) {\n            ((__global int32_t *) mem_83192)[rep_i_83209] = val_83194;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i64zireplicate_83337(int64_t num_elems_83333, int64_t val_83334, int64_t replicate_n_83336, int64_t virt_num_tblocks_83342, int64_t num_tblocks_83343, __global unsigned char *mem_83332)\n{\n    int32_t replicate_ltid_83338;\n    int32_t tblock_sizze_83340;\n    int32_t replicate_gid_83339;\n    int32_t replicate_gtid_83337;\n    int32_t phys_tblock_id_83344;\n    int32_t iterations_83345;\n    \n    replicate_ltid_83338 = get_local_id(0);\n    tblock_sizze_83340 = get_local_size(0);\n    replicate_gid_83339 = get_tblock_id(0);\n    replicate_gtid_83337 = replicate_gid_83339 * tblock_sizze_83340 + replicate_ltid_83338;\n    phys_tblock_id_83344 = get_tblock_id(0);\n    iterations_83345 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83342) - phys_tblock_id_83344, sext_i64_i32(num_tblocks_83343));\n    for (int32_t i_83346 = 0; i_83346 < iterations_83345; i_83346++) {\n        int32_t virt_tblock_id_83347;\n        int64_t global_tid_83348;\n        int64_t slice_83350;\n        int64_t rep_i_83349;\n        int64_t remnant_83351;\n        \n        virt_tblock_id_83347 = phys_tblock_id_83344 + i_83346 * sext_i64_i32(num_tblocks_83343);\n        global_tid_83348 = sext_i32_i64(virt_tblock_id_83347) * sext_i32_i64(tblock_sizze_83340) + sext_i32_i64(replicate_ltid_83338);\n        slice_83350 = num_elems_83333;\n        rep_i_83349 = global_tid_83348;\n        remnant_83351 = global_tid_83348 - rep_i_8334",
                                    "9;\n        if (slt64(global_tid_83348, replicate_n_83336)) {\n            ((__global int64_t *) mem_83332)[rep_i_83349] = val_83334;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i8zireplicate_83171(int64_t num_elems_83167, int8_t val_83168, int64_t replicate_n_83170, int64_t virt_num_tblocks_83176, int64_t num_tblocks_83177, __global unsigned char *mem_83166)\n{\n    int32_t replicate_ltid_83172;\n    int32_t tblock_sizze_83174;\n    int32_t replicate_gid_83173;\n    int32_t replicate_gtid_83171;\n    int32_t phys_tblock_id_83178;\n    int32_t iterations_83179;\n    \n    replicate_ltid_83172 = get_local_id(0);\n    tblock_sizze_83174 = get_local_size(0);\n    replicate_gid_83173 = get_tblock_id(0);\n    replicate_gtid_83171 = replicate_gid_83173 * tblock_sizze_83174 + replicate_ltid_83172;\n    phys_tblock_id_83178 = get_tblock_id(0);\n    iterations_83179 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83176) - phys_tblock_id_83178, sext_i64_i32(num_tblocks_83177));\n    for (int32_t i_83180 = 0; i_83180 < iterations_83179; i_83180++) {\n        int32_t virt_tblock_id_83181;\n        int64_t global_tid_83182;\n        int64_t slice_83184;\n        int64_t rep_i_83183;\n        int64_t remnant_83185;\n        \n        virt_tblock_id_83181 = phys_tblock_id_83178 + i_83180 * sext_i64_i32(num_tblocks_83177);\n        global_tid_83182 = sext_i32_i64(virt_tblock_id_83181) * sext_i32_i64(tblock_sizze_83174) + sext_i32_i64(replicate_ltid_83172);\n        slice_83184 = num_elems_83167;\n        rep_i_83183 = global_tid_83182;\n        remnant_83185 = global_tid_83182 - rep_i_83183;\n        if (slt64(global_tid_83182, replicate_n_83170)) {\n            ((__global int8_t *) mem_83166)[rep_i_83183] = val_83168;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezigpuseq_83355_dim1, 1, 1)\nvoid do_DBSCAN_doublezigpuseq_", "83355(__global int *global_failure, __global unsigned char *current_partition_mem_81946, __global unsigned char *current_partition_mem_81947, __global unsigned char *mem_81979, __global unsigned char *mem_81980, __global unsigned char *mem_81981, __global unsigned char *mem_81982, __global unsigned char *mem_81983, __global unsigned char *mem_81984, __global unsigned char *mem_81985, __global unsigned char *mem_81986)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83357;\n    int32_t tblock_sizze_83360;\n    int32_t wave_sizze_83359;\n    int32_t block_id_83358;\n    int32_t global_tid_83356;\n    int64_t tid_83355;\n    double isWithinMargins_arg2_81561;\n    double zt_res_81564;\n    double zs_res_81567;\n    double isWithinMargins_arg0_81573;\n    double zt_res_81576;\n    double zs_res_81579;\n    double isWithinMargins_arg3_81585;\n    double zt_res_81588;\n    double zs_res_81591;\n    double isWithinMargins_arg1_81594;\n    double zt_res_81597;\n    double zs_res_81600;\n    \n    local_tid_83357 = get_local_id(0);\n    tblock_sizze_83360 = get_local_size(0);\n    wave_sizze_83359 = LOCKSTEP_WIDTH;\n    block_id_83358 = get_tblock_id(0);\n    global_tid_83356 = block_id_83358 * tblock_sizze_83360 + local_tid_83357;\n    tid_83355 = sext_i32_i64(global_tid_83356);\n    isWithinMargins_arg2_81561 = ((__global double *) current_partition_mem_81946)[(int64_t) 0];\n    zt_res_81564 = 3.141592653589793 * isWithinMargins_arg2_81561;\n    zs_res_81567 = zt_res_81564 / 180.0;\n    isWithinMargins_arg0_81573 = ((__global double *) current_partition_mem_81947)[(int64_t) 0];\n    zt_res_81576 = 3.141592653589793 * isWithinMargins_arg0_81573;\n    zs_res_81579 = zt_res_81576 / 180.0;\n    isWithinMargins_arg3_81585 = ((__global double *) current_partition_mem_81946)[(int64_t) 1];\n    zt_res_81588 = 3.141592653589793 * isWithinMargins_arg3_81585;\n    zs_res_81591 = zt_res_81588 / 180.0;\n    isWithinMargins_arg1_81594 = ((__global double *) current_partition_mem_81947)[(int64_", "t) 1];\n    zt_res_81597 = 3.141592653589793 * isWithinMargins_arg1_81594;\n    zs_res_81600 = zt_res_81597 / 180.0;\n    ((__global double *) mem_81979)[(int64_t) 0] = isWithinMargins_arg2_81561;\n    ((__global double *) mem_81980)[(int64_t) 0] = zs_res_81567;\n    ((__global double *) mem_81981)[(int64_t) 0] = isWithinMargins_arg0_81573;\n    ((__global double *) mem_81982)[(int64_t) 0] = zs_res_81579;\n    ((__global double *) mem_81983)[(int64_t) 0] = isWithinMargins_arg3_81585;\n    ((__global double *) mem_81984)[(int64_t) 0] = zs_res_81591;\n    ((__global double *) mem_81985)[(int64_t) 0] = isWithinMargins_arg1_81594;\n    ((__global double *) mem_81986)[(int64_t) 0] = zs_res_81600;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezigpuseq_83361_dim1, 1, 1)\nvoid do_DBSCAN_doublezigpuseq_83361(__global int *global_failure, __global unsigned char *ext_mem_81987, __global unsigned char *ext_mem_81988, __global unsigned char *mem_81991, __global unsigned char *mem_81992)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83363;\n    int32_t tblock_sizze_83366;\n    int32_t wave_sizze_83365;\n    int32_t block_id_83364;\n    int32_t global_tid_83362;\n    int64_t tid_83361;\n    double d_haversine_res_81570;\n    double cos_res_81571;\n    double d_haversine_res_81582;\n    double cos_res_81583;\n    \n    local_tid_83363 = get_local_id(0);\n    tblock_sizze_83366 = get_local_size(0);\n    wave_sizze_83365 = LOCKSTEP_WIDTH;\n    block_id_83364 = get_tblock_id(0);\n    global_tid_83362 = block_id_83364 * tblock_sizze_83366 + local_tid_83363;\n    tid_83361 = sext_i32_i64(global_tid_83362);\n    d_haversine_res_81570 = ((__global double *) ext_mem_81987)[(int64_t) 0];\n    cos_res_81571 = futrts_cos64(d_haversine_res_81570);\n    d_haversine_res_81582 = ((__global double *) ext_mem_81988)[(int64_t) 0];\n    cos_res_81583 = futrts_cos64(d_haversine_res_81582);\n    ((__global double *) mem_81991)[(int64_t) 0] = cos_res_81571;\n    ((__global double *) mem",
                                    "_81992)[(int64_t) 0] = cos_res_81583;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezigpuseq_86817_dim1, 1, 1)\nvoid do_DBSCAN_doublezigpuseq_86817(__global int *global_failure, __global unsigned char *mem_82899, __global unsigned char *mem_82901, __global unsigned char *mem_82906)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86819;\n    int32_t tblock_sizze_86822;\n    int32_t wave_sizze_86821;\n    int32_t block_id_86820;\n    int32_t global_tid_86818;\n    int64_t tid_86817;\n    int64_t defunc_0_reduce_res_81633;\n    int64_t defunc_0_reduce_res_81635;\n    int64_t max_res_81639;\n    \n    local_tid_86819 = get_local_id(0);\n    tblock_sizze_86822 = get_local_size(0);\n    wave_sizze_86821 = LOCKSTEP_WIDTH;\n    block_id_86820 = get_tblock_id(0);\n    global_tid_86818 = block_id_86820 * tblock_sizze_86822 + local_tid_86819;\n    tid_86817 = sext_i32_i64(global_tid_86818);\n    defunc_0_reduce_res_81633 = ((__global int64_t *) mem_82899)[(int64_t) 0];\n    defunc_0_reduce_res_81635 = ((__global int64_t *) mem_82901)[(int64_t) 0];\n    max_res_81639 = smax64(defunc_0_reduce_res_81633, defunc_0_reduce_res_81635);\n    ((__global int64_t *) mem_82906)[(int64_t) 0] = max_res_81639;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid do_DBSCAN_doublezireplicate_84152(int64_t conc_tmp_62382, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t replicate_n_84151, int64_t virt_num_tblocks_84157, int64_t num_tblocks_84158, __global unsigned char *mem_82180, __global unsigned char *mem_82183)\n{\n    int32_t replicate_ltid_84153;\n    int32_t tblock_sizze_84155;\n    int32_t replicate_gid_84154;\n    int32_t replicate_gtid_84152;\n    int32_t phys_tblock_id_84159;\n    int32_t iterations_84160;\n    \n    replicate_ltid_84153 = get_local_id(0);\n    tblock_sizze_84155 = get_local_size(0);\n    replicate_gid_84154 = get_tblock_id(0);\n    replicate_gtid_84152 = replicate_gid_84154 * tblock_sizze_84155 + replicate_ltid_84153;\n    phys_tblock_id_84159 = ", "get_tblock_id(0);\n    iterations_84160 = sdiv_up32(sext_i64_i32(virt_num_tblocks_84157) - phys_tblock_id_84159, sext_i64_i32(num_tblocks_84158));\n    for (int32_t i_84161 = 0; i_84161 < iterations_84160; i_84161++) {\n        int32_t virt_tblock_id_84162;\n        int64_t global_tid_84163;\n        int64_t slice_84166;\n        int64_t slice_84167;\n        int64_t rep_i_84164;\n        int64_t remnant_84168;\n        int64_t rep_i_84165;\n        int64_t remnant_84169;\n        \n        virt_tblock_id_84162 = phys_tblock_id_84159 + i_84161 * sext_i64_i32(num_tblocks_84158);\n        global_tid_84163 = sext_i32_i64(virt_tblock_id_84162) * sext_i32_i64(tblock_sizze_84155) + sext_i32_i64(replicate_ltid_84153);\n        slice_84166 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;\n        slice_84167 = conc_tmp_62382 * slice_84166;\n        rep_i_84164 = squot64(global_tid_84163, slice_84166);\n        remnant_84168 = global_tid_84163 - rep_i_84164 * slice_84166;\n        rep_i_84165 = remnant_84168;\n        remnant_84169 = remnant_84168 - rep_i_84165;\n        if (slt64(global_tid_84163, replicate_n_84151)) {\n            int64_t tmp_84170 = ((__global int64_t *) mem_82180)[rep_i_84165];\n            \n            ((__global int64_t *) mem_82183)[rep_i_84164 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 + rep_i_84165] = tmp_84170;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid do_DBSCAN_doublezireplicate_84172(int64_t conc_tmp_62382, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t replicate_n_84171, int64_t virt_num_tblocks_84177, int64_t num_tblocks_84178, __global unsigned char *mem_82172, __global unsigned char *mem_82196)\n{\n    int32_t replicate_ltid_84173;\n    int32_t tblock_sizze_84175;\n    int32_t replicate_gid_84174;\n    int32_t replicate_gtid_84172;\n    int32_t phys_tblock_id_84179;\n    int32_t iterations_84180;\n    \n    replicate_ltid_84173 = get_local_id(0);\n    tblock_sizze_84175 = get_local_size(", "0);\n    replicate_gid_84174 = get_tblock_id(0);\n    replicate_gtid_84172 = replicate_gid_84174 * tblock_sizze_84175 + replicate_ltid_84173;\n    phys_tblock_id_84179 = get_tblock_id(0);\n    iterations_84180 = sdiv_up32(sext_i64_i32(virt_num_tblocks_84177) - phys_tblock_id_84179, sext_i64_i32(num_tblocks_84178));\n    for (int32_t i_84181 = 0; i_84181 < iterations_84180; i_84181++) {\n        int32_t virt_tblock_id_84182;\n        int64_t global_tid_84183;\n        int64_t slice_84186;\n        int64_t slice_84187;\n        int64_t rep_i_84184;\n        int64_t remnant_84188;\n        int64_t rep_i_84185;\n        int64_t remnant_84189;\n        \n        virt_tblock_id_84182 = phys_tblock_id_84179 + i_84181 * sext_i64_i32(num_tblocks_84178);\n        global_tid_84183 = sext_i32_i64(virt_tblock_id_84182) * sext_i32_i64(tblock_sizze_84175) + sext_i32_i64(replicate_ltid_84173);\n        slice_84186 = conc_tmp_62382;\n        slice_84187 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * slice_84186;\n        rep_i_84184 = squot64(global_tid_84183, slice_84186);\n        remnant_84188 = global_tid_84183 - rep_i_84184 * slice_84186;\n        rep_i_84185 = remnant_84188;\n        remnant_84189 = remnant_84188 - rep_i_84185;\n        if (slt64(global_tid_84183, replicate_n_84171)) {\n            int64_t tmp_84190 = ((__global int64_t *) mem_82172)[rep_i_84185];\n            \n            ((__global int64_t *) mem_82196)[rep_i_84184 * conc_tmp_62382 + rep_i_84185] = tmp_84190;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doubleziseghist_global_75451_dim1, 1, 1)\nvoid do_DBSCAN_doubleziseghist_global_75451(__global int *global_failure, int64_t inf_66341, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t m_66453, int64_t num_tblocks_75446, int64_t num_subhistos_84206, int32_t chk_i_84276, int64_t hist_H_chk_84277, __global unsigned char *mem_82209, __global unsigned char *defunc_0_map_res_subhistos_mem_84207",
                                    ")\n{\n    #define seghist_tblock_sizze_75444 (do_DBSCAN_doubleziseghist_global_75451ziseghist_tblock_sizze_75444)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84279;\n    int32_t tblock_sizze_84282;\n    int32_t wave_sizze_84281;\n    int32_t block_id_84280;\n    int32_t global_tid_84278;\n    int64_t phys_tid_75451;\n    int32_t subhisto_ind_84283;\n    int64_t num_chunks_84284;\n    \n    local_tid_84279 = get_local_id(0);\n    tblock_sizze_84282 = get_local_size(0);\n    wave_sizze_84281 = LOCKSTEP_WIDTH;\n    block_id_84280 = get_tblock_id(0);\n    global_tid_84278 = block_id_84280 * tblock_sizze_84282 + local_tid_84279;\n    phys_tid_75451 = sext_i32_i64(global_tid_84278);\n    subhisto_ind_84283 = squot32(global_tid_84278, sdiv_up32(sext_i64_i32(seghist_tblock_sizze_75444 * num_tblocks_75446), sext_i64_i32(num_subhistos_84206)));\n    num_chunks_84284 = sdiv_up64(m_66453, sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_75444 * num_tblocks_75446)));\n    for (int64_t chunk_i_84285 = 0; chunk_i_84285 < num_chunks_84284; chunk_i_84285++) {\n        int64_t i_84286 = chunk_i_84285 * sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_75444 * num_tblocks_75446)) + sext_i32_i64(global_tid_84278);\n        \n        if (slt64(i_84286, m_66453)) {\n            int64_t slice_84287;\n            int64_t gtid_75450;\n            int64_t remnant_84288;\n            \n            slice_84287 = m_66453;\n            gtid_75450 = i_84286;\n            remnant_84288 = i_84286 - gtid_75450;\n            if (slt64(i_84286, m_66453)) {\n                int64_t eta_p_75455;\n                int64_t tmp_75457;\n                \n                eta_p_75455 = ((__global int64_t *) mem_82209)[gtid_75450];\n                tmp_75457 = sub64(eta_p_75455, inf_66341);\n                // save map-out results\n                { }\n                // perform atomic updates\n                {\n                    if (sle64(sext_i32_i64(chk_i_84276) * hist_H_chk_84277, tmp_75457) && (slt64(tmp_75457, sext_i3", "2_i64(chk_i_84276) * hist_H_chk_84277 + hist_H_chk_84277) && (sle64((int64_t) 0, tmp_75457) && slt64(tmp_75457, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344)))) {\n                        int64_t eta_p_75452;\n                        int64_t eta_p_75453 = (int64_t) 1;\n                        int64_t old_84289;\n                        \n                        old_84289 = atomic_add_i64_global(&((volatile __global int64_t *) defunc_0_map_res_subhistos_mem_84207)[sext_i32_i64(subhisto_ind_84283) * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 + tmp_75457], (int64_t) eta_p_75453);\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_tblock_sizze_75444\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doubleziseghist_local_75451_dim1, 1, 1)\nvoid do_DBSCAN_doubleziseghist_local_75451(__global int *global_failure, int64_t inf_66341, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t m_66453, int64_t num_subhistos_84206, int64_t num_tblocks_84217, int32_t hist_M_84223, int32_t chk_i_84227, int64_t num_segments_84228, int64_t hist_H_chk_84229, int64_t histo_sizze_84230, int32_t init_per_thread_84231, __global unsigned char *mem_82209, __global unsigned char *defunc_0_map_res_subhistos_mem_84207)\n{\n    #define max_tblock_sizze_84216 (do_DBSCAN_doubleziseghist_local_75451zimax_tblock_sizze_84216)\n    \n    volatile __local unsigned char *subhistogram_local_mem_84245_backing_0 = &shared_mem[0];\n    const int64_t subhistogram_local_mem_84245_backing_0_offset = 0 + ((int64_t) 8 * (hist_M_84223 * hist_H_chk_84229) + srem64((int64_t) 8 - srem64((int64_t) 8 * (hist_M_84223 * hist_H_chk_84229), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84233;\n    int32_t tblock_sizze_84236;\n    int32_t wave_sizze_84235;\n    int32_t block_id_84234;\n    int32_t global_tid_84232;\n    int64_t phys_tid_75451;\n    int32_t phys_tblock_id_84237;\n    int32_t iterations_84238;\n    \n    local_tid_84233 = get_", "local_id(0);\n    tblock_sizze_84236 = get_local_size(0);\n    wave_sizze_84235 = LOCKSTEP_WIDTH;\n    block_id_84234 = get_tblock_id(0);\n    global_tid_84232 = block_id_84234 * tblock_sizze_84236 + local_tid_84233;\n    phys_tid_75451 = sext_i32_i64(global_tid_84232);\n    phys_tblock_id_84237 = get_tblock_id(0);\n    iterations_84238 = sdiv_up32(sext_i64_i32(num_tblocks_84217 * num_segments_84228) - phys_tblock_id_84237, sext_i64_i32(num_tblocks_84217));\n    for (int32_t i_84239 = 0; i_84239 < iterations_84238; i_84239++) {\n        int32_t virt_tblock_id_84240;\n        int32_t flat_segment_id_84241;\n        int32_t gid_in_segment_84242;\n        int32_t pgtid_in_segment_84243;\n        int32_t threads_per_segment_84244;\n        __local unsigned char *subhistogram_local_mem_84245;\n        int32_t thread_local_subhisto_i_84247;\n        int64_t num_chunks_84254;\n        \n        virt_tblock_id_84240 = phys_tblock_id_84237 + i_84239 * sext_i64_i32(num_tblocks_84217);\n        flat_segment_id_84241 = squot32(virt_tblock_id_84240, sext_i64_i32(num_tblocks_84217));\n        gid_in_segment_84242 = srem32(virt_tblock_id_84240, sext_i64_i32(num_tblocks_84217));\n        pgtid_in_segment_84243 = gid_in_segment_84242 * sext_i64_i32(max_tblock_sizze_84216) + local_tid_84233;\n        threads_per_segment_84244 = sext_i64_i32(num_tblocks_84217 * max_tblock_sizze_84216);\n        subhistogram_local_mem_84245 = (__local unsigned char *) subhistogram_local_mem_84245_backing_0;\n        thread_local_subhisto_i_84247 = srem32(local_tid_84233, hist_M_84223);\n        // initialize histograms in shared memory\n        {\n            for (int32_t local_i_84248 = 0; local_i_84248 < init_per_thread_84231; local_i_84248++) {\n                int32_t j_84249 = local_i_84248 * sext_i64_i32(max_tblock_sizze_84216) + local_tid_84233;\n                int32_t j_offset_84250 = hist_M_84223 * sext_i64_i32(histo_sizze_84230) * gid_in_segment_84242 + j_84249;\n                int32_t local_subhisto_i_84251 = squot32(j",
                                    "_84249, sext_i64_i32(histo_sizze_84230));\n                int32_t global_subhisto_i_84252 = squot32(j_offset_84250, sext_i64_i32(histo_sizze_84230));\n                \n                if (slt32(j_84249, hist_M_84223 * sext_i64_i32(histo_sizze_84230))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_84252 == 0 && ((sle64((int64_t) 0, (int64_t) 0) && slt64((int64_t) 0, num_subhistos_84206)) && (sle64((int64_t) 0, sext_i32_i64(srem32(j_84249, sext_i64_i32(histo_sizze_84230))) + sext_i32_i64(chk_i_84227) * hist_H_chk_84229) && slt64(sext_i32_i64(srem32(j_84249, sext_i64_i32(histo_sizze_84230))) + sext_i32_i64(chk_i_84227) * hist_H_chk_84229, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344)))) {\n                            int64_t tmp_84253 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_84207)[sext_i32_i64(srem32(j_84249, sext_i64_i32(histo_sizze_84230))) + sext_i32_i64(chk_i_84227) * hist_H_chk_84229];\n                            \n                            ((__local int64_t *) subhistogram_local_mem_84245)[sext_i32_i64(local_subhisto_i_84251) * hist_H_chk_84229 + sext_i32_i64(srem32(j_84249, sext_i64_i32(histo_sizze_84230)))] = tmp_84253;\n                        } else {\n                            ((__local int64_t *) subhistogram_local_mem_84245)[sext_i32_i64(local_subhisto_i_84251) * hist_H_chk_84229 + sext_i32_i64(srem32(j_84249, sext_i64_i32(histo_sizze_84230)))] = (int64_t) 0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        num_chunks_84254 = sdiv_up64(m_66453, sext_i32_i64(threads_per_segment_84244));\n        for (int64_t chunk_i_84255 = 0; chunk_i_84255 < num_chunks_84254; chunk_i_84255++) {\n            int64_t i_84256 = chunk_i_84255 * sext_i32_i64(threads_per_segment_84244) + sext_i32_i64(pgtid_in_segment_84243);\n            \n            if (slt64", "(i_84256, m_66453)) {\n                int64_t gtid_75450;\n                int64_t eta_p_75455;\n                int64_t tmp_75457;\n                \n                gtid_75450 = i_84256;\n                eta_p_75455 = ((__global int64_t *) mem_82209)[gtid_75450];\n                tmp_75457 = sub64(eta_p_75455, inf_66341);\n                if (chk_i_84227 == 0) {\n                    // save map-out results\n                    { }\n                }\n                // perform atomic updates\n                {\n                    if ((sle64((int64_t) 0, tmp_75457) && slt64(tmp_75457, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344)) && (sle64(sext_i32_i64(chk_i_84227) * hist_H_chk_84229, tmp_75457) && slt64(tmp_75457, sext_i32_i64(chk_i_84227) * hist_H_chk_84229 + hist_H_chk_84229))) {\n                        int64_t eta_p_75452;\n                        int64_t eta_p_75453 = (int64_t) 1;\n                        int64_t old_84257;\n                        \n                        old_84257 = atomic_add_i64_shared(&((volatile __local int64_t *) subhistogram_local_mem_84245)[sext_i32_i64(thread_local_subhisto_i_84247) * hist_H_chk_84229 + (tmp_75457 - sext_i32_i64(chk_i_84227) * hist_H_chk_84229)], (int64_t) eta_p_75453);\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple shared memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_84258 = smin64(hist_H_chk_84229, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 - sext_i32_i64(chk_i_84227) * hist_H_chk_84229);\n            int32_t histo_sizze_84259 = sext_i64_i32(trunc_H_84258);\n            \n            for (int32_t local_i_84260 = 0; local_i_84260 < init_per_thread_84231; local_i_84260++) {\n                int32_t j_84261 = local_i_84260 * sext_i64_i32(max_tblock_sizze_84216) + local_tid_84233;\n                \n                if (slt32(j_84261, histo_sizze_84259)) {\n                    int64_t eta_p_75452;\n   ", "                 int64_t eta_p_75453;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        eta_p_75452 = ((__local int64_t *) subhistogram_local_mem_84245)[sext_i32_i64(j_84261)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_84262 = 0; subhisto_id_84262 < hist_M_84223 - 1; subhisto_id_84262++) {\n                            eta_p_75453 = ((__local int64_t *) subhistogram_local_mem_84245)[(sext_i32_i64(subhisto_id_84262) + (int64_t) 1) * hist_H_chk_84229 + sext_i32_i64(j_84261)];\n                            \n                            int64_t defunc_0_op_res_75454 = add64(eta_p_75452, eta_p_75453);\n                            \n                            eta_p_75452 = defunc_0_op_res_75454;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global int64_t *) defunc_0_map_res_subhistos_mem_84207)[srem64(sext_i32_i64(virt_tblock_id_84240), num_tblocks_84217) * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 + (sext_i32_i64(j_84261) + sext_i32_i64(chk_i_84227) * hist_H_chk_84229)] = eta_p_75452;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_2:\n    return;\n    #undef max_tblock_sizze_84216\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75084_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75084(__global int *global_failure, int64_t n_48679, int64_t m_61612, int64_t num_tblocks_75089, int32_t virt_num_tblocks_83317, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_81954, __global unsigned char *mem_81956, __global unsigned char *mem_81962, __global unsigned char *mem_81964, __global unsigned char *mem_81966)",
                                    "\n{\n    #define segmap_tblock_sizze_75087 (do_DBSCAN_doublezisegmap_75084zisegmap_tblock_sizze_75087)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83319;\n    int32_t tblock_sizze_83322;\n    int32_t wave_sizze_83321;\n    int32_t block_id_83320;\n    int32_t global_tid_83318;\n    int64_t phys_tid_75084;\n    int32_t phys_tblock_id_83323;\n    int32_t iterations_83324;\n    \n    local_tid_83319 = get_local_id(0);\n    tblock_sizze_83322 = get_local_size(0);\n    wave_sizze_83321 = LOCKSTEP_WIDTH;\n    block_id_83320 = get_tblock_id(0);\n    global_tid_83318 = block_id_83320 * tblock_sizze_83322 + local_tid_83319;\n    phys_tid_75084 = sext_i32_i64(global_tid_83318);\n    phys_tblock_id_83323 = get_tblock_id(0);\n    iterations_83324 = sdiv_up32(virt_num_tblocks_83317 - phys_tblock_id_83323, sext_i64_i32(num_tblocks_75089));\n    for (int32_t i_83325 = 0; i_83325 < iterations_83324; i_83325++) {\n        int32_t virt_tblock_id_83326;\n        int64_t global_tid_83327;\n        int64_t slice_83328;\n        int64_t write_i_75083;\n        int64_t remnant_83329;\n        \n        virt_tblock_id_83326 = phys_tblock_id_83323 + i_83325 * sext_i64_i32(num_tblocks_75089);\n        global_tid_83327 = sext_i32_i64(virt_tblock_id_83326) * segmap_tblock_sizze_75087 + sext_i32_i64(local_tid_83319);\n        slice_83328 = n_48679;\n        write_i_75083 = global_tid_83327;\n        remnant_83329 = global_tid_83327 - write_i_75083;\n        if (slt64(write_i_75083, n_48679)) {\n            int64_t eta_p_65089;\n            double write_value_65092;\n            double write_value_65093;\n            bool cond_65094;\n            int64_t lifted_lambda_res_65095;\n            \n            eta_p_65089 = ((__global int64_t *) mem_81956)[write_i_75083];\n            write_value_65092 = ((__global double *) current_partition_mem_81940)[write_i_75083];\n            write_value_65093 = ((__global double *) current_partition_mem_81941)[write_i_75083];\n            cond_65094 = eta_p_65089 == (int6", "4_t) 1;\n            if (cond_65094) {\n                int64_t eta_p_65090;\n                int64_t lifted_lambda_res_t_res_66163;\n                \n                eta_p_65090 = ((__global int64_t *) mem_81954)[write_i_75083];\n                lifted_lambda_res_t_res_66163 = sub64(eta_p_65090, (int64_t) 1);\n                lifted_lambda_res_65095 = lifted_lambda_res_t_res_66163;\n            } else {\n                lifted_lambda_res_65095 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65095) && slt64(lifted_lambda_res_65095, m_61612)) {\n                ((__global int64_t *) mem_81966)[lifted_lambda_res_65095] = write_i_75083;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65095) && slt64(lifted_lambda_res_65095, m_61612)) {\n                ((__global double *) mem_81964)[lifted_lambda_res_65095] = write_value_65092;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65095) && slt64(lifted_lambda_res_65095, m_61612)) {\n                ((__global double *) mem_81962)[lifted_lambda_res_65095] = write_value_65093;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75087\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75100_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75100(__global int *global_failure, int64_t dz2082U_48684, int64_t m_61888, int64_t num_tblocks_75105, int32_t virt_num_tblocks_83469, __global unsigned char *clProc_mem_81935, __global unsigned char *clProc_mem_81936, __global unsigned char *mem_81995, __global unsigned char *mem_81997, __global unsigned char *mem_81998, __global unsigned char *mem_82000, __global unsigned char *mem_82002, __global unsigned char *mem_82004, __global unsigned char *mem_82005, __global unsigned char *mem_82007, __global unsigned char *mem_82009)\n{\n    #define segmap_tblock_sizze_75103 (do_DBSCAN_doublezisegmap_75100zisegmap_tblock_sizze_75103)\n    if (*global_fa", "ilure >= 0)\n        return;\n    \n    int32_t local_tid_83471;\n    int32_t tblock_sizze_83474;\n    int32_t wave_sizze_83473;\n    int32_t block_id_83472;\n    int32_t global_tid_83470;\n    int64_t phys_tid_75100;\n    int32_t phys_tblock_id_83475;\n    int32_t iterations_83476;\n    \n    local_tid_83471 = get_local_id(0);\n    tblock_sizze_83474 = get_local_size(0);\n    wave_sizze_83473 = LOCKSTEP_WIDTH;\n    block_id_83472 = get_tblock_id(0);\n    global_tid_83470 = block_id_83472 * tblock_sizze_83474 + local_tid_83471;\n    phys_tid_75100 = sext_i32_i64(global_tid_83470);\n    phys_tblock_id_83475 = get_tblock_id(0);\n    iterations_83476 = sdiv_up32(virt_num_tblocks_83469 - phys_tblock_id_83475, sext_i64_i32(num_tblocks_75105));\n    for (int32_t i_83477 = 0; i_83477 < iterations_83476; i_83477++) {\n        int32_t virt_tblock_id_83478;\n        int64_t global_tid_83479;\n        int64_t slice_83480;\n        int64_t write_i_75099;\n        int64_t remnant_83481;\n        \n        virt_tblock_id_83478 = phys_tblock_id_83475 + i_83477 * sext_i64_i32(num_tblocks_75105);\n        global_tid_83479 = sext_i32_i64(virt_tblock_id_83478) * segmap_tblock_sizze_75103 + sext_i32_i64(local_tid_83471);\n        slice_83480 = dz2082U_48684;\n        write_i_75099 = global_tid_83479;\n        remnant_83481 = global_tid_83479 - write_i_75099;\n        if (slt64(write_i_75099, dz2082U_48684)) {\n            int64_t eta_p_64669;\n            double write_value_64671;\n            double write_value_64672;\n            bool write_value_64673;\n            int64_t write_value_64674;\n            bool cond_64676;\n            int64_t lifted_lambda_res_64677;\n            \n            eta_p_64669 = ((__global int64_t *) mem_81997)[write_i_75099];\n            write_value_64671 = ((__global double *) clProc_mem_81935)[write_i_75099];\n            write_value_64672 = ((__global double *) clProc_mem_81936)[write_i_75099];\n            write_value_64673 = ((__global bool *) mem_81998)[write_i_75099];\n            write_val",
                                    "ue_64674 = ((__global int64_t *) mem_82000)[write_i_75099];\n            cond_64676 = eta_p_64669 == (int64_t) 1;\n            if (cond_64676) {\n                int64_t eta_p_64670;\n                int64_t lifted_lambda_res_t_res_66210;\n                \n                eta_p_64670 = ((__global int64_t *) mem_81995)[write_i_75099];\n                lifted_lambda_res_t_res_66210 = sub64(eta_p_64670, (int64_t) 1);\n                lifted_lambda_res_64677 = lifted_lambda_res_t_res_66210;\n            } else {\n                lifted_lambda_res_64677 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64677) && slt64(lifted_lambda_res_64677, m_61888)) {\n                ((__global double *) mem_82009)[lifted_lambda_res_64677] = write_value_64671;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64677) && slt64(lifted_lambda_res_64677, m_61888)) {\n                ((__global double *) mem_82007)[lifted_lambda_res_64677] = write_value_64672;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64677) && slt64(lifted_lambda_res_64677, m_61888)) {\n                ((__global bool *) mem_82005)[lifted_lambda_res_64677] = write_value_64673;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64677) && slt64(lifted_lambda_res_64677, m_61888)) {\n                ((__global int64_t *) mem_82004)[lifted_lambda_res_64677] = write_value_64674;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64677) && slt64(lifted_lambda_res_64677, m_61888)) {\n                ((__global int64_t *) mem_82002)[lifted_lambda_res_64677] = write_i_75099;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75103\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75116_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75116(__global int *global_failure, int64_t m_61888, int64_t y_62148, int64_t num_tblocks_75121, int32_t virt_num_tblock", "s_83636, __global unsigned char *mem_82002, __global unsigned char *mem_82004, __global unsigned char *mem_82005, __global unsigned char *mem_82007, __global unsigned char *mem_82009, __global unsigned char *mem_82013, __global unsigned char *mem_82015, __global unsigned char *mem_82017, __global unsigned char *mem_82019, __global unsigned char *mem_82021, __global unsigned char *mem_82022, __global unsigned char *mem_82024, __global unsigned char *mem_82026)\n{\n    #define segmap_tblock_sizze_75119 (do_DBSCAN_doublezisegmap_75116zisegmap_tblock_sizze_75119)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83638;\n    int32_t tblock_sizze_83641;\n    int32_t wave_sizze_83640;\n    int32_t block_id_83639;\n    int32_t global_tid_83637;\n    int64_t phys_tid_75116;\n    int32_t phys_tblock_id_83642;\n    int32_t iterations_83643;\n    \n    local_tid_83638 = get_local_id(0);\n    tblock_sizze_83641 = get_local_size(0);\n    wave_sizze_83640 = LOCKSTEP_WIDTH;\n    block_id_83639 = get_tblock_id(0);\n    global_tid_83637 = block_id_83639 * tblock_sizze_83641 + local_tid_83638;\n    phys_tid_75116 = sext_i32_i64(global_tid_83637);\n    phys_tblock_id_83642 = get_tblock_id(0);\n    iterations_83643 = sdiv_up32(virt_num_tblocks_83636 - phys_tblock_id_83642, sext_i64_i32(num_tblocks_75121));\n    for (int32_t i_83644 = 0; i_83644 < iterations_83643; i_83644++) {\n        int32_t virt_tblock_id_83645;\n        int64_t global_tid_83646;\n        int64_t slice_83647;\n        int64_t write_i_75115;\n        int64_t remnant_83648;\n        \n        virt_tblock_id_83645 = phys_tblock_id_83642 + i_83644 * sext_i64_i32(num_tblocks_75121);\n        global_tid_83646 = sext_i32_i64(virt_tblock_id_83645) * segmap_tblock_sizze_75119 + sext_i32_i64(local_tid_83638);\n        slice_83647 = m_61888;\n        write_i_75115 = global_tid_83646;\n        remnant_83648 = global_tid_83646 - write_i_75115;\n        if (slt64(write_i_75115, m_61888)) {\n            int64_t c_62154;\n            int64_t ", "offset_62155;\n            int64_t offset_62156;\n            double v_62157;\n            double v_62158;\n            bool v_62159;\n            int64_t v_62160;\n            int64_t v_62161;\n            bool is_this_one_62162;\n            bool is_this_one_62163;\n            int64_t this_offset_62164;\n            int64_t total_res_62165;\n            int64_t this_offset_62166;\n            int64_t total_res_62167;\n            \n            c_62154 = ((__global int64_t *) mem_82017)[write_i_75115];\n            offset_62155 = ((__global int64_t *) mem_82013)[write_i_75115];\n            offset_62156 = ((__global int64_t *) mem_82015)[write_i_75115];\n            v_62157 = ((__global double *) mem_82009)[write_i_75115];\n            v_62158 = ((__global double *) mem_82007)[write_i_75115];\n            v_62159 = ((__global bool *) mem_82005)[write_i_75115];\n            v_62160 = ((__global int64_t *) mem_82004)[write_i_75115];\n            v_62161 = ((__global int64_t *) mem_82002)[write_i_75115];\n            is_this_one_62162 = c_62154 == (int64_t) 0;\n            is_this_one_62163 = c_62154 == (int64_t) 1;\n            this_offset_62164 = y_62148 + offset_62156;\n            if (is_this_one_62163) {\n                total_res_62165 = this_offset_62164;\n            } else {\n                total_res_62165 = (int64_t) -1;\n            }\n            this_offset_62166 = (int64_t) -1 + offset_62155;\n            if (is_this_one_62162) {\n                total_res_62167 = this_offset_62166;\n            } else {\n                total_res_62167 = total_res_62165;\n            }\n            if (sle64((int64_t) 0, total_res_62167) && slt64(total_res_62167, m_61888)) {\n                ((__global double *) mem_82019)[total_res_62167] = v_62157;\n            }\n            if (sle64((int64_t) 0, total_res_62167) && slt64(total_res_62167, m_61888)) {\n                ((__global double *) mem_82021)[total_res_62167] = v_62158;\n            }\n            if (sle64((int64_t) 0, total_res_62167) && slt64(tot",
                                    "al_res_62167, m_61888)) {\n                ((__global bool *) mem_82022)[total_res_62167] = v_62159;\n            }\n            if (sle64((int64_t) 0, total_res_62167) && slt64(total_res_62167, m_61888)) {\n                ((__global int64_t *) mem_82024)[total_res_62167] = v_62160;\n            }\n            if (sle64((int64_t) 0, total_res_62167) && slt64(total_res_62167, m_61888)) {\n                ((__global int64_t *) mem_82026)[total_res_62167] = v_62161;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75119\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75132_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75132(__global int *global_failure, int64_t partition_sizze_62142, int64_t m_62247, int64_t num_tblocks_75137, int32_t virt_num_tblocks_83753, __global unsigned char *mem_82019, __global unsigned char *mem_82021, __global unsigned char *mem_82024, __global unsigned char *mem_82039, __global unsigned char *mem_82041, __global unsigned char *mem_82044, __global unsigned char *mem_82046, __global unsigned char *mem_82048)\n{\n    #define segmap_tblock_sizze_75135 (do_DBSCAN_doublezisegmap_75132zisegmap_tblock_sizze_75135)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83755;\n    int32_t tblock_sizze_83758;\n    int32_t wave_sizze_83757;\n    int32_t block_id_83756;\n    int32_t global_tid_83754;\n    int64_t phys_tid_75132;\n    int32_t phys_tblock_id_83759;\n    int32_t iterations_83760;\n    \n    local_tid_83755 = get_local_id(0);\n    tblock_sizze_83758 = get_local_size(0);\n    wave_sizze_83757 = LOCKSTEP_WIDTH;\n    block_id_83756 = get_tblock_id(0);\n    global_tid_83754 = block_id_83756 * tblock_sizze_83758 + local_tid_83755;\n    phys_tid_75132 = sext_i32_i64(global_tid_83754);\n    phys_tblock_id_83759 = get_tblock_id(0);\n    iterations_83760 = sdiv_up32(virt_num_tblocks_83753 - phys_tblock_id_83759, sext_i64_i32(num_tblocks_75137));\n    for (int32_", "t i_83761 = 0; i_83761 < iterations_83760; i_83761++) {\n        int32_t virt_tblock_id_83762;\n        int64_t global_tid_83763;\n        int64_t slice_83764;\n        int64_t write_i_75131;\n        int64_t remnant_83765;\n        \n        virt_tblock_id_83762 = phys_tblock_id_83759 + i_83761 * sext_i64_i32(num_tblocks_75137);\n        global_tid_83763 = sext_i32_i64(virt_tblock_id_83762) * segmap_tblock_sizze_75135 + sext_i32_i64(local_tid_83755);\n        slice_83764 = partition_sizze_62142;\n        write_i_75131 = global_tid_83763;\n        remnant_83765 = global_tid_83763 - write_i_75131;\n        if (slt64(write_i_75131, partition_sizze_62142)) {\n            int64_t eta_p_64405;\n            double write_value_64407;\n            double write_value_64408;\n            int64_t write_value_64409;\n            bool cond_64410;\n            int64_t lifted_lambda_res_64411;\n            \n            eta_p_64405 = ((__global int64_t *) mem_82041)[write_i_75131];\n            write_value_64407 = ((__global double *) mem_82019)[write_i_75131];\n            write_value_64408 = ((__global double *) mem_82021)[write_i_75131];\n            write_value_64409 = ((__global int64_t *) mem_82024)[write_i_75131];\n            cond_64410 = eta_p_64405 == (int64_t) 1;\n            if (cond_64410) {\n                int64_t eta_p_64406;\n                int64_t lifted_lambda_res_t_res_66257;\n                \n                eta_p_64406 = ((__global int64_t *) mem_82039)[write_i_75131];\n                lifted_lambda_res_t_res_66257 = sub64(eta_p_64406, (int64_t) 1);\n                lifted_lambda_res_64411 = lifted_lambda_res_t_res_66257;\n            } else {\n                lifted_lambda_res_64411 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64411) && slt64(lifted_lambda_res_64411, m_62247)) {\n                ((__global double *) mem_82048)[lifted_lambda_res_64411] = write_value_64407;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64411) && slt6", "4(lifted_lambda_res_64411, m_62247)) {\n                ((__global double *) mem_82046)[lifted_lambda_res_64411] = write_value_64408;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64411) && slt64(lifted_lambda_res_64411, m_62247)) {\n                ((__global int64_t *) mem_82044)[lifted_lambda_res_64411] = write_value_64409;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75135\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75148_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75148(__global int *global_failure, int64_t partition_sizze_62142, int64_t j_m_i_62183, int64_t m_62344, int64_t num_tblocks_75153, int32_t virt_num_tblocks_83870, __global unsigned char *mem_82019, __global unsigned char *mem_82021, __global unsigned char *mem_82024, __global unsigned char *mem_82052, __global unsigned char *mem_82054, __global unsigned char *mem_82056, __global unsigned char *mem_82058, __global unsigned char *mem_82060)\n{\n    #define segmap_tblock_sizze_75151 (do_DBSCAN_doublezisegmap_75148zisegmap_tblock_sizze_75151)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83872;\n    int32_t tblock_sizze_83875;\n    int32_t wave_sizze_83874;\n    int32_t block_id_83873;\n    int32_t global_tid_83871;\n    int64_t phys_tid_75148;\n    int32_t phys_tblock_id_83876;\n    int32_t iterations_83877;\n    \n    local_tid_83872 = get_local_id(0);\n    tblock_sizze_83875 = get_local_size(0);\n    wave_sizze_83874 = LOCKSTEP_WIDTH;\n    block_id_83873 = get_tblock_id(0);\n    global_tid_83871 = block_id_83873 * tblock_sizze_83875 + local_tid_83872;\n    phys_tid_75148 = sext_i32_i64(global_tid_83871);\n    phys_tblock_id_83876 = get_tblock_id(0);\n    iterations_83877 = sdiv_up32(virt_num_tblocks_83870 - phys_tblock_id_83876, sext_i64_i32(num_tblocks_75153));\n    for (int32_t i_83878 = 0; i_83878 < iterations_83877; i_83878++) {\n        int32_t virt_tblock_id_83879;",
                                    "\n        int64_t global_tid_83880;\n        int64_t slice_83881;\n        int64_t write_i_75147;\n        int64_t remnant_83882;\n        \n        virt_tblock_id_83879 = phys_tblock_id_83876 + i_83878 * sext_i64_i32(num_tblocks_75153);\n        global_tid_83880 = sext_i32_i64(virt_tblock_id_83879) * segmap_tblock_sizze_75151 + sext_i32_i64(local_tid_83872);\n        slice_83881 = j_m_i_62183;\n        write_i_75147 = global_tid_83880;\n        remnant_83882 = global_tid_83880 - write_i_75147;\n        if (slt64(write_i_75147, j_m_i_62183)) {\n            int64_t eta_p_65203;\n            int64_t slice_78057;\n            double write_value_65205;\n            double write_value_65206;\n            int64_t write_value_65207;\n            bool cond_65208;\n            int64_t lifted_lambda_res_65209;\n            \n            eta_p_65203 = ((__global int64_t *) mem_82054)[write_i_75147];\n            slice_78057 = partition_sizze_62142 + write_i_75147;\n            write_value_65205 = ((__global double *) mem_82019)[slice_78057];\n            write_value_65206 = ((__global double *) mem_82021)[slice_78057];\n            write_value_65207 = ((__global int64_t *) mem_82024)[slice_78057];\n            cond_65208 = eta_p_65203 == (int64_t) 1;\n            if (cond_65208) {\n                int64_t eta_p_65204;\n                int64_t lifted_lambda_res_t_res_66263;\n                \n                eta_p_65204 = ((__global int64_t *) mem_82052)[write_i_75147];\n                lifted_lambda_res_t_res_66263 = sub64(eta_p_65204, (int64_t) 1);\n                lifted_lambda_res_65209 = lifted_lambda_res_t_res_66263;\n            } else {\n                lifted_lambda_res_65209 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65209) && slt64(lifted_lambda_res_65209, m_62344)) {\n                ((__global double *) mem_82060)[lifted_lambda_res_65209] = write_value_65205;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65209) && slt64(lifted_lambda_res_6", "5209, m_62344)) {\n                ((__global double *) mem_82058)[lifted_lambda_res_65209] = write_value_65206;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_65209) && slt64(lifted_lambda_res_65209, m_62344)) {\n                ((__global int64_t *) mem_82056)[lifted_lambda_res_65209] = write_value_65207;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75151\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75156_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75156(__global int *global_failure, int64_t n_48679, int64_t m_61612, int64_t num_tblocks_75161, int32_t virt_num_tblocks_83883, __global unsigned char *mem_81966, __global unsigned char *mem_81970, __global unsigned char *ext_mem_82067)\n{\n    #define segmap_tblock_sizze_75159 (do_DBSCAN_doublezisegmap_75156zisegmap_tblock_sizze_75159)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83885;\n    int32_t tblock_sizze_83888;\n    int32_t wave_sizze_83887;\n    int32_t block_id_83886;\n    int32_t global_tid_83884;\n    int64_t phys_tid_75156;\n    int32_t phys_tblock_id_83889;\n    int32_t iterations_83890;\n    \n    local_tid_83885 = get_local_id(0);\n    tblock_sizze_83888 = get_local_size(0);\n    wave_sizze_83887 = LOCKSTEP_WIDTH;\n    block_id_83886 = get_tblock_id(0);\n    global_tid_83884 = block_id_83886 * tblock_sizze_83888 + local_tid_83885;\n    phys_tid_75156 = sext_i32_i64(global_tid_83884);\n    phys_tblock_id_83889 = get_tblock_id(0);\n    iterations_83890 = sdiv_up32(virt_num_tblocks_83883 - phys_tblock_id_83889, sext_i64_i32(num_tblocks_75161));\n    for (int32_t i_83891 = 0; i_83891 < iterations_83890; i_83891++) {\n        int32_t virt_tblock_id_83892;\n        int64_t global_tid_83893;\n        int64_t slice_83894;\n        int64_t write_i_75155;\n        int64_t remnant_83895;\n        \n        virt_tblock_id_83892 = phys_tblock_id_83889 + i_83891 * sext_i64_i32(num_tblocks_751", "61);\n        global_tid_83893 = sext_i32_i64(virt_tblock_id_83892) * segmap_tblock_sizze_75159 + sext_i32_i64(local_tid_83885);\n        slice_83894 = m_61612;\n        write_i_75155 = global_tid_83893;\n        remnant_83895 = global_tid_83893 - write_i_75155;\n        if (slt64(write_i_75155, m_61612)) {\n            int64_t write_index_62221;\n            int64_t write_value_62222;\n            \n            write_index_62221 = ((__global int64_t *) mem_81966)[write_i_75155];\n            write_value_62222 = ((__global int64_t *) ext_mem_82067)[write_i_75155];\n            if (sle64((int64_t) 0, write_index_62221) && slt64(write_index_62221, n_48679)) {\n                ((__global int64_t *) mem_81970)[write_index_62221] = write_value_62222;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75159\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75181_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75181(__global int *global_failure, int64_t n_48679, int64_t clBase_48695, __global unsigned char *ext_mem_81968, __global unsigned char *mem_81970, __global unsigned char *mem_82070)\n{\n    #define segmap_tblock_sizze_75177 (do_DBSCAN_doublezisegmap_75181zisegmap_tblock_sizze_75177)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83898;\n    int32_t tblock_sizze_83901;\n    int32_t wave_sizze_83900;\n    int32_t block_id_83899;\n    int32_t global_tid_83897;\n    int64_t phys_tid_75181;\n    int64_t global_tid_83902;\n    int64_t slice_83903;\n    int64_t gtid_75180;\n    int64_t remnant_83904;\n    \n    local_tid_83898 = get_local_id(0);\n    tblock_sizze_83901 = get_local_size(0);\n    wave_sizze_83900 = LOCKSTEP_WIDTH;\n    block_id_83899 = get_tblock_id(0);\n    global_tid_83897 = block_id_83899 * tblock_sizze_83901 + local_tid_83898;\n    phys_tid_75181 = sext_i32_i64(global_tid_83897);\n    global_tid_83902 = sext_i32_i64(block_id_83899) * segmap_tblock_sizze_75177 + sext_i3",
                                    "2_i64(local_tid_83898);\n    slice_83903 = n_48679;\n    gtid_75180 = global_tid_83902;\n    remnant_83904 = global_tid_83902 - gtid_75180;\n    if (slt64(gtid_75180, n_48679)) {\n        int64_t eta_p_75182;\n        int64_t eta_p_75183;\n        int64_t lifted_lambda_res_75184;\n        int64_t defunc_0_f_res_75185;\n        bool lifted_lambda_res_75186;\n        \n        eta_p_75182 = ((__global int64_t *) ext_mem_81968)[gtid_75180];\n        eta_p_75183 = ((__global int64_t *) mem_81970)[gtid_75180];\n        lifted_lambda_res_75184 = sub64(eta_p_75182, (int64_t) 1);\n        defunc_0_f_res_75185 = add64(eta_p_75183, lifted_lambda_res_75184);\n        lifted_lambda_res_75186 = sle64(clBase_48695, defunc_0_f_res_75185);\n        ((__global bool *) mem_82070)[gtid_75180] = lifted_lambda_res_75186;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75177\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75196_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75196(__global int *global_failure, int64_t n_48679, int64_t m_62289, int64_t num_tblocks_75201, int32_t virt_num_tblocks_84007, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_82073, __global unsigned char *mem_82075, __global unsigned char *mem_82077, __global unsigned char *mem_82079, __global unsigned char *mem_82081)\n{\n    #define segmap_tblock_sizze_75199 (do_DBSCAN_doublezisegmap_75196zisegmap_tblock_sizze_75199)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84009;\n    int32_t tblock_sizze_84012;\n    int32_t wave_sizze_84011;\n    int32_t block_id_84010;\n    int32_t global_tid_84008;\n    int64_t phys_tid_75196;\n    int32_t phys_tblock_id_84013;\n    int32_t iterations_84014;\n    \n    local_tid_84009 = get_local_id(0);\n    tblock_sizze_84012 = get_local_size(0);\n    wave_sizze_84011 = LOCKSTEP_WIDTH;\n    block_id_84010 = get_tblock_id(0);\n    global_tid_84008 = block_id_84010 * tblock_sizze_84012 + local_ti", "d_84009;\n    phys_tid_75196 = sext_i32_i64(global_tid_84008);\n    phys_tblock_id_84013 = get_tblock_id(0);\n    iterations_84014 = sdiv_up32(virt_num_tblocks_84007 - phys_tblock_id_84013, sext_i64_i32(num_tblocks_75201));\n    for (int32_t i_84015 = 0; i_84015 < iterations_84014; i_84015++) {\n        int32_t virt_tblock_id_84016;\n        int64_t global_tid_84017;\n        int64_t slice_84018;\n        int64_t write_i_75195;\n        int64_t remnant_84019;\n        \n        virt_tblock_id_84016 = phys_tblock_id_84013 + i_84015 * sext_i64_i32(num_tblocks_75201);\n        global_tid_84017 = sext_i32_i64(virt_tblock_id_84016) * segmap_tblock_sizze_75199 + sext_i32_i64(local_tid_84009);\n        slice_84018 = n_48679;\n        write_i_75195 = global_tid_84017;\n        remnant_84019 = global_tid_84017 - write_i_75195;\n        if (slt64(write_i_75195, n_48679)) {\n            int64_t eta_p_64392;\n            double write_value_64394;\n            double write_value_64395;\n            bool cond_64396;\n            int64_t lifted_lambda_res_64397;\n            \n            eta_p_64392 = ((__global int64_t *) mem_82075)[write_i_75195];\n            write_value_64394 = ((__global double *) current_partition_mem_81940)[write_i_75195];\n            write_value_64395 = ((__global double *) current_partition_mem_81941)[write_i_75195];\n            cond_64396 = eta_p_64392 == (int64_t) 1;\n            if (cond_64396) {\n                int64_t eta_p_64393;\n                int64_t lifted_lambda_res_t_res_66273;\n                \n                eta_p_64393 = ((__global int64_t *) mem_82073)[write_i_75195];\n                lifted_lambda_res_t_res_66273 = sub64(eta_p_64393, (int64_t) 1);\n                lifted_lambda_res_64397 = lifted_lambda_res_t_res_66273;\n            } else {\n                lifted_lambda_res_64397 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64397) && slt64(lifted_lambda_res_64397, m_62289)) {\n                ((__global double *) mem_82081)[lif", "ted_lambda_res_64397] = write_value_64394;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64397) && slt64(lifted_lambda_res_64397, m_62289)) {\n                ((__global double *) mem_82079)[lifted_lambda_res_64397] = write_value_64395;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64397) && slt64(lifted_lambda_res_64397, m_62289)) {\n                ((__global int64_t *) mem_82077)[lifted_lambda_res_64397] = (int64_t) -1;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75199\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75356_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75356(__global int *global_failure, int8_t clBase_48690, int64_t m_62289, int64_t conc_tmp_62375, int64_t inf_66341, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_82186, __global unsigned char *mem_82188, __global unsigned char *mem_82190)\n{\n    #define segmap_tblock_sizze_75350 (do_DBSCAN_doublezisegmap_75356zisegmap_tblock_sizze_75350)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84030;\n    int32_t tblock_sizze_84033;\n    int32_t wave_sizze_84032;\n    int32_t block_id_84031;\n    int32_t global_tid_84029;\n    int64_t phys_tid_75356;\n    int64_t global_tid_84034;\n    int64_t slice_84035;\n    int64_t gtid_75355;\n    int64_t remnant_84036;\n    \n    local_tid_84030 = get_local_id(0);\n    tblock_sizze_84033 = get_local_size(0);\n    wave_sizze_84032 = LOCKSTEP_WIDTH;\n    block_id_84031 = get_tblock_id(0);\n    global_tid_84029 = block_id_84031 * tblock_sizze_84033 + local_tid_84030;\n    phys_tid_75356 = sext_i32_i64(global_tid_84029);\n    global_tid_84034 = sext_i32_i64(block_id_84031) * segmap_",
                                    "tblock_sizze_75350 + sext_i32_i64(local_tid_84030);\n    slice_84035 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;\n    gtid_75355 = global_tid_84034;\n    remnant_84036 = global_tid_84034 - gtid_75355;\n    if (slt64(gtid_75355, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344)) {\n        int64_t slice_77947;\n        bool index_concat_cmp_77950;\n        double index_concat_branch_77958;\n        double index_concat_branch_77946;\n        double zt_res_75359;\n        double zt_res_75360;\n        double zs_res_75361;\n        double zs_res_75362;\n        double d_haversine_res_75363;\n        double d_haversine_res_75364;\n        double cos_res_75365;\n        \n        slice_77947 = inf_66341 + gtid_75355;\n        index_concat_cmp_77950 = sle64(conc_tmp_62375, slice_77947);\n        if (index_concat_cmp_77950) {\n            int64_t index_concat_i_77951;\n            double index_concat_77952;\n            \n            index_concat_i_77951 = sub64(slice_77947, conc_tmp_62375);\n            index_concat_77952 = ((__global double *) ext_mem_82066)[index_concat_i_77951];\n            index_concat_branch_77958 = index_concat_77952;\n        } else {\n            bool index_concat_cmp_77953;\n            double index_concat_branch_77957;\n            \n            index_concat_cmp_77953 = sle64(m_62289, slice_77947);\n            if (index_concat_cmp_77953) {\n                int64_t index_concat_i_77954;\n                double index_concat_77955;\n                \n                index_concat_i_77954 = sub64(slice_77947, m_62289);\n                index_concat_77955 = ((__global double *) mem_82048)[index_concat_i_77954];\n                index_concat_branch_77957 = index_concat_77955;\n            } else {\n                double index_concat_77956 = ((__global double *) mem_82081)[slice_77947];\n                \n                index_concat_branch_77957 = index_concat_77956;\n            }\n            index_concat_branch_77958 = index_concat_branch_77957;\n        }\n        if (index_concat_cmp_77950) {\n      ", "      int64_t index_concat_i_77939;\n            double index_concat_77940;\n            \n            index_concat_i_77939 = sub64(slice_77947, conc_tmp_62375);\n            index_concat_77940 = ((__global double *) ext_mem_82065)[index_concat_i_77939];\n            index_concat_branch_77946 = index_concat_77940;\n        } else {\n            bool index_concat_cmp_77941;\n            double index_concat_branch_77945;\n            \n            index_concat_cmp_77941 = sle64(m_62289, slice_77947);\n            if (index_concat_cmp_77941) {\n                int64_t index_concat_i_77942;\n                double index_concat_77943;\n                \n                index_concat_i_77942 = sub64(slice_77947, m_62289);\n                index_concat_77943 = ((__global double *) mem_82046)[index_concat_i_77942];\n                index_concat_branch_77945 = index_concat_77943;\n            } else {\n                double index_concat_77944 = ((__global double *) mem_82079)[slice_77947];\n                \n                index_concat_branch_77945 = index_concat_77944;\n            }\n            index_concat_branch_77946 = index_concat_branch_77945;\n        }\n        zt_res_75359 = 3.141592653589793 * index_concat_branch_77958;\n        zt_res_75360 = 3.141592653589793 * index_concat_branch_77946;\n        zs_res_75361 = zt_res_75359 / 180.0;\n        zs_res_75362 = zt_res_75360 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_75363 = index_concat_branch_77958;\n        } else {\n            d_haversine_res_75363 = zs_res_75361;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_75364 = index_concat_branch_77946;\n        } else {\n            d_haversine_res_75364 = zs_res_75362;\n        }\n        cos_res_75365 = futrts_cos64(d_haversine_res_75363);\n        ((__global double *) mem_82186)[gtid_75355] = d_haversine_res_75363;\n        ((__global double *) mem_82188)[gtid_75355] = d_haversine_res_75364;\n        ((__global double *) mem_82190)[gt", "id_75355] = cos_res_75365;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75350\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75377_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75377(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t inf_66341, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, unsigned char x_81841_bits, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_82186, __global unsigned char *mem_82188, __global unsigned char *mem_82190, __global unsigned char *mem_82193)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segmap_tblock_sizze_75372 (do_DBSCAN_doublezisegmap_75377zisegmap_tblock_sizze_75372)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84039;\n    int32_t tblock_sizze_84042;\n    int32_t wave_sizze_84041;\n    int32_t block_id_84040;\n    int32_t global_tid_84038;\n    int64_t phys_tid_75377;\n    int64_t global_tid_84043;\n    int64_t slice_84044;\n    int64_t slice_84045;\n    int64_t gtid_75375;\n    int64_t remnant_84046;\n    int64_t gtid_75376;\n    int64_t remnant_84047;\n    \n    local_tid_84039 = get_local_id(0);\n    tblock_sizze_84042 = get_local_size(0);\n    wave_sizze_84041 = LOCKSTEP_WIDTH;\n    block_id_84040 = get_tblock_id(0);\n    global_tid_84038 = block_id_84040 * tblock_sizze_84042 + local_tid_84039;\n    phys_tid_75377 = sext_i32_i64(global_tid_84038);\n    global_tid_84043 = sext_i32_i64(block_id_84040) * segmap_tblock_sizze_75372 + sext_i32_i64(local_tid_84039);\n    slice_84044 = conc_tmp_62382;\n    slice_84045 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * slice_84044;\n    gtid_75375 = squot64(global_tid_84043, slice_84044);\n    remnant_84046 = global_tid_84043 - gtid_7",
                                    "5375 * slice_84044;\n    gtid_75376 = remnant_84046;\n    remnant_84047 = remnant_84046 - gtid_75376;\n    if (slt64(gtid_75375, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344) && slt64(gtid_75376, conc_tmp_62382)) {\n        int64_t index_primexp_77934;\n        bool index_concat_cmp_77924;\n        double index_concat_branch_77932;\n        double index_concat_branch_77920;\n        bool index_concat_cmp_77898;\n        double index_concat_branch_77906;\n        double index_concat_branch_77895;\n        bool cond_75387;\n        double d_haversine_res_75381;\n        double d_haversine_res_75382;\n        double cos_res_75383;\n        double dist_res_75388;\n        bool zlze_res_75421;\n        bool x_75422;\n        bool y_75423;\n        bool lifted_lambda_res_75424;\n        \n        index_primexp_77934 = add64(inf_66341, gtid_75375);\n        index_concat_cmp_77924 = sle64(conc_tmp_62375, index_primexp_77934);\n        if (index_concat_cmp_77924) {\n            int64_t index_concat_i_77925;\n            double index_concat_77926;\n            \n            index_concat_i_77925 = sub64(index_primexp_77934, conc_tmp_62375);\n            index_concat_77926 = ((__global double *) ext_mem_82066)[index_concat_i_77925];\n            index_concat_branch_77932 = index_concat_77926;\n        } else {\n            bool index_concat_cmp_77927;\n            double index_concat_branch_77931;\n            \n            index_concat_cmp_77927 = sle64(m_62289, index_primexp_77934);\n            if (index_concat_cmp_77927) {\n                int64_t index_concat_i_77928;\n                double index_concat_77929;\n                \n                index_concat_i_77928 = sub64(index_primexp_77934, m_62289);\n                index_concat_77929 = ((__global double *) mem_82048)[index_concat_i_77928];\n                index_concat_branch_77931 = index_concat_77929;\n            } else {\n                double index_concat_77930 = ((__global double *) mem_82081)[index_primexp_77934];\n                \n                index_con", "cat_branch_77931 = index_concat_77930;\n            }\n            index_concat_branch_77932 = index_concat_branch_77931;\n        }\n        if (index_concat_cmp_77924) {\n            int64_t index_concat_i_77913;\n            double index_concat_77914;\n            \n            index_concat_i_77913 = sub64(index_primexp_77934, conc_tmp_62375);\n            index_concat_77914 = ((__global double *) ext_mem_82065)[index_concat_i_77913];\n            index_concat_branch_77920 = index_concat_77914;\n        } else {\n            bool index_concat_cmp_77915;\n            double index_concat_branch_77919;\n            \n            index_concat_cmp_77915 = sle64(m_62289, index_primexp_77934);\n            if (index_concat_cmp_77915) {\n                int64_t index_concat_i_77916;\n                double index_concat_77917;\n                \n                index_concat_i_77916 = sub64(index_primexp_77934, m_62289);\n                index_concat_77917 = ((__global double *) mem_82046)[index_concat_i_77916];\n                index_concat_branch_77919 = index_concat_77917;\n            } else {\n                double index_concat_77918 = ((__global double *) mem_82079)[index_primexp_77934];\n                \n                index_concat_branch_77919 = index_concat_77918;\n            }\n            index_concat_branch_77920 = index_concat_branch_77919;\n        }\n        index_concat_cmp_77898 = sle64(conc_tmp_62375, gtid_75376);\n        if (index_concat_cmp_77898) {\n            int64_t index_concat_i_77899;\n            double index_concat_77900;\n            \n            index_concat_i_77899 = sub64(gtid_75376, conc_tmp_62375);\n            index_concat_77900 = ((__global double *) ext_mem_82066)[index_concat_i_77899];\n            index_concat_branch_77906 = index_concat_77900;\n        } else {\n            bool index_concat_cmp_77901;\n            double index_concat_branch_77905;\n            \n            index_concat_cmp_77901 = sle64(m_62289, gtid_75376);\n            if (index_concat_cmp_77901) {", "\n                int64_t index_concat_i_77902;\n                double index_concat_77903;\n                \n                index_concat_i_77902 = sub64(gtid_75376, m_62289);\n                index_concat_77903 = ((__global double *) mem_82048)[index_concat_i_77902];\n                index_concat_branch_77905 = index_concat_77903;\n            } else {\n                double index_concat_77904 = ((__global double *) mem_82081)[gtid_75376];\n                \n                index_concat_branch_77905 = index_concat_77904;\n            }\n            index_concat_branch_77906 = index_concat_branch_77905;\n        }\n        if (index_concat_cmp_77898) {\n            int64_t index_concat_i_77888;\n            double index_concat_77889;\n            \n            index_concat_i_77888 = sub64(gtid_75376, conc_tmp_62375);\n            index_concat_77889 = ((__global double *) ext_mem_82065)[index_concat_i_77888];\n            index_concat_branch_77895 = index_concat_77889;\n        } else {\n            bool index_concat_cmp_77890;\n            double index_concat_branch_77894;\n            \n            index_concat_cmp_77890 = sle64(m_62289, gtid_75376);\n            if (index_concat_cmp_77890) {\n                int64_t index_concat_i_77891;\n                double index_concat_77892;\n                \n                index_concat_i_77891 = sub64(gtid_75376, m_62289);\n                index_concat_77892 = ((__global double *) mem_82046)[index_concat_i_77891];\n                index_concat_branch_77894 = index_concat_77892;\n            } else {\n                double index_concat_77893 = ((__global double *) mem_82079)[gtid_75376];\n                \n                index_concat_branch_77894 = index_concat_77893;\n            }\n            index_concat_branch_77895 = index_concat_branch_77894;\n        }\n        cond_75387 = index_primexp_77934 == gtid_75376;\n        if (x_81841) {\n            double x_81834 = ((__global double *) mem_82186)[gtid_75375];\n            \n            d_haversine_res_75381",
                                    " = x_81834;\n        } else {\n            d_haversine_res_75381 = 0.0;\n        }\n        if (x_81841) {\n            double x_81836 = ((__global double *) mem_82188)[gtid_75375];\n            \n            d_haversine_res_75382 = x_81836;\n        } else {\n            d_haversine_res_75382 = 0.0;\n        }\n        if (x_81841) {\n            double x_81838 = ((__global double *) mem_82190)[gtid_75375];\n            \n            cos_res_75383 = x_81838;\n        } else {\n            cos_res_75383 = 0.0;\n        }\n        if (clBase_48691 == (int8_t) 0) {\n            bool zeze_res_75389;\n            double d_euclidean_res_75390;\n            \n            zeze_res_75389 = index_concat_branch_77932 == index_concat_branch_77906;\n            if (zeze_res_75389) {\n                double zm_res_75391;\n                double abs_res_75392;\n                \n                zm_res_75391 = index_concat_branch_77920 - index_concat_branch_77895;\n                abs_res_75392 = fabs64(zm_res_75391);\n                d_euclidean_res_75390 = abs_res_75392;\n            } else {\n                bool zeze_res_75393;\n                double d_euclidean_res_f_res_75394;\n                \n                zeze_res_75393 = index_concat_branch_77920 == index_concat_branch_77895;\n                if (zeze_res_75393) {\n                    double zm_res_75395;\n                    double abs_res_75396;\n                    \n                    zm_res_75395 = index_concat_branch_77932 - index_concat_branch_77906;\n                    abs_res_75396 = fabs64(zm_res_75395);\n                    d_euclidean_res_f_res_75394 = abs_res_75396;\n                } else {\n                    double zm_res_75397;\n                    double zm_res_75398;\n                    double hypot_res_75399;\n                    \n                    zm_res_75397 = index_concat_branch_77920 - index_concat_branch_77895;\n                    zm_res_75398 = index_concat_branch_77932 - index_concat_branch_77906;\n                    hypot_res_7", "5399 = futrts_hypot64(zm_res_75398, zm_res_75397);\n                    d_euclidean_res_f_res_75394 = hypot_res_75399;\n                }\n                d_euclidean_res_75390 = d_euclidean_res_f_res_75394;\n            }\n            dist_res_75388 = d_euclidean_res_75390;\n        } else {\n            double d_haversine_res_75400;\n            double d_haversine_res_75401;\n            double zm_res_75406;\n            double cos_res_75407;\n            double zm_res_75408;\n            double cos_res_75409;\n            double zt_res_75410;\n            double zm_res_75411;\n            double zm_res_75412;\n            double zt_res_75413;\n            double zp_res_75414;\n            double zs_res_75415;\n            double min_res_75416;\n            double zt_res_75417;\n            double zm_res_75418;\n            double acos_res_75419;\n            double zt_res_75420;\n            \n            if (clBase_48690 == (int8_t) 1) {\n                d_haversine_res_75400 = index_concat_branch_77906;\n                d_haversine_res_75401 = index_concat_branch_77895;\n            } else {\n                double zt_res_75402;\n                double zs_res_75403;\n                double zt_res_75404;\n                double zs_res_75405;\n                \n                zt_res_75402 = 3.141592653589793 * index_concat_branch_77906;\n                zs_res_75403 = zt_res_75402 / 180.0;\n                zt_res_75404 = 3.141592653589793 * index_concat_branch_77895;\n                zs_res_75405 = zt_res_75404 / 180.0;\n                d_haversine_res_75400 = zs_res_75403;\n                d_haversine_res_75401 = zs_res_75405;\n            }\n            zm_res_75406 = d_haversine_res_75381 - d_haversine_res_75400;\n            cos_res_75407 = futrts_cos64(zm_res_75406);\n            zm_res_75408 = 1.0 - cos_res_75407;\n            cos_res_75409 = futrts_cos64(d_haversine_res_75400);\n            zt_res_75410 = cos_res_75383 * cos_res_75409;\n            zm_res_75411 = d_haversine_res_75382 - d_haversine_r", "es_75401;\n            zm_res_75412 = 1.0 - zm_res_75411;\n            zt_res_75413 = zt_res_75410 * zm_res_75412;\n            zp_res_75414 = zm_res_75408 + zt_res_75413;\n            zs_res_75415 = zp_res_75414 / 2.0;\n            min_res_75416 = fmin64(1.0, zs_res_75415);\n            zt_res_75417 = 2.0 * min_res_75416;\n            zm_res_75418 = 1.0 - zt_res_75417;\n            acos_res_75419 = futrts_acos64(zm_res_75418);\n            zt_res_75420 = clBase_48698 * acos_res_75419;\n            dist_res_75388 = zt_res_75420;\n        }\n        zlze_res_75421 = dist_res_75388 <= clBase_48692;\n        x_75422 = !cond_75387;\n        y_75423 = zlze_res_75421 && x_75422;\n        lifted_lambda_res_75424 = cond_75387 || y_75423;\n        ((__global bool *) mem_82193)[gtid_75375 * conc_tmp_62382 + gtid_75376] = lifted_lambda_res_75424;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75372\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75435_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75435(__global int *global_failure, int64_t conc_tmp_62382, int64_t inf_66341, int64_t dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, int64_t m_66453, int64_t num_tblocks_75440, int32_t virt_num_tblocks_84192, __global unsigned char *mem_82203, __global unsigned char *mem_82205, __global unsigned char *mem_82207, __global unsigned char *mem_82209)\n{\n    #define segmap_tblock_sizze_75438 (do_DBSCAN_doublezisegmap_75435zisegmap_tblock_sizze_75438)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84194;\n    int32_t tblock_sizze_84197;\n    int32_t wave_sizze_84196;\n    int32_t block_id_84195;\n    int32_t global_tid_84193;\n    int64_t phys_tid_75435;\n    int32_t phys_tblock_id_84198;\n    int32_t iterations_84199;\n    \n    local_tid_84194 = get_local_id(0);\n    tblock_sizze_84197 = get_local_size(0);\n    wave_sizze_84196 = LOCKSTEP_WIDTH;\n    block_id_84195 = get_tblock_id(0);\n    global_tid_84193 = block_id_84195 * tblock_sizze_84197 + local_tid_84194;\n  ",
                                    "  phys_tid_75435 = sext_i32_i64(global_tid_84193);\n    phys_tblock_id_84198 = get_tblock_id(0);\n    iterations_84199 = sdiv_up32(virt_num_tblocks_84192 - phys_tblock_id_84198, sext_i64_i32(num_tblocks_75440));\n    for (int32_t i_84200 = 0; i_84200 < iterations_84199; i_84200++) {\n        int32_t virt_tblock_id_84201;\n        int64_t global_tid_84202;\n        int64_t slice_84203;\n        int64_t write_i_75434;\n        int64_t remnant_84204;\n        \n        virt_tblock_id_84201 = phys_tblock_id_84198 + i_84200 * sext_i64_i32(num_tblocks_75440);\n        global_tid_84202 = sext_i32_i64(virt_tblock_id_84201) * segmap_tblock_sizze_75438 + sext_i32_i64(local_tid_84194);\n        slice_84203 = dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345;\n        write_i_75434 = global_tid_84202;\n        remnant_84204 = global_tid_84202 - write_i_75434;\n        if (slt64(write_i_75434, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345)) {\n            int64_t eta_p_66471;\n            int64_t new_index_77869;\n            int64_t index_primexp_77880;\n            int64_t binop_y_77875;\n            int64_t new_index_77876;\n            bool cond_66475;\n            int64_t lifted_lambda_res_66476;\n            \n            eta_p_66471 = ((__global int64_t *) mem_82205)[write_i_75434];\n            new_index_77869 = squot64(write_i_75434, conc_tmp_62382);\n            index_primexp_77880 = add64(inf_66341, new_index_77869);\n            binop_y_77875 = conc_tmp_62382 * new_index_77869;\n            new_index_77876 = write_i_75434 - binop_y_77875;\n            cond_66475 = eta_p_66471 == (int64_t) 1;\n            if (cond_66475) {\n                int64_t eta_p_66472;\n                int64_t lifted_lambda_res_t_res_66477;\n                \n                eta_p_66472 = ((__global int64_t *) mem_82203)[write_i_75434];\n                lifted_lambda_res_t_res_66477 = sub64(eta_p_66472, (int64_t) 1);\n                lifted_lambda_res_66476 = lifted_lambda_res_t_res_66477;\n            } els", "e {\n                lifted_lambda_res_66476 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66476) && slt64(lifted_lambda_res_66476, m_66453)) {\n                ((__global int64_t *) mem_82209)[lifted_lambda_res_66476] = index_primexp_77880;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66476) && slt64(lifted_lambda_res_66476, m_66453)) {\n                ((__global int64_t *) mem_82207)[lifted_lambda_res_66476] = new_index_77876;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75438\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75467_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75467(__global int *global_failure, int64_t conc_tmp_62382, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75472, int32_t virt_num_tblocks_84489, __global unsigned char *mem_82224, __global unsigned char *mem_82225)\n{\n    #define segmap_tblock_sizze_75470 (do_DBSCAN_doublezisegmap_75467zisegmap_tblock_sizze_75470)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84491;\n    int32_t tblock_sizze_84494;\n    int32_t wave_sizze_84493;\n    int32_t block_id_84492;\n    int32_t global_tid_84490;\n    int64_t phys_tid_75467;\n    int32_t phys_tblock_id_84495;\n    int32_t iterations_84496;\n    \n    local_tid_84491 = get_local_id(0);\n    tblock_sizze_84494 = get_local_size(0);\n    wave_sizze_84493 = LOCKSTEP_WIDTH;\n    block_id_84492 = get_tblock_id(0);\n    global_tid_84490 = block_id_84492 * tblock_sizze_84494 + local_tid_84491;\n    phys_tid_75467 = sext_i32_i64(global_tid_84490);\n    phys_tblock_id_84495 = get_tblock_id(0);\n    iterations_84496 = sdiv_up32(virt_num_tblocks_84489 - phys_tblock_id_84495, sext_i64_i32(num_tblocks_75472));\n    for (int32_t i_84497 = 0; i_84497 < iterations_84496; i_84497++) {\n        int32_t virt_tblock_id_84498;\n        int64_t global_tid_84499;\n        int64_t slice_84500;\n        int6", "4_t write_i_75466;\n        int64_t remnant_84501;\n        \n        virt_tblock_id_84498 = phys_tblock_id_84495 + i_84497 * sext_i64_i32(num_tblocks_75472);\n        global_tid_84499 = sext_i32_i64(virt_tblock_id_84498) * segmap_tblock_sizze_75470 + sext_i32_i64(local_tid_84491);\n        slice_84500 = conc_tmp_62382;\n        write_i_75466 = global_tid_84499;\n        remnant_84501 = global_tid_84499 - write_i_75466;\n        if (slt64(write_i_75466, conc_tmp_62382)) {\n            int64_t zv_lhs_66509;\n            int64_t tmp_66510;\n            bool cond_66512;\n            int64_t lifted_lambda_res_66513;\n            \n            zv_lhs_66509 = add64((int64_t) -1, write_i_75466);\n            tmp_66510 = smod64(zv_lhs_66509, conc_tmp_62382);\n            cond_66512 = write_i_75466 == (int64_t) 0;\n            if (cond_66512) {\n                lifted_lambda_res_66513 = (int64_t) 0;\n            } else {\n                int64_t lifted_lambda_res_66511 = ((__global int64_t *) mem_82224)[tmp_66510];\n                \n                lifted_lambda_res_66513 = lifted_lambda_res_66511;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_66513) && slt64(lifted_lambda_res_66513, mk_adjacency_list_res_66334)) {\n                ((__global bool *) mem_82225)[lifted_lambda_res_66513] = 1;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75470\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75501_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75501(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_segments_66572, int64_t num_tblocks_75506, int32_t virt_num_tblocks_84915, __global unsigned char *mem_82231, __global unsigned char *mem_82232, __global unsigned char *mem_82239, __global unsigned char *mem_82241)\n{\n    #define segmap_tblock_sizze_75504 (do_DBSCAN_doublezisegmap_75501zisegmap_tblock_sizze_75504)\n    if (*global_failure >= 0)\n        return;\n",
                                    "    \n    int32_t local_tid_84917;\n    int32_t tblock_sizze_84920;\n    int32_t wave_sizze_84919;\n    int32_t block_id_84918;\n    int32_t global_tid_84916;\n    int64_t phys_tid_75501;\n    int32_t phys_tblock_id_84921;\n    int32_t iterations_84922;\n    \n    local_tid_84917 = get_local_id(0);\n    tblock_sizze_84920 = get_local_size(0);\n    wave_sizze_84919 = LOCKSTEP_WIDTH;\n    block_id_84918 = get_tblock_id(0);\n    global_tid_84916 = block_id_84918 * tblock_sizze_84920 + local_tid_84917;\n    phys_tid_75501 = sext_i32_i64(global_tid_84916);\n    phys_tblock_id_84921 = get_tblock_id(0);\n    iterations_84922 = sdiv_up32(virt_num_tblocks_84915 - phys_tblock_id_84921, sext_i64_i32(num_tblocks_75506));\n    for (int32_t i_84923 = 0; i_84923 < iterations_84922; i_84923++) {\n        int32_t virt_tblock_id_84924;\n        int64_t global_tid_84925;\n        int64_t slice_84926;\n        int64_t write_i_75500;\n        int64_t remnant_84927;\n        \n        virt_tblock_id_84924 = phys_tblock_id_84921 + i_84923 * sext_i64_i32(num_tblocks_75506);\n        global_tid_84925 = sext_i32_i64(virt_tblock_id_84924) * segmap_tblock_sizze_75504 + sext_i32_i64(local_tid_84917);\n        slice_84926 = mk_adjacency_list_res_66334;\n        write_i_75500 = global_tid_84925;\n        remnant_84927 = global_tid_84925 - write_i_75500;\n        if (slt64(write_i_75500, mk_adjacency_list_res_66334)) {\n            bool eta_p_66576;\n            int64_t write_value_66577;\n            int64_t lifted_index_res_66578;\n            \n            eta_p_66576 = ((__global bool *) mem_82232)[write_i_75500];\n            write_value_66577 = ((__global int64_t *) mem_82239)[write_i_75500];\n            if (eta_p_66576) {\n                int64_t eta_p_66575;\n                int64_t lifted_index_res_t_res_66579;\n                \n                eta_p_66575 = ((__global int64_t *) mem_82231)[write_i_75500];\n                lifted_index_res_t_res_66579 = sub64(eta_p_66575, (int64_t) 1);\n                lifted_index_res_66578 = l", "ifted_index_res_t_res_66579;\n            } else {\n                lifted_index_res_66578 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_index_res_66578) && slt64(lifted_index_res_66578, num_segments_66572)) {\n                ((__global int64_t *) mem_82241)[lifted_index_res_66578] = write_value_66577;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75504\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75536_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75536(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_segments_66639, int64_t num_tblocks_75541, int32_t virt_num_tblocks_85130, __global unsigned char *mem_82253, __global unsigned char *mem_82256, __global unsigned char *mem_82257, __global unsigned char *mem_82259)\n{\n    #define segmap_tblock_sizze_75539 (do_DBSCAN_doublezisegmap_75536zisegmap_tblock_sizze_75539)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85132;\n    int32_t tblock_sizze_85135;\n    int32_t wave_sizze_85134;\n    int32_t block_id_85133;\n    int32_t global_tid_85131;\n    int64_t phys_tid_75536;\n    int32_t phys_tblock_id_85136;\n    int32_t iterations_85137;\n    \n    local_tid_85132 = get_local_id(0);\n    tblock_sizze_85135 = get_local_size(0);\n    wave_sizze_85134 = LOCKSTEP_WIDTH;\n    block_id_85133 = get_tblock_id(0);\n    global_tid_85131 = block_id_85133 * tblock_sizze_85135 + local_tid_85132;\n    phys_tid_75536 = sext_i32_i64(global_tid_85131);\n    phys_tblock_id_85136 = get_tblock_id(0);\n    iterations_85137 = sdiv_up32(virt_num_tblocks_85130 - phys_tblock_id_85136, sext_i64_i32(num_tblocks_75541));\n    for (int32_t i_85138 = 0; i_85138 < iterations_85137; i_85138++) {\n        int32_t virt_tblock_id_85139;\n        int64_t global_tid_85140;\n        int64_t slice_85141;\n        int64_t write_i_75535;\n        int64_t remnant_85142;\n        \n        virt_tblock_id_85139 ", "= phys_tblock_id_85136 + i_85138 * sext_i64_i32(num_tblocks_75541);\n        global_tid_85140 = sext_i32_i64(virt_tblock_id_85139) * segmap_tblock_sizze_75539 + sext_i32_i64(local_tid_85132);\n        slice_85141 = mk_adjacency_list_res_66334;\n        write_i_75535 = global_tid_85140;\n        remnant_85142 = global_tid_85140 - write_i_75535;\n        if (slt64(write_i_75535, mk_adjacency_list_res_66334)) {\n            bool eta_p_66643;\n            int64_t write_value_66644;\n            int64_t lifted_index_res_66645;\n            \n            eta_p_66643 = ((__global bool *) mem_82257)[write_i_75535];\n            write_value_66644 = ((__global int64_t *) mem_82253)[write_i_75535];\n            if (eta_p_66643) {\n                int64_t eta_p_66642;\n                int64_t lifted_index_res_t_res_66646;\n                \n                eta_p_66642 = ((__global int64_t *) mem_82256)[write_i_75535];\n                lifted_index_res_t_res_66646 = sub64(eta_p_66642, (int64_t) 1);\n                lifted_index_res_66645 = lifted_index_res_t_res_66646;\n            } else {\n                lifted_index_res_66645 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_index_res_66645) && slt64(lifted_index_res_66645, num_segments_66639)) {\n                ((__global int64_t *) mem_82259)[lifted_index_res_66645] = write_value_66644;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75539\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75750_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75750(__global int *global_failure, int8_t clBase_48690, int64_t m_62289, int64_t conc_tmp_62375, int64_t inf_62706, int64_t j_m_i_62709, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_82095, __g",
                                    "lobal unsigned char *mem_82097, __global unsigned char *mem_82099)\n{\n    #define segmap_tblock_sizze_75744 (do_DBSCAN_doublezisegmap_75750zisegmap_tblock_sizze_75744)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85168;\n    int32_t tblock_sizze_85171;\n    int32_t wave_sizze_85170;\n    int32_t block_id_85169;\n    int32_t global_tid_85167;\n    int64_t phys_tid_75750;\n    int64_t global_tid_85172;\n    int64_t slice_85173;\n    int64_t gtid_75749;\n    int64_t remnant_85174;\n    \n    local_tid_85168 = get_local_id(0);\n    tblock_sizze_85171 = get_local_size(0);\n    wave_sizze_85170 = LOCKSTEP_WIDTH;\n    block_id_85169 = get_tblock_id(0);\n    global_tid_85167 = block_id_85169 * tblock_sizze_85171 + local_tid_85168;\n    phys_tid_75750 = sext_i32_i64(global_tid_85167);\n    global_tid_85172 = sext_i32_i64(block_id_85169) * segmap_tblock_sizze_75744 + sext_i32_i64(local_tid_85168);\n    slice_85173 = j_m_i_62709;\n    gtid_75749 = global_tid_85172;\n    remnant_85174 = global_tid_85172 - gtid_75749;\n    if (slt64(gtid_75749, j_m_i_62709)) {\n        int64_t slice_78043;\n        bool index_concat_cmp_78046;\n        double index_concat_branch_78054;\n        double index_concat_branch_78042;\n        double zt_res_75753;\n        double zt_res_75754;\n        double zs_res_75755;\n        double zs_res_75756;\n        double d_haversine_res_75757;\n        double d_haversine_res_75758;\n        double cos_res_75759;\n        \n        slice_78043 = inf_62706 + gtid_75749;\n        index_concat_cmp_78046 = sle64(conc_tmp_62375, slice_78043);\n        if (index_concat_cmp_78046) {\n            int64_t index_concat_i_78047;\n            double index_concat_78048;\n            \n            index_concat_i_78047 = sub64(slice_78043, conc_tmp_62375);\n            index_concat_78048 = ((__global double *) ext_mem_82066)[index_concat_i_78047];\n            index_concat_branch_78054 = index_concat_78048;\n        } else {\n            bool index_concat_cmp_78049;\n            double in", "dex_concat_branch_78053;\n            \n            index_concat_cmp_78049 = sle64(m_62289, slice_78043);\n            if (index_concat_cmp_78049) {\n                int64_t index_concat_i_78050;\n                double index_concat_78051;\n                \n                index_concat_i_78050 = sub64(slice_78043, m_62289);\n                index_concat_78051 = ((__global double *) mem_82048)[index_concat_i_78050];\n                index_concat_branch_78053 = index_concat_78051;\n            } else {\n                double index_concat_78052 = ((__global double *) mem_82081)[slice_78043];\n                \n                index_concat_branch_78053 = index_concat_78052;\n            }\n            index_concat_branch_78054 = index_concat_branch_78053;\n        }\n        if (index_concat_cmp_78046) {\n            int64_t index_concat_i_78035;\n            double index_concat_78036;\n            \n            index_concat_i_78035 = sub64(slice_78043, conc_tmp_62375);\n            index_concat_78036 = ((__global double *) ext_mem_82065)[index_concat_i_78035];\n            index_concat_branch_78042 = index_concat_78036;\n        } else {\n            bool index_concat_cmp_78037;\n            double index_concat_branch_78041;\n            \n            index_concat_cmp_78037 = sle64(m_62289, slice_78043);\n            if (index_concat_cmp_78037) {\n                int64_t index_concat_i_78038;\n                double index_concat_78039;\n                \n                index_concat_i_78038 = sub64(slice_78043, m_62289);\n                index_concat_78039 = ((__global double *) mem_82046)[index_concat_i_78038];\n                index_concat_branch_78041 = index_concat_78039;\n            } else {\n                double index_concat_78040 = ((__global double *) mem_82079)[slice_78043];\n                \n                index_concat_branch_78041 = index_concat_78040;\n            }\n            index_concat_branch_78042 = index_concat_branch_78041;\n        }\n        zt_res_75753 = 3.141592653589793 * index", "_concat_branch_78054;\n        zt_res_75754 = 3.141592653589793 * index_concat_branch_78042;\n        zs_res_75755 = zt_res_75753 / 180.0;\n        zs_res_75756 = zt_res_75754 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_75757 = index_concat_branch_78054;\n        } else {\n            d_haversine_res_75757 = zs_res_75755;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_75758 = index_concat_branch_78042;\n        } else {\n            d_haversine_res_75758 = zs_res_75756;\n        }\n        cos_res_75759 = futrts_cos64(d_haversine_res_75757);\n        ((__global double *) mem_82095)[gtid_75749] = d_haversine_res_75757;\n        ((__global double *) mem_82097)[gtid_75749] = d_haversine_res_75758;\n        ((__global double *) mem_82099)[gtid_75749] = cos_res_75759;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75744\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75854_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75854(__global int *global_failure, int64_t conc_tmp_62382, __global unsigned char *mem_82266, __global unsigned char *mem_82269)\n{\n    #define segmap_tblock_sizze_75850 (do_DBSCAN_doublezisegmap_75854zisegmap_tblock_sizze_75850)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85387;\n    int32_t tblock_sizze_85390;\n    int32_t wave_sizze_85389;\n    int32_t block_id_85388;\n    int32_t global_tid_85386;\n    int64_t phys_tid_75854;\n    int64_t global_tid_85391;\n    int64_t slice_85392;\n    int64_t gtid_75853;\n    int64_t remnant_85393;\n    \n    local_tid_85387 = get_local_id(0);\n    tblock_sizze_85390 = get_local_size(0);\n    wave_sizze_85389 = LOCKSTEP_WIDTH;\n    block_id_85388 = get_tblock_id(0);\n    global_tid_85386 = block_id_85388 * tblock_sizze_85390 + local_tid_85387;\n    phys_tid_75854 = sext_i32_i64(global_tid_85386);\n    global_tid_85391 = sext_i32_i64(block_id_85388) * segmap_tblock_sizze_75850 + sext_i32_i64(local_tid_85387);\n    slice_85392 = conc_tmp_62",
                                    "382;\n    gtid_75853 = global_tid_85391;\n    remnant_85393 = global_tid_85391 - gtid_75853;\n    if (slt64(gtid_75853, conc_tmp_62382)) {\n        int64_t zv_lhs_75856;\n        int64_t tmp_75857;\n        bool cond_75859;\n        int64_t lifted_lambda_res_75860;\n        \n        zv_lhs_75856 = add64((int64_t) -1, gtid_75853);\n        tmp_75857 = smod64(zv_lhs_75856, conc_tmp_62382);\n        cond_75859 = gtid_75853 == (int64_t) 0;\n        if (cond_75859) {\n            lifted_lambda_res_75860 = (int64_t) 0;\n        } else {\n            int64_t lifted_lambda_res_75858 = ((__global int64_t *) mem_82266)[tmp_75857];\n            \n            lifted_lambda_res_75860 = lifted_lambda_res_75858;\n        }\n        ((__global int64_t *) mem_82269)[gtid_75853] = lifted_lambda_res_75860;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75850\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75887_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75887(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t clProc_48705, int64_t conc_tmp_62382, __global unsigned char *ext_mem_82263, __global unsigned char *mem_82269, __global unsigned char *mem_82272)\n{\n    #define segmap_tblock_sizze_75883 (do_DBSCAN_doublezisegmap_75887zisegmap_tblock_sizze_75883)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85396;\n    int32_t tblock_sizze_85399;\n    int32_t wave_sizze_85398;\n    int32_t block_id_85397;\n    int32_t global_tid_85395;\n    int64_t phys_tid_75887;\n    int64_t global_tid_85400;\n    int64_t slice_85401;\n    int64_t gtid_75886;\n    int64_t remnant_85402;\n    \n    local_tid_85396 = get_local_id(0);\n    tblock_sizze_85399 = get_local_size(0);\n    wave_sizze_85398 = LOCKSTEP_WIDTH;\n    block_id_85397 = get_tblock_id(0);\n    global_tid_85395 = block_id_85397 * tblock_sizze_85399 + local_tid_85396;\n    phys_tid_75887 = sext_i32_i64(global_tid_85395);\n    global_tid_85400 = sext_i32_i64(block_id_85397) * segmap_tblo", "ck_sizze_75883 + sext_i32_i64(local_tid_85396);\n    slice_85401 = conc_tmp_62382;\n    gtid_75886 = global_tid_85400;\n    remnant_85402 = global_tid_85400 - gtid_75886;\n    if (slt64(gtid_75886, conc_tmp_62382)) {\n        int64_t eta_p_75888;\n        bool cond_75889;\n        bool cond_f_res_75890;\n        bool x_75891;\n        bool y_75892;\n        bool cond_75893;\n        int64_t lifted_lambda_res_75894;\n        int64_t lifted_lambda_res_75900;\n        \n        eta_p_75888 = ((__global int64_t *) ext_mem_82263)[gtid_75886];\n        cond_75889 = slt64(eta_p_75888, (int64_t) 0);\n        cond_f_res_75890 = sle64(conc_tmp_62382, eta_p_75888);\n        x_75891 = !cond_75889;\n        y_75892 = cond_f_res_75890 && x_75891;\n        cond_75893 = cond_75889 || y_75892;\n        if (cond_75893) {\n            lifted_lambda_res_75894 = (int64_t) -1;\n        } else {\n            bool x_75895;\n            bool y_75896;\n            bool bounds_check_75897;\n            bool index_certs_75898;\n            int64_t lifted_lambda_res_f_res_75899;\n            \n            x_75895 = sle64((int64_t) 0, eta_p_75888);\n            y_75896 = slt64(eta_p_75888, conc_tmp_62382);\n            bounds_check_75897 = x_75895 && y_75896;\n            if (!bounds_check_75897) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 23) == -1) {\n                        global_failure_args[0] = (int64_t) eta_p_75888;\n                        global_failure_args[1] = (int64_t) conc_tmp_62382;\n                        ;\n                    }\n                    return;\n                }\n            }\n            lifted_lambda_res_f_res_75899 = ((__global int64_t *) mem_82269)[eta_p_75888];\n            lifted_lambda_res_75894 = lifted_lambda_res_f_res_75899;\n        }\n        lifted_lambda_res_75900 = add64(clProc_48705, lifted_lambda_res_75894);\n        ((__global int64_t *) mem_82272)[gtid_75886] = lifted_lambda_res_75900;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblo", "ck_sizze_75883\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_75910_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_75910(__global int *global_failure, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t m_62843, int64_t num_tblocks_75915, int32_t virt_num_tblocks_85507, __global unsigned char *mem_82044, __global unsigned char *ext_mem_82064, __global unsigned char *mem_82077, __global unsigned char *mem_82272, __global unsigned char *mem_82275, __global unsigned char *mem_82277, __global unsigned char *mem_82279, __global unsigned char *mem_82281)\n{\n    #define segmap_tblock_sizze_75913 (do_DBSCAN_doublezisegmap_75910zisegmap_tblock_sizze_75913)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85509;\n    int32_t tblock_sizze_85512;\n    int32_t wave_sizze_85511;\n    int32_t block_id_85510;\n    int32_t global_tid_85508;\n    int64_t phys_tid_75910;\n    int32_t phys_tblock_id_85513;\n    int32_t iterations_85514;\n    \n    local_tid_85509 = get_local_id(0);\n    tblock_sizze_85512 = get_local_size(0);\n    wave_sizze_85511 = LOCKSTEP_WIDTH;\n    block_id_85510 = get_tblock_id(0);\n    global_tid_85508 = block_id_85510 * tblock_sizze_85512 + local_tid_85509;\n    phys_tid_75910 = sext_i32_i64(global_tid_85508);\n    phys_tblock_id_85513 = get_tblock_id(0);\n    iterations_85514 = sdiv_up32(virt_num_tblocks_85507 - phys_tblock_id_85513, sext_i64_i32(num_tblocks_75915));\n    for (int32_t i_85515 = 0; i_85515 < iterations_85514; i_85515++) {\n        int32_t virt_tblock_id_85516;\n        int64_t global_tid_85517;\n        int64_t slice_85518;\n        int64_t write_i_75909;\n        int64_t remnant_85519;\n        \n        virt_tblock_id_85516 = phys_tblock_id_85513 + i_85515 * sext_i64_i32(num_tblocks_75915);\n        global_tid_85517 = sext_i32_i64(virt_tblock_id_85516) * segmap_tblock_sizze_75913 + sext_i32_i64(local_tid_85509);\n        slice_85518 = conc_tmp_62382;\n        write_i_75909 = global_tid_85517;\n        remnant_85519 = global_tid_85",
                                    "517 - write_i_75909;\n        if (slt64(write_i_75909, conc_tmp_62382)) {\n            int64_t eta_p_64343;\n            int64_t write_value_64345;\n            bool index_concat_cmp_77838;\n            int64_t index_concat_branch_77846;\n            bool cond_64347;\n            int64_t lifted_lambda_res_64348;\n            \n            eta_p_64343 = ((__global int64_t *) mem_82277)[write_i_75909];\n            write_value_64345 = ((__global int64_t *) mem_82272)[write_i_75909];\n            index_concat_cmp_77838 = sle64(conc_tmp_62375, write_i_75909);\n            if (index_concat_cmp_77838) {\n                int64_t index_concat_i_77839;\n                int64_t index_concat_77840;\n                \n                index_concat_i_77839 = sub64(write_i_75909, conc_tmp_62375);\n                index_concat_77840 = ((__global int64_t *) ext_mem_82064)[index_concat_i_77839];\n                index_concat_branch_77846 = index_concat_77840;\n            } else {\n                bool index_concat_cmp_77841;\n                int64_t index_concat_branch_77845;\n                \n                index_concat_cmp_77841 = sle64(m_62289, write_i_75909);\n                if (index_concat_cmp_77841) {\n                    int64_t index_concat_i_77842;\n                    int64_t index_concat_77843;\n                    \n                    index_concat_i_77842 = sub64(write_i_75909, m_62289);\n                    index_concat_77843 = ((__global int64_t *) mem_82044)[index_concat_i_77842];\n                    index_concat_branch_77845 = index_concat_77843;\n                } else {\n                    int64_t index_concat_77844 = ((__global int64_t *) mem_82077)[write_i_75909];\n                    \n                    index_concat_branch_77845 = index_concat_77844;\n                }\n                index_concat_branch_77846 = index_concat_branch_77845;\n            }\n            cond_64347 = eta_p_64343 == (int64_t) 1;\n            if (cond_64347) {\n                int64_t eta_p_64344;\n                i", "nt64_t lifted_lambda_res_t_res_66678;\n                \n                eta_p_64344 = ((__global int64_t *) mem_82275)[write_i_75909];\n                lifted_lambda_res_t_res_66678 = sub64(eta_p_64344, (int64_t) 1);\n                lifted_lambda_res_64348 = lifted_lambda_res_t_res_66678;\n            } else {\n                lifted_lambda_res_64348 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64348) && slt64(lifted_lambda_res_64348, m_62843)) {\n                ((__global int64_t *) mem_82281)[lifted_lambda_res_64348] = write_value_64345;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64348) && slt64(lifted_lambda_res_64348, m_62843)) {\n                ((__global int64_t *) mem_82279)[lifted_lambda_res_64348] = index_concat_branch_77846;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_75913\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_76323_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_76323(__global int *global_failure, int64_t m_62843, int64_t m_62935, int64_t num_tblocks_76328, int32_t virt_num_tblocks_85781, __global unsigned char *mem_82279, __global unsigned char *mem_82281, __global unsigned char *ext_mem_82418, __global unsigned char *ext_mem_82419, __global unsigned char *mem_82421, __global unsigned char *mem_82423)\n{\n    #define segmap_tblock_sizze_76326 (do_DBSCAN_doublezisegmap_76323zisegmap_tblock_sizze_76326)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85783;\n    int32_t tblock_sizze_85786;\n    int32_t wave_sizze_85785;\n    int32_t block_id_85784;\n    int32_t global_tid_85782;\n    int64_t phys_tid_76323;\n    int32_t phys_tblock_id_85787;\n    int32_t iterations_85788;\n    \n    local_tid_85783 = get_local_id(0);\n    tblock_sizze_85786 = get_local_size(0);\n    wave_sizze_85785 = LOCKSTEP_WIDTH;\n    block_id_85784 = get_tblock_id(0);\n    global_tid_85782 = block_id_85784 * ", "tblock_sizze_85786 + local_tid_85783;\n    phys_tid_76323 = sext_i32_i64(global_tid_85782);\n    phys_tblock_id_85787 = get_tblock_id(0);\n    iterations_85788 = sdiv_up32(virt_num_tblocks_85781 - phys_tblock_id_85787, sext_i64_i32(num_tblocks_76328));\n    for (int32_t i_85789 = 0; i_85789 < iterations_85788; i_85789++) {\n        int32_t virt_tblock_id_85790;\n        int64_t global_tid_85791;\n        int64_t slice_85792;\n        int64_t write_i_76322;\n        int64_t remnant_85793;\n        \n        virt_tblock_id_85790 = phys_tblock_id_85787 + i_85789 * sext_i64_i32(num_tblocks_76328);\n        global_tid_85791 = sext_i32_i64(virt_tblock_id_85790) * segmap_tblock_sizze_76326 + sext_i32_i64(local_tid_85783);\n        slice_85792 = m_62843;\n        write_i_76322 = global_tid_85791;\n        remnant_85793 = global_tid_85791 - write_i_76322;\n        if (slt64(write_i_76322, m_62843)) {\n            int64_t eta_p_64289;\n            int64_t write_value_64291;\n            int64_t write_value_64292;\n            bool cond_64293;\n            int64_t lifted_lambda_res_64294;\n            \n            eta_p_64289 = ((__global int64_t *) ext_mem_82418)[write_i_76322];\n            write_value_64291 = ((__global int64_t *) mem_82281)[write_i_76322];\n            write_value_64292 = ((__global int64_t *) mem_82279)[write_i_76322];\n            cond_64293 = eta_p_64289 == (int64_t) 1;\n            if (cond_64293) {\n                int64_t eta_p_64290;\n                int64_t lifted_lambda_res_t_res_66683;\n                \n                eta_p_64290 = ((__global int64_t *) ext_mem_82419)[write_i_76322];\n                lifted_lambda_res_t_res_66683 = sub64(eta_p_64290, (int64_t) 1);\n                lifted_lambda_res_64294 = lifted_lambda_res_t_res_66683;\n            } else {\n                lifted_lambda_res_64294 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64294) && slt64(lifted_lambda_res_64294, m_62935)) {\n                ((__global int64_t *) mem_8242",
                                    "3)[lifted_lambda_res_64294] = write_value_64291;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64294) && slt64(lifted_lambda_res_64294, m_62935)) {\n                ((__global int64_t *) mem_82421)[lifted_lambda_res_64294] = write_value_64292;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_76326\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_76637_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_76637(__global int *global_failure, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t m_63000, int64_t num_tblocks_76642, int32_t virt_num_tblocks_86048, __global unsigned char *mem_82044, __global unsigned char *ext_mem_82064, __global unsigned char *mem_82077, __global unsigned char *ext_mem_82539, __global unsigned char *ext_mem_82540, __global unsigned char *ext_mem_82541, __global unsigned char *mem_82543, __global unsigned char *mem_82545)\n{\n    #define segmap_tblock_sizze_76640 (do_DBSCAN_doublezisegmap_76637zisegmap_tblock_sizze_76640)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86050;\n    int32_t tblock_sizze_86053;\n    int32_t wave_sizze_86052;\n    int32_t block_id_86051;\n    int32_t global_tid_86049;\n    int64_t phys_tid_76637;\n    int32_t phys_tblock_id_86054;\n    int32_t iterations_86055;\n    \n    local_tid_86050 = get_local_id(0);\n    tblock_sizze_86053 = get_local_size(0);\n    wave_sizze_86052 = LOCKSTEP_WIDTH;\n    block_id_86051 = get_tblock_id(0);\n    global_tid_86049 = block_id_86051 * tblock_sizze_86053 + local_tid_86050;\n    phys_tid_76637 = sext_i32_i64(global_tid_86049);\n    phys_tblock_id_86054 = get_tblock_id(0);\n    iterations_86055 = sdiv_up32(virt_num_tblocks_86048 - phys_tblock_id_86054, sext_i64_i32(num_tblocks_76642));\n    for (int32_t i_86056 = 0; i_86056 < iterations_86055; i_86056++) {\n        int32_t virt_tblock_id_86057;\n        int64_t global_tid_86058;\n        int64_t slic", "e_86059;\n        int64_t write_i_76636;\n        int64_t remnant_86060;\n        \n        virt_tblock_id_86057 = phys_tblock_id_86054 + i_86056 * sext_i64_i32(num_tblocks_76642);\n        global_tid_86058 = sext_i32_i64(virt_tblock_id_86057) * segmap_tblock_sizze_76640 + sext_i32_i64(local_tid_86050);\n        slice_86059 = conc_tmp_62382;\n        write_i_76636 = global_tid_86058;\n        remnant_86060 = global_tid_86058 - write_i_76636;\n        if (slt64(write_i_76636, conc_tmp_62382)) {\n            int64_t eta_p_64242;\n            bool index_concat_cmp_77778;\n            int64_t index_concat_branch_77786;\n            int64_t write_value_64245;\n            bool cond_64246;\n            int64_t lifted_lambda_res_64247;\n            \n            eta_p_64242 = ((__global int64_t *) ext_mem_82540)[write_i_76636];\n            index_concat_cmp_77778 = sle64(conc_tmp_62375, write_i_76636);\n            if (index_concat_cmp_77778) {\n                int64_t index_concat_i_77779;\n                int64_t index_concat_77780;\n                \n                index_concat_i_77779 = sub64(write_i_76636, conc_tmp_62375);\n                index_concat_77780 = ((__global int64_t *) ext_mem_82064)[index_concat_i_77779];\n                index_concat_branch_77786 = index_concat_77780;\n            } else {\n                bool index_concat_cmp_77781;\n                int64_t index_concat_branch_77785;\n                \n                index_concat_cmp_77781 = sle64(m_62289, write_i_76636);\n                if (index_concat_cmp_77781) {\n                    int64_t index_concat_i_77782;\n                    int64_t index_concat_77783;\n                    \n                    index_concat_i_77782 = sub64(write_i_76636, m_62289);\n                    index_concat_77783 = ((__global int64_t *) mem_82044)[index_concat_i_77782];\n                    index_concat_branch_77785 = index_concat_77783;\n                } else {\n                    int64_t index_concat_77784 = ((__global int64_t *) mem_82077)[write", "_i_76636];\n                    \n                    index_concat_branch_77785 = index_concat_77784;\n                }\n                index_concat_branch_77786 = index_concat_branch_77785;\n            }\n            write_value_64245 = ((__global int64_t *) ext_mem_82539)[write_i_76636];\n            cond_64246 = eta_p_64242 == (int64_t) 1;\n            if (cond_64246) {\n                int64_t eta_p_64243;\n                int64_t lifted_lambda_res_t_res_66687;\n                \n                eta_p_64243 = ((__global int64_t *) ext_mem_82541)[write_i_76636];\n                lifted_lambda_res_t_res_66687 = sub64(eta_p_64243, (int64_t) 1);\n                lifted_lambda_res_64247 = lifted_lambda_res_t_res_66687;\n            } else {\n                lifted_lambda_res_64247 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64247) && slt64(lifted_lambda_res_64247, m_63000)) {\n                ((__global int64_t *) mem_82545)[lifted_lambda_res_64247] = index_concat_branch_77786;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64247) && slt64(lifted_lambda_res_64247, m_63000)) {\n                ((__global int64_t *) mem_82543)[lifted_lambda_res_64247] = write_value_64245;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_76640\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77089_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77089(__global int *global_failure, int64_t m_63000, int64_t m_63092, int64_t num_tblocks_77094, int32_t virt_num_tblocks_86426, __global unsigned char *mem_82543, __global unsigned char *mem_82545, __global unsigned char *ext_mem_82702, __global unsigned char *ext_mem_82703, __global unsigned char *mem_82705, __global unsigned char *mem_82707)\n{\n    #define segmap_tblock_sizze_77092 (do_DBSCAN_doublezisegmap_77089zisegmap_tblock_sizze_77092)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_",
                                    "tid_86428;\n    int32_t tblock_sizze_86431;\n    int32_t wave_sizze_86430;\n    int32_t block_id_86429;\n    int32_t global_tid_86427;\n    int64_t phys_tid_77089;\n    int32_t phys_tblock_id_86432;\n    int32_t iterations_86433;\n    \n    local_tid_86428 = get_local_id(0);\n    tblock_sizze_86431 = get_local_size(0);\n    wave_sizze_86430 = LOCKSTEP_WIDTH;\n    block_id_86429 = get_tblock_id(0);\n    global_tid_86427 = block_id_86429 * tblock_sizze_86431 + local_tid_86428;\n    phys_tid_77089 = sext_i32_i64(global_tid_86427);\n    phys_tblock_id_86432 = get_tblock_id(0);\n    iterations_86433 = sdiv_up32(virt_num_tblocks_86426 - phys_tblock_id_86432, sext_i64_i32(num_tblocks_77094));\n    for (int32_t i_86434 = 0; i_86434 < iterations_86433; i_86434++) {\n        int32_t virt_tblock_id_86435;\n        int64_t global_tid_86436;\n        int64_t slice_86437;\n        int64_t write_i_77088;\n        int64_t remnant_86438;\n        \n        virt_tblock_id_86435 = phys_tblock_id_86432 + i_86434 * sext_i64_i32(num_tblocks_77094);\n        global_tid_86436 = sext_i32_i64(virt_tblock_id_86435) * segmap_tblock_sizze_77092 + sext_i32_i64(local_tid_86428);\n        slice_86437 = m_63000;\n        write_i_77088 = global_tid_86436;\n        remnant_86438 = global_tid_86436 - write_i_77088;\n        if (slt64(write_i_77088, m_63000)) {\n            int64_t eta_p_64179;\n            int64_t write_value_64181;\n            int64_t write_value_64182;\n            bool cond_64183;\n            int64_t lifted_lambda_res_64184;\n            \n            eta_p_64179 = ((__global int64_t *) ext_mem_82702)[write_i_77088];\n            write_value_64181 = ((__global int64_t *) mem_82545)[write_i_77088];\n            write_value_64182 = ((__global int64_t *) mem_82543)[write_i_77088];\n            cond_64183 = eta_p_64179 == (int64_t) 1;\n            if (cond_64183) {\n                int64_t eta_p_64180;\n                int64_t lifted_lambda_res_t_res_66692;\n                \n                eta_p_64180 = ((__global int64_t *)", " ext_mem_82703)[write_i_77088];\n                lifted_lambda_res_t_res_66692 = sub64(eta_p_64180, (int64_t) 1);\n                lifted_lambda_res_64184 = lifted_lambda_res_t_res_66692;\n            } else {\n                lifted_lambda_res_64184 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64184) && slt64(lifted_lambda_res_64184, m_63092)) {\n                ((__global int64_t *) mem_82707)[lifted_lambda_res_64184] = write_value_64181;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_64184) && slt64(lifted_lambda_res_64184, m_63092)) {\n                ((__global int64_t *) mem_82705)[lifted_lambda_res_64184] = write_value_64182;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_77092\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77105_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77105(__global int *global_failure, int64_t conc_tmp_62379, int64_t m_63400, int64_t num_tblocks_77110, int32_t virt_num_tblocks_86443, __global unsigned char *mem_82720, __global unsigned char *mem_82722, __global unsigned char *mem_82724, __global unsigned char *mem_82726, __global unsigned char *mem_82728, __global unsigned char *mem_82730, __global unsigned char *mem_82732, __global unsigned char *mem_82734)\n{\n    #define segmap_tblock_sizze_77108 (do_DBSCAN_doublezisegmap_77105zisegmap_tblock_sizze_77108)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86445;\n    int32_t tblock_sizze_86448;\n    int32_t wave_sizze_86447;\n    int32_t block_id_86446;\n    int32_t global_tid_86444;\n    int64_t phys_tid_77105;\n    int32_t phys_tblock_id_86449;\n    int32_t iterations_86450;\n    \n    local_tid_86445 = get_local_id(0);\n    tblock_sizze_86448 = get_local_size(0);\n    wave_sizze_86447 = LOCKSTEP_WIDTH;\n    block_id_86446 = get_tblock_id(0);\n    global_tid_86444 = block_id_86446 * tblock_sizze_86448 + local_tid_86445;\n   ", " phys_tid_77105 = sext_i32_i64(global_tid_86444);\n    phys_tblock_id_86449 = get_tblock_id(0);\n    iterations_86450 = sdiv_up32(virt_num_tblocks_86443 - phys_tblock_id_86449, sext_i64_i32(num_tblocks_77110));\n    for (int32_t i_86451 = 0; i_86451 < iterations_86450; i_86451++) {\n        int32_t virt_tblock_id_86452;\n        int64_t global_tid_86453;\n        int64_t slice_86454;\n        int64_t write_i_77104;\n        int64_t remnant_86455;\n        \n        virt_tblock_id_86452 = phys_tblock_id_86449 + i_86451 * sext_i64_i32(num_tblocks_77110);\n        global_tid_86453 = sext_i32_i64(virt_tblock_id_86452) * segmap_tblock_sizze_77108 + sext_i32_i64(local_tid_86445);\n        slice_86454 = conc_tmp_62379;\n        write_i_77104 = global_tid_86453;\n        remnant_86455 = global_tid_86453 - write_i_77104;\n        if (slt64(write_i_77104, conc_tmp_62379)) {\n            int64_t eta_p_63751;\n            int64_t write_value_63753;\n            double write_value_63754;\n            double write_value_63755;\n            bool cond_63756;\n            int64_t lifted_lambda_res_63757;\n            \n            eta_p_63751 = ((__global int64_t *) mem_82722)[write_i_77104];\n            write_value_63753 = ((__global int64_t *) mem_82724)[write_i_77104];\n            write_value_63754 = ((__global double *) mem_82726)[write_i_77104];\n            write_value_63755 = ((__global double *) mem_82728)[write_i_77104];\n            cond_63756 = eta_p_63751 == (int64_t) 1;\n            if (cond_63756) {\n                int64_t eta_p_63752;\n                int64_t lifted_lambda_res_t_res_66747;\n                \n                eta_p_63752 = ((__global int64_t *) mem_82720)[write_i_77104];\n                lifted_lambda_res_t_res_66747 = sub64(eta_p_63752, (int64_t) 1);\n                lifted_lambda_res_63757 = lifted_lambda_res_t_res_66747;\n            } else {\n                lifted_lambda_res_63757 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63757) && slt64(li",
                                    "fted_lambda_res_63757, m_63400)) {\n                ((__global int64_t *) mem_82734)[lifted_lambda_res_63757] = write_value_63753;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63757) && slt64(lifted_lambda_res_63757, m_63400)) {\n                ((__global double *) mem_82732)[lifted_lambda_res_63757] = write_value_63754;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63757) && slt64(lifted_lambda_res_63757, m_63400)) {\n                ((__global double *) mem_82730)[lifted_lambda_res_63757] = write_value_63755;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_77108\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77340_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77340(__global int *global_failure, int8_t clBase_48690, int64_t inf_63450, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, __global unsigned char *ext_mem_82716, __global unsigned char *ext_mem_82717, __global unsigned char *mem_82743, __global unsigned char *mem_82745, __global unsigned char *mem_82747)\n{\n    #define segmap_tblock_sizze_77334 (do_DBSCAN_doublezisegmap_77340zisegmap_tblock_sizze_77334)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86481;\n    int32_t tblock_sizze_86484;\n    int32_t wave_sizze_86483;\n    int32_t block_id_86482;\n    int32_t global_tid_86480;\n    int64_t phys_tid_77340;\n    int64_t global_tid_86485;\n    int64_t slice_86486;\n    int64_t gtid_77339;\n    int64_t remnant_86487;\n    \n    local_tid_86481 = get_local_id(0);\n    tblock_sizze_86484 = get_local_size(0);\n    wave_sizze_86483 = LOCKSTEP_WIDTH;\n    block_id_86482 = get_tblock_id(0);\n    global_tid_86480 = block_id_86482 * tblock_sizze_86484 + local_tid_86481;\n    phys_tid_77340 = sext_i32_i64(global_tid_86480);\n    global_tid_86485 = sext_i32_i64(block_id_86482) * segmap_tblock_sizze_77334 + sext_i32_i64(local_tid_86481);\n    slice_86486 = dzlz7bUZLzmZRz20Usup", "z20Uinfz7dUzg_63453;\n    gtid_77339 = global_tid_86485;\n    remnant_86487 = global_tid_86485 - gtid_77339;\n    if (slt64(gtid_77339, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453)) {\n        int64_t slice_77763;\n        double eta_p_77341;\n        double eta_p_77342;\n        double zt_res_77343;\n        double zt_res_77344;\n        double zs_res_77345;\n        double zs_res_77346;\n        double d_haversine_res_77347;\n        double d_haversine_res_77348;\n        double cos_res_77349;\n        \n        slice_77763 = inf_63450 + gtid_77339;\n        eta_p_77341 = ((__global double *) ext_mem_82717)[slice_77763];\n        eta_p_77342 = ((__global double *) ext_mem_82716)[slice_77763];\n        zt_res_77343 = 3.141592653589793 * eta_p_77341;\n        zt_res_77344 = 3.141592653589793 * eta_p_77342;\n        zs_res_77345 = zt_res_77343 / 180.0;\n        zs_res_77346 = zt_res_77344 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_77347 = eta_p_77341;\n        } else {\n            d_haversine_res_77347 = zs_res_77345;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_77348 = eta_p_77342;\n        } else {\n            d_haversine_res_77348 = zs_res_77346;\n        }\n        cos_res_77349 = futrts_cos64(d_haversine_res_77347);\n        ((__global double *) mem_82743)[gtid_77339] = d_haversine_res_77347;\n        ((__global double *) mem_82745)[gtid_77339] = d_haversine_res_77348;\n        ((__global double *) mem_82747)[gtid_77339] = cos_res_77349;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_77334\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77642_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77642(__global int *global_failure, int8_t clBase_48690, int64_t inf_63544, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_82822, __global unsigned char *mem_82824, __global unsigned char *mem", "_82826)\n{\n    #define segmap_tblock_sizze_77636 (do_DBSCAN_doublezisegmap_77642zisegmap_tblock_sizze_77636)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86612;\n    int32_t tblock_sizze_86615;\n    int32_t wave_sizze_86614;\n    int32_t block_id_86613;\n    int32_t global_tid_86611;\n    int64_t phys_tid_77642;\n    int64_t global_tid_86616;\n    int64_t slice_86617;\n    int64_t gtid_77641;\n    int64_t remnant_86618;\n    \n    local_tid_86612 = get_local_id(0);\n    tblock_sizze_86615 = get_local_size(0);\n    wave_sizze_86614 = LOCKSTEP_WIDTH;\n    block_id_86613 = get_tblock_id(0);\n    global_tid_86611 = block_id_86613 * tblock_sizze_86615 + local_tid_86612;\n    phys_tid_77642 = sext_i32_i64(global_tid_86611);\n    global_tid_86616 = sext_i32_i64(block_id_86613) * segmap_tblock_sizze_77636 + sext_i32_i64(local_tid_86612);\n    slice_86617 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;\n    gtid_77641 = global_tid_86616;\n    remnant_86618 = global_tid_86616 - gtid_77641;\n    if (slt64(gtid_77641, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547)) {\n        int64_t slice_77757;\n        double eta_p_77643;\n        double eta_p_77644;\n        double zt_res_77645;\n        double zt_res_77646;\n        double zs_res_77647;\n        double zs_res_77648;\n        double d_haversine_res_77649;\n        double d_haversine_res_77650;\n        double cos_res_77651;\n        \n        slice_77757 = inf_63544 + gtid_77641;\n        eta_p_77643 = ((__global double *) current_partition_mem_81940)[slice_77757];\n        eta_p_77644 = ((__global double *) current_partition_mem_81941)[slice_77757];\n        zt_res_77645 = 3.141592653589793 * eta_p_77643;\n        zt_res_77646 = 3.141592653589793 * eta_p_77644;\n        zs_res_77647 = zt_res_77645 / 180.0;\n        zs_res_77648 = zt_res_77646 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_77649 = eta_p_77643;\n        } else {\n            d_haversine_res_77649 = zs_res_77647;\n        }\n        if (clBase_48690 == (",
                                    "int8_t) 1) {\n            d_haversine_res_77650 = eta_p_77644;\n        } else {\n            d_haversine_res_77650 = zs_res_77648;\n        }\n        cos_res_77651 = futrts_cos64(d_haversine_res_77649);\n        ((__global double *) mem_82822)[gtid_77641] = d_haversine_res_77649;\n        ((__global double *) mem_82824)[gtid_77641] = d_haversine_res_77650;\n        ((__global double *) mem_82826)[gtid_77641] = cos_res_77651;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_77636\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77717_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77717(__global int *global_failure, int64_t dz2081U_48683, int64_t do_DBSCAN_res_63120, int64_t num_tblocks_77722, int32_t virt_num_tblocks_86719, __global unsigned char *mem_81974, __global unsigned char *ext_mem_82715, __global unsigned char *mem_82737)\n{\n    #define segmap_tblock_sizze_77720 (do_DBSCAN_doublezisegmap_77717zisegmap_tblock_sizze_77720)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86721;\n    int32_t tblock_sizze_86724;\n    int32_t wave_sizze_86723;\n    int32_t block_id_86722;\n    int32_t global_tid_86720;\n    int64_t phys_tid_77717;\n    int32_t phys_tblock_id_86725;\n    int32_t iterations_86726;\n    \n    local_tid_86721 = get_local_id(0);\n    tblock_sizze_86724 = get_local_size(0);\n    wave_sizze_86723 = LOCKSTEP_WIDTH;\n    block_id_86722 = get_tblock_id(0);\n    global_tid_86720 = block_id_86722 * tblock_sizze_86724 + local_tid_86721;\n    phys_tid_77717 = sext_i32_i64(global_tid_86720);\n    phys_tblock_id_86725 = get_tblock_id(0);\n    iterations_86726 = sdiv_up32(virt_num_tblocks_86719 - phys_tblock_id_86725, sext_i64_i32(num_tblocks_77722));\n    for (int32_t i_86727 = 0; i_86727 < iterations_86726; i_86727++) {\n        int32_t virt_tblock_id_86728;\n        int64_t global_tid_86729;\n        int64_t slice_86730;\n        int64_t write_i_77716;\n        int64_t remnant_86731;\n        \n        virt_tblock_id_86728 = phys_tblock_id_86725 + i_86727 *", " sext_i64_i32(num_tblocks_77722);\n        global_tid_86729 = sext_i32_i64(virt_tblock_id_86728) * segmap_tblock_sizze_77720 + sext_i32_i64(local_tid_86721);\n        slice_86730 = do_DBSCAN_res_63120;\n        write_i_77716 = global_tid_86729;\n        remnant_86731 = global_tid_86729 - write_i_77716;\n        if (slt64(write_i_77716, do_DBSCAN_res_63120)) {\n            int64_t write_index_63630;\n            int64_t write_value_63631;\n            \n            write_index_63630 = ((__global int64_t *) ext_mem_82715)[write_i_77716];\n            write_value_63631 = ((__global int64_t *) mem_82737)[write_i_77716];\n            if (sle64((int64_t) 0, write_index_63630) && slt64(write_index_63630, dz2081U_48683)) {\n                ((__global int64_t *) mem_81974)[write_index_63630] = write_value_63631;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_77720\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_77725_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_77725(__global int *global_failure, int64_t dz2080U_48682, int64_t partition_sizze_62142, int64_t num_tblocks_77730, int32_t virt_num_tblocks_86733, __global unsigned char *mem_81975, __global unsigned char *mem_82026, __global unsigned char *mem_82042)\n{\n    #define segmap_tblock_sizze_77728 (do_DBSCAN_doublezisegmap_77725zisegmap_tblock_sizze_77728)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86735;\n    int32_t tblock_sizze_86738;\n    int32_t wave_sizze_86737;\n    int32_t block_id_86736;\n    int32_t global_tid_86734;\n    int64_t phys_tid_77725;\n    int32_t phys_tblock_id_86739;\n    int32_t iterations_86740;\n    \n    local_tid_86735 = get_local_id(0);\n    tblock_sizze_86738 = get_local_size(0);\n    wave_sizze_86737 = LOCKSTEP_WIDTH;\n    block_id_86736 = get_tblock_id(0);\n    global_tid_86734 = block_id_86736 * tblock_sizze_86738 + local_tid_86735;\n    phys_tid_77725 = sext_i32_i64(global_tid_86734);\n  ", "  phys_tblock_id_86739 = get_tblock_id(0);\n    iterations_86740 = sdiv_up32(virt_num_tblocks_86733 - phys_tblock_id_86739, sext_i64_i32(num_tblocks_77730));\n    for (int32_t i_86741 = 0; i_86741 < iterations_86740; i_86741++) {\n        int32_t virt_tblock_id_86742;\n        int64_t global_tid_86743;\n        int64_t slice_86744;\n        int64_t write_i_77724;\n        int64_t remnant_86745;\n        \n        virt_tblock_id_86742 = phys_tblock_id_86739 + i_86741 * sext_i64_i32(num_tblocks_77730);\n        global_tid_86743 = sext_i32_i64(virt_tblock_id_86742) * segmap_tblock_sizze_77728 + sext_i32_i64(local_tid_86735);\n        slice_86744 = partition_sizze_62142;\n        write_i_77724 = global_tid_86743;\n        remnant_86745 = global_tid_86743 - write_i_77724;\n        if (slt64(write_i_77724, partition_sizze_62142)) {\n            int64_t write_index_63634;\n            bool write_value_63635;\n            \n            write_index_63634 = ((__global int64_t *) mem_82026)[write_i_77724];\n            write_value_63635 = ((__global bool *) mem_82042)[write_i_77724];\n            if (sle64((int64_t) 0, write_index_63634) && slt64(write_index_63634, dz2080U_48682)) {\n                ((__global bool *) mem_81975)[write_index_63634] = write_value_63635;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_77728\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_78070_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_78070(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_62247, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t inf_62706, int64_t j_m_i_62709, int64_t ldim_78073, int64_t num_whole_tiles_78140, int64_t residual_input_78371, unsigned char cond_78372_bits, int64_t binop_x_78388, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char",
                                    " *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_param_82092, __global unsigned char *mem_82156)\n{\n    bool cond_78372 = cond_78372_bits;\n    \n    #define tile_sizze_78072 (do_DBSCAN_doublezisegmap_intrablock_78070zitile_sizze_78072)\n    #define bytes_82133 (do_DBSCAN_doublezisegmap_intrablock_78070zibytes_82133)\n    \n    volatile __local unsigned char *color_83089_backing_2 = &shared_mem[0];\n    const int64_t color_83089_backing_2_offset = 0 + (bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83088_backing_1 = &shared_mem[color_83089_backing_2_offset];\n    const int64_t color_83088_backing_1_offset = color_83089_backing_2_offset + (bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83087_backing_0 = &shared_mem[color_83088_backing_1_offset];\n    const int64_t color_83087_backing_0_offset = color_83088_backing_1_offset + (bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85152;\n    int32_t tblock_sizze_85155;\n    int32_t wave_sizze_85154;\n    int32_t block_id_85153;\n    int32_t global_tid_85151;\n    int64_t gid_flat_78070;\n    int64_t slice_85157;\n    int64_t ltid_pre_85156;\n    int64_t remnant_85158;\n    int64_t slice_85159;\n    int64_t gid_78069;\n    int64_t remnant_85160;\n    __local unsigned char *color_83087;\n    __local unsigned char *color_83088;\n    __local unsigned char *color_83089;\n    int64_t binop_x_78090;\n    int64_t mem_82107[1];\n    double mem_82111[1];\n    double mem_82115[1];\n    double mem_82119[1];\n    double mem_82123[1];\n    double mem_82127[1];\n    int64_t ltid_flat_78075;\n    int64_t ltid_78074;\n    int64_t gtid_78091;\n    bool cond_78092;\n    int64_t pre_78093;\n    double pre_780", "94;\n    double pre_78095;\n    double pre_78096;\n    double pre_78097;\n    double pre_78098;\n    int64_t mem_82131[1];\n    int64_t ltid_flat_78142;\n    int64_t ltid_78141;\n    int64_t ext_mem_82143[1];\n    int64_t mem_param_82132[1];\n    int64_t mem_82153[1];\n    int64_t ext_mem_82154[1];\n    \n    local_tid_85152 = get_local_id(0);\n    tblock_sizze_85155 = get_local_size(0);\n    wave_sizze_85154 = LOCKSTEP_WIDTH;\n    block_id_85153 = get_tblock_id(0);\n    global_tid_85151 = block_id_85153 * tblock_sizze_85155 + local_tid_85152;\n    gid_flat_78070 = sext_i32_i64(block_id_85153);\n    slice_85157 = tile_sizze_78072;\n    ltid_pre_85156 = sext_i32_i64(local_tid_85152);\n    remnant_85158 = sext_i32_i64(local_tid_85152) - ltid_pre_85156;\n    slice_85159 = ldim_78073;\n    gid_78069 = sext_i32_i64(block_id_85153);\n    remnant_85160 = sext_i32_i64(block_id_85153) - gid_78069;\n    color_83087 = (__local unsigned char *) color_83087_backing_0;\n    color_83088 = (__local unsigned char *) color_83088_backing_1;\n    color_83089 = (__local unsigned char *) color_83089_backing_2;\n    binop_x_78090 = gid_78069 * tile_sizze_78072;\n    ltid_flat_78075 = sext_i32_i64(local_tid_85152);\n    ltid_78074 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n    gtid_78091 = ltid_78074 + binop_x_78090;\n    cond_78092 = slt64(gtid_78091, j_m_i_62709);\n    if (cond_78092) {\n        int64_t slice_78099;\n        int64_t eta_p_78100;\n        bool index_concat_cmp_78102;\n        double index_concat_branch_78103;\n        double index_concat_branch_78113;\n        double zt_res_78121;\n        double zt_res_78122;\n        double zs_res_78123;\n        double zs_res_78124;\n        double d_haversine_res_78125;\n        double d_haversine_res_78126;\n        double cos_res_78127;\n        \n        slice_78099 = inf_62706 + gtid_78091;\n        eta_p_78100 = ((__global int64_t *) mem_param_82092)[slice_78099];\n        index_concat_cmp_78102 = sle64(conc_tmp_62375, slice_78099);\n        if (index_concat_cmp_78102) {\n   ", "         int64_t index_concat_i_78104;\n            double index_concat_78105;\n            \n            index_concat_i_78104 = sub64(slice_78099, conc_tmp_62375);\n            index_concat_78105 = ((__global double *) ext_mem_82066)[index_concat_i_78104];\n            index_concat_branch_78103 = index_concat_78105;\n        } else {\n            bool index_concat_cmp_78106;\n            double index_concat_branch_78107;\n            \n            index_concat_cmp_78106 = sle64(m_62289, slice_78099);\n            if (index_concat_cmp_78106) {\n                int64_t index_concat_i_78108;\n                double index_concat_78109;\n                \n                index_concat_i_78108 = sub64(slice_78099, m_62289);\n                index_concat_78109 = ((__global double *) mem_82048)[index_concat_i_78108];\n                index_concat_branch_78107 = index_concat_78109;\n            } else {\n                double index_concat_78110 = ((__global double *) mem_82081)[slice_78099];\n                \n                index_concat_branch_78107 = index_concat_78110;\n            }\n            index_concat_branch_78103 = index_concat_branch_78107;\n        }\n        if (index_concat_cmp_78102) {\n            int64_t index_concat_i_78114;\n            double index_concat_78115;\n            \n            index_concat_i_78114 = sub64(slice_78099, conc_tmp_62375);\n            index_concat_78115 = ((__global double *) ext_mem_82065)[index_concat_i_78114];\n            index_concat_branch_78113 = index_concat_78115;\n        } else {\n            bool index_concat_cmp_78116;\n            double index_concat_branch_78117;\n            \n            index_concat_cmp_78116 = sle64(m_62289, slice_78099);\n            if (index_concat_cmp_78116) {\n                int64_t index_concat_i_78118;\n                double index_concat_78119;\n                \n                index_concat_i_78118 = sub64(slice_78099, m_62289);\n                index_concat_78119 = ((__global double *) mem_82046)[index_concat_i_78118];\n  ",
                                    "              index_concat_branch_78117 = index_concat_78119;\n            } else {\n                double index_concat_78120 = ((__global double *) mem_82079)[slice_78099];\n                \n                index_concat_branch_78117 = index_concat_78120;\n            }\n            index_concat_branch_78113 = index_concat_branch_78117;\n        }\n        zt_res_78121 = 3.141592653589793 * index_concat_branch_78103;\n        zt_res_78122 = 3.141592653589793 * index_concat_branch_78113;\n        zs_res_78123 = zt_res_78121 / 180.0;\n        zs_res_78124 = zt_res_78122 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_78125 = index_concat_branch_78103;\n        } else {\n            d_haversine_res_78125 = zs_res_78123;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_78126 = index_concat_branch_78113;\n        } else {\n            d_haversine_res_78126 = zs_res_78124;\n        }\n        cos_res_78127 = futrts_cos64(d_haversine_res_78125);\n        pre_78093 = eta_p_78100;\n        pre_78094 = d_haversine_res_78125;\n        pre_78095 = d_haversine_res_78126;\n        pre_78096 = cos_res_78127;\n        pre_78097 = index_concat_branch_78113;\n        pre_78098 = index_concat_branch_78103;\n    } else {\n        pre_78093 = (int64_t) 0;\n        pre_78094 = 0.0;\n        pre_78095 = 0.0;\n        pre_78096 = 0.0;\n        pre_78097 = 0.0;\n        pre_78098 = 0.0;\n    }\n    mem_82107[(int64_t) 0] = pre_78093;\n    mem_82111[(int64_t) 0] = pre_78094;\n    mem_82115[(int64_t) 0] = pre_78095;\n    mem_82119[(int64_t) 0] = pre_78096;\n    mem_82123[(int64_t) 0] = pre_78097;\n    mem_82127[(int64_t) 0] = pre_78098;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78142 = sext_i32_i64(local_tid_85152);\n    ltid_78141 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n    mem_82131[(int64_t) 0] = (int64_t) 9223372036854775807;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param", "_82132[i_3] = mem_82131[i_3];\n    for (int64_t tile_id_78148 = 0; tile_id_78148 < num_whole_tiles_78140; tile_id_78148++) {\n        int64_t binop_x_78253;\n        int64_t ltid_flat_78252;\n        int64_t ltid_78251;\n        int64_t j_78254;\n        bool cond_78263;\n        double pre1d_78264;\n        double pre1d_78265;\n        int64_t pre1d_78266;\n        int64_t mem_82142[1];\n        int64_t ltid_flat_78275;\n        int64_t ltid_78274;\n        int64_t gtid_78277;\n        int64_t acc_78284;\n        bool cond_78285;\n        int64_t acc_78286;\n        int64_t mem_param_tmp_85161[1];\n        \n        binop_x_78253 = tile_sizze_78072 * tile_id_78148;\n        ltid_flat_78252 = sext_i32_i64(local_tid_85152);\n        ltid_78251 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n        j_78254 = ltid_78251 + binop_x_78253;\n        cond_78263 = slt64(j_78254, conc_tmp_62382);\n        if (cond_78263) {\n            int64_t index_concat_add_81475;\n            bool index_concat_cmp_81477;\n            double index_concat_branch_81485;\n            double index_concat_branch_81474;\n            int64_t tile_elem_78269;\n            \n            index_concat_add_81475 = add64(m_62247, m_62289);\n            index_concat_cmp_81477 = sle64(index_concat_add_81475, j_78254);\n            if (index_concat_cmp_81477) {\n                int64_t index_concat_i_81478;\n                double index_concat_81479;\n                \n                index_concat_i_81478 = sub64(j_78254, index_concat_add_81475);\n                index_concat_81479 = ((__global double *) ext_mem_82066)[index_concat_i_81478];\n                index_concat_branch_81485 = index_concat_81479;\n            } else {\n                bool index_concat_cmp_81480;\n                double index_concat_branch_81484;\n                \n                index_concat_cmp_81480 = sle64(m_62289, j_78254);\n                if (index_concat_cmp_81480) {\n                    int64_t index_concat_i_81481;\n                    double index_concat_81482;\n  ", "                  \n                    index_concat_i_81481 = sub64(j_78254, m_62289);\n                    index_concat_81482 = ((__global double *) mem_82048)[index_concat_i_81481];\n                    index_concat_branch_81484 = index_concat_81482;\n                } else {\n                    double index_concat_81483 = ((__global double *) mem_82081)[j_78254];\n                    \n                    index_concat_branch_81484 = index_concat_81483;\n                }\n                index_concat_branch_81485 = index_concat_branch_81484;\n            }\n            if (index_concat_cmp_81477) {\n                int64_t index_concat_i_81467;\n                double index_concat_81468;\n                \n                index_concat_i_81467 = sub64(j_78254, index_concat_add_81475);\n                index_concat_81468 = ((__global double *) ext_mem_82065)[index_concat_i_81467];\n                index_concat_branch_81474 = index_concat_81468;\n            } else {\n                bool index_concat_cmp_81469;\n                double index_concat_branch_81473;\n                \n                index_concat_cmp_81469 = sle64(m_62289, j_78254);\n                if (index_concat_cmp_81469) {\n                    int64_t index_concat_i_81470;\n                    double index_concat_81471;\n                    \n                    index_concat_i_81470 = sub64(j_78254, m_62289);\n                    index_concat_81471 = ((__global double *) mem_82046)[index_concat_i_81470];\n                    index_concat_branch_81473 = index_concat_81471;\n                } else {\n                    double index_concat_81472 = ((__global double *) mem_82079)[j_78254];\n                    \n                    index_concat_branch_81473 = index_concat_81472;\n                }\n                index_concat_branch_81474 = index_concat_branch_81473;\n            }\n            tile_elem_78269 = ((__global int64_t *) mem_param_82092)[j_78254];\n            pre1d_78264 = index_concat_branch_81485;\n            pre1d_782",
                                    "65 = index_concat_branch_81474;\n            pre1d_78266 = tile_elem_78269;\n        } else {\n            pre1d_78264 = 0.0;\n            pre1d_78265 = 0.0;\n            pre1d_78266 = (int64_t) 0;\n        }\n        ((__local double *) color_83089)[ltid_78251] = pre1d_78264;\n        ((__local double *) color_83088)[ltid_78251] = pre1d_78265;\n        ((__local int64_t *) color_83087)[ltid_78251] = pre1d_78266;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78275 = sext_i32_i64(local_tid_85152);\n        ltid_78274 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n        gtid_78277 = binop_x_78090 + ltid_78274;\n        acc_78284 = mem_param_82132[(int64_t) 0];\n        cond_78285 = slt64(gtid_78277, j_m_i_62709);\n        if (cond_78285) {\n            int64_t eta_p_78278;\n            double d_haversine_res_78279;\n            double d_haversine_res_78280;\n            double cos_res_78281;\n            double index_concat_branch_78282;\n            double index_concat_branch_78283;\n            int64_t x_78287;\n            int64_t redout_81486;\n            \n            eta_p_78278 = mem_82107[(int64_t) 0];\n            d_haversine_res_78279 = mem_82111[(int64_t) 0];\n            d_haversine_res_78280 = mem_82115[(int64_t) 0];\n            cos_res_78281 = mem_82119[(int64_t) 0];\n            index_concat_branch_78282 = mem_82123[(int64_t) 0];\n            index_concat_branch_78283 = mem_82127[(int64_t) 0];\n            redout_81486 = acc_78284;\n            for (int64_t i_81487 = 0; i_81487 < tile_sizze_78072; i_81487++) {\n                double eta_p_78288;\n                double eta_p_78289;\n                double dist_res_78291;\n                bool zlze_res_78324;\n                int64_t lifted_lambda_res_78325;\n                int64_t min_res_78328;\n                int64_t redout_tmp_85163;\n                \n                eta_p_78288 = ((__local double *) color_83089)[i_81487];\n                eta_p_78289 = ((__local double *) color_83088)[i_81487];\n                if (clBase_", "48691 == (int8_t) 0) {\n                    bool zeze_res_78292;\n                    double d_euclidean_res_78293;\n                    \n                    zeze_res_78292 = index_concat_branch_78283 == eta_p_78288;\n                    if (zeze_res_78292) {\n                        double zm_res_78294;\n                        double abs_res_78295;\n                        \n                        zm_res_78294 = index_concat_branch_78282 - eta_p_78289;\n                        abs_res_78295 = fabs64(zm_res_78294);\n                        d_euclidean_res_78293 = abs_res_78295;\n                    } else {\n                        bool zeze_res_78296;\n                        double d_euclidean_res_f_res_78297;\n                        \n                        zeze_res_78296 = index_concat_branch_78282 == eta_p_78289;\n                        if (zeze_res_78296) {\n                            double zm_res_78298;\n                            double abs_res_78299;\n                            \n                            zm_res_78298 = index_concat_branch_78283 - eta_p_78288;\n                            abs_res_78299 = fabs64(zm_res_78298);\n                            d_euclidean_res_f_res_78297 = abs_res_78299;\n                        } else {\n                            double zm_res_78300;\n                            double zm_res_78301;\n                            double hypot_res_78302;\n                            \n                            zm_res_78300 = index_concat_branch_78282 - eta_p_78289;\n                            zm_res_78301 = index_concat_branch_78283 - eta_p_78288;\n                            hypot_res_78302 = futrts_hypot64(zm_res_78301, zm_res_78300);\n                            d_euclidean_res_f_res_78297 = hypot_res_78302;\n                        }\n                        d_euclidean_res_78293 = d_euclidean_res_f_res_78297;\n                    }\n                    dist_res_78291 = d_euclidean_res_78293;\n                } else {\n                    double d_", "haversine_res_78303;\n                    double d_haversine_res_78304;\n                    double zm_res_78309;\n                    double cos_res_78310;\n                    double zm_res_78311;\n                    double cos_res_78312;\n                    double zt_res_78313;\n                    double zm_res_78314;\n                    double zm_res_78315;\n                    double zt_res_78316;\n                    double zp_res_78317;\n                    double zs_res_78318;\n                    double min_res_78319;\n                    double zt_res_78320;\n                    double zm_res_78321;\n                    double acos_res_78322;\n                    double zt_res_78323;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_78303 = eta_p_78288;\n                        d_haversine_res_78304 = eta_p_78289;\n                    } else {\n                        double zt_res_78305;\n                        double zs_res_78306;\n                        double zt_res_78307;\n                        double zs_res_78308;\n                        \n                        zt_res_78305 = 3.141592653589793 * eta_p_78288;\n                        zs_res_78306 = zt_res_78305 / 180.0;\n                        zt_res_78307 = 3.141592653589793 * eta_p_78289;\n                        zs_res_78308 = zt_res_78307 / 180.0;\n                        d_haversine_res_78303 = zs_res_78306;\n                        d_haversine_res_78304 = zs_res_78308;\n                    }\n                    zm_res_78309 = d_haversine_res_78279 - d_haversine_res_78303;\n                    cos_res_78310 = futrts_cos64(zm_res_78309);\n                    zm_res_78311 = 1.0 - cos_res_78310;\n                    cos_res_78312 = futrts_cos64(d_haversine_res_78303);\n                    zt_res_78313 = cos_res_78281 * cos_res_78312;\n                    zm_res_78314 = d_haversine_res_78280 - d_haversine_res_78304;\n                    zm_res_78315 = 1.0 - zm",
                                    "_res_78314;\n                    zt_res_78316 = zt_res_78313 * zm_res_78315;\n                    zp_res_78317 = zm_res_78311 + zt_res_78316;\n                    zs_res_78318 = zp_res_78317 / 2.0;\n                    min_res_78319 = fmin64(1.0, zs_res_78318);\n                    zt_res_78320 = 2.0 * min_res_78319;\n                    zm_res_78321 = 1.0 - zt_res_78320;\n                    acos_res_78322 = futrts_acos64(zm_res_78321);\n                    zt_res_78323 = clBase_48698 * acos_res_78322;\n                    dist_res_78291 = zt_res_78323;\n                }\n                zlze_res_78324 = dist_res_78291 <= clBase_48692;\n                if (zlze_res_78324) {\n                    int64_t eta_p_78290 = ((__local int64_t *) color_83087)[i_81487];\n                    \n                    lifted_lambda_res_78325 = eta_p_78290;\n                } else {\n                    lifted_lambda_res_78325 = eta_p_78278;\n                }\n                min_res_78328 = smin64(lifted_lambda_res_78325, redout_81486);\n                redout_tmp_85163 = min_res_78328;\n                redout_81486 = redout_tmp_85163;\n            }\n            x_78287 = redout_81486;\n            acc_78286 = x_78287;\n        } else {\n            acc_78286 = acc_78284;\n        }\n        mem_82142[(int64_t) 0] = acc_78286;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_4 = 0; i_4 < 1; i_4++)\n            mem_param_tmp_85161[i_4] = mem_82142[i_4];\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            mem_param_82132[i_5] = mem_param_tmp_85161[i_5];\n    }\n    for (int32_t i_6 = 0; i_6 < 1; i_6++)\n        ext_mem_82143[i_6] = mem_param_82132[i_6];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_78372) {\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            ext_mem_82154[i_7] = ext_mem_82143[i_7];\n    } else {\n        int64_t ltid_flat_78374;\n        int64_t ltid_78373;\n        int64_t j_78389;\n        bool cond_78398;\n        double pre1d_78399;\n        double pre1d_78400;\n        int6", "4_t pre1d_78401;\n        int64_t ltid_flat_78415;\n        int64_t ltid_78414;\n        int64_t gtid_78422;\n        int64_t acc_78429;\n        bool cond_78430;\n        int64_t acc_78431;\n        \n        ltid_flat_78374 = sext_i32_i64(local_tid_85152);\n        ltid_78373 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n        j_78389 = ltid_78373 + binop_x_78388;\n        cond_78398 = slt64(j_78389, conc_tmp_62382);\n        if (cond_78398) {\n            int64_t index_concat_add_81453;\n            bool index_concat_cmp_81455;\n            double index_concat_branch_81463;\n            double index_concat_branch_81452;\n            int64_t tile_elem_78404;\n            \n            index_concat_add_81453 = add64(m_62247, m_62289);\n            index_concat_cmp_81455 = sle64(index_concat_add_81453, j_78389);\n            if (index_concat_cmp_81455) {\n                int64_t index_concat_i_81456;\n                double index_concat_81457;\n                \n                index_concat_i_81456 = sub64(j_78389, index_concat_add_81453);\n                index_concat_81457 = ((__global double *) ext_mem_82066)[index_concat_i_81456];\n                index_concat_branch_81463 = index_concat_81457;\n            } else {\n                bool index_concat_cmp_81458;\n                double index_concat_branch_81462;\n                \n                index_concat_cmp_81458 = sle64(m_62289, j_78389);\n                if (index_concat_cmp_81458) {\n                    int64_t index_concat_i_81459;\n                    double index_concat_81460;\n                    \n                    index_concat_i_81459 = sub64(j_78389, m_62289);\n                    index_concat_81460 = ((__global double *) mem_82048)[index_concat_i_81459];\n                    index_concat_branch_81462 = index_concat_81460;\n                } else {\n                    double index_concat_81461 = ((__global double *) mem_82081)[j_78389];\n                    \n                    index_concat_branch_81462 = index_concat_81461;\n       ", "         }\n                index_concat_branch_81463 = index_concat_branch_81462;\n            }\n            if (index_concat_cmp_81455) {\n                int64_t index_concat_i_81445;\n                double index_concat_81446;\n                \n                index_concat_i_81445 = sub64(j_78389, index_concat_add_81453);\n                index_concat_81446 = ((__global double *) ext_mem_82065)[index_concat_i_81445];\n                index_concat_branch_81452 = index_concat_81446;\n            } else {\n                bool index_concat_cmp_81447;\n                double index_concat_branch_81451;\n                \n                index_concat_cmp_81447 = sle64(m_62289, j_78389);\n                if (index_concat_cmp_81447) {\n                    int64_t index_concat_i_81448;\n                    double index_concat_81449;\n                    \n                    index_concat_i_81448 = sub64(j_78389, m_62289);\n                    index_concat_81449 = ((__global double *) mem_82046)[index_concat_i_81448];\n                    index_concat_branch_81451 = index_concat_81449;\n                } else {\n                    double index_concat_81450 = ((__global double *) mem_82079)[j_78389];\n                    \n                    index_concat_branch_81451 = index_concat_81450;\n                }\n                index_concat_branch_81452 = index_concat_branch_81451;\n            }\n            tile_elem_78404 = ((__global int64_t *) mem_param_82092)[j_78389];\n            pre1d_78399 = index_concat_branch_81463;\n            pre1d_78400 = index_concat_branch_81452;\n            pre1d_78401 = tile_elem_78404;\n        } else {\n            pre1d_78399 = 0.0;\n            pre1d_78400 = 0.0;\n            pre1d_78401 = (int64_t) 0;\n        }\n        ((__local double *) color_83089)[ltid_78373] = pre1d_78399;\n        ((__local double *) color_83088)[ltid_78373] = pre1d_78400;\n        ((__local int64_t *) color_83087)[ltid_78373] = pre1d_78401;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_fla",
                                    "t_78415 = sext_i32_i64(local_tid_85152);\n        ltid_78414 = sext_i32_i64(sext_i64_i32(ltid_pre_85156));\n        gtid_78422 = binop_x_78090 + ltid_78414;\n        acc_78429 = ext_mem_82143[(int64_t) 0];\n        cond_78430 = slt64(gtid_78422, j_m_i_62709);\n        if (cond_78430) {\n            int64_t eta_p_78423;\n            double d_haversine_res_78424;\n            double d_haversine_res_78425;\n            double cos_res_78426;\n            double index_concat_branch_78427;\n            double index_concat_branch_78428;\n            int64_t x_78432;\n            int64_t redout_81488;\n            \n            eta_p_78423 = mem_82107[(int64_t) 0];\n            d_haversine_res_78424 = mem_82111[(int64_t) 0];\n            d_haversine_res_78425 = mem_82115[(int64_t) 0];\n            cos_res_78426 = mem_82119[(int64_t) 0];\n            index_concat_branch_78427 = mem_82123[(int64_t) 0];\n            index_concat_branch_78428 = mem_82127[(int64_t) 0];\n            redout_81488 = acc_78429;\n            for (int64_t i_81489 = 0; i_81489 < residual_input_78371; i_81489++) {\n                double eta_p_78433;\n                double eta_p_78434;\n                double dist_res_78436;\n                bool zlze_res_78469;\n                int64_t lifted_lambda_res_78470;\n                int64_t min_res_78473;\n                int64_t redout_tmp_85164;\n                \n                eta_p_78433 = ((__local double *) color_83089)[i_81489];\n                eta_p_78434 = ((__local double *) color_83088)[i_81489];\n                if (clBase_48691 == (int8_t) 0) {\n                    bool zeze_res_78437;\n                    double d_euclidean_res_78438;\n                    \n                    zeze_res_78437 = index_concat_branch_78428 == eta_p_78433;\n                    if (zeze_res_78437) {\n                        double zm_res_78439;\n                        double abs_res_78440;\n                        \n                        zm_res_78439 = index_concat_branch_78427 - eta_p_78434;\n        ", "                abs_res_78440 = fabs64(zm_res_78439);\n                        d_euclidean_res_78438 = abs_res_78440;\n                    } else {\n                        bool zeze_res_78441;\n                        double d_euclidean_res_f_res_78442;\n                        \n                        zeze_res_78441 = index_concat_branch_78427 == eta_p_78434;\n                        if (zeze_res_78441) {\n                            double zm_res_78443;\n                            double abs_res_78444;\n                            \n                            zm_res_78443 = index_concat_branch_78428 - eta_p_78433;\n                            abs_res_78444 = fabs64(zm_res_78443);\n                            d_euclidean_res_f_res_78442 = abs_res_78444;\n                        } else {\n                            double zm_res_78445;\n                            double zm_res_78446;\n                            double hypot_res_78447;\n                            \n                            zm_res_78445 = index_concat_branch_78427 - eta_p_78434;\n                            zm_res_78446 = index_concat_branch_78428 - eta_p_78433;\n                            hypot_res_78447 = futrts_hypot64(zm_res_78446, zm_res_78445);\n                            d_euclidean_res_f_res_78442 = hypot_res_78447;\n                        }\n                        d_euclidean_res_78438 = d_euclidean_res_f_res_78442;\n                    }\n                    dist_res_78436 = d_euclidean_res_78438;\n                } else {\n                    double d_haversine_res_78448;\n                    double d_haversine_res_78449;\n                    double zm_res_78454;\n                    double cos_res_78455;\n                    double zm_res_78456;\n                    double cos_res_78457;\n                    double zt_res_78458;\n                    double zm_res_78459;\n                    double zm_res_78460;\n                    double zt_res_78461;\n                    double zp_res_78462;\n                  ", "  double zs_res_78463;\n                    double min_res_78464;\n                    double zt_res_78465;\n                    double zm_res_78466;\n                    double acos_res_78467;\n                    double zt_res_78468;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_78448 = eta_p_78433;\n                        d_haversine_res_78449 = eta_p_78434;\n                    } else {\n                        double zt_res_78450;\n                        double zs_res_78451;\n                        double zt_res_78452;\n                        double zs_res_78453;\n                        \n                        zt_res_78450 = 3.141592653589793 * eta_p_78433;\n                        zs_res_78451 = zt_res_78450 / 180.0;\n                        zt_res_78452 = 3.141592653589793 * eta_p_78434;\n                        zs_res_78453 = zt_res_78452 / 180.0;\n                        d_haversine_res_78448 = zs_res_78451;\n                        d_haversine_res_78449 = zs_res_78453;\n                    }\n                    zm_res_78454 = d_haversine_res_78424 - d_haversine_res_78448;\n                    cos_res_78455 = futrts_cos64(zm_res_78454);\n                    zm_res_78456 = 1.0 - cos_res_78455;\n                    cos_res_78457 = futrts_cos64(d_haversine_res_78448);\n                    zt_res_78458 = cos_res_78426 * cos_res_78457;\n                    zm_res_78459 = d_haversine_res_78425 - d_haversine_res_78449;\n                    zm_res_78460 = 1.0 - zm_res_78459;\n                    zt_res_78461 = zt_res_78458 * zm_res_78460;\n                    zp_res_78462 = zm_res_78456 + zt_res_78461;\n                    zs_res_78463 = zp_res_78462 / 2.0;\n                    min_res_78464 = fmin64(1.0, zs_res_78463);\n                    zt_res_78465 = 2.0 * min_res_78464;\n                    zm_res_78466 = 1.0 - zt_res_78465;\n                    acos_res_78467 = futrts_acos64(zm_res_78466);\n                    zt_re",
                                    "s_78468 = clBase_48698 * acos_res_78467;\n                    dist_res_78436 = zt_res_78468;\n                }\n                zlze_res_78469 = dist_res_78436 <= clBase_48692;\n                if (zlze_res_78469) {\n                    int64_t eta_p_78435 = ((__local int64_t *) color_83087)[i_81489];\n                    \n                    lifted_lambda_res_78470 = eta_p_78435;\n                } else {\n                    lifted_lambda_res_78470 = eta_p_78423;\n                }\n                min_res_78473 = smin64(lifted_lambda_res_78470, redout_81488);\n                redout_tmp_85164 = min_res_78473;\n                redout_81488 = redout_tmp_85164;\n            }\n            x_78432 = redout_81488;\n            acc_78431 = x_78432;\n        } else {\n            acc_78431 = acc_78429;\n        }\n        mem_82153[(int64_t) 0] = acc_78431;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            ext_mem_82154[i_8] = mem_82153[i_8];\n    }\n    if (slt64(sext_i32_i64(local_tid_85152) + tile_sizze_78072 * sext_i32_i64(block_id_85153), j_m_i_62709)) {\n        int64_t tmp_85165 = ext_mem_82154[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82156)[sext_i32_i64(local_tid_85152) + tile_sizze_78072 * sext_i32_i64(block_id_85153)] = tmp_85165;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_78072\n    #undef bytes_82133\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_78490_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_78490(__global int *global_failure, int64_t m_62843, int64_t ldim_78493, int64_t num_whole_tiles_78513, int64_t residual_input_78727, unsigned char cond_78728_bits, int64_t binop_x_78744, __global unsigned char *mem_82279, __global unsigned char *mem_82281, __global unsigned char *mem_82406)\n{\n    bool cond_78728 = cond_78728_bits;\n    \n    #define tile_sizze_78492 (do_DBSCAN_doublezisegmap_intrablock_78490zitile_sizze_78492)\n    #define bytes_82369 (do_DBSCAN_doublezisegmap_intrablock_78490zib", "ytes_82369)\n    \n    volatile __local unsigned char *color_83092_backing_2 = &shared_mem[0];\n    const int64_t color_83092_backing_2_offset = 0 + (bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83091_backing_1 = &shared_mem[color_83092_backing_2_offset];\n    const int64_t color_83091_backing_1_offset = color_83092_backing_2_offset + (bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83090_backing_0 = &shared_mem[color_83091_backing_1_offset];\n    const int64_t color_83090_backing_0_offset = color_83091_backing_1_offset + (bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85630;\n    int32_t tblock_sizze_85633;\n    int32_t wave_sizze_85632;\n    int32_t block_id_85631;\n    int32_t global_tid_85629;\n    int64_t gid_flat_78490;\n    int64_t slice_85635;\n    int64_t ltid_pre_85634;\n    int64_t remnant_85636;\n    int64_t slice_85637;\n    int64_t gid_78489;\n    int64_t remnant_85638;\n    __local unsigned char *color_83090;\n    __local unsigned char *color_83091;\n    __local unsigned char *color_83092;\n    int64_t binop_x_78502;\n    int64_t mem_82349[1];\n    int64_t mem_82353[1];\n    int64_t ltid_flat_78495;\n    int64_t ltid_78494;\n    int64_t gtid_78503;\n    bool cond_78504;\n    int64_t pre_78505;\n    int64_t pre_78506;\n    int64_t mem_82357[1];\n    int64_t mem_82361[1];\n    int64_t mem_82365[1];\n    int64_t ltid_flat_78515;\n    int64_t ltid_78514;\n    int64_t gtid_78525;\n    bool cond_78526;\n    int64_t neutral_78527;\n    int64_t neutral_78528;\n    int64_t neutral_78529;\n    int64_t ext_mem_82389[1];\n    int64_t ext_mem_82388[1];\n    int64_t ext_mem_82387[1];\n    int64_t mem_param_82366[1];\n    int64_t mem_param_82367[1];\n    int64_t mem_param_82368[1];\n    int64_t mem_82399[1];\n    int64_t ext_mem_82400[1];\n   ", " int64_t mem_82404[1];\n    int64_t ltid_flat_78826;\n    int64_t ltid_78825;\n    int64_t gtid_78832;\n    bool cond_78836;\n    int64_t postlude_78837;\n    \n    local_tid_85630 = get_local_id(0);\n    tblock_sizze_85633 = get_local_size(0);\n    wave_sizze_85632 = LOCKSTEP_WIDTH;\n    block_id_85631 = get_tblock_id(0);\n    global_tid_85629 = block_id_85631 * tblock_sizze_85633 + local_tid_85630;\n    gid_flat_78490 = sext_i32_i64(block_id_85631);\n    slice_85635 = tile_sizze_78492;\n    ltid_pre_85634 = sext_i32_i64(local_tid_85630);\n    remnant_85636 = sext_i32_i64(local_tid_85630) - ltid_pre_85634;\n    slice_85637 = ldim_78493;\n    gid_78489 = sext_i32_i64(block_id_85631);\n    remnant_85638 = sext_i32_i64(block_id_85631) - gid_78489;\n    color_83090 = (__local unsigned char *) color_83090_backing_0;\n    color_83091 = (__local unsigned char *) color_83091_backing_1;\n    color_83092 = (__local unsigned char *) color_83092_backing_2;\n    binop_x_78502 = gid_78489 * tile_sizze_78492;\n    ltid_flat_78495 = sext_i32_i64(local_tid_85630);\n    ltid_78494 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n    gtid_78503 = ltid_78494 + binop_x_78502;\n    cond_78504 = slt64(gtid_78503, m_62843);\n    if (cond_78504) {\n        int64_t lifted_lambda_res_78507;\n        int64_t lifted_lambda_res_78508;\n        \n        lifted_lambda_res_78507 = ((__global int64_t *) mem_82281)[gtid_78503];\n        lifted_lambda_res_78508 = ((__global int64_t *) mem_82279)[gtid_78503];\n        pre_78505 = lifted_lambda_res_78507;\n        pre_78506 = lifted_lambda_res_78508;\n    } else {\n        pre_78505 = (int64_t) 0;\n        pre_78506 = (int64_t) 0;\n    }\n    mem_82349[(int64_t) 0] = pre_78505;\n    mem_82353[(int64_t) 0] = pre_78506;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78515 = sext_i32_i64(local_tid_85630);\n    ltid_78514 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n    gtid_78525 = binop_x_78502 + ltid_78514;\n    cond_78526 = slt64(gtid_78525, m_62843);\n    if (cond_78526) {\n        neutral_785",
                                    "27 = gtid_78525;\n    } else {\n        neutral_78527 = (int64_t) 0;\n    }\n    if (cond_78526) {\n        int64_t lifted_lambda_res_78530;\n        int64_t lifted_lambda_res_78531;\n        \n        lifted_lambda_res_78530 = mem_82349[(int64_t) 0];\n        lifted_lambda_res_78531 = mem_82353[(int64_t) 0];\n        neutral_78528 = lifted_lambda_res_78530;\n        neutral_78529 = lifted_lambda_res_78531;\n    } else {\n        neutral_78528 = (int64_t) 0;\n        neutral_78529 = (int64_t) 0;\n    }\n    mem_82357[(int64_t) 0] = neutral_78527;\n    mem_82361[(int64_t) 0] = neutral_78528;\n    mem_82365[(int64_t) 0] = neutral_78529;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82366[i_3] = mem_82357[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82367[i_4] = mem_82361[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_82368[i_5] = mem_82365[i_5];\n    for (int64_t tile_id_78541 = 0; tile_id_78541 < num_whole_tiles_78513; tile_id_78541++) {\n        int64_t binop_x_78637;\n        int64_t ltid_flat_78636;\n        int64_t ltid_78635;\n        int64_t j_78638;\n        bool cond_78643;\n        int64_t pre1d_78644;\n        int64_t pre1d_78645;\n        int64_t pre1d_78646;\n        int64_t mem_82378[1];\n        int64_t mem_82382[1];\n        int64_t mem_82386[1];\n        int64_t ltid_flat_78657;\n        int64_t ltid_78656;\n        int64_t gtid_78659;\n        int64_t acc_78662;\n        int64_t acc_78663;\n        int64_t acc_78664;\n        bool cond_78665;\n        int64_t acc_78666;\n        int64_t acc_78667;\n        int64_t acc_78668;\n        int64_t mem_param_tmp_85639[1];\n        int64_t mem_param_tmp_85640[1];\n        int64_t mem_param_tmp_85641[1];\n        \n        binop_x_78637 = tile_sizze_78492 * tile_id_78541;\n        ltid_flat_78636 = sext_i32_i64(local_tid_85630);\n        ltid_78635 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n        j_78638 = ltid_78635 + binop_x_786", "37;\n        cond_78643 = slt64(j_78638, m_62843);\n        if (cond_78643) {\n            pre1d_78644 = j_78638;\n        } else {\n            pre1d_78644 = (int64_t) 0;\n        }\n        if (cond_78643) {\n            int64_t tile_elem_78648;\n            int64_t tile_elem_78649;\n            \n            tile_elem_78648 = ((__global int64_t *) mem_82281)[j_78638];\n            tile_elem_78649 = ((__global int64_t *) mem_82279)[j_78638];\n            pre1d_78645 = tile_elem_78648;\n            pre1d_78646 = tile_elem_78649;\n        } else {\n            pre1d_78645 = (int64_t) 0;\n            pre1d_78646 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83092)[ltid_78635] = pre1d_78644;\n        ((__local int64_t *) color_83091)[ltid_78635] = pre1d_78645;\n        ((__local int64_t *) color_83090)[ltid_78635] = pre1d_78646;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78657 = sext_i32_i64(local_tid_85630);\n        ltid_78656 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n        gtid_78659 = binop_x_78502 + ltid_78656;\n        acc_78662 = mem_param_82366[(int64_t) 0];\n        acc_78663 = mem_param_82367[(int64_t) 0];\n        acc_78664 = mem_param_82368[(int64_t) 0];\n        cond_78665 = slt64(gtid_78659, m_62843);\n        if (cond_78665) {\n            int64_t lifted_lambda_res_78660;\n            int64_t lifted_lambda_res_78661;\n            int64_t x_78669;\n            int64_t x_78670;\n            int64_t x_78671;\n            int64_t redout_81494;\n            int64_t redout_81495;\n            int64_t redout_81496;\n            \n            lifted_lambda_res_78660 = mem_82349[(int64_t) 0];\n            lifted_lambda_res_78661 = mem_82353[(int64_t) 0];\n            redout_81494 = acc_78662;\n            redout_81495 = acc_78663;\n            redout_81496 = acc_78664;\n            for (int64_t i_81497 = 0; i_81497 < tile_sizze_78492; i_81497++) {\n                int64_t x_78672;\n                int64_t x_78673;\n                int64_t x_78674;\n                bool con", "d_78681;\n                bool cond_78682;\n                bool cond_f_res_78683;\n                bool cond_f_res_78684;\n                bool y_78685;\n                bool cond_78686;\n                bool cond_78687;\n                bool cond_t_res_78688;\n                bool x_78689;\n                bool cond_f_res_t_res_78690;\n                bool x_78691;\n                bool x_78692;\n                bool y_78693;\n                bool cond_78694;\n                int64_t lifted_lambda_res_78695;\n                int64_t lifted_lambda_res_78696;\n                int64_t lifted_lambda_res_78697;\n                int64_t redout_tmp_85645;\n                int64_t redout_tmp_85646;\n                int64_t redout_tmp_85647;\n                \n                x_78672 = ((__local int64_t *) color_83092)[i_81497];\n                x_78673 = ((__local int64_t *) color_83091)[i_81497];\n                x_78674 = ((__local int64_t *) color_83090)[i_81497];\n                cond_78681 = redout_81495 == lifted_lambda_res_78660;\n                cond_78682 = !cond_78681;\n                cond_f_res_78683 = redout_81496 == lifted_lambda_res_78661;\n                cond_f_res_78684 = !cond_f_res_78683;\n                y_78685 = cond_78681 && cond_f_res_78684;\n                cond_78686 = cond_78682 || y_78685;\n                cond_78687 = slt64(x_78672, redout_81494);\n                cond_t_res_78688 = x_78673 == lifted_lambda_res_78660;\n                x_78689 = cond_78687 && cond_t_res_78688;\n                cond_f_res_t_res_78690 = x_78674 == lifted_lambda_res_78661;\n                x_78691 = x_78689 && cond_f_res_t_res_78690;\n                x_78692 = !cond_78686;\n                y_78693 = x_78691 && x_78692;\n                cond_78694 = cond_78686 || y_78693;\n                if (cond_78694) {\n                    lifted_lambda_res_78695 = x_78672;\n                } else {\n                    lifted_lambda_res_78695 = redout_81494;\n                }\n                if (cond_78694) {\n      ",
                                    "              lifted_lambda_res_78696 = x_78673;\n                } else {\n                    lifted_lambda_res_78696 = redout_81495;\n                }\n                if (cond_78694) {\n                    lifted_lambda_res_78697 = x_78674;\n                } else {\n                    lifted_lambda_res_78697 = redout_81496;\n                }\n                redout_tmp_85645 = lifted_lambda_res_78695;\n                redout_tmp_85646 = lifted_lambda_res_78696;\n                redout_tmp_85647 = lifted_lambda_res_78697;\n                redout_81494 = redout_tmp_85645;\n                redout_81495 = redout_tmp_85646;\n                redout_81496 = redout_tmp_85647;\n            }\n            x_78669 = redout_81494;\n            x_78670 = redout_81495;\n            x_78671 = redout_81496;\n            acc_78666 = x_78669;\n            acc_78667 = x_78670;\n            acc_78668 = x_78671;\n        } else {\n            acc_78666 = acc_78662;\n            acc_78667 = acc_78663;\n            acc_78668 = acc_78664;\n        }\n        mem_82378[(int64_t) 0] = acc_78666;\n        mem_82382[(int64_t) 0] = acc_78667;\n        mem_82386[(int64_t) 0] = acc_78668;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_85639[i_6] = mem_82378[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_85640[i_7] = mem_82382[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_85641[i_8] = mem_82386[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_82366[i_9] = mem_param_tmp_85639[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_82367[i_10] = mem_param_tmp_85640[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_82368[i_11] = mem_param_tmp_85641[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_82389[i_12] = mem_param_82366[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_82388[i", "_13] = mem_param_82367[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_82387[i_14] = mem_param_82368[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_78728) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_82400[i_15] = ext_mem_82389[i_15];\n    } else {\n        int64_t ltid_flat_78730;\n        int64_t ltid_78729;\n        int64_t j_78745;\n        bool cond_78750;\n        int64_t pre1d_78751;\n        int64_t pre1d_78752;\n        int64_t pre1d_78753;\n        int64_t ltid_flat_78767;\n        int64_t ltid_78766;\n        int64_t gtid_78780;\n        int64_t acc_78783;\n        bool cond_78786;\n        int64_t acc_78787;\n        \n        ltid_flat_78730 = sext_i32_i64(local_tid_85630);\n        ltid_78729 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n        j_78745 = ltid_78729 + binop_x_78744;\n        cond_78750 = slt64(j_78745, m_62843);\n        if (cond_78750) {\n            pre1d_78751 = j_78745;\n        } else {\n            pre1d_78751 = (int64_t) 0;\n        }\n        if (cond_78750) {\n            int64_t tile_elem_78755;\n            int64_t tile_elem_78756;\n            \n            tile_elem_78755 = ((__global int64_t *) mem_82281)[j_78745];\n            tile_elem_78756 = ((__global int64_t *) mem_82279)[j_78745];\n            pre1d_78752 = tile_elem_78755;\n            pre1d_78753 = tile_elem_78756;\n        } else {\n            pre1d_78752 = (int64_t) 0;\n            pre1d_78753 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83092)[ltid_78729] = pre1d_78751;\n        ((__local int64_t *) color_83091)[ltid_78729] = pre1d_78752;\n        ((__local int64_t *) color_83090)[ltid_78729] = pre1d_78753;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78767 = sext_i32_i64(local_tid_85630);\n        ltid_78766 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n        gtid_78780 = binop_x_78502 + ltid_78766;\n        acc_78783 = ext_mem_82389[(int64_t) 0];\n        cond_78786 = slt64(gtid_78780, m_62843);\n        if (cond_787", "86) {\n            int64_t lifted_lambda_res_78781;\n            int64_t lifted_lambda_res_78782;\n            int64_t acc_78784;\n            int64_t acc_78785;\n            int64_t x_78790;\n            int64_t x_78791;\n            int64_t x_78792;\n            int64_t redout_81498;\n            int64_t redout_81499;\n            int64_t redout_81500;\n            \n            lifted_lambda_res_78781 = mem_82349[(int64_t) 0];\n            lifted_lambda_res_78782 = mem_82353[(int64_t) 0];\n            acc_78784 = ext_mem_82388[(int64_t) 0];\n            acc_78785 = ext_mem_82387[(int64_t) 0];\n            redout_81498 = acc_78783;\n            redout_81499 = acc_78784;\n            redout_81500 = acc_78785;\n            for (int64_t i_81501 = 0; i_81501 < residual_input_78727; i_81501++) {\n                int64_t x_78793;\n                int64_t x_78794;\n                int64_t x_78795;\n                bool cond_78802;\n                bool cond_78803;\n                bool cond_f_res_78804;\n                bool cond_f_res_78805;\n                bool y_78806;\n                bool cond_78807;\n                bool cond_78808;\n                bool cond_t_res_78809;\n                bool x_78810;\n                bool cond_f_res_t_res_78811;\n                bool x_78812;\n                bool x_78813;\n                bool y_78814;\n                bool cond_78815;\n                int64_t lifted_lambda_res_78816;\n                int64_t lifted_lambda_res_78817;\n                int64_t lifted_lambda_res_78818;\n                int64_t redout_tmp_85648;\n                int64_t redout_tmp_85649;\n                int64_t redout_tmp_85650;\n                \n                x_78793 = ((__local int64_t *) color_83092)[i_81501];\n                x_78794 = ((__local int64_t *) color_83091)[i_81501];\n                x_78795 = ((__local int64_t *) color_83090)[i_81501];\n                cond_78802 = redout_81499 == lifted_lambda_res_78781;\n                cond_78803 = !cond_78802;\n                cond_f_res_",
                                    "78804 = redout_81500 == lifted_lambda_res_78782;\n                cond_f_res_78805 = !cond_f_res_78804;\n                y_78806 = cond_78802 && cond_f_res_78805;\n                cond_78807 = cond_78803 || y_78806;\n                cond_78808 = slt64(x_78793, redout_81498);\n                cond_t_res_78809 = x_78794 == lifted_lambda_res_78781;\n                x_78810 = cond_78808 && cond_t_res_78809;\n                cond_f_res_t_res_78811 = x_78795 == lifted_lambda_res_78782;\n                x_78812 = x_78810 && cond_f_res_t_res_78811;\n                x_78813 = !cond_78807;\n                y_78814 = x_78812 && x_78813;\n                cond_78815 = cond_78807 || y_78814;\n                if (cond_78815) {\n                    lifted_lambda_res_78816 = x_78793;\n                } else {\n                    lifted_lambda_res_78816 = redout_81498;\n                }\n                if (cond_78815) {\n                    lifted_lambda_res_78817 = x_78794;\n                } else {\n                    lifted_lambda_res_78817 = redout_81499;\n                }\n                if (cond_78815) {\n                    lifted_lambda_res_78818 = x_78795;\n                } else {\n                    lifted_lambda_res_78818 = redout_81500;\n                }\n                redout_tmp_85648 = lifted_lambda_res_78816;\n                redout_tmp_85649 = lifted_lambda_res_78817;\n                redout_tmp_85650 = lifted_lambda_res_78818;\n                redout_81498 = redout_tmp_85648;\n                redout_81499 = redout_tmp_85649;\n                redout_81500 = redout_tmp_85650;\n            }\n            x_78790 = redout_81498;\n            x_78791 = redout_81499;\n            x_78792 = redout_81500;\n            acc_78787 = x_78790;\n        } else {\n            acc_78787 = acc_78783;\n        }\n        mem_82399[(int64_t) 0] = acc_78787;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_82400[i_16] = mem_82399[i_16];\n    }\n    ltid_flat_78", "826 = sext_i32_i64(local_tid_85630);\n    ltid_78825 = sext_i32_i64(sext_i64_i32(ltid_pre_85634));\n    gtid_78832 = binop_x_78502 + ltid_78825;\n    cond_78836 = slt64(gtid_78832, m_62843);\n    if (cond_78836) {\n        int64_t defunc_0_f_res_78833;\n        bool lifted_lambda_res_78840;\n        int64_t defunc_0_f_res_78841;\n        \n        defunc_0_f_res_78833 = ext_mem_82400[(int64_t) 0];\n        lifted_lambda_res_78840 = defunc_0_f_res_78833 == gtid_78832;\n        defunc_0_f_res_78841 = btoi_bool_i64(lifted_lambda_res_78840);\n        postlude_78837 = defunc_0_f_res_78841;\n    } else {\n        postlude_78837 = (int64_t) 0;\n    }\n    mem_82404[(int64_t) 0] = postlude_78837;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_85630) + tile_sizze_78492 * sext_i32_i64(block_id_85631), m_62843)) {\n        int64_t tmp_85651 = mem_82404[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82406)[sext_i32_i64(local_tid_85630) + tile_sizze_78492 * sext_i32_i64(block_id_85631)] = tmp_85651;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_78492\n    #undef bytes_82369\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_78845_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_78845(__global int *global_failure, int64_t m_62843, int64_t ldim_78848, int64_t num_whole_tiles_78868, int64_t residual_input_79082, unsigned char cond_79083_bits, int64_t binop_x_79099, __global unsigned char *mem_82279, __global unsigned char *mem_82281, __global unsigned char *mem_82344)\n{\n    bool cond_79083 = cond_79083_bits;\n    \n    #define tile_sizze_78847 (do_DBSCAN_doublezisegmap_intrablock_78845zitile_sizze_78847)\n    #define bytes_82307 (do_DBSCAN_doublezisegmap_intrablock_78845zibytes_82307)\n    \n    volatile __local unsigned char *color_83095_backing_2 = &shared_mem[0];\n    const int64_t color_83095_backing_2_offset = 0 + (bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83094_", "backing_1 = &shared_mem[color_83095_backing_2_offset];\n    const int64_t color_83094_backing_1_offset = color_83095_backing_2_offset + (bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83093_backing_0 = &shared_mem[color_83094_backing_1_offset];\n    const int64_t color_83093_backing_0_offset = color_83094_backing_1_offset + (bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85655;\n    int32_t tblock_sizze_85658;\n    int32_t wave_sizze_85657;\n    int32_t block_id_85656;\n    int32_t global_tid_85654;\n    int64_t gid_flat_78845;\n    int64_t slice_85660;\n    int64_t ltid_pre_85659;\n    int64_t remnant_85661;\n    int64_t slice_85662;\n    int64_t gid_78844;\n    int64_t remnant_85663;\n    __local unsigned char *color_83093;\n    __local unsigned char *color_83094;\n    __local unsigned char *color_83095;\n    int64_t binop_x_78857;\n    int64_t mem_82287[1];\n    int64_t mem_82291[1];\n    int64_t ltid_flat_78850;\n    int64_t ltid_78849;\n    int64_t gtid_78858;\n    bool cond_78859;\n    int64_t pre_78860;\n    int64_t pre_78861;\n    int64_t mem_82295[1];\n    int64_t mem_82299[1];\n    int64_t mem_82303[1];\n    int64_t ltid_flat_78870;\n    int64_t ltid_78869;\n    int64_t gtid_78880;\n    bool cond_78881;\n    int64_t neutral_78882;\n    int64_t neutral_78883;\n    int64_t neutral_78884;\n    int64_t ext_mem_82327[1];\n    int64_t ext_mem_82326[1];\n    int64_t ext_mem_82325[1];\n    int64_t mem_param_82304[1];\n    int64_t mem_param_82305[1];\n    int64_t mem_param_82306[1];\n    int64_t mem_82337[1];\n    int64_t ext_mem_82338[1];\n    int64_t mem_82342[1];\n    int64_t ltid_flat_79181;\n    int64_t ltid_79180;\n    int64_t gtid_79187;\n    bool cond_79191;\n    int64_t postlude_79192;\n    \n    local_tid_85655 = get_local_id(0);\n    tblock_sizze_85658 = get_local_size(0);\n    wave_sizze_85657 = LOCKSTEP_WIDTH;\n   ",
                                    " block_id_85656 = get_tblock_id(0);\n    global_tid_85654 = block_id_85656 * tblock_sizze_85658 + local_tid_85655;\n    gid_flat_78845 = sext_i32_i64(block_id_85656);\n    slice_85660 = tile_sizze_78847;\n    ltid_pre_85659 = sext_i32_i64(local_tid_85655);\n    remnant_85661 = sext_i32_i64(local_tid_85655) - ltid_pre_85659;\n    slice_85662 = ldim_78848;\n    gid_78844 = sext_i32_i64(block_id_85656);\n    remnant_85663 = sext_i32_i64(block_id_85656) - gid_78844;\n    color_83093 = (__local unsigned char *) color_83093_backing_0;\n    color_83094 = (__local unsigned char *) color_83094_backing_1;\n    color_83095 = (__local unsigned char *) color_83095_backing_2;\n    binop_x_78857 = gid_78844 * tile_sizze_78847;\n    ltid_flat_78850 = sext_i32_i64(local_tid_85655);\n    ltid_78849 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n    gtid_78858 = ltid_78849 + binop_x_78857;\n    cond_78859 = slt64(gtid_78858, m_62843);\n    if (cond_78859) {\n        int64_t lifted_lambda_res_78862;\n        int64_t lifted_lambda_res_78863;\n        \n        lifted_lambda_res_78862 = ((__global int64_t *) mem_82281)[gtid_78858];\n        lifted_lambda_res_78863 = ((__global int64_t *) mem_82279)[gtid_78858];\n        pre_78860 = lifted_lambda_res_78862;\n        pre_78861 = lifted_lambda_res_78863;\n    } else {\n        pre_78860 = (int64_t) 0;\n        pre_78861 = (int64_t) 0;\n    }\n    mem_82287[(int64_t) 0] = pre_78860;\n    mem_82291[(int64_t) 0] = pre_78861;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78870 = sext_i32_i64(local_tid_85655);\n    ltid_78869 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n    gtid_78880 = binop_x_78857 + ltid_78869;\n    cond_78881 = slt64(gtid_78880, m_62843);\n    if (cond_78881) {\n        neutral_78882 = gtid_78880;\n    } else {\n        neutral_78882 = (int64_t) 0;\n    }\n    if (cond_78881) {\n        int64_t lifted_lambda_res_78885;\n        int64_t lifted_lambda_res_78886;\n        \n        lifted_lambda_res_78885 = mem_82287[(int64_t) 0];\n        lifted_lambda_res_78886 = m", "em_82291[(int64_t) 0];\n        neutral_78883 = lifted_lambda_res_78885;\n        neutral_78884 = lifted_lambda_res_78886;\n    } else {\n        neutral_78883 = (int64_t) 0;\n        neutral_78884 = (int64_t) 0;\n    }\n    mem_82295[(int64_t) 0] = neutral_78882;\n    mem_82299[(int64_t) 0] = neutral_78883;\n    mem_82303[(int64_t) 0] = neutral_78884;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82304[i_3] = mem_82295[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82305[i_4] = mem_82299[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_82306[i_5] = mem_82303[i_5];\n    for (int64_t tile_id_78896 = 0; tile_id_78896 < num_whole_tiles_78868; tile_id_78896++) {\n        int64_t binop_x_78992;\n        int64_t ltid_flat_78991;\n        int64_t ltid_78990;\n        int64_t j_78993;\n        bool cond_78998;\n        int64_t pre1d_78999;\n        int64_t pre1d_79000;\n        int64_t pre1d_79001;\n        int64_t mem_82316[1];\n        int64_t mem_82320[1];\n        int64_t mem_82324[1];\n        int64_t ltid_flat_79012;\n        int64_t ltid_79011;\n        int64_t gtid_79014;\n        int64_t acc_79017;\n        int64_t acc_79018;\n        int64_t acc_79019;\n        bool cond_79020;\n        int64_t acc_79021;\n        int64_t acc_79022;\n        int64_t acc_79023;\n        int64_t mem_param_tmp_85664[1];\n        int64_t mem_param_tmp_85665[1];\n        int64_t mem_param_tmp_85666[1];\n        \n        binop_x_78992 = tile_sizze_78847 * tile_id_78896;\n        ltid_flat_78991 = sext_i32_i64(local_tid_85655);\n        ltid_78990 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n        j_78993 = ltid_78990 + binop_x_78992;\n        cond_78998 = slt64(j_78993, m_62843);\n        if (cond_78998) {\n            pre1d_78999 = j_78993;\n        } else {\n            pre1d_78999 = (int64_t) 0;\n        }\n        if (cond_78998) {\n            int64_t tile_elem_79003;\n            int64_t tile_elem_79004;\n  ", "          \n            tile_elem_79003 = ((__global int64_t *) mem_82281)[j_78993];\n            tile_elem_79004 = ((__global int64_t *) mem_82279)[j_78993];\n            pre1d_79000 = tile_elem_79003;\n            pre1d_79001 = tile_elem_79004;\n        } else {\n            pre1d_79000 = (int64_t) 0;\n            pre1d_79001 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83095)[ltid_78990] = pre1d_78999;\n        ((__local int64_t *) color_83094)[ltid_78990] = pre1d_79000;\n        ((__local int64_t *) color_83093)[ltid_78990] = pre1d_79001;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79012 = sext_i32_i64(local_tid_85655);\n        ltid_79011 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n        gtid_79014 = binop_x_78857 + ltid_79011;\n        acc_79017 = mem_param_82304[(int64_t) 0];\n        acc_79018 = mem_param_82305[(int64_t) 0];\n        acc_79019 = mem_param_82306[(int64_t) 0];\n        cond_79020 = slt64(gtid_79014, m_62843);\n        if (cond_79020) {\n            int64_t lifted_lambda_res_79015;\n            int64_t lifted_lambda_res_79016;\n            int64_t x_79024;\n            int64_t x_79025;\n            int64_t x_79026;\n            int64_t redout_81502;\n            int64_t redout_81503;\n            int64_t redout_81504;\n            \n            lifted_lambda_res_79015 = mem_82287[(int64_t) 0];\n            lifted_lambda_res_79016 = mem_82291[(int64_t) 0];\n            redout_81502 = acc_79017;\n            redout_81503 = acc_79018;\n            redout_81504 = acc_79019;\n            for (int64_t i_81505 = 0; i_81505 < tile_sizze_78847; i_81505++) {\n                int64_t x_79027;\n                int64_t x_79028;\n                int64_t x_79029;\n                bool cond_79036;\n                bool cond_79037;\n                bool cond_f_res_79038;\n                bool cond_f_res_79039;\n                bool y_79040;\n                bool cond_79041;\n                bool cond_79042;\n                bool cond_t_res_79043;\n                bool x_7",
                                    "9044;\n                bool cond_f_res_t_res_79045;\n                bool x_79046;\n                bool x_79047;\n                bool y_79048;\n                bool cond_79049;\n                int64_t lifted_lambda_res_79050;\n                int64_t lifted_lambda_res_79051;\n                int64_t lifted_lambda_res_79052;\n                int64_t redout_tmp_85670;\n                int64_t redout_tmp_85671;\n                int64_t redout_tmp_85672;\n                \n                x_79027 = ((__local int64_t *) color_83095)[i_81505];\n                x_79028 = ((__local int64_t *) color_83094)[i_81505];\n                x_79029 = ((__local int64_t *) color_83093)[i_81505];\n                cond_79036 = redout_81503 == lifted_lambda_res_79015;\n                cond_79037 = !cond_79036;\n                cond_f_res_79038 = redout_81504 == lifted_lambda_res_79016;\n                cond_f_res_79039 = !cond_f_res_79038;\n                y_79040 = cond_79036 && cond_f_res_79039;\n                cond_79041 = cond_79037 || y_79040;\n                cond_79042 = slt64(x_79027, redout_81502);\n                cond_t_res_79043 = x_79028 == lifted_lambda_res_79015;\n                x_79044 = cond_79042 && cond_t_res_79043;\n                cond_f_res_t_res_79045 = x_79029 == lifted_lambda_res_79016;\n                x_79046 = x_79044 && cond_f_res_t_res_79045;\n                x_79047 = !cond_79041;\n                y_79048 = x_79046 && x_79047;\n                cond_79049 = cond_79041 || y_79048;\n                if (cond_79049) {\n                    lifted_lambda_res_79050 = x_79027;\n                } else {\n                    lifted_lambda_res_79050 = redout_81502;\n                }\n                if (cond_79049) {\n                    lifted_lambda_res_79051 = x_79028;\n                } else {\n                    lifted_lambda_res_79051 = redout_81503;\n                }\n                if (cond_79049) {\n                    lifted_lambda_res_79052 = x_79029;\n                } else {\n             ", "       lifted_lambda_res_79052 = redout_81504;\n                }\n                redout_tmp_85670 = lifted_lambda_res_79050;\n                redout_tmp_85671 = lifted_lambda_res_79051;\n                redout_tmp_85672 = lifted_lambda_res_79052;\n                redout_81502 = redout_tmp_85670;\n                redout_81503 = redout_tmp_85671;\n                redout_81504 = redout_tmp_85672;\n            }\n            x_79024 = redout_81502;\n            x_79025 = redout_81503;\n            x_79026 = redout_81504;\n            acc_79021 = x_79024;\n            acc_79022 = x_79025;\n            acc_79023 = x_79026;\n        } else {\n            acc_79021 = acc_79017;\n            acc_79022 = acc_79018;\n            acc_79023 = acc_79019;\n        }\n        mem_82316[(int64_t) 0] = acc_79021;\n        mem_82320[(int64_t) 0] = acc_79022;\n        mem_82324[(int64_t) 0] = acc_79023;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_85664[i_6] = mem_82316[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_85665[i_7] = mem_82320[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_85666[i_8] = mem_82324[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_82304[i_9] = mem_param_tmp_85664[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_82305[i_10] = mem_param_tmp_85665[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_82306[i_11] = mem_param_tmp_85666[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_82327[i_12] = mem_param_82304[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_82326[i_13] = mem_param_82305[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_82325[i_14] = mem_param_82306[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_79083) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_82338[i_15] = ext_mem_8232", "7[i_15];\n    } else {\n        int64_t ltid_flat_79085;\n        int64_t ltid_79084;\n        int64_t j_79100;\n        bool cond_79105;\n        int64_t pre1d_79106;\n        int64_t pre1d_79107;\n        int64_t pre1d_79108;\n        int64_t ltid_flat_79122;\n        int64_t ltid_79121;\n        int64_t gtid_79135;\n        int64_t acc_79138;\n        bool cond_79141;\n        int64_t acc_79142;\n        \n        ltid_flat_79085 = sext_i32_i64(local_tid_85655);\n        ltid_79084 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n        j_79100 = ltid_79084 + binop_x_79099;\n        cond_79105 = slt64(j_79100, m_62843);\n        if (cond_79105) {\n            pre1d_79106 = j_79100;\n        } else {\n            pre1d_79106 = (int64_t) 0;\n        }\n        if (cond_79105) {\n            int64_t tile_elem_79110;\n            int64_t tile_elem_79111;\n            \n            tile_elem_79110 = ((__global int64_t *) mem_82281)[j_79100];\n            tile_elem_79111 = ((__global int64_t *) mem_82279)[j_79100];\n            pre1d_79107 = tile_elem_79110;\n            pre1d_79108 = tile_elem_79111;\n        } else {\n            pre1d_79107 = (int64_t) 0;\n            pre1d_79108 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83095)[ltid_79084] = pre1d_79106;\n        ((__local int64_t *) color_83094)[ltid_79084] = pre1d_79107;\n        ((__local int64_t *) color_83093)[ltid_79084] = pre1d_79108;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79122 = sext_i32_i64(local_tid_85655);\n        ltid_79121 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n        gtid_79135 = binop_x_78857 + ltid_79121;\n        acc_79138 = ext_mem_82327[(int64_t) 0];\n        cond_79141 = slt64(gtid_79135, m_62843);\n        if (cond_79141) {\n            int64_t lifted_lambda_res_79136;\n            int64_t lifted_lambda_res_79137;\n            int64_t acc_79139;\n            int64_t acc_79140;\n            int64_t x_79145;\n            int64_t x_79146;\n            int64_t x_79147;\n            int64_t redout_81506;\n",
                                    "            int64_t redout_81507;\n            int64_t redout_81508;\n            \n            lifted_lambda_res_79136 = mem_82287[(int64_t) 0];\n            lifted_lambda_res_79137 = mem_82291[(int64_t) 0];\n            acc_79139 = ext_mem_82326[(int64_t) 0];\n            acc_79140 = ext_mem_82325[(int64_t) 0];\n            redout_81506 = acc_79138;\n            redout_81507 = acc_79139;\n            redout_81508 = acc_79140;\n            for (int64_t i_81509 = 0; i_81509 < residual_input_79082; i_81509++) {\n                int64_t x_79148;\n                int64_t x_79149;\n                int64_t x_79150;\n                bool cond_79157;\n                bool cond_79158;\n                bool cond_f_res_79159;\n                bool cond_f_res_79160;\n                bool y_79161;\n                bool cond_79162;\n                bool cond_79163;\n                bool cond_t_res_79164;\n                bool x_79165;\n                bool cond_f_res_t_res_79166;\n                bool x_79167;\n                bool x_79168;\n                bool y_79169;\n                bool cond_79170;\n                int64_t lifted_lambda_res_79171;\n                int64_t lifted_lambda_res_79172;\n                int64_t lifted_lambda_res_79173;\n                int64_t redout_tmp_85673;\n                int64_t redout_tmp_85674;\n                int64_t redout_tmp_85675;\n                \n                x_79148 = ((__local int64_t *) color_83095)[i_81509];\n                x_79149 = ((__local int64_t *) color_83094)[i_81509];\n                x_79150 = ((__local int64_t *) color_83093)[i_81509];\n                cond_79157 = redout_81507 == lifted_lambda_res_79136;\n                cond_79158 = !cond_79157;\n                cond_f_res_79159 = redout_81508 == lifted_lambda_res_79137;\n                cond_f_res_79160 = !cond_f_res_79159;\n                y_79161 = cond_79157 && cond_f_res_79160;\n                cond_79162 = cond_79158 || y_79161;\n                cond_79163 = slt64(x_79148, redout_81506);\n       ", "         cond_t_res_79164 = x_79149 == lifted_lambda_res_79136;\n                x_79165 = cond_79163 && cond_t_res_79164;\n                cond_f_res_t_res_79166 = x_79150 == lifted_lambda_res_79137;\n                x_79167 = x_79165 && cond_f_res_t_res_79166;\n                x_79168 = !cond_79162;\n                y_79169 = x_79167 && x_79168;\n                cond_79170 = cond_79162 || y_79169;\n                if (cond_79170) {\n                    lifted_lambda_res_79171 = x_79148;\n                } else {\n                    lifted_lambda_res_79171 = redout_81506;\n                }\n                if (cond_79170) {\n                    lifted_lambda_res_79172 = x_79149;\n                } else {\n                    lifted_lambda_res_79172 = redout_81507;\n                }\n                if (cond_79170) {\n                    lifted_lambda_res_79173 = x_79150;\n                } else {\n                    lifted_lambda_res_79173 = redout_81508;\n                }\n                redout_tmp_85673 = lifted_lambda_res_79171;\n                redout_tmp_85674 = lifted_lambda_res_79172;\n                redout_tmp_85675 = lifted_lambda_res_79173;\n                redout_81506 = redout_tmp_85673;\n                redout_81507 = redout_tmp_85674;\n                redout_81508 = redout_tmp_85675;\n            }\n            x_79145 = redout_81506;\n            x_79146 = redout_81507;\n            x_79147 = redout_81508;\n            acc_79142 = x_79145;\n        } else {\n            acc_79142 = acc_79138;\n        }\n        mem_82337[(int64_t) 0] = acc_79142;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_82338[i_16] = mem_82337[i_16];\n    }\n    ltid_flat_79181 = sext_i32_i64(local_tid_85655);\n    ltid_79180 = sext_i32_i64(sext_i64_i32(ltid_pre_85659));\n    gtid_79187 = binop_x_78857 + ltid_79180;\n    cond_79191 = slt64(gtid_79187, m_62843);\n    if (cond_79191) {\n        int64_t defunc_0_f_res_79188;\n        bool lifted_lambda_res_", "79195;\n        int64_t defunc_0_f_res_79196;\n        \n        defunc_0_f_res_79188 = ext_mem_82338[(int64_t) 0];\n        lifted_lambda_res_79195 = defunc_0_f_res_79188 == gtid_79187;\n        defunc_0_f_res_79196 = btoi_bool_i64(lifted_lambda_res_79195);\n        postlude_79192 = defunc_0_f_res_79196;\n    } else {\n        postlude_79192 = (int64_t) 0;\n    }\n    mem_82342[(int64_t) 0] = postlude_79192;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_85655) + tile_sizze_78847 * sext_i32_i64(block_id_85656), m_62843)) {\n        int64_t tmp_85676 = mem_82342[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82344)[sext_i32_i64(local_tid_85655) + tile_sizze_78847 * sext_i32_i64(block_id_85656)] = tmp_85676;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_78847\n    #undef bytes_82307\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_79200_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_79200(__global int *global_failure, int64_t clProc_48705, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t m_62935, int64_t ldim_79203, int64_t num_whole_tiles_79217, int64_t residual_input_79376, unsigned char cond_79377_bits, int64_t binop_x_79390, __global unsigned char *mem_82044, __global unsigned char *ext_mem_82064, __global unsigned char *mem_82077, __global unsigned char *mem_82272, __global unsigned char *mem_82421, __global unsigned char *mem_82423, __global unsigned char *mem_82522, __global unsigned char *mem_82524)\n{\n    bool cond_79377 = cond_79377_bits;\n    \n    #define tile_sizze_79202 (do_DBSCAN_doublezisegmap_intrablock_79200zitile_sizze_79202)\n    #define bytes_82490 (do_DBSCAN_doublezisegmap_intrablock_79200zibytes_82490)\n    \n    volatile __local unsigned char *color_83097_backing_1 = &shared_mem[0];\n    const int64_t color_83097_backing_1_offset = 0 + (bytes_82490 + srem64((int64_t) 8 - srem64(bytes_82490, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83096_backing_0 = &",
                                    "shared_mem[color_83097_backing_1_offset];\n    const int64_t color_83096_backing_0_offset = color_83097_backing_1_offset + (bytes_82490 + srem64((int64_t) 8 - srem64(bytes_82490, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85903;\n    int32_t tblock_sizze_85906;\n    int32_t wave_sizze_85905;\n    int32_t block_id_85904;\n    int32_t global_tid_85902;\n    int64_t gid_flat_79200;\n    int64_t slice_85908;\n    int64_t ltid_pre_85907;\n    int64_t remnant_85909;\n    int64_t slice_85910;\n    int64_t gid_79199;\n    int64_t remnant_85911;\n    __local unsigned char *color_83096;\n    __local unsigned char *color_83097;\n    int64_t binop_x_79210;\n    int64_t mem_82479[1];\n    int64_t ltid_flat_79205;\n    int64_t ltid_79204;\n    int64_t gtid_79211;\n    bool cond_79212;\n    int64_t pre_79213;\n    int64_t mem_82483[1];\n    int64_t mem_82487[1];\n    int64_t ltid_flat_79219;\n    int64_t ltid_79218;\n    int64_t gtid_79227;\n    bool cond_79228;\n    int64_t neutral_79229;\n    int64_t neutral_79230;\n    int64_t ext_mem_82503[1];\n    int64_t ext_mem_82502[1];\n    int64_t mem_param_82488[1];\n    int64_t mem_param_82489[1];\n    int64_t mem_82511[1];\n    int64_t ext_mem_82512[1];\n    int64_t mem_82516[1];\n    int64_t mem_82520[1];\n    int64_t ltid_flat_79450;\n    int64_t ltid_79449;\n    int64_t gtid_79458;\n    int64_t defunc_0_f_res_79460;\n    bool cond_79461;\n    int64_t postlude_79463;\n    int64_t postlude_79462;\n    \n    local_tid_85903 = get_local_id(0);\n    tblock_sizze_85906 = get_local_size(0);\n    wave_sizze_85905 = LOCKSTEP_WIDTH;\n    block_id_85904 = get_tblock_id(0);\n    global_tid_85902 = block_id_85904 * tblock_sizze_85906 + local_tid_85903;\n    gid_flat_79200 = sext_i32_i64(block_id_85904);\n    slice_85908 = tile_sizze_79202;\n    ltid_pre_85907 = sext_i32_i64(local_tid_85903);\n    remnant_85909 = sext_i32_i64(local_tid_85903) - ltid_pre_85907;\n    slice_85910 = ldim_79203;\n    gid_79199 = sext_i32_i64(block_id_85904);\n", "    remnant_85911 = sext_i32_i64(block_id_85904) - gid_79199;\n    color_83096 = (__local unsigned char *) color_83096_backing_0;\n    color_83097 = (__local unsigned char *) color_83097_backing_1;\n    binop_x_79210 = gid_79199 * tile_sizze_79202;\n    ltid_flat_79205 = sext_i32_i64(local_tid_85903);\n    ltid_79204 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n    gtid_79211 = ltid_79204 + binop_x_79210;\n    cond_79212 = slt64(gtid_79211, conc_tmp_62382);\n    if (cond_79212) {\n        int64_t eta_p_79214 = ((__global int64_t *) mem_82272)[gtid_79211];\n        \n        pre_79213 = eta_p_79214;\n    } else {\n        pre_79213 = (int64_t) 0;\n    }\n    mem_82479[(int64_t) 0] = pre_79213;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_79219 = sext_i32_i64(local_tid_85903);\n    ltid_79218 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n    gtid_79227 = binop_x_79210 + ltid_79218;\n    cond_79228 = slt64(gtid_79227, conc_tmp_62382);\n    if (cond_79228) {\n        int64_t eta_p_79231 = mem_82479[(int64_t) 0];\n        \n        neutral_79229 = eta_p_79231;\n        neutral_79230 = eta_p_79231;\n    } else {\n        neutral_79229 = (int64_t) 0;\n        neutral_79230 = (int64_t) 0;\n    }\n    mem_82483[(int64_t) 0] = neutral_79229;\n    mem_82487[(int64_t) 0] = neutral_79230;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_2 = 0; i_2 < 1; i_2++)\n        mem_param_82488[i_2] = mem_82483[i_2];\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82489[i_3] = mem_82487[i_3];\n    for (int64_t tile_id_79238 = 0; tile_id_79238 < num_whole_tiles_79217; tile_id_79238++) {\n        int64_t binop_x_79310;\n        int64_t ltid_flat_79309;\n        int64_t ltid_79308;\n        int64_t j_79311;\n        bool cond_79315;\n        int64_t pre1d_79316;\n        int64_t pre1d_79317;\n        int64_t mem_82497[1];\n        int64_t mem_82501[1];\n        int64_t ltid_flat_79325;\n        int64_t ltid_79324;\n        int64_t gtid_79327;\n        int64_t acc_79329;\n        in", "t64_t acc_79330;\n        bool cond_79331;\n        int64_t acc_79332;\n        int64_t acc_79333;\n        int64_t mem_param_tmp_85912[1];\n        int64_t mem_param_tmp_85913[1];\n        \n        binop_x_79310 = tile_sizze_79202 * tile_id_79238;\n        ltid_flat_79309 = sext_i32_i64(local_tid_85903);\n        ltid_79308 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n        j_79311 = ltid_79308 + binop_x_79310;\n        cond_79315 = slt64(j_79311, m_62935);\n        if (cond_79315) {\n            int64_t tile_elem_79318;\n            int64_t tile_elem_79319;\n            \n            tile_elem_79318 = ((__global int64_t *) mem_82423)[j_79311];\n            tile_elem_79319 = ((__global int64_t *) mem_82421)[j_79311];\n            pre1d_79316 = tile_elem_79318;\n            pre1d_79317 = tile_elem_79319;\n        } else {\n            pre1d_79316 = (int64_t) 0;\n            pre1d_79317 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83097)[ltid_79308] = pre1d_79316;\n        ((__local int64_t *) color_83096)[ltid_79308] = pre1d_79317;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79325 = sext_i32_i64(local_tid_85903);\n        ltid_79324 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n        gtid_79327 = binop_x_79210 + ltid_79324;\n        acc_79329 = mem_param_82488[(int64_t) 0];\n        acc_79330 = mem_param_82489[(int64_t) 0];\n        cond_79331 = slt64(gtid_79327, conc_tmp_62382);\n        if (cond_79331) {\n            int64_t eta_p_79328;\n            int64_t x_79334;\n            int64_t x_79335;\n            int64_t redout_81513;\n            int64_t redout_81514;\n            \n            eta_p_79328 = mem_82479[(int64_t) 0];\n            redout_81513 = acc_79329;\n            redout_81514 = acc_79330;\n            for (int64_t i_81515 = 0; i_81515 < tile_sizze_79202; i_81515++) {\n                int64_t x_79336;\n                int64_t x_79337;\n                bool cond_79342;\n                bool cond_79343;\n                bool cond_f_res_79344;\n                ",
                                    "bool y_79345;\n                bool cond_79346;\n                bool cond_79347;\n                bool cond_f_res_t_res_79348;\n                bool x_79349;\n                bool x_79350;\n                bool y_79351;\n                bool cond_79352;\n                int64_t lifted_lambda_res_79353;\n                int64_t lifted_lambda_res_79354;\n                int64_t redout_tmp_85916;\n                int64_t redout_tmp_85917;\n                \n                x_79336 = ((__local int64_t *) color_83097)[i_81515];\n                x_79337 = ((__local int64_t *) color_83096)[i_81515];\n                cond_79342 = redout_81513 == eta_p_79328;\n                cond_79343 = !cond_79342;\n                cond_f_res_79344 = slt64(redout_81514, (int64_t) 0);\n                y_79345 = cond_79342 && cond_f_res_79344;\n                cond_79346 = cond_79343 || y_79345;\n                cond_79347 = slt64(x_79337, redout_81514);\n                cond_f_res_t_res_79348 = x_79336 == eta_p_79328;\n                x_79349 = cond_79347 && cond_f_res_t_res_79348;\n                x_79350 = !cond_79346;\n                y_79351 = x_79349 && x_79350;\n                cond_79352 = cond_79346 || y_79351;\n                if (cond_79352) {\n                    lifted_lambda_res_79353 = x_79336;\n                } else {\n                    lifted_lambda_res_79353 = redout_81513;\n                }\n                if (cond_79352) {\n                    lifted_lambda_res_79354 = x_79337;\n                } else {\n                    lifted_lambda_res_79354 = redout_81514;\n                }\n                redout_tmp_85916 = lifted_lambda_res_79353;\n                redout_tmp_85917 = lifted_lambda_res_79354;\n                redout_81513 = redout_tmp_85916;\n                redout_81514 = redout_tmp_85917;\n            }\n            x_79334 = redout_81513;\n            x_79335 = redout_81514;\n            acc_79332 = x_79334;\n            acc_79333 = x_79335;\n        } else {\n            acc_79332 = acc_79329;\n   ", "         acc_79333 = acc_79330;\n        }\n        mem_82497[(int64_t) 0] = acc_79332;\n        mem_82501[(int64_t) 0] = acc_79333;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_4 = 0; i_4 < 1; i_4++)\n            mem_param_tmp_85912[i_4] = mem_82497[i_4];\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            mem_param_tmp_85913[i_5] = mem_82501[i_5];\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_82488[i_6] = mem_param_tmp_85912[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_82489[i_7] = mem_param_tmp_85913[i_7];\n    }\n    for (int32_t i_8 = 0; i_8 < 1; i_8++)\n        ext_mem_82503[i_8] = mem_param_82488[i_8];\n    for (int32_t i_9 = 0; i_9 < 1; i_9++)\n        ext_mem_82502[i_9] = mem_param_82489[i_9];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_79377) {\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            ext_mem_82512[i_10] = ext_mem_82502[i_10];\n    } else {\n        int64_t ltid_flat_79379;\n        int64_t ltid_79378;\n        int64_t j_79391;\n        bool cond_79395;\n        int64_t pre1d_79396;\n        int64_t pre1d_79397;\n        int64_t ltid_flat_79407;\n        int64_t ltid_79406;\n        int64_t gtid_79417;\n        int64_t acc_79420;\n        bool cond_79421;\n        int64_t acc_79423;\n        \n        ltid_flat_79379 = sext_i32_i64(local_tid_85903);\n        ltid_79378 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n        j_79391 = ltid_79378 + binop_x_79390;\n        cond_79395 = slt64(j_79391, m_62935);\n        if (cond_79395) {\n            int64_t tile_elem_79398;\n            int64_t tile_elem_79399;\n            \n            tile_elem_79398 = ((__global int64_t *) mem_82423)[j_79391];\n            tile_elem_79399 = ((__global int64_t *) mem_82421)[j_79391];\n            pre1d_79396 = tile_elem_79398;\n            pre1d_79397 = tile_elem_79399;\n        } else {\n            pre1d_79396 = (int64_t) 0;\n            pre1d_79397 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83097)", "[ltid_79378] = pre1d_79396;\n        ((__local int64_t *) color_83096)[ltid_79378] = pre1d_79397;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79407 = sext_i32_i64(local_tid_85903);\n        ltid_79406 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n        gtid_79417 = binop_x_79210 + ltid_79406;\n        acc_79420 = ext_mem_82502[(int64_t) 0];\n        cond_79421 = slt64(gtid_79417, conc_tmp_62382);\n        if (cond_79421) {\n            int64_t eta_p_79418;\n            int64_t acc_79419;\n            int64_t x_79424;\n            int64_t x_79425;\n            int64_t redout_81516;\n            int64_t redout_81517;\n            \n            eta_p_79418 = mem_82479[(int64_t) 0];\n            acc_79419 = ext_mem_82503[(int64_t) 0];\n            redout_81516 = acc_79419;\n            redout_81517 = acc_79420;\n            for (int64_t i_81518 = 0; i_81518 < residual_input_79376; i_81518++) {\n                int64_t x_79426;\n                int64_t x_79427;\n                bool cond_79432;\n                bool cond_79433;\n                bool cond_f_res_79434;\n                bool y_79435;\n                bool cond_79436;\n                bool cond_79437;\n                bool cond_f_res_t_res_79438;\n                bool x_79439;\n                bool x_79440;\n                bool y_79441;\n                bool cond_79442;\n                int64_t lifted_lambda_res_79443;\n                int64_t lifted_lambda_res_79444;\n                int64_t redout_tmp_85918;\n                int64_t redout_tmp_85919;\n                \n                x_79426 = ((__local int64_t *) color_83097)[i_81518];\n                x_79427 = ((__local int64_t *) color_83096)[i_81518];\n                cond_79432 = redout_81516 == eta_p_79418;\n                cond_79433 = !cond_79432;\n                cond_f_res_79434 = slt64(redout_81517, (int64_t) 0);\n                y_79435 = cond_79432 && cond_f_res_79434;\n                cond_79436 = cond_79433 || y_79435;\n                cond_79437 = slt64(x_79427, red",
                                    "out_81517);\n                cond_f_res_t_res_79438 = x_79426 == eta_p_79418;\n                x_79439 = cond_79437 && cond_f_res_t_res_79438;\n                x_79440 = !cond_79436;\n                y_79441 = x_79439 && x_79440;\n                cond_79442 = cond_79436 || y_79441;\n                if (cond_79442) {\n                    lifted_lambda_res_79443 = x_79426;\n                } else {\n                    lifted_lambda_res_79443 = redout_81516;\n                }\n                if (cond_79442) {\n                    lifted_lambda_res_79444 = x_79427;\n                } else {\n                    lifted_lambda_res_79444 = redout_81517;\n                }\n                redout_tmp_85918 = lifted_lambda_res_79443;\n                redout_tmp_85919 = lifted_lambda_res_79444;\n                redout_81516 = redout_tmp_85918;\n                redout_81517 = redout_tmp_85919;\n            }\n            x_79424 = redout_81516;\n            x_79425 = redout_81517;\n            acc_79423 = x_79425;\n        } else {\n            acc_79423 = acc_79420;\n        }\n        mem_82511[(int64_t) 0] = acc_79423;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            ext_mem_82512[i_11] = mem_82511[i_11];\n    }\n    ltid_flat_79450 = sext_i32_i64(local_tid_85903);\n    ltid_79449 = sext_i32_i64(sext_i64_i32(ltid_pre_85907));\n    gtid_79458 = binop_x_79210 + ltid_79449;\n    defunc_0_f_res_79460 = ext_mem_82512[(int64_t) 0];\n    cond_79461 = slt64(gtid_79458, conc_tmp_62382);\n    if (cond_79461) {\n        postlude_79463 = defunc_0_f_res_79460;\n    } else {\n        postlude_79463 = (int64_t) 0;\n    }\n    if (cond_79461) {\n        bool index_concat_cmp_79465;\n        int64_t index_concat_branch_79466;\n        bool cond_79474;\n        bool lifted_lambda_res_t_res_79475;\n        bool x_79476;\n        int64_t defunc_0_f_res_79477;\n        \n        index_concat_cmp_79465 = sle64(conc_tmp_62375, gtid_79458);\n        if (index_concat_cmp_79465) {\n            i", "nt64_t index_concat_i_79467;\n            int64_t index_concat_79468;\n            \n            index_concat_i_79467 = sub64(gtid_79458, conc_tmp_62375);\n            index_concat_79468 = ((__global int64_t *) ext_mem_82064)[index_concat_i_79467];\n            index_concat_branch_79466 = index_concat_79468;\n        } else {\n            bool index_concat_cmp_79469;\n            int64_t index_concat_branch_79470;\n            \n            index_concat_cmp_79469 = sle64(m_62289, gtid_79458);\n            if (index_concat_cmp_79469) {\n                int64_t index_concat_i_79471;\n                int64_t index_concat_79472;\n                \n                index_concat_i_79471 = sub64(gtid_79458, m_62289);\n                index_concat_79472 = ((__global int64_t *) mem_82044)[index_concat_i_79471];\n                index_concat_branch_79470 = index_concat_79472;\n            } else {\n                int64_t index_concat_79473 = ((__global int64_t *) mem_82077)[gtid_79458];\n                \n                index_concat_branch_79470 = index_concat_79473;\n            }\n            index_concat_branch_79466 = index_concat_branch_79470;\n        }\n        cond_79474 = slt64(defunc_0_f_res_79460, clProc_48705);\n        lifted_lambda_res_t_res_79475 = sle64((int64_t) 0, index_concat_branch_79466);\n        x_79476 = cond_79474 && lifted_lambda_res_t_res_79475;\n        defunc_0_f_res_79477 = btoi_bool_i64(x_79476);\n        postlude_79462 = defunc_0_f_res_79477;\n    } else {\n        postlude_79462 = (int64_t) 0;\n    }\n    mem_82516[(int64_t) 0] = postlude_79462;\n    mem_82520[(int64_t) 0] = postlude_79463;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_85903) + tile_sizze_79202 * sext_i32_i64(block_id_85904), conc_tmp_62382)) {\n        int64_t tmp_85920 = mem_82516[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82522)[sext_i32_i64(local_tid_85903) + tile_sizze_79202 * sext_i32_i64(block_id_85904)] = tmp_85920;\n    }\n    if (slt64(sext_i32_i64(local_tid_85903", ") + tile_sizze_79202 * sext_i32_i64(block_id_85904), conc_tmp_62382)) {\n        int64_t tmp_85921 = mem_82520[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82524)[sext_i32_i64(local_tid_85903) + tile_sizze_79202 * sext_i32_i64(block_id_85904)] = tmp_85921;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_79202\n    #undef bytes_82490\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_79483_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_79483(__global int *global_failure, int64_t clProc_48705, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t m_62935, int64_t ldim_79486, int64_t num_whole_tiles_79500, int64_t residual_input_79659, unsigned char cond_79660_bits, int64_t binop_x_79673, __global unsigned char *mem_82044, __global unsigned char *ext_mem_82064, __global unsigned char *mem_82077, __global unsigned char *mem_82272, __global unsigned char *mem_82421, __global unsigned char *mem_82423, __global unsigned char *mem_82472, __global unsigned char *mem_82474)\n{\n    bool cond_79660 = cond_79660_bits;\n    \n    #define tile_sizze_79485 (do_DBSCAN_doublezisegmap_intrablock_79483zitile_sizze_79485)\n    #define bytes_82440 (do_DBSCAN_doublezisegmap_intrablock_79483zibytes_82440)\n    \n    volatile __local unsigned char *color_83099_backing_1 = &shared_mem[0];\n    const int64_t color_83099_backing_1_offset = 0 + (bytes_82440 + srem64((int64_t) 8 - srem64(bytes_82440, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83098_backing_0 = &shared_mem[color_83099_backing_1_offset];\n    const int64_t color_83098_backing_0_offset = color_83099_backing_1_offset + (bytes_82440 + srem64((int64_t) 8 - srem64(bytes_82440, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85925;\n    int32_t tblock_sizze_85928;\n    int32_t wave_sizze_85927;\n    int32_t block_id_85926;\n    int32_t global_tid_85924;\n    int64_t gid_flat_79483;\n    int64_t slice_85930;\n    int",
                                    "64_t ltid_pre_85929;\n    int64_t remnant_85931;\n    int64_t slice_85932;\n    int64_t gid_79482;\n    int64_t remnant_85933;\n    __local unsigned char *color_83098;\n    __local unsigned char *color_83099;\n    int64_t binop_x_79493;\n    int64_t mem_82429[1];\n    int64_t ltid_flat_79488;\n    int64_t ltid_79487;\n    int64_t gtid_79494;\n    bool cond_79495;\n    int64_t pre_79496;\n    int64_t mem_82433[1];\n    int64_t mem_82437[1];\n    int64_t ltid_flat_79502;\n    int64_t ltid_79501;\n    int64_t gtid_79510;\n    bool cond_79511;\n    int64_t neutral_79512;\n    int64_t neutral_79513;\n    int64_t ext_mem_82453[1];\n    int64_t ext_mem_82452[1];\n    int64_t mem_param_82438[1];\n    int64_t mem_param_82439[1];\n    int64_t mem_82461[1];\n    int64_t ext_mem_82462[1];\n    int64_t mem_82466[1];\n    int64_t mem_82470[1];\n    int64_t ltid_flat_79733;\n    int64_t ltid_79732;\n    int64_t gtid_79741;\n    int64_t defunc_0_f_res_79743;\n    bool cond_79744;\n    int64_t postlude_79746;\n    int64_t postlude_79745;\n    \n    local_tid_85925 = get_local_id(0);\n    tblock_sizze_85928 = get_local_size(0);\n    wave_sizze_85927 = LOCKSTEP_WIDTH;\n    block_id_85926 = get_tblock_id(0);\n    global_tid_85924 = block_id_85926 * tblock_sizze_85928 + local_tid_85925;\n    gid_flat_79483 = sext_i32_i64(block_id_85926);\n    slice_85930 = tile_sizze_79485;\n    ltid_pre_85929 = sext_i32_i64(local_tid_85925);\n    remnant_85931 = sext_i32_i64(local_tid_85925) - ltid_pre_85929;\n    slice_85932 = ldim_79486;\n    gid_79482 = sext_i32_i64(block_id_85926);\n    remnant_85933 = sext_i32_i64(block_id_85926) - gid_79482;\n    color_83098 = (__local unsigned char *) color_83098_backing_0;\n    color_83099 = (__local unsigned char *) color_83099_backing_1;\n    binop_x_79493 = gid_79482 * tile_sizze_79485;\n    ltid_flat_79488 = sext_i32_i64(local_tid_85925);\n    ltid_79487 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n    gtid_79494 = ltid_79487 + binop_x_79493;\n    cond_79495 = slt64(gtid_79494, conc_tmp_62382);\n    if (cond_79", "495) {\n        int64_t eta_p_79497 = ((__global int64_t *) mem_82272)[gtid_79494];\n        \n        pre_79496 = eta_p_79497;\n    } else {\n        pre_79496 = (int64_t) 0;\n    }\n    mem_82429[(int64_t) 0] = pre_79496;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_79502 = sext_i32_i64(local_tid_85925);\n    ltid_79501 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n    gtid_79510 = binop_x_79493 + ltid_79501;\n    cond_79511 = slt64(gtid_79510, conc_tmp_62382);\n    if (cond_79511) {\n        int64_t eta_p_79514 = mem_82429[(int64_t) 0];\n        \n        neutral_79512 = eta_p_79514;\n        neutral_79513 = eta_p_79514;\n    } else {\n        neutral_79512 = (int64_t) 0;\n        neutral_79513 = (int64_t) 0;\n    }\n    mem_82433[(int64_t) 0] = neutral_79512;\n    mem_82437[(int64_t) 0] = neutral_79513;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_2 = 0; i_2 < 1; i_2++)\n        mem_param_82438[i_2] = mem_82433[i_2];\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82439[i_3] = mem_82437[i_3];\n    for (int64_t tile_id_79521 = 0; tile_id_79521 < num_whole_tiles_79500; tile_id_79521++) {\n        int64_t binop_x_79593;\n        int64_t ltid_flat_79592;\n        int64_t ltid_79591;\n        int64_t j_79594;\n        bool cond_79598;\n        int64_t pre1d_79599;\n        int64_t pre1d_79600;\n        int64_t mem_82447[1];\n        int64_t mem_82451[1];\n        int64_t ltid_flat_79608;\n        int64_t ltid_79607;\n        int64_t gtid_79610;\n        int64_t acc_79612;\n        int64_t acc_79613;\n        bool cond_79614;\n        int64_t acc_79615;\n        int64_t acc_79616;\n        int64_t mem_param_tmp_85934[1];\n        int64_t mem_param_tmp_85935[1];\n        \n        binop_x_79593 = tile_sizze_79485 * tile_id_79521;\n        ltid_flat_79592 = sext_i32_i64(local_tid_85925);\n        ltid_79591 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n        j_79594 = ltid_79591 + binop_x_79593;\n        cond_79598 = slt64(j_79594, m_62935);\n        if (con", "d_79598) {\n            int64_t tile_elem_79601;\n            int64_t tile_elem_79602;\n            \n            tile_elem_79601 = ((__global int64_t *) mem_82423)[j_79594];\n            tile_elem_79602 = ((__global int64_t *) mem_82421)[j_79594];\n            pre1d_79599 = tile_elem_79601;\n            pre1d_79600 = tile_elem_79602;\n        } else {\n            pre1d_79599 = (int64_t) 0;\n            pre1d_79600 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83099)[ltid_79591] = pre1d_79599;\n        ((__local int64_t *) color_83098)[ltid_79591] = pre1d_79600;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79608 = sext_i32_i64(local_tid_85925);\n        ltid_79607 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n        gtid_79610 = binop_x_79493 + ltid_79607;\n        acc_79612 = mem_param_82438[(int64_t) 0];\n        acc_79613 = mem_param_82439[(int64_t) 0];\n        cond_79614 = slt64(gtid_79610, conc_tmp_62382);\n        if (cond_79614) {\n            int64_t eta_p_79611;\n            int64_t x_79617;\n            int64_t x_79618;\n            int64_t redout_81519;\n            int64_t redout_81520;\n            \n            eta_p_79611 = mem_82429[(int64_t) 0];\n            redout_81519 = acc_79612;\n            redout_81520 = acc_79613;\n            for (int64_t i_81521 = 0; i_81521 < tile_sizze_79485; i_81521++) {\n                int64_t x_79619;\n                int64_t x_79620;\n                bool cond_79625;\n                bool cond_79626;\n                bool cond_f_res_79627;\n                bool y_79628;\n                bool cond_79629;\n                bool cond_79630;\n                bool cond_f_res_t_res_79631;\n                bool x_79632;\n                bool x_79633;\n                bool y_79634;\n                bool cond_79635;\n                int64_t lifted_lambda_res_79636;\n                int64_t lifted_lambda_res_79637;\n                int64_t redout_tmp_85938;\n                int64_t redout_tmp_85939;\n                \n                x_79619 =",
                                    " ((__local int64_t *) color_83099)[i_81521];\n                x_79620 = ((__local int64_t *) color_83098)[i_81521];\n                cond_79625 = redout_81519 == eta_p_79611;\n                cond_79626 = !cond_79625;\n                cond_f_res_79627 = slt64(redout_81520, (int64_t) 0);\n                y_79628 = cond_79625 && cond_f_res_79627;\n                cond_79629 = cond_79626 || y_79628;\n                cond_79630 = slt64(x_79620, redout_81520);\n                cond_f_res_t_res_79631 = x_79619 == eta_p_79611;\n                x_79632 = cond_79630 && cond_f_res_t_res_79631;\n                x_79633 = !cond_79629;\n                y_79634 = x_79632 && x_79633;\n                cond_79635 = cond_79629 || y_79634;\n                if (cond_79635) {\n                    lifted_lambda_res_79636 = x_79619;\n                } else {\n                    lifted_lambda_res_79636 = redout_81519;\n                }\n                if (cond_79635) {\n                    lifted_lambda_res_79637 = x_79620;\n                } else {\n                    lifted_lambda_res_79637 = redout_81520;\n                }\n                redout_tmp_85938 = lifted_lambda_res_79636;\n                redout_tmp_85939 = lifted_lambda_res_79637;\n                redout_81519 = redout_tmp_85938;\n                redout_81520 = redout_tmp_85939;\n            }\n            x_79617 = redout_81519;\n            x_79618 = redout_81520;\n            acc_79615 = x_79617;\n            acc_79616 = x_79618;\n        } else {\n            acc_79615 = acc_79612;\n            acc_79616 = acc_79613;\n        }\n        mem_82447[(int64_t) 0] = acc_79615;\n        mem_82451[(int64_t) 0] = acc_79616;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_4 = 0; i_4 < 1; i_4++)\n            mem_param_tmp_85934[i_4] = mem_82447[i_4];\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            mem_param_tmp_85935[i_5] = mem_82451[i_5];\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_82438[i_6] = mem_param_tmp_85934[i", "_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_82439[i_7] = mem_param_tmp_85935[i_7];\n    }\n    for (int32_t i_8 = 0; i_8 < 1; i_8++)\n        ext_mem_82453[i_8] = mem_param_82438[i_8];\n    for (int32_t i_9 = 0; i_9 < 1; i_9++)\n        ext_mem_82452[i_9] = mem_param_82439[i_9];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_79660) {\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            ext_mem_82462[i_10] = ext_mem_82452[i_10];\n    } else {\n        int64_t ltid_flat_79662;\n        int64_t ltid_79661;\n        int64_t j_79674;\n        bool cond_79678;\n        int64_t pre1d_79679;\n        int64_t pre1d_79680;\n        int64_t ltid_flat_79690;\n        int64_t ltid_79689;\n        int64_t gtid_79700;\n        int64_t acc_79703;\n        bool cond_79704;\n        int64_t acc_79706;\n        \n        ltid_flat_79662 = sext_i32_i64(local_tid_85925);\n        ltid_79661 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n        j_79674 = ltid_79661 + binop_x_79673;\n        cond_79678 = slt64(j_79674, m_62935);\n        if (cond_79678) {\n            int64_t tile_elem_79681;\n            int64_t tile_elem_79682;\n            \n            tile_elem_79681 = ((__global int64_t *) mem_82423)[j_79674];\n            tile_elem_79682 = ((__global int64_t *) mem_82421)[j_79674];\n            pre1d_79679 = tile_elem_79681;\n            pre1d_79680 = tile_elem_79682;\n        } else {\n            pre1d_79679 = (int64_t) 0;\n            pre1d_79680 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83099)[ltid_79661] = pre1d_79679;\n        ((__local int64_t *) color_83098)[ltid_79661] = pre1d_79680;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79690 = sext_i32_i64(local_tid_85925);\n        ltid_79689 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n        gtid_79700 = binop_x_79493 + ltid_79689;\n        acc_79703 = ext_mem_82452[(int64_t) 0];\n        cond_79704 = slt64(gtid_79700, conc_tmp_62382);\n        if (cond_79704) {\n            int64_t eta_p_79701;\n   ", "         int64_t acc_79702;\n            int64_t x_79707;\n            int64_t x_79708;\n            int64_t redout_81522;\n            int64_t redout_81523;\n            \n            eta_p_79701 = mem_82429[(int64_t) 0];\n            acc_79702 = ext_mem_82453[(int64_t) 0];\n            redout_81522 = acc_79702;\n            redout_81523 = acc_79703;\n            for (int64_t i_81524 = 0; i_81524 < residual_input_79659; i_81524++) {\n                int64_t x_79709;\n                int64_t x_79710;\n                bool cond_79715;\n                bool cond_79716;\n                bool cond_f_res_79717;\n                bool y_79718;\n                bool cond_79719;\n                bool cond_79720;\n                bool cond_f_res_t_res_79721;\n                bool x_79722;\n                bool x_79723;\n                bool y_79724;\n                bool cond_79725;\n                int64_t lifted_lambda_res_79726;\n                int64_t lifted_lambda_res_79727;\n                int64_t redout_tmp_85940;\n                int64_t redout_tmp_85941;\n                \n                x_79709 = ((__local int64_t *) color_83099)[i_81524];\n                x_79710 = ((__local int64_t *) color_83098)[i_81524];\n                cond_79715 = redout_81522 == eta_p_79701;\n                cond_79716 = !cond_79715;\n                cond_f_res_79717 = slt64(redout_81523, (int64_t) 0);\n                y_79718 = cond_79715 && cond_f_res_79717;\n                cond_79719 = cond_79716 || y_79718;\n                cond_79720 = slt64(x_79710, redout_81523);\n                cond_f_res_t_res_79721 = x_79709 == eta_p_79701;\n                x_79722 = cond_79720 && cond_f_res_t_res_79721;\n                x_79723 = !cond_79719;\n                y_79724 = x_79722 && x_79723;\n                cond_79725 = cond_79719 || y_79724;\n                if (cond_79725) {\n                    lifted_lambda_res_79726 = x_79709;\n                } else {\n                    lifted_lambda_res_79726 = redout_81522;\n                }\n  ",
                                    "              if (cond_79725) {\n                    lifted_lambda_res_79727 = x_79710;\n                } else {\n                    lifted_lambda_res_79727 = redout_81523;\n                }\n                redout_tmp_85940 = lifted_lambda_res_79726;\n                redout_tmp_85941 = lifted_lambda_res_79727;\n                redout_81522 = redout_tmp_85940;\n                redout_81523 = redout_tmp_85941;\n            }\n            x_79707 = redout_81522;\n            x_79708 = redout_81523;\n            acc_79706 = x_79708;\n        } else {\n            acc_79706 = acc_79703;\n        }\n        mem_82461[(int64_t) 0] = acc_79706;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            ext_mem_82462[i_11] = mem_82461[i_11];\n    }\n    ltid_flat_79733 = sext_i32_i64(local_tid_85925);\n    ltid_79732 = sext_i32_i64(sext_i64_i32(ltid_pre_85929));\n    gtid_79741 = binop_x_79493 + ltid_79732;\n    defunc_0_f_res_79743 = ext_mem_82462[(int64_t) 0];\n    cond_79744 = slt64(gtid_79741, conc_tmp_62382);\n    if (cond_79744) {\n        postlude_79746 = defunc_0_f_res_79743;\n    } else {\n        postlude_79746 = (int64_t) 0;\n    }\n    if (cond_79744) {\n        bool index_concat_cmp_79748;\n        int64_t index_concat_branch_79749;\n        bool cond_79757;\n        bool lifted_lambda_res_t_res_79758;\n        bool x_79759;\n        int64_t defunc_0_f_res_79760;\n        \n        index_concat_cmp_79748 = sle64(conc_tmp_62375, gtid_79741);\n        if (index_concat_cmp_79748) {\n            int64_t index_concat_i_79750;\n            int64_t index_concat_79751;\n            \n            index_concat_i_79750 = sub64(gtid_79741, conc_tmp_62375);\n            index_concat_79751 = ((__global int64_t *) ext_mem_82064)[index_concat_i_79750];\n            index_concat_branch_79749 = index_concat_79751;\n        } else {\n            bool index_concat_cmp_79752;\n            int64_t index_concat_branch_79753;\n            \n            index_concat_cmp_79752 = sle64(m_6228", "9, gtid_79741);\n            if (index_concat_cmp_79752) {\n                int64_t index_concat_i_79754;\n                int64_t index_concat_79755;\n                \n                index_concat_i_79754 = sub64(gtid_79741, m_62289);\n                index_concat_79755 = ((__global int64_t *) mem_82044)[index_concat_i_79754];\n                index_concat_branch_79753 = index_concat_79755;\n            } else {\n                int64_t index_concat_79756 = ((__global int64_t *) mem_82077)[gtid_79741];\n                \n                index_concat_branch_79753 = index_concat_79756;\n            }\n            index_concat_branch_79749 = index_concat_branch_79753;\n        }\n        cond_79757 = slt64(defunc_0_f_res_79743, clProc_48705);\n        lifted_lambda_res_t_res_79758 = sle64((int64_t) 0, index_concat_branch_79749);\n        x_79759 = cond_79757 && lifted_lambda_res_t_res_79758;\n        defunc_0_f_res_79760 = btoi_bool_i64(x_79759);\n        postlude_79745 = defunc_0_f_res_79760;\n    } else {\n        postlude_79745 = (int64_t) 0;\n    }\n    mem_82466[(int64_t) 0] = postlude_79745;\n    mem_82470[(int64_t) 0] = postlude_79746;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_85925) + tile_sizze_79485 * sext_i32_i64(block_id_85926), conc_tmp_62382)) {\n        int64_t tmp_85942 = mem_82466[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82472)[sext_i32_i64(local_tid_85925) + tile_sizze_79485 * sext_i32_i64(block_id_85926)] = tmp_85942;\n    }\n    if (slt64(sext_i32_i64(local_tid_85925) + tile_sizze_79485 * sext_i32_i64(block_id_85926), conc_tmp_62382)) {\n        int64_t tmp_85943 = mem_82470[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82474)[sext_i32_i64(local_tid_85925) + tile_sizze_79485 * sext_i32_i64(block_id_85926)] = tmp_85943;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_79485\n    #undef bytes_82440\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_79766_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_7", "9766(__global int *global_failure, int64_t m_63000, int64_t ldim_79769, int64_t num_whole_tiles_79789, int64_t residual_input_80021, unsigned char cond_80022_bits, int64_t binop_x_80038, __global unsigned char *mem_82543, __global unsigned char *mem_82545, __global unsigned char *mem_82690)\n{\n    bool cond_80022 = cond_80022_bits;\n    \n    #define tile_sizze_79768 (do_DBSCAN_doublezisegmap_intrablock_79766zitile_sizze_79768)\n    #define bytes_82643 (do_DBSCAN_doublezisegmap_intrablock_79766zibytes_82643)\n    \n    volatile __local unsigned char *color_83102_backing_2 = &shared_mem[0];\n    const int64_t color_83102_backing_2_offset = 0 + (bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83101_backing_1 = &shared_mem[color_83102_backing_2_offset];\n    const int64_t color_83101_backing_1_offset = color_83102_backing_2_offset + (bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83100_backing_0 = &shared_mem[color_83101_backing_1_offset];\n    const int64_t color_83100_backing_0_offset = color_83101_backing_1_offset + (bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86171;\n    int32_t tblock_sizze_86174;\n    int32_t wave_sizze_86173;\n    int32_t block_id_86172;\n    int32_t global_tid_86170;\n    int64_t gid_flat_79766;\n    int64_t slice_86176;\n    int64_t ltid_pre_86175;\n    int64_t remnant_86177;\n    int64_t slice_86178;\n    int64_t gid_79765;\n    int64_t remnant_86179;\n    __local unsigned char *color_83100;\n    __local unsigned char *color_83101;\n    __local unsigned char *color_83102;\n    int64_t binop_x_79778;\n    int64_t mem_82623[1];\n    int64_t mem_82627[1];\n    int64_t ltid_flat_79771;\n    int64_t ltid_79770;\n    int64_t gtid_79779;\n    bool cond_79780;\n    int64_t pre_79781;\n    int64_t pre_79782;\n    ",
                                    "int64_t mem_82631[1];\n    int64_t mem_82635[1];\n    int64_t mem_82639[1];\n    int64_t ltid_flat_79791;\n    int64_t ltid_79790;\n    int64_t gtid_79801;\n    bool cond_79802;\n    int64_t neutral_79803;\n    int64_t neutral_79804;\n    int64_t neutral_79805;\n    int64_t ext_mem_82663[1];\n    int64_t ext_mem_82662[1];\n    int64_t ext_mem_82661[1];\n    int64_t mem_param_82640[1];\n    int64_t mem_param_82641[1];\n    int64_t mem_param_82642[1];\n    int64_t mem_82673[1];\n    int64_t mem_82677[1];\n    int64_t mem_82681[1];\n    int64_t ext_mem_82684[1];\n    int64_t ext_mem_82683[1];\n    int64_t ext_mem_82682[1];\n    int64_t mem_82688[1];\n    int64_t ltid_flat_80126;\n    int64_t ltid_80125;\n    int64_t gtid_80132;\n    bool cond_80136;\n    int64_t postlude_80137;\n    \n    local_tid_86171 = get_local_id(0);\n    tblock_sizze_86174 = get_local_size(0);\n    wave_sizze_86173 = LOCKSTEP_WIDTH;\n    block_id_86172 = get_tblock_id(0);\n    global_tid_86170 = block_id_86172 * tblock_sizze_86174 + local_tid_86171;\n    gid_flat_79766 = sext_i32_i64(block_id_86172);\n    slice_86176 = tile_sizze_79768;\n    ltid_pre_86175 = sext_i32_i64(local_tid_86171);\n    remnant_86177 = sext_i32_i64(local_tid_86171) - ltid_pre_86175;\n    slice_86178 = ldim_79769;\n    gid_79765 = sext_i32_i64(block_id_86172);\n    remnant_86179 = sext_i32_i64(block_id_86172) - gid_79765;\n    color_83100 = (__local unsigned char *) color_83100_backing_0;\n    color_83101 = (__local unsigned char *) color_83101_backing_1;\n    color_83102 = (__local unsigned char *) color_83102_backing_2;\n    binop_x_79778 = gid_79765 * tile_sizze_79768;\n    ltid_flat_79771 = sext_i32_i64(local_tid_86171);\n    ltid_79770 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n    gtid_79779 = ltid_79770 + binop_x_79778;\n    cond_79780 = slt64(gtid_79779, m_63000);\n    if (cond_79780) {\n        int64_t lifted_lambda_res_79783;\n        int64_t lifted_lambda_res_79784;\n        \n        lifted_lambda_res_79783 = ((__global int64_t *) mem_82545)[gtid_79779];\n    ", "    lifted_lambda_res_79784 = ((__global int64_t *) mem_82543)[gtid_79779];\n        pre_79781 = lifted_lambda_res_79783;\n        pre_79782 = lifted_lambda_res_79784;\n    } else {\n        pre_79781 = (int64_t) 0;\n        pre_79782 = (int64_t) 0;\n    }\n    mem_82623[(int64_t) 0] = pre_79781;\n    mem_82627[(int64_t) 0] = pre_79782;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_79791 = sext_i32_i64(local_tid_86171);\n    ltid_79790 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n    gtid_79801 = binop_x_79778 + ltid_79790;\n    cond_79802 = slt64(gtid_79801, m_63000);\n    if (cond_79802) {\n        neutral_79803 = gtid_79801;\n    } else {\n        neutral_79803 = (int64_t) 0;\n    }\n    if (cond_79802) {\n        int64_t lifted_lambda_res_79806;\n        int64_t lifted_lambda_res_79807;\n        \n        lifted_lambda_res_79806 = mem_82623[(int64_t) 0];\n        lifted_lambda_res_79807 = mem_82627[(int64_t) 0];\n        neutral_79804 = lifted_lambda_res_79806;\n        neutral_79805 = lifted_lambda_res_79807;\n    } else {\n        neutral_79804 = (int64_t) 0;\n        neutral_79805 = (int64_t) 0;\n    }\n    mem_82631[(int64_t) 0] = neutral_79803;\n    mem_82635[(int64_t) 0] = neutral_79804;\n    mem_82639[(int64_t) 0] = neutral_79805;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82640[i_3] = mem_82631[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82641[i_4] = mem_82635[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_82642[i_5] = mem_82639[i_5];\n    for (int64_t tile_id_79817 = 0; tile_id_79817 < num_whole_tiles_79789; tile_id_79817++) {\n        int64_t binop_x_79919;\n        int64_t ltid_flat_79918;\n        int64_t ltid_79917;\n        int64_t j_79920;\n        bool cond_79925;\n        int64_t pre1d_79926;\n        int64_t pre1d_79927;\n        int64_t pre1d_79928;\n        int64_t mem_82652[1];\n        int64_t mem_82656[1];\n        int64_t mem_82660[1];\n        int64_t l", "tid_flat_79939;\n        int64_t ltid_79938;\n        int64_t gtid_79941;\n        int64_t acc_79944;\n        int64_t acc_79945;\n        int64_t acc_79946;\n        bool cond_79947;\n        int64_t acc_79948;\n        int64_t acc_79949;\n        int64_t acc_79950;\n        int64_t mem_param_tmp_86180[1];\n        int64_t mem_param_tmp_86181[1];\n        int64_t mem_param_tmp_86182[1];\n        \n        binop_x_79919 = tile_sizze_79768 * tile_id_79817;\n        ltid_flat_79918 = sext_i32_i64(local_tid_86171);\n        ltid_79917 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n        j_79920 = ltid_79917 + binop_x_79919;\n        cond_79925 = slt64(j_79920, m_63000);\n        if (cond_79925) {\n            pre1d_79926 = j_79920;\n        } else {\n            pre1d_79926 = (int64_t) 0;\n        }\n        if (cond_79925) {\n            int64_t tile_elem_79930;\n            int64_t tile_elem_79931;\n            \n            tile_elem_79930 = ((__global int64_t *) mem_82545)[j_79920];\n            tile_elem_79931 = ((__global int64_t *) mem_82543)[j_79920];\n            pre1d_79927 = tile_elem_79930;\n            pre1d_79928 = tile_elem_79931;\n        } else {\n            pre1d_79927 = (int64_t) 0;\n            pre1d_79928 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83102)[ltid_79917] = pre1d_79926;\n        ((__local int64_t *) color_83101)[ltid_79917] = pre1d_79927;\n        ((__local int64_t *) color_83100)[ltid_79917] = pre1d_79928;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_79939 = sext_i32_i64(local_tid_86171);\n        ltid_79938 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n        gtid_79941 = binop_x_79778 + ltid_79938;\n        acc_79944 = mem_param_82640[(int64_t) 0];\n        acc_79945 = mem_param_82641[(int64_t) 0];\n        acc_79946 = mem_param_82642[(int64_t) 0];\n        cond_79947 = slt64(gtid_79941, m_63000);\n        if (cond_79947) {\n            int64_t lifted_lambda_res_79943;\n            int64_t x_79951;\n            int64_t x_79952;\n            int64_t",
                                    " x_79953;\n            int64_t redout_81529;\n            int64_t redout_81530;\n            int64_t redout_81531;\n            \n            lifted_lambda_res_79943 = mem_82627[(int64_t) 0];\n            redout_81529 = acc_79944;\n            redout_81530 = acc_79945;\n            redout_81531 = acc_79946;\n            for (int64_t i_81532 = 0; i_81532 < tile_sizze_79768; i_81532++) {\n                int64_t x_79954;\n                int64_t x_79955;\n                int64_t x_79956;\n                bool cond_79963;\n                bool cond_79964;\n                bool cond_f_res_79965;\n                bool y_79966;\n                bool cond_79967;\n                bool cond_79968;\n                bool cond_79969;\n                bool cond_t_res_79970;\n                bool cond_t_res_79971;\n                bool x_79972;\n                bool cond_79973;\n                bool cond_f_res_t_res_f_res_t_res_79974;\n                bool x_79975;\n                bool x_79976;\n                bool y_79977;\n                bool cond_f_res_t_res_79978;\n                bool x_79979;\n                bool x_79980;\n                bool y_79981;\n                bool cond_79982;\n                int64_t lifted_lambda_res_79983;\n                int64_t lifted_lambda_res_79984;\n                int64_t lifted_lambda_res_79985;\n                int64_t redout_tmp_86186;\n                int64_t redout_tmp_86187;\n                int64_t redout_tmp_86188;\n                \n                x_79954 = ((__local int64_t *) color_83102)[i_81532];\n                x_79955 = ((__local int64_t *) color_83101)[i_81532];\n                x_79956 = ((__local int64_t *) color_83100)[i_81532];\n                cond_79963 = redout_81531 == lifted_lambda_res_79943;\n                cond_79964 = !cond_79963;\n                cond_f_res_79965 = redout_81531 == redout_81530;\n                y_79966 = cond_79963 && cond_f_res_79965;\n                cond_79967 = cond_79964 || y_79966;\n                cond_79968 = x_79956 == lift", "ed_lambda_res_79943;\n                cond_79969 = slt64(x_79955, redout_81530);\n                cond_t_res_79970 = x_79955 == x_79956;\n                cond_t_res_79971 = !cond_t_res_79970;\n                x_79972 = cond_79969 && cond_t_res_79971;\n                cond_79973 = x_79955 == redout_81530;\n                cond_f_res_t_res_f_res_t_res_79974 = slt64(x_79954, redout_81529);\n                x_79975 = cond_79973 && cond_f_res_t_res_f_res_t_res_79974;\n                x_79976 = !x_79972;\n                y_79977 = x_79975 && x_79976;\n                cond_f_res_t_res_79978 = x_79972 || y_79977;\n                x_79979 = cond_79968 && cond_f_res_t_res_79978;\n                x_79980 = !cond_79967;\n                y_79981 = x_79979 && x_79980;\n                cond_79982 = cond_79967 || y_79981;\n                if (cond_79982) {\n                    lifted_lambda_res_79983 = x_79954;\n                } else {\n                    lifted_lambda_res_79983 = redout_81529;\n                }\n                if (cond_79982) {\n                    lifted_lambda_res_79984 = x_79956;\n                } else {\n                    lifted_lambda_res_79984 = redout_81531;\n                }\n                if (cond_79982) {\n                    lifted_lambda_res_79985 = x_79955;\n                } else {\n                    lifted_lambda_res_79985 = redout_81530;\n                }\n                redout_tmp_86186 = lifted_lambda_res_79983;\n                redout_tmp_86187 = lifted_lambda_res_79984;\n                redout_tmp_86188 = lifted_lambda_res_79985;\n                redout_81529 = redout_tmp_86186;\n                redout_81530 = redout_tmp_86187;\n                redout_81531 = redout_tmp_86188;\n            }\n            x_79951 = redout_81529;\n            x_79952 = redout_81530;\n            x_79953 = redout_81531;\n            acc_79948 = x_79951;\n            acc_79949 = x_79952;\n            acc_79950 = x_79953;\n        } else {\n            acc_79948 = acc_79944;\n            acc_7994", "9 = acc_79945;\n            acc_79950 = acc_79946;\n        }\n        mem_82652[(int64_t) 0] = acc_79948;\n        mem_82656[(int64_t) 0] = acc_79949;\n        mem_82660[(int64_t) 0] = acc_79950;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_86180[i_6] = mem_82652[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_86181[i_7] = mem_82656[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_86182[i_8] = mem_82660[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_82640[i_9] = mem_param_tmp_86180[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_82641[i_10] = mem_param_tmp_86181[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_82642[i_11] = mem_param_tmp_86182[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_82663[i_12] = mem_param_82640[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_82662[i_13] = mem_param_82641[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_82661[i_14] = mem_param_82642[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_80022) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_82684[i_15] = ext_mem_82663[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_82683[i_16] = ext_mem_82662[i_16];\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_82682[i_17] = ext_mem_82661[i_17];\n    } else {\n        int64_t ltid_flat_80024;\n        int64_t ltid_80023;\n        int64_t j_80039;\n        bool cond_80044;\n        int64_t pre1d_80045;\n        int64_t pre1d_80046;\n        int64_t pre1d_80047;\n        int64_t ltid_flat_80061;\n        int64_t ltid_80060;\n        int64_t gtid_80074;\n        int64_t acc_80077;\n        int64_t acc_80078;\n        int64_t acc_80079;\n        bool cond_80080;\n        int64_t acc_80081;\n        int64_t acc_80082;\n        ",
                                    "int64_t acc_80083;\n        \n        ltid_flat_80024 = sext_i32_i64(local_tid_86171);\n        ltid_80023 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n        j_80039 = ltid_80023 + binop_x_80038;\n        cond_80044 = slt64(j_80039, m_63000);\n        if (cond_80044) {\n            pre1d_80045 = j_80039;\n        } else {\n            pre1d_80045 = (int64_t) 0;\n        }\n        if (cond_80044) {\n            int64_t tile_elem_80049;\n            int64_t tile_elem_80050;\n            \n            tile_elem_80049 = ((__global int64_t *) mem_82545)[j_80039];\n            tile_elem_80050 = ((__global int64_t *) mem_82543)[j_80039];\n            pre1d_80046 = tile_elem_80049;\n            pre1d_80047 = tile_elem_80050;\n        } else {\n            pre1d_80046 = (int64_t) 0;\n            pre1d_80047 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83102)[ltid_80023] = pre1d_80045;\n        ((__local int64_t *) color_83101)[ltid_80023] = pre1d_80046;\n        ((__local int64_t *) color_83100)[ltid_80023] = pre1d_80047;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_80061 = sext_i32_i64(local_tid_86171);\n        ltid_80060 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n        gtid_80074 = binop_x_79778 + ltid_80060;\n        acc_80077 = ext_mem_82663[(int64_t) 0];\n        acc_80078 = ext_mem_82662[(int64_t) 0];\n        acc_80079 = ext_mem_82661[(int64_t) 0];\n        cond_80080 = slt64(gtid_80074, m_63000);\n        if (cond_80080) {\n            int64_t lifted_lambda_res_80076;\n            int64_t x_80084;\n            int64_t x_80085;\n            int64_t x_80086;\n            int64_t redout_81533;\n            int64_t redout_81534;\n            int64_t redout_81535;\n            \n            lifted_lambda_res_80076 = mem_82627[(int64_t) 0];\n            redout_81533 = acc_80077;\n            redout_81534 = acc_80078;\n            redout_81535 = acc_80079;\n            for (int64_t i_81536 = 0; i_81536 < residual_input_80021; i_81536++) {\n                int64_t x_80087;\n       ", "         int64_t x_80088;\n                int64_t x_80089;\n                bool cond_80096;\n                bool cond_80097;\n                bool cond_f_res_80098;\n                bool y_80099;\n                bool cond_80100;\n                bool cond_80101;\n                bool cond_80102;\n                bool cond_t_res_80103;\n                bool cond_t_res_80104;\n                bool x_80105;\n                bool cond_80106;\n                bool cond_f_res_t_res_f_res_t_res_80107;\n                bool x_80108;\n                bool x_80109;\n                bool y_80110;\n                bool cond_f_res_t_res_80111;\n                bool x_80112;\n                bool x_80113;\n                bool y_80114;\n                bool cond_80115;\n                int64_t lifted_lambda_res_80116;\n                int64_t lifted_lambda_res_80117;\n                int64_t lifted_lambda_res_80118;\n                int64_t redout_tmp_86189;\n                int64_t redout_tmp_86190;\n                int64_t redout_tmp_86191;\n                \n                x_80087 = ((__local int64_t *) color_83102)[i_81536];\n                x_80088 = ((__local int64_t *) color_83101)[i_81536];\n                x_80089 = ((__local int64_t *) color_83100)[i_81536];\n                cond_80096 = redout_81535 == lifted_lambda_res_80076;\n                cond_80097 = !cond_80096;\n                cond_f_res_80098 = redout_81535 == redout_81534;\n                y_80099 = cond_80096 && cond_f_res_80098;\n                cond_80100 = cond_80097 || y_80099;\n                cond_80101 = x_80089 == lifted_lambda_res_80076;\n                cond_80102 = slt64(x_80088, redout_81534);\n                cond_t_res_80103 = x_80088 == x_80089;\n                cond_t_res_80104 = !cond_t_res_80103;\n                x_80105 = cond_80102 && cond_t_res_80104;\n                cond_80106 = x_80088 == redout_81534;\n                cond_f_res_t_res_f_res_t_res_80107 = slt64(x_80087, redout_81533);\n                x_80108 = cond_80106", " && cond_f_res_t_res_f_res_t_res_80107;\n                x_80109 = !x_80105;\n                y_80110 = x_80108 && x_80109;\n                cond_f_res_t_res_80111 = x_80105 || y_80110;\n                x_80112 = cond_80101 && cond_f_res_t_res_80111;\n                x_80113 = !cond_80100;\n                y_80114 = x_80112 && x_80113;\n                cond_80115 = cond_80100 || y_80114;\n                if (cond_80115) {\n                    lifted_lambda_res_80116 = x_80087;\n                } else {\n                    lifted_lambda_res_80116 = redout_81533;\n                }\n                if (cond_80115) {\n                    lifted_lambda_res_80117 = x_80089;\n                } else {\n                    lifted_lambda_res_80117 = redout_81535;\n                }\n                if (cond_80115) {\n                    lifted_lambda_res_80118 = x_80088;\n                } else {\n                    lifted_lambda_res_80118 = redout_81534;\n                }\n                redout_tmp_86189 = lifted_lambda_res_80116;\n                redout_tmp_86190 = lifted_lambda_res_80117;\n                redout_tmp_86191 = lifted_lambda_res_80118;\n                redout_81533 = redout_tmp_86189;\n                redout_81534 = redout_tmp_86190;\n                redout_81535 = redout_tmp_86191;\n            }\n            x_80084 = redout_81533;\n            x_80085 = redout_81534;\n            x_80086 = redout_81535;\n            acc_80081 = x_80084;\n            acc_80082 = x_80085;\n            acc_80083 = x_80086;\n        } else {\n            acc_80081 = acc_80077;\n            acc_80082 = acc_80078;\n            acc_80083 = acc_80079;\n        }\n        mem_82673[(int64_t) 0] = acc_80081;\n        mem_82677[(int64_t) 0] = acc_80082;\n        mem_82681[(int64_t) 0] = acc_80083;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_82684[i_18] = mem_82673[i_18];\n        for (int32_t i_19 = 0; i_19 < 1; i_19++)\n            ext_mem_82683[i_19] = mem_826",
                                    "77[i_19];\n        for (int32_t i_20 = 0; i_20 < 1; i_20++)\n            ext_mem_82682[i_20] = mem_82681[i_20];\n    }\n    ltid_flat_80126 = sext_i32_i64(local_tid_86171);\n    ltid_80125 = sext_i32_i64(sext_i64_i32(ltid_pre_86175));\n    gtid_80132 = binop_x_79778 + ltid_80125;\n    cond_80136 = slt64(gtid_80132, m_63000);\n    if (cond_80136) {\n        int64_t defunc_0_f_res_80133;\n        int64_t defunc_0_f_res_80134;\n        int64_t defunc_0_f_res_80135;\n        bool cond_80140;\n        bool lifted_lambda_res_t_res_80141;\n        bool lifted_lambda_res_t_res_80142;\n        bool x_80143;\n        int64_t defunc_0_f_res_80144;\n        \n        defunc_0_f_res_80133 = ext_mem_82684[(int64_t) 0];\n        defunc_0_f_res_80134 = ext_mem_82683[(int64_t) 0];\n        defunc_0_f_res_80135 = ext_mem_82682[(int64_t) 0];\n        cond_80140 = gtid_80132 == defunc_0_f_res_80133;\n        lifted_lambda_res_t_res_80141 = defunc_0_f_res_80134 == defunc_0_f_res_80135;\n        lifted_lambda_res_t_res_80142 = !lifted_lambda_res_t_res_80141;\n        x_80143 = cond_80140 && lifted_lambda_res_t_res_80142;\n        defunc_0_f_res_80144 = btoi_bool_i64(x_80143);\n        postlude_80137 = defunc_0_f_res_80144;\n    } else {\n        postlude_80137 = (int64_t) 0;\n    }\n    mem_82688[(int64_t) 0] = postlude_80137;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_86171) + tile_sizze_79768 * sext_i32_i64(block_id_86172), m_63000)) {\n        int64_t tmp_86192 = mem_82688[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82690)[sext_i32_i64(local_tid_86171) + tile_sizze_79768 * sext_i32_i64(block_id_86172)] = tmp_86192;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_79768\n    #undef bytes_82643\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_80148_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_80148(__global int *global_failure, int64_t m_63000, int64_t ldim_80151, int64_t num_whole_tiles_80171, int64_t residual_input_80403, unsigned char cond_80404_bits", ", int64_t binop_x_80420, __global unsigned char *mem_82543, __global unsigned char *mem_82545, __global unsigned char *mem_82618)\n{\n    bool cond_80404 = cond_80404_bits;\n    \n    #define tile_sizze_80150 (do_DBSCAN_doublezisegmap_intrablock_80148zitile_sizze_80150)\n    #define bytes_82571 (do_DBSCAN_doublezisegmap_intrablock_80148zibytes_82571)\n    \n    volatile __local unsigned char *color_83105_backing_2 = &shared_mem[0];\n    const int64_t color_83105_backing_2_offset = 0 + (bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83104_backing_1 = &shared_mem[color_83105_backing_2_offset];\n    const int64_t color_83104_backing_1_offset = color_83105_backing_2_offset + (bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83103_backing_0 = &shared_mem[color_83104_backing_1_offset];\n    const int64_t color_83103_backing_0_offset = color_83104_backing_1_offset + (bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86196;\n    int32_t tblock_sizze_86199;\n    int32_t wave_sizze_86198;\n    int32_t block_id_86197;\n    int32_t global_tid_86195;\n    int64_t gid_flat_80148;\n    int64_t slice_86201;\n    int64_t ltid_pre_86200;\n    int64_t remnant_86202;\n    int64_t slice_86203;\n    int64_t gid_80147;\n    int64_t remnant_86204;\n    __local unsigned char *color_83103;\n    __local unsigned char *color_83104;\n    __local unsigned char *color_83105;\n    int64_t binop_x_80160;\n    int64_t mem_82551[1];\n    int64_t mem_82555[1];\n    int64_t ltid_flat_80153;\n    int64_t ltid_80152;\n    int64_t gtid_80161;\n    bool cond_80162;\n    int64_t pre_80163;\n    int64_t pre_80164;\n    int64_t mem_82559[1];\n    int64_t mem_82563[1];\n    int64_t mem_82567[1];\n    int64_t ltid_flat_80173;\n    int64_t ltid_80172;\n    int64_t gtid_80183;\n    bool co", "nd_80184;\n    int64_t neutral_80185;\n    int64_t neutral_80186;\n    int64_t neutral_80187;\n    int64_t ext_mem_82591[1];\n    int64_t ext_mem_82590[1];\n    int64_t ext_mem_82589[1];\n    int64_t mem_param_82568[1];\n    int64_t mem_param_82569[1];\n    int64_t mem_param_82570[1];\n    int64_t mem_82601[1];\n    int64_t mem_82605[1];\n    int64_t mem_82609[1];\n    int64_t ext_mem_82612[1];\n    int64_t ext_mem_82611[1];\n    int64_t ext_mem_82610[1];\n    int64_t mem_82616[1];\n    int64_t ltid_flat_80508;\n    int64_t ltid_80507;\n    int64_t gtid_80514;\n    bool cond_80518;\n    int64_t postlude_80519;\n    \n    local_tid_86196 = get_local_id(0);\n    tblock_sizze_86199 = get_local_size(0);\n    wave_sizze_86198 = LOCKSTEP_WIDTH;\n    block_id_86197 = get_tblock_id(0);\n    global_tid_86195 = block_id_86197 * tblock_sizze_86199 + local_tid_86196;\n    gid_flat_80148 = sext_i32_i64(block_id_86197);\n    slice_86201 = tile_sizze_80150;\n    ltid_pre_86200 = sext_i32_i64(local_tid_86196);\n    remnant_86202 = sext_i32_i64(local_tid_86196) - ltid_pre_86200;\n    slice_86203 = ldim_80151;\n    gid_80147 = sext_i32_i64(block_id_86197);\n    remnant_86204 = sext_i32_i64(block_id_86197) - gid_80147;\n    color_83103 = (__local unsigned char *) color_83103_backing_0;\n    color_83104 = (__local unsigned char *) color_83104_backing_1;\n    color_83105 = (__local unsigned char *) color_83105_backing_2;\n    binop_x_80160 = gid_80147 * tile_sizze_80150;\n    ltid_flat_80153 = sext_i32_i64(local_tid_86196);\n    ltid_80152 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n    gtid_80161 = ltid_80152 + binop_x_80160;\n    cond_80162 = slt64(gtid_80161, m_63000);\n    if (cond_80162) {\n        int64_t lifted_lambda_res_80165;\n        int64_t lifted_lambda_res_80166;\n        \n        lifted_lambda_res_80165 = ((__global int64_t *) mem_82545)[gtid_80161];\n        lifted_lambda_res_80166 = ((__global int64_t *) mem_82543)[gtid_80161];\n        pre_80163 = lifted_lambda_res_80165;\n        pre_80164 = lifted_lambda_res_801",
                                    "66;\n    } else {\n        pre_80163 = (int64_t) 0;\n        pre_80164 = (int64_t) 0;\n    }\n    mem_82551[(int64_t) 0] = pre_80163;\n    mem_82555[(int64_t) 0] = pre_80164;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_80173 = sext_i32_i64(local_tid_86196);\n    ltid_80172 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n    gtid_80183 = binop_x_80160 + ltid_80172;\n    cond_80184 = slt64(gtid_80183, m_63000);\n    if (cond_80184) {\n        neutral_80185 = gtid_80183;\n    } else {\n        neutral_80185 = (int64_t) 0;\n    }\n    if (cond_80184) {\n        int64_t lifted_lambda_res_80188;\n        int64_t lifted_lambda_res_80189;\n        \n        lifted_lambda_res_80188 = mem_82551[(int64_t) 0];\n        lifted_lambda_res_80189 = mem_82555[(int64_t) 0];\n        neutral_80186 = lifted_lambda_res_80188;\n        neutral_80187 = lifted_lambda_res_80189;\n    } else {\n        neutral_80186 = (int64_t) 0;\n        neutral_80187 = (int64_t) 0;\n    }\n    mem_82559[(int64_t) 0] = neutral_80185;\n    mem_82563[(int64_t) 0] = neutral_80186;\n    mem_82567[(int64_t) 0] = neutral_80187;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82568[i_3] = mem_82559[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82569[i_4] = mem_82563[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_82570[i_5] = mem_82567[i_5];\n    for (int64_t tile_id_80199 = 0; tile_id_80199 < num_whole_tiles_80171; tile_id_80199++) {\n        int64_t binop_x_80301;\n        int64_t ltid_flat_80300;\n        int64_t ltid_80299;\n        int64_t j_80302;\n        bool cond_80307;\n        int64_t pre1d_80308;\n        int64_t pre1d_80309;\n        int64_t pre1d_80310;\n        int64_t mem_82580[1];\n        int64_t mem_82584[1];\n        int64_t mem_82588[1];\n        int64_t ltid_flat_80321;\n        int64_t ltid_80320;\n        int64_t gtid_80323;\n        int64_t acc_80326;\n        int64_t acc_80327;\n        int64_t acc_80328;\n        b", "ool cond_80329;\n        int64_t acc_80330;\n        int64_t acc_80331;\n        int64_t acc_80332;\n        int64_t mem_param_tmp_86205[1];\n        int64_t mem_param_tmp_86206[1];\n        int64_t mem_param_tmp_86207[1];\n        \n        binop_x_80301 = tile_sizze_80150 * tile_id_80199;\n        ltid_flat_80300 = sext_i32_i64(local_tid_86196);\n        ltid_80299 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n        j_80302 = ltid_80299 + binop_x_80301;\n        cond_80307 = slt64(j_80302, m_63000);\n        if (cond_80307) {\n            pre1d_80308 = j_80302;\n        } else {\n            pre1d_80308 = (int64_t) 0;\n        }\n        if (cond_80307) {\n            int64_t tile_elem_80312;\n            int64_t tile_elem_80313;\n            \n            tile_elem_80312 = ((__global int64_t *) mem_82545)[j_80302];\n            tile_elem_80313 = ((__global int64_t *) mem_82543)[j_80302];\n            pre1d_80309 = tile_elem_80312;\n            pre1d_80310 = tile_elem_80313;\n        } else {\n            pre1d_80309 = (int64_t) 0;\n            pre1d_80310 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83105)[ltid_80299] = pre1d_80308;\n        ((__local int64_t *) color_83104)[ltid_80299] = pre1d_80309;\n        ((__local int64_t *) color_83103)[ltid_80299] = pre1d_80310;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_80321 = sext_i32_i64(local_tid_86196);\n        ltid_80320 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n        gtid_80323 = binop_x_80160 + ltid_80320;\n        acc_80326 = mem_param_82568[(int64_t) 0];\n        acc_80327 = mem_param_82569[(int64_t) 0];\n        acc_80328 = mem_param_82570[(int64_t) 0];\n        cond_80329 = slt64(gtid_80323, m_63000);\n        if (cond_80329) {\n            int64_t lifted_lambda_res_80325;\n            int64_t x_80333;\n            int64_t x_80334;\n            int64_t x_80335;\n            int64_t redout_81537;\n            int64_t redout_81538;\n            int64_t redout_81539;\n            \n            lifted_lambda_res_80325 =", " mem_82555[(int64_t) 0];\n            redout_81537 = acc_80326;\n            redout_81538 = acc_80327;\n            redout_81539 = acc_80328;\n            for (int64_t i_81540 = 0; i_81540 < tile_sizze_80150; i_81540++) {\n                int64_t x_80336;\n                int64_t x_80337;\n                int64_t x_80338;\n                bool cond_80345;\n                bool cond_80346;\n                bool cond_f_res_80347;\n                bool y_80348;\n                bool cond_80349;\n                bool cond_80350;\n                bool cond_80351;\n                bool cond_t_res_80352;\n                bool cond_t_res_80353;\n                bool x_80354;\n                bool cond_80355;\n                bool cond_f_res_t_res_f_res_t_res_80356;\n                bool x_80357;\n                bool x_80358;\n                bool y_80359;\n                bool cond_f_res_t_res_80360;\n                bool x_80361;\n                bool x_80362;\n                bool y_80363;\n                bool cond_80364;\n                int64_t lifted_lambda_res_80365;\n                int64_t lifted_lambda_res_80366;\n                int64_t lifted_lambda_res_80367;\n                int64_t redout_tmp_86211;\n                int64_t redout_tmp_86212;\n                int64_t redout_tmp_86213;\n                \n                x_80336 = ((__local int64_t *) color_83105)[i_81540];\n                x_80337 = ((__local int64_t *) color_83104)[i_81540];\n                x_80338 = ((__local int64_t *) color_83103)[i_81540];\n                cond_80345 = redout_81539 == lifted_lambda_res_80325;\n                cond_80346 = !cond_80345;\n                cond_f_res_80347 = redout_81539 == redout_81538;\n                y_80348 = cond_80345 && cond_f_res_80347;\n                cond_80349 = cond_80346 || y_80348;\n                cond_80350 = x_80338 == lifted_lambda_res_80325;\n                cond_80351 = slt64(x_80337, redout_81538);\n                cond_t_res_80352 = x_80337 == x_80338;\n                cond_t_res_",
                                    "80353 = !cond_t_res_80352;\n                x_80354 = cond_80351 && cond_t_res_80353;\n                cond_80355 = x_80337 == redout_81538;\n                cond_f_res_t_res_f_res_t_res_80356 = slt64(x_80336, redout_81537);\n                x_80357 = cond_80355 && cond_f_res_t_res_f_res_t_res_80356;\n                x_80358 = !x_80354;\n                y_80359 = x_80357 && x_80358;\n                cond_f_res_t_res_80360 = x_80354 || y_80359;\n                x_80361 = cond_80350 && cond_f_res_t_res_80360;\n                x_80362 = !cond_80349;\n                y_80363 = x_80361 && x_80362;\n                cond_80364 = cond_80349 || y_80363;\n                if (cond_80364) {\n                    lifted_lambda_res_80365 = x_80336;\n                } else {\n                    lifted_lambda_res_80365 = redout_81537;\n                }\n                if (cond_80364) {\n                    lifted_lambda_res_80366 = x_80338;\n                } else {\n                    lifted_lambda_res_80366 = redout_81539;\n                }\n                if (cond_80364) {\n                    lifted_lambda_res_80367 = x_80337;\n                } else {\n                    lifted_lambda_res_80367 = redout_81538;\n                }\n                redout_tmp_86211 = lifted_lambda_res_80365;\n                redout_tmp_86212 = lifted_lambda_res_80366;\n                redout_tmp_86213 = lifted_lambda_res_80367;\n                redout_81537 = redout_tmp_86211;\n                redout_81538 = redout_tmp_86212;\n                redout_81539 = redout_tmp_86213;\n            }\n            x_80333 = redout_81537;\n            x_80334 = redout_81538;\n            x_80335 = redout_81539;\n            acc_80330 = x_80333;\n            acc_80331 = x_80334;\n            acc_80332 = x_80335;\n        } else {\n            acc_80330 = acc_80326;\n            acc_80331 = acc_80327;\n            acc_80332 = acc_80328;\n        }\n        mem_82580[(int64_t) 0] = acc_80330;\n        mem_82584[(int64_t) 0] = acc_80331;\n        mem_82", "588[(int64_t) 0] = acc_80332;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_86205[i_6] = mem_82580[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_86206[i_7] = mem_82584[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_86207[i_8] = mem_82588[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_82568[i_9] = mem_param_tmp_86205[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_82569[i_10] = mem_param_tmp_86206[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_82570[i_11] = mem_param_tmp_86207[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_82591[i_12] = mem_param_82568[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_82590[i_13] = mem_param_82569[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_82589[i_14] = mem_param_82570[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_80404) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_82612[i_15] = ext_mem_82591[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_82611[i_16] = ext_mem_82590[i_16];\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_82610[i_17] = ext_mem_82589[i_17];\n    } else {\n        int64_t ltid_flat_80406;\n        int64_t ltid_80405;\n        int64_t j_80421;\n        bool cond_80426;\n        int64_t pre1d_80427;\n        int64_t pre1d_80428;\n        int64_t pre1d_80429;\n        int64_t ltid_flat_80443;\n        int64_t ltid_80442;\n        int64_t gtid_80456;\n        int64_t acc_80459;\n        int64_t acc_80460;\n        int64_t acc_80461;\n        bool cond_80462;\n        int64_t acc_80463;\n        int64_t acc_80464;\n        int64_t acc_80465;\n        \n        ltid_flat_80406 = sext_i32_i64(local_tid_86196);\n        ltid_80405 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n        j_80", "421 = ltid_80405 + binop_x_80420;\n        cond_80426 = slt64(j_80421, m_63000);\n        if (cond_80426) {\n            pre1d_80427 = j_80421;\n        } else {\n            pre1d_80427 = (int64_t) 0;\n        }\n        if (cond_80426) {\n            int64_t tile_elem_80431;\n            int64_t tile_elem_80432;\n            \n            tile_elem_80431 = ((__global int64_t *) mem_82545)[j_80421];\n            tile_elem_80432 = ((__global int64_t *) mem_82543)[j_80421];\n            pre1d_80428 = tile_elem_80431;\n            pre1d_80429 = tile_elem_80432;\n        } else {\n            pre1d_80428 = (int64_t) 0;\n            pre1d_80429 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_83105)[ltid_80405] = pre1d_80427;\n        ((__local int64_t *) color_83104)[ltid_80405] = pre1d_80428;\n        ((__local int64_t *) color_83103)[ltid_80405] = pre1d_80429;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_80443 = sext_i32_i64(local_tid_86196);\n        ltid_80442 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n        gtid_80456 = binop_x_80160 + ltid_80442;\n        acc_80459 = ext_mem_82591[(int64_t) 0];\n        acc_80460 = ext_mem_82590[(int64_t) 0];\n        acc_80461 = ext_mem_82589[(int64_t) 0];\n        cond_80462 = slt64(gtid_80456, m_63000);\n        if (cond_80462) {\n            int64_t lifted_lambda_res_80458;\n            int64_t x_80466;\n            int64_t x_80467;\n            int64_t x_80468;\n            int64_t redout_81541;\n            int64_t redout_81542;\n            int64_t redout_81543;\n            \n            lifted_lambda_res_80458 = mem_82555[(int64_t) 0];\n            redout_81541 = acc_80459;\n            redout_81542 = acc_80460;\n            redout_81543 = acc_80461;\n            for (int64_t i_81544 = 0; i_81544 < residual_input_80403; i_81544++) {\n                int64_t x_80469;\n                int64_t x_80470;\n                int64_t x_80471;\n                bool cond_80478;\n                bool cond_80479;\n                bool cond_f_res_80480",
                                    ";\n                bool y_80481;\n                bool cond_80482;\n                bool cond_80483;\n                bool cond_80484;\n                bool cond_t_res_80485;\n                bool cond_t_res_80486;\n                bool x_80487;\n                bool cond_80488;\n                bool cond_f_res_t_res_f_res_t_res_80489;\n                bool x_80490;\n                bool x_80491;\n                bool y_80492;\n                bool cond_f_res_t_res_80493;\n                bool x_80494;\n                bool x_80495;\n                bool y_80496;\n                bool cond_80497;\n                int64_t lifted_lambda_res_80498;\n                int64_t lifted_lambda_res_80499;\n                int64_t lifted_lambda_res_80500;\n                int64_t redout_tmp_86214;\n                int64_t redout_tmp_86215;\n                int64_t redout_tmp_86216;\n                \n                x_80469 = ((__local int64_t *) color_83105)[i_81544];\n                x_80470 = ((__local int64_t *) color_83104)[i_81544];\n                x_80471 = ((__local int64_t *) color_83103)[i_81544];\n                cond_80478 = redout_81543 == lifted_lambda_res_80458;\n                cond_80479 = !cond_80478;\n                cond_f_res_80480 = redout_81543 == redout_81542;\n                y_80481 = cond_80478 && cond_f_res_80480;\n                cond_80482 = cond_80479 || y_80481;\n                cond_80483 = x_80471 == lifted_lambda_res_80458;\n                cond_80484 = slt64(x_80470, redout_81542);\n                cond_t_res_80485 = x_80470 == x_80471;\n                cond_t_res_80486 = !cond_t_res_80485;\n                x_80487 = cond_80484 && cond_t_res_80486;\n                cond_80488 = x_80470 == redout_81542;\n                cond_f_res_t_res_f_res_t_res_80489 = slt64(x_80469, redout_81541);\n                x_80490 = cond_80488 && cond_f_res_t_res_f_res_t_res_80489;\n                x_80491 = !x_80487;\n                y_80492 = x_80490 && x_80491;\n                cond_f_res_t_res_80493 =", " x_80487 || y_80492;\n                x_80494 = cond_80483 && cond_f_res_t_res_80493;\n                x_80495 = !cond_80482;\n                y_80496 = x_80494 && x_80495;\n                cond_80497 = cond_80482 || y_80496;\n                if (cond_80497) {\n                    lifted_lambda_res_80498 = x_80469;\n                } else {\n                    lifted_lambda_res_80498 = redout_81541;\n                }\n                if (cond_80497) {\n                    lifted_lambda_res_80499 = x_80471;\n                } else {\n                    lifted_lambda_res_80499 = redout_81543;\n                }\n                if (cond_80497) {\n                    lifted_lambda_res_80500 = x_80470;\n                } else {\n                    lifted_lambda_res_80500 = redout_81542;\n                }\n                redout_tmp_86214 = lifted_lambda_res_80498;\n                redout_tmp_86215 = lifted_lambda_res_80499;\n                redout_tmp_86216 = lifted_lambda_res_80500;\n                redout_81541 = redout_tmp_86214;\n                redout_81542 = redout_tmp_86215;\n                redout_81543 = redout_tmp_86216;\n            }\n            x_80466 = redout_81541;\n            x_80467 = redout_81542;\n            x_80468 = redout_81543;\n            acc_80463 = x_80466;\n            acc_80464 = x_80467;\n            acc_80465 = x_80468;\n        } else {\n            acc_80463 = acc_80459;\n            acc_80464 = acc_80460;\n            acc_80465 = acc_80461;\n        }\n        mem_82601[(int64_t) 0] = acc_80463;\n        mem_82605[(int64_t) 0] = acc_80464;\n        mem_82609[(int64_t) 0] = acc_80465;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_82612[i_18] = mem_82601[i_18];\n        for (int32_t i_19 = 0; i_19 < 1; i_19++)\n            ext_mem_82611[i_19] = mem_82605[i_19];\n        for (int32_t i_20 = 0; i_20 < 1; i_20++)\n            ext_mem_82610[i_20] = mem_82609[i_20];\n    }\n    ltid_flat_80508 = sext_i32_i64(local_tid_8", "6196);\n    ltid_80507 = sext_i32_i64(sext_i64_i32(ltid_pre_86200));\n    gtid_80514 = binop_x_80160 + ltid_80507;\n    cond_80518 = slt64(gtid_80514, m_63000);\n    if (cond_80518) {\n        int64_t defunc_0_f_res_80515;\n        int64_t defunc_0_f_res_80516;\n        int64_t defunc_0_f_res_80517;\n        bool cond_80522;\n        bool lifted_lambda_res_t_res_80523;\n        bool lifted_lambda_res_t_res_80524;\n        bool x_80525;\n        int64_t defunc_0_f_res_80526;\n        \n        defunc_0_f_res_80515 = ext_mem_82612[(int64_t) 0];\n        defunc_0_f_res_80516 = ext_mem_82611[(int64_t) 0];\n        defunc_0_f_res_80517 = ext_mem_82610[(int64_t) 0];\n        cond_80522 = gtid_80514 == defunc_0_f_res_80515;\n        lifted_lambda_res_t_res_80523 = defunc_0_f_res_80516 == defunc_0_f_res_80517;\n        lifted_lambda_res_t_res_80524 = !lifted_lambda_res_t_res_80523;\n        x_80525 = cond_80522 && lifted_lambda_res_t_res_80524;\n        defunc_0_f_res_80526 = btoi_bool_i64(x_80525);\n        postlude_80519 = defunc_0_f_res_80526;\n    } else {\n        postlude_80519 = (int64_t) 0;\n    }\n    mem_82616[(int64_t) 0] = postlude_80519;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (slt64(sext_i32_i64(local_tid_86196) + tile_sizze_80150 * sext_i32_i64(block_id_86197), m_63000)) {\n        int64_t tmp_86217 = mem_82616[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82618)[sext_i32_i64(local_tid_86196) + tile_sizze_80150 * sext_i32_i64(block_id_86197)] = tmp_86217;\n    }\n    \n  error_9:\n    return;\n    #undef tile_sizze_80150\n    #undef bytes_82571\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_80530_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_80530(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_63400, int64_t inf_63450, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, int64_t ldim_80533, int64_t num_whole_tiles_80577, int64_t residual_input_80839, unsigned char cond_80840_bits, int64_t ",
                                    "binop_x_80856, __global unsigned char *ext_mem_82716, __global unsigned char *ext_mem_82717, __global unsigned char *mem_82730, __global unsigned char *mem_82732, __global unsigned char *mem_82734, __global unsigned char *mem_82737)\n{\n    bool cond_80840 = cond_80840_bits;\n    \n    #define tile_sizze_80532 (do_DBSCAN_doublezisegmap_intrablock_80530zitile_sizze_80532)\n    #define bytes_82784 (do_DBSCAN_doublezisegmap_intrablock_80530zibytes_82784)\n    \n    volatile __local unsigned char *color_83108_backing_2 = &shared_mem[0];\n    const int64_t color_83108_backing_2_offset = 0 + (bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83107_backing_1 = &shared_mem[color_83108_backing_2_offset];\n    const int64_t color_83107_backing_1_offset = color_83108_backing_2_offset + (bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83106_backing_0 = &shared_mem[color_83107_backing_1_offset];\n    const int64_t color_83106_backing_0_offset = color_83107_backing_1_offset + (bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86461;\n    int32_t tblock_sizze_86464;\n    int32_t wave_sizze_86463;\n    int32_t block_id_86462;\n    int32_t global_tid_86460;\n    int64_t gid_flat_80530;\n    int64_t slice_86466;\n    int64_t ltid_pre_86465;\n    int64_t remnant_86467;\n    int64_t slice_86468;\n    int64_t gid_80529;\n    int64_t remnant_86469;\n    __local unsigned char *color_83106;\n    __local unsigned char *color_83107;\n    __local unsigned char *color_83108;\n    int64_t binop_x_80548;\n    double mem_82757[1];\n    double mem_82761[1];\n    double mem_82765[1];\n    double mem_82769[1];\n    double mem_82773[1];\n    int64_t ltid_flat_80535;\n    int64_t ltid_80534;\n    int64_t gtid_80549;\n    bool cond_80550;\n    double pre_80551;\n    double pre", "_80552;\n    double pre_80553;\n    double pre_80554;\n    double pre_80555;\n    int64_t mem_82777[1];\n    double mem_82781[1];\n    int64_t ltid_flat_80579;\n    int64_t ltid_80578;\n    int64_t ext_mem_82799[1];\n    double ext_mem_82798[1];\n    int64_t mem_param_82782[1];\n    double mem_param_82783[1];\n    int64_t mem_82809[1];\n    int64_t ext_mem_82810[1];\n    \n    local_tid_86461 = get_local_id(0);\n    tblock_sizze_86464 = get_local_size(0);\n    wave_sizze_86463 = LOCKSTEP_WIDTH;\n    block_id_86462 = get_tblock_id(0);\n    global_tid_86460 = block_id_86462 * tblock_sizze_86464 + local_tid_86461;\n    gid_flat_80530 = sext_i32_i64(block_id_86462);\n    slice_86466 = tile_sizze_80532;\n    ltid_pre_86465 = sext_i32_i64(local_tid_86461);\n    remnant_86467 = sext_i32_i64(local_tid_86461) - ltid_pre_86465;\n    slice_86468 = ldim_80533;\n    gid_80529 = sext_i32_i64(block_id_86462);\n    remnant_86469 = sext_i32_i64(block_id_86462) - gid_80529;\n    color_83106 = (__local unsigned char *) color_83106_backing_0;\n    color_83107 = (__local unsigned char *) color_83107_backing_1;\n    color_83108 = (__local unsigned char *) color_83108_backing_2;\n    binop_x_80548 = gid_80529 * tile_sizze_80532;\n    ltid_flat_80535 = sext_i32_i64(local_tid_86461);\n    ltid_80534 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n    gtid_80549 = ltid_80534 + binop_x_80548;\n    cond_80550 = slt64(gtid_80549, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453);\n    if (cond_80550) {\n        int64_t slice_80556;\n        double eta_p_80557;\n        double eta_p_80559;\n        double zt_res_80560;\n        double zt_res_80561;\n        double zs_res_80562;\n        double zs_res_80563;\n        double d_haversine_res_80564;\n        double d_haversine_res_80565;\n        double cos_res_80566;\n        \n        slice_80556 = inf_63450 + gtid_80549;\n        eta_p_80557 = ((__global double *) ext_mem_82717)[slice_80556];\n        eta_p_80559 = ((__global double *) ext_mem_82716)[slice_80556];\n        zt_res_80560 = 3.141592653589793", " * eta_p_80557;\n        zt_res_80561 = 3.141592653589793 * eta_p_80559;\n        zs_res_80562 = zt_res_80560 / 180.0;\n        zs_res_80563 = zt_res_80561 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_80564 = eta_p_80557;\n        } else {\n            d_haversine_res_80564 = zs_res_80562;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_80565 = eta_p_80559;\n        } else {\n            d_haversine_res_80565 = zs_res_80563;\n        }\n        cos_res_80566 = futrts_cos64(d_haversine_res_80564);\n        pre_80551 = eta_p_80557;\n        pre_80552 = eta_p_80559;\n        pre_80553 = d_haversine_res_80564;\n        pre_80554 = d_haversine_res_80565;\n        pre_80555 = cos_res_80566;\n    } else {\n        pre_80551 = 0.0;\n        pre_80552 = 0.0;\n        pre_80553 = 0.0;\n        pre_80554 = 0.0;\n        pre_80555 = 0.0;\n    }\n    mem_82757[(int64_t) 0] = pre_80551;\n    mem_82761[(int64_t) 0] = pre_80552;\n    mem_82765[(int64_t) 0] = pre_80553;\n    mem_82769[(int64_t) 0] = pre_80554;\n    mem_82773[(int64_t) 0] = pre_80555;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_80579 = sext_i32_i64(local_tid_86461);\n    ltid_80578 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n    mem_82777[(int64_t) 0] = (int64_t) -1;\n    mem_82781[(int64_t) 0] = INFINITY;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82782[i_3] = mem_82777[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82783[i_4] = mem_82781[i_4];\n    for (int64_t tile_id_80587 = 0; tile_id_80587 < num_whole_tiles_80577; tile_id_80587++) {\n        int64_t binop_x_80704;\n        int64_t ltid_flat_80703;\n        int64_t ltid_80702;\n        int64_t j_80705;\n        bool cond_80713;\n        double pre1d_80714;\n        double pre1d_80715;\n        int64_t pre1d_80716;\n        int64_t mem_82793[1];\n        double mem_82797[1];\n        int64_t ltid_flat_80726;\n        int64_t ltid_",
                                    "80725;\n        int64_t gtid_80728;\n        int64_t acc_80734;\n        double acc_80735;\n        bool cond_80736;\n        int64_t acc_80737;\n        double acc_80738;\n        int64_t mem_param_tmp_86470[1];\n        double mem_param_tmp_86471[1];\n        \n        binop_x_80704 = tile_sizze_80532 * tile_id_80587;\n        ltid_flat_80703 = sext_i32_i64(local_tid_86461);\n        ltid_80702 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n        j_80705 = ltid_80702 + binop_x_80704;\n        cond_80713 = slt64(j_80705, m_63400);\n        if (cond_80713) {\n            double tile_elem_80717;\n            double tile_elem_80718;\n            int64_t tile_elem_80719;\n            \n            tile_elem_80717 = ((__global double *) mem_82732)[j_80705];\n            tile_elem_80718 = ((__global double *) mem_82730)[j_80705];\n            tile_elem_80719 = ((__global int64_t *) mem_82734)[j_80705];\n            pre1d_80714 = tile_elem_80717;\n            pre1d_80715 = tile_elem_80718;\n            pre1d_80716 = tile_elem_80719;\n        } else {\n            pre1d_80714 = 0.0;\n            pre1d_80715 = 0.0;\n            pre1d_80716 = (int64_t) 0;\n        }\n        ((__local double *) color_83108)[ltid_80702] = pre1d_80714;\n        ((__local double *) color_83107)[ltid_80702] = pre1d_80715;\n        ((__local int64_t *) color_83106)[ltid_80702] = pre1d_80716;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_80726 = sext_i32_i64(local_tid_86461);\n        ltid_80725 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n        gtid_80728 = binop_x_80548 + ltid_80725;\n        acc_80734 = mem_param_82782[(int64_t) 0];\n        acc_80735 = mem_param_82783[(int64_t) 0];\n        cond_80736 = slt64(gtid_80728, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453);\n        if (cond_80736) {\n            double eta_p_80729;\n            double eta_p_80730;\n            double d_haversine_res_80731;\n            double d_haversine_res_80732;\n            double cos_res_80733;\n            int64_t x_80739;\n            double x", "_80740;\n            int64_t redout_81545;\n            double redout_81546;\n            \n            eta_p_80729 = mem_82757[(int64_t) 0];\n            eta_p_80730 = mem_82761[(int64_t) 0];\n            d_haversine_res_80731 = mem_82765[(int64_t) 0];\n            d_haversine_res_80732 = mem_82769[(int64_t) 0];\n            cos_res_80733 = mem_82773[(int64_t) 0];\n            redout_81545 = acc_80734;\n            redout_81546 = acc_80735;\n            for (int64_t i_81547 = 0; i_81547 < tile_sizze_80532; i_81547++) {\n                double eta_p_80741;\n                double eta_p_80742;\n                double dist_res_80744;\n                bool zg_res_80781;\n                bool zg_res_80782;\n                bool x_80783;\n                int64_t lifted_lambda_res_80784;\n                double lifted_lambda_res_80785;\n                int64_t redout_tmp_86474;\n                double redout_tmp_86475;\n                \n                eta_p_80741 = ((__local double *) color_83108)[i_81547];\n                eta_p_80742 = ((__local double *) color_83107)[i_81547];\n                if (clBase_48691 == (int8_t) 0) {\n                    bool zeze_res_80745;\n                    double d_euclidean_res_80746;\n                    \n                    zeze_res_80745 = eta_p_80729 == eta_p_80741;\n                    if (zeze_res_80745) {\n                        double zm_res_80747;\n                        double abs_res_80748;\n                        \n                        zm_res_80747 = eta_p_80730 - eta_p_80742;\n                        abs_res_80748 = fabs64(zm_res_80747);\n                        d_euclidean_res_80746 = abs_res_80748;\n                    } else {\n                        bool zeze_res_80749;\n                        double d_euclidean_res_f_res_80750;\n                        \n                        zeze_res_80749 = eta_p_80730 == eta_p_80742;\n                        if (zeze_res_80749) {\n                            double zm_res_80751;\n                            doub", "le abs_res_80752;\n                            \n                            zm_res_80751 = eta_p_80729 - eta_p_80741;\n                            abs_res_80752 = fabs64(zm_res_80751);\n                            d_euclidean_res_f_res_80750 = abs_res_80752;\n                        } else {\n                            double zm_res_80753;\n                            double zm_res_80754;\n                            double hypot_res_80755;\n                            \n                            zm_res_80753 = eta_p_80730 - eta_p_80742;\n                            zm_res_80754 = eta_p_80729 - eta_p_80741;\n                            hypot_res_80755 = futrts_hypot64(zm_res_80754, zm_res_80753);\n                            d_euclidean_res_f_res_80750 = hypot_res_80755;\n                        }\n                        d_euclidean_res_80746 = d_euclidean_res_f_res_80750;\n                    }\n                    dist_res_80744 = d_euclidean_res_80746;\n                } else {\n                    double d_haversine_res_80756;\n                    double d_haversine_res_80757;\n                    double zm_res_80762;\n                    double cos_res_80763;\n                    double zm_res_80764;\n                    double cos_res_80765;\n                    double zt_res_80766;\n                    double zm_res_80767;\n                    double zm_res_80768;\n                    double zt_res_80769;\n                    double zp_res_80770;\n                    double zs_res_80771;\n                    double min_res_80772;\n                    double zt_res_80773;\n                    double zm_res_80774;\n                    double acos_res_80775;\n                    double zt_res_80776;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_80756 = eta_p_80741;\n                        d_haversine_res_80757 = eta_p_80742;\n                    } else {\n                        double zt_res_80758;\n                        do",
                                    "uble zs_res_80759;\n                        double zt_res_80760;\n                        double zs_res_80761;\n                        \n                        zt_res_80758 = 3.141592653589793 * eta_p_80741;\n                        zs_res_80759 = zt_res_80758 / 180.0;\n                        zt_res_80760 = 3.141592653589793 * eta_p_80742;\n                        zs_res_80761 = zt_res_80760 / 180.0;\n                        d_haversine_res_80756 = zs_res_80759;\n                        d_haversine_res_80757 = zs_res_80761;\n                    }\n                    zm_res_80762 = d_haversine_res_80731 - d_haversine_res_80756;\n                    cos_res_80763 = futrts_cos64(zm_res_80762);\n                    zm_res_80764 = 1.0 - cos_res_80763;\n                    cos_res_80765 = futrts_cos64(d_haversine_res_80756);\n                    zt_res_80766 = cos_res_80733 * cos_res_80765;\n                    zm_res_80767 = d_haversine_res_80732 - d_haversine_res_80757;\n                    zm_res_80768 = 1.0 - zm_res_80767;\n                    zt_res_80769 = zt_res_80766 * zm_res_80768;\n                    zp_res_80770 = zm_res_80764 + zt_res_80769;\n                    zs_res_80771 = zp_res_80770 / 2.0;\n                    min_res_80772 = fmin64(1.0, zs_res_80771);\n                    zt_res_80773 = 2.0 * min_res_80772;\n                    zm_res_80774 = 1.0 - zt_res_80773;\n                    acos_res_80775 = futrts_acos64(zm_res_80774);\n                    zt_res_80776 = clBase_48698 * acos_res_80775;\n                    dist_res_80744 = zt_res_80776;\n                }\n                zg_res_80781 = clBase_48692 < redout_81546;\n                zg_res_80782 = clBase_48692 < dist_res_80744;\n                x_80783 = zg_res_80781 && zg_res_80782;\n                if (x_80783) {\n                    lifted_lambda_res_80784 = (int64_t) -1;\n                    lifted_lambda_res_80785 = INFINITY;\n                } else {\n                    bool zl_res_80786;\n                    int64_t l", "ifted_lambda_res_f_res_80787;\n                    double lifted_lambda_res_f_res_80788;\n                    \n                    zl_res_80786 = redout_81546 < dist_res_80744;\n                    if (zl_res_80786) {\n                        lifted_lambda_res_f_res_80787 = redout_81545;\n                    } else {\n                        int64_t x_80743 = ((__local int64_t *) color_83106)[i_81547];\n                        \n                        lifted_lambda_res_f_res_80787 = x_80743;\n                    }\n                    if (zl_res_80786) {\n                        lifted_lambda_res_f_res_80788 = redout_81546;\n                    } else {\n                        lifted_lambda_res_f_res_80788 = dist_res_80744;\n                    }\n                    lifted_lambda_res_80784 = lifted_lambda_res_f_res_80787;\n                    lifted_lambda_res_80785 = lifted_lambda_res_f_res_80788;\n                }\n                redout_tmp_86474 = lifted_lambda_res_80784;\n                redout_tmp_86475 = lifted_lambda_res_80785;\n                redout_81545 = redout_tmp_86474;\n                redout_81546 = redout_tmp_86475;\n            }\n            x_80739 = redout_81545;\n            x_80740 = redout_81546;\n            acc_80737 = x_80739;\n            acc_80738 = x_80740;\n        } else {\n            acc_80737 = acc_80734;\n            acc_80738 = acc_80735;\n        }\n        mem_82793[(int64_t) 0] = acc_80737;\n        mem_82797[(int64_t) 0] = acc_80738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            mem_param_tmp_86470[i_5] = mem_82793[i_5];\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_86471[i_6] = mem_82797[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_82782[i_7] = mem_param_tmp_86470[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_82783[i_8] = mem_param_tmp_86471[i_8];\n    }\n    for (int32_t i_9 = 0; i_9 < 1; i_9++)\n        ext_mem_82799[i_9]", " = mem_param_82782[i_9];\n    for (int32_t i_10 = 0; i_10 < 1; i_10++)\n        ext_mem_82798[i_10] = mem_param_82783[i_10];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_80840) {\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            ext_mem_82810[i_11] = ext_mem_82799[i_11];\n    } else {\n        int64_t ltid_flat_80842;\n        int64_t ltid_80841;\n        int64_t j_80857;\n        bool cond_80865;\n        double pre1d_80866;\n        double pre1d_80867;\n        int64_t pre1d_80868;\n        int64_t ltid_flat_80882;\n        int64_t ltid_80881;\n        int64_t gtid_80892;\n        int64_t acc_80898;\n        bool cond_80900;\n        int64_t acc_80901;\n        \n        ltid_flat_80842 = sext_i32_i64(local_tid_86461);\n        ltid_80841 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n        j_80857 = ltid_80841 + binop_x_80856;\n        cond_80865 = slt64(j_80857, m_63400);\n        if (cond_80865) {\n            double tile_elem_80869;\n            double tile_elem_80870;\n            int64_t tile_elem_80871;\n            \n            tile_elem_80869 = ((__global double *) mem_82732)[j_80857];\n            tile_elem_80870 = ((__global double *) mem_82730)[j_80857];\n            tile_elem_80871 = ((__global int64_t *) mem_82734)[j_80857];\n            pre1d_80866 = tile_elem_80869;\n            pre1d_80867 = tile_elem_80870;\n            pre1d_80868 = tile_elem_80871;\n        } else {\n            pre1d_80866 = 0.0;\n            pre1d_80867 = 0.0;\n            pre1d_80868 = (int64_t) 0;\n        }\n        ((__local double *) color_83108)[ltid_80841] = pre1d_80866;\n        ((__local double *) color_83107)[ltid_80841] = pre1d_80867;\n        ((__local int64_t *) color_83106)[ltid_80841] = pre1d_80868;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_80882 = sext_i32_i64(local_tid_86461);\n        ltid_80881 = sext_i32_i64(sext_i64_i32(ltid_pre_86465));\n        gtid_80892 = binop_x_80548 + ltid_80881;\n        acc_80898 = ext_mem_82799[(int64_t) 0];\n        cond_80900 = slt64(gtid_8",
                                    "0892, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453);\n        if (cond_80900) {\n            double eta_p_80893;\n            double eta_p_80894;\n            double d_haversine_res_80895;\n            double d_haversine_res_80896;\n            double cos_res_80897;\n            double acc_80899;\n            int64_t x_80903;\n            double x_80904;\n            int64_t redout_81548;\n            double redout_81549;\n            \n            eta_p_80893 = mem_82757[(int64_t) 0];\n            eta_p_80894 = mem_82761[(int64_t) 0];\n            d_haversine_res_80895 = mem_82765[(int64_t) 0];\n            d_haversine_res_80896 = mem_82769[(int64_t) 0];\n            cos_res_80897 = mem_82773[(int64_t) 0];\n            acc_80899 = ext_mem_82798[(int64_t) 0];\n            redout_81548 = acc_80898;\n            redout_81549 = acc_80899;\n            for (int64_t i_81550 = 0; i_81550 < residual_input_80839; i_81550++) {\n                double eta_p_80905;\n                double eta_p_80906;\n                double dist_res_80908;\n                bool zg_res_80945;\n                bool zg_res_80946;\n                bool x_80947;\n                int64_t lifted_lambda_res_80948;\n                double lifted_lambda_res_80949;\n                int64_t redout_tmp_86476;\n                double redout_tmp_86477;\n                \n                eta_p_80905 = ((__local double *) color_83108)[i_81550];\n                eta_p_80906 = ((__local double *) color_83107)[i_81550];\n                if (clBase_48691 == (int8_t) 0) {\n                    bool zeze_res_80909;\n                    double d_euclidean_res_80910;\n                    \n                    zeze_res_80909 = eta_p_80893 == eta_p_80905;\n                    if (zeze_res_80909) {\n                        double zm_res_80911;\n                        double abs_res_80912;\n                        \n                        zm_res_80911 = eta_p_80894 - eta_p_80906;\n                        abs_res_80912 = fabs64(zm_res_80911);\n                        d_e", "uclidean_res_80910 = abs_res_80912;\n                    } else {\n                        bool zeze_res_80913;\n                        double d_euclidean_res_f_res_80914;\n                        \n                        zeze_res_80913 = eta_p_80894 == eta_p_80906;\n                        if (zeze_res_80913) {\n                            double zm_res_80915;\n                            double abs_res_80916;\n                            \n                            zm_res_80915 = eta_p_80893 - eta_p_80905;\n                            abs_res_80916 = fabs64(zm_res_80915);\n                            d_euclidean_res_f_res_80914 = abs_res_80916;\n                        } else {\n                            double zm_res_80917;\n                            double zm_res_80918;\n                            double hypot_res_80919;\n                            \n                            zm_res_80917 = eta_p_80894 - eta_p_80906;\n                            zm_res_80918 = eta_p_80893 - eta_p_80905;\n                            hypot_res_80919 = futrts_hypot64(zm_res_80918, zm_res_80917);\n                            d_euclidean_res_f_res_80914 = hypot_res_80919;\n                        }\n                        d_euclidean_res_80910 = d_euclidean_res_f_res_80914;\n                    }\n                    dist_res_80908 = d_euclidean_res_80910;\n                } else {\n                    double d_haversine_res_80920;\n                    double d_haversine_res_80921;\n                    double zm_res_80926;\n                    double cos_res_80927;\n                    double zm_res_80928;\n                    double cos_res_80929;\n                    double zt_res_80930;\n                    double zm_res_80931;\n                    double zm_res_80932;\n                    double zt_res_80933;\n                    double zp_res_80934;\n                    double zs_res_80935;\n                    double min_res_80936;\n                    double zt_res_80937;\n                    double zm_r", "es_80938;\n                    double acos_res_80939;\n                    double zt_res_80940;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_80920 = eta_p_80905;\n                        d_haversine_res_80921 = eta_p_80906;\n                    } else {\n                        double zt_res_80922;\n                        double zs_res_80923;\n                        double zt_res_80924;\n                        double zs_res_80925;\n                        \n                        zt_res_80922 = 3.141592653589793 * eta_p_80905;\n                        zs_res_80923 = zt_res_80922 / 180.0;\n                        zt_res_80924 = 3.141592653589793 * eta_p_80906;\n                        zs_res_80925 = zt_res_80924 / 180.0;\n                        d_haversine_res_80920 = zs_res_80923;\n                        d_haversine_res_80921 = zs_res_80925;\n                    }\n                    zm_res_80926 = d_haversine_res_80895 - d_haversine_res_80920;\n                    cos_res_80927 = futrts_cos64(zm_res_80926);\n                    zm_res_80928 = 1.0 - cos_res_80927;\n                    cos_res_80929 = futrts_cos64(d_haversine_res_80920);\n                    zt_res_80930 = cos_res_80897 * cos_res_80929;\n                    zm_res_80931 = d_haversine_res_80896 - d_haversine_res_80921;\n                    zm_res_80932 = 1.0 - zm_res_80931;\n                    zt_res_80933 = zt_res_80930 * zm_res_80932;\n                    zp_res_80934 = zm_res_80928 + zt_res_80933;\n                    zs_res_80935 = zp_res_80934 / 2.0;\n                    min_res_80936 = fmin64(1.0, zs_res_80935);\n                    zt_res_80937 = 2.0 * min_res_80936;\n                    zm_res_80938 = 1.0 - zt_res_80937;\n                    acos_res_80939 = futrts_acos64(zm_res_80938);\n                    zt_res_80940 = clBase_48698 * acos_res_80939;\n                    dist_res_80908 = zt_res_80940;\n                }\n                zg_res_8094",
                                    "5 = clBase_48692 < redout_81549;\n                zg_res_80946 = clBase_48692 < dist_res_80908;\n                x_80947 = zg_res_80945 && zg_res_80946;\n                if (x_80947) {\n                    lifted_lambda_res_80948 = (int64_t) -1;\n                    lifted_lambda_res_80949 = INFINITY;\n                } else {\n                    bool zl_res_80950;\n                    int64_t lifted_lambda_res_f_res_80951;\n                    double lifted_lambda_res_f_res_80952;\n                    \n                    zl_res_80950 = redout_81549 < dist_res_80908;\n                    if (zl_res_80950) {\n                        lifted_lambda_res_f_res_80951 = redout_81548;\n                    } else {\n                        int64_t x_80907 = ((__local int64_t *) color_83106)[i_81550];\n                        \n                        lifted_lambda_res_f_res_80951 = x_80907;\n                    }\n                    if (zl_res_80950) {\n                        lifted_lambda_res_f_res_80952 = redout_81549;\n                    } else {\n                        lifted_lambda_res_f_res_80952 = dist_res_80908;\n                    }\n                    lifted_lambda_res_80948 = lifted_lambda_res_f_res_80951;\n                    lifted_lambda_res_80949 = lifted_lambda_res_f_res_80952;\n                }\n                redout_tmp_86476 = lifted_lambda_res_80948;\n                redout_tmp_86477 = lifted_lambda_res_80949;\n                redout_81548 = redout_tmp_86476;\n                redout_81549 = redout_tmp_86477;\n            }\n            x_80903 = redout_81548;\n            x_80904 = redout_81549;\n            acc_80901 = x_80903;\n        } else {\n            acc_80901 = acc_80898;\n        }\n        mem_82809[(int64_t) 0] = acc_80901;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_12 = 0; i_12 < 1; i_12++)\n            ext_mem_82810[i_12] = mem_82809[i_12];\n    }\n    if (slt64(sext_i32_i64(local_tid_86461) + tile_sizze_80532 * sext_i32_i64(block_id_86462), dzlz7bUZLz", "mZRz20Usupz20Uinfz7dUzg_63453)) {\n        int64_t tmp_86478 = ext_mem_82810[(int64_t) 0];\n        \n        ((__global int64_t *) mem_82737)[inf_63450 + (sext_i32_i64(local_tid_86461) + tile_sizze_80532 * sext_i32_i64(block_id_86462))] = tmp_86478;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_80532\n    #undef bytes_82784\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegmap_intrablock_80971_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegmap_intrablock_80971(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t conc_tmp_62379, int64_t inf_63544, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, int64_t ldim_80974, int64_t num_whole_tiles_81018, int64_t residual_input_81280, unsigned char cond_81281_bits, int64_t binop_x_81297, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_81972, __global unsigned char *mem_82724, __global unsigned char *mem_82726, __global unsigned char *mem_82728)\n{\n    bool cond_81281 = cond_81281_bits;\n    \n    #define tile_sizze_80973 (do_DBSCAN_doublezisegmap_intrablock_80971zitile_sizze_80973)\n    #define bytes_82863 (do_DBSCAN_doublezisegmap_intrablock_80971zibytes_82863)\n    \n    volatile __local unsigned char *color_83111_backing_2 = &shared_mem[0];\n    const int64_t color_83111_backing_2_offset = 0 + (bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83110_backing_1 = &shared_mem[color_83111_backing_2_offset];\n    const int64_t color_83110_backing_1_offset = color_83111_backing_2_offset + (bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83109_backing_0 = &shared_mem[color_83110_backing_1_offset];\n    const int64_t color_83109_backing_0_offset = color_83110_backing_1_offset + (bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8)", ", (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86592;\n    int32_t tblock_sizze_86595;\n    int32_t wave_sizze_86594;\n    int32_t block_id_86593;\n    int32_t global_tid_86591;\n    int64_t gid_flat_80971;\n    int64_t slice_86597;\n    int64_t ltid_pre_86596;\n    int64_t remnant_86598;\n    int64_t slice_86599;\n    int64_t gid_80970;\n    int64_t remnant_86600;\n    __local unsigned char *color_83109;\n    __local unsigned char *color_83110;\n    __local unsigned char *color_83111;\n    int64_t binop_x_80989;\n    double mem_82836[1];\n    double mem_82840[1];\n    double mem_82844[1];\n    double mem_82848[1];\n    double mem_82852[1];\n    int64_t ltid_flat_80976;\n    int64_t ltid_80975;\n    int64_t gtid_80990;\n    bool cond_80991;\n    double pre_80992;\n    double pre_80993;\n    double pre_80994;\n    double pre_80995;\n    double pre_80996;\n    int64_t mem_82856[1];\n    double mem_82860[1];\n    int64_t ltid_flat_81020;\n    int64_t ltid_81019;\n    int64_t ext_mem_82878[1];\n    double ext_mem_82877[1];\n    int64_t mem_param_82861[1];\n    double mem_param_82862[1];\n    int64_t mem_82888[1];\n    int64_t ext_mem_82889[1];\n    \n    local_tid_86592 = get_local_id(0);\n    tblock_sizze_86595 = get_local_size(0);\n    wave_sizze_86594 = LOCKSTEP_WIDTH;\n    block_id_86593 = get_tblock_id(0);\n    global_tid_86591 = block_id_86593 * tblock_sizze_86595 + local_tid_86592;\n    gid_flat_80971 = sext_i32_i64(block_id_86593);\n    slice_86597 = tile_sizze_80973;\n    ltid_pre_86596 = sext_i32_i64(local_tid_86592);\n    remnant_86598 = sext_i32_i64(local_tid_86592) - ltid_pre_86596;\n    slice_86599 = ldim_80974;\n    gid_80970 = sext_i32_i64(block_id_86593);\n    remnant_86600 = sext_i32_i64(block_id_86593) - gid_80970;\n    color_83109 = (__local unsigned char *) color_83109_backing_0;\n    color_83110 = (__local unsigned char *) color_83110_backing_1;\n    color_83111 = (__local unsigned char *) color_83111_backing_2;\n    binop_x_80989 = gid_80970 * tile_sizze_",
                                    "80973;\n    ltid_flat_80976 = sext_i32_i64(local_tid_86592);\n    ltid_80975 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n    gtid_80990 = ltid_80975 + binop_x_80989;\n    cond_80991 = slt64(gtid_80990, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547);\n    if (cond_80991) {\n        int64_t slice_80997;\n        double eta_p_80998;\n        double eta_p_81000;\n        double zt_res_81001;\n        double zt_res_81002;\n        double zs_res_81003;\n        double zs_res_81004;\n        double d_haversine_res_81005;\n        double d_haversine_res_81006;\n        double cos_res_81007;\n        \n        slice_80997 = inf_63544 + gtid_80990;\n        eta_p_80998 = ((__global double *) current_partition_mem_81940)[slice_80997];\n        eta_p_81000 = ((__global double *) current_partition_mem_81941)[slice_80997];\n        zt_res_81001 = 3.141592653589793 * eta_p_80998;\n        zt_res_81002 = 3.141592653589793 * eta_p_81000;\n        zs_res_81003 = zt_res_81001 / 180.0;\n        zs_res_81004 = zt_res_81002 / 180.0;\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_81005 = eta_p_80998;\n        } else {\n            d_haversine_res_81005 = zs_res_81003;\n        }\n        if (clBase_48690 == (int8_t) 1) {\n            d_haversine_res_81006 = eta_p_81000;\n        } else {\n            d_haversine_res_81006 = zs_res_81004;\n        }\n        cos_res_81007 = futrts_cos64(d_haversine_res_81005);\n        pre_80992 = eta_p_80998;\n        pre_80993 = eta_p_81000;\n        pre_80994 = d_haversine_res_81005;\n        pre_80995 = d_haversine_res_81006;\n        pre_80996 = cos_res_81007;\n    } else {\n        pre_80992 = 0.0;\n        pre_80993 = 0.0;\n        pre_80994 = 0.0;\n        pre_80995 = 0.0;\n        pre_80996 = 0.0;\n    }\n    mem_82836[(int64_t) 0] = pre_80992;\n    mem_82840[(int64_t) 0] = pre_80993;\n    mem_82844[(int64_t) 0] = pre_80994;\n    mem_82848[(int64_t) 0] = pre_80995;\n    mem_82852[(int64_t) 0] = pre_80996;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_81020 = sext_i32_i64(lo", "cal_tid_86592);\n    ltid_81019 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n    mem_82856[(int64_t) 0] = (int64_t) -1;\n    mem_82860[(int64_t) 0] = INFINITY;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_82861[i_3] = mem_82856[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_82862[i_4] = mem_82860[i_4];\n    for (int64_t tile_id_81028 = 0; tile_id_81028 < num_whole_tiles_81018; tile_id_81028++) {\n        int64_t binop_x_81145;\n        int64_t ltid_flat_81144;\n        int64_t ltid_81143;\n        int64_t j_81146;\n        bool cond_81154;\n        double pre1d_81155;\n        double pre1d_81156;\n        int64_t pre1d_81157;\n        int64_t mem_82872[1];\n        double mem_82876[1];\n        int64_t ltid_flat_81167;\n        int64_t ltid_81166;\n        int64_t gtid_81169;\n        int64_t acc_81175;\n        double acc_81176;\n        bool cond_81177;\n        int64_t acc_81178;\n        double acc_81179;\n        int64_t mem_param_tmp_86601[1];\n        double mem_param_tmp_86602[1];\n        \n        binop_x_81145 = tile_sizze_80973 * tile_id_81028;\n        ltid_flat_81144 = sext_i32_i64(local_tid_86592);\n        ltid_81143 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n        j_81146 = ltid_81143 + binop_x_81145;\n        cond_81154 = slt64(j_81146, conc_tmp_62379);\n        if (cond_81154) {\n            double tile_elem_81158;\n            double tile_elem_81159;\n            int64_t tile_elem_81160;\n            \n            tile_elem_81158 = ((__global double *) mem_82726)[j_81146];\n            tile_elem_81159 = ((__global double *) mem_82728)[j_81146];\n            tile_elem_81160 = ((__global int64_t *) mem_82724)[j_81146];\n            pre1d_81155 = tile_elem_81158;\n            pre1d_81156 = tile_elem_81159;\n            pre1d_81157 = tile_elem_81160;\n        } else {\n            pre1d_81155 = 0.0;\n            pre1d_81156 = 0.0;\n            pre1d_81157 = (int64_t) 0;\n        }\n      ", "  ((__local double *) color_83111)[ltid_81143] = pre1d_81155;\n        ((__local double *) color_83110)[ltid_81143] = pre1d_81156;\n        ((__local int64_t *) color_83109)[ltid_81143] = pre1d_81157;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_81167 = sext_i32_i64(local_tid_86592);\n        ltid_81166 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n        gtid_81169 = binop_x_80989 + ltid_81166;\n        acc_81175 = mem_param_82861[(int64_t) 0];\n        acc_81176 = mem_param_82862[(int64_t) 0];\n        cond_81177 = slt64(gtid_81169, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547);\n        if (cond_81177) {\n            double eta_p_81170;\n            double eta_p_81171;\n            double d_haversine_res_81172;\n            double d_haversine_res_81173;\n            double cos_res_81174;\n            int64_t x_81180;\n            double x_81181;\n            int64_t redout_81551;\n            double redout_81552;\n            \n            eta_p_81170 = mem_82836[(int64_t) 0];\n            eta_p_81171 = mem_82840[(int64_t) 0];\n            d_haversine_res_81172 = mem_82844[(int64_t) 0];\n            d_haversine_res_81173 = mem_82848[(int64_t) 0];\n            cos_res_81174 = mem_82852[(int64_t) 0];\n            redout_81551 = acc_81175;\n            redout_81552 = acc_81176;\n            for (int64_t i_81553 = 0; i_81553 < tile_sizze_80973; i_81553++) {\n                double eta_p_81182;\n                double eta_p_81183;\n                double dist_res_81185;\n                bool zg_res_81222;\n                bool zg_res_81223;\n                bool x_81224;\n                int64_t lifted_lambda_res_81225;\n                double lifted_lambda_res_81226;\n                int64_t redout_tmp_86605;\n                double redout_tmp_86606;\n                \n                eta_p_81182 = ((__local double *) color_83111)[i_81553];\n                eta_p_81183 = ((__local double *) color_83110)[i_81553];\n                if (clBase_48691 == (int8_t) 0) {\n                    bool zeze_res_8",
                                    "1186;\n                    double d_euclidean_res_81187;\n                    \n                    zeze_res_81186 = eta_p_81170 == eta_p_81182;\n                    if (zeze_res_81186) {\n                        double zm_res_81188;\n                        double abs_res_81189;\n                        \n                        zm_res_81188 = eta_p_81171 - eta_p_81183;\n                        abs_res_81189 = fabs64(zm_res_81188);\n                        d_euclidean_res_81187 = abs_res_81189;\n                    } else {\n                        bool zeze_res_81190;\n                        double d_euclidean_res_f_res_81191;\n                        \n                        zeze_res_81190 = eta_p_81171 == eta_p_81183;\n                        if (zeze_res_81190) {\n                            double zm_res_81192;\n                            double abs_res_81193;\n                            \n                            zm_res_81192 = eta_p_81170 - eta_p_81182;\n                            abs_res_81193 = fabs64(zm_res_81192);\n                            d_euclidean_res_f_res_81191 = abs_res_81193;\n                        } else {\n                            double zm_res_81194;\n                            double zm_res_81195;\n                            double hypot_res_81196;\n                            \n                            zm_res_81194 = eta_p_81171 - eta_p_81183;\n                            zm_res_81195 = eta_p_81170 - eta_p_81182;\n                            hypot_res_81196 = futrts_hypot64(zm_res_81195, zm_res_81194);\n                            d_euclidean_res_f_res_81191 = hypot_res_81196;\n                        }\n                        d_euclidean_res_81187 = d_euclidean_res_f_res_81191;\n                    }\n                    dist_res_81185 = d_euclidean_res_81187;\n                } else {\n                    double d_haversine_res_81197;\n                    double d_haversine_res_81198;\n                    double zm_res_81203;\n                    double cos", "_res_81204;\n                    double zm_res_81205;\n                    double cos_res_81206;\n                    double zt_res_81207;\n                    double zm_res_81208;\n                    double zm_res_81209;\n                    double zt_res_81210;\n                    double zp_res_81211;\n                    double zs_res_81212;\n                    double min_res_81213;\n                    double zt_res_81214;\n                    double zm_res_81215;\n                    double acos_res_81216;\n                    double zt_res_81217;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_81197 = eta_p_81182;\n                        d_haversine_res_81198 = eta_p_81183;\n                    } else {\n                        double zt_res_81199;\n                        double zs_res_81200;\n                        double zt_res_81201;\n                        double zs_res_81202;\n                        \n                        zt_res_81199 = 3.141592653589793 * eta_p_81182;\n                        zs_res_81200 = zt_res_81199 / 180.0;\n                        zt_res_81201 = 3.141592653589793 * eta_p_81183;\n                        zs_res_81202 = zt_res_81201 / 180.0;\n                        d_haversine_res_81197 = zs_res_81200;\n                        d_haversine_res_81198 = zs_res_81202;\n                    }\n                    zm_res_81203 = d_haversine_res_81172 - d_haversine_res_81197;\n                    cos_res_81204 = futrts_cos64(zm_res_81203);\n                    zm_res_81205 = 1.0 - cos_res_81204;\n                    cos_res_81206 = futrts_cos64(d_haversine_res_81197);\n                    zt_res_81207 = cos_res_81174 * cos_res_81206;\n                    zm_res_81208 = d_haversine_res_81173 - d_haversine_res_81198;\n                    zm_res_81209 = 1.0 - zm_res_81208;\n                    zt_res_81210 = zt_res_81207 * zm_res_81209;\n                    zp_res_81211 = zm_res_81205 + zt_res_81210;\n  ", "                  zs_res_81212 = zp_res_81211 / 2.0;\n                    min_res_81213 = fmin64(1.0, zs_res_81212);\n                    zt_res_81214 = 2.0 * min_res_81213;\n                    zm_res_81215 = 1.0 - zt_res_81214;\n                    acos_res_81216 = futrts_acos64(zm_res_81215);\n                    zt_res_81217 = clBase_48698 * acos_res_81216;\n                    dist_res_81185 = zt_res_81217;\n                }\n                zg_res_81222 = clBase_48692 < redout_81552;\n                zg_res_81223 = clBase_48692 < dist_res_81185;\n                x_81224 = zg_res_81222 && zg_res_81223;\n                if (x_81224) {\n                    lifted_lambda_res_81225 = (int64_t) -1;\n                    lifted_lambda_res_81226 = INFINITY;\n                } else {\n                    bool zl_res_81227;\n                    int64_t lifted_lambda_res_f_res_81228;\n                    double lifted_lambda_res_f_res_81229;\n                    \n                    zl_res_81227 = redout_81552 < dist_res_81185;\n                    if (zl_res_81227) {\n                        lifted_lambda_res_f_res_81228 = redout_81551;\n                    } else {\n                        int64_t x_81184 = ((__local int64_t *) color_83109)[i_81553];\n                        \n                        lifted_lambda_res_f_res_81228 = x_81184;\n                    }\n                    if (zl_res_81227) {\n                        lifted_lambda_res_f_res_81229 = redout_81552;\n                    } else {\n                        lifted_lambda_res_f_res_81229 = dist_res_81185;\n                    }\n                    lifted_lambda_res_81225 = lifted_lambda_res_f_res_81228;\n                    lifted_lambda_res_81226 = lifted_lambda_res_f_res_81229;\n                }\n                redout_tmp_86605 = lifted_lambda_res_81225;\n                redout_tmp_86606 = lifted_lambda_res_81226;\n                redout_81551 = redout_tmp_86605;\n                redout_81552 = redout_tmp_86606;\n            }\n     ",
                                    "       x_81180 = redout_81551;\n            x_81181 = redout_81552;\n            acc_81178 = x_81180;\n            acc_81179 = x_81181;\n        } else {\n            acc_81178 = acc_81175;\n            acc_81179 = acc_81176;\n        }\n        mem_82872[(int64_t) 0] = acc_81178;\n        mem_82876[(int64_t) 0] = acc_81179;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            mem_param_tmp_86601[i_5] = mem_82872[i_5];\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_86602[i_6] = mem_82876[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_82861[i_7] = mem_param_tmp_86601[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_82862[i_8] = mem_param_tmp_86602[i_8];\n    }\n    for (int32_t i_9 = 0; i_9 < 1; i_9++)\n        ext_mem_82878[i_9] = mem_param_82861[i_9];\n    for (int32_t i_10 = 0; i_10 < 1; i_10++)\n        ext_mem_82877[i_10] = mem_param_82862[i_10];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_81281) {\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            ext_mem_82889[i_11] = ext_mem_82878[i_11];\n    } else {\n        int64_t ltid_flat_81283;\n        int64_t ltid_81282;\n        int64_t j_81298;\n        bool cond_81306;\n        double pre1d_81307;\n        double pre1d_81308;\n        int64_t pre1d_81309;\n        int64_t ltid_flat_81323;\n        int64_t ltid_81322;\n        int64_t gtid_81333;\n        int64_t acc_81339;\n        bool cond_81341;\n        int64_t acc_81342;\n        \n        ltid_flat_81283 = sext_i32_i64(local_tid_86592);\n        ltid_81282 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n        j_81298 = ltid_81282 + binop_x_81297;\n        cond_81306 = slt64(j_81298, conc_tmp_62379);\n        if (cond_81306) {\n            double tile_elem_81310;\n            double tile_elem_81311;\n            int64_t tile_elem_81312;\n            \n            tile_elem_81310 = ((__global double *) mem_82726)[j_81298];\n            tile_elem_81311 = ((__global dou", "ble *) mem_82728)[j_81298];\n            tile_elem_81312 = ((__global int64_t *) mem_82724)[j_81298];\n            pre1d_81307 = tile_elem_81310;\n            pre1d_81308 = tile_elem_81311;\n            pre1d_81309 = tile_elem_81312;\n        } else {\n            pre1d_81307 = 0.0;\n            pre1d_81308 = 0.0;\n            pre1d_81309 = (int64_t) 0;\n        }\n        ((__local double *) color_83111)[ltid_81282] = pre1d_81307;\n        ((__local double *) color_83110)[ltid_81282] = pre1d_81308;\n        ((__local int64_t *) color_83109)[ltid_81282] = pre1d_81309;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_81323 = sext_i32_i64(local_tid_86592);\n        ltid_81322 = sext_i32_i64(sext_i64_i32(ltid_pre_86596));\n        gtid_81333 = binop_x_80989 + ltid_81322;\n        acc_81339 = ext_mem_82878[(int64_t) 0];\n        cond_81341 = slt64(gtid_81333, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547);\n        if (cond_81341) {\n            double eta_p_81334;\n            double eta_p_81335;\n            double d_haversine_res_81336;\n            double d_haversine_res_81337;\n            double cos_res_81338;\n            double acc_81340;\n            int64_t x_81344;\n            double x_81345;\n            int64_t redout_81554;\n            double redout_81555;\n            \n            eta_p_81334 = mem_82836[(int64_t) 0];\n            eta_p_81335 = mem_82840[(int64_t) 0];\n            d_haversine_res_81336 = mem_82844[(int64_t) 0];\n            d_haversine_res_81337 = mem_82848[(int64_t) 0];\n            cos_res_81338 = mem_82852[(int64_t) 0];\n            acc_81340 = ext_mem_82877[(int64_t) 0];\n            redout_81554 = acc_81339;\n            redout_81555 = acc_81340;\n            for (int64_t i_81556 = 0; i_81556 < residual_input_81280; i_81556++) {\n                double eta_p_81346;\n                double eta_p_81347;\n                double dist_res_81349;\n                bool zg_res_81386;\n                bool zg_res_81387;\n                bool x_81388;\n                int64_t lifted", "_lambda_res_81389;\n                double lifted_lambda_res_81390;\n                int64_t redout_tmp_86607;\n                double redout_tmp_86608;\n                \n                eta_p_81346 = ((__local double *) color_83111)[i_81556];\n                eta_p_81347 = ((__local double *) color_83110)[i_81556];\n                if (clBase_48691 == (int8_t) 0) {\n                    bool zeze_res_81350;\n                    double d_euclidean_res_81351;\n                    \n                    zeze_res_81350 = eta_p_81334 == eta_p_81346;\n                    if (zeze_res_81350) {\n                        double zm_res_81352;\n                        double abs_res_81353;\n                        \n                        zm_res_81352 = eta_p_81335 - eta_p_81347;\n                        abs_res_81353 = fabs64(zm_res_81352);\n                        d_euclidean_res_81351 = abs_res_81353;\n                    } else {\n                        bool zeze_res_81354;\n                        double d_euclidean_res_f_res_81355;\n                        \n                        zeze_res_81354 = eta_p_81335 == eta_p_81347;\n                        if (zeze_res_81354) {\n                            double zm_res_81356;\n                            double abs_res_81357;\n                            \n                            zm_res_81356 = eta_p_81334 - eta_p_81346;\n                            abs_res_81357 = fabs64(zm_res_81356);\n                            d_euclidean_res_f_res_81355 = abs_res_81357;\n                        } else {\n                            double zm_res_81358;\n                            double zm_res_81359;\n                            double hypot_res_81360;\n                            \n                            zm_res_81358 = eta_p_81335 - eta_p_81347;\n                            zm_res_81359 = eta_p_81334 - eta_p_81346;\n                            hypot_res_81360 = futrts_hypot64(zm_res_81359, zm_res_81358);\n                            d_euclidean_res_f_res_81355 = ",
                                    "hypot_res_81360;\n                        }\n                        d_euclidean_res_81351 = d_euclidean_res_f_res_81355;\n                    }\n                    dist_res_81349 = d_euclidean_res_81351;\n                } else {\n                    double d_haversine_res_81361;\n                    double d_haversine_res_81362;\n                    double zm_res_81367;\n                    double cos_res_81368;\n                    double zm_res_81369;\n                    double cos_res_81370;\n                    double zt_res_81371;\n                    double zm_res_81372;\n                    double zm_res_81373;\n                    double zt_res_81374;\n                    double zp_res_81375;\n                    double zs_res_81376;\n                    double min_res_81377;\n                    double zt_res_81378;\n                    double zm_res_81379;\n                    double acos_res_81380;\n                    double zt_res_81381;\n                    \n                    if (clBase_48690 == (int8_t) 1) {\n                        d_haversine_res_81361 = eta_p_81346;\n                        d_haversine_res_81362 = eta_p_81347;\n                    } else {\n                        double zt_res_81363;\n                        double zs_res_81364;\n                        double zt_res_81365;\n                        double zs_res_81366;\n                        \n                        zt_res_81363 = 3.141592653589793 * eta_p_81346;\n                        zs_res_81364 = zt_res_81363 / 180.0;\n                        zt_res_81365 = 3.141592653589793 * eta_p_81347;\n                        zs_res_81366 = zt_res_81365 / 180.0;\n                        d_haversine_res_81361 = zs_res_81364;\n                        d_haversine_res_81362 = zs_res_81366;\n                    }\n                    zm_res_81367 = d_haversine_res_81336 - d_haversine_res_81361;\n                    cos_res_81368 = futrts_cos64(zm_res_81367);\n                    zm_res_81369 = 1.0 - cos_res_81368;\n        ", "            cos_res_81370 = futrts_cos64(d_haversine_res_81361);\n                    zt_res_81371 = cos_res_81338 * cos_res_81370;\n                    zm_res_81372 = d_haversine_res_81337 - d_haversine_res_81362;\n                    zm_res_81373 = 1.0 - zm_res_81372;\n                    zt_res_81374 = zt_res_81371 * zm_res_81373;\n                    zp_res_81375 = zm_res_81369 + zt_res_81374;\n                    zs_res_81376 = zp_res_81375 / 2.0;\n                    min_res_81377 = fmin64(1.0, zs_res_81376);\n                    zt_res_81378 = 2.0 * min_res_81377;\n                    zm_res_81379 = 1.0 - zt_res_81378;\n                    acos_res_81380 = futrts_acos64(zm_res_81379);\n                    zt_res_81381 = clBase_48698 * acos_res_81380;\n                    dist_res_81349 = zt_res_81381;\n                }\n                zg_res_81386 = clBase_48692 < redout_81555;\n                zg_res_81387 = clBase_48692 < dist_res_81349;\n                x_81388 = zg_res_81386 && zg_res_81387;\n                if (x_81388) {\n                    lifted_lambda_res_81389 = (int64_t) -1;\n                    lifted_lambda_res_81390 = INFINITY;\n                } else {\n                    bool zl_res_81391;\n                    int64_t lifted_lambda_res_f_res_81392;\n                    double lifted_lambda_res_f_res_81393;\n                    \n                    zl_res_81391 = redout_81555 < dist_res_81349;\n                    if (zl_res_81391) {\n                        lifted_lambda_res_f_res_81392 = redout_81554;\n                    } else {\n                        int64_t x_81348 = ((__local int64_t *) color_83109)[i_81556];\n                        \n                        lifted_lambda_res_f_res_81392 = x_81348;\n                    }\n                    if (zl_res_81391) {\n                        lifted_lambda_res_f_res_81393 = redout_81555;\n                    } else {\n                        lifted_lambda_res_f_res_81393 = dist_res_81349;\n                    }\n           ", "         lifted_lambda_res_81389 = lifted_lambda_res_f_res_81392;\n                    lifted_lambda_res_81390 = lifted_lambda_res_f_res_81393;\n                }\n                redout_tmp_86607 = lifted_lambda_res_81389;\n                redout_tmp_86608 = lifted_lambda_res_81390;\n                redout_81554 = redout_tmp_86607;\n                redout_81555 = redout_tmp_86608;\n            }\n            x_81344 = redout_81554;\n            x_81345 = redout_81555;\n            acc_81342 = x_81344;\n        } else {\n            acc_81342 = acc_81339;\n        }\n        mem_82888[(int64_t) 0] = acc_81342;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_12 = 0; i_12 < 1; i_12++)\n            ext_mem_82889[i_12] = mem_82888[i_12];\n    }\n    if (slt64(sext_i32_i64(local_tid_86592) + tile_sizze_80973 * sext_i32_i64(block_id_86593), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547)) {\n        int64_t tmp_86609 = ext_mem_82889[(int64_t) 0];\n        \n        ((__global int64_t *) mem_81972)[inf_63544 + (sext_i32_i64(local_tid_86592) + tile_sizze_80973 * sext_i32_i64(block_id_86593))] = tmp_86609;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_80973\n    #undef bytes_82863\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_large_75768_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_large_75768(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t inf_62706, int64_t j_m_i_62709, int64_t num_tblocks_75763, unsigned char x_81841_bits, int64_t blocks_per_segment_85204, int64_t q_85205, int64_t num_virtblocks_85206, int64_t threads_per_segment_85207, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_param_82092, __global unsigned char *mem_82095, __global unsigne",
                                    "d char *mem_82097, __global unsigned char *mem_82099, __global unsigned char *mem_82102, __global unsigned char *segred_tmp_mem_85208, __global unsigned char *counters_mem_85210)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_75762 (do_DBSCAN_doublezisegred_large_75768zisegred_tblock_sizze_75762)\n    #define chunk_sizze_85175 (do_DBSCAN_doublezisegred_large_75768zichunk_sizze_85175)\n    \n    volatile __local unsigned char *sync_arr_mem_85219_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_85219_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_85217_backing_0 = &shared_mem[sync_arr_mem_85219_backing_1_offset];\n    const int64_t red_arr_i64_mem_85217_backing_0_offset = sync_arr_mem_85219_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_75762 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_75762, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85213;\n    int32_t tblock_sizze_85216;\n    int32_t wave_sizze_85215;\n    int32_t block_id_85214;\n    int32_t global_tid_85212;\n    int64_t phys_tid_75768;\n    __local unsigned char *red_arr_i64_mem_85217;\n    __local unsigned char *sync_arr_mem_85219;\n    int32_t phys_tblock_id_85221;\n    int32_t iterations_85222;\n    \n    local_tid_85213 = get_local_id(0);\n    tblock_sizze_85216 = get_local_size(0);\n    wave_sizze_85215 = LOCKSTEP_WIDTH;\n    block_id_85214 = get_tblock_id(0);\n    global_tid_85212 = block_id_85214 * tblock_sizze_85216 + local_tid_85213;\n    phys_tid_75768 = sext_i32_i64(global_tid_85212);\n    red_arr_i64_mem_85217 = (__local unsigned char *) red_arr_i64_mem_85217_backing_0;\n    sync_arr_mem_85219 = (__local unsigned char *) sync_arr_mem_85219_backing_1;\n    phys_tblock_id_85221 = get_tblock_id(0);\n    iterations_85222 = sdiv_up32(sext_i64_i32(num_virtblocks_85206) - phys_tblock_id_85221, sext_i64_i32(num_tblocks_75763));\n    for (int32_t i_85223 = 0; i_85223 < iterations", "_85222; i_85223++) {\n        int32_t virt_tblock_id_85224;\n        int64_t flat_segment_id_85225;\n        int64_t global_tid_85226;\n        int64_t slice_85227;\n        int64_t gtid_75766;\n        int64_t remnant_85228;\n        int64_t gtid_75767;\n        int64_t eta_p_block_res_acc_85229;\n        int64_t eta_p_75769;\n        int64_t eta_p_75770;\n        int64_t tblock_id_in_segment_85233;\n        int64_t block_base_offset_85234;\n        int32_t offset_85237;\n        int32_t skip_waves_85238;\n        int64_t eta_p_85230;\n        int64_t eta_p_85231;\n        \n        virt_tblock_id_85224 = phys_tblock_id_85221 + i_85223 * sext_i64_i32(num_tblocks_75763);\n        flat_segment_id_85225 = squot64(sext_i32_i64(virt_tblock_id_85224), blocks_per_segment_85204);\n        global_tid_85226 = srem64(sext_i32_i64(virt_tblock_id_85224) * segred_tblock_sizze_75762 + sext_i32_i64(local_tid_85213), threads_per_segment_85207);\n        slice_85227 = j_m_i_62709;\n        gtid_75766 = flat_segment_id_85225;\n        remnant_85228 = flat_segment_id_85225 - gtid_75766;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_85229 = (int64_t) 9223372036854775807;\n        }\n        tblock_id_in_segment_85233 = squot64(global_tid_85226, segred_tblock_sizze_75762);\n        block_base_offset_85234 = tblock_id_in_segment_85233 * q_85205 * segred_tblock_sizze_75762;\n        for (int64_t i_85235 = 0; i_85235 < q_85205; i_85235++) {\n            int64_t block_offset_85236 = block_base_offset_85234 + i_85235 * segred_tblock_sizze_75762;\n            \n            gtid_75767 = global_tid_85226 + threads_per_segment_85207 * i_85235;\n            if (slt64(gtid_75767, conc_tmp_62382)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_78030 = inf_62706 + gtid_75766;\n                        bool index_concat_cmp_78021 = sle64(conc_tmp_62375, slice_78", "030);\n                        double index_concat_branch_78029;\n                        \n                        if (index_concat_cmp_78021) {\n                            int64_t index_concat_i_78022 = sub64(slice_78030, conc_tmp_62375);\n                            double index_concat_78023 = ((__global double *) ext_mem_82066)[index_concat_i_78022];\n                            \n                            index_concat_branch_78029 = index_concat_78023;\n                        } else {\n                            bool index_concat_cmp_78024 = sle64(m_62289, slice_78030);\n                            double index_concat_branch_78028;\n                            \n                            if (index_concat_cmp_78024) {\n                                int64_t index_concat_i_78025 = sub64(slice_78030, m_62289);\n                                double index_concat_78026 = ((__global double *) mem_82048)[index_concat_i_78025];\n                                \n                                index_concat_branch_78028 = index_concat_78026;\n                            } else {\n                                double index_concat_78027 = ((__global double *) mem_82081)[slice_78030];\n                                \n                                index_concat_branch_78028 = index_concat_78027;\n                            }\n                            index_concat_branch_78029 = index_concat_branch_78028;\n                        }\n                        \n                        double index_concat_branch_78017;\n                        \n                        if (index_concat_cmp_78021) {\n                            int64_t index_concat_i_78010 = sub64(slice_78030, conc_tmp_62375);\n                            double index_concat_78011 = ((__global double *) ext_mem_82065)[index_concat_i_78010];\n                            \n                            index_concat_branch_78017 = index_concat_78011;\n                        } else {\n                            bool index_concat_cm",
                                    "p_78012 = sle64(m_62289, slice_78030);\n                            double index_concat_branch_78016;\n                            \n                            if (index_concat_cmp_78012) {\n                                int64_t index_concat_i_78013 = sub64(slice_78030, m_62289);\n                                double index_concat_78014 = ((__global double *) mem_82046)[index_concat_i_78013];\n                                \n                                index_concat_branch_78016 = index_concat_78014;\n                            } else {\n                                double index_concat_78015 = ((__global double *) mem_82079)[slice_78030];\n                                \n                                index_concat_branch_78016 = index_concat_78015;\n                            }\n                            index_concat_branch_78017 = index_concat_branch_78016;\n                        }\n                        \n                        bool index_concat_cmp_77997 = sle64(conc_tmp_62375, gtid_75767);\n                        double index_concat_branch_78005;\n                        \n                        if (index_concat_cmp_77997) {\n                            int64_t index_concat_i_77998 = sub64(gtid_75767, conc_tmp_62375);\n                            double index_concat_77999 = ((__global double *) ext_mem_82066)[index_concat_i_77998];\n                            \n                            index_concat_branch_78005 = index_concat_77999;\n                        } else {\n                            bool index_concat_cmp_78000 = sle64(m_62289, gtid_75767);\n                            double index_concat_branch_78004;\n                            \n                            if (index_concat_cmp_78000) {\n                                int64_t index_concat_i_78001 = sub64(gtid_75767, m_62289);\n                                double index_concat_78002 = ((__global double *) mem_82048)[index_concat_i_78001];\n                                \n                         ", "       index_concat_branch_78004 = index_concat_78002;\n                            } else {\n                                double index_concat_78003 = ((__global double *) mem_82081)[gtid_75767];\n                                \n                                index_concat_branch_78004 = index_concat_78003;\n                            }\n                            index_concat_branch_78005 = index_concat_branch_78004;\n                        }\n                        \n                        double index_concat_branch_77994;\n                        \n                        if (index_concat_cmp_77997) {\n                            int64_t index_concat_i_77987 = sub64(gtid_75767, conc_tmp_62375);\n                            double index_concat_77988 = ((__global double *) ext_mem_82065)[index_concat_i_77987];\n                            \n                            index_concat_branch_77994 = index_concat_77988;\n                        } else {\n                            bool index_concat_cmp_77989 = sle64(m_62289, gtid_75767);\n                            double index_concat_branch_77993;\n                            \n                            if (index_concat_cmp_77989) {\n                                int64_t index_concat_i_77990 = sub64(gtid_75767, m_62289);\n                                double index_concat_77991 = ((__global double *) mem_82046)[index_concat_i_77990];\n                                \n                                index_concat_branch_77993 = index_concat_77991;\n                            } else {\n                                double index_concat_77992 = ((__global double *) mem_82079)[gtid_75767];\n                                \n                                index_concat_branch_77993 = index_concat_77992;\n                            }\n                            index_concat_branch_77994 = index_concat_branch_77993;\n                        }\n                        \n                        double d_haversine_res_75775;\n               ", "         \n                        if (x_81841) {\n                            double x_81843 = ((__global double *) mem_82095)[gtid_75766];\n                            \n                            d_haversine_res_75775 = x_81843;\n                        } else {\n                            d_haversine_res_75775 = 0.0;\n                        }\n                        \n                        double d_haversine_res_75776;\n                        \n                        if (x_81841) {\n                            double x_81845 = ((__global double *) mem_82097)[gtid_75766];\n                            \n                            d_haversine_res_75776 = x_81845;\n                        } else {\n                            d_haversine_res_75776 = 0.0;\n                        }\n                        \n                        double cos_res_75777;\n                        \n                        if (x_81841) {\n                            double x_81847 = ((__global double *) mem_82099)[gtid_75766];\n                            \n                            cos_res_75777 = x_81847;\n                        } else {\n                            cos_res_75777 = 0.0;\n                        }\n                        \n                        double dist_res_75781;\n                        \n                        if (clBase_48691 == (int8_t) 0) {\n                            bool zeze_res_75782 = index_concat_branch_78029 == index_concat_branch_78005;\n                            double d_euclidean_res_75783;\n                            \n                            if (zeze_res_75782) {\n                                double zm_res_75784 = index_concat_branch_78017 - index_concat_branch_77994;\n                                double abs_res_75785 = fabs64(zm_res_75784);\n                                \n                                d_euclidean_res_75783 = abs_res_75785;\n                            } else {\n                                bool zeze_res_75786 = index_concat_branch_78",
                                    "017 == index_concat_branch_77994;\n                                double d_euclidean_res_f_res_75787;\n                                \n                                if (zeze_res_75786) {\n                                    double zm_res_75788 = index_concat_branch_78029 - index_concat_branch_78005;\n                                    double abs_res_75789 = fabs64(zm_res_75788);\n                                    \n                                    d_euclidean_res_f_res_75787 = abs_res_75789;\n                                } else {\n                                    double zm_res_75790 = index_concat_branch_78017 - index_concat_branch_77994;\n                                    double zm_res_75791 = index_concat_branch_78029 - index_concat_branch_78005;\n                                    double hypot_res_75792 = futrts_hypot64(zm_res_75791, zm_res_75790);\n                                    \n                                    d_euclidean_res_f_res_75787 = hypot_res_75792;\n                                }\n                                d_euclidean_res_75783 = d_euclidean_res_f_res_75787;\n                            }\n                            dist_res_75781 = d_euclidean_res_75783;\n                        } else {\n                            double d_haversine_res_75793;\n                            double d_haversine_res_75794;\n                            \n                            if (clBase_48690 == (int8_t) 1) {\n                                d_haversine_res_75793 = index_concat_branch_78005;\n                                d_haversine_res_75794 = index_concat_branch_77994;\n                            } else {\n                                double zt_res_75795 = 3.141592653589793 * index_concat_branch_78005;\n                                double zs_res_75796 = zt_res_75795 / 180.0;\n                                double zt_res_75797 = 3.141592653589793 * index_concat_branch_77994;\n                                double zs_res_75798 = zt_res_75797 / ", "180.0;\n                                \n                                d_haversine_res_75793 = zs_res_75796;\n                                d_haversine_res_75794 = zs_res_75798;\n                            }\n                            \n                            double zm_res_75799 = d_haversine_res_75775 - d_haversine_res_75793;\n                            double cos_res_75800 = futrts_cos64(zm_res_75799);\n                            double zm_res_75801 = 1.0 - cos_res_75800;\n                            double cos_res_75802 = futrts_cos64(d_haversine_res_75793);\n                            double zt_res_75803 = cos_res_75777 * cos_res_75802;\n                            double zm_res_75804 = d_haversine_res_75776 - d_haversine_res_75794;\n                            double zm_res_75805 = 1.0 - zm_res_75804;\n                            double zt_res_75806 = zt_res_75803 * zm_res_75805;\n                            double zp_res_75807 = zm_res_75801 + zt_res_75806;\n                            double zs_res_75808 = zp_res_75807 / 2.0;\n                            double min_res_75809 = fmin64(1.0, zs_res_75808);\n                            double zt_res_75810 = 2.0 * min_res_75809;\n                            double zm_res_75811 = 1.0 - zt_res_75810;\n                            double acos_res_75812 = futrts_acos64(zm_res_75811);\n                            double zt_res_75813 = clBase_48698 * acos_res_75812;\n                            \n                            dist_res_75781 = zt_res_75813;\n                        }\n                        \n                        bool zlze_res_75814 = dist_res_75781 <= clBase_48692;\n                        int64_t lifted_lambda_res_75815;\n                        \n                        if (zlze_res_75814) {\n                            int64_t eta_p_75780 = ((__global int64_t *) mem_param_82092)[gtid_75767];\n                            \n                            lifted_lambda_res_75815 = eta_p_75780;\n                        } ", "else {\n                            int64_t eta_p_75772 = ((__global int64_t *) mem_param_82092)[slice_78030];\n                            \n                            lifted_lambda_res_75815 = eta_p_75772;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_75769 = eta_p_block_res_acc_85229;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_75770 = lifted_lambda_res_75815;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            int64_t min_res_75771 = smin64(eta_p_75769, eta_p_75770);\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_85229 = min_res_75771;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_block_res_acc_85229;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_85238 = 1;\n        offset_85237 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_85213, sext_i64_i32(segred_tblock_sizze_75762))) {\n                eta_p_85230 = ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85237)];\n            }\n        }\n        offset_85237 = 1;\n        while (slt32(offset_85237, wave_sizze_85215)) {\n            if (slt32(local_tid_85213 + offset_85237, sext_i64_i32(segred_tblock_sizze_75762)) && ((local_tid_85213 - squot32(local_tid_85213, wave_sizze_85215) * wave_sizze_85215) & (2 * offset_85237 - 1)) == 0) {\n                // re",
                                    "ad array element\n                {\n                    eta_p_85231 = ((volatile __local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85237)];\n                }\n                // apply reduction operation\n                {\n                    int64_t min_res_85232 = smin64(eta_p_85230, eta_p_85231);\n                    \n                    eta_p_85230 = min_res_85232;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_85230;\n                }\n            }\n            offset_85237 *= 2;\n        }\n        while (slt32(skip_waves_85238, squot32(sext_i64_i32(segred_tblock_sizze_75762) + wave_sizze_85215 - 1, wave_sizze_85215))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_85237 = skip_waves_85238 * wave_sizze_85215;\n            if (slt32(local_tid_85213 + offset_85237, sext_i64_i32(segred_tblock_sizze_75762)) && ((local_tid_85213 - squot32(local_tid_85213, wave_sizze_85215) * wave_sizze_85215) == 0 && (squot32(local_tid_85213, wave_sizze_85215) & (2 * skip_waves_85238 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_85231 = ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85237)];\n                }\n                // apply reduction operation\n                {\n                    int64_t min_res_85232 = smin64(eta_p_85230, eta_p_85231);\n                    \n                    eta_p_85230 = min_res_85232;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_85230;\n                }\n            }\n            skip_waves_85238 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n ", "       {\n            if (sext_i32_i64(local_tid_85213) == (int64_t) 0) {\n                eta_p_block_res_acc_85229 = eta_p_85230;\n            } else {\n                eta_p_block_res_acc_85229 = (int64_t) 9223372036854775807;\n            }\n        }\n        if (blocks_per_segment_85204 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_85213 == 0) {\n                    ((__global int64_t *) mem_82102)[gtid_75766] = eta_p_block_res_acc_85229;\n                }\n            }\n        } else {\n            int32_t old_counter_85239;\n            bool is_last_block_85240;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_85213 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_85208)[sext_i32_i64(virt_tblock_id_85224)] = eta_p_block_res_acc_85229;\n                    mem_fence_global();\n                    old_counter_85239 = atomic_add_i32_global(&((volatile __global int *) counters_mem_85210)[srem64(flat_segment_id_85225, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_85219)[(int64_t) 0] = old_counter_85239 == sext_i64_i32(blocks_per_segment_85204 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_85240 = ((__local bool *) sync_arr_mem_85219)[(int64_t) 0];\n            if (is_last_block_85240) {\n                if (local_tid_85213 == 0) {\n                    old_counter_85239 = atomic_add_i32_global(&((volatile __global int *) counters_mem_85210)[srem64(flat_segment_id_85225, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_85204));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_85241 = sdiv_up64(blocks_per_segment_85204, segred_tblock_sizze_75762);\n                    \n             ", "       eta_p_75769 = (int64_t) 9223372036854775807;\n                    for (int64_t i_85242 = 0; i_85242 < read_per_thread_85241; i_85242++) {\n                        int64_t block_res_id_85243 = sext_i32_i64(local_tid_85213) * read_per_thread_85241 + i_85242;\n                        int64_t index_of_block_res_85244 = flat_segment_id_85225 * blocks_per_segment_85204 + block_res_id_85243;\n                        \n                        if (slt64(block_res_id_85243, blocks_per_segment_85204)) {\n                            eta_p_75770 = ((__global int64_t *) segred_tmp_mem_85208)[index_of_block_res_85244];\n                            \n                            int64_t min_res_75771 = smin64(eta_p_75769, eta_p_75770);\n                            \n                            eta_p_75769 = min_res_75771;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_75769;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_85245;\n                    int32_t skip_waves_85246 = 1;\n                    int64_t eta_p_85230;\n                    int64_t eta_p_85231;\n                    \n                    offset_85245 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_85213, sext_i64_i32(segred_tblock_sizze_75762))) {\n                            eta_p_85230 = ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85245)];\n                        }\n                    }\n                    offset_85245 = 1;\n                    while (slt32(offset_85245, wave_sizze_85215)) {\n                        if (slt32(local_tid_85213 + offset_85245, sext_i64_i32(segred_tblock_sizze_75762)) && ((local_tid_85213 - squot32(local_tid_85213, wave_sizze_85215) * wave_sizze_85215) & ",
                                    "(2 * offset_85245 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_85231 = ((volatile __local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85245)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t min_res_85232 = smin64(eta_p_85230, eta_p_85231);\n                                \n                                eta_p_85230 = min_res_85232;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_85230;\n                            }\n                        }\n                        offset_85245 *= 2;\n                    }\n                    while (slt32(skip_waves_85246, squot32(sext_i64_i32(segred_tblock_sizze_75762) + wave_sizze_85215 - 1, wave_sizze_85215))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_85245 = skip_waves_85246 * wave_sizze_85215;\n                        if (slt32(local_tid_85213 + offset_85245, sext_i64_i32(segred_tblock_sizze_75762)) && ((local_tid_85213 - squot32(local_tid_85213, wave_sizze_85215) * wave_sizze_85215) == 0 && (squot32(local_tid_85213, wave_sizze_85215) & (2 * skip_waves_85246 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_85231 = ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213 + offset_85245)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t min_res_85232 = smin64(eta_p_85230, eta_p_85231);\n                                \n                                eta_p_85230 = min_res_85", "232;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_85217)[sext_i32_i64(local_tid_85213)] = eta_p_85230;\n                            }\n                        }\n                        skip_waves_85246 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_85213 == 0) {\n                            ((__global int64_t *) mem_82102)[gtid_75766] = eta_p_85230;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_75762\n    #undef chunk_sizze_85175\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_large_77359_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_large_77359(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_63400, int64_t inf_63450, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, int64_t num_tblocks_77353, unsigned char x_81841_bits, int64_t blocks_per_segment_86529, int64_t q_86530, int64_t num_virtblocks_86531, int64_t threads_per_segment_86532, __global unsigned char *ext_mem_82716, __global unsigned char *ext_mem_82717, __global unsigned char *mem_82730, __global unsigned char *mem_82732, __global unsigned char *mem_82734, __global unsigned char *mem_82737, __global unsigned char *mem_82743, __global unsigned char *mem_82745, __global unsigned char *mem_82747, __global unsigned char *mem_82752, __global unsigned char *segred_tmp_mem_86533, __global unsigned char *segred_tmp_mem_86535, __global unsigned char *counters_mem_86537)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_77352 (do_DBSCAN_doublezisegred_large_77359zisegred_tb", "lock_sizze_77352)\n    #define chunk_sizze_86488 (do_DBSCAN_doublezisegred_large_77359zichunk_sizze_86488)\n    \n    volatile __local unsigned char *sync_arr_mem_86548_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_86548_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f64_mem_86546_backing_1 = &shared_mem[sync_arr_mem_86548_backing_2_offset];\n    const int64_t red_arr_f64_mem_86546_backing_1_offset = sync_arr_mem_86548_backing_2_offset + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_86544_backing_0 = &shared_mem[red_arr_f64_mem_86546_backing_1_offset];\n    const int64_t red_arr_i64_mem_86544_backing_0_offset = red_arr_f64_mem_86546_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86540;\n    int32_t tblock_sizze_86543;\n    int32_t wave_sizze_86542;\n    int32_t block_id_86541;\n    int32_t global_tid_86539;\n    int64_t phys_tid_77359;\n    __local unsigned char *red_arr_i64_mem_86544;\n    __local unsigned char *red_arr_f64_mem_86546;\n    __local unsigned char *sync_arr_mem_86548;\n    int32_t phys_tblock_id_86550;\n    int32_t iterations_86551;\n    \n    local_tid_86540 = get_local_id(0);\n    tblock_sizze_86543 = get_local_size(0);\n    wave_sizze_86542 = LOCKSTEP_WIDTH;\n    block_id_86541 = get_tblock_id(0);\n    global_tid_86539 = block_id_86541 * tblock_sizze_86543 + local_tid_86540;\n    phys_tid_77359 = sext_i32_i64(global_tid_86539);\n    red_arr_i64_mem_86544 = (__local unsigned char *) red_arr_i64_mem_86544_backing_0;\n    red_arr_f64_mem_86546 = (__local unsigned char *) red_arr_f64_mem_86546_backing_1;\n    sync_arr_mem_86548 = (__local unsigned char *) sync_arr_mem_86548_backing_2;\n    phys_tblock_id_86550 ",
                                    "= get_tblock_id(0);\n    iterations_86551 = sdiv_up32(sext_i64_i32(num_virtblocks_86531) - phys_tblock_id_86550, sext_i64_i32(num_tblocks_77353));\n    for (int32_t i_86552 = 0; i_86552 < iterations_86551; i_86552++) {\n        int32_t virt_tblock_id_86553;\n        int64_t flat_segment_id_86554;\n        int64_t global_tid_86555;\n        int64_t slice_86556;\n        int64_t gtid_77357;\n        int64_t remnant_86557;\n        int64_t gtid_77358;\n        int64_t eta_p_block_res_acc_86558;\n        double eta_p_block_res_acc_86559;\n        int64_t eta_p_77360;\n        double eta_p_77361;\n        int64_t eta_p_77362;\n        double eta_p_77363;\n        int64_t tblock_id_in_segment_86572;\n        int64_t block_base_offset_86573;\n        int32_t offset_86576;\n        int32_t skip_waves_86577;\n        int64_t eta_p_86560;\n        double eta_p_86561;\n        int64_t eta_p_86562;\n        double eta_p_86563;\n        \n        virt_tblock_id_86553 = phys_tblock_id_86550 + i_86552 * sext_i64_i32(num_tblocks_77353);\n        flat_segment_id_86554 = squot64(sext_i32_i64(virt_tblock_id_86553), blocks_per_segment_86529);\n        global_tid_86555 = srem64(sext_i32_i64(virt_tblock_id_86553) * segred_tblock_sizze_77352 + sext_i32_i64(local_tid_86540), threads_per_segment_86532);\n        slice_86556 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;\n        gtid_77357 = flat_segment_id_86554;\n        remnant_86557 = flat_segment_id_86554 - gtid_77357;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_86558 = (int64_t) -1;\n            eta_p_block_res_acc_86559 = INFINITY;\n        }\n        tblock_id_in_segment_86572 = squot64(global_tid_86555, segred_tblock_sizze_77352);\n        block_base_offset_86573 = tblock_id_in_segment_86572 * q_86530 * segred_tblock_sizze_77352;\n        for (int64_t i_86574 = 0; i_86574 < q_86530; i_86574++) {\n            int64_t block_offset_86575 = block_base_offset_86573 + i_86574 * segred_tblock_sizze_77352;\n            \n", "            gtid_77358 = global_tid_86555 + threads_per_segment_86532 * i_86574;\n            if (slt64(gtid_77358, m_63400)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_77761 = inf_63450 + gtid_77357;\n                        double eta_p_77377 = ((__global double *) mem_82732)[gtid_77358];\n                        double eta_p_77378 = ((__global double *) mem_82730)[gtid_77358];\n                        int64_t x_77379 = ((__global int64_t *) mem_82734)[gtid_77358];\n                        double d_haversine_res_77374;\n                        \n                        if (x_81841) {\n                            double x_81825 = ((__global double *) mem_82743)[gtid_77357];\n                            \n                            d_haversine_res_77374 = x_81825;\n                        } else {\n                            d_haversine_res_77374 = 0.0;\n                        }\n                        \n                        double d_haversine_res_77375;\n                        \n                        if (x_81841) {\n                            double x_81827 = ((__global double *) mem_82745)[gtid_77357];\n                            \n                            d_haversine_res_77375 = x_81827;\n                        } else {\n                            d_haversine_res_77375 = 0.0;\n                        }\n                        \n                        double cos_res_77376;\n                        \n                        if (x_81841) {\n                            double x_81829 = ((__global double *) mem_82747)[gtid_77357];\n                            \n                            cos_res_77376 = x_81829;\n                        } else {\n                            cos_res_77376 = 0.0;\n                        }\n                        \n                        double dist_res_77380;\n                        \n                        if (clBase_48691 == (in", "t8_t) 0) {\n                            double eta_p_77372 = ((__global double *) ext_mem_82717)[slice_77761];\n                            double eta_p_77373 = ((__global double *) ext_mem_82716)[slice_77761];\n                            bool zeze_res_77381 = eta_p_77372 == eta_p_77377;\n                            double d_euclidean_res_77382;\n                            \n                            if (zeze_res_77381) {\n                                double zm_res_77383 = eta_p_77373 - eta_p_77378;\n                                double abs_res_77384 = fabs64(zm_res_77383);\n                                \n                                d_euclidean_res_77382 = abs_res_77384;\n                            } else {\n                                bool zeze_res_77385 = eta_p_77373 == eta_p_77378;\n                                double d_euclidean_res_f_res_77386;\n                                \n                                if (zeze_res_77385) {\n                                    double zm_res_77387 = eta_p_77372 - eta_p_77377;\n                                    double abs_res_77388 = fabs64(zm_res_77387);\n                                    \n                                    d_euclidean_res_f_res_77386 = abs_res_77388;\n                                } else {\n                                    double zm_res_77389 = eta_p_77373 - eta_p_77378;\n                                    double zm_res_77390 = eta_p_77372 - eta_p_77377;\n                                    double hypot_res_77391 = futrts_hypot64(zm_res_77390, zm_res_77389);\n                                    \n                                    d_euclidean_res_f_res_77386 = hypot_res_77391;\n                                }\n                                d_euclidean_res_77382 = d_euclidean_res_f_res_77386;\n                            }\n                            dist_res_77380 = d_euclidean_res_77382;\n                        } else {\n                            double d_haversine_res_77392;\n            ",
                                    "                double d_haversine_res_77393;\n                            \n                            if (clBase_48690 == (int8_t) 1) {\n                                d_haversine_res_77392 = eta_p_77377;\n                                d_haversine_res_77393 = eta_p_77378;\n                            } else {\n                                double zt_res_77394 = 3.141592653589793 * eta_p_77377;\n                                double zs_res_77395 = zt_res_77394 / 180.0;\n                                double zt_res_77396 = 3.141592653589793 * eta_p_77378;\n                                double zs_res_77397 = zt_res_77396 / 180.0;\n                                \n                                d_haversine_res_77392 = zs_res_77395;\n                                d_haversine_res_77393 = zs_res_77397;\n                            }\n                            \n                            double zm_res_77398 = d_haversine_res_77374 - d_haversine_res_77392;\n                            double cos_res_77399 = futrts_cos64(zm_res_77398);\n                            double zm_res_77400 = 1.0 - cos_res_77399;\n                            double cos_res_77401 = futrts_cos64(d_haversine_res_77392);\n                            double zt_res_77402 = cos_res_77376 * cos_res_77401;\n                            double zm_res_77403 = d_haversine_res_77375 - d_haversine_res_77393;\n                            double zm_res_77404 = 1.0 - zm_res_77403;\n                            double zt_res_77405 = zt_res_77402 * zm_res_77404;\n                            double zp_res_77406 = zm_res_77400 + zt_res_77405;\n                            double zs_res_77407 = zp_res_77406 / 2.0;\n                            double min_res_77408 = fmin64(1.0, zs_res_77407);\n                            double zt_res_77409 = 2.0 * min_res_77408;\n                            double zm_res_77410 = 1.0 - zt_res_77409;\n                            double acos_res_77411 = futrts_acos64(zm_res_77410);\n                   ", "         double zt_res_77412 = clBase_48698 * acos_res_77411;\n                            \n                            dist_res_77380 = zt_res_77412;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_77360 = eta_p_block_res_acc_86558;\n                            eta_p_77361 = eta_p_block_res_acc_86559;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_77362 = x_77379;\n                            eta_p_77363 = dist_res_77380;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            bool zg_res_77364 = clBase_48692 < eta_p_77361;\n                            bool zg_res_77365 = clBase_48692 < eta_p_77363;\n                            bool x_77366 = zg_res_77364 && zg_res_77365;\n                            int64_t lifted_lambda_res_77367;\n                            double lifted_lambda_res_77368;\n                            \n                            if (x_77366) {\n                                lifted_lambda_res_77367 = (int64_t) -1;\n                                lifted_lambda_res_77368 = INFINITY;\n                            } else {\n                                bool zl_res_77369 = eta_p_77361 < eta_p_77363;\n                                int64_t lifted_lambda_res_f_res_77370;\n                                \n                                if (zl_res_77369) {\n                                    lifted_lambda_res_f_res_77370 = eta_p_77360;\n                                } else {\n                                    lifted_lambda_res_f_res_77370 = eta_p_77362;\n                                }\n                                \n                                double lifted_lambda_res_f_res_77371;\n                                \n                                if (zl_res_77369) {\n                                    lifted_l", "ambda_res_f_res_77371 = eta_p_77361;\n                                } else {\n                                    lifted_lambda_res_f_res_77371 = eta_p_77363;\n                                }\n                                lifted_lambda_res_77367 = lifted_lambda_res_f_res_77370;\n                                lifted_lambda_res_77368 = lifted_lambda_res_f_res_77371;\n                            }\n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_86558 = lifted_lambda_res_77367;\n                                eta_p_block_res_acc_86559 = lifted_lambda_res_77368;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540)] = eta_p_block_res_acc_86558;\n            ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_block_res_acc_86559;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_86577 = 1;\n        offset_86576 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_86540, sext_i64_i32(segred_tblock_sizze_77352))) {\n                eta_p_86560 = ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86576)];\n                eta_p_86561 = ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86576)];\n            }\n        }\n        offset_86576 = 1;\n        while (slt32(offset_86576, wave_sizze_86542)) {\n            if (slt32(local_tid_86540 + offset_86576, sext_i64_i32(segred_tblock_sizze_77352)) && ((local_tid_86540 - squot32(local_tid_86540, wave_sizze_86542) * wave_sizze_86542) & (2 * offset_86576 - 1)) == 0) {\n                // read array element\n             ",
                                    "   {\n                    eta_p_86562 = ((volatile __local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86576)];\n                    eta_p_86563 = ((volatile __local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86576)];\n                }\n                // apply reduction operation\n                {\n                    bool zg_res_86564 = clBase_48692 < eta_p_86561;\n                    bool zg_res_86565 = clBase_48692 < eta_p_86563;\n                    bool x_86566 = zg_res_86564 && zg_res_86565;\n                    int64_t lifted_lambda_res_86567;\n                    double lifted_lambda_res_86568;\n                    \n                    if (x_86566) {\n                        lifted_lambda_res_86567 = (int64_t) -1;\n                        lifted_lambda_res_86568 = INFINITY;\n                    } else {\n                        bool zl_res_86569 = eta_p_86561 < eta_p_86563;\n                        int64_t lifted_lambda_res_f_res_86570;\n                        \n                        if (zl_res_86569) {\n                            lifted_lambda_res_f_res_86570 = eta_p_86560;\n                        } else {\n                            lifted_lambda_res_f_res_86570 = eta_p_86562;\n                        }\n                        \n                        double lifted_lambda_res_f_res_86571;\n                        \n                        if (zl_res_86569) {\n                            lifted_lambda_res_f_res_86571 = eta_p_86561;\n                        } else {\n                            lifted_lambda_res_f_res_86571 = eta_p_86563;\n                        }\n                        lifted_lambda_res_86567 = lifted_lambda_res_f_res_86570;\n                        lifted_lambda_res_86568 = lifted_lambda_res_f_res_86571;\n                    }\n                    eta_p_86560 = lifted_lambda_res_86567;\n                    eta_p_86561 = lifted_lambda_res_86568;\n                }\n                // write result of operatio", "n\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540)] = eta_p_86560;\n                    ((volatile __local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_86561;\n                }\n            }\n            offset_86576 *= 2;\n        }\n        while (slt32(skip_waves_86577, squot32(sext_i64_i32(segred_tblock_sizze_77352) + wave_sizze_86542 - 1, wave_sizze_86542))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_86576 = skip_waves_86577 * wave_sizze_86542;\n            if (slt32(local_tid_86540 + offset_86576, sext_i64_i32(segred_tblock_sizze_77352)) && ((local_tid_86540 - squot32(local_tid_86540, wave_sizze_86542) * wave_sizze_86542) == 0 && (squot32(local_tid_86540, wave_sizze_86542) & (2 * skip_waves_86577 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_86562 = ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86576)];\n                    eta_p_86563 = ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86576)];\n                }\n                // apply reduction operation\n                {\n                    bool zg_res_86564 = clBase_48692 < eta_p_86561;\n                    bool zg_res_86565 = clBase_48692 < eta_p_86563;\n                    bool x_86566 = zg_res_86564 && zg_res_86565;\n                    int64_t lifted_lambda_res_86567;\n                    double lifted_lambda_res_86568;\n                    \n                    if (x_86566) {\n                        lifted_lambda_res_86567 = (int64_t) -1;\n                        lifted_lambda_res_86568 = INFINITY;\n                    } else {\n                        bool zl_res_86569 = eta_p_86561 < eta_p_86563;\n                        int64_t lifted_lambda_res_f_res_86570;\n                        \n                        if (zl_res_86569) {\n                            lifted_lambda_res_f_res_865", "70 = eta_p_86560;\n                        } else {\n                            lifted_lambda_res_f_res_86570 = eta_p_86562;\n                        }\n                        \n                        double lifted_lambda_res_f_res_86571;\n                        \n                        if (zl_res_86569) {\n                            lifted_lambda_res_f_res_86571 = eta_p_86561;\n                        } else {\n                            lifted_lambda_res_f_res_86571 = eta_p_86563;\n                        }\n                        lifted_lambda_res_86567 = lifted_lambda_res_f_res_86570;\n                        lifted_lambda_res_86568 = lifted_lambda_res_f_res_86571;\n                    }\n                    eta_p_86560 = lifted_lambda_res_86567;\n                    eta_p_86561 = lifted_lambda_res_86568;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540)] = eta_p_86560;\n                    ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_86561;\n                }\n            }\n            skip_waves_86577 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_86540) == (int64_t) 0) {\n                eta_p_block_res_acc_86558 = eta_p_86560;\n                eta_p_block_res_acc_86559 = eta_p_86561;\n            } else {\n                eta_p_block_res_acc_86558 = (int64_t) -1;\n                eta_p_block_res_acc_86559 = INFINITY;\n            }\n        }\n        if (blocks_per_segment_86529 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_86540 == 0) {\n                    ((__global int64_t *) mem_82737)[inf_63450 + gtid_77357] = eta_p_block_res_acc_86558;\n                    ((__global double *) ",
                                    "mem_82752)[gtid_77357] = eta_p_block_res_acc_86559;\n                }\n            }\n        } else {\n            int32_t old_counter_86578;\n            bool is_last_block_86579;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_86540 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_86533)[sext_i32_i64(virt_tblock_id_86553)] = eta_p_block_res_acc_86558;\n                    mem_fence_global();\n                    ((__global double *) segred_tmp_mem_86535)[sext_i32_i64(virt_tblock_id_86553)] = eta_p_block_res_acc_86559;\n                    mem_fence_global();\n                    old_counter_86578 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86537)[srem64(flat_segment_id_86554, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_86548)[(int64_t) 0] = old_counter_86578 == sext_i64_i32(blocks_per_segment_86529 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_86579 = ((__local bool *) sync_arr_mem_86548)[(int64_t) 0];\n            if (is_last_block_86579) {\n                if (local_tid_86540 == 0) {\n                    old_counter_86578 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86537)[srem64(flat_segment_id_86554, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_86529));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_86580 = sdiv_up64(blocks_per_segment_86529, segred_tblock_sizze_77352);\n                    \n                    eta_p_77360 = (int64_t) -1;\n                    eta_p_77361 = INFINITY;\n                    for (int64_t i_86581 = 0; i_86581 < read_per_thread_86580; i_86581++) {\n                        int64_t block_res_id_86582 = sext_i32_i64(local_tid_86540) * read_per_thread_86580 + i_86581;\n              ", "          int64_t index_of_block_res_86583 = flat_segment_id_86554 * blocks_per_segment_86529 + block_res_id_86582;\n                        \n                        if (slt64(block_res_id_86582, blocks_per_segment_86529)) {\n                            eta_p_77362 = ((__global int64_t *) segred_tmp_mem_86533)[index_of_block_res_86583];\n                            eta_p_77363 = ((__global double *) segred_tmp_mem_86535)[index_of_block_res_86583];\n                            \n                            bool zg_res_77364 = clBase_48692 < eta_p_77361;\n                            bool zg_res_77365 = clBase_48692 < eta_p_77363;\n                            bool x_77366 = zg_res_77364 && zg_res_77365;\n                            int64_t lifted_lambda_res_77367;\n                            double lifted_lambda_res_77368;\n                            \n                            if (x_77366) {\n                                lifted_lambda_res_77367 = (int64_t) -1;\n                                lifted_lambda_res_77368 = INFINITY;\n                            } else {\n                                bool zl_res_77369 = eta_p_77361 < eta_p_77363;\n                                int64_t lifted_lambda_res_f_res_77370;\n                                \n                                if (zl_res_77369) {\n                                    lifted_lambda_res_f_res_77370 = eta_p_77360;\n                                } else {\n                                    lifted_lambda_res_f_res_77370 = eta_p_77362;\n                                }\n                                \n                                double lifted_lambda_res_f_res_77371;\n                                \n                                if (zl_res_77369) {\n                                    lifted_lambda_res_f_res_77371 = eta_p_77361;\n                                } else {\n                                    lifted_lambda_res_f_res_77371 = eta_p_77363;\n                                }\n                              ", "  lifted_lambda_res_77367 = lifted_lambda_res_f_res_77370;\n                                lifted_lambda_res_77368 = lifted_lambda_res_f_res_77371;\n                            }\n                            eta_p_77360 = lifted_lambda_res_77367;\n                            eta_p_77361 = lifted_lambda_res_77368;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540)] = eta_p_77360;\n                ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_77361;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_86584;\n                    int32_t skip_waves_86585 = 1;\n                    int64_t eta_p_86560;\n                    double eta_p_86561;\n                    int64_t eta_p_86562;\n                    double eta_p_86563;\n                    \n                    offset_86584 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_86540, sext_i64_i32(segred_tblock_sizze_77352))) {\n                            eta_p_86560 = ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                            eta_p_86561 = ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                        }\n                    }\n                    offset_86584 = 1;\n                    while (slt32(offset_86584, wave_sizze_86542)) {\n                        if (slt32(local_tid_86540 + offset_86584, sext_i64_i32(segred_tblock_sizze_77352)) && ((local_tid_86540 - squot32(local_tid_86540, wave_sizze_86542) * wave_sizze_86542) & (2 * offset_86584 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_86562 = ((volatile __local int64_t ",
                                    "*) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                                eta_p_86563 = ((volatile __local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zg_res_86564 = clBase_48692 < eta_p_86561;\n                                bool zg_res_86565 = clBase_48692 < eta_p_86563;\n                                bool x_86566 = zg_res_86564 && zg_res_86565;\n                                int64_t lifted_lambda_res_86567;\n                                double lifted_lambda_res_86568;\n                                \n                                if (x_86566) {\n                                    lifted_lambda_res_86567 = (int64_t) -1;\n                                    lifted_lambda_res_86568 = INFINITY;\n                                } else {\n                                    bool zl_res_86569 = eta_p_86561 < eta_p_86563;\n                                    int64_t lifted_lambda_res_f_res_86570;\n                                    \n                                    if (zl_res_86569) {\n                                        lifted_lambda_res_f_res_86570 = eta_p_86560;\n                                    } else {\n                                        lifted_lambda_res_f_res_86570 = eta_p_86562;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_86571;\n                                    \n                                    if (zl_res_86569) {\n                                        lifted_lambda_res_f_res_86571 = eta_p_86561;\n                                    } else {\n                                        lifted_lambda_res_f_res_86571 = eta_p_86563;\n                                    }\n                                    lifted_lambda_res_86567 = lifted_", "lambda_res_f_res_86570;\n                                    lifted_lambda_res_86568 = lifted_lambda_res_f_res_86571;\n                                }\n                                eta_p_86560 = lifted_lambda_res_86567;\n                                eta_p_86561 = lifted_lambda_res_86568;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540)] = eta_p_86560;\n                                ((volatile __local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_86561;\n                            }\n                        }\n                        offset_86584 *= 2;\n                    }\n                    while (slt32(skip_waves_86585, squot32(sext_i64_i32(segred_tblock_sizze_77352) + wave_sizze_86542 - 1, wave_sizze_86542))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_86584 = skip_waves_86585 * wave_sizze_86542;\n                        if (slt32(local_tid_86540 + offset_86584, sext_i64_i32(segred_tblock_sizze_77352)) && ((local_tid_86540 - squot32(local_tid_86540, wave_sizze_86542) * wave_sizze_86542) == 0 && (squot32(local_tid_86540, wave_sizze_86542) & (2 * skip_waves_86585 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_86562 = ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                                eta_p_86563 = ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540 + offset_86584)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zg_res_86564 = clBase_48692 < eta_p_86561;\n                                bool zg_res_86565 = clBase_48692 < eta_p_86563;\n                   ", "             bool x_86566 = zg_res_86564 && zg_res_86565;\n                                int64_t lifted_lambda_res_86567;\n                                double lifted_lambda_res_86568;\n                                \n                                if (x_86566) {\n                                    lifted_lambda_res_86567 = (int64_t) -1;\n                                    lifted_lambda_res_86568 = INFINITY;\n                                } else {\n                                    bool zl_res_86569 = eta_p_86561 < eta_p_86563;\n                                    int64_t lifted_lambda_res_f_res_86570;\n                                    \n                                    if (zl_res_86569) {\n                                        lifted_lambda_res_f_res_86570 = eta_p_86560;\n                                    } else {\n                                        lifted_lambda_res_f_res_86570 = eta_p_86562;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_86571;\n                                    \n                                    if (zl_res_86569) {\n                                        lifted_lambda_res_f_res_86571 = eta_p_86561;\n                                    } else {\n                                        lifted_lambda_res_f_res_86571 = eta_p_86563;\n                                    }\n                                    lifted_lambda_res_86567 = lifted_lambda_res_f_res_86570;\n                                    lifted_lambda_res_86568 = lifted_lambda_res_f_res_86571;\n                                }\n                                eta_p_86560 = lifted_lambda_res_86567;\n                                eta_p_86561 = lifted_lambda_res_86568;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_86544)[sext_i32_i64(local_tid_86540",
                                    ")] = eta_p_86560;\n                                ((__local double *) red_arr_f64_mem_86546)[sext_i32_i64(local_tid_86540)] = eta_p_86561;\n                            }\n                        }\n                        skip_waves_86585 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_86540 == 0) {\n                            ((__global int64_t *) mem_82737)[inf_63450 + gtid_77357] = eta_p_86560;\n                            ((__global double *) mem_82752)[gtid_77357] = eta_p_86561;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_77352\n    #undef chunk_sizze_86488\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_large_77661_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_large_77661(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t conc_tmp_62379, int64_t inf_63544, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, int64_t num_tblocks_77655, unsigned char x_81841_bits, int64_t blocks_per_segment_86660, int64_t q_86661, int64_t num_virtblocks_86662, int64_t threads_per_segment_86663, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_81972, __global unsigned char *mem_82724, __global unsigned char *mem_82726, __global unsigned char *mem_82728, __global unsigned char *mem_82822, __global unsigned char *mem_82824, __global unsigned char *mem_82826, __global unsigned char *mem_82831, __global unsigned char *segred_tmp_mem_86664, __global unsigned char *segred_tmp_mem_86666, __global unsigned char *counters_mem_86668)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_77654 (do_DBSCAN_doublezi", "segred_large_77661zisegred_tblock_sizze_77654)\n    #define chunk_sizze_86619 (do_DBSCAN_doublezisegred_large_77661zichunk_sizze_86619)\n    \n    volatile __local unsigned char *sync_arr_mem_86679_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_86679_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f64_mem_86677_backing_1 = &shared_mem[sync_arr_mem_86679_backing_2_offset];\n    const int64_t red_arr_f64_mem_86677_backing_1_offset = sync_arr_mem_86679_backing_2_offset + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_86675_backing_0 = &shared_mem[red_arr_f64_mem_86677_backing_1_offset];\n    const int64_t red_arr_i64_mem_86675_backing_0_offset = red_arr_f64_mem_86677_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86671;\n    int32_t tblock_sizze_86674;\n    int32_t wave_sizze_86673;\n    int32_t block_id_86672;\n    int32_t global_tid_86670;\n    int64_t phys_tid_77661;\n    __local unsigned char *red_arr_i64_mem_86675;\n    __local unsigned char *red_arr_f64_mem_86677;\n    __local unsigned char *sync_arr_mem_86679;\n    int32_t phys_tblock_id_86681;\n    int32_t iterations_86682;\n    \n    local_tid_86671 = get_local_id(0);\n    tblock_sizze_86674 = get_local_size(0);\n    wave_sizze_86673 = LOCKSTEP_WIDTH;\n    block_id_86672 = get_tblock_id(0);\n    global_tid_86670 = block_id_86672 * tblock_sizze_86674 + local_tid_86671;\n    phys_tid_77661 = sext_i32_i64(global_tid_86670);\n    red_arr_i64_mem_86675 = (__local unsigned char *) red_arr_i64_mem_86675_backing_0;\n    red_arr_f64_mem_86677 = (__local unsigned char *) red_arr_f64_mem_86677_backing_1;\n    sync_arr_mem_86679 = (__local unsigned char *) sync_arr_mem_86679_backing", "_2;\n    phys_tblock_id_86681 = get_tblock_id(0);\n    iterations_86682 = sdiv_up32(sext_i64_i32(num_virtblocks_86662) - phys_tblock_id_86681, sext_i64_i32(num_tblocks_77655));\n    for (int32_t i_86683 = 0; i_86683 < iterations_86682; i_86683++) {\n        int32_t virt_tblock_id_86684;\n        int64_t flat_segment_id_86685;\n        int64_t global_tid_86686;\n        int64_t slice_86687;\n        int64_t gtid_77659;\n        int64_t remnant_86688;\n        int64_t gtid_77660;\n        int64_t eta_p_block_res_acc_86689;\n        double eta_p_block_res_acc_86690;\n        int64_t eta_p_77662;\n        double eta_p_77663;\n        int64_t eta_p_77664;\n        double eta_p_77665;\n        int64_t tblock_id_in_segment_86703;\n        int64_t block_base_offset_86704;\n        int32_t offset_86707;\n        int32_t skip_waves_86708;\n        int64_t eta_p_86691;\n        double eta_p_86692;\n        int64_t eta_p_86693;\n        double eta_p_86694;\n        \n        virt_tblock_id_86684 = phys_tblock_id_86681 + i_86683 * sext_i64_i32(num_tblocks_77655);\n        flat_segment_id_86685 = squot64(sext_i32_i64(virt_tblock_id_86684), blocks_per_segment_86660);\n        global_tid_86686 = srem64(sext_i32_i64(virt_tblock_id_86684) * segred_tblock_sizze_77654 + sext_i32_i64(local_tid_86671), threads_per_segment_86663);\n        slice_86687 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;\n        gtid_77659 = flat_segment_id_86685;\n        remnant_86688 = flat_segment_id_86685 - gtid_77659;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_86689 = (int64_t) -1;\n            eta_p_block_res_acc_86690 = INFINITY;\n        }\n        tblock_id_in_segment_86703 = squot64(global_tid_86686, segred_tblock_sizze_77654);\n        block_base_offset_86704 = tblock_id_in_segment_86703 * q_86661 * segred_tblock_sizze_77654;\n        for (int64_t i_86705 = 0; i_86705 < q_86661; i_86705++) {\n            int64_t block_offset_86706 = block_base_offset_86704 + i_86705 * segred_tblo",
                                    "ck_sizze_77654;\n            \n            gtid_77660 = global_tid_86686 + threads_per_segment_86663 * i_86705;\n            if (slt64(gtid_77660, conc_tmp_62379)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_77755 = inf_63544 + gtid_77659;\n                        double eta_p_77679 = ((__global double *) mem_82726)[gtid_77660];\n                        double eta_p_77680 = ((__global double *) mem_82728)[gtid_77660];\n                        int64_t x_77681 = ((__global int64_t *) mem_82724)[gtid_77660];\n                        double d_haversine_res_77676;\n                        \n                        if (x_81841) {\n                            double x_81816 = ((__global double *) mem_82822)[gtid_77659];\n                            \n                            d_haversine_res_77676 = x_81816;\n                        } else {\n                            d_haversine_res_77676 = 0.0;\n                        }\n                        \n                        double d_haversine_res_77677;\n                        \n                        if (x_81841) {\n                            double x_81818 = ((__global double *) mem_82824)[gtid_77659];\n                            \n                            d_haversine_res_77677 = x_81818;\n                        } else {\n                            d_haversine_res_77677 = 0.0;\n                        }\n                        \n                        double cos_res_77678;\n                        \n                        if (x_81841) {\n                            double x_81820 = ((__global double *) mem_82826)[gtid_77659];\n                            \n                            cos_res_77678 = x_81820;\n                        } else {\n                            cos_res_77678 = 0.0;\n                        }\n                        \n                        double dist_res_77682;\n                        \n           ", "             if (clBase_48691 == (int8_t) 0) {\n                            double eta_p_77674 = ((__global double *) current_partition_mem_81940)[slice_77755];\n                            double eta_p_77675 = ((__global double *) current_partition_mem_81941)[slice_77755];\n                            bool zeze_res_77683 = eta_p_77674 == eta_p_77679;\n                            double d_euclidean_res_77684;\n                            \n                            if (zeze_res_77683) {\n                                double zm_res_77685 = eta_p_77675 - eta_p_77680;\n                                double abs_res_77686 = fabs64(zm_res_77685);\n                                \n                                d_euclidean_res_77684 = abs_res_77686;\n                            } else {\n                                bool zeze_res_77687 = eta_p_77675 == eta_p_77680;\n                                double d_euclidean_res_f_res_77688;\n                                \n                                if (zeze_res_77687) {\n                                    double zm_res_77689 = eta_p_77674 - eta_p_77679;\n                                    double abs_res_77690 = fabs64(zm_res_77689);\n                                    \n                                    d_euclidean_res_f_res_77688 = abs_res_77690;\n                                } else {\n                                    double zm_res_77691 = eta_p_77675 - eta_p_77680;\n                                    double zm_res_77692 = eta_p_77674 - eta_p_77679;\n                                    double hypot_res_77693 = futrts_hypot64(zm_res_77692, zm_res_77691);\n                                    \n                                    d_euclidean_res_f_res_77688 = hypot_res_77693;\n                                }\n                                d_euclidean_res_77684 = d_euclidean_res_f_res_77688;\n                            }\n                            dist_res_77682 = d_euclidean_res_77684;\n                        } else {\n      ", "                      double d_haversine_res_77694;\n                            double d_haversine_res_77695;\n                            \n                            if (clBase_48690 == (int8_t) 1) {\n                                d_haversine_res_77694 = eta_p_77679;\n                                d_haversine_res_77695 = eta_p_77680;\n                            } else {\n                                double zt_res_77696 = 3.141592653589793 * eta_p_77679;\n                                double zs_res_77697 = zt_res_77696 / 180.0;\n                                double zt_res_77698 = 3.141592653589793 * eta_p_77680;\n                                double zs_res_77699 = zt_res_77698 / 180.0;\n                                \n                                d_haversine_res_77694 = zs_res_77697;\n                                d_haversine_res_77695 = zs_res_77699;\n                            }\n                            \n                            double zm_res_77700 = d_haversine_res_77676 - d_haversine_res_77694;\n                            double cos_res_77701 = futrts_cos64(zm_res_77700);\n                            double zm_res_77702 = 1.0 - cos_res_77701;\n                            double cos_res_77703 = futrts_cos64(d_haversine_res_77694);\n                            double zt_res_77704 = cos_res_77678 * cos_res_77703;\n                            double zm_res_77705 = d_haversine_res_77677 - d_haversine_res_77695;\n                            double zm_res_77706 = 1.0 - zm_res_77705;\n                            double zt_res_77707 = zt_res_77704 * zm_res_77706;\n                            double zp_res_77708 = zm_res_77702 + zt_res_77707;\n                            double zs_res_77709 = zp_res_77708 / 2.0;\n                            double min_res_77710 = fmin64(1.0, zs_res_77709);\n                            double zt_res_77711 = 2.0 * min_res_77710;\n                            double zm_res_77712 = 1.0 - zt_res_77711;\n                            double a",
                                    "cos_res_77713 = futrts_acos64(zm_res_77712);\n                            double zt_res_77714 = clBase_48698 * acos_res_77713;\n                            \n                            dist_res_77682 = zt_res_77714;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_77662 = eta_p_block_res_acc_86689;\n                            eta_p_77663 = eta_p_block_res_acc_86690;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_77664 = x_77681;\n                            eta_p_77665 = dist_res_77682;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            bool zg_res_77666 = clBase_48692 < eta_p_77663;\n                            bool zg_res_77667 = clBase_48692 < eta_p_77665;\n                            bool x_77668 = zg_res_77666 && zg_res_77667;\n                            int64_t lifted_lambda_res_77669;\n                            double lifted_lambda_res_77670;\n                            \n                            if (x_77668) {\n                                lifted_lambda_res_77669 = (int64_t) -1;\n                                lifted_lambda_res_77670 = INFINITY;\n                            } else {\n                                bool zl_res_77671 = eta_p_77663 < eta_p_77665;\n                                int64_t lifted_lambda_res_f_res_77672;\n                                \n                                if (zl_res_77671) {\n                                    lifted_lambda_res_f_res_77672 = eta_p_77662;\n                                } else {\n                                    lifted_lambda_res_f_res_77672 = eta_p_77664;\n                                }\n                                \n                                double lifted_lambda_res_f_res_77673;\n                                \n                                ", "if (zl_res_77671) {\n                                    lifted_lambda_res_f_res_77673 = eta_p_77663;\n                                } else {\n                                    lifted_lambda_res_f_res_77673 = eta_p_77665;\n                                }\n                                lifted_lambda_res_77669 = lifted_lambda_res_f_res_77672;\n                                lifted_lambda_res_77670 = lifted_lambda_res_f_res_77673;\n                            }\n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_86689 = lifted_lambda_res_77669;\n                                eta_p_block_res_acc_86690 = lifted_lambda_res_77670;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_block_res_acc_86689;\n            ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_block_res_acc_86690;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_86708 = 1;\n        offset_86707 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_86671, sext_i64_i32(segred_tblock_sizze_77654))) {\n                eta_p_86691 = ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86707)];\n                eta_p_86692 = ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86707)];\n            }\n        }\n        offset_86707 = 1;\n        while (slt32(offset_86707, wave_sizze_86673)) {\n            if (slt32(local_tid_86671 + offset_86707, sext_i64_i32(segred_tblock_sizze_77654)) && ((local_tid_86671 - squot32(local_tid_86671, wave_sizze_86673) * wave_sizze_86673) & (2 * offset_86707 -", " 1)) == 0) {\n                // read array element\n                {\n                    eta_p_86693 = ((volatile __local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86707)];\n                    eta_p_86694 = ((volatile __local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86707)];\n                }\n                // apply reduction operation\n                {\n                    bool zg_res_86695 = clBase_48692 < eta_p_86692;\n                    bool zg_res_86696 = clBase_48692 < eta_p_86694;\n                    bool x_86697 = zg_res_86695 && zg_res_86696;\n                    int64_t lifted_lambda_res_86698;\n                    double lifted_lambda_res_86699;\n                    \n                    if (x_86697) {\n                        lifted_lambda_res_86698 = (int64_t) -1;\n                        lifted_lambda_res_86699 = INFINITY;\n                    } else {\n                        bool zl_res_86700 = eta_p_86692 < eta_p_86694;\n                        int64_t lifted_lambda_res_f_res_86701;\n                        \n                        if (zl_res_86700) {\n                            lifted_lambda_res_f_res_86701 = eta_p_86691;\n                        } else {\n                            lifted_lambda_res_f_res_86701 = eta_p_86693;\n                        }\n                        \n                        double lifted_lambda_res_f_res_86702;\n                        \n                        if (zl_res_86700) {\n                            lifted_lambda_res_f_res_86702 = eta_p_86692;\n                        } else {\n                            lifted_lambda_res_f_res_86702 = eta_p_86694;\n                        }\n                        lifted_lambda_res_86698 = lifted_lambda_res_f_res_86701;\n                        lifted_lambda_res_86699 = lifted_lambda_res_f_res_86702;\n                    }\n                    eta_p_86691 = lifted_lambda_res_86698;\n                    eta_p_86692 = lifted_lambda_res_8669",
                                    "9;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_86691;\n                    ((volatile __local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_86692;\n                }\n            }\n            offset_86707 *= 2;\n        }\n        while (slt32(skip_waves_86708, squot32(sext_i64_i32(segred_tblock_sizze_77654) + wave_sizze_86673 - 1, wave_sizze_86673))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_86707 = skip_waves_86708 * wave_sizze_86673;\n            if (slt32(local_tid_86671 + offset_86707, sext_i64_i32(segred_tblock_sizze_77654)) && ((local_tid_86671 - squot32(local_tid_86671, wave_sizze_86673) * wave_sizze_86673) == 0 && (squot32(local_tid_86671, wave_sizze_86673) & (2 * skip_waves_86708 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_86693 = ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86707)];\n                    eta_p_86694 = ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86707)];\n                }\n                // apply reduction operation\n                {\n                    bool zg_res_86695 = clBase_48692 < eta_p_86692;\n                    bool zg_res_86696 = clBase_48692 < eta_p_86694;\n                    bool x_86697 = zg_res_86695 && zg_res_86696;\n                    int64_t lifted_lambda_res_86698;\n                    double lifted_lambda_res_86699;\n                    \n                    if (x_86697) {\n                        lifted_lambda_res_86698 = (int64_t) -1;\n                        lifted_lambda_res_86699 = INFINITY;\n                    } else {\n                        bool zl_res_86700 = eta_p_86692 < eta_p_86694;\n                        int64_t lifted_lambda_res_f_res_86701;\n                        \n                        if (zl_res_", "86700) {\n                            lifted_lambda_res_f_res_86701 = eta_p_86691;\n                        } else {\n                            lifted_lambda_res_f_res_86701 = eta_p_86693;\n                        }\n                        \n                        double lifted_lambda_res_f_res_86702;\n                        \n                        if (zl_res_86700) {\n                            lifted_lambda_res_f_res_86702 = eta_p_86692;\n                        } else {\n                            lifted_lambda_res_f_res_86702 = eta_p_86694;\n                        }\n                        lifted_lambda_res_86698 = lifted_lambda_res_f_res_86701;\n                        lifted_lambda_res_86699 = lifted_lambda_res_f_res_86702;\n                    }\n                    eta_p_86691 = lifted_lambda_res_86698;\n                    eta_p_86692 = lifted_lambda_res_86699;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_86691;\n                    ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_86692;\n                }\n            }\n            skip_waves_86708 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_86671) == (int64_t) 0) {\n                eta_p_block_res_acc_86689 = eta_p_86691;\n                eta_p_block_res_acc_86690 = eta_p_86692;\n            } else {\n                eta_p_block_res_acc_86689 = (int64_t) -1;\n                eta_p_block_res_acc_86690 = INFINITY;\n            }\n        }\n        if (blocks_per_segment_86660 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_86671 == 0) {\n                    ((__global int64_t *) mem_81972)[inf_63544 + gtid_77659] = eta_", "p_block_res_acc_86689;\n                    ((__global double *) mem_82831)[gtid_77659] = eta_p_block_res_acc_86690;\n                }\n            }\n        } else {\n            int32_t old_counter_86709;\n            bool is_last_block_86710;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_86671 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_86664)[sext_i32_i64(virt_tblock_id_86684)] = eta_p_block_res_acc_86689;\n                    mem_fence_global();\n                    ((__global double *) segred_tmp_mem_86666)[sext_i32_i64(virt_tblock_id_86684)] = eta_p_block_res_acc_86690;\n                    mem_fence_global();\n                    old_counter_86709 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86668)[srem64(flat_segment_id_86685, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_86679)[(int64_t) 0] = old_counter_86709 == sext_i64_i32(blocks_per_segment_86660 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_86710 = ((__local bool *) sync_arr_mem_86679)[(int64_t) 0];\n            if (is_last_block_86710) {\n                if (local_tid_86671 == 0) {\n                    old_counter_86709 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86668)[srem64(flat_segment_id_86685, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_86660));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_86711 = sdiv_up64(blocks_per_segment_86660, segred_tblock_sizze_77654);\n                    \n                    eta_p_77662 = (int64_t) -1;\n                    eta_p_77663 = INFINITY;\n                    for (int64_t i_86712 = 0; i_86712 < read_per_thread_86711; i_86712++) {\n                        int64_t block_res_id_86713 = sext_i32_i64(lo",
                                    "cal_tid_86671) * read_per_thread_86711 + i_86712;\n                        int64_t index_of_block_res_86714 = flat_segment_id_86685 * blocks_per_segment_86660 + block_res_id_86713;\n                        \n                        if (slt64(block_res_id_86713, blocks_per_segment_86660)) {\n                            eta_p_77664 = ((__global int64_t *) segred_tmp_mem_86664)[index_of_block_res_86714];\n                            eta_p_77665 = ((__global double *) segred_tmp_mem_86666)[index_of_block_res_86714];\n                            \n                            bool zg_res_77666 = clBase_48692 < eta_p_77663;\n                            bool zg_res_77667 = clBase_48692 < eta_p_77665;\n                            bool x_77668 = zg_res_77666 && zg_res_77667;\n                            int64_t lifted_lambda_res_77669;\n                            double lifted_lambda_res_77670;\n                            \n                            if (x_77668) {\n                                lifted_lambda_res_77669 = (int64_t) -1;\n                                lifted_lambda_res_77670 = INFINITY;\n                            } else {\n                                bool zl_res_77671 = eta_p_77663 < eta_p_77665;\n                                int64_t lifted_lambda_res_f_res_77672;\n                                \n                                if (zl_res_77671) {\n                                    lifted_lambda_res_f_res_77672 = eta_p_77662;\n                                } else {\n                                    lifted_lambda_res_f_res_77672 = eta_p_77664;\n                                }\n                                \n                                double lifted_lambda_res_f_res_77673;\n                                \n                                if (zl_res_77671) {\n                                    lifted_lambda_res_f_res_77673 = eta_p_77663;\n                                } else {\n                                    lifted_lambda_res_f_res_77673 = eta_p_77665;\n", "                                }\n                                lifted_lambda_res_77669 = lifted_lambda_res_f_res_77672;\n                                lifted_lambda_res_77670 = lifted_lambda_res_f_res_77673;\n                            }\n                            eta_p_77662 = lifted_lambda_res_77669;\n                            eta_p_77663 = lifted_lambda_res_77670;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_77662;\n                ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_77663;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_86715;\n                    int32_t skip_waves_86716 = 1;\n                    int64_t eta_p_86691;\n                    double eta_p_86692;\n                    int64_t eta_p_86693;\n                    double eta_p_86694;\n                    \n                    offset_86715 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_86671, sext_i64_i32(segred_tblock_sizze_77654))) {\n                            eta_p_86691 = ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                            eta_p_86692 = ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                        }\n                    }\n                    offset_86715 = 1;\n                    while (slt32(offset_86715, wave_sizze_86673)) {\n                        if (slt32(local_tid_86671 + offset_86715, sext_i64_i32(segred_tblock_sizze_77654)) && ((local_tid_86671 - squot32(local_tid_86671, wave_sizze_86673) * wave_sizze_86673) & (2 * offset_86715 - 1)) == 0) {\n                            // read array element\n                            {\n         ", "                       eta_p_86693 = ((volatile __local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                                eta_p_86694 = ((volatile __local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zg_res_86695 = clBase_48692 < eta_p_86692;\n                                bool zg_res_86696 = clBase_48692 < eta_p_86694;\n                                bool x_86697 = zg_res_86695 && zg_res_86696;\n                                int64_t lifted_lambda_res_86698;\n                                double lifted_lambda_res_86699;\n                                \n                                if (x_86697) {\n                                    lifted_lambda_res_86698 = (int64_t) -1;\n                                    lifted_lambda_res_86699 = INFINITY;\n                                } else {\n                                    bool zl_res_86700 = eta_p_86692 < eta_p_86694;\n                                    int64_t lifted_lambda_res_f_res_86701;\n                                    \n                                    if (zl_res_86700) {\n                                        lifted_lambda_res_f_res_86701 = eta_p_86691;\n                                    } else {\n                                        lifted_lambda_res_f_res_86701 = eta_p_86693;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_86702;\n                                    \n                                    if (zl_res_86700) {\n                                        lifted_lambda_res_f_res_86702 = eta_p_86692;\n                                    } else {\n                                        lifted_lambda_res_f_res_86702 = eta_p_86694;\n                                    }\n     ",
                                    "                               lifted_lambda_res_86698 = lifted_lambda_res_f_res_86701;\n                                    lifted_lambda_res_86699 = lifted_lambda_res_f_res_86702;\n                                }\n                                eta_p_86691 = lifted_lambda_res_86698;\n                                eta_p_86692 = lifted_lambda_res_86699;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_86691;\n                                ((volatile __local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_86692;\n                            }\n                        }\n                        offset_86715 *= 2;\n                    }\n                    while (slt32(skip_waves_86716, squot32(sext_i64_i32(segred_tblock_sizze_77654) + wave_sizze_86673 - 1, wave_sizze_86673))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_86715 = skip_waves_86716 * wave_sizze_86673;\n                        if (slt32(local_tid_86671 + offset_86715, sext_i64_i32(segred_tblock_sizze_77654)) && ((local_tid_86671 - squot32(local_tid_86671, wave_sizze_86673) * wave_sizze_86673) == 0 && (squot32(local_tid_86671, wave_sizze_86673) & (2 * skip_waves_86716 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_86693 = ((__local int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                                eta_p_86694 = ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671 + offset_86715)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zg_res_86695 = clBase_48692 < eta_p_86692;\n                                boo", "l zg_res_86696 = clBase_48692 < eta_p_86694;\n                                bool x_86697 = zg_res_86695 && zg_res_86696;\n                                int64_t lifted_lambda_res_86698;\n                                double lifted_lambda_res_86699;\n                                \n                                if (x_86697) {\n                                    lifted_lambda_res_86698 = (int64_t) -1;\n                                    lifted_lambda_res_86699 = INFINITY;\n                                } else {\n                                    bool zl_res_86700 = eta_p_86692 < eta_p_86694;\n                                    int64_t lifted_lambda_res_f_res_86701;\n                                    \n                                    if (zl_res_86700) {\n                                        lifted_lambda_res_f_res_86701 = eta_p_86691;\n                                    } else {\n                                        lifted_lambda_res_f_res_86701 = eta_p_86693;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_86702;\n                                    \n                                    if (zl_res_86700) {\n                                        lifted_lambda_res_f_res_86702 = eta_p_86692;\n                                    } else {\n                                        lifted_lambda_res_f_res_86702 = eta_p_86694;\n                                    }\n                                    lifted_lambda_res_86698 = lifted_lambda_res_f_res_86701;\n                                    lifted_lambda_res_86699 = lifted_lambda_res_f_res_86702;\n                                }\n                                eta_p_86691 = lifted_lambda_res_86698;\n                                eta_p_86692 = lifted_lambda_res_86699;\n                            }\n                            // write result of operation\n                            {\n                                ((__loca", "l int64_t *) red_arr_i64_mem_86675)[sext_i32_i64(local_tid_86671)] = eta_p_86691;\n                                ((__local double *) red_arr_f64_mem_86677)[sext_i32_i64(local_tid_86671)] = eta_p_86692;\n                            }\n                        }\n                        skip_waves_86716 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_86671 == 0) {\n                            ((__global int64_t *) mem_81972)[inf_63544 + gtid_77659] = eta_p_86691;\n                            ((__global double *) mem_82831)[gtid_77659] = eta_p_86692;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_77654\n    #undef chunk_sizze_86619\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_large_84292_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_large_84292(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t num_tblocks_75446, int64_t num_subhistos_84206, int64_t blocks_per_segment_84323, int64_t q_84324, int64_t num_virtblocks_84325, int64_t threads_per_segment_84326, __global unsigned char *mem_82212, __global unsigned char *defunc_0_map_res_subhistos_mem_84207, __global unsigned char *segred_tmp_mem_84327, __global unsigned char *counters_mem_84329)\n{\n    #define seghist_tblock_sizze_75444 (do_DBSCAN_doublezisegred_large_84292ziseghist_tblock_sizze_75444)\n    #define chunk_sizze_84293 (do_DBSCAN_doublezisegred_large_84292zichunk_sizze_84293)\n    \n    volatile __local unsigned char *sync_arr_mem_84338_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_84338_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_84336_backing_0 = &shared_mem[sync_arr_mem_84338_backing_1_offset];\n    const int64_t red_arr_i",
                                    "64_mem_84336_backing_0_offset = sync_arr_mem_84338_backing_1_offset + ((int64_t) 8 * seghist_tblock_sizze_75444 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_75444, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84332;\n    int32_t tblock_sizze_84335;\n    int32_t wave_sizze_84334;\n    int32_t block_id_84333;\n    int32_t global_tid_84331;\n    int64_t flat_gtid_84292;\n    __local unsigned char *red_arr_i64_mem_84336;\n    __local unsigned char *sync_arr_mem_84338;\n    int32_t phys_tblock_id_84340;\n    int32_t iterations_84341;\n    \n    local_tid_84332 = get_local_id(0);\n    tblock_sizze_84335 = get_local_size(0);\n    wave_sizze_84334 = LOCKSTEP_WIDTH;\n    block_id_84333 = get_tblock_id(0);\n    global_tid_84331 = block_id_84333 * tblock_sizze_84335 + local_tid_84332;\n    flat_gtid_84292 = sext_i32_i64(global_tid_84331);\n    red_arr_i64_mem_84336 = (__local unsigned char *) red_arr_i64_mem_84336_backing_0;\n    sync_arr_mem_84338 = (__local unsigned char *) sync_arr_mem_84338_backing_1;\n    phys_tblock_id_84340 = get_tblock_id(0);\n    iterations_84341 = sdiv_up32(sext_i64_i32(num_virtblocks_84325) - phys_tblock_id_84340, sext_i64_i32(num_tblocks_75446));\n    for (int32_t i_84342 = 0; i_84342 < iterations_84341; i_84342++) {\n        int32_t virt_tblock_id_84343;\n        int64_t flat_segment_id_84344;\n        int64_t global_tid_84345;\n        int64_t slice_84346;\n        int64_t bucket_id_84290;\n        int64_t remnant_84347;\n        int64_t subhistogram_id_84291;\n        int64_t eta_p_block_res_acc_84348;\n        int64_t eta_p_75452;\n        int64_t eta_p_75453;\n        int64_t tblock_id_in_segment_84352;\n        int64_t block_base_offset_84353;\n        int32_t offset_84356;\n        int32_t skip_waves_84357;\n        int64_t eta_p_84349;\n        int64_t eta_p_84350;\n        \n        virt_tblock_id_84343 = phys_tblock_id_84340 + i_84342 * sext_i64_i32(num_tblocks_75446);\n        flat_segment_id_843", "44 = squot64(sext_i32_i64(virt_tblock_id_84343), blocks_per_segment_84323);\n        global_tid_84345 = srem64(sext_i32_i64(virt_tblock_id_84343) * seghist_tblock_sizze_75444 + sext_i32_i64(local_tid_84332), threads_per_segment_84326);\n        slice_84346 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;\n        bucket_id_84290 = flat_segment_id_84344;\n        remnant_84347 = flat_segment_id_84344 - bucket_id_84290;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_84348 = (int64_t) 0;\n        }\n        tblock_id_in_segment_84352 = squot64(global_tid_84345, seghist_tblock_sizze_75444);\n        block_base_offset_84353 = tblock_id_in_segment_84352 * q_84324 * seghist_tblock_sizze_75444;\n        for (int64_t i_84354 = 0; i_84354 < q_84324; i_84354++) {\n            int64_t block_offset_84355 = block_base_offset_84353 + i_84354 * seghist_tblock_sizze_75444;\n            \n            subhistogram_id_84291 = global_tid_84345 + threads_per_segment_84326 * i_84354;\n            if (slt64(subhistogram_id_84291, num_subhistos_84206)) {\n                // apply map function(s)\n                {\n                    // load accumulator(s)\n                    {\n                        eta_p_75452 = eta_p_block_res_acc_84348;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_75453 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_84207)[subhistogram_id_84291 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 + bucket_id_84290];\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t defunc_0_op_res_75454 = add64(eta_p_75452, eta_p_75453);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_84348 = defunc_0_op_res_75454;\n                        }\n                    }\n                }\n            }\n        }\n   ", "     barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_block_res_acc_84348;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_84357 = 1;\n        offset_84356 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_84332, sext_i64_i32(seghist_tblock_sizze_75444))) {\n                eta_p_84349 = ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84356)];\n            }\n        }\n        offset_84356 = 1;\n        while (slt32(offset_84356, wave_sizze_84334)) {\n            if (slt32(local_tid_84332 + offset_84356, sext_i64_i32(seghist_tblock_sizze_75444)) && ((local_tid_84332 - squot32(local_tid_84332, wave_sizze_84334) * wave_sizze_84334) & (2 * offset_84356 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_84350 = ((volatile __local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84356)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_0_op_res_84351 = add64(eta_p_84349, eta_p_84350);\n                    \n                    eta_p_84349 = defunc_0_op_res_84351;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_84349;\n                }\n            }\n            offset_84356 *= 2;\n        }\n        while (slt32(skip_waves_84357, squot32(sext_i64_i32(seghist_tblock_sizze_75444) + wave_sizze_84334 - 1, wave_sizze_84334))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_84356 = skip_waves_84357 * wave_sizze_84334;\n            if (slt32(local_tid_84332 + offset_84356, sext_i64_i32(seghist_tblock_sizze_75444)) && ((local_tid_84332",
                                    " - squot32(local_tid_84332, wave_sizze_84334) * wave_sizze_84334) == 0 && (squot32(local_tid_84332, wave_sizze_84334) & (2 * skip_waves_84357 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_84350 = ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84356)];\n                }\n                // apply reduction operation\n                {\n                    int64_t defunc_0_op_res_84351 = add64(eta_p_84349, eta_p_84350);\n                    \n                    eta_p_84349 = defunc_0_op_res_84351;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_84349;\n                }\n            }\n            skip_waves_84357 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_84332) == (int64_t) 0) {\n                eta_p_block_res_acc_84348 = eta_p_84349;\n            } else {\n                eta_p_block_res_acc_84348 = (int64_t) 0;\n            }\n        }\n        if (blocks_per_segment_84323 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_84332 == 0) {\n                    ((__global int64_t *) mem_82212)[bucket_id_84290] = eta_p_block_res_acc_84348;\n                }\n            }\n        } else {\n            int32_t old_counter_84358;\n            bool is_last_block_84359;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_84332 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_84327)[sext_i32_i64(virt_tblock_id_84343)] = eta_p_block_res_acc_84348;\n                    mem_fence_global();\n                    old_counter_84358 = atomic_add_i32_global", "(&((volatile __global int *) counters_mem_84329)[srem64(flat_segment_id_84344, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_84338)[(int64_t) 0] = old_counter_84358 == sext_i64_i32(blocks_per_segment_84323 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_84359 = ((__local bool *) sync_arr_mem_84338)[(int64_t) 0];\n            if (is_last_block_84359) {\n                if (local_tid_84332 == 0) {\n                    old_counter_84358 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84329)[srem64(flat_segment_id_84344, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_84323));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_84360 = sdiv_up64(blocks_per_segment_84323, seghist_tblock_sizze_75444);\n                    \n                    eta_p_75452 = (int64_t) 0;\n                    for (int64_t i_84361 = 0; i_84361 < read_per_thread_84360; i_84361++) {\n                        int64_t block_res_id_84362 = sext_i32_i64(local_tid_84332) * read_per_thread_84360 + i_84361;\n                        int64_t index_of_block_res_84363 = flat_segment_id_84344 * blocks_per_segment_84323 + block_res_id_84362;\n                        \n                        if (slt64(block_res_id_84362, blocks_per_segment_84323)) {\n                            eta_p_75453 = ((__global int64_t *) segred_tmp_mem_84327)[index_of_block_res_84363];\n                            \n                            int64_t defunc_0_op_res_75454 = add64(eta_p_75452, eta_p_75453);\n                            \n                            eta_p_75452 = defunc_0_op_res_75454;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_75452;\n                barrier(CLK_LOCAL_MEM_F", "ENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_84364;\n                    int32_t skip_waves_84365 = 1;\n                    int64_t eta_p_84349;\n                    int64_t eta_p_84350;\n                    \n                    offset_84364 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_84332, sext_i64_i32(seghist_tblock_sizze_75444))) {\n                            eta_p_84349 = ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84364)];\n                        }\n                    }\n                    offset_84364 = 1;\n                    while (slt32(offset_84364, wave_sizze_84334)) {\n                        if (slt32(local_tid_84332 + offset_84364, sext_i64_i32(seghist_tblock_sizze_75444)) && ((local_tid_84332 - squot32(local_tid_84332, wave_sizze_84334) * wave_sizze_84334) & (2 * offset_84364 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_84350 = ((volatile __local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84364)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_0_op_res_84351 = add64(eta_p_84349, eta_p_84350);\n                                \n                                eta_p_84349 = defunc_0_op_res_84351;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_84349;\n                            }\n                        }\n                        offset_84364 *= 2;\n                    }\n                    while (slt32(skip_waves_84365, squot32(sext_i64_i32(seghist_",
                                    "tblock_sizze_75444) + wave_sizze_84334 - 1, wave_sizze_84334))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_84364 = skip_waves_84365 * wave_sizze_84334;\n                        if (slt32(local_tid_84332 + offset_84364, sext_i64_i32(seghist_tblock_sizze_75444)) && ((local_tid_84332 - squot32(local_tid_84332, wave_sizze_84334) * wave_sizze_84334) == 0 && (squot32(local_tid_84332, wave_sizze_84334) & (2 * skip_waves_84365 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_84350 = ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332 + offset_84364)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t defunc_0_op_res_84351 = add64(eta_p_84349, eta_p_84350);\n                                \n                                eta_p_84349 = defunc_0_op_res_84351;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_84336)[sext_i32_i64(local_tid_84332)] = eta_p_84349;\n                            }\n                        }\n                        skip_waves_84365 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_84332 == 0) {\n                            ((__global int64_t *) mem_82212)[bucket_id_84290] = eta_p_84349;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef seghist_tblock_sizze_75444\n    #undef chunk_sizze_84293\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_nonseg_75483_dim1, 1, 1)\nvoid do_DBSCAN_d", "oublezisegred_nonseg_75483(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75478, int64_t num_threads_84508, __global unsigned char *ext_mem_82220, __global unsigned char *mem_82228, __global unsigned char *counters_mem_84504, __global unsigned char *segred_tmp_mem_84506)\n{\n    #define segred_tblock_sizze_75476 (do_DBSCAN_doublezisegred_nonseg_75483zisegred_tblock_sizze_75476)\n    #define chunk_sizze_84503 (do_DBSCAN_doublezisegred_nonseg_75483zichunk_sizze_84503)\n    \n    volatile __local unsigned char *sync_arr_mem_84516_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_84516_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_84514_backing_0 = &shared_mem[sync_arr_mem_84516_backing_1_offset];\n    const int64_t red_arr_bool_mem_84514_backing_0_offset = sync_arr_mem_84516_backing_1_offset + (segred_tblock_sizze_75476 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75476, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84510;\n    int32_t tblock_sizze_84513;\n    int32_t wave_sizze_84512;\n    int32_t block_id_84511;\n    int32_t global_tid_84509;\n    int64_t phys_tid_75483;\n    __local unsigned char *red_arr_bool_mem_84514;\n    __local unsigned char *sync_arr_mem_84516;\n    int64_t dummy_75481;\n    int64_t gtid_75482;\n    int64_t q_84518;\n    bool eta_p_block_res_acc_84519;\n    bool eta_p_66520;\n    bool eta_p_66521;\n    int64_t tblock_id_in_segment_84523;\n    int64_t block_base_offset_84524;\n    int32_t offset_84527;\n    int32_t skip_waves_84528;\n    bool eta_p_84520;\n    bool eta_p_84521;\n    int32_t old_counter_84529;\n    bool is_last_block_84530;\n    \n    local_tid_84510 = get_local_id(0);\n    tblock_sizze_84513 = get_local_size(0);\n    wave_sizze_84512 = LOCKSTEP_WIDTH;\n    block_id_84511 = get_tblock_id(0);\n    global_tid_84509 = block_id_84511 * tblock_sizze_84513 + local_tid_84510;\n    phys_tid_75483 = sext_i32_i64(global_tid_8", "4509);\n    red_arr_bool_mem_84514 = (__local unsigned char *) red_arr_bool_mem_84514_backing_0;\n    sync_arr_mem_84516 = (__local unsigned char *) sync_arr_mem_84516_backing_1;\n    dummy_75481 = (int64_t) 0;\n    gtid_75482 = (int64_t) 0;\n    q_84518 = sdiv_up64(mk_adjacency_list_res_66334, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_75476 * num_tblocks_75478)) * chunk_sizze_84503);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_84519 = 0;\n    }\n    tblock_id_in_segment_84523 = squot64(phys_tid_75483, segred_tblock_sizze_75476);\n    block_base_offset_84524 = tblock_id_in_segment_84523 * q_84518 * segred_tblock_sizze_75476;\n    for (int64_t i_84525 = 0; i_84525 < q_84518; i_84525++) {\n        int64_t block_offset_84526 = block_base_offset_84524 + i_84525 * segred_tblock_sizze_75476;\n        \n        gtid_75482 = phys_tid_75483 + num_threads_84508 * i_84525;\n        if (slt64(gtid_75482, mk_adjacency_list_res_66334)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t eta_p_66517 = ((__global int64_t *) ext_mem_82220)[gtid_75482];\n                    bool lifted_lambda_res_66518 = (int64_t) -1 == eta_p_66517;\n                    bool lifted_lambda_res_66519 = !lifted_lambda_res_66518;\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_66520 = eta_p_block_res_acc_84519;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_66521 = lifted_lambda_res_66519;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_op_res_66522 = eta_p_66520 || eta_p_66521;\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_84519 = defunc_0_op_res_66522;\n          ",
                                    "              }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_block_res_acc_84519;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_84528 = 1;\n    offset_84527 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_84510, sext_i64_i32(segred_tblock_sizze_75476))) {\n            eta_p_84520 = ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84527)];\n        }\n    }\n    offset_84527 = 1;\n    while (slt32(offset_84527, wave_sizze_84512)) {\n        if (slt32(local_tid_84510 + offset_84527, sext_i64_i32(segred_tblock_sizze_75476)) && ((local_tid_84510 - squot32(local_tid_84510, wave_sizze_84512) * wave_sizze_84512) & (2 * offset_84527 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_84521 = ((volatile __local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84527)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_84522 = eta_p_84520 || eta_p_84521;\n                \n                eta_p_84520 = defunc_0_op_res_84522;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_84520;\n            }\n        }\n        offset_84527 *= 2;\n    }\n    while (slt32(skip_waves_84528, squot32(sext_i64_i32(segred_tblock_sizze_75476) + wave_sizze_84512 - 1, wave_sizze_84512))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_84527 = skip_waves_84528 * wave_sizze_84512;\n        if (slt32(local_tid_84510 + offset_84527, sext_i64_i32(segred_tblock_sizze_75476)) && ((local_tid_84510 - squot32(local_tid_84510, wave_sizze_84512) * wave_sizze_84512) == 0 && (squot32(", "local_tid_84510, wave_sizze_84512) & (2 * skip_waves_84528 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_84521 = ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84527)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_84522 = eta_p_84520 || eta_p_84521;\n                \n                eta_p_84520 = defunc_0_op_res_84522;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_84520;\n            }\n        }\n        skip_waves_84528 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_84510) == (int64_t) 0) {\n            eta_p_block_res_acc_84519 = eta_p_84520;\n        } else {\n            eta_p_block_res_acc_84519 = 0;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_84510 == 0) {\n            ((__global bool *) segred_tmp_mem_84506)[sext_i32_i64(block_id_84511)] = eta_p_block_res_acc_84519;\n            mem_fence_global();\n            old_counter_84529 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84504)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_84516)[(int64_t) 0] = old_counter_84529 == sext_i64_i32(num_tblocks_75478 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_84530 = ((__local bool *) sync_arr_mem_84516)[(int64_t) 0];\n    if (is_last_block_84530) {\n        if (local_tid_84510 == 0) {\n            old_counter_84529 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84504)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_75478));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thr", "ead_84531 = sdiv_up64(num_tblocks_75478, segred_tblock_sizze_75476);\n            \n            eta_p_66520 = 0;\n            for (int64_t i_84532 = 0; i_84532 < read_per_thread_84531; i_84532++) {\n                int64_t block_res_id_84533 = sext_i32_i64(local_tid_84510) * read_per_thread_84531 + i_84532;\n                int64_t index_of_block_res_84534 = block_res_id_84533;\n                \n                if (slt64(block_res_id_84533, num_tblocks_75478)) {\n                    eta_p_66521 = ((__global bool *) segred_tmp_mem_84506)[index_of_block_res_84534];\n                    \n                    bool defunc_0_op_res_66522 = eta_p_66520 || eta_p_66521;\n                    \n                    eta_p_66520 = defunc_0_op_res_66522;\n                }\n            }\n        }\n        ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_66520;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_84535;\n            int32_t skip_waves_84536 = 1;\n            bool eta_p_84520;\n            bool eta_p_84521;\n            \n            offset_84535 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_84510, sext_i64_i32(segred_tblock_sizze_75476))) {\n                    eta_p_84520 = ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84535)];\n                }\n            }\n            offset_84535 = 1;\n            while (slt32(offset_84535, wave_sizze_84512)) {\n                if (slt32(local_tid_84510 + offset_84535, sext_i64_i32(segred_tblock_sizze_75476)) && ((local_tid_84510 - squot32(local_tid_84510, wave_sizze_84512) * wave_sizze_84512) & (2 * offset_84535 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_84521 = ((volatile __local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84535)];\n                    }\n       ",
                                    "             // apply reduction operation\n                    {\n                        bool defunc_0_op_res_84522 = eta_p_84520 || eta_p_84521;\n                        \n                        eta_p_84520 = defunc_0_op_res_84522;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_84520;\n                    }\n                }\n                offset_84535 *= 2;\n            }\n            while (slt32(skip_waves_84536, squot32(sext_i64_i32(segred_tblock_sizze_75476) + wave_sizze_84512 - 1, wave_sizze_84512))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_84535 = skip_waves_84536 * wave_sizze_84512;\n                if (slt32(local_tid_84510 + offset_84535, sext_i64_i32(segred_tblock_sizze_75476)) && ((local_tid_84510 - squot32(local_tid_84510, wave_sizze_84512) * wave_sizze_84512) == 0 && (squot32(local_tid_84510, wave_sizze_84512) & (2 * skip_waves_84536 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_84521 = ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510 + offset_84535)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_op_res_84522 = eta_p_84520 || eta_p_84521;\n                        \n                        eta_p_84520 = defunc_0_op_res_84522;\n                    }\n                    // write result of operation\n                    {\n                        ((__local bool *) red_arr_bool_mem_84514)[sext_i32_i64(local_tid_84510)] = eta_p_84520;\n                    }\n                }\n                skip_waves_84536 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_84510 == 0) {\n                    ((__global boo", "l *) mem_82228)[(int64_t) 0] = eta_p_84520;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_75476\n    #undef chunk_sizze_84503\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_nonseg_75518_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_nonseg_75518(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t mk_adjacency_list_res_66334, int64_t num_segments_66572, int64_t num_tblocks_75512, int64_t num_threads_84933, __global unsigned char *mem_param_82235, __global unsigned char *mem_82241, __global unsigned char *mem_82244, __global unsigned char *mem_82246, __global unsigned char *counters_mem_84929, __global unsigned char *segred_tmp_mem_84931)\n{\n    #define segred_tblock_sizze_75510 (do_DBSCAN_doublezisegred_nonseg_75518zisegred_tblock_sizze_75510)\n    #define chunk_sizze_84928 (do_DBSCAN_doublezisegred_nonseg_75518zichunk_sizze_84928)\n    \n    volatile __local unsigned char *sync_arr_mem_84941_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_84941_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_84939_backing_0 = &shared_mem[sync_arr_mem_84941_backing_1_offset];\n    const int64_t red_arr_bool_mem_84939_backing_0_offset = sync_arr_mem_84941_backing_1_offset + (segred_tblock_sizze_75510 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75510, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_84935;\n    int32_t tblock_sizze_84938;\n    int32_t wave_sizze_84937;\n    int32_t block_id_84936;\n    int32_t global_tid_84934;\n    int64_t phys_tid_75518;\n    __local unsigned char *red_arr_bool_mem_84939;\n    __local unsigned char *sync_arr_mem_84941;\n    int64_t dummy_75516;\n    int64_t gtid_75517;\n    int6", "4_t q_84943;\n    bool eta_p_block_res_acc_84944;\n    bool eta_p_66593;\n    bool eta_p_66594;\n    int64_t tblock_id_in_segment_84948;\n    int64_t block_base_offset_84949;\n    int32_t offset_84952;\n    int32_t skip_waves_84953;\n    bool eta_p_84945;\n    bool eta_p_84946;\n    int32_t old_counter_84954;\n    bool is_last_block_84955;\n    \n    local_tid_84935 = get_local_id(0);\n    tblock_sizze_84938 = get_local_size(0);\n    wave_sizze_84937 = LOCKSTEP_WIDTH;\n    block_id_84936 = get_tblock_id(0);\n    global_tid_84934 = block_id_84936 * tblock_sizze_84938 + local_tid_84935;\n    phys_tid_75518 = sext_i32_i64(global_tid_84934);\n    red_arr_bool_mem_84939 = (__local unsigned char *) red_arr_bool_mem_84939_backing_0;\n    sync_arr_mem_84941 = (__local unsigned char *) sync_arr_mem_84941_backing_1;\n    dummy_75516 = (int64_t) 0;\n    gtid_75517 = (int64_t) 0;\n    q_84943 = sdiv_up64(mk_adjacency_list_res_66334, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_75510 * num_tblocks_75512)) * chunk_sizze_84928);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_84944 = 0;\n    }\n    tblock_id_in_segment_84948 = squot64(phys_tid_75518, segred_tblock_sizze_75510);\n    block_base_offset_84949 = tblock_id_in_segment_84948 * q_84943 * segred_tblock_sizze_75510;\n    for (int64_t i_84950 = 0; i_84950 < q_84943; i_84950++) {\n        int64_t block_offset_84951 = block_base_offset_84949 + i_84950 * segred_tblock_sizze_75510;\n        \n        gtid_75517 = phys_tid_75518 + num_threads_84933 * i_84950;\n        if (slt64(gtid_75517, mk_adjacency_list_res_66334)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t eta_p_66585 = ((__global int64_t *) mem_param_82235)[gtid_75517];\n                    bool x_66586 = sle64((int64_t) 0, eta_p_66585);\n                    bool y_66587 = slt64(eta_p_66585, num_segments_66572);\n                    bool bounds_check_66588 = x_66586 && y",
                                    "_66587;\n                    bool index_certs_66589;\n                    \n                    if (!bounds_check_66588) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n                                global_failure_args[0] = (int64_t) eta_p_66585;\n                                global_failure_args[1] = (int64_t) num_segments_66572;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    int64_t lifted_lambda_res_66590 = ((__global int64_t *) mem_82241)[eta_p_66585];\n                    bool lifted_lambda_res_66591 = eta_p_66585 == lifted_lambda_res_66590;\n                    bool lifted_lambda_res_66592 = !lifted_lambda_res_66591;\n                    \n                    // write map-out result(s)\n                    {\n                        ((__global int64_t *) mem_82246)[dummy_75516 * mk_adjacency_list_res_66334 + gtid_75517] = lifted_lambda_res_66590;\n                    }\n                    // load accumulator(s)\n                    {\n                        eta_p_66593 = eta_p_block_res_acc_84944;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_66594 = lifted_lambda_res_66592;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_op_res_66595 = eta_p_66593 || eta_p_66594;\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_84944 = defunc_0_op_res_66595;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE)", ";\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_block_res_acc_84944;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_84953 = 1;\n    offset_84952 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_84935, sext_i64_i32(segred_tblock_sizze_75510))) {\n            eta_p_84945 = ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84952)];\n        }\n    }\n    offset_84952 = 1;\n    while (slt32(offset_84952, wave_sizze_84937)) {\n        if (slt32(local_tid_84935 + offset_84952, sext_i64_i32(segred_tblock_sizze_75510)) && ((local_tid_84935 - squot32(local_tid_84935, wave_sizze_84937) * wave_sizze_84937) & (2 * offset_84952 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_84946 = ((volatile __local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84952)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_84947 = eta_p_84945 || eta_p_84946;\n                \n                eta_p_84945 = defunc_0_op_res_84947;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_84945;\n            }\n        }\n        offset_84952 *= 2;\n    }\n    while (slt32(skip_waves_84953, squot32(sext_i64_i32(segred_tblock_sizze_75510) + wave_sizze_84937 - 1, wave_sizze_84937))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_84952 = skip_waves_84953 * wave_sizze_84937;\n        if (slt32(local_tid_84935 + offset_84952, sext_i64_i32(segred_tblock_sizze_75510)) && ((local_tid_84935 - squot32(local_tid_84935, wave_sizze_84937) * wave_sizze_84937) == 0 && (squot32(local_tid_84935, wave_sizze_84937) & (2 * skip_waves_84953 - 1)) == 0)) {\n            // read array element\n          ", "  {\n                eta_p_84946 = ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84952)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_84947 = eta_p_84945 || eta_p_84946;\n                \n                eta_p_84945 = defunc_0_op_res_84947;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_84945;\n            }\n        }\n        skip_waves_84953 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_84935) == (int64_t) 0) {\n            eta_p_block_res_acc_84944 = eta_p_84945;\n        } else {\n            eta_p_block_res_acc_84944 = 0;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_84935 == 0) {\n            ((__global bool *) segred_tmp_mem_84931)[sext_i32_i64(block_id_84936)] = eta_p_block_res_acc_84944;\n            mem_fence_global();\n            old_counter_84954 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84929)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_84941)[(int64_t) 0] = old_counter_84954 == sext_i64_i32(num_tblocks_75512 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_84955 = ((__local bool *) sync_arr_mem_84941)[(int64_t) 0];\n    if (is_last_block_84955) {\n        if (local_tid_84935 == 0) {\n            old_counter_84954 = atomic_add_i32_global(&((volatile __global int *) counters_mem_84929)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_75512));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_84956 = sdiv_up64(num_tblocks_75512, segred_tblock_sizze_75510);\n            \n            eta_p_66593 = 0;\n       ",
                                    "     for (int64_t i_84957 = 0; i_84957 < read_per_thread_84956; i_84957++) {\n                int64_t block_res_id_84958 = sext_i32_i64(local_tid_84935) * read_per_thread_84956 + i_84957;\n                int64_t index_of_block_res_84959 = block_res_id_84958;\n                \n                if (slt64(block_res_id_84958, num_tblocks_75512)) {\n                    eta_p_66594 = ((__global bool *) segred_tmp_mem_84931)[index_of_block_res_84959];\n                    \n                    bool defunc_0_op_res_66595 = eta_p_66593 || eta_p_66594;\n                    \n                    eta_p_66593 = defunc_0_op_res_66595;\n                }\n            }\n        }\n        ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_66593;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_84960;\n            int32_t skip_waves_84961 = 1;\n            bool eta_p_84945;\n            bool eta_p_84946;\n            \n            offset_84960 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_84935, sext_i64_i32(segred_tblock_sizze_75510))) {\n                    eta_p_84945 = ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84960)];\n                }\n            }\n            offset_84960 = 1;\n            while (slt32(offset_84960, wave_sizze_84937)) {\n                if (slt32(local_tid_84935 + offset_84960, sext_i64_i32(segred_tblock_sizze_75510)) && ((local_tid_84935 - squot32(local_tid_84935, wave_sizze_84937) * wave_sizze_84937) & (2 * offset_84960 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_84946 = ((volatile __local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84960)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_op_res_84947 = e", "ta_p_84945 || eta_p_84946;\n                        \n                        eta_p_84945 = defunc_0_op_res_84947;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_84945;\n                    }\n                }\n                offset_84960 *= 2;\n            }\n            while (slt32(skip_waves_84961, squot32(sext_i64_i32(segred_tblock_sizze_75510) + wave_sizze_84937 - 1, wave_sizze_84937))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_84960 = skip_waves_84961 * wave_sizze_84937;\n                if (slt32(local_tid_84935 + offset_84960, sext_i64_i32(segred_tblock_sizze_75510)) && ((local_tid_84935 - squot32(local_tid_84935, wave_sizze_84937) * wave_sizze_84937) == 0 && (squot32(local_tid_84935, wave_sizze_84937) & (2 * skip_waves_84961 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_84946 = ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935 + offset_84960)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_op_res_84947 = eta_p_84945 || eta_p_84946;\n                        \n                        eta_p_84945 = defunc_0_op_res_84947;\n                    }\n                    // write result of operation\n                    {\n                        ((__local bool *) red_arr_bool_mem_84939)[sext_i32_i64(local_tid_84935)] = eta_p_84945;\n                    }\n                }\n                skip_waves_84961 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_84935 == 0) {\n                    ((__global bool *) mem_82244)[(int64_t) 0] = eta_p_84945;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return", ";\n    #undef segred_tblock_sizze_75510\n    #undef chunk_sizze_84928\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_nonseg_75826_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_nonseg_75826(__global int *global_failure, int64_t conc_tmp_62382, int64_t num_tblocks_75821, int64_t num_threads_85253, __global unsigned char *mem_param_82089, __global unsigned char *ext_mem_82162, __global unsigned char *mem_82164, __global unsigned char *counters_mem_85249, __global unsigned char *segred_tmp_mem_85251)\n{\n    #define segred_tblock_sizze_75819 (do_DBSCAN_doublezisegred_nonseg_75826zisegred_tblock_sizze_75819)\n    #define chunk_sizze_85248 (do_DBSCAN_doublezisegred_nonseg_75826zichunk_sizze_85248)\n    \n    volatile __local unsigned char *sync_arr_mem_85261_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_85261_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_85259_backing_0 = &shared_mem[sync_arr_mem_85261_backing_1_offset];\n    const int64_t red_arr_bool_mem_85259_backing_0_offset = sync_arr_mem_85261_backing_1_offset + (segred_tblock_sizze_75819 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75819, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85255;\n    int32_t tblock_sizze_85258;\n    int32_t wave_sizze_85257;\n    int32_t block_id_85256;\n    int32_t global_tid_85254;\n    int64_t phys_tid_75826;\n    __local unsigned char *red_arr_bool_mem_85259;\n    __local unsigned char *sync_arr_mem_85261;\n    int64_t dummy_75824;\n    int64_t gtid_75825;\n    int64_t q_85263;\n    bool eta_p_block_res_acc_85264;\n    bool eta_p_62792;\n    bool eta_p_62793;\n    int64_t tblock_id_in_segment_85268;\n    int64_t block_base_offset_85269;\n    int32_t offset_85272;\n    int32_t skip_waves_85273;\n    bool eta_p_85265;\n    bool eta_p_85266;\n    int32_t old_counter_85274;\n    bool is_last_block_85275;\n    \n    local_tid_85255 = get_local_id(0);\n    tblock_sizze_85258 = get_local_size(0);\n    wave_sizze_85",
                                    "257 = LOCKSTEP_WIDTH;\n    block_id_85256 = get_tblock_id(0);\n    global_tid_85254 = block_id_85256 * tblock_sizze_85258 + local_tid_85255;\n    phys_tid_75826 = sext_i32_i64(global_tid_85254);\n    red_arr_bool_mem_85259 = (__local unsigned char *) red_arr_bool_mem_85259_backing_0;\n    sync_arr_mem_85261 = (__local unsigned char *) sync_arr_mem_85261_backing_1;\n    dummy_75824 = (int64_t) 0;\n    gtid_75825 = (int64_t) 0;\n    q_85263 = sdiv_up64(conc_tmp_62382, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_75819 * num_tblocks_75821)) * chunk_sizze_85248);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_85264 = 1;\n    }\n    tblock_id_in_segment_85268 = squot64(phys_tid_75826, segred_tblock_sizze_75819);\n    block_base_offset_85269 = tblock_id_in_segment_85268 * q_85263 * segred_tblock_sizze_75819;\n    for (int64_t i_85270 = 0; i_85270 < q_85263; i_85270++) {\n        int64_t block_offset_85271 = block_base_offset_85269 + i_85270 * segred_tblock_sizze_75819;\n        \n        gtid_75825 = phys_tid_75826 + num_threads_85253 * i_85270;\n        if (slt64(gtid_75825, conc_tmp_62382)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t eta_p_65760 = ((__global int64_t *) mem_param_82089)[gtid_75825];\n                    int64_t eta_p_65761 = ((__global int64_t *) ext_mem_82162)[gtid_75825];\n                    bool defunc_0_f_res_65762 = eta_p_65760 == eta_p_65761;\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_62792 = eta_p_block_res_acc_85264;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_62793 = defunc_0_f_res_65762;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool x_62794 = eta_p_62792 && eta_p_62793;\n                        \n           ", "             // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_85264 = x_62794;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_block_res_acc_85264;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_85273 = 1;\n    offset_85272 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_85255, sext_i64_i32(segred_tblock_sizze_75819))) {\n            eta_p_85265 = ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255 + offset_85272)];\n        }\n    }\n    offset_85272 = 1;\n    while (slt32(offset_85272, wave_sizze_85257)) {\n        if (slt32(local_tid_85255 + offset_85272, sext_i64_i32(segred_tblock_sizze_75819)) && ((local_tid_85255 - squot32(local_tid_85255, wave_sizze_85257) * wave_sizze_85257) & (2 * offset_85272 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_85266 = ((volatile __local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255 + offset_85272)];\n            }\n            // apply reduction operation\n            {\n                bool x_85267 = eta_p_85265 && eta_p_85266;\n                \n                eta_p_85265 = x_85267;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_85265;\n            }\n        }\n        offset_85272 *= 2;\n    }\n    while (slt32(skip_waves_85273, squot32(sext_i64_i32(segred_tblock_sizze_75819) + wave_sizze_85257 - 1, wave_sizze_85257))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_85272 = skip_waves_85273 * wave_sizze_85257;\n        if (slt32(local_tid_85255 + offset_85272, sext_i64_i32(segred_tblock_sizz", "e_75819)) && ((local_tid_85255 - squot32(local_tid_85255, wave_sizze_85257) * wave_sizze_85257) == 0 && (squot32(local_tid_85255, wave_sizze_85257) & (2 * skip_waves_85273 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_85266 = ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255 + offset_85272)];\n            }\n            // apply reduction operation\n            {\n                bool x_85267 = eta_p_85265 && eta_p_85266;\n                \n                eta_p_85265 = x_85267;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_85265;\n            }\n        }\n        skip_waves_85273 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_85255) == (int64_t) 0) {\n            eta_p_block_res_acc_85264 = eta_p_85265;\n        } else {\n            eta_p_block_res_acc_85264 = 1;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_85255 == 0) {\n            ((__global bool *) segred_tmp_mem_85251)[sext_i32_i64(block_id_85256)] = eta_p_block_res_acc_85264;\n            mem_fence_global();\n            old_counter_85274 = atomic_add_i32_global(&((volatile __global int *) counters_mem_85249)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_85261)[(int64_t) 0] = old_counter_85274 == sext_i64_i32(num_tblocks_75821 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_85275 = ((__local bool *) sync_arr_mem_85261)[(int64_t) 0];\n    if (is_last_block_85275) {\n        if (local_tid_85255 == 0) {\n            old_counter_85274 = atomic_add_i32_global(&((volatile __global int *) counters_mem_85249)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_75821));\n        ",
                                    "}\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_85276 = sdiv_up64(num_tblocks_75821, segred_tblock_sizze_75819);\n            \n            eta_p_62792 = 1;\n            for (int64_t i_85277 = 0; i_85277 < read_per_thread_85276; i_85277++) {\n                int64_t block_res_id_85278 = sext_i32_i64(local_tid_85255) * read_per_thread_85276 + i_85277;\n                int64_t index_of_block_res_85279 = block_res_id_85278;\n                \n                if (slt64(block_res_id_85278, num_tblocks_75821)) {\n                    eta_p_62793 = ((__global bool *) segred_tmp_mem_85251)[index_of_block_res_85279];\n                    \n                    bool x_62794 = eta_p_62792 && eta_p_62793;\n                    \n                    eta_p_62792 = x_62794;\n                }\n            }\n        }\n        ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_62792;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_85280;\n            int32_t skip_waves_85281 = 1;\n            bool eta_p_85265;\n            bool eta_p_85266;\n            \n            offset_85280 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_85255, sext_i64_i32(segred_tblock_sizze_75819))) {\n                    eta_p_85265 = ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255 + offset_85280)];\n                }\n            }\n            offset_85280 = 1;\n            while (slt32(offset_85280, wave_sizze_85257)) {\n                if (slt32(local_tid_85255 + offset_85280, sext_i64_i32(segred_tblock_sizze_75819)) && ((local_tid_85255 - squot32(local_tid_85255, wave_sizze_85257) * wave_sizze_85257) & (2 * offset_85280 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_85266 = ((volatile __local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_", "tid_85255 + offset_85280)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_85267 = eta_p_85265 && eta_p_85266;\n                        \n                        eta_p_85265 = x_85267;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_85265;\n                    }\n                }\n                offset_85280 *= 2;\n            }\n            while (slt32(skip_waves_85281, squot32(sext_i64_i32(segred_tblock_sizze_75819) + wave_sizze_85257 - 1, wave_sizze_85257))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_85280 = skip_waves_85281 * wave_sizze_85257;\n                if (slt32(local_tid_85255 + offset_85280, sext_i64_i32(segred_tblock_sizze_75819)) && ((local_tid_85255 - squot32(local_tid_85255, wave_sizze_85257) * wave_sizze_85257) == 0 && (squot32(local_tid_85255, wave_sizze_85257) & (2 * skip_waves_85281 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_85266 = ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255 + offset_85280)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool x_85267 = eta_p_85265 && eta_p_85266;\n                        \n                        eta_p_85265 = x_85267;\n                    }\n                    // write result of operation\n                    {\n                        ((__local bool *) red_arr_bool_mem_85259)[sext_i32_i64(local_tid_85255)] = eta_p_85265;\n                    }\n                }\n                skip_waves_85281 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_85255 == 0) {\n                    ((__global bo", "ol *) mem_82164)[(int64_t) 0] = eta_p_85265;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_75819\n    #undef chunk_sizze_85248\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_nonseg_77741_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_nonseg_77741(__global int *global_failure, int64_t n_48679, int64_t num_tblocks_77736, int64_t num_threads_86751, __global unsigned char *mem_81972, __global unsigned char *mem_82899, __global unsigned char *counters_mem_86747, __global unsigned char *segred_tmp_mem_86749)\n{\n    #define segred_tblock_sizze_77734 (do_DBSCAN_doublezisegred_nonseg_77741zisegred_tblock_sizze_77734)\n    #define chunk_sizze_86746 (do_DBSCAN_doublezisegred_nonseg_77741zichunk_sizze_86746)\n    \n    volatile __local unsigned char *sync_arr_mem_86759_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_86759_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_86757_backing_0 = &shared_mem[sync_arr_mem_86759_backing_1_offset];\n    const int64_t red_arr_i64_mem_86757_backing_0_offset = sync_arr_mem_86759_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_77734 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77734, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86753;\n    int32_t tblock_sizze_86756;\n    int32_t wave_sizze_86755;\n    int32_t block_id_86754;\n    int32_t global_tid_86752;\n    int64_t phys_tid_77741;\n    __local unsigned char *red_arr_i64_mem_86757;\n    __local unsigned char *sync_arr_mem_86759;\n    int64_t dummy_77739;\n    int64_t gtid_77740;\n    int64_t q_86761;\n    int64_t eta_p_block_res_acc_86762;\n    int64_t eta_p_63638;\n    int64_t eta_p_63639;\n    int64_t tblock_id_in_segment_86766;\n    int64_t block_base_offset_86767;\n    int32_t offset_86770;\n    int32_t skip_waves_86771;\n    int64_t eta_p_86763;\n    int64_t eta_p_86764;\n    int32_t old_counter_86772;\n    bool is_last_block_86773",
                                    ";\n    \n    local_tid_86753 = get_local_id(0);\n    tblock_sizze_86756 = get_local_size(0);\n    wave_sizze_86755 = LOCKSTEP_WIDTH;\n    block_id_86754 = get_tblock_id(0);\n    global_tid_86752 = block_id_86754 * tblock_sizze_86756 + local_tid_86753;\n    phys_tid_77741 = sext_i32_i64(global_tid_86752);\n    red_arr_i64_mem_86757 = (__local unsigned char *) red_arr_i64_mem_86757_backing_0;\n    sync_arr_mem_86759 = (__local unsigned char *) sync_arr_mem_86759_backing_1;\n    dummy_77739 = (int64_t) 0;\n    gtid_77740 = (int64_t) 0;\n    q_86761 = sdiv_up64(n_48679, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_77734 * num_tblocks_77736)) * chunk_sizze_86746);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_86762 = (int64_t) -9223372036854775808;\n    }\n    tblock_id_in_segment_86766 = squot64(phys_tid_77741, segred_tblock_sizze_77734);\n    block_base_offset_86767 = tblock_id_in_segment_86766 * q_86761 * segred_tblock_sizze_77734;\n    for (int64_t i_86768 = 0; i_86768 < q_86761; i_86768++) {\n        int64_t block_offset_86769 = block_base_offset_86767 + i_86768 * segred_tblock_sizze_77734;\n        \n        gtid_77740 = phys_tid_77741 + num_threads_86751 * i_86768;\n        if (slt64(gtid_77740, n_48679)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_63637 = ((__global int64_t *) mem_81972)[gtid_77740];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_63638 = eta_p_block_res_acc_86762;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_63639 = x_63637;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t max_res_63640 = smax64(eta_p_63638, eta_p_63639);\n                        \n                        // store in accumulator(s)\n                ", "        {\n                            eta_p_block_res_acc_86762 = max_res_63640;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_block_res_acc_86762;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_86771 = 1;\n    offset_86770 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_86753, sext_i64_i32(segred_tblock_sizze_77734))) {\n            eta_p_86763 = ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86770)];\n        }\n    }\n    offset_86770 = 1;\n    while (slt32(offset_86770, wave_sizze_86755)) {\n        if (slt32(local_tid_86753 + offset_86770, sext_i64_i32(segred_tblock_sizze_77734)) && ((local_tid_86753 - squot32(local_tid_86753, wave_sizze_86755) * wave_sizze_86755) & (2 * offset_86770 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_86764 = ((volatile __local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86770)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_86765 = smax64(eta_p_86763, eta_p_86764);\n                \n                eta_p_86763 = max_res_86765;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_86763;\n            }\n        }\n        offset_86770 *= 2;\n    }\n    while (slt32(skip_waves_86771, squot32(sext_i64_i32(segred_tblock_sizze_77734) + wave_sizze_86755 - 1, wave_sizze_86755))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_86770 = skip_waves_86771 * wave_sizze_86755;\n        if (slt32(local_tid_86753 + offset_86770, sext_i64_i32(segred_tblock_sizze_77734)) && ((local_", "tid_86753 - squot32(local_tid_86753, wave_sizze_86755) * wave_sizze_86755) == 0 && (squot32(local_tid_86753, wave_sizze_86755) & (2 * skip_waves_86771 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_86764 = ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86770)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_86765 = smax64(eta_p_86763, eta_p_86764);\n                \n                eta_p_86763 = max_res_86765;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_86763;\n            }\n        }\n        skip_waves_86771 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_86753) == (int64_t) 0) {\n            eta_p_block_res_acc_86762 = eta_p_86763;\n        } else {\n            eta_p_block_res_acc_86762 = (int64_t) -9223372036854775808;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_86753 == 0) {\n            ((__global int64_t *) segred_tmp_mem_86749)[sext_i32_i64(block_id_86754)] = eta_p_block_res_acc_86762;\n            mem_fence_global();\n            old_counter_86772 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86747)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_86759)[(int64_t) 0] = old_counter_86772 == sext_i64_i32(num_tblocks_77736 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_86773 = ((__local bool *) sync_arr_mem_86759)[(int64_t) 0];\n    if (is_last_block_86773) {\n        if (local_tid_86753 == 0) {\n            old_counter_86772 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86747)[(int64_t) 0], (int) sext_i64_i32((int64_",
                                    "t) 0 - num_tblocks_77736));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_86774 = sdiv_up64(num_tblocks_77736, segred_tblock_sizze_77734);\n            \n            eta_p_63638 = (int64_t) -9223372036854775808;\n            for (int64_t i_86775 = 0; i_86775 < read_per_thread_86774; i_86775++) {\n                int64_t block_res_id_86776 = sext_i32_i64(local_tid_86753) * read_per_thread_86774 + i_86775;\n                int64_t index_of_block_res_86777 = block_res_id_86776;\n                \n                if (slt64(block_res_id_86776, num_tblocks_77736)) {\n                    eta_p_63639 = ((__global int64_t *) segred_tmp_mem_86749)[index_of_block_res_86777];\n                    \n                    int64_t max_res_63640 = smax64(eta_p_63638, eta_p_63639);\n                    \n                    eta_p_63638 = max_res_63640;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_63638;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_86778;\n            int32_t skip_waves_86779 = 1;\n            int64_t eta_p_86763;\n            int64_t eta_p_86764;\n            \n            offset_86778 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_86753, sext_i64_i32(segred_tblock_sizze_77734))) {\n                    eta_p_86763 = ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86778)];\n                }\n            }\n            offset_86778 = 1;\n            while (slt32(offset_86778, wave_sizze_86755)) {\n                if (slt32(local_tid_86753 + offset_86778, sext_i64_i32(segred_tblock_sizze_77734)) && ((local_tid_86753 - squot32(local_tid_86753, wave_sizze_86755) * wave_sizze_86755) & (2 * offset_86778 - 1)) == 0) {\n                    // read array element\n                    {\n         ", "               eta_p_86764 = ((volatile __local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86778)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_86765 = smax64(eta_p_86763, eta_p_86764);\n                        \n                        eta_p_86763 = max_res_86765;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_86763;\n                    }\n                }\n                offset_86778 *= 2;\n            }\n            while (slt32(skip_waves_86779, squot32(sext_i64_i32(segred_tblock_sizze_77734) + wave_sizze_86755 - 1, wave_sizze_86755))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_86778 = skip_waves_86779 * wave_sizze_86755;\n                if (slt32(local_tid_86753 + offset_86778, sext_i64_i32(segred_tblock_sizze_77734)) && ((local_tid_86753 - squot32(local_tid_86753, wave_sizze_86755) * wave_sizze_86755) == 0 && (squot32(local_tid_86753, wave_sizze_86755) & (2 * skip_waves_86779 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_86764 = ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753 + offset_86778)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_86765 = smax64(eta_p_86763, eta_p_86764);\n                        \n                        eta_p_86763 = max_res_86765;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_86757)[sext_i32_i64(local_tid_86753)] = eta_p_86763;\n                    }\n                }\n                skip_waves_86779 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE)", ";\n            // and back to memory with the final result\n            {\n                if (local_tid_86753 == 0) {\n                    ((__global int64_t *) mem_82899)[(int64_t) 0] = eta_p_86763;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_77734\n    #undef chunk_sizze_86746\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_nonseg_77751_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_nonseg_77751(__global int *global_failure, int64_t do_DBSCAN_res_63120, int64_t num_tblocks_77746, int64_t num_threads_86786, __global unsigned char *mem_82737, __global unsigned char *mem_82901, __global unsigned char *counters_mem_86782, __global unsigned char *segred_tmp_mem_86784)\n{\n    #define segred_tblock_sizze_77744 (do_DBSCAN_doublezisegred_nonseg_77751zisegred_tblock_sizze_77744)\n    #define chunk_sizze_86781 (do_DBSCAN_doublezisegred_nonseg_77751zichunk_sizze_86781)\n    \n    volatile __local unsigned char *sync_arr_mem_86794_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_86794_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_86792_backing_0 = &shared_mem[sync_arr_mem_86794_backing_1_offset];\n    const int64_t red_arr_i64_mem_86792_backing_0_offset = sync_arr_mem_86794_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_77744 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77744, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86788;\n    int32_t tblock_sizze_86791;\n    int32_t wave_sizze_86790;\n    int32_t block_id_86789;\n    int32_t global_tid_86787;\n    int64_t phys_tid_77751;\n    __local unsigned char *red_arr_i64_mem_86792;\n    __local unsigned char *sync_arr_mem_86794;\n    int64_t dummy_77749;\n    int64_t gtid_77750;\n    int64_t q_86796;\n    int64_t eta_p_block_res_acc_86797;\n    int64_t eta_p_63643;\n    int64_t eta_p_63644;\n    int64_t tblock_id_in_segment_86801;\n    int64_t block_base_offset_86802;\n ",
                                    "   int32_t offset_86805;\n    int32_t skip_waves_86806;\n    int64_t eta_p_86798;\n    int64_t eta_p_86799;\n    int32_t old_counter_86807;\n    bool is_last_block_86808;\n    \n    local_tid_86788 = get_local_id(0);\n    tblock_sizze_86791 = get_local_size(0);\n    wave_sizze_86790 = LOCKSTEP_WIDTH;\n    block_id_86789 = get_tblock_id(0);\n    global_tid_86787 = block_id_86789 * tblock_sizze_86791 + local_tid_86788;\n    phys_tid_77751 = sext_i32_i64(global_tid_86787);\n    red_arr_i64_mem_86792 = (__local unsigned char *) red_arr_i64_mem_86792_backing_0;\n    sync_arr_mem_86794 = (__local unsigned char *) sync_arr_mem_86794_backing_1;\n    dummy_77749 = (int64_t) 0;\n    gtid_77750 = (int64_t) 0;\n    q_86796 = sdiv_up64(do_DBSCAN_res_63120, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_77744 * num_tblocks_77746)) * chunk_sizze_86781);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_86797 = (int64_t) -9223372036854775808;\n    }\n    tblock_id_in_segment_86801 = squot64(phys_tid_77751, segred_tblock_sizze_77744);\n    block_base_offset_86802 = tblock_id_in_segment_86801 * q_86796 * segred_tblock_sizze_77744;\n    for (int64_t i_86803 = 0; i_86803 < q_86796; i_86803++) {\n        int64_t block_offset_86804 = block_base_offset_86802 + i_86803 * segred_tblock_sizze_77744;\n        \n        gtid_77750 = phys_tid_77751 + num_threads_86786 * i_86803;\n        if (slt64(gtid_77750, do_DBSCAN_res_63120)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_63642 = ((__global int64_t *) mem_82737)[gtid_77750];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_63643 = eta_p_block_res_acc_86797;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_63644 = x_63642;\n                    }\n                    // apply reduction operator(s)\n        ", "            {\n                        int64_t max_res_63645 = smax64(eta_p_63643, eta_p_63644);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_86797 = max_res_63645;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788)] = eta_p_block_res_acc_86797;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_86806 = 1;\n    offset_86805 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_86788, sext_i64_i32(segred_tblock_sizze_77744))) {\n            eta_p_86798 = ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86805)];\n        }\n    }\n    offset_86805 = 1;\n    while (slt32(offset_86805, wave_sizze_86790)) {\n        if (slt32(local_tid_86788 + offset_86805, sext_i64_i32(segred_tblock_sizze_77744)) && ((local_tid_86788 - squot32(local_tid_86788, wave_sizze_86790) * wave_sizze_86790) & (2 * offset_86805 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_86799 = ((volatile __local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86805)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_86800 = smax64(eta_p_86798, eta_p_86799);\n                \n                eta_p_86798 = max_res_86800;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788)] = eta_p_86798;\n            }\n        }\n        offset_86805 *= 2;\n    }\n    while (slt32(skip_waves_86806, squot32(sext_i64_i32(segred_tblock_sizze_77744) + wave_sizze_86790 - 1, wave_sizze_86790))) {\n        barr", "ier(CLK_LOCAL_MEM_FENCE);\n        offset_86805 = skip_waves_86806 * wave_sizze_86790;\n        if (slt32(local_tid_86788 + offset_86805, sext_i64_i32(segred_tblock_sizze_77744)) && ((local_tid_86788 - squot32(local_tid_86788, wave_sizze_86790) * wave_sizze_86790) == 0 && (squot32(local_tid_86788, wave_sizze_86790) & (2 * skip_waves_86806 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_86799 = ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86805)];\n            }\n            // apply reduction operation\n            {\n                int64_t max_res_86800 = smax64(eta_p_86798, eta_p_86799);\n                \n                eta_p_86798 = max_res_86800;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788)] = eta_p_86798;\n            }\n        }\n        skip_waves_86806 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_86788) == (int64_t) 0) {\n            eta_p_block_res_acc_86797 = eta_p_86798;\n        } else {\n            eta_p_block_res_acc_86797 = (int64_t) -9223372036854775808;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_86788 == 0) {\n            ((__global int64_t *) segred_tmp_mem_86784)[sext_i32_i64(block_id_86789)] = eta_p_block_res_acc_86797;\n            mem_fence_global();\n            old_counter_86807 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86782)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_86794)[(int64_t) 0] = old_counter_86807 == sext_i64_i32(num_tblocks_77746 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_86808 = ((__local bool *) sync_arr_mem_86794)[(int64_t) 0];\n    if (is_last_block",
                                    "_86808) {\n        if (local_tid_86788 == 0) {\n            old_counter_86807 = atomic_add_i32_global(&((volatile __global int *) counters_mem_86782)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_77746));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_86809 = sdiv_up64(num_tblocks_77746, segred_tblock_sizze_77744);\n            \n            eta_p_63643 = (int64_t) -9223372036854775808;\n            for (int64_t i_86810 = 0; i_86810 < read_per_thread_86809; i_86810++) {\n                int64_t block_res_id_86811 = sext_i32_i64(local_tid_86788) * read_per_thread_86809 + i_86810;\n                int64_t index_of_block_res_86812 = block_res_id_86811;\n                \n                if (slt64(block_res_id_86811, num_tblocks_77746)) {\n                    eta_p_63644 = ((__global int64_t *) segred_tmp_mem_86784)[index_of_block_res_86812];\n                    \n                    int64_t max_res_63645 = smax64(eta_p_63643, eta_p_63644);\n                    \n                    eta_p_63643 = max_res_63645;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788)] = eta_p_63643;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_86813;\n            int32_t skip_waves_86814 = 1;\n            int64_t eta_p_86798;\n            int64_t eta_p_86799;\n            \n            offset_86813 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_86788, sext_i64_i32(segred_tblock_sizze_77744))) {\n                    eta_p_86798 = ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86813)];\n                }\n            }\n            offset_86813 = 1;\n            while (slt32(offset_86813, wave_sizze_86790)) {\n                if (slt32(local_tid_86788 + offset_86813, sext_i64_i32(segred_tblock_sizze_77744)) && ((", "local_tid_86788 - squot32(local_tid_86788, wave_sizze_86790) * wave_sizze_86790) & (2 * offset_86813 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_86799 = ((volatile __local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86813)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_86800 = smax64(eta_p_86798, eta_p_86799);\n                        \n                        eta_p_86798 = max_res_86800;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788)] = eta_p_86798;\n                    }\n                }\n                offset_86813 *= 2;\n            }\n            while (slt32(skip_waves_86814, squot32(sext_i64_i32(segred_tblock_sizze_77744) + wave_sizze_86790 - 1, wave_sizze_86790))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_86813 = skip_waves_86814 * wave_sizze_86790;\n                if (slt32(local_tid_86788 + offset_86813, sext_i64_i32(segred_tblock_sizze_77744)) && ((local_tid_86788 - squot32(local_tid_86788, wave_sizze_86790) * wave_sizze_86790) == 0 && (squot32(local_tid_86788, wave_sizze_86790) & (2 * skip_waves_86814 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_86799 = ((__local int64_t *) red_arr_i64_mem_86792)[sext_i32_i64(local_tid_86788 + offset_86813)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t max_res_86800 = smax64(eta_p_86798, eta_p_86799);\n                        \n                        eta_p_86798 = max_res_86800;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_me", "m_86792)[sext_i32_i64(local_tid_86788)] = eta_p_86798;\n                    }\n                }\n                skip_waves_86814 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_86788 == 0) {\n                    ((__global int64_t *) mem_82901)[(int64_t) 0] = eta_p_86798;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_77744\n    #undef chunk_sizze_86781\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_small_75768_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_small_75768(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t inf_62706, int64_t j_m_i_62709, int64_t num_tblocks_75763, unsigned char x_81841_bits, int64_t segment_sizze_nonzzero_85176, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *mem_param_82092, __global unsigned char *mem_82095, __global unsigned char *mem_82097, __global unsigned char *mem_82099, __global unsigned char *mem_82102)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_75762 (do_DBSCAN_doublezisegred_small_75768zisegred_tblock_sizze_75762)\n    \n    volatile __local unsigned char *red_arr_i64_mem_85183_backing_0 = &shared_mem[0];\n    const int64_t red_arr_i64_mem_85183_backing_0_offset = 0 + ((int64_t) 8 * segred_tblock_sizze_75762 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_75762, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85179;\n    int32_t tblock_sizze_85182;\n    int32_t wave_sizze_85181;\n    int32_t block_id_85180;\n    int32_t global_tid_85178;\n    ",
                                    "int64_t phys_tid_75768;\n    __local unsigned char *red_arr_i64_mem_85183;\n    int32_t phys_tblock_id_85185;\n    int32_t iterations_85186;\n    \n    local_tid_85179 = get_local_id(0);\n    tblock_sizze_85182 = get_local_size(0);\n    wave_sizze_85181 = LOCKSTEP_WIDTH;\n    block_id_85180 = get_tblock_id(0);\n    global_tid_85178 = block_id_85180 * tblock_sizze_85182 + local_tid_85179;\n    phys_tid_75768 = sext_i32_i64(global_tid_85178);\n    red_arr_i64_mem_85183 = (__local unsigned char *) red_arr_i64_mem_85183_backing_0;\n    phys_tblock_id_85185 = get_tblock_id(0);\n    iterations_85186 = sdiv_up32(sext_i64_i32(sdiv_up64(j_m_i_62709, squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176))) - phys_tblock_id_85185, sext_i64_i32(num_tblocks_75763));\n    for (int32_t i_85187 = 0; i_85187 < iterations_85186; i_85187++) {\n        int32_t virt_tblock_id_85188;\n        int64_t slice_85189;\n        int64_t gtid_75766;\n        int64_t remnant_85190;\n        int64_t gtid_75767;\n        \n        virt_tblock_id_85188 = phys_tblock_id_85185 + i_85187 * sext_i64_i32(num_tblocks_75763);\n        slice_85189 = j_m_i_62709;\n        gtid_75766 = squot64(sext_i32_i64(local_tid_85179), segment_sizze_nonzzero_85176) + sext_i32_i64(virt_tblock_id_85188) * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176);\n        remnant_85190 = squot64(sext_i32_i64(local_tid_85179), segment_sizze_nonzzero_85176) + sext_i32_i64(virt_tblock_id_85188) * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176) - gtid_75766;\n        gtid_75767 = srem64(sext_i32_i64(local_tid_85179), conc_tmp_62382);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, conc_tmp_62382) && (slt64(gtid_75766, j_m_i_62709) && slt64(sext_i32_i64(local_tid_85179), conc_tmp_62382 * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176)))) {\n                // apply map function\n                {\n                    int64_t slice_78030 = inf_62706 + gtid_75766;\n   ", "                 bool index_concat_cmp_78021 = sle64(conc_tmp_62375, slice_78030);\n                    double index_concat_branch_78029;\n                    \n                    if (index_concat_cmp_78021) {\n                        int64_t index_concat_i_78022 = sub64(slice_78030, conc_tmp_62375);\n                        double index_concat_78023 = ((__global double *) ext_mem_82066)[index_concat_i_78022];\n                        \n                        index_concat_branch_78029 = index_concat_78023;\n                    } else {\n                        bool index_concat_cmp_78024 = sle64(m_62289, slice_78030);\n                        double index_concat_branch_78028;\n                        \n                        if (index_concat_cmp_78024) {\n                            int64_t index_concat_i_78025 = sub64(slice_78030, m_62289);\n                            double index_concat_78026 = ((__global double *) mem_82048)[index_concat_i_78025];\n                            \n                            index_concat_branch_78028 = index_concat_78026;\n                        } else {\n                            double index_concat_78027 = ((__global double *) mem_82081)[slice_78030];\n                            \n                            index_concat_branch_78028 = index_concat_78027;\n                        }\n                        index_concat_branch_78029 = index_concat_branch_78028;\n                    }\n                    \n                    double index_concat_branch_78017;\n                    \n                    if (index_concat_cmp_78021) {\n                        int64_t index_concat_i_78010 = sub64(slice_78030, conc_tmp_62375);\n                        double index_concat_78011 = ((__global double *) ext_mem_82065)[index_concat_i_78010];\n                        \n                        index_concat_branch_78017 = index_concat_78011;\n                    } else {\n                        bool index_concat_cmp_78012 = sle64(m_62289, slice_78030);\n                ", "        double index_concat_branch_78016;\n                        \n                        if (index_concat_cmp_78012) {\n                            int64_t index_concat_i_78013 = sub64(slice_78030, m_62289);\n                            double index_concat_78014 = ((__global double *) mem_82046)[index_concat_i_78013];\n                            \n                            index_concat_branch_78016 = index_concat_78014;\n                        } else {\n                            double index_concat_78015 = ((__global double *) mem_82079)[slice_78030];\n                            \n                            index_concat_branch_78016 = index_concat_78015;\n                        }\n                        index_concat_branch_78017 = index_concat_branch_78016;\n                    }\n                    \n                    bool index_concat_cmp_77997 = sle64(conc_tmp_62375, gtid_75767);\n                    double index_concat_branch_78005;\n                    \n                    if (index_concat_cmp_77997) {\n                        int64_t index_concat_i_77998 = sub64(gtid_75767, conc_tmp_62375);\n                        double index_concat_77999 = ((__global double *) ext_mem_82066)[index_concat_i_77998];\n                        \n                        index_concat_branch_78005 = index_concat_77999;\n                    } else {\n                        bool index_concat_cmp_78000 = sle64(m_62289, gtid_75767);\n                        double index_concat_branch_78004;\n                        \n                        if (index_concat_cmp_78000) {\n                            int64_t index_concat_i_78001 = sub64(gtid_75767, m_62289);\n                            double index_concat_78002 = ((__global double *) mem_82048)[index_concat_i_78001];\n                            \n                            index_concat_branch_78004 = index_concat_78002;\n                        } else {\n                            double index_concat_78003 = ((__global double *) mem_82081)[gtid_75",
                                    "767];\n                            \n                            index_concat_branch_78004 = index_concat_78003;\n                        }\n                        index_concat_branch_78005 = index_concat_branch_78004;\n                    }\n                    \n                    double index_concat_branch_77994;\n                    \n                    if (index_concat_cmp_77997) {\n                        int64_t index_concat_i_77987 = sub64(gtid_75767, conc_tmp_62375);\n                        double index_concat_77988 = ((__global double *) ext_mem_82065)[index_concat_i_77987];\n                        \n                        index_concat_branch_77994 = index_concat_77988;\n                    } else {\n                        bool index_concat_cmp_77989 = sle64(m_62289, gtid_75767);\n                        double index_concat_branch_77993;\n                        \n                        if (index_concat_cmp_77989) {\n                            int64_t index_concat_i_77990 = sub64(gtid_75767, m_62289);\n                            double index_concat_77991 = ((__global double *) mem_82046)[index_concat_i_77990];\n                            \n                            index_concat_branch_77993 = index_concat_77991;\n                        } else {\n                            double index_concat_77992 = ((__global double *) mem_82079)[gtid_75767];\n                            \n                            index_concat_branch_77993 = index_concat_77992;\n                        }\n                        index_concat_branch_77994 = index_concat_branch_77993;\n                    }\n                    \n                    double d_haversine_res_75775;\n                    \n                    if (x_81841) {\n                        double x_81843 = ((__global double *) mem_82095)[gtid_75766];\n                        \n                        d_haversine_res_75775 = x_81843;\n                    } else {\n                        d_haversine_res_75775 = 0.0;\n                    }\n  ", "                  \n                    double d_haversine_res_75776;\n                    \n                    if (x_81841) {\n                        double x_81845 = ((__global double *) mem_82097)[gtid_75766];\n                        \n                        d_haversine_res_75776 = x_81845;\n                    } else {\n                        d_haversine_res_75776 = 0.0;\n                    }\n                    \n                    double cos_res_75777;\n                    \n                    if (x_81841) {\n                        double x_81847 = ((__global double *) mem_82099)[gtid_75766];\n                        \n                        cos_res_75777 = x_81847;\n                    } else {\n                        cos_res_75777 = 0.0;\n                    }\n                    \n                    double dist_res_75781;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_75782 = index_concat_branch_78029 == index_concat_branch_78005;\n                        double d_euclidean_res_75783;\n                        \n                        if (zeze_res_75782) {\n                            double zm_res_75784 = index_concat_branch_78017 - index_concat_branch_77994;\n                            double abs_res_75785 = fabs64(zm_res_75784);\n                            \n                            d_euclidean_res_75783 = abs_res_75785;\n                        } else {\n                            bool zeze_res_75786 = index_concat_branch_78017 == index_concat_branch_77994;\n                            double d_euclidean_res_f_res_75787;\n                            \n                            if (zeze_res_75786) {\n                                double zm_res_75788 = index_concat_branch_78029 - index_concat_branch_78005;\n                                double abs_res_75789 = fabs64(zm_res_75788);\n                                \n                                d_euclidean_res_f_res_75787 = abs_res_75789;\n          ", "                  } else {\n                                double zm_res_75790 = index_concat_branch_78017 - index_concat_branch_77994;\n                                double zm_res_75791 = index_concat_branch_78029 - index_concat_branch_78005;\n                                double hypot_res_75792 = futrts_hypot64(zm_res_75791, zm_res_75790);\n                                \n                                d_euclidean_res_f_res_75787 = hypot_res_75792;\n                            }\n                            d_euclidean_res_75783 = d_euclidean_res_f_res_75787;\n                        }\n                        dist_res_75781 = d_euclidean_res_75783;\n                    } else {\n                        double d_haversine_res_75793;\n                        double d_haversine_res_75794;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_75793 = index_concat_branch_78005;\n                            d_haversine_res_75794 = index_concat_branch_77994;\n                        } else {\n                            double zt_res_75795 = 3.141592653589793 * index_concat_branch_78005;\n                            double zs_res_75796 = zt_res_75795 / 180.0;\n                            double zt_res_75797 = 3.141592653589793 * index_concat_branch_77994;\n                            double zs_res_75798 = zt_res_75797 / 180.0;\n                            \n                            d_haversine_res_75793 = zs_res_75796;\n                            d_haversine_res_75794 = zs_res_75798;\n                        }\n                        \n                        double zm_res_75799 = d_haversine_res_75775 - d_haversine_res_75793;\n                        double cos_res_75800 = futrts_cos64(zm_res_75799);\n                        double zm_res_75801 = 1.0 - cos_res_75800;\n                        double cos_res_75802 = futrts_cos64(d_haversine_res_75793);\n                        double zt_res_75803 = cos_res_75777 *",
                                    " cos_res_75802;\n                        double zm_res_75804 = d_haversine_res_75776 - d_haversine_res_75794;\n                        double zm_res_75805 = 1.0 - zm_res_75804;\n                        double zt_res_75806 = zt_res_75803 * zm_res_75805;\n                        double zp_res_75807 = zm_res_75801 + zt_res_75806;\n                        double zs_res_75808 = zp_res_75807 / 2.0;\n                        double min_res_75809 = fmin64(1.0, zs_res_75808);\n                        double zt_res_75810 = 2.0 * min_res_75809;\n                        double zm_res_75811 = 1.0 - zt_res_75810;\n                        double acos_res_75812 = futrts_acos64(zm_res_75811);\n                        double zt_res_75813 = clBase_48698 * acos_res_75812;\n                        \n                        dist_res_75781 = zt_res_75813;\n                    }\n                    \n                    bool zlze_res_75814 = dist_res_75781 <= clBase_48692;\n                    int64_t lifted_lambda_res_75815;\n                    \n                    if (zlze_res_75814) {\n                        int64_t eta_p_75780 = ((__global int64_t *) mem_param_82092)[gtid_75767];\n                        \n                        lifted_lambda_res_75815 = eta_p_75780;\n                    } else {\n                        int64_t eta_p_75772 = ((__global int64_t *) mem_param_82092)[slice_78030];\n                        \n                        lifted_lambda_res_75815 = eta_p_75772;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = lifted_lambda_res_75815;\n                    }\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = (int64_t) 9223372036854775807;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, conc_tmp_62382)) {\n            // p", "erform segmented scan to imitate reduction\n            {\n                int64_t eta_p_75769;\n                int64_t eta_p_75770;\n                int64_t eta_p_85191;\n                int64_t eta_p_85192;\n                bool ltid_in_bounds_85194 = slt64(sext_i32_i64(local_tid_85179), conc_tmp_62382 * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176));\n                int32_t skip_threads_85195;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_85194) {\n                        eta_p_75770 = ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)];\n                        if ((local_tid_85179 - squot32(local_tid_85179, 32) * 32) == 0) {\n                            eta_p_75769 = eta_p_75770;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_85195 = 1;\n                    while (slt32(skip_threads_85195, 32)) {\n                        bool thread_active_85196 = sle32(skip_threads_85195, local_tid_85179 - squot32(local_tid_85179, 32) * 32) && ltid_in_bounds_85194;\n                        \n                        if (thread_active_85196) {\n                            // read operands\n                            {\n                                eta_p_75769 = ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179) - sext_i32_i64(skip_threads_85195)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_85197 = slt64(srem64(sext_i32_i64(local_tid_85179), conc_tmp_62382), sext_i32_i64(local_tid_85179) - sext_i32_i64(local_tid_85179 - skip_threads_85195));\n                            \n                            if (thread_active_85196 && inactive_85197) {\n                                eta_p_", "75769 = eta_p_75770;\n                            }\n                            if (thread_active_85196) {\n                                if (!inactive_85197) {\n                                    int64_t min_res_75771 = smin64(eta_p_75769, eta_p_75770);\n                                    \n                                    eta_p_75769 = min_res_75771;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_85181, skip_threads_85195)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_85196) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = eta_p_75769;\n                                eta_p_75770 = eta_p_75769;\n                            }\n                        }\n                        if (sle32(wave_sizze_85181, skip_threads_85195)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_85195 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_85179 - squot32(local_tid_85179, 32) * 32) == 31 && ltid_in_bounds_85194) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(squot32(local_tid_85179, 32))] = eta_p_75769;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_85198;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_t",
                                    "id_85179, 32) == 0 && ltid_in_bounds_85194) {\n                            eta_p_85192 = ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)];\n                            if ((local_tid_85179 - squot32(local_tid_85179, 32) * 32) == 0) {\n                                eta_p_85191 = eta_p_85192;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_85198 = 1;\n                        while (slt32(skip_threads_85198, 32)) {\n                            bool thread_active_85199 = sle32(skip_threads_85198, local_tid_85179 - squot32(local_tid_85179, 32) * 32) && (squot32(local_tid_85179, 32) == 0 && ltid_in_bounds_85194);\n                            \n                            if (thread_active_85199) {\n                                // read operands\n                                {\n                                    eta_p_85191 = ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179) - sext_i32_i64(skip_threads_85198)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_85200 = slt64(srem64(sext_i32_i64(local_tid_85179 * 32 + 32 - 1), conc_tmp_62382), sext_i32_i64(local_tid_85179 * 32 + 32 - 1) - sext_i32_i64((local_tid_85179 - skip_threads_85198) * 32 + 32 - 1));\n                                \n                                if (thread_active_85199 && inactive_85200) {\n                                    eta_p_85191 = eta_p_85192;\n                                }\n                                if (thread_active_85199) {\n                                    if (!inactive_85200) {\n                                        int64_t min_res_85193 = smin64(eta_p_85191, eta_p_85192);\n                                        \n        ", "                                eta_p_85191 = min_res_85193;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_85181, skip_threads_85198)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_85199) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = eta_p_85191;\n                                    eta_p_85192 = eta_p_85191;\n                                }\n                            }\n                            if (sle32(wave_sizze_85181, skip_threads_85198)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_85198 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_85201 = squot32(local_tid_85179, 32) == 0 || !ltid_in_bounds_85194;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_85201) {\n                            eta_p_75770 = eta_p_75769;\n                            eta_p_75769 = ((__local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(squot32(local_tid_85179, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_85202 = slt64(srem64(sext_i32_i64(local_tid_85179), conc_tmp_62382), sext_i32_i64(local_tid_85179) - sext_i32_i64(squot32(local_tid_85179, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_85201) {\n                            i", "f (inactive_85202) {\n                                eta_p_75769 = eta_p_75770;\n                            }\n                        }\n                        if (!no_carry_in_85201) {\n                            if (!inactive_85202) {\n                                int64_t min_res_75771 = smin64(eta_p_75769, eta_p_75770);\n                                \n                                eta_p_75769 = min_res_75771;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_85201) {\n                            ((__local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = eta_p_75769;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_85179, 32) == 0 && ltid_in_bounds_85194) {\n                        ((__local int64_t *) red_arr_i64_mem_85183)[sext_i32_i64(local_tid_85179)] = eta_p_75770;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_85188) * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176) + sext_i32_i64(local_tid_85179), j_m_i_62709) && slt64(sext_i32_i64(local_tid_85179), squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176))) {\n                int64_t tmp_85203 = ((__local int64_t *) red_arr_i64_mem_85183)[(sext_i32_i64(local_tid_85179) + (int64_t) 1) * segment_sizze_nonzzero_85176 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_82102)[sext_i32_i64(virt_tblock_id_85188) * squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176) + sext_i32_i64(local_tid_85179)] = tmp_85203;\n            }\n   ",
                                    "     }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_75762\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_small_77359_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_small_77359(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_63400, int64_t inf_63450, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, int64_t num_tblocks_77353, unsigned char x_81841_bits, int64_t segment_sizze_nonzzero_86489, __global unsigned char *ext_mem_82716, __global unsigned char *ext_mem_82717, __global unsigned char *mem_82730, __global unsigned char *mem_82732, __global unsigned char *mem_82734, __global unsigned char *mem_82737, __global unsigned char *mem_82743, __global unsigned char *mem_82745, __global unsigned char *mem_82747, __global unsigned char *mem_82752)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_77352 (do_DBSCAN_doublezisegred_small_77359zisegred_tblock_sizze_77352)\n    \n    volatile __local unsigned char *red_arr_f64_mem_86498_backing_1 = &shared_mem[0];\n    const int64_t red_arr_f64_mem_86498_backing_1_offset = 0 + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_86496_backing_0 = &shared_mem[red_arr_f64_mem_86498_backing_1_offset];\n    const int64_t red_arr_i64_mem_86496_backing_0_offset = red_arr_f64_mem_86498_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86492;\n    int32_t tblock_sizze_86495;\n    int32_t wave_sizze_86494;\n    int32_t block_id_86493;\n    int32_t global_tid_86491;\n    int64_t phys_tid_77359;\n    __local unsigned ch", "ar *red_arr_i64_mem_86496;\n    __local unsigned char *red_arr_f64_mem_86498;\n    int32_t phys_tblock_id_86500;\n    int32_t iterations_86501;\n    \n    local_tid_86492 = get_local_id(0);\n    tblock_sizze_86495 = get_local_size(0);\n    wave_sizze_86494 = LOCKSTEP_WIDTH;\n    block_id_86493 = get_tblock_id(0);\n    global_tid_86491 = block_id_86493 * tblock_sizze_86495 + local_tid_86492;\n    phys_tid_77359 = sext_i32_i64(global_tid_86491);\n    red_arr_i64_mem_86496 = (__local unsigned char *) red_arr_i64_mem_86496_backing_0;\n    red_arr_f64_mem_86498 = (__local unsigned char *) red_arr_f64_mem_86498_backing_1;\n    phys_tblock_id_86500 = get_tblock_id(0);\n    iterations_86501 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489))) - phys_tblock_id_86500, sext_i64_i32(num_tblocks_77353));\n    for (int32_t i_86502 = 0; i_86502 < iterations_86501; i_86502++) {\n        int32_t virt_tblock_id_86503;\n        int64_t slice_86504;\n        int64_t gtid_77357;\n        int64_t remnant_86505;\n        int64_t gtid_77358;\n        \n        virt_tblock_id_86503 = phys_tblock_id_86500 + i_86502 * sext_i64_i32(num_tblocks_77353);\n        slice_86504 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;\n        gtid_77357 = squot64(sext_i32_i64(local_tid_86492), segment_sizze_nonzzero_86489) + sext_i32_i64(virt_tblock_id_86503) * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489);\n        remnant_86505 = squot64(sext_i32_i64(local_tid_86492), segment_sizze_nonzzero_86489) + sext_i32_i64(virt_tblock_id_86503) * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489) - gtid_77357;\n        gtid_77358 = srem64(sext_i32_i64(local_tid_86492), m_63400);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, m_63400) && (slt64(gtid_77357, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453) && slt64(sext_i32_i64(local_tid_86492), m_63400 * squot64(segred_tblock_sizze_77352, segment", "_sizze_nonzzero_86489)))) {\n                // apply map function\n                {\n                    int64_t slice_77761 = inf_63450 + gtid_77357;\n                    double eta_p_77377 = ((__global double *) mem_82732)[gtid_77358];\n                    double eta_p_77378 = ((__global double *) mem_82730)[gtid_77358];\n                    int64_t x_77379 = ((__global int64_t *) mem_82734)[gtid_77358];\n                    double d_haversine_res_77374;\n                    \n                    if (x_81841) {\n                        double x_81825 = ((__global double *) mem_82743)[gtid_77357];\n                        \n                        d_haversine_res_77374 = x_81825;\n                    } else {\n                        d_haversine_res_77374 = 0.0;\n                    }\n                    \n                    double d_haversine_res_77375;\n                    \n                    if (x_81841) {\n                        double x_81827 = ((__global double *) mem_82745)[gtid_77357];\n                        \n                        d_haversine_res_77375 = x_81827;\n                    } else {\n                        d_haversine_res_77375 = 0.0;\n                    }\n                    \n                    double cos_res_77376;\n                    \n                    if (x_81841) {\n                        double x_81829 = ((__global double *) mem_82747)[gtid_77357];\n                        \n                        cos_res_77376 = x_81829;\n                    } else {\n                        cos_res_77376 = 0.0;\n                    }\n                    \n                    double dist_res_77380;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double eta_p_77372 = ((__global double *) ext_mem_82717)[slice_77761];\n                        double eta_p_77373 = ((__global double *) ext_mem_82716)[slice_77761];\n                        bool zeze_res_77381 = eta_p_77372 == eta_p_77377;\n                        double d_euclid",
                                    "ean_res_77382;\n                        \n                        if (zeze_res_77381) {\n                            double zm_res_77383 = eta_p_77373 - eta_p_77378;\n                            double abs_res_77384 = fabs64(zm_res_77383);\n                            \n                            d_euclidean_res_77382 = abs_res_77384;\n                        } else {\n                            bool zeze_res_77385 = eta_p_77373 == eta_p_77378;\n                            double d_euclidean_res_f_res_77386;\n                            \n                            if (zeze_res_77385) {\n                                double zm_res_77387 = eta_p_77372 - eta_p_77377;\n                                double abs_res_77388 = fabs64(zm_res_77387);\n                                \n                                d_euclidean_res_f_res_77386 = abs_res_77388;\n                            } else {\n                                double zm_res_77389 = eta_p_77373 - eta_p_77378;\n                                double zm_res_77390 = eta_p_77372 - eta_p_77377;\n                                double hypot_res_77391 = futrts_hypot64(zm_res_77390, zm_res_77389);\n                                \n                                d_euclidean_res_f_res_77386 = hypot_res_77391;\n                            }\n                            d_euclidean_res_77382 = d_euclidean_res_f_res_77386;\n                        }\n                        dist_res_77380 = d_euclidean_res_77382;\n                    } else {\n                        double d_haversine_res_77392;\n                        double d_haversine_res_77393;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_77392 = eta_p_77377;\n                            d_haversine_res_77393 = eta_p_77378;\n                        } else {\n                            double zt_res_77394 = 3.141592653589793 * eta_p_77377;\n                            double zs_res_77395 = zt_res_77394 / 18", "0.0;\n                            double zt_res_77396 = 3.141592653589793 * eta_p_77378;\n                            double zs_res_77397 = zt_res_77396 / 180.0;\n                            \n                            d_haversine_res_77392 = zs_res_77395;\n                            d_haversine_res_77393 = zs_res_77397;\n                        }\n                        \n                        double zm_res_77398 = d_haversine_res_77374 - d_haversine_res_77392;\n                        double cos_res_77399 = futrts_cos64(zm_res_77398);\n                        double zm_res_77400 = 1.0 - cos_res_77399;\n                        double cos_res_77401 = futrts_cos64(d_haversine_res_77392);\n                        double zt_res_77402 = cos_res_77376 * cos_res_77401;\n                        double zm_res_77403 = d_haversine_res_77375 - d_haversine_res_77393;\n                        double zm_res_77404 = 1.0 - zm_res_77403;\n                        double zt_res_77405 = zt_res_77402 * zm_res_77404;\n                        double zp_res_77406 = zm_res_77400 + zt_res_77405;\n                        double zs_res_77407 = zp_res_77406 / 2.0;\n                        double min_res_77408 = fmin64(1.0, zs_res_77407);\n                        double zt_res_77409 = 2.0 * min_res_77408;\n                        double zm_res_77410 = 1.0 - zt_res_77409;\n                        double acos_res_77411 = futrts_acos64(zm_res_77410);\n                        double zt_res_77412 = clBase_48698 * acos_res_77411;\n                        \n                        dist_res_77380 = zt_res_77412;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)] = x_77379;\n                        ((__local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = dist_res_77380;\n                    }\n                }\n            } else {\n                ((__local int64_t *", ") red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)] = (int64_t) -1;\n                ((__local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = INFINITY;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, m_63400)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_77360;\n                double eta_p_77361;\n                int64_t eta_p_77362;\n                double eta_p_77363;\n                int64_t eta_p_86506;\n                double eta_p_86507;\n                int64_t eta_p_86508;\n                double eta_p_86509;\n                bool ltid_in_bounds_86518 = slt64(sext_i32_i64(local_tid_86492), m_63400 * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489));\n                int32_t skip_threads_86519;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_86518) {\n                        eta_p_77362 = ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)];\n                        eta_p_77363 = ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)];\n                        if ((local_tid_86492 - squot32(local_tid_86492, 32) * 32) == 0) {\n                            eta_p_77360 = eta_p_77362;\n                            eta_p_77361 = eta_p_77363;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_86519 = 1;\n                    while (slt32(skip_threads_86519, 32)) {\n                        bool thread_active_86520 = sle32(skip_threads_86519, local_tid_86492 - squot32(local_tid_86492, 32) * 32) && ltid_in_bounds_86518;\n                        \n                        if (thread_active_86520) {\n                            // read operands\n                            {\n                    ",
                                    "            eta_p_77360 = ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492) - sext_i32_i64(skip_threads_86519)];\n                                eta_p_77361 = ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492) - sext_i32_i64(skip_threads_86519)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_86521 = slt64(srem64(sext_i32_i64(local_tid_86492), m_63400), sext_i32_i64(local_tid_86492) - sext_i32_i64(local_tid_86492 - skip_threads_86519));\n                            \n                            if (thread_active_86520 && inactive_86521) {\n                                eta_p_77360 = eta_p_77362;\n                                eta_p_77361 = eta_p_77363;\n                            }\n                            if (thread_active_86520) {\n                                if (!inactive_86521) {\n                                    bool zg_res_77364 = clBase_48692 < eta_p_77361;\n                                    bool zg_res_77365 = clBase_48692 < eta_p_77363;\n                                    bool x_77366 = zg_res_77364 && zg_res_77365;\n                                    int64_t lifted_lambda_res_77367;\n                                    double lifted_lambda_res_77368;\n                                    \n                                    if (x_77366) {\n                                        lifted_lambda_res_77367 = (int64_t) -1;\n                                        lifted_lambda_res_77368 = INFINITY;\n                                    } else {\n                                        bool zl_res_77369 = eta_p_77361 < eta_p_77363;\n                                        int64_t lifted_lambda_res_f_res_77370;\n                                        \n                                        if (zl_res_77369) {\n                                            lifted_lambda_res_f_res_773", "70 = eta_p_77360;\n                                        } else {\n                                            lifted_lambda_res_f_res_77370 = eta_p_77362;\n                                        }\n                                        \n                                        double lifted_lambda_res_f_res_77371;\n                                        \n                                        if (zl_res_77369) {\n                                            lifted_lambda_res_f_res_77371 = eta_p_77361;\n                                        } else {\n                                            lifted_lambda_res_f_res_77371 = eta_p_77363;\n                                        }\n                                        lifted_lambda_res_77367 = lifted_lambda_res_f_res_77370;\n                                        lifted_lambda_res_77368 = lifted_lambda_res_f_res_77371;\n                                    }\n                                    eta_p_77360 = lifted_lambda_res_77367;\n                                    eta_p_77361 = lifted_lambda_res_77368;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_86494, skip_threads_86519)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_86520) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)] = eta_p_77360;\n                                eta_p_77362 = eta_p_77360;\n                                ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = eta_p_77361;\n                                eta_p_77363 = eta_p_77361;\n                            }\n                        }\n                        if (sle32(wave_sizze_86494, skip_threads_86519)) {\n                            barrier(CLK_LOCAL_M", "EM_FENCE);\n                        }\n                        skip_threads_86519 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_86492 - squot32(local_tid_86492, 32) * 32) == 31 && ltid_in_bounds_86518) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(squot32(local_tid_86492, 32))] = eta_p_77360;\n                        ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(squot32(local_tid_86492, 32))] = eta_p_77361;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_86522;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_86492, 32) == 0 && ltid_in_bounds_86518) {\n                            eta_p_86508 = ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)];\n                            eta_p_86509 = ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)];\n                            if ((local_tid_86492 - squot32(local_tid_86492, 32) * 32) == 0) {\n                                eta_p_86506 = eta_p_86508;\n                                eta_p_86507 = eta_p_86509;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_86522 = 1;\n                        while (slt32(skip_threads_86522, 32)) {\n                            bool thread_active_86523 = sle32(skip_threads_86522, local_tid_86492 - squot32(local_tid_86492, 32) * 32) && (squot32(local_tid_86492, 32) == 0 &",
                                    "& ltid_in_bounds_86518);\n                            \n                            if (thread_active_86523) {\n                                // read operands\n                                {\n                                    eta_p_86506 = ((volatile __local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492) - sext_i32_i64(skip_threads_86522)];\n                                    eta_p_86507 = ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492) - sext_i32_i64(skip_threads_86522)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_86524 = slt64(srem64(sext_i32_i64(local_tid_86492 * 32 + 32 - 1), m_63400), sext_i32_i64(local_tid_86492 * 32 + 32 - 1) - sext_i32_i64((local_tid_86492 - skip_threads_86522) * 32 + 32 - 1));\n                                \n                                if (thread_active_86523 && inactive_86524) {\n                                    eta_p_86506 = eta_p_86508;\n                                    eta_p_86507 = eta_p_86509;\n                                }\n                                if (thread_active_86523) {\n                                    if (!inactive_86524) {\n                                        bool zg_res_86510 = clBase_48692 < eta_p_86507;\n                                        bool zg_res_86511 = clBase_48692 < eta_p_86509;\n                                        bool x_86512 = zg_res_86510 && zg_res_86511;\n                                        int64_t lifted_lambda_res_86513;\n                                        double lifted_lambda_res_86514;\n                                        \n                                        if (x_86512) {\n                                            lifted_lambda_res_86513 = (int64_t) -1;\n                                            lifted_lambda_res_86514 = INFINITY;\n                                   ", "     } else {\n                                            bool zl_res_86515 = eta_p_86507 < eta_p_86509;\n                                            int64_t lifted_lambda_res_f_res_86516;\n                                            \n                                            if (zl_res_86515) {\n                                                lifted_lambda_res_f_res_86516 = eta_p_86506;\n                                            } else {\n                                                lifted_lambda_res_f_res_86516 = eta_p_86508;\n                                            }\n                                            \n                                            double lifted_lambda_res_f_res_86517;\n                                            \n                                            if (zl_res_86515) {\n                                                lifted_lambda_res_f_res_86517 = eta_p_86507;\n                                            } else {\n                                                lifted_lambda_res_f_res_86517 = eta_p_86509;\n                                            }\n                                            lifted_lambda_res_86513 = lifted_lambda_res_f_res_86516;\n                                            lifted_lambda_res_86514 = lifted_lambda_res_f_res_86517;\n                                        }\n                                        eta_p_86506 = lifted_lambda_res_86513;\n                                        eta_p_86507 = lifted_lambda_res_86514;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_86494, skip_threads_86522)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_86523) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_864", "96)[sext_i32_i64(local_tid_86492)] = eta_p_86506;\n                                    eta_p_86508 = eta_p_86506;\n                                    ((volatile __local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = eta_p_86507;\n                                    eta_p_86509 = eta_p_86507;\n                                }\n                            }\n                            if (sle32(wave_sizze_86494, skip_threads_86522)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_86522 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_86525 = squot32(local_tid_86492, 32) == 0 || !ltid_in_bounds_86518;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_86525) {\n                            eta_p_77362 = eta_p_77360;\n                            eta_p_77363 = eta_p_77361;\n                            eta_p_77360 = ((__local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(squot32(local_tid_86492, 32)) - (int64_t) 1];\n                            eta_p_77361 = ((__local double *) red_arr_f64_mem_86498)[sext_i32_i64(squot32(local_tid_86492, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_86526 = slt64(srem64(sext_i32_i64(local_tid_86492), m_63400), sext_i32_i64(local_tid_86492) - sext_i32_i64(squot32(local_tid_86492, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_86525) {\n                            if (inactive_86526) {\n                                eta_p_77360 = eta_p_77362;\n                                eta_p_77361 = eta_p_77363;\n                            ",
                                    "}\n                        }\n                        if (!no_carry_in_86525) {\n                            if (!inactive_86526) {\n                                bool zg_res_77364 = clBase_48692 < eta_p_77361;\n                                bool zg_res_77365 = clBase_48692 < eta_p_77363;\n                                bool x_77366 = zg_res_77364 && zg_res_77365;\n                                int64_t lifted_lambda_res_77367;\n                                double lifted_lambda_res_77368;\n                                \n                                if (x_77366) {\n                                    lifted_lambda_res_77367 = (int64_t) -1;\n                                    lifted_lambda_res_77368 = INFINITY;\n                                } else {\n                                    bool zl_res_77369 = eta_p_77361 < eta_p_77363;\n                                    int64_t lifted_lambda_res_f_res_77370;\n                                    \n                                    if (zl_res_77369) {\n                                        lifted_lambda_res_f_res_77370 = eta_p_77360;\n                                    } else {\n                                        lifted_lambda_res_f_res_77370 = eta_p_77362;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_77371;\n                                    \n                                    if (zl_res_77369) {\n                                        lifted_lambda_res_f_res_77371 = eta_p_77361;\n                                    } else {\n                                        lifted_lambda_res_f_res_77371 = eta_p_77363;\n                                    }\n                                    lifted_lambda_res_77367 = lifted_lambda_res_f_res_77370;\n                                    lifted_lambda_res_77368 = lifted_lambda_res_f_res_77371;\n                                }\n                                eta_p_77360 = lifted_la", "mbda_res_77367;\n                                eta_p_77361 = lifted_lambda_res_77368;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_86525) {\n                            ((__local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)] = eta_p_77360;\n                            ((__local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = eta_p_77361;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_86492, 32) == 0 && ltid_in_bounds_86518) {\n                        ((__local int64_t *) red_arr_i64_mem_86496)[sext_i32_i64(local_tid_86492)] = eta_p_77362;\n                        ((__local double *) red_arr_f64_mem_86498)[sext_i32_i64(local_tid_86492)] = eta_p_77363;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_86503) * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489) + sext_i32_i64(local_tid_86492), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453) && slt64(sext_i32_i64(local_tid_86492), squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489))) {\n                int64_t tmp_86527 = ((__local int64_t *) red_arr_i64_mem_86496)[(sext_i32_i64(local_tid_86492) + (int64_t) 1) * segment_sizze_nonzzero_86489 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_82737)[inf_63450 + (sext_i32_i64(virt_tblock_id_86503) * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489) + sext_i32_i64(local_tid_86492))] = tmp_86527;\n                \n                double tmp_86528 = ((__local double *) red_arr", "_f64_mem_86498)[(sext_i32_i64(local_tid_86492) + (int64_t) 1) * segment_sizze_nonzzero_86489 - (int64_t) 1];\n                \n                ((__global double *) mem_82752)[sext_i32_i64(virt_tblock_id_86503) * squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489) + sext_i32_i64(local_tid_86492)] = tmp_86528;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_77352\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_small_77661_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_small_77661(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t conc_tmp_62379, int64_t inf_63544, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, int64_t num_tblocks_77655, unsigned char x_81841_bits, int64_t segment_sizze_nonzzero_86620, __global unsigned char *current_partition_mem_81940, __global unsigned char *current_partition_mem_81941, __global unsigned char *mem_81972, __global unsigned char *mem_82724, __global unsigned char *mem_82726, __global unsigned char *mem_82728, __global unsigned char *mem_82822, __global unsigned char *mem_82824, __global unsigned char *mem_82826, __global unsigned char *mem_82831)\n{\n    bool x_81841 = x_81841_bits;\n    \n    #define segred_tblock_sizze_77654 (do_DBSCAN_doublezisegred_small_77661zisegred_tblock_sizze_77654)\n    \n    volatile __local unsigned char *red_arr_f64_mem_86629_backing_1 = &shared_mem[0];\n    const int64_t red_arr_f64_mem_86629_backing_1_offset = 0 + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_86627_backing_0 = &shared_mem[red_arr_f64_mem_86629_backing_1_offset];\n    const int64_t red_arr_i64_mem_86627_backing_0_offset = red_arr_f64_mem_86629_backing_1_offset + ((int64_t) 8 * segred_t",
                                    "block_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86623;\n    int32_t tblock_sizze_86626;\n    int32_t wave_sizze_86625;\n    int32_t block_id_86624;\n    int32_t global_tid_86622;\n    int64_t phys_tid_77661;\n    __local unsigned char *red_arr_i64_mem_86627;\n    __local unsigned char *red_arr_f64_mem_86629;\n    int32_t phys_tblock_id_86631;\n    int32_t iterations_86632;\n    \n    local_tid_86623 = get_local_id(0);\n    tblock_sizze_86626 = get_local_size(0);\n    wave_sizze_86625 = LOCKSTEP_WIDTH;\n    block_id_86624 = get_tblock_id(0);\n    global_tid_86622 = block_id_86624 * tblock_sizze_86626 + local_tid_86623;\n    phys_tid_77661 = sext_i32_i64(global_tid_86622);\n    red_arr_i64_mem_86627 = (__local unsigned char *) red_arr_i64_mem_86627_backing_0;\n    red_arr_f64_mem_86629 = (__local unsigned char *) red_arr_f64_mem_86629_backing_1;\n    phys_tblock_id_86631 = get_tblock_id(0);\n    iterations_86632 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620))) - phys_tblock_id_86631, sext_i64_i32(num_tblocks_77655));\n    for (int32_t i_86633 = 0; i_86633 < iterations_86632; i_86633++) {\n        int32_t virt_tblock_id_86634;\n        int64_t slice_86635;\n        int64_t gtid_77659;\n        int64_t remnant_86636;\n        int64_t gtid_77660;\n        \n        virt_tblock_id_86634 = phys_tblock_id_86631 + i_86633 * sext_i64_i32(num_tblocks_77655);\n        slice_86635 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;\n        gtid_77659 = squot64(sext_i32_i64(local_tid_86623), segment_sizze_nonzzero_86620) + sext_i32_i64(virt_tblock_id_86634) * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620);\n        remnant_86636 = squot64(sext_i32_i64(local_tid_86623), segment_sizze_nonzzero_86620) + sext_i32_i64(virt_tblock_id_86634) * squot64(segred_tblock_sizz", "e_77654, segment_sizze_nonzzero_86620) - gtid_77659;\n        gtid_77660 = srem64(sext_i32_i64(local_tid_86623), conc_tmp_62379);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, conc_tmp_62379) && (slt64(gtid_77659, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547) && slt64(sext_i32_i64(local_tid_86623), conc_tmp_62379 * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620)))) {\n                // apply map function\n                {\n                    int64_t slice_77755 = inf_63544 + gtid_77659;\n                    double eta_p_77679 = ((__global double *) mem_82726)[gtid_77660];\n                    double eta_p_77680 = ((__global double *) mem_82728)[gtid_77660];\n                    int64_t x_77681 = ((__global int64_t *) mem_82724)[gtid_77660];\n                    double d_haversine_res_77676;\n                    \n                    if (x_81841) {\n                        double x_81816 = ((__global double *) mem_82822)[gtid_77659];\n                        \n                        d_haversine_res_77676 = x_81816;\n                    } else {\n                        d_haversine_res_77676 = 0.0;\n                    }\n                    \n                    double d_haversine_res_77677;\n                    \n                    if (x_81841) {\n                        double x_81818 = ((__global double *) mem_82824)[gtid_77659];\n                        \n                        d_haversine_res_77677 = x_81818;\n                    } else {\n                        d_haversine_res_77677 = 0.0;\n                    }\n                    \n                    double cos_res_77678;\n                    \n                    if (x_81841) {\n                        double x_81820 = ((__global double *) mem_82826)[gtid_77659];\n                        \n                        cos_res_77678 = x_81820;\n                    } else {\n                        cos_res_77678 = 0.0;\n                    }\n                    \n                    double", " dist_res_77682;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double eta_p_77674 = ((__global double *) current_partition_mem_81940)[slice_77755];\n                        double eta_p_77675 = ((__global double *) current_partition_mem_81941)[slice_77755];\n                        bool zeze_res_77683 = eta_p_77674 == eta_p_77679;\n                        double d_euclidean_res_77684;\n                        \n                        if (zeze_res_77683) {\n                            double zm_res_77685 = eta_p_77675 - eta_p_77680;\n                            double abs_res_77686 = fabs64(zm_res_77685);\n                            \n                            d_euclidean_res_77684 = abs_res_77686;\n                        } else {\n                            bool zeze_res_77687 = eta_p_77675 == eta_p_77680;\n                            double d_euclidean_res_f_res_77688;\n                            \n                            if (zeze_res_77687) {\n                                double zm_res_77689 = eta_p_77674 - eta_p_77679;\n                                double abs_res_77690 = fabs64(zm_res_77689);\n                                \n                                d_euclidean_res_f_res_77688 = abs_res_77690;\n                            } else {\n                                double zm_res_77691 = eta_p_77675 - eta_p_77680;\n                                double zm_res_77692 = eta_p_77674 - eta_p_77679;\n                                double hypot_res_77693 = futrts_hypot64(zm_res_77692, zm_res_77691);\n                                \n                                d_euclidean_res_f_res_77688 = hypot_res_77693;\n                            }\n                            d_euclidean_res_77684 = d_euclidean_res_f_res_77688;\n                        }\n                        dist_res_77682 = d_euclidean_res_77684;\n                    } else {\n                        double d_haversine_res_77694;\n                        dou",
                                    "ble d_haversine_res_77695;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_77694 = eta_p_77679;\n                            d_haversine_res_77695 = eta_p_77680;\n                        } else {\n                            double zt_res_77696 = 3.141592653589793 * eta_p_77679;\n                            double zs_res_77697 = zt_res_77696 / 180.0;\n                            double zt_res_77698 = 3.141592653589793 * eta_p_77680;\n                            double zs_res_77699 = zt_res_77698 / 180.0;\n                            \n                            d_haversine_res_77694 = zs_res_77697;\n                            d_haversine_res_77695 = zs_res_77699;\n                        }\n                        \n                        double zm_res_77700 = d_haversine_res_77676 - d_haversine_res_77694;\n                        double cos_res_77701 = futrts_cos64(zm_res_77700);\n                        double zm_res_77702 = 1.0 - cos_res_77701;\n                        double cos_res_77703 = futrts_cos64(d_haversine_res_77694);\n                        double zt_res_77704 = cos_res_77678 * cos_res_77703;\n                        double zm_res_77705 = d_haversine_res_77677 - d_haversine_res_77695;\n                        double zm_res_77706 = 1.0 - zm_res_77705;\n                        double zt_res_77707 = zt_res_77704 * zm_res_77706;\n                        double zp_res_77708 = zm_res_77702 + zt_res_77707;\n                        double zs_res_77709 = zp_res_77708 / 2.0;\n                        double min_res_77710 = fmin64(1.0, zs_res_77709);\n                        double zt_res_77711 = 2.0 * min_res_77710;\n                        double zm_res_77712 = 1.0 - zt_res_77711;\n                        double acos_res_77713 = futrts_acos64(zm_res_77712);\n                        double zt_res_77714 = clBase_48698 * acos_res_77713;\n                        \n                        dist_res_77682 = zt_res_", "77714;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)] = x_77681;\n                        ((__local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = dist_res_77682;\n                    }\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)] = (int64_t) -1;\n                ((__local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = INFINITY;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, conc_tmp_62379)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_77662;\n                double eta_p_77663;\n                int64_t eta_p_77664;\n                double eta_p_77665;\n                int64_t eta_p_86637;\n                double eta_p_86638;\n                int64_t eta_p_86639;\n                double eta_p_86640;\n                bool ltid_in_bounds_86649 = slt64(sext_i32_i64(local_tid_86623), conc_tmp_62379 * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620));\n                int32_t skip_threads_86650;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_86649) {\n                        eta_p_77664 = ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)];\n                        eta_p_77665 = ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)];\n                        if ((local_tid_86623 - squot32(local_tid_86623, 32) * 32) == 0) {\n                            eta_p_77662 = eta_p_77664;\n                            eta_p_77663 = eta_p_77665;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n           ", "     {\n                    skip_threads_86650 = 1;\n                    while (slt32(skip_threads_86650, 32)) {\n                        bool thread_active_86651 = sle32(skip_threads_86650, local_tid_86623 - squot32(local_tid_86623, 32) * 32) && ltid_in_bounds_86649;\n                        \n                        if (thread_active_86651) {\n                            // read operands\n                            {\n                                eta_p_77662 = ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623) - sext_i32_i64(skip_threads_86650)];\n                                eta_p_77663 = ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623) - sext_i32_i64(skip_threads_86650)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_86652 = slt64(srem64(sext_i32_i64(local_tid_86623), conc_tmp_62379), sext_i32_i64(local_tid_86623) - sext_i32_i64(local_tid_86623 - skip_threads_86650));\n                            \n                            if (thread_active_86651 && inactive_86652) {\n                                eta_p_77662 = eta_p_77664;\n                                eta_p_77663 = eta_p_77665;\n                            }\n                            if (thread_active_86651) {\n                                if (!inactive_86652) {\n                                    bool zg_res_77666 = clBase_48692 < eta_p_77663;\n                                    bool zg_res_77667 = clBase_48692 < eta_p_77665;\n                                    bool x_77668 = zg_res_77666 && zg_res_77667;\n                                    int64_t lifted_lambda_res_77669;\n                                    double lifted_lambda_res_77670;\n                                    \n                                    if (x_77668) {\n                                        lifted_lambda_res_77669 = (int64_t) -1;\n               ",
                                    "                         lifted_lambda_res_77670 = INFINITY;\n                                    } else {\n                                        bool zl_res_77671 = eta_p_77663 < eta_p_77665;\n                                        int64_t lifted_lambda_res_f_res_77672;\n                                        \n                                        if (zl_res_77671) {\n                                            lifted_lambda_res_f_res_77672 = eta_p_77662;\n                                        } else {\n                                            lifted_lambda_res_f_res_77672 = eta_p_77664;\n                                        }\n                                        \n                                        double lifted_lambda_res_f_res_77673;\n                                        \n                                        if (zl_res_77671) {\n                                            lifted_lambda_res_f_res_77673 = eta_p_77663;\n                                        } else {\n                                            lifted_lambda_res_f_res_77673 = eta_p_77665;\n                                        }\n                                        lifted_lambda_res_77669 = lifted_lambda_res_f_res_77672;\n                                        lifted_lambda_res_77670 = lifted_lambda_res_f_res_77673;\n                                    }\n                                    eta_p_77662 = lifted_lambda_res_77669;\n                                    eta_p_77663 = lifted_lambda_res_77670;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_86625, skip_threads_86650)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_86651) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623", ")] = eta_p_77662;\n                                eta_p_77664 = eta_p_77662;\n                                ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = eta_p_77663;\n                                eta_p_77665 = eta_p_77663;\n                            }\n                        }\n                        if (sle32(wave_sizze_86625, skip_threads_86650)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_86650 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_86623 - squot32(local_tid_86623, 32) * 32) == 31 && ltid_in_bounds_86649) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(squot32(local_tid_86623, 32))] = eta_p_77662;\n                        ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(squot32(local_tid_86623, 32))] = eta_p_77663;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_86653;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_86623, 32) == 0 && ltid_in_bounds_86649) {\n                            eta_p_86639 = ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)];\n                            eta_p_86640 = ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)];\n                            if ((local_tid_86623 - squot32(local_tid_86623, 32) * 32) == 0) {\n                                eta_p_86637 = eta_p_86639;\n                                eta_p_86638 = eta_p_86640;\n         ", "                   }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_86653 = 1;\n                        while (slt32(skip_threads_86653, 32)) {\n                            bool thread_active_86654 = sle32(skip_threads_86653, local_tid_86623 - squot32(local_tid_86623, 32) * 32) && (squot32(local_tid_86623, 32) == 0 && ltid_in_bounds_86649);\n                            \n                            if (thread_active_86654) {\n                                // read operands\n                                {\n                                    eta_p_86637 = ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623) - sext_i32_i64(skip_threads_86653)];\n                                    eta_p_86638 = ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623) - sext_i32_i64(skip_threads_86653)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_86655 = slt64(srem64(sext_i32_i64(local_tid_86623 * 32 + 32 - 1), conc_tmp_62379), sext_i32_i64(local_tid_86623 * 32 + 32 - 1) - sext_i32_i64((local_tid_86623 - skip_threads_86653) * 32 + 32 - 1));\n                                \n                                if (thread_active_86654 && inactive_86655) {\n                                    eta_p_86637 = eta_p_86639;\n                                    eta_p_86638 = eta_p_86640;\n                                }\n                                if (thread_active_86654) {\n                                    if (!inactive_86655) {\n                                        bool zg_res_86641 = clBase_48692 < eta_p_86638;\n                                        bool zg_res_86642 = clBase_48692 < eta_p_86640;\n                                        bool x_86643 = zg_res_86641 && zg_",
                                    "res_86642;\n                                        int64_t lifted_lambda_res_86644;\n                                        double lifted_lambda_res_86645;\n                                        \n                                        if (x_86643) {\n                                            lifted_lambda_res_86644 = (int64_t) -1;\n                                            lifted_lambda_res_86645 = INFINITY;\n                                        } else {\n                                            bool zl_res_86646 = eta_p_86638 < eta_p_86640;\n                                            int64_t lifted_lambda_res_f_res_86647;\n                                            \n                                            if (zl_res_86646) {\n                                                lifted_lambda_res_f_res_86647 = eta_p_86637;\n                                            } else {\n                                                lifted_lambda_res_f_res_86647 = eta_p_86639;\n                                            }\n                                            \n                                            double lifted_lambda_res_f_res_86648;\n                                            \n                                            if (zl_res_86646) {\n                                                lifted_lambda_res_f_res_86648 = eta_p_86638;\n                                            } else {\n                                                lifted_lambda_res_f_res_86648 = eta_p_86640;\n                                            }\n                                            lifted_lambda_res_86644 = lifted_lambda_res_f_res_86647;\n                                            lifted_lambda_res_86645 = lifted_lambda_res_f_res_86648;\n                                        }\n                                        eta_p_86637 = lifted_lambda_res_86644;\n                                        eta_p_86638 = lifted_lambda_res_86645;\n                                    }\n      ", "                          }\n                            }\n                            if (sle32(wave_sizze_86625, skip_threads_86653)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_86654) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)] = eta_p_86637;\n                                    eta_p_86639 = eta_p_86637;\n                                    ((volatile __local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = eta_p_86638;\n                                    eta_p_86640 = eta_p_86638;\n                                }\n                            }\n                            if (sle32(wave_sizze_86625, skip_threads_86653)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_86653 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_86656 = squot32(local_tid_86623, 32) == 0 || !ltid_in_bounds_86649;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_86656) {\n                            eta_p_77664 = eta_p_77662;\n                            eta_p_77665 = eta_p_77663;\n                            eta_p_77662 = ((__local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(squot32(local_tid_86623, 32)) - (int64_t) 1];\n                            eta_p_77663 = ((__local double *) red_arr_f64_mem_86629)[sext_i32_i64(squot32(local_tid_86623, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n      ", "                  bool inactive_86657 = slt64(srem64(sext_i32_i64(local_tid_86623), conc_tmp_62379), sext_i32_i64(local_tid_86623) - sext_i32_i64(squot32(local_tid_86623, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_86656) {\n                            if (inactive_86657) {\n                                eta_p_77662 = eta_p_77664;\n                                eta_p_77663 = eta_p_77665;\n                            }\n                        }\n                        if (!no_carry_in_86656) {\n                            if (!inactive_86657) {\n                                bool zg_res_77666 = clBase_48692 < eta_p_77663;\n                                bool zg_res_77667 = clBase_48692 < eta_p_77665;\n                                bool x_77668 = zg_res_77666 && zg_res_77667;\n                                int64_t lifted_lambda_res_77669;\n                                double lifted_lambda_res_77670;\n                                \n                                if (x_77668) {\n                                    lifted_lambda_res_77669 = (int64_t) -1;\n                                    lifted_lambda_res_77670 = INFINITY;\n                                } else {\n                                    bool zl_res_77671 = eta_p_77663 < eta_p_77665;\n                                    int64_t lifted_lambda_res_f_res_77672;\n                                    \n                                    if (zl_res_77671) {\n                                        lifted_lambda_res_f_res_77672 = eta_p_77662;\n                                    } else {\n                                        lifted_lambda_res_f_res_77672 = eta_p_77664;\n                                    }\n                                    \n                                    double lifted_lambda_res_f_res_77673;\n                                    \n                                    if (zl_res_77671) {\n                                        lifted_lambda_res_f_res_77673 ",
                                    "= eta_p_77663;\n                                    } else {\n                                        lifted_lambda_res_f_res_77673 = eta_p_77665;\n                                    }\n                                    lifted_lambda_res_77669 = lifted_lambda_res_f_res_77672;\n                                    lifted_lambda_res_77670 = lifted_lambda_res_f_res_77673;\n                                }\n                                eta_p_77662 = lifted_lambda_res_77669;\n                                eta_p_77663 = lifted_lambda_res_77670;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_86656) {\n                            ((__local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)] = eta_p_77662;\n                            ((__local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = eta_p_77663;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_86623, 32) == 0 && ltid_in_bounds_86649) {\n                        ((__local int64_t *) red_arr_i64_mem_86627)[sext_i32_i64(local_tid_86623)] = eta_p_77664;\n                        ((__local double *) red_arr_f64_mem_86629)[sext_i32_i64(local_tid_86623)] = eta_p_77665;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_86634) * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620) + sext_i32_i64(local_tid_86623), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547) && slt64(sext_i32_i64(local_tid_86623), squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620))) {\n                int64_", "t tmp_86658 = ((__local int64_t *) red_arr_i64_mem_86627)[(sext_i32_i64(local_tid_86623) + (int64_t) 1) * segment_sizze_nonzzero_86620 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_81972)[inf_63544 + (sext_i32_i64(virt_tblock_id_86634) * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620) + sext_i32_i64(local_tid_86623))] = tmp_86658;\n                \n                double tmp_86659 = ((__local double *) red_arr_f64_mem_86629)[(sext_i32_i64(local_tid_86623) + (int64_t) 1) * segment_sizze_nonzzero_86620 - (int64_t) 1];\n                \n                ((__global double *) mem_82831)[sext_i32_i64(virt_tblock_id_86634) * squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620) + sext_i32_i64(local_tid_86623)] = tmp_86659;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_77654\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegred_small_84292_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegred_small_84292(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, int64_t num_tblocks_75446, int64_t num_subhistos_84206, int64_t segment_sizze_nonzzero_84294, __global unsigned char *mem_82212, __global unsigned char *defunc_0_map_res_subhistos_mem_84207)\n{\n    #define seghist_tblock_sizze_75444 (do_DBSCAN_doublezisegred_small_84292ziseghist_tblock_sizze_75444)\n    \n    volatile __local unsigned char *red_arr_i64_mem_84301_backing_0 = &shared_mem[0];\n    const int64_t red_arr_i64_mem_84301_backing_0_offset = 0 + ((int64_t) 8 * seghist_tblock_sizze_75444 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_75444, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84297;\n    int32_t tblock_sizze_84300;\n    int32_t wave_sizze_84299;\n    int32_t block_id_84298;\n    int32_t global_tid_84296;\n    int64_t flat_gtid_84292;\n   ", " __local unsigned char *red_arr_i64_mem_84301;\n    int32_t phys_tblock_id_84303;\n    int32_t iterations_84304;\n    \n    local_tid_84297 = get_local_id(0);\n    tblock_sizze_84300 = get_local_size(0);\n    wave_sizze_84299 = LOCKSTEP_WIDTH;\n    block_id_84298 = get_tblock_id(0);\n    global_tid_84296 = block_id_84298 * tblock_sizze_84300 + local_tid_84297;\n    flat_gtid_84292 = sext_i32_i64(global_tid_84296);\n    red_arr_i64_mem_84301 = (__local unsigned char *) red_arr_i64_mem_84301_backing_0;\n    phys_tblock_id_84303 = get_tblock_id(0);\n    iterations_84304 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294))) - phys_tblock_id_84303, sext_i64_i32(num_tblocks_75446));\n    for (int32_t i_84305 = 0; i_84305 < iterations_84304; i_84305++) {\n        int32_t virt_tblock_id_84306;\n        int64_t slice_84307;\n        int64_t bucket_id_84290;\n        int64_t remnant_84308;\n        int64_t subhistogram_id_84291;\n        \n        virt_tblock_id_84306 = phys_tblock_id_84303 + i_84305 * sext_i64_i32(num_tblocks_75446);\n        slice_84307 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;\n        bucket_id_84290 = squot64(sext_i32_i64(local_tid_84297), segment_sizze_nonzzero_84294) + sext_i32_i64(virt_tblock_id_84306) * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294);\n        remnant_84308 = squot64(sext_i32_i64(local_tid_84297), segment_sizze_nonzzero_84294) + sext_i32_i64(virt_tblock_id_84306) * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294) - bucket_id_84290;\n        subhistogram_id_84291 = srem64(sext_i32_i64(local_tid_84297), num_subhistos_84206);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_84206) && (slt64(bucket_id_84290, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344) && slt64(sext_i32_i64(local_tid_84297), num_subhistos_84206 * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294)))) {\n      ",
                                    "          // save results to be reduced\n                {\n                    int64_t tmp_84309 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_84207)[subhistogram_id_84291 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 + bucket_id_84290];\n                    \n                    ((__local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = tmp_84309;\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_84206)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_75452;\n                int64_t eta_p_75453;\n                int64_t eta_p_84310;\n                int64_t eta_p_84311;\n                bool ltid_in_bounds_84313 = slt64(sext_i32_i64(local_tid_84297), num_subhistos_84206 * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294));\n                int32_t skip_threads_84314;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_84313) {\n                        eta_p_75453 = ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)];\n                        if ((local_tid_84297 - squot32(local_tid_84297, 32) * 32) == 0) {\n                            eta_p_75452 = eta_p_75453;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84314 = 1;\n                    while (slt32(skip_threads_84314, 32)) {\n                        bool thread_active_84315 = sle32(skip_threads_84314, local_tid_84297 - squot32(local_tid_84297, 32) * 32) && ltid_in_bounds_84313;\n                        \n                        if (thread_active_84315) {\n                            // read operands\n    ", "                        {\n                                eta_p_75452 = ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297) - sext_i32_i64(skip_threads_84314)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_84316 = slt64(srem64(sext_i32_i64(local_tid_84297), num_subhistos_84206), sext_i32_i64(local_tid_84297) - sext_i32_i64(local_tid_84297 - skip_threads_84314));\n                            \n                            if (thread_active_84315 && inactive_84316) {\n                                eta_p_75452 = eta_p_75453;\n                            }\n                            if (thread_active_84315) {\n                                if (!inactive_84316) {\n                                    int64_t defunc_0_op_res_75454 = add64(eta_p_75452, eta_p_75453);\n                                    \n                                    eta_p_75452 = defunc_0_op_res_75454;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_84299, skip_threads_84314)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84315) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = eta_p_75452;\n                                eta_p_75453 = eta_p_75452;\n                            }\n                        }\n                        if (sle32(wave_sizze_84299, skip_threads_84314)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84314 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its", " result to offset 'i'\n                {\n                    if ((local_tid_84297 - squot32(local_tid_84297, 32) * 32) == 31 && ltid_in_bounds_84313) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(squot32(local_tid_84297, 32))] = eta_p_75452;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_84317;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_84297, 32) == 0 && ltid_in_bounds_84313) {\n                            eta_p_84311 = ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)];\n                            if ((local_tid_84297 - squot32(local_tid_84297, 32) * 32) == 0) {\n                                eta_p_84310 = eta_p_84311;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_84317 = 1;\n                        while (slt32(skip_threads_84317, 32)) {\n                            bool thread_active_84318 = sle32(skip_threads_84317, local_tid_84297 - squot32(local_tid_84297, 32) * 32) && (squot32(local_tid_84297, 32) == 0 && ltid_in_bounds_84313);\n                            \n                            if (thread_active_84318) {\n                                // read operands\n                                {\n                                    eta_p_84310 = ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297) - sext_i32_i64(skip_threads_84317)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inac",
                                    "tive_84319 = slt64(srem64(sext_i32_i64(local_tid_84297 * 32 + 32 - 1), num_subhistos_84206), sext_i32_i64(local_tid_84297 * 32 + 32 - 1) - sext_i32_i64((local_tid_84297 - skip_threads_84317) * 32 + 32 - 1));\n                                \n                                if (thread_active_84318 && inactive_84319) {\n                                    eta_p_84310 = eta_p_84311;\n                                }\n                                if (thread_active_84318) {\n                                    if (!inactive_84319) {\n                                        int64_t defunc_0_op_res_84312 = add64(eta_p_84310, eta_p_84311);\n                                        \n                                        eta_p_84310 = defunc_0_op_res_84312;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_84299, skip_threads_84317)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_84318) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = eta_p_84310;\n                                    eta_p_84311 = eta_p_84310;\n                                }\n                            }\n                            if (sle32(wave_sizze_84299, skip_threads_84317)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_84317 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_84320 = squot32(local_tid_84297, 32) == 0 || !ltid_in_bounds_84313;\n                \n                // carry-in for every block except the first\n                {\n                    //", " read operands\n                    {\n                        if (!no_carry_in_84320) {\n                            eta_p_75453 = eta_p_75452;\n                            eta_p_75452 = ((__local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(squot32(local_tid_84297, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_84321 = slt64(srem64(sext_i32_i64(local_tid_84297), num_subhistos_84206), sext_i32_i64(local_tid_84297) - sext_i32_i64(squot32(local_tid_84297, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_84320) {\n                            if (inactive_84321) {\n                                eta_p_75452 = eta_p_75453;\n                            }\n                        }\n                        if (!no_carry_in_84320) {\n                            if (!inactive_84321) {\n                                int64_t defunc_0_op_res_75454 = add64(eta_p_75452, eta_p_75453);\n                                \n                                eta_p_75452 = defunc_0_op_res_75454;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_84320) {\n                            ((__local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = eta_p_75452;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_84297, 32) == 0 && ltid_in_bounds_84313) {\n                        ((__local int64_t *) red_arr_i64_mem_84301)[sext_i32_i64(local_tid_84297)] = eta_p_75453;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save fin", "al values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_84306) * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294) + sext_i32_i64(local_tid_84297), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344) && slt64(sext_i32_i64(local_tid_84297), squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294))) {\n                int64_t tmp_84322 = ((__local int64_t *) red_arr_i64_mem_84301)[(sext_i32_i64(local_tid_84297) + (int64_t) 1) * segment_sizze_nonzzero_84294 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_82212)[sext_i32_i64(virt_tblock_id_84306) * squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294) + sext_i32_i64(local_tid_84297)] = tmp_84322;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef seghist_tblock_sizze_75444\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75082_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75082(__global int *global_failure, int64_t n_48679, int64_t num_tblocks_75079, int64_t num_virt_blocks_83162, int64_t num_virt_threads_83163, __global unsigned char *current_partition_mem_81945, __global unsigned char *mem_81954, __global unsigned char *mem_81956, __global unsigned char *status_flags_mem_83164, __global unsigned char *aggregates_mem_83186, __global unsigned char *incprefixes_mem_83188, __global unsigned char *global_dynid_mem_83190)\n{\n    #define segscan_tblock_sizze_75077 (do_DBSCAN_doublezisegscan_75082zisegscan_tblock_sizze_75077)\n    #define chunk_sizze_83161 (do_DBSCAN_doublezisegscan_75082zichunk_sizze_83161)\n    \n    volatile __local unsigned char *local_mem_83220_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83220_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75077), chunk_sizze_83161 * segscan_tblock_sizze_75077 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (",
                                    "int64_t) 8 * segscan_tblock_sizze_75077), chunk_sizze_83161 * segscan_tblock_sizze_75077 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83213;\n    int32_t tblock_sizze_83216;\n    int32_t wave_sizze_83215;\n    int32_t block_id_83214;\n    int32_t global_tid_83212;\n    int64_t phys_tid_75082;\n    int32_t chunk_sizze_32b_83217;\n    int64_t byte_offsets_83218;\n    int64_t warp_byte_offset_83219;\n    __local unsigned char *local_mem_83220;\n    int64_t trans_arr_len_83221;\n    int64_t phys_block_id_83227;\n    int64_t virtloop_bound_83228;\n    \n    local_tid_83213 = get_local_id(0);\n    tblock_sizze_83216 = get_local_size(0);\n    wave_sizze_83215 = LOCKSTEP_WIDTH;\n    block_id_83214 = get_tblock_id(0);\n    global_tid_83212 = block_id_83214 * tblock_sizze_83216 + local_tid_83213;\n    phys_tid_75082 = sext_i32_i64(global_tid_83212);\n    chunk_sizze_32b_83217 = sext_i64_i32(chunk_sizze_83161);\n    byte_offsets_83218 = segscan_tblock_sizze_75077 * (int64_t) 8;\n    warp_byte_offset_83219 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83220 = (__local unsigned char *) local_mem_83220_backing_0;\n    trans_arr_len_83221 = chunk_sizze_83161 * segscan_tblock_sizze_75077;\n    phys_block_id_83227 = get_tblock_id(0);\n    virtloop_bound_83228 = sdiv_up64(num_virt_blocks_83162 - phys_block_id_83227, num_tblocks_75079);\n    for (int64_t virtloop_i_83229 = 0; virtloop_i_83229 < virtloop_bound_83228; virtloop_i_83229++) {\n        int64_t dynamic_id_83230;\n        int64_t block_offset_83231;\n        int64_t sgm_idx_83232;\n        int32_t boundary_83233;\n        int32_t segsizze_compact_83234;\n        int64_t private_mem_83235[chunk_sizze_83161];\n        int64_t thd_offset_83237;\n        int64_t acc_83253;\n        int64_t prefix_83263;\n        bool block_new_sgm_83264;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83213 == 0)", " {\n                dynamic_id_83230 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83190)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83220)[(int64_t) 0] = dynamic_id_83230;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83230 == num_virt_blocks_83162 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83190)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83230 = ((__local int32_t *) local_mem_83220)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83231 = dynamic_id_83230 * chunk_sizze_83161 * segscan_tblock_sizze_75077;\n        sgm_idx_83232 = smod64(block_offset_83231, n_48679);\n        boundary_83233 = sext_i64_i32(smin64(chunk_sizze_83161 * segscan_tblock_sizze_75077, n_48679 - sgm_idx_83232));\n        segsizze_compact_83234 = sext_i64_i32(smin64(chunk_sizze_83161 * segscan_tblock_sizze_75077, n_48679));\n        thd_offset_83237 = block_offset_83231 + sext_i32_i64(local_tid_83213);\n        // Load and map\n        {\n            for (int64_t i_83238 = 0; i_83238 < chunk_sizze_83161; i_83238++) {\n                int64_t virt_tid_83239 = thd_offset_83237 + i_83238 * segscan_tblock_sizze_75077;\n                int64_t slice_83240 = n_48679;\n                int64_t gtid_75081 = virt_tid_83239;\n                int64_t remnant_83241 = virt_tid_83239 - gtid_75081;\n                \n                if (slt64(virt_tid_83239, n_48679)) {\n                    bool eta_p_65099 = ((__global bool *) current_partition_mem_81945)[gtid_75081];\n                    int64_t defunc_0_f_res_65100 = btoi_bool_i64(eta_p_65099);\n                    \n                    ((__global int64_t *) mem_81956)[gtid_75081] = defunc_0_f_r", "es_65100;\n                    private_mem_83235[i_83238] = defunc_0_f_res_65100;\n                } else {\n                    private_mem_83235[i_83238] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83242 = 0; i_83242 < chunk_sizze_83161; i_83242++) {\n                int64_t sharedIdx_83243 = sext_i32_i64(local_tid_83213) + i_83242 * segscan_tblock_sizze_75077;\n                int64_t tmp_83244 = private_mem_83235[i_83242];\n                \n                ((__local int64_t *) local_mem_83220)[sharedIdx_83243] = tmp_83244;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83245 = 0; i_83245 < chunk_sizze_83161; i_83245++) {\n                int64_t sharedIdx_83246 = sext_i32_i64(local_tid_83213) * chunk_sizze_83161 + i_83245;\n                int64_t tmp_83247 = ((__local int64_t *) local_mem_83220)[sharedIdx_83246];\n                \n                private_mem_83235[i_83245] = tmp_83247;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83248 = 0; i_83248 < chunk_sizze_83161 - (int64_t) 1; i_83248++) {\n                int64_t eta_p_61599;\n                int64_t eta_p_61600;\n                \n                eta_p_61599 = private_mem_83235[i_83248];\n                eta_p_61600 = private_mem_83235[i_83248 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_61601 = add64(eta_p_61599, eta_p_61600);\n                \n                private_mem_83235[i_83248 + (int64_t) 1] = defunc_0_op_res_61601;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83249 = private_mem_83235[chunk_sizze_83161 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = tmp_83249;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // S",
                                    "can results (with warp scan)\n        {\n            int64_t eta_p_83250;\n            int64_t eta_p_83251;\n            int64_t eta_p_83254;\n            int64_t eta_p_83255;\n            bool ltid_in_bounds_83257 = slt64(sext_i32_i64(local_tid_83213), num_virt_threads_83163);\n            int32_t skip_threads_83258;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83257) {\n                    eta_p_83251 = ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)];\n                    if ((local_tid_83213 - squot32(local_tid_83213, 32) * 32) == 0) {\n                        eta_p_83250 = eta_p_83251;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83258 = 1;\n                while (slt32(skip_threads_83258, 32)) {\n                    bool thread_active_83259 = sle32(skip_threads_83258, local_tid_83213 - squot32(local_tid_83213, 32) * 32) && ltid_in_bounds_83257;\n                    \n                    if (thread_active_83259) {\n                        // read operands\n                        {\n                            eta_p_83250 = ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213) - sext_i32_i64(skip_threads_83258)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83259) {\n                            int64_t defunc_0_op_res_83252 = add64(eta_p_83250, eta_p_83251);\n                            \n                            eta_p_83250 = defunc_0_op_res_83252;\n                        }\n                    }\n                    if (sle32(wave_sizze_83215, skip_threads_83258)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83259) {\n                        // write result\n                        {", "\n                            ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = eta_p_83250;\n                            eta_p_83251 = eta_p_83250;\n                        }\n                    }\n                    if (sle32(wave_sizze_83215, skip_threads_83258)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83258 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83213 - squot32(local_tid_83213, 32) * 32) == 31 && ltid_in_bounds_83257) {\n                    ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(squot32(local_tid_83213, 32))] = eta_p_83250;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83260;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83213, 32) == 0 && ltid_in_bounds_83257) {\n                        eta_p_83255 = ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)];\n                        if ((local_tid_83213 - squot32(local_tid_83213, 32) * 32) == 0) {\n                            eta_p_83254 = eta_p_83255;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83260 = 1;\n                    while (slt32(skip_threads_83260, 32)) {\n                        bool thread_active_83261 = sle32(skip_threads_83260, local_tid_83213 - squot32(local_tid_83213, 32) * 32) && (squot32(local_tid_83213, 32) == 0 && ltid_in_bounds_83257);\n                        \n                        if (thread_active_83261) {\n            ", "                // read operands\n                            {\n                                eta_p_83254 = ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213) - sext_i32_i64(skip_threads_83260)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83261) {\n                                int64_t defunc_0_op_res_83256 = add64(eta_p_83254, eta_p_83255);\n                                \n                                eta_p_83254 = defunc_0_op_res_83256;\n                            }\n                        }\n                        if (sle32(wave_sizze_83215, skip_threads_83260)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83261) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = eta_p_83254;\n                                eta_p_83255 = eta_p_83254;\n                            }\n                        }\n                        if (sle32(wave_sizze_83215, skip_threads_83260)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83260 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83262 = squot32(local_tid_83213, 32) == 0 || !ltid_in_bounds_83257;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83262) {\n                        eta_p_83251 = eta_p_83250;\n                        eta_p_83250 = ((__local int64_t *) local_mem_83220)[sext_i32_i64(squot32(local_tid_83213, 32)) - (int64_t) 1];\n                    }\n             ",
                                    "   }\n                // perform operation\n                {\n                    if (!no_carry_in_83262) {\n                        int64_t defunc_0_op_res_83252 = add64(eta_p_83250, eta_p_83251);\n                        \n                        eta_p_83250 = defunc_0_op_res_83252;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83262) {\n                        ((__local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = eta_p_83250;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83213, 32) == 0 && ltid_in_bounds_83257) {\n                    ((__local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = eta_p_83251;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83213 == 0) {\n                acc_83253 = ((__local int64_t *) local_mem_83220)[segscan_tblock_sizze_75077 - (int64_t) 1];\n            } else {\n                acc_83253 = ((__local int64_t *) local_mem_83220)[sext_i32_i64(local_tid_83213) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83263 = (int64_t) 0;\n        block_new_sgm_83264 = sgm_idx_83232 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83264 && local_tid_83213 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83188)[dynamic_id_83230] = acc_83253;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83164)[dynamic_id_83230] = (int8_t) 2;\n                acc_83253 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83264 && slt32(local_tid_83213, wave_sizze_83215)) {\n                if (local_tid_83213 == 0) {\n                    ((volatile __glob", "al int64_t *) aggregates_mem_83186)[dynamic_id_83230] = acc_83253;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83164)[dynamic_id_83230] = (int8_t) 1;\n                    \n                    int8_t tmp_83265 = ((volatile __global int8_t *) status_flags_mem_83164)[dynamic_id_83230 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83220)[(int64_t) 0] = tmp_83265;\n                }\n                mem_fence_local();\n                \n                int8_t status_83266 = ((__local int8_t *) local_mem_83220)[(int64_t) 0];\n                \n                if (status_83266 == (int8_t) 2) {\n                    if (local_tid_83213 == 0) {\n                        prefix_83263 = ((volatile __global int64_t *) incprefixes_mem_83188)[dynamic_id_83230 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83267 = sext_i64_i32(dynamic_id_83230 - sext_i32_i64(wave_sizze_83215));\n                    \n                    while (slt32(wave_sizze_83215 * -1, readOffset_83267)) {\n                        int32_t read_i_83268 = readOffset_83267 + local_tid_83213;\n                        int64_t aggr_83269 = (int64_t) 0;\n                        int8_t flag_83270 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83268)) {\n                            flag_83270 = ((volatile __global int8_t *) status_flags_mem_83164)[sext_i32_i64(read_i_83268)];\n                            if (flag_83270 == (int8_t) 2) {\n                                aggr_83269 = ((volatile __global int64_t *) incprefixes_mem_83188)[sext_i32_i64(read_i_83268)];\n                            } else if (flag_83270 == (int8_t) 1) {\n                                aggr_83269 = ((volatile __global int64_t *) aggregates_mem_83186)[sext_i32_i64(read_i_83268)];\n                            }\n                        }\n                        ((__loca", "l int64_t *) local_mem_83220)[(int64_t) 4 + sext_i32_i64(local_tid_83213)] = aggr_83269;\n                        ((__local int8_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = flag_83270;\n                        flag_83270 = ((__local int8_t *) local_mem_83220)[sext_i32_i64(wave_sizze_83215) - (int64_t) 1];\n                        if (slt8(flag_83270, (int8_t) 2)) {\n                            int8_t flg_x_83274;\n                            int8_t flg_y_83275;\n                            int64_t eta_p_83271;\n                            int64_t eta_p_83272;\n                            int32_t skip_threads_83276;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83275 = ((volatile __local int8_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)];\n                                eta_p_83272 = ((volatile __local int64_t *) local_mem_83220)[(int64_t) 4 + sext_i32_i64(local_tid_83213)];\n                                if ((local_tid_83213 - squot32(local_tid_83213, 32) * 32) == 0) {\n                                    eta_p_83271 = eta_p_83272;\n                                    flg_x_83274 = flg_y_83275;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83276 = 1;\n                                while (slt32(skip_threads_83276, 32)) {\n                                    if (sle32(skip_threads_83276, local_tid_83213 - squot32(local_tid_83213, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83274 = ((volatile __local int8_t *) local_mem_83220)[sext_i32_i64(local_tid_83213) - sext_i32_i64(skip_threads_83276)];\n                                            eta_p_83271 = ((volatile __local i",
                                    "nt64_t *) local_mem_83220)[(int64_t) 4 + (sext_i32_i64(local_tid_83213) - sext_i32_i64(skip_threads_83276))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83275 == (int8_t) 2 || flg_y_83275 == (int8_t) 0) {\n                                                flg_x_83274 = flg_y_83275;\n                                                eta_p_83271 = eta_p_83272;\n                                            } else {\n                                                int64_t defunc_0_op_res_83273 = add64(eta_p_83271, eta_p_83272);\n                                                \n                                                eta_p_83271 = defunc_0_op_res_83273;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83220)[sext_i32_i64(local_tid_83213)] = flg_x_83274;\n                                            flg_y_83275 = flg_x_83274;\n                                            ((volatile __local int64_t *) local_mem_83220)[(int64_t) 4 + sext_i32_i64(local_tid_83213)] = eta_p_83271;\n                                            eta_p_83272 = eta_p_83271;\n                                        }\n                                    }\n                                    skip_threads_83276 *= 2;\n                                }\n                            }\n                        }\n                        flag_83270 = ((__local int8_t *) local_mem_83220)[sext_i32_i64(wave_sizze_83215) - (int64_t) 1];\n                        aggr_83269 = ((__local int64_t *) local_mem_83220)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83215) - (int64_t) 1)];\n                        if (flag_83270 == (int8_t) 2) {\n                            ", "readOffset_83267 = wave_sizze_83215 * -1;\n                        } else if (flag_83270 == (int8_t) 1) {\n                            readOffset_83267 -= wave_sizze_83215;\n                        }\n                        if (slt8((int8_t) 0, flag_83270)) {\n                            int64_t eta_p_83277 = aggr_83269;\n                            int64_t eta_p_83278 = prefix_83263;\n                            int64_t defunc_0_op_res_83279 = add64(eta_p_83277, eta_p_83278);\n                            \n                            prefix_83263 = defunc_0_op_res_83279;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83213 == 0) {\n                    if (boundary_83233 == sext_i64_i32(segscan_tblock_sizze_75077 * chunk_sizze_83161)) {\n                        int64_t eta_p_83280 = prefix_83263;\n                        int64_t eta_p_83281 = acc_83253;\n                        int64_t defunc_0_op_res_83282 = add64(eta_p_83280, eta_p_83281);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83188)[dynamic_id_83230] = defunc_0_op_res_83282;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83164)[dynamic_id_83230] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83220)[(int64_t) 4] = prefix_83263;\n                    acc_83253 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83230 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83263 = ((__local int64_t *) local_mem_83220)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83283;\n            int64_t eta_p_83284;\n            int64_t eta_p_83286 = prefix_83263;\n            int64_t eta_p_83287 = acc_83253;\n            \n            i", "f (slt32(local_tid_83213 * chunk_sizze_32b_83217, boundary_83233) && !block_new_sgm_83264) {\n                int64_t defunc_0_op_res_83288 = add64(eta_p_83286, eta_p_83287);\n                \n                eta_p_83283 = defunc_0_op_res_83288;\n            } else {\n                eta_p_83283 = acc_83253;\n            }\n            \n            int32_t stopping_point_83289 = segsizze_compact_83234 - srem32(local_tid_83213 * chunk_sizze_32b_83217 - 1 + segsizze_compact_83234 - boundary_83233, segsizze_compact_83234);\n            \n            for (int64_t i_83290 = 0; i_83290 < chunk_sizze_83161; i_83290++) {\n                if (slt32(sext_i64_i32(i_83290), stopping_point_83289 - 1)) {\n                    eta_p_83284 = private_mem_83235[i_83290];\n                    \n                    int64_t defunc_0_op_res_83285 = add64(eta_p_83283, eta_p_83284);\n                    \n                    private_mem_83235[i_83290] = defunc_0_op_res_83285;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83291 = 0; i_83291 < chunk_sizze_83161; i_83291++) {\n                int64_t sharedIdx_83292 = sext_i32_i64(local_tid_83213) * chunk_sizze_83161 + i_83291;\n                int64_t tmp_83293 = private_mem_83235[i_83291];\n                \n                ((__local int64_t *) local_mem_83220)[sharedIdx_83292] = tmp_83293;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83294 = 0; i_83294 < chunk_sizze_83161; i_83294++) {\n                int64_t flat_idx_83295 = thd_offset_83237 + i_83294 * segscan_tblock_sizze_75077;\n                int64_t slice_83296 = n_48679;\n                int64_t gtid_75081 = flat_idx_83295;\n                int64_t remnant_83297 = flat_idx_83295 - gtid_75081;\n                \n                if (slt64(flat_idx_83295, n_48679)) {\n                    int64_t tmp_83298 = ((__local int64_t *) local_mem_83220)[flat_idx_832",
                                    "95 - block_offset_83231];\n                    \n                    ((__global int64_t *) mem_81954)[gtid_75081] = tmp_83298;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75077\n    #undef chunk_sizze_83161\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75098_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75098(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2080U_48682, int64_t dz2081U_48683, int64_t dz2082U_48684, int8_t clBase_48690, int8_t clBase_48691, double clBase_48698, double zt_res_61589, int64_t num_tblocks_75095, double d_haversine_res_81607, double d_haversine_res_81608, double d_haversine_res_81609, double d_haversine_res_81610, double cos_res_81611, double cos_res_81612, int64_t num_virt_blocks_83372, int64_t num_virt_threads_83373, __global unsigned char *clProc_mem_81933, __global unsigned char *clProc_mem_81934, __global unsigned char *clProc_mem_81935, __global unsigned char *clProc_mem_81936, __global unsigned char *mem_81979, __global unsigned char *mem_81981, __global unsigned char *mem_81983, __global unsigned char *mem_81985, __global unsigned char *mem_81995, __global unsigned char *mem_81997, __global unsigned char *mem_81998, __global unsigned char *mem_82000, __global unsigned char *status_flags_mem_83374, __global unsigned char *aggregates_mem_83376, __global unsigned char *incprefixes_mem_83378, __global unsigned char *global_dynid_mem_83380)\n{\n    #define segscan_tblock_sizze_75093 (do_DBSCAN_doublezisegscan_75098zisegscan_tblock_sizze_75093)\n    #define chunk_sizze_83371 (do_DBSCAN_doublezisegscan_75098zichunk_sizze_83371)\n    \n    volatile __local unsigned char *local_mem_83390_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83390_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75093), chunk_sizze_83371 * segscan_tblock_sizze_75093", " * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75093), chunk_sizze_83371 * segscan_tblock_sizze_75093 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83383;\n    int32_t tblock_sizze_83386;\n    int32_t wave_sizze_83385;\n    int32_t block_id_83384;\n    int32_t global_tid_83382;\n    int64_t phys_tid_75098;\n    int32_t chunk_sizze_32b_83387;\n    int64_t byte_offsets_83388;\n    int64_t warp_byte_offset_83389;\n    __local unsigned char *local_mem_83390;\n    int64_t trans_arr_len_83391;\n    int64_t phys_block_id_83397;\n    int64_t virtloop_bound_83398;\n    \n    local_tid_83383 = get_local_id(0);\n    tblock_sizze_83386 = get_local_size(0);\n    wave_sizze_83385 = LOCKSTEP_WIDTH;\n    block_id_83384 = get_tblock_id(0);\n    global_tid_83382 = block_id_83384 * tblock_sizze_83386 + local_tid_83383;\n    phys_tid_75098 = sext_i32_i64(global_tid_83382);\n    chunk_sizze_32b_83387 = sext_i64_i32(chunk_sizze_83371);\n    byte_offsets_83388 = segscan_tblock_sizze_75093 * (int64_t) 8;\n    warp_byte_offset_83389 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83390 = (__local unsigned char *) local_mem_83390_backing_0;\n    trans_arr_len_83391 = chunk_sizze_83371 * segscan_tblock_sizze_75093;\n    phys_block_id_83397 = get_tblock_id(0);\n    virtloop_bound_83398 = sdiv_up64(num_virt_blocks_83372 - phys_block_id_83397, num_tblocks_75095);\n    for (int64_t virtloop_i_83399 = 0; virtloop_i_83399 < virtloop_bound_83398; virtloop_i_83399++) {\n        int64_t dynamic_id_83400;\n        int64_t block_offset_83401;\n        int64_t sgm_idx_83402;\n        int32_t boundary_83403;\n        int32_t segsizze_compact_83404;\n        int64_t private_mem_83405[chunk_siz", "ze_83371];\n        int64_t thd_offset_83407;\n        int64_t acc_83423;\n        int64_t prefix_83433;\n        bool block_new_sgm_83434;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83383 == 0) {\n                dynamic_id_83400 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83380)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83390)[(int64_t) 0] = dynamic_id_83400;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83400 == num_virt_blocks_83372 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83380)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83400 = ((__local int32_t *) local_mem_83390)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83401 = dynamic_id_83400 * chunk_sizze_83371 * segscan_tblock_sizze_75093;\n        sgm_idx_83402 = smod64(block_offset_83401, dz2082U_48684);\n        boundary_83403 = sext_i64_i32(smin64(chunk_sizze_83371 * segscan_tblock_sizze_75093, dz2082U_48684 - sgm_idx_83402));\n        segsizze_compact_83404 = sext_i64_i32(smin64(chunk_sizze_83371 * segscan_tblock_sizze_75093, dz2082U_48684));\n        thd_offset_83407 = block_offset_83401 + sext_i32_i64(local_tid_83383);\n        // Load and map\n        {\n            for (int64_t i_83408 = 0; i_83408 < chunk_sizze_83371; i_83408++) {\n                int64_t virt_tid_83409 = thd_offset_83407 + i_83408 * segscan_tblock_sizze_75093;\n                int64_t slice_83410 = dz2082U_48684;\n                int64_t gtid_75097 = virt_tid_83409;\n                int64_t remnant_83411 = virt_tid_83409 - gtid_75097;\n                \n                if (slt64(virt_tid_83409, dz2082U_48",
                                    "684)) {\n                    bool y_64885 = slt64(gtid_75097, dz2080U_48682);\n                    bool index_certs_64887;\n                    \n                    if (!y_64885) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                                global_failure_args[0] = (int64_t) gtid_75097;\n                                global_failure_args[1] = (int64_t) dz2080U_48682;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    bool y_64889 = slt64(gtid_75097, dz2081U_48683);\n                    bool index_certs_64891;\n                    \n                    if (!y_64889) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                                global_failure_args[0] = (int64_t) gtid_75097;\n                                global_failure_args[1] = (int64_t) dz2081U_48683;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    double isWithinMargins_arg3_81603 = ((__global double *) mem_81983)[(int64_t) 0];\n                    double isWithinMargins_arg2_81604 = ((__global double *) mem_81979)[(int64_t) 0];\n                    double isWithinMargins_arg1_81605 = ((__global double *) mem_81985)[(int64_t) 0];\n                    double isWithinMargins_arg0_81606 = ((__global double *) mem_81981)[(int64_t) 0];\n                    double lifted_lambda_res_64883 = ((__global double *) clProc_mem_81935)[gtid_75097];\n                    double lifted_lambda_res_64884 = ((__global double *) clProc_mem_81936)[gtid_75097];\n                    bool tmp_64888", " = ((__global bool *) clProc_mem_81933)[gtid_75097];\n                    int64_t tmp_64892 = ((__global int64_t *) clProc_mem_81934)[gtid_75097];\n                    bool zgze_res_64897 = isWithinMargins_arg1_81605 <= lifted_lambda_res_64884;\n                    bool zlze_res_64898 = lifted_lambda_res_64884 <= isWithinMargins_arg3_81603;\n                    bool x_64899 = zgze_res_64897 && zlze_res_64898;\n                    double dist_res_64900;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_66166 = lifted_lambda_res_64883 == isWithinMargins_arg0_81606;\n                        double d_euclidean_res_66167;\n                        \n                        if (zeze_res_66166) {\n                            double zm_res_66168 = lifted_lambda_res_64884 - lifted_lambda_res_64884;\n                            double abs_res_66169 = fabs64(zm_res_66168);\n                            \n                            d_euclidean_res_66167 = abs_res_66169;\n                        } else {\n                            double zm_res_66170 = lifted_lambda_res_64883 - isWithinMargins_arg0_81606;\n                            double abs_res_66171 = fabs64(zm_res_66170);\n                            \n                            d_euclidean_res_66167 = abs_res_66171;\n                        }\n                        dist_res_64900 = d_euclidean_res_66167;\n                    } else {\n                        double d_haversine_res_64907;\n                        double d_haversine_res_64908;\n                        double d_haversine_res_64909;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64907 = lifted_lambda_res_64883;\n                            d_haversine_res_64908 = lifted_lambda_res_64884;\n                            d_haversine_res_64909 = lifted_lambda_res_64884;\n                        } else {\n                            double zt_res_6", "4910 = 3.141592653589793 * lifted_lambda_res_64883;\n                            double zs_res_64911 = zt_res_64910 / 180.0;\n                            double zt_res_64912 = 3.141592653589793 * lifted_lambda_res_64884;\n                            double zs_res_64913 = zt_res_64912 / 180.0;\n                            \n                            d_haversine_res_64907 = zs_res_64911;\n                            d_haversine_res_64908 = zs_res_64913;\n                            d_haversine_res_64909 = zs_res_64913;\n                        }\n                        \n                        double zm_res_64914 = d_haversine_res_64907 - d_haversine_res_81607;\n                        double cos_res_64915 = futrts_cos64(zm_res_64914);\n                        double zm_res_64916 = 1.0 - cos_res_64915;\n                        double cos_res_64917 = futrts_cos64(d_haversine_res_64907);\n                        double zt_res_64918 = cos_res_64917 * cos_res_81611;\n                        double zm_res_64919 = d_haversine_res_64908 - d_haversine_res_64909;\n                        double zm_res_64920 = 1.0 - zm_res_64919;\n                        double zt_res_64921 = zt_res_64918 * zm_res_64920;\n                        double zp_res_64922 = zm_res_64916 + zt_res_64921;\n                        double zs_res_64923 = zp_res_64922 / 2.0;\n                        double min_res_64924 = fmin64(1.0, zs_res_64923);\n                        double zt_res_64925 = 2.0 * min_res_64924;\n                        double zm_res_64926 = 1.0 - zt_res_64925;\n                        double acos_res_64927 = futrts_acos64(zm_res_64926);\n                        double zt_res_64928 = clBase_48698 * acos_res_64927;\n                        \n                        dist_res_64900 = zt_res_64928;\n                    }\n                    \n                    bool zlze_res_64929 = dist_res_64900 <= zt_res_61589;\n                    double dist_res_64930;\n                    \n                    if (clBase_48691 =",
                                    "= (int8_t) 0) {\n                        bool zeze_res_66174 = lifted_lambda_res_64883 == isWithinMargins_arg2_81604;\n                        double d_euclidean_res_66175;\n                        \n                        if (zeze_res_66174) {\n                            double zm_res_66176 = lifted_lambda_res_64884 - lifted_lambda_res_64884;\n                            double abs_res_66177 = fabs64(zm_res_66176);\n                            \n                            d_euclidean_res_66175 = abs_res_66177;\n                        } else {\n                            double zm_res_66178 = lifted_lambda_res_64883 - isWithinMargins_arg2_81604;\n                            double abs_res_66179 = fabs64(zm_res_66178);\n                            \n                            d_euclidean_res_66175 = abs_res_66179;\n                        }\n                        dist_res_64930 = d_euclidean_res_66175;\n                    } else {\n                        double d_haversine_res_64937;\n                        double d_haversine_res_64938;\n                        double d_haversine_res_64939;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64937 = lifted_lambda_res_64883;\n                            d_haversine_res_64938 = lifted_lambda_res_64884;\n                            d_haversine_res_64939 = lifted_lambda_res_64884;\n                        } else {\n                            double zt_res_64940 = 3.141592653589793 * lifted_lambda_res_64883;\n                            double zs_res_64941 = zt_res_64940 / 180.0;\n                            double zt_res_64942 = 3.141592653589793 * lifted_lambda_res_64884;\n                            double zs_res_64943 = zt_res_64942 / 180.0;\n                            \n                            d_haversine_res_64937 = zs_res_64941;\n                            d_haversine_res_64938 = zs_res_64943;\n                            d_haversine_res_64939 = zs_res_", "64943;\n                        }\n                        \n                        double zm_res_64944 = d_haversine_res_64937 - d_haversine_res_81608;\n                        double cos_res_64945 = futrts_cos64(zm_res_64944);\n                        double zm_res_64946 = 1.0 - cos_res_64945;\n                        double cos_res_64947 = futrts_cos64(d_haversine_res_64937);\n                        double zt_res_64948 = cos_res_64947 * cos_res_81612;\n                        double zm_res_64949 = d_haversine_res_64938 - d_haversine_res_64939;\n                        double zm_res_64950 = 1.0 - zm_res_64949;\n                        double zt_res_64951 = zt_res_64948 * zm_res_64950;\n                        double zp_res_64952 = zm_res_64946 + zt_res_64951;\n                        double zs_res_64953 = zp_res_64952 / 2.0;\n                        double min_res_64954 = fmin64(1.0, zs_res_64953);\n                        double zt_res_64955 = 2.0 * min_res_64954;\n                        double zm_res_64956 = 1.0 - zt_res_64955;\n                        double acos_res_64957 = futrts_acos64(zm_res_64956);\n                        double zt_res_64958 = clBase_48698 * acos_res_64957;\n                        \n                        dist_res_64930 = zt_res_64958;\n                    }\n                    \n                    bool zlze_res_64959 = dist_res_64930 <= zt_res_61589;\n                    bool x_64960 = !zlze_res_64929;\n                    bool y_64961 = zlze_res_64959 && x_64960;\n                    bool cond_t_res_64962 = zlze_res_64929 || y_64961;\n                    bool x_64963 = x_64899 && cond_t_res_64962;\n                    bool zgze_res_64964 = isWithinMargins_arg0_81606 <= lifted_lambda_res_64883;\n                    bool zlze_res_64965 = lifted_lambda_res_64883 <= isWithinMargins_arg2_81604;\n                    bool x_64966 = zgze_res_64964 && zlze_res_64965;\n                    double dist_res_64967;\n                    \n                    if (clBase_48691 ", "== (int8_t) 0) {\n                        double zm_res_66180 = lifted_lambda_res_64884 - isWithinMargins_arg1_81605;\n                        double abs_res_66181 = fabs64(zm_res_66180);\n                        \n                        dist_res_64967 = abs_res_66181;\n                    } else {\n                        double d_haversine_res_64970;\n                        double d_haversine_res_64971;\n                        double d_haversine_res_64972;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64970 = lifted_lambda_res_64883;\n                            d_haversine_res_64971 = lifted_lambda_res_64884;\n                            d_haversine_res_64972 = lifted_lambda_res_64883;\n                        } else {\n                            double zt_res_64973 = 3.141592653589793 * lifted_lambda_res_64883;\n                            double zs_res_64974 = zt_res_64973 / 180.0;\n                            double zt_res_64975 = 3.141592653589793 * lifted_lambda_res_64884;\n                            double zs_res_64976 = zt_res_64975 / 180.0;\n                            \n                            d_haversine_res_64970 = zs_res_64974;\n                            d_haversine_res_64971 = zs_res_64976;\n                            d_haversine_res_64972 = zs_res_64974;\n                        }\n                        \n                        double zm_res_64977 = d_haversine_res_64970 - d_haversine_res_64972;\n                        double cos_res_64978 = futrts_cos64(zm_res_64977);\n                        double zm_res_64979 = 1.0 - cos_res_64978;\n                        double cos_res_64980 = futrts_cos64(d_haversine_res_64972);\n                        double cos_res_64981 = futrts_cos64(d_haversine_res_64970);\n                        double zt_res_64982 = cos_res_64980 * cos_res_64981;\n                        double zm_res_64983 = d_haversine_res_64971 - d_haversine_res_81609;\n          ",
                                    "              double zm_res_64984 = 1.0 - zm_res_64983;\n                        double zt_res_64985 = zt_res_64982 * zm_res_64984;\n                        double zp_res_64986 = zm_res_64979 + zt_res_64985;\n                        double zs_res_64987 = zp_res_64986 / 2.0;\n                        double min_res_64988 = fmin64(1.0, zs_res_64987);\n                        double zt_res_64989 = 2.0 * min_res_64988;\n                        double zm_res_64990 = 1.0 - zt_res_64989;\n                        double acos_res_64991 = futrts_acos64(zm_res_64990);\n                        double zt_res_64992 = clBase_48698 * acos_res_64991;\n                        \n                        dist_res_64967 = zt_res_64992;\n                    }\n                    \n                    bool zlze_res_64993 = dist_res_64967 <= zt_res_61589;\n                    double dist_res_64994;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double zm_res_66182 = lifted_lambda_res_64884 - isWithinMargins_arg3_81603;\n                        double abs_res_66183 = fabs64(zm_res_66182);\n                        \n                        dist_res_64994 = abs_res_66183;\n                    } else {\n                        double d_haversine_res_64997;\n                        double d_haversine_res_64998;\n                        double d_haversine_res_64999;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64997 = lifted_lambda_res_64883;\n                            d_haversine_res_64998 = lifted_lambda_res_64884;\n                            d_haversine_res_64999 = lifted_lambda_res_64883;\n                        } else {\n                            double zt_res_65000 = 3.141592653589793 * lifted_lambda_res_64883;\n                            double zs_res_65001 = zt_res_65000 / 180.0;\n                            double zt_res_65002 = 3.141592653589793 * lifted_lambda_res_64884;\n  ", "                          double zs_res_65003 = zt_res_65002 / 180.0;\n                            \n                            d_haversine_res_64997 = zs_res_65001;\n                            d_haversine_res_64998 = zs_res_65003;\n                            d_haversine_res_64999 = zs_res_65001;\n                        }\n                        \n                        double zm_res_65004 = d_haversine_res_64997 - d_haversine_res_64999;\n                        double cos_res_65005 = futrts_cos64(zm_res_65004);\n                        double zm_res_65006 = 1.0 - cos_res_65005;\n                        double cos_res_65007 = futrts_cos64(d_haversine_res_64999);\n                        double cos_res_65008 = futrts_cos64(d_haversine_res_64997);\n                        double zt_res_65009 = cos_res_65007 * cos_res_65008;\n                        double zm_res_65010 = d_haversine_res_64998 - d_haversine_res_81610;\n                        double zm_res_65011 = 1.0 - zm_res_65010;\n                        double zt_res_65012 = zt_res_65009 * zm_res_65011;\n                        double zp_res_65013 = zm_res_65006 + zt_res_65012;\n                        double zs_res_65014 = zp_res_65013 / 2.0;\n                        double min_res_65015 = fmin64(1.0, zs_res_65014);\n                        double zt_res_65016 = 2.0 * min_res_65015;\n                        double zm_res_65017 = 1.0 - zt_res_65016;\n                        double acos_res_65018 = futrts_acos64(zm_res_65017);\n                        double zt_res_65019 = clBase_48698 * acos_res_65018;\n                        \n                        dist_res_64994 = zt_res_65019;\n                    }\n                    \n                    bool zlze_res_65020 = dist_res_64994 <= zt_res_61589;\n                    bool x_65021 = !zlze_res_64993;\n                    bool y_65022 = zlze_res_65020 && x_65021;\n                    bool cond_f_res_t_res_65023 = zlze_res_64993 || y_65022;\n                    bool x_65024 = x_64966 && co", "nd_f_res_t_res_65023;\n                    bool x_65025 = !x_64963;\n                    bool y_65026 = x_65024 && x_65025;\n                    bool cond_65027 = x_64963 || y_65026;\n                    bool zlze_res_65028 = lifted_lambda_res_64883 <= isWithinMargins_arg0_81606;\n                    double corn_x_65029;\n                    \n                    if (zlze_res_65028) {\n                        corn_x_65029 = isWithinMargins_arg0_81606;\n                    } else {\n                        corn_x_65029 = isWithinMargins_arg2_81604;\n                    }\n                    \n                    bool zlze_res_65030 = lifted_lambda_res_64884 <= isWithinMargins_arg1_81605;\n                    double corn_y_65031;\n                    \n                    if (zlze_res_65030) {\n                        corn_y_65031 = isWithinMargins_arg1_81605;\n                    } else {\n                        corn_y_65031 = isWithinMargins_arg3_81603;\n                    }\n                    \n                    double dist_res_65032;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool eq_x_y_66188 = lifted_lambda_res_64883 == isWithinMargins_arg0_81606;\n                        bool eq_x_zz_66189 = lifted_lambda_res_64883 == isWithinMargins_arg2_81604;\n                        bool p_and_eq_x_y_66190 = zlze_res_65028 && eq_x_y_66188;\n                        bool not_p_66191 = !zlze_res_65028;\n                        bool p_and_eq_x_y_66192 = eq_x_zz_66189 && not_p_66191;\n                        bool zeze_res_66193 = p_and_eq_x_y_66190 || p_and_eq_x_y_66192;\n                        double d_euclidean_res_66194;\n                        \n                        if (zeze_res_66193) {\n                            double zm_res_66195 = lifted_lambda_res_64884 - corn_y_65031;\n                            double abs_res_66196 = fabs64(zm_res_66195);\n                            \n                            d_euclidean_res_66194 = abs_res_66",
                                    "196;\n                        } else {\n                            bool eq_x_y_66197 = lifted_lambda_res_64884 == isWithinMargins_arg1_81605;\n                            bool eq_x_zz_66198 = lifted_lambda_res_64884 == isWithinMargins_arg3_81603;\n                            bool p_and_eq_x_y_66199 = zlze_res_65030 && eq_x_y_66197;\n                            bool not_p_66200 = !zlze_res_65030;\n                            bool p_and_eq_x_y_66201 = eq_x_zz_66198 && not_p_66200;\n                            bool zeze_res_66202 = p_and_eq_x_y_66199 || p_and_eq_x_y_66201;\n                            double d_euclidean_res_f_res_66203;\n                            \n                            if (zeze_res_66202) {\n                                double zm_res_66204 = lifted_lambda_res_64883 - corn_x_65029;\n                                double abs_res_66205 = fabs64(zm_res_66204);\n                                \n                                d_euclidean_res_f_res_66203 = abs_res_66205;\n                            } else {\n                                double zm_res_66206 = lifted_lambda_res_64884 - corn_y_65031;\n                                double zm_res_66207 = lifted_lambda_res_64883 - corn_x_65029;\n                                double hypot_res_66208 = futrts_hypot64(zm_res_66207, zm_res_66206);\n                                \n                                d_euclidean_res_f_res_66203 = hypot_res_66208;\n                            }\n                            d_euclidean_res_66194 = d_euclidean_res_f_res_66203;\n                        }\n                        dist_res_65032 = d_euclidean_res_66194;\n                    } else {\n                        double d_haversine_res_65054;\n                        double d_haversine_res_65055;\n                        double d_haversine_res_65056;\n                        double d_haversine_res_65057;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversin", "e_res_65054 = lifted_lambda_res_64883;\n                            d_haversine_res_65055 = lifted_lambda_res_64884;\n                            d_haversine_res_65056 = corn_x_65029;\n                            d_haversine_res_65057 = corn_y_65031;\n                        } else {\n                            double zt_res_65058 = 3.141592653589793 * lifted_lambda_res_64883;\n                            double zs_res_65059 = zt_res_65058 / 180.0;\n                            double zt_res_65060 = 3.141592653589793 * lifted_lambda_res_64884;\n                            double zs_res_65061 = zt_res_65060 / 180.0;\n                            double zt_res_65062 = 3.141592653589793 * corn_x_65029;\n                            double zs_res_65063 = zt_res_65062 / 180.0;\n                            double zt_res_65064 = 3.141592653589793 * corn_y_65031;\n                            double zs_res_65065 = zt_res_65064 / 180.0;\n                            \n                            d_haversine_res_65054 = zs_res_65059;\n                            d_haversine_res_65055 = zs_res_65061;\n                            d_haversine_res_65056 = zs_res_65063;\n                            d_haversine_res_65057 = zs_res_65065;\n                        }\n                        \n                        double zm_res_65066 = d_haversine_res_65054 - d_haversine_res_65056;\n                        double cos_res_65067 = futrts_cos64(zm_res_65066);\n                        double zm_res_65068 = 1.0 - cos_res_65067;\n                        double cos_res_65069 = futrts_cos64(d_haversine_res_65056);\n                        double cos_res_65070 = futrts_cos64(d_haversine_res_65054);\n                        double zt_res_65071 = cos_res_65069 * cos_res_65070;\n                        double zm_res_65072 = d_haversine_res_65055 - d_haversine_res_65057;\n                        double zm_res_65073 = 1.0 - zm_res_65072;\n                        double zt_res_65074 = zt_res_65071 * zm_res_65073;\n               ", "         double zp_res_65075 = zm_res_65068 + zt_res_65074;\n                        double zs_res_65076 = zp_res_65075 / 2.0;\n                        double min_res_65077 = fmin64(1.0, zs_res_65076);\n                        double zt_res_65078 = 2.0 * min_res_65077;\n                        double zm_res_65079 = 1.0 - zt_res_65078;\n                        double acos_res_65080 = futrts_acos64(zm_res_65079);\n                        double zt_res_65081 = clBase_48698 * acos_res_65080;\n                        \n                        dist_res_65032 = zt_res_65081;\n                    }\n                    \n                    bool zlze_res_65082 = dist_res_65032 <= zt_res_61589;\n                    bool x_65083 = !cond_65027;\n                    bool y_65084 = zlze_res_65082 && x_65083;\n                    bool is_pt_marginal_res_65085 = cond_65027 || y_65084;\n                    int64_t defunc_0_f_res_65086 = btoi_bool_i64(is_pt_marginal_res_65085);\n                    \n                    ((__global int64_t *) mem_81997)[gtid_75097] = defunc_0_f_res_65086;\n                    ((__global bool *) mem_81998)[gtid_75097] = tmp_64888;\n                    ((__global int64_t *) mem_82000)[gtid_75097] = tmp_64892;\n                    private_mem_83405[i_83408] = defunc_0_f_res_65086;\n                } else {\n                    private_mem_83405[i_83408] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83412 = 0; i_83412 < chunk_sizze_83371; i_83412++) {\n                int64_t sharedIdx_83413 = sext_i32_i64(local_tid_83383) + i_83412 * segscan_tblock_sizze_75093;\n                int64_t tmp_83414 = private_mem_83405[i_83412];\n                \n                ((__local int64_t *) local_mem_83390)[sharedIdx_83413] = tmp_83414;\n            }\n            bar",
                                    "rier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83415 = 0; i_83415 < chunk_sizze_83371; i_83415++) {\n                int64_t sharedIdx_83416 = sext_i32_i64(local_tid_83383) * chunk_sizze_83371 + i_83415;\n                int64_t tmp_83417 = ((__local int64_t *) local_mem_83390)[sharedIdx_83416];\n                \n                private_mem_83405[i_83415] = tmp_83417;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83418 = 0; i_83418 < chunk_sizze_83371 - (int64_t) 1; i_83418++) {\n                int64_t eta_p_61875;\n                int64_t eta_p_61876;\n                \n                eta_p_61875 = private_mem_83405[i_83418];\n                eta_p_61876 = private_mem_83405[i_83418 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_61877 = add64(eta_p_61875, eta_p_61876);\n                \n                private_mem_83405[i_83418 + (int64_t) 1] = defunc_0_op_res_61877;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83419 = private_mem_83405[chunk_sizze_83371 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = tmp_83419;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83420;\n            int64_t eta_p_83421;\n            int64_t eta_p_83424;\n            int64_t eta_p_83425;\n            bool ltid_in_bounds_83427 = slt64(sext_i32_i64(local_tid_83383), num_virt_threads_83373);\n            int32_t skip_threads_83428;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83427) {\n                    eta_p_83421 = ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)];\n                    if ((local_tid_83383 - squot32(local_tid_83383, 32) * 32) == 0) {\n                        eta_p_83420 = eta_p_83421;", "\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83428 = 1;\n                while (slt32(skip_threads_83428, 32)) {\n                    bool thread_active_83429 = sle32(skip_threads_83428, local_tid_83383 - squot32(local_tid_83383, 32) * 32) && ltid_in_bounds_83427;\n                    \n                    if (thread_active_83429) {\n                        // read operands\n                        {\n                            eta_p_83420 = ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383) - sext_i32_i64(skip_threads_83428)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83429) {\n                            int64_t defunc_0_op_res_83422 = add64(eta_p_83420, eta_p_83421);\n                            \n                            eta_p_83420 = defunc_0_op_res_83422;\n                        }\n                    }\n                    if (sle32(wave_sizze_83385, skip_threads_83428)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83429) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = eta_p_83420;\n                            eta_p_83421 = eta_p_83420;\n                        }\n                    }\n                    if (sle32(wave_sizze_83385, skip_threads_83428)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83428 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83383 - squot32(local_tid_83383, 32) * 32) == 31 && ltid_in_bounds_83", "427) {\n                    ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(squot32(local_tid_83383, 32))] = eta_p_83420;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83430;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83383, 32) == 0 && ltid_in_bounds_83427) {\n                        eta_p_83425 = ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)];\n                        if ((local_tid_83383 - squot32(local_tid_83383, 32) * 32) == 0) {\n                            eta_p_83424 = eta_p_83425;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83430 = 1;\n                    while (slt32(skip_threads_83430, 32)) {\n                        bool thread_active_83431 = sle32(skip_threads_83430, local_tid_83383 - squot32(local_tid_83383, 32) * 32) && (squot32(local_tid_83383, 32) == 0 && ltid_in_bounds_83427);\n                        \n                        if (thread_active_83431) {\n                            // read operands\n                            {\n                                eta_p_83424 = ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383) - sext_i32_i64(skip_threads_83430)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83431) {\n                                int64_t defunc_0_op_res_83426 = add64(eta_p_83424, eta_p_83425);\n                                \n                                eta_p_83424 = defunc_0_op_res_83426;\n                            }\n                        }\n                 ",
                                    "       if (sle32(wave_sizze_83385, skip_threads_83430)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83431) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = eta_p_83424;\n                                eta_p_83425 = eta_p_83424;\n                            }\n                        }\n                        if (sle32(wave_sizze_83385, skip_threads_83430)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83430 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83432 = squot32(local_tid_83383, 32) == 0 || !ltid_in_bounds_83427;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83432) {\n                        eta_p_83421 = eta_p_83420;\n                        eta_p_83420 = ((__local int64_t *) local_mem_83390)[sext_i32_i64(squot32(local_tid_83383, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83432) {\n                        int64_t defunc_0_op_res_83422 = add64(eta_p_83420, eta_p_83421);\n                        \n                        eta_p_83420 = defunc_0_op_res_83422;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83432) {\n                        ((__local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = eta_p_83420;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first bl", "ock\n            {\n                if (squot32(local_tid_83383, 32) == 0 && ltid_in_bounds_83427) {\n                    ((__local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = eta_p_83421;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83383 == 0) {\n                acc_83423 = ((__local int64_t *) local_mem_83390)[segscan_tblock_sizze_75093 - (int64_t) 1];\n            } else {\n                acc_83423 = ((__local int64_t *) local_mem_83390)[sext_i32_i64(local_tid_83383) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83433 = (int64_t) 0;\n        block_new_sgm_83434 = sgm_idx_83402 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83434 && local_tid_83383 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83378)[dynamic_id_83400] = acc_83423;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83374)[dynamic_id_83400] = (int8_t) 2;\n                acc_83423 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83434 && slt32(local_tid_83383, wave_sizze_83385)) {\n                if (local_tid_83383 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83376)[dynamic_id_83400] = acc_83423;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83374)[dynamic_id_83400] = (int8_t) 1;\n                    \n                    int8_t tmp_83435 = ((volatile __global int8_t *) status_flags_mem_83374)[dynamic_id_83400 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83390)[(int64_t) 0] = tmp_83435;\n                }\n                mem_fence_local();\n                \n                int8_t status_83436 = ((__local int8_t *) local_mem_83390)[(int64_t) 0];\n                \n                if (status_8", "3436 == (int8_t) 2) {\n                    if (local_tid_83383 == 0) {\n                        prefix_83433 = ((volatile __global int64_t *) incprefixes_mem_83378)[dynamic_id_83400 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83437 = sext_i64_i32(dynamic_id_83400 - sext_i32_i64(wave_sizze_83385));\n                    \n                    while (slt32(wave_sizze_83385 * -1, readOffset_83437)) {\n                        int32_t read_i_83438 = readOffset_83437 + local_tid_83383;\n                        int64_t aggr_83439 = (int64_t) 0;\n                        int8_t flag_83440 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83438)) {\n                            flag_83440 = ((volatile __global int8_t *) status_flags_mem_83374)[sext_i32_i64(read_i_83438)];\n                            if (flag_83440 == (int8_t) 2) {\n                                aggr_83439 = ((volatile __global int64_t *) incprefixes_mem_83378)[sext_i32_i64(read_i_83438)];\n                            } else if (flag_83440 == (int8_t) 1) {\n                                aggr_83439 = ((volatile __global int64_t *) aggregates_mem_83376)[sext_i32_i64(read_i_83438)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83390)[(int64_t) 4 + sext_i32_i64(local_tid_83383)] = aggr_83439;\n                        ((__local int8_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = flag_83440;\n                        flag_83440 = ((__local int8_t *) local_mem_83390)[sext_i32_i64(wave_sizze_83385) - (int64_t) 1];\n                        if (slt8(flag_83440, (int8_t) 2)) {\n                            int8_t flg_x_83444;\n                            int8_t flg_y_83445;\n                            int64_t eta_p_83441;\n                            int64_t eta_p_83442;\n                            int32_t skip_threads_83446;\n                            \n                      ",
                                    "      // read input for in-block scan\n                            {\n                                flg_y_83445 = ((volatile __local int8_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)];\n                                eta_p_83442 = ((volatile __local int64_t *) local_mem_83390)[(int64_t) 4 + sext_i32_i64(local_tid_83383)];\n                                if ((local_tid_83383 - squot32(local_tid_83383, 32) * 32) == 0) {\n                                    eta_p_83441 = eta_p_83442;\n                                    flg_x_83444 = flg_y_83445;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83446 = 1;\n                                while (slt32(skip_threads_83446, 32)) {\n                                    if (sle32(skip_threads_83446, local_tid_83383 - squot32(local_tid_83383, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83444 = ((volatile __local int8_t *) local_mem_83390)[sext_i32_i64(local_tid_83383) - sext_i32_i64(skip_threads_83446)];\n                                            eta_p_83441 = ((volatile __local int64_t *) local_mem_83390)[(int64_t) 4 + (sext_i32_i64(local_tid_83383) - sext_i32_i64(skip_threads_83446))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83445 == (int8_t) 2 || flg_y_83445 == (int8_t) 0) {\n                                                flg_x_83444 = flg_y_83445;\n                                                eta_p_83441 = eta_p_83442;\n                                            } else {\n                                                int64_t defunc_0_op_res_83443 = add64(eta_p_83441, eta_p_83442);\n", "                                                \n                                                eta_p_83441 = defunc_0_op_res_83443;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83390)[sext_i32_i64(local_tid_83383)] = flg_x_83444;\n                                            flg_y_83445 = flg_x_83444;\n                                            ((volatile __local int64_t *) local_mem_83390)[(int64_t) 4 + sext_i32_i64(local_tid_83383)] = eta_p_83441;\n                                            eta_p_83442 = eta_p_83441;\n                                        }\n                                    }\n                                    skip_threads_83446 *= 2;\n                                }\n                            }\n                        }\n                        flag_83440 = ((__local int8_t *) local_mem_83390)[sext_i32_i64(wave_sizze_83385) - (int64_t) 1];\n                        aggr_83439 = ((__local int64_t *) local_mem_83390)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83385) - (int64_t) 1)];\n                        if (flag_83440 == (int8_t) 2) {\n                            readOffset_83437 = wave_sizze_83385 * -1;\n                        } else if (flag_83440 == (int8_t) 1) {\n                            readOffset_83437 -= wave_sizze_83385;\n                        }\n                        if (slt8((int8_t) 0, flag_83440)) {\n                            int64_t eta_p_83447 = aggr_83439;\n                            int64_t eta_p_83448 = prefix_83433;\n                            int64_t defunc_0_op_res_83449 = add64(eta_p_83447, eta_p_83448);\n                            \n                            prefix_83433 = defunc_0_op_res_83449;\n                        }\n                        mem_fence_local();\n                    }\n               ", " }\n                if (local_tid_83383 == 0) {\n                    if (boundary_83403 == sext_i64_i32(segscan_tblock_sizze_75093 * chunk_sizze_83371)) {\n                        int64_t eta_p_83450 = prefix_83433;\n                        int64_t eta_p_83451 = acc_83423;\n                        int64_t defunc_0_op_res_83452 = add64(eta_p_83450, eta_p_83451);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83378)[dynamic_id_83400] = defunc_0_op_res_83452;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83374)[dynamic_id_83400] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83390)[(int64_t) 4] = prefix_83433;\n                    acc_83423 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83400 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83433 = ((__local int64_t *) local_mem_83390)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83453;\n            int64_t eta_p_83454;\n            int64_t eta_p_83456 = prefix_83433;\n            int64_t eta_p_83457 = acc_83423;\n            \n            if (slt32(local_tid_83383 * chunk_sizze_32b_83387, boundary_83403) && !block_new_sgm_83434) {\n                int64_t defunc_0_op_res_83458 = add64(eta_p_83456, eta_p_83457);\n                \n                eta_p_83453 = defunc_0_op_res_83458;\n            } else {\n                eta_p_83453 = acc_83423;\n            }\n            \n            int32_t stopping_point_83459 = segsizze_compact_83404 - srem32(local_tid_83383 * chunk_sizze_32b_83387 - 1 + segsizze_compact_83404 - boundary_83403, segsizze_compact_83404);\n            \n            for (int64_t i_83460 = 0; i_83460 < chunk_sizze_83371; i_83460++) {\n                if (slt32(sext_i64_i32(i_83460), stopping_point_",
                                    "83459 - 1)) {\n                    eta_p_83454 = private_mem_83405[i_83460];\n                    \n                    int64_t defunc_0_op_res_83455 = add64(eta_p_83453, eta_p_83454);\n                    \n                    private_mem_83405[i_83460] = defunc_0_op_res_83455;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83461 = 0; i_83461 < chunk_sizze_83371; i_83461++) {\n                int64_t sharedIdx_83462 = sext_i32_i64(local_tid_83383) * chunk_sizze_83371 + i_83461;\n                int64_t tmp_83463 = private_mem_83405[i_83461];\n                \n                ((__local int64_t *) local_mem_83390)[sharedIdx_83462] = tmp_83463;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83464 = 0; i_83464 < chunk_sizze_83371; i_83464++) {\n                int64_t flat_idx_83465 = thd_offset_83407 + i_83464 * segscan_tblock_sizze_75093;\n                int64_t slice_83466 = dz2082U_48684;\n                int64_t gtid_75097 = flat_idx_83465;\n                int64_t remnant_83467 = flat_idx_83465 - gtid_75097;\n                \n                if (slt64(flat_idx_83465, dz2082U_48684)) {\n                    int64_t tmp_83468 = ((__local int64_t *) local_mem_83390)[flat_idx_83465 - block_offset_83401];\n                    \n                    ((__global int64_t *) mem_81995)[gtid_75097] = tmp_83468;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75093\n    #undef chunk_sizze_83371\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75114_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75114(__global int *global_failure, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_61888, int64_t num_tblocks_75111, double d_haversine_res_81617, double d_haversine_res_81618, double d_haversine_res_81619, dou", "ble d_haversine_res_81620, double cos_res_81621, double cos_res_81622, int64_t num_virt_blocks_83488, int64_t num_virt_threads_83489, __global unsigned char *mem_81979, __global unsigned char *mem_81981, __global unsigned char *mem_81983, __global unsigned char *mem_81985, __global unsigned char *mem_82007, __global unsigned char *mem_82009, __global unsigned char *mem_82013, __global unsigned char *mem_82015, __global unsigned char *mem_82017, __global unsigned char *status_flags_mem_83490, __global unsigned char *aggregates_mem_83492, __global unsigned char *incprefixes_mem_83494, __global unsigned char *aggregates_mem_83496, __global unsigned char *incprefixes_mem_83498, __global unsigned char *global_dynid_mem_83500)\n{\n    #define segscan_tblock_sizze_75109 (do_DBSCAN_doublezisegscan_75114zisegscan_tblock_sizze_75109)\n    #define chunk_sizze_83487 (do_DBSCAN_doublezisegscan_75114zichunk_sizze_83487)\n    \n    volatile __local unsigned char *local_mem_83512_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83512_backing_0_offset = 0 + (smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75109, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75109), smax64(chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8, chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75109, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75109), smax64(chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8, chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83503;\n    int32_t tblock_sizze_83506;\n    int32_t wave_sizze_83505;\n    int32_t block_id_83504;\n    int32_t global_tid_83502;\n    int64_t phys_tid_75114;\n    int32_t chunk_sizze_32b_83507;\n    int64_t byte_offsets_83508;\n    int64_", "t byte_offsets_83509;\n    int64_t warp_byte_offset_83510;\n    int64_t warp_byte_offset_83511;\n    __local unsigned char *local_mem_83512;\n    int64_t trans_arr_len_83513;\n    int64_t phys_block_id_83522;\n    int64_t virtloop_bound_83523;\n    \n    local_tid_83503 = get_local_id(0);\n    tblock_sizze_83506 = get_local_size(0);\n    wave_sizze_83505 = LOCKSTEP_WIDTH;\n    block_id_83504 = get_tblock_id(0);\n    global_tid_83502 = block_id_83504 * tblock_sizze_83506 + local_tid_83503;\n    phys_tid_75114 = sext_i32_i64(global_tid_83502);\n    chunk_sizze_32b_83507 = sext_i64_i32(chunk_sizze_83487);\n    byte_offsets_83508 = segscan_tblock_sizze_75109 * (int64_t) 8;\n    byte_offsets_83509 = sdiv_up64(byte_offsets_83508, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_75109 * (int64_t) 8;\n    warp_byte_offset_83510 = (int64_t) 288;\n    warp_byte_offset_83511 = sdiv_up64(warp_byte_offset_83510, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83512 = (__local unsigned char *) local_mem_83512_backing_0;\n    trans_arr_len_83513 = chunk_sizze_83487 * segscan_tblock_sizze_75109;\n    phys_block_id_83522 = get_tblock_id(0);\n    virtloop_bound_83523 = sdiv_up64(num_virt_blocks_83488 - phys_block_id_83522, num_tblocks_75111);\n    for (int64_t virtloop_i_83524 = 0; virtloop_i_83524 < virtloop_bound_83523; virtloop_i_83524++) {\n        int64_t dynamic_id_83525;\n        int64_t block_offset_83526;\n        int64_t sgm_idx_83527;\n        int32_t boundary_83528;\n        int32_t segsizze_compact_83529;\n        int64_t private_mem_83530[chunk_sizze_83487];\n        int64_t private_mem_83532[chunk_sizze_83487];\n        int64_t thd_offset_83534;\n        int64_t acc_83560;\n        int64_t acc_83561;\n        int64_t prefix_83574;\n        int64_t prefix_83575;\n        bool block_new_sgm_83576;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83503 == 0) {\n                dynamic_id_83",
                                    "525 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83500)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83512)[(int64_t) 0] = dynamic_id_83525;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83525 == num_virt_blocks_83488 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83500)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83525 = ((__local int32_t *) local_mem_83512)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83526 = dynamic_id_83525 * chunk_sizze_83487 * segscan_tblock_sizze_75109;\n        sgm_idx_83527 = smod64(block_offset_83526, m_61888);\n        boundary_83528 = sext_i64_i32(smin64(chunk_sizze_83487 * segscan_tblock_sizze_75109, m_61888 - sgm_idx_83527));\n        segsizze_compact_83529 = sext_i64_i32(smin64(chunk_sizze_83487 * segscan_tblock_sizze_75109, m_61888));\n        thd_offset_83534 = block_offset_83526 + sext_i32_i64(local_tid_83503);\n        // Load and map\n        {\n            for (int64_t i_83535 = 0; i_83535 < chunk_sizze_83487; i_83535++) {\n                int64_t virt_tid_83536 = thd_offset_83534 + i_83535 * segscan_tblock_sizze_75109;\n                int64_t slice_83537 = m_61888;\n                int64_t gtid_75113 = virt_tid_83536;\n                int64_t remnant_83538 = virt_tid_83536 - gtid_75113;\n                \n                if (slt64(virt_tid_83536, m_61888)) {\n                    double isWithinMargins_arg3_81613 = ((__global double *) mem_81983)[(int64_t) 0];\n                    double isWithinMargins_arg2_81614 = ((__global double *) mem_81979)[(int64_t) 0];\n                    double isWithinMargins_arg1_81615 = ((__global double *) mem_81985)[(int64_t) 0];\n     ", "               double isWithinMargins_arg0_81616 = ((__global double *) mem_81981)[(int64_t) 0];\n                    double x_64465 = ((__global double *) mem_82009)[gtid_75113];\n                    double x_64466 = ((__global double *) mem_82007)[gtid_75113];\n                    bool zgze_res_64467 = isWithinMargins_arg1_81615 <= x_64466;\n                    bool zlze_res_64468 = x_64466 <= isWithinMargins_arg3_81613;\n                    bool x_64469 = zgze_res_64467 && zlze_res_64468;\n                    double dist_res_64470;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_66213 = x_64465 == isWithinMargins_arg0_81616;\n                        double d_euclidean_res_66214;\n                        \n                        if (zeze_res_66213) {\n                            double zm_res_66215 = x_64466 - x_64466;\n                            double abs_res_66216 = fabs64(zm_res_66215);\n                            \n                            d_euclidean_res_66214 = abs_res_66216;\n                        } else {\n                            double zm_res_66217 = x_64465 - isWithinMargins_arg0_81616;\n                            double abs_res_66218 = fabs64(zm_res_66217);\n                            \n                            d_euclidean_res_66214 = abs_res_66218;\n                        }\n                        dist_res_64470 = d_euclidean_res_66214;\n                    } else {\n                        double d_haversine_res_64477;\n                        double d_haversine_res_64478;\n                        double d_haversine_res_64479;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64477 = x_64465;\n                            d_haversine_res_64478 = x_64466;\n                            d_haversine_res_64479 = x_64466;\n                        } else {\n                            double zt_res_64480 = 3.141592653589793 * x_", "64465;\n                            double zs_res_64481 = zt_res_64480 / 180.0;\n                            double zt_res_64482 = 3.141592653589793 * x_64466;\n                            double zs_res_64483 = zt_res_64482 / 180.0;\n                            \n                            d_haversine_res_64477 = zs_res_64481;\n                            d_haversine_res_64478 = zs_res_64483;\n                            d_haversine_res_64479 = zs_res_64483;\n                        }\n                        \n                        double zm_res_64484 = d_haversine_res_64477 - d_haversine_res_81617;\n                        double cos_res_64485 = futrts_cos64(zm_res_64484);\n                        double zm_res_64486 = 1.0 - cos_res_64485;\n                        double cos_res_64487 = futrts_cos64(d_haversine_res_64477);\n                        double zt_res_64488 = cos_res_64487 * cos_res_81621;\n                        double zm_res_64489 = d_haversine_res_64478 - d_haversine_res_64479;\n                        double zm_res_64490 = 1.0 - zm_res_64489;\n                        double zt_res_64491 = zt_res_64488 * zm_res_64490;\n                        double zp_res_64492 = zm_res_64486 + zt_res_64491;\n                        double zs_res_64493 = zp_res_64492 / 2.0;\n                        double min_res_64494 = fmin64(1.0, zs_res_64493);\n                        double zt_res_64495 = 2.0 * min_res_64494;\n                        double zm_res_64496 = 1.0 - zt_res_64495;\n                        double acos_res_64497 = futrts_acos64(zm_res_64496);\n                        double zt_res_64498 = clBase_48698 * acos_res_64497;\n                        \n                        dist_res_64470 = zt_res_64498;\n                    }\n                    \n                    bool zlze_res_64499 = dist_res_64470 <= clBase_48692;\n                    double dist_res_64500;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_66221 =",
                                    " x_64465 == isWithinMargins_arg2_81614;\n                        double d_euclidean_res_66222;\n                        \n                        if (zeze_res_66221) {\n                            double zm_res_66223 = x_64466 - x_64466;\n                            double abs_res_66224 = fabs64(zm_res_66223);\n                            \n                            d_euclidean_res_66222 = abs_res_66224;\n                        } else {\n                            double zm_res_66225 = x_64465 - isWithinMargins_arg2_81614;\n                            double abs_res_66226 = fabs64(zm_res_66225);\n                            \n                            d_euclidean_res_66222 = abs_res_66226;\n                        }\n                        dist_res_64500 = d_euclidean_res_66222;\n                    } else {\n                        double d_haversine_res_64507;\n                        double d_haversine_res_64508;\n                        double d_haversine_res_64509;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64507 = x_64465;\n                            d_haversine_res_64508 = x_64466;\n                            d_haversine_res_64509 = x_64466;\n                        } else {\n                            double zt_res_64510 = 3.141592653589793 * x_64465;\n                            double zs_res_64511 = zt_res_64510 / 180.0;\n                            double zt_res_64512 = 3.141592653589793 * x_64466;\n                            double zs_res_64513 = zt_res_64512 / 180.0;\n                            \n                            d_haversine_res_64507 = zs_res_64511;\n                            d_haversine_res_64508 = zs_res_64513;\n                            d_haversine_res_64509 = zs_res_64513;\n                        }\n                        \n                        double zm_res_64514 = d_haversine_res_64507 - d_haversine_res_81618;\n                        double cos_res_64515 = futrts_", "cos64(zm_res_64514);\n                        double zm_res_64516 = 1.0 - cos_res_64515;\n                        double cos_res_64517 = futrts_cos64(d_haversine_res_64507);\n                        double zt_res_64518 = cos_res_64517 * cos_res_81622;\n                        double zm_res_64519 = d_haversine_res_64508 - d_haversine_res_64509;\n                        double zm_res_64520 = 1.0 - zm_res_64519;\n                        double zt_res_64521 = zt_res_64518 * zm_res_64520;\n                        double zp_res_64522 = zm_res_64516 + zt_res_64521;\n                        double zs_res_64523 = zp_res_64522 / 2.0;\n                        double min_res_64524 = fmin64(1.0, zs_res_64523);\n                        double zt_res_64525 = 2.0 * min_res_64524;\n                        double zm_res_64526 = 1.0 - zt_res_64525;\n                        double acos_res_64527 = futrts_acos64(zm_res_64526);\n                        double zt_res_64528 = clBase_48698 * acos_res_64527;\n                        \n                        dist_res_64500 = zt_res_64528;\n                    }\n                    \n                    bool zlze_res_64529 = dist_res_64500 <= clBase_48692;\n                    bool x_64530 = !zlze_res_64499;\n                    bool y_64531 = zlze_res_64529 && x_64530;\n                    bool cond_t_res_64532 = zlze_res_64499 || y_64531;\n                    bool x_64533 = x_64469 && cond_t_res_64532;\n                    bool zgze_res_64534 = isWithinMargins_arg0_81616 <= x_64465;\n                    bool zlze_res_64535 = x_64465 <= isWithinMargins_arg2_81614;\n                    bool x_64536 = zgze_res_64534 && zlze_res_64535;\n                    double dist_res_64537;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double zm_res_66227 = x_64466 - isWithinMargins_arg1_81615;\n                        double abs_res_66228 = fabs64(zm_res_66227);\n                        \n                        dist_res_64537 = a", "bs_res_66228;\n                    } else {\n                        double d_haversine_res_64540;\n                        double d_haversine_res_64541;\n                        double d_haversine_res_64542;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64540 = x_64465;\n                            d_haversine_res_64541 = x_64466;\n                            d_haversine_res_64542 = x_64465;\n                        } else {\n                            double zt_res_64543 = 3.141592653589793 * x_64465;\n                            double zs_res_64544 = zt_res_64543 / 180.0;\n                            double zt_res_64545 = 3.141592653589793 * x_64466;\n                            double zs_res_64546 = zt_res_64545 / 180.0;\n                            \n                            d_haversine_res_64540 = zs_res_64544;\n                            d_haversine_res_64541 = zs_res_64546;\n                            d_haversine_res_64542 = zs_res_64544;\n                        }\n                        \n                        double zm_res_64547 = d_haversine_res_64540 - d_haversine_res_64542;\n                        double cos_res_64548 = futrts_cos64(zm_res_64547);\n                        double zm_res_64549 = 1.0 - cos_res_64548;\n                        double cos_res_64550 = futrts_cos64(d_haversine_res_64542);\n                        double cos_res_64551 = futrts_cos64(d_haversine_res_64540);\n                        double zt_res_64552 = cos_res_64550 * cos_res_64551;\n                        double zm_res_64553 = d_haversine_res_64541 - d_haversine_res_81619;\n                        double zm_res_64554 = 1.0 - zm_res_64553;\n                        double zt_res_64555 = zt_res_64552 * zm_res_64554;\n                        double zp_res_64556 = zm_res_64549 + zt_res_64555;\n                        double zs_res_64557 = zp_res_64556 / 2.0;\n                        double min_res_64558 = fmin64(1.0, zs",
                                    "_res_64557);\n                        double zt_res_64559 = 2.0 * min_res_64558;\n                        double zm_res_64560 = 1.0 - zt_res_64559;\n                        double acos_res_64561 = futrts_acos64(zm_res_64560);\n                        double zt_res_64562 = clBase_48698 * acos_res_64561;\n                        \n                        dist_res_64537 = zt_res_64562;\n                    }\n                    \n                    bool zlze_res_64563 = dist_res_64537 <= clBase_48692;\n                    double dist_res_64564;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double zm_res_66229 = x_64466 - isWithinMargins_arg3_81613;\n                        double abs_res_66230 = fabs64(zm_res_66229);\n                        \n                        dist_res_64564 = abs_res_66230;\n                    } else {\n                        double d_haversine_res_64567;\n                        double d_haversine_res_64568;\n                        double d_haversine_res_64569;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64567 = x_64465;\n                            d_haversine_res_64568 = x_64466;\n                            d_haversine_res_64569 = x_64465;\n                        } else {\n                            double zt_res_64570 = 3.141592653589793 * x_64465;\n                            double zs_res_64571 = zt_res_64570 / 180.0;\n                            double zt_res_64572 = 3.141592653589793 * x_64466;\n                            double zs_res_64573 = zt_res_64572 / 180.0;\n                            \n                            d_haversine_res_64567 = zs_res_64571;\n                            d_haversine_res_64568 = zs_res_64573;\n                            d_haversine_res_64569 = zs_res_64571;\n                        }\n                        \n                        double zm_res_64574 = d_haversine_res_64567 - d_haversine", "_res_64569;\n                        double cos_res_64575 = futrts_cos64(zm_res_64574);\n                        double zm_res_64576 = 1.0 - cos_res_64575;\n                        double cos_res_64577 = futrts_cos64(d_haversine_res_64569);\n                        double cos_res_64578 = futrts_cos64(d_haversine_res_64567);\n                        double zt_res_64579 = cos_res_64577 * cos_res_64578;\n                        double zm_res_64580 = d_haversine_res_64568 - d_haversine_res_81620;\n                        double zm_res_64581 = 1.0 - zm_res_64580;\n                        double zt_res_64582 = zt_res_64579 * zm_res_64581;\n                        double zp_res_64583 = zm_res_64576 + zt_res_64582;\n                        double zs_res_64584 = zp_res_64583 / 2.0;\n                        double min_res_64585 = fmin64(1.0, zs_res_64584);\n                        double zt_res_64586 = 2.0 * min_res_64585;\n                        double zm_res_64587 = 1.0 - zt_res_64586;\n                        double acos_res_64588 = futrts_acos64(zm_res_64587);\n                        double zt_res_64589 = clBase_48698 * acos_res_64588;\n                        \n                        dist_res_64564 = zt_res_64589;\n                    }\n                    \n                    bool zlze_res_64590 = dist_res_64564 <= clBase_48692;\n                    bool x_64591 = !zlze_res_64563;\n                    bool y_64592 = zlze_res_64590 && x_64591;\n                    bool cond_f_res_t_res_64593 = zlze_res_64563 || y_64592;\n                    bool x_64594 = x_64536 && cond_f_res_t_res_64593;\n                    bool x_64595 = !x_64533;\n                    bool y_64596 = x_64594 && x_64595;\n                    bool cond_64597 = x_64533 || y_64596;\n                    bool zlze_res_64598 = x_64465 <= isWithinMargins_arg0_81616;\n                    double corn_x_64599;\n                    \n                    if (zlze_res_64598) {\n                        corn_x_64599 = isWithinMargins_arg0_8161", "6;\n                    } else {\n                        corn_x_64599 = isWithinMargins_arg2_81614;\n                    }\n                    \n                    bool zlze_res_64600 = x_64466 <= isWithinMargins_arg1_81615;\n                    double corn_y_64601;\n                    \n                    if (zlze_res_64600) {\n                        corn_y_64601 = isWithinMargins_arg1_81615;\n                    } else {\n                        corn_y_64601 = isWithinMargins_arg3_81613;\n                    }\n                    \n                    double dist_res_64602;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool eq_x_y_66235 = x_64465 == isWithinMargins_arg0_81616;\n                        bool eq_x_zz_66236 = x_64465 == isWithinMargins_arg2_81614;\n                        bool p_and_eq_x_y_66237 = zlze_res_64598 && eq_x_y_66235;\n                        bool not_p_66238 = !zlze_res_64598;\n                        bool p_and_eq_x_y_66239 = eq_x_zz_66236 && not_p_66238;\n                        bool zeze_res_66240 = p_and_eq_x_y_66237 || p_and_eq_x_y_66239;\n                        double d_euclidean_res_66241;\n                        \n                        if (zeze_res_66240) {\n                            double zm_res_66242 = x_64466 - corn_y_64601;\n                            double abs_res_66243 = fabs64(zm_res_66242);\n                            \n                            d_euclidean_res_66241 = abs_res_66243;\n                        } else {\n                            bool eq_x_y_66244 = x_64466 == isWithinMargins_arg1_81615;\n                            bool eq_x_zz_66245 = x_64466 == isWithinMargins_arg3_81613;\n                            bool p_and_eq_x_y_66246 = zlze_res_64600 && eq_x_y_66244;\n                            bool not_p_66247 = !zlze_res_64600;\n                            bool p_and_eq_x_y_66248 = eq_x_zz_66245 && not_p_66247;\n                            bool zeze_res_66249 = p_and_eq_x_y",
                                    "_66246 || p_and_eq_x_y_66248;\n                            double d_euclidean_res_f_res_66250;\n                            \n                            if (zeze_res_66249) {\n                                double zm_res_66251 = x_64465 - corn_x_64599;\n                                double abs_res_66252 = fabs64(zm_res_66251);\n                                \n                                d_euclidean_res_f_res_66250 = abs_res_66252;\n                            } else {\n                                double zm_res_66253 = x_64466 - corn_y_64601;\n                                double zm_res_66254 = x_64465 - corn_x_64599;\n                                double hypot_res_66255 = futrts_hypot64(zm_res_66254, zm_res_66253);\n                                \n                                d_euclidean_res_f_res_66250 = hypot_res_66255;\n                            }\n                            d_euclidean_res_66241 = d_euclidean_res_f_res_66250;\n                        }\n                        dist_res_64602 = d_euclidean_res_66241;\n                    } else {\n                        double d_haversine_res_64624;\n                        double d_haversine_res_64625;\n                        double d_haversine_res_64626;\n                        double d_haversine_res_64627;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64624 = x_64465;\n                            d_haversine_res_64625 = x_64466;\n                            d_haversine_res_64626 = corn_x_64599;\n                            d_haversine_res_64627 = corn_y_64601;\n                        } else {\n                            double zt_res_64628 = 3.141592653589793 * x_64465;\n                            double zs_res_64629 = zt_res_64628 / 180.0;\n                            double zt_res_64630 = 3.141592653589793 * x_64466;\n                            double zs_res_64631 = zt_res_64630 / 180.0;\n                            double zt_", "res_64632 = 3.141592653589793 * corn_x_64599;\n                            double zs_res_64633 = zt_res_64632 / 180.0;\n                            double zt_res_64634 = 3.141592653589793 * corn_y_64601;\n                            double zs_res_64635 = zt_res_64634 / 180.0;\n                            \n                            d_haversine_res_64624 = zs_res_64629;\n                            d_haversine_res_64625 = zs_res_64631;\n                            d_haversine_res_64626 = zs_res_64633;\n                            d_haversine_res_64627 = zs_res_64635;\n                        }\n                        \n                        double zm_res_64636 = d_haversine_res_64624 - d_haversine_res_64626;\n                        double cos_res_64637 = futrts_cos64(zm_res_64636);\n                        double zm_res_64638 = 1.0 - cos_res_64637;\n                        double cos_res_64639 = futrts_cos64(d_haversine_res_64626);\n                        double cos_res_64640 = futrts_cos64(d_haversine_res_64624);\n                        double zt_res_64641 = cos_res_64639 * cos_res_64640;\n                        double zm_res_64642 = d_haversine_res_64625 - d_haversine_res_64627;\n                        double zm_res_64643 = 1.0 - zm_res_64642;\n                        double zt_res_64644 = zt_res_64641 * zm_res_64643;\n                        double zp_res_64645 = zm_res_64638 + zt_res_64644;\n                        double zs_res_64646 = zp_res_64645 / 2.0;\n                        double min_res_64647 = fmin64(1.0, zs_res_64646);\n                        double zt_res_64648 = 2.0 * min_res_64647;\n                        double zm_res_64649 = 1.0 - zt_res_64648;\n                        double acos_res_64650 = futrts_acos64(zm_res_64649);\n                        double zt_res_64651 = clBase_48698 * acos_res_64650;\n                        \n                        dist_res_64602 = zt_res_64651;\n                    }\n                    \n                    bool zlze_res_64652 = d", "ist_res_64602 <= clBase_48692;\n                    bool x_64653 = !cond_64597;\n                    bool y_64654 = zlze_res_64652 && x_64653;\n                    bool is_pt_marginal_res_64655 = cond_64597 || y_64654;\n                    bool cond_neg_64656 = !is_pt_marginal_res_64655;\n                    int64_t defunc_0_lifted_pzq_res_64657 = btoi_bool_i64(cond_neg_64656);\n                    bool is_i_64658 = defunc_0_lifted_pzq_res_64657 == (int64_t) 0;\n                    int64_t part_res_64659 = btoi_bool_i64(is_i_64658);\n                    int64_t part_res_64660;\n                    int64_t part_res_64661;\n                    \n                    if (is_i_64658) {\n                        part_res_64660 = (int64_t) 0;\n                        part_res_64661 = (int64_t) 0;\n                    } else {\n                        bool is_i_64662 = defunc_0_lifted_pzq_res_64657 == (int64_t) 1;\n                        int64_t part_res_64663;\n                        \n                        if (is_i_64662) {\n                            part_res_64663 = (int64_t) 1;\n                        } else {\n                            part_res_64663 = (int64_t) 2;\n                        }\n                        \n                        int64_t part_res_64664 = btoi_bool_i64(is_i_64662);\n                        \n                        part_res_64660 = part_res_64663;\n                        part_res_64661 = part_res_64664;\n                    }\n                    ((__global int64_t *) mem_82017)[gtid_75113] = part_res_64660;\n                    private_mem_83530[i_83535] = part_res_64659;\n                    private_mem_83532[i_83535] = part_res_64661;\n                } else {\n                    private_mem_83530[i_83535] = (int64_t) 0;\n                    private_mem_83532[i_83535] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83539 = 0; i_83539 < chunk_sizze",
                                    "_83487; i_83539++) {\n                int64_t sharedIdx_83540 = sext_i32_i64(local_tid_83503) + i_83539 * segscan_tblock_sizze_75109;\n                int64_t tmp_83541 = private_mem_83530[i_83539];\n                \n                ((__local int64_t *) local_mem_83512)[sharedIdx_83540] = tmp_83541;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83542 = 0; i_83542 < chunk_sizze_83487; i_83542++) {\n                int64_t sharedIdx_83543 = sext_i32_i64(local_tid_83503) * chunk_sizze_83487 + i_83542;\n                int64_t tmp_83544 = ((__local int64_t *) local_mem_83512)[sharedIdx_83543];\n                \n                private_mem_83530[i_83542] = tmp_83544;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83545 = 0; i_83545 < chunk_sizze_83487; i_83545++) {\n                int64_t sharedIdx_83546 = sext_i32_i64(local_tid_83503) + i_83545 * segscan_tblock_sizze_75109;\n                int64_t tmp_83547 = private_mem_83532[i_83545];\n                \n                ((__local int64_t *) local_mem_83512)[sharedIdx_83546] = tmp_83547;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83548 = 0; i_83548 < chunk_sizze_83487; i_83548++) {\n                int64_t sharedIdx_83549 = sext_i32_i64(local_tid_83503) * chunk_sizze_83487 + i_83548;\n                int64_t tmp_83550 = ((__local int64_t *) local_mem_83512)[sharedIdx_83549];\n                \n                private_mem_83532[i_83548] = tmp_83550;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83551 = 0; i_83551 < chunk_sizze_83487 - (int64_t) 1; i_83551++) {\n                int64_t x_62133;\n                int64_t y_62135;\n                \n                x_62133 = private_mem_83530[i_83551];\n                y_62135 = private_mem_83530[i_83551 + (int64_t) 1];\n                \n                int64_t x_62134;\n                int64_t y_621", "36;\n                \n                x_62134 = private_mem_83532[i_83551];\n                y_62136 = private_mem_83532[i_83551 + (int64_t) 1];\n                \n                int64_t zz_62137 = x_62133 + y_62135;\n                int64_t zz_62138 = x_62134 + y_62136;\n                \n                private_mem_83530[i_83551 + (int64_t) 1] = zz_62137;\n                private_mem_83532[i_83551 + (int64_t) 1] = zz_62138;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83552 = private_mem_83530[chunk_sizze_83487 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = tmp_83552;\n            \n            int64_t tmp_83553 = private_mem_83532[chunk_sizze_83487 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = tmp_83553;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t x_83554;\n            int64_t x_83555;\n            int64_t y_83556;\n            int64_t y_83557;\n            int64_t x_83562;\n            int64_t x_83563;\n            int64_t y_83564;\n            int64_t y_83565;\n            bool ltid_in_bounds_83568 = slt64(sext_i32_i64(local_tid_83503), num_virt_threads_83489);\n            int32_t skip_threads_83569;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83568) {\n                    y_83556 = ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)];\n                    y_83557 = ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)];\n                    if ((local_tid_83503 - squot32(local_tid_83503, 32) * 32) == 0) {\n                        x_83554 = y_83556;\n                        x_83555 = y_83557;\n                    }\n              ", "  }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83569 = 1;\n                while (slt32(skip_threads_83569, 32)) {\n                    bool thread_active_83570 = sle32(skip_threads_83569, local_tid_83503 - squot32(local_tid_83503, 32) * 32) && ltid_in_bounds_83568;\n                    \n                    if (thread_active_83570) {\n                        // read operands\n                        {\n                            x_83554 = ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83569)];\n                            x_83555 = ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + (sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83569))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83570) {\n                            int64_t zz_83558 = x_83554 + y_83556;\n                            int64_t zz_83559 = x_83555 + y_83557;\n                            \n                            x_83554 = zz_83558;\n                            x_83555 = zz_83559;\n                        }\n                    }\n                    if (sle32(wave_sizze_83505, skip_threads_83569)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83570) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = x_83554;\n                            y_83556 = x_83554;\n                            ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = x_83555;\n                            y_83557 = x_83555;\n                        }\n                    }\n                    if (sle32(w",
                                    "ave_sizze_83505, skip_threads_83569)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83569 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83503 - squot32(local_tid_83503, 32) * 32) == 31 && ltid_in_bounds_83568) {\n                    ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(squot32(local_tid_83503, 32))] = x_83554;\n                    ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(squot32(local_tid_83503, 32))] = x_83555;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83571;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83503, 32) == 0 && ltid_in_bounds_83568) {\n                        y_83564 = ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)];\n                        y_83565 = ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)];\n                        if ((local_tid_83503 - squot32(local_tid_83503, 32) * 32) == 0) {\n                            x_83562 = y_83564;\n                            x_83563 = y_83565;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83571 = 1;\n                    while (slt32(skip_threads_83571, 32)) {\n                        bool thread_active_83572 = sle32(skip_threads_83571, local_tid_83503 - squot32(local_tid_83503, 32) * 32) && (squot32(local_tid_83503, 32) == 0 && ltid_in_bounds_", "83568);\n                        \n                        if (thread_active_83572) {\n                            // read operands\n                            {\n                                x_83562 = ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83571)];\n                                x_83563 = ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + (sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83571))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83572) {\n                                int64_t zz_83566 = x_83562 + y_83564;\n                                int64_t zz_83567 = x_83563 + y_83565;\n                                \n                                x_83562 = zz_83566;\n                                x_83563 = zz_83567;\n                            }\n                        }\n                        if (sle32(wave_sizze_83505, skip_threads_83571)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83572) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = x_83562;\n                                y_83564 = x_83562;\n                                ((volatile __local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = x_83563;\n                                y_83565 = x_83563;\n                            }\n                        }\n                        if (sle32(wave_sizze_83505, skip_threads_83571)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83571 *= 2;\n                    }\n            ", "    }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83573 = squot32(local_tid_83503, 32) == 0 || !ltid_in_bounds_83568;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83573) {\n                        y_83556 = x_83554;\n                        y_83557 = x_83555;\n                        x_83554 = ((__local int64_t *) local_mem_83512)[sext_i32_i64(squot32(local_tid_83503, 32)) - (int64_t) 1];\n                        x_83555 = ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_83503, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83573) {\n                        int64_t zz_83558 = x_83554 + y_83556;\n                        int64_t zz_83559 = x_83555 + y_83557;\n                        \n                        x_83554 = zz_83558;\n                        x_83555 = zz_83559;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83573) {\n                        ((__local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = x_83554;\n                        ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = x_83555;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83503, 32) == 0 && ltid_in_bounds_83568) {\n                    ((__local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = y_83556;\n                    ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = y_83",
                                    "557;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83503 == 0) {\n                acc_83560 = ((__local int64_t *) local_mem_83512)[segscan_tblock_sizze_75109 - (int64_t) 1];\n                acc_83561 = ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + (segscan_tblock_sizze_75109 - (int64_t) 1)];\n            } else {\n                acc_83560 = ((__local int64_t *) local_mem_83512)[sext_i32_i64(local_tid_83503) - (int64_t) 1];\n                acc_83561 = ((__local int64_t *) local_mem_83512)[squot64(byte_offsets_83508, (int64_t) 8) + (sext_i32_i64(local_tid_83503) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83574 = (int64_t) 0;\n        prefix_83575 = (int64_t) 0;\n        block_new_sgm_83576 = sgm_idx_83527 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83576 && local_tid_83503 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83494)[dynamic_id_83525] = acc_83560;\n                ((volatile __global int64_t *) incprefixes_mem_83498)[dynamic_id_83525] = acc_83561;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83490)[dynamic_id_83525] = (int8_t) 2;\n                acc_83560 = (int64_t) 0;\n                acc_83561 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83576 && slt32(local_tid_83503, wave_sizze_83505)) {\n                if (local_tid_83503 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83492)[dynamic_id_83525] = acc_83560;\n                    ((volatile __global int64_t *) aggregates_mem_83496)[dynamic_id_83525] = acc_83561;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83490)[dynamic_id_83525] = (int8_t) 1;\n                    \n                    int8_t tmp_83577 = ((volatil", "e __global int8_t *) status_flags_mem_83490)[dynamic_id_83525 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83512)[(int64_t) 0] = tmp_83577;\n                }\n                mem_fence_local();\n                \n                int8_t status_83578 = ((__local int8_t *) local_mem_83512)[(int64_t) 0];\n                \n                if (status_83578 == (int8_t) 2) {\n                    if (local_tid_83503 == 0) {\n                        prefix_83574 = ((volatile __global int64_t *) incprefixes_mem_83494)[dynamic_id_83525 - (int64_t) 1];\n                        prefix_83575 = ((volatile __global int64_t *) incprefixes_mem_83498)[dynamic_id_83525 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83579 = sext_i64_i32(dynamic_id_83525 - sext_i32_i64(wave_sizze_83505));\n                    \n                    while (slt32(wave_sizze_83505 * -1, readOffset_83579)) {\n                        int32_t read_i_83580 = readOffset_83579 + local_tid_83503;\n                        int64_t aggr_83581 = (int64_t) 0;\n                        int64_t aggr_83582 = (int64_t) 0;\n                        int8_t flag_83583 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83580)) {\n                            flag_83583 = ((volatile __global int8_t *) status_flags_mem_83490)[sext_i32_i64(read_i_83580)];\n                            if (flag_83583 == (int8_t) 2) {\n                                aggr_83581 = ((volatile __global int64_t *) incprefixes_mem_83494)[sext_i32_i64(read_i_83580)];\n                                aggr_83582 = ((volatile __global int64_t *) incprefixes_mem_83498)[sext_i32_i64(read_i_83580)];\n                            } else if (flag_83583 == (int8_t) 1) {\n                                aggr_83581 = ((volatile __global int64_t *) aggregates_mem_83492)[sext_i32_i64(read_i_83580)];\n                                aggr_83582 = ((volatile __", "global int64_t *) aggregates_mem_83496)[sext_i32_i64(read_i_83580)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83512)[(int64_t) 4 + sext_i32_i64(local_tid_83503)] = aggr_83581;\n                        ((__local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = aggr_83582;\n                        ((__local int8_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = flag_83583;\n                        flag_83583 = ((__local int8_t *) local_mem_83512)[sext_i32_i64(wave_sizze_83505) - (int64_t) 1];\n                        if (slt8(flag_83583, (int8_t) 2)) {\n                            int8_t flg_x_83590;\n                            int8_t flg_y_83591;\n                            int64_t x_83584;\n                            int64_t x_83585;\n                            int64_t y_83586;\n                            int64_t y_83587;\n                            int32_t skip_threads_83592;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83591 = ((volatile __local int8_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)];\n                                y_83586 = ((volatile __local int64_t *) local_mem_83512)[(int64_t) 4 + sext_i32_i64(local_tid_83503)];\n                                y_83587 = ((volatile __local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8) + sext_i32_i64(local_tid_83503)];\n                                if ((local_tid_83503 - squot32(local_tid_83503, 32) * 32) == 0) {\n                                    x_83584 = y_83586;\n                                    x_83585 = y_83587;\n                                    flg_x_83590 = flg_y_83591;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                        ",
                                    "    {\n                                skip_threads_83592 = 1;\n                                while (slt32(skip_threads_83592, 32)) {\n                                    if (sle32(skip_threads_83592, local_tid_83503 - squot32(local_tid_83503, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83590 = ((volatile __local int8_t *) local_mem_83512)[sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83592)];\n                                            x_83584 = ((volatile __local int64_t *) local_mem_83512)[(int64_t) 4 + (sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83592))];\n                                            x_83585 = ((volatile __local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8) + (sext_i32_i64(local_tid_83503) - sext_i32_i64(skip_threads_83592))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83591 == (int8_t) 2 || flg_y_83591 == (int8_t) 0) {\n                                                flg_x_83590 = flg_y_83591;\n                                                x_83584 = y_83586;\n                                                x_83585 = y_83587;\n                                            } else {\n                                                int64_t zz_83588 = x_83584 + y_83586;\n                                                int64_t zz_83589 = x_83585 + y_83587;\n                                                \n                                                x_83584 = zz_83588;\n                                                x_83585 = zz_83589;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                 ", "                           ((volatile __local int8_t *) local_mem_83512)[sext_i32_i64(local_tid_83503)] = flg_x_83590;\n                                            flg_y_83591 = flg_x_83590;\n                                            ((volatile __local int64_t *) local_mem_83512)[(int64_t) 4 + sext_i32_i64(local_tid_83503)] = x_83584;\n                                            y_83586 = x_83584;\n                                            ((volatile __local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8) + sext_i32_i64(local_tid_83503)] = x_83585;\n                                            y_83587 = x_83585;\n                                        }\n                                    }\n                                    skip_threads_83592 *= 2;\n                                }\n                            }\n                        }\n                        flag_83583 = ((__local int8_t *) local_mem_83512)[sext_i32_i64(wave_sizze_83505) - (int64_t) 1];\n                        aggr_83581 = ((__local int64_t *) local_mem_83512)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83505) - (int64_t) 1)];\n                        aggr_83582 = ((__local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8) + (sext_i32_i64(wave_sizze_83505) - (int64_t) 1)];\n                        if (flag_83583 == (int8_t) 2) {\n                            readOffset_83579 = wave_sizze_83505 * -1;\n                        } else if (flag_83583 == (int8_t) 1) {\n                            readOffset_83579 -= wave_sizze_83505;\n                        }\n                        if (slt8((int8_t) 0, flag_83583)) {\n                            int64_t x_83593 = aggr_83581;\n                            int64_t x_83594 = aggr_83582;\n                            int64_t y_83595 = prefix_83574;\n                            int64_t y_83596 = prefix_83575;\n                            int64_t zz_83597 = x_83593 + y_83595;\n                            int64_t zz_83598 = x_8359", "4 + y_83596;\n                            \n                            prefix_83574 = zz_83597;\n                            prefix_83575 = zz_83598;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83503 == 0) {\n                    if (boundary_83528 == sext_i64_i32(segscan_tblock_sizze_75109 * chunk_sizze_83487)) {\n                        int64_t x_83599 = prefix_83574;\n                        int64_t x_83600 = prefix_83575;\n                        int64_t y_83601 = acc_83560;\n                        int64_t y_83602 = acc_83561;\n                        int64_t zz_83603 = x_83599 + y_83601;\n                        int64_t zz_83604 = x_83600 + y_83602;\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83494)[dynamic_id_83525] = zz_83603;\n                        ((volatile __global int64_t *) incprefixes_mem_83498)[dynamic_id_83525] = zz_83604;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83490)[dynamic_id_83525] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83512)[(int64_t) 4] = prefix_83574;\n                    ((__local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8)] = prefix_83575;\n                    acc_83560 = (int64_t) 0;\n                    acc_83561 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83525 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83574 = ((__local int64_t *) local_mem_83512)[(int64_t) 4];\n                prefix_83575 = ((__local int64_t *) local_mem_83512)[squot64(warp_byte_offset_83510, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t x_83605;\n            int64_t y_83607;\n            int64_t x_83611 = prefix_8",
                                    "3574;\n            int64_t y_83613 = acc_83560;\n            int64_t x_83606;\n            int64_t y_83608;\n            int64_t x_83612 = prefix_83575;\n            int64_t y_83614 = acc_83561;\n            \n            if (slt32(local_tid_83503 * chunk_sizze_32b_83507, boundary_83528) && !block_new_sgm_83576) {\n                int64_t zz_83615 = x_83611 + y_83613;\n                int64_t zz_83616 = x_83612 + y_83614;\n                \n                x_83605 = zz_83615;\n                x_83606 = zz_83616;\n            } else {\n                x_83605 = acc_83560;\n                x_83606 = acc_83561;\n            }\n            \n            int32_t stopping_point_83617 = segsizze_compact_83529 - srem32(local_tid_83503 * chunk_sizze_32b_83507 - 1 + segsizze_compact_83529 - boundary_83528, segsizze_compact_83529);\n            \n            for (int64_t i_83618 = 0; i_83618 < chunk_sizze_83487; i_83618++) {\n                if (slt32(sext_i64_i32(i_83618), stopping_point_83617 - 1)) {\n                    y_83607 = private_mem_83530[i_83618];\n                    y_83608 = private_mem_83532[i_83618];\n                    \n                    int64_t zz_83609 = x_83605 + y_83607;\n                    int64_t zz_83610 = x_83606 + y_83608;\n                    \n                    private_mem_83530[i_83618] = zz_83609;\n                    private_mem_83532[i_83618] = zz_83610;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83619 = 0; i_83619 < chunk_sizze_83487; i_83619++) {\n                int64_t sharedIdx_83620 = sext_i32_i64(local_tid_83503) * chunk_sizze_83487 + i_83619;\n                int64_t tmp_83621 = private_mem_83530[i_83619];\n                \n                ((__local int64_t *) local_mem_83512)[sharedIdx_83620] = tmp_83621;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83622 = 0; i_83622 < chunk_sizze_83487; i_83622++) {\n  ", "              int64_t flat_idx_83623 = thd_offset_83534 + i_83622 * segscan_tblock_sizze_75109;\n                int64_t slice_83624 = m_61888;\n                int64_t gtid_75113 = flat_idx_83623;\n                int64_t remnant_83625 = flat_idx_83623 - gtid_75113;\n                \n                if (slt64(flat_idx_83623, m_61888)) {\n                    int64_t tmp_83626 = ((__local int64_t *) local_mem_83512)[flat_idx_83623 - block_offset_83526];\n                    \n                    ((__global int64_t *) mem_82013)[gtid_75113] = tmp_83626;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83627 = 0; i_83627 < chunk_sizze_83487; i_83627++) {\n                int64_t sharedIdx_83628 = sext_i32_i64(local_tid_83503) * chunk_sizze_83487 + i_83627;\n                int64_t tmp_83629 = private_mem_83532[i_83627];\n                \n                ((__local int64_t *) local_mem_83512)[sharedIdx_83628] = tmp_83629;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83630 = 0; i_83630 < chunk_sizze_83487; i_83630++) {\n                int64_t flat_idx_83631 = thd_offset_83534 + i_83630 * segscan_tblock_sizze_75109;\n                int64_t slice_83632 = m_61888;\n                int64_t gtid_75113 = flat_idx_83631;\n                int64_t remnant_83633 = flat_idx_83631 - gtid_75113;\n                \n                if (slt64(flat_idx_83631, m_61888)) {\n                    int64_t tmp_83634 = ((__local int64_t *) local_mem_83512)[flat_idx_83631 - block_offset_83526];\n                    \n                    ((__global int64_t *) mem_82015)[gtid_75113] = tmp_83634;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75109\n    #undef chunk_sizze_83487\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75130_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75130(__global int *global_failure, int64_t clBase_4869", "5, int64_t partition_sizze_62142, int64_t num_tblocks_75127, int64_t num_virt_blocks_83655, int64_t num_virt_threads_83656, __global unsigned char *ext_mem_82028, __global unsigned char *ext_mem_82035, __global unsigned char *ext_mem_82036, __global unsigned char *mem_82039, __global unsigned char *mem_82041, __global unsigned char *mem_82042, __global unsigned char *status_flags_mem_83657, __global unsigned char *aggregates_mem_83659, __global unsigned char *incprefixes_mem_83661, __global unsigned char *global_dynid_mem_83663)\n{\n    #define segscan_tblock_sizze_75125 (do_DBSCAN_doublezisegscan_75130zisegscan_tblock_sizze_75125)\n    #define chunk_sizze_83654 (do_DBSCAN_doublezisegscan_75130zichunk_sizze_83654)\n    \n    volatile __local unsigned char *local_mem_83673_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83673_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75125), chunk_sizze_83654 * segscan_tblock_sizze_75125 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75125), chunk_sizze_83654 * segscan_tblock_sizze_75125 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83666;\n    int32_t tblock_sizze_83669;\n    int32_t wave_sizze_83668;\n    int32_t block_id_83667;\n    int32_t global_tid_83665;\n    int64_t phys_tid_75130;\n    int32_t chunk_sizze_32b_83670;\n    int64_t byte_offsets_83671;\n    int64_t warp_byte_offset_83672;\n    __local unsigned char *local_mem_83673;\n    int64_t trans_arr_len_83674;\n    int64_t phys_block_id_83680;\n    int64_t virtloop_bound_83681;\n    \n    local_tid_83666 = get_local_id(0);\n    tblock_sizze_83669 = get_local_size(0);\n    wave_sizze_83668 = LOCKSTEP_WIDTH;\n    block_id_83667 = get_tblock_id(0);\n    global_tid_83665 = block_id_83667 * tblock_sizze_83669 + local_tid_83666;\n    phys_tid_75130 = sext_i32_i64(global_tid_83665);\n    chunk_sizze_32b_83670 = sex",
                                    "t_i64_i32(chunk_sizze_83654);\n    byte_offsets_83671 = segscan_tblock_sizze_75125 * (int64_t) 8;\n    warp_byte_offset_83672 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83673 = (__local unsigned char *) local_mem_83673_backing_0;\n    trans_arr_len_83674 = chunk_sizze_83654 * segscan_tblock_sizze_75125;\n    phys_block_id_83680 = get_tblock_id(0);\n    virtloop_bound_83681 = sdiv_up64(num_virt_blocks_83655 - phys_block_id_83680, num_tblocks_75127);\n    for (int64_t virtloop_i_83682 = 0; virtloop_i_83682 < virtloop_bound_83681; virtloop_i_83682++) {\n        int64_t dynamic_id_83683;\n        int64_t block_offset_83684;\n        int64_t sgm_idx_83685;\n        int32_t boundary_83686;\n        int32_t segsizze_compact_83687;\n        int64_t private_mem_83688[chunk_sizze_83654];\n        int64_t thd_offset_83690;\n        int64_t acc_83706;\n        int64_t prefix_83716;\n        bool block_new_sgm_83717;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83666 == 0) {\n                dynamic_id_83683 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83663)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83673)[(int64_t) 0] = dynamic_id_83683;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83683 == num_virt_blocks_83655 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83663)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83683 = ((__local int32_t *) local_mem_83673)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83684 = dynamic_id_83683 * chunk_sizze_83654 * segscan_tblock_sizze_75125;\n        sgm_idx_83685 = smod64(block_offset_8", "3684, partition_sizze_62142);\n        boundary_83686 = sext_i64_i32(smin64(chunk_sizze_83654 * segscan_tblock_sizze_75125, partition_sizze_62142 - sgm_idx_83685));\n        segsizze_compact_83687 = sext_i64_i32(smin64(chunk_sizze_83654 * segscan_tblock_sizze_75125, partition_sizze_62142));\n        thd_offset_83690 = block_offset_83684 + sext_i32_i64(local_tid_83666);\n        // Load and map\n        {\n            for (int64_t i_83691 = 0; i_83691 < chunk_sizze_83654; i_83691++) {\n                int64_t virt_tid_83692 = thd_offset_83690 + i_83691 * segscan_tblock_sizze_75125;\n                int64_t slice_83693 = partition_sizze_62142;\n                int64_t gtid_75129 = virt_tid_83692;\n                int64_t remnant_83694 = virt_tid_83692 - gtid_75129;\n                \n                if (slt64(virt_tid_83692, partition_sizze_62142)) {\n                    int64_t eta_p_64450 = ((__global int64_t *) ext_mem_82036)[gtid_75129];\n                    int64_t eta_p_64451 = ((__global int64_t *) ext_mem_82035)[gtid_75129];\n                    int64_t eta_p_64452 = ((__global int64_t *) ext_mem_82028)[gtid_75129];\n                    int64_t lifted_lambda_res_64453 = sub64(eta_p_64450, (int64_t) 1);\n                    int64_t zp_lhs_64455 = add64(eta_p_64451, lifted_lambda_res_64453);\n                    int64_t lifted_lambda_res_64456 = add64(eta_p_64452, zp_lhs_64455);\n                    bool lifted_lambda_res_64458 = sle64(clBase_48695, lifted_lambda_res_64456);\n                    int64_t defunc_0_f_res_64460 = btoi_bool_i64(lifted_lambda_res_64458);\n                    \n                    ((__global int64_t *) mem_82041)[gtid_75129] = defunc_0_f_res_64460;\n                    ((__global bool *) mem_82042)[gtid_75129] = lifted_lambda_res_64458;\n                    private_mem_83688[i_83691] = defunc_0_f_res_64460;\n                } else {\n                    private_mem_83688[i_83691] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL", "_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83695 = 0; i_83695 < chunk_sizze_83654; i_83695++) {\n                int64_t sharedIdx_83696 = sext_i32_i64(local_tid_83666) + i_83695 * segscan_tblock_sizze_75125;\n                int64_t tmp_83697 = private_mem_83688[i_83695];\n                \n                ((__local int64_t *) local_mem_83673)[sharedIdx_83696] = tmp_83697;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83698 = 0; i_83698 < chunk_sizze_83654; i_83698++) {\n                int64_t sharedIdx_83699 = sext_i32_i64(local_tid_83666) * chunk_sizze_83654 + i_83698;\n                int64_t tmp_83700 = ((__local int64_t *) local_mem_83673)[sharedIdx_83699];\n                \n                private_mem_83688[i_83698] = tmp_83700;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83701 = 0; i_83701 < chunk_sizze_83654 - (int64_t) 1; i_83701++) {\n                int64_t eta_p_62235;\n                int64_t eta_p_62236;\n                \n                eta_p_62235 = private_mem_83688[i_83701];\n                eta_p_62236 = private_mem_83688[i_83701 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_62237 = add64(eta_p_62235, eta_p_62236);\n                \n                private_mem_83688[i_83701 + (int64_t) 1] = defunc_0_op_res_62237;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83702 = private_mem_83688[chunk_sizze_83654 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = tmp_83702;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83703;\n            int64_t eta_p_83704;\n            int64_t eta_p_83707;\n            int64_t eta_p_83708;\n            bool ltid_in_bounds_83710 = slt64(sext_i32_i64(local",
                                    "_tid_83666), num_virt_threads_83656);\n            int32_t skip_threads_83711;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83710) {\n                    eta_p_83704 = ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)];\n                    if ((local_tid_83666 - squot32(local_tid_83666, 32) * 32) == 0) {\n                        eta_p_83703 = eta_p_83704;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83711 = 1;\n                while (slt32(skip_threads_83711, 32)) {\n                    bool thread_active_83712 = sle32(skip_threads_83711, local_tid_83666 - squot32(local_tid_83666, 32) * 32) && ltid_in_bounds_83710;\n                    \n                    if (thread_active_83712) {\n                        // read operands\n                        {\n                            eta_p_83703 = ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666) - sext_i32_i64(skip_threads_83711)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83712) {\n                            int64_t defunc_0_op_res_83705 = add64(eta_p_83703, eta_p_83704);\n                            \n                            eta_p_83703 = defunc_0_op_res_83705;\n                        }\n                    }\n                    if (sle32(wave_sizze_83668, skip_threads_83711)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83712) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = eta_p_83703;\n                            eta_p_83704 = eta_p_83703;\n                        }\n                    }\n          ", "          if (sle32(wave_sizze_83668, skip_threads_83711)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83711 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83666 - squot32(local_tid_83666, 32) * 32) == 31 && ltid_in_bounds_83710) {\n                    ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(squot32(local_tid_83666, 32))] = eta_p_83703;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83713;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83666, 32) == 0 && ltid_in_bounds_83710) {\n                        eta_p_83708 = ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)];\n                        if ((local_tid_83666 - squot32(local_tid_83666, 32) * 32) == 0) {\n                            eta_p_83707 = eta_p_83708;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83713 = 1;\n                    while (slt32(skip_threads_83713, 32)) {\n                        bool thread_active_83714 = sle32(skip_threads_83713, local_tid_83666 - squot32(local_tid_83666, 32) * 32) && (squot32(local_tid_83666, 32) == 0 && ltid_in_bounds_83710);\n                        \n                        if (thread_active_83714) {\n                            // read operands\n                            {\n                                eta_p_83707 = ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666) - sext_i32_i64(skip_threads_83713)];\n            ", "                }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83714) {\n                                int64_t defunc_0_op_res_83709 = add64(eta_p_83707, eta_p_83708);\n                                \n                                eta_p_83707 = defunc_0_op_res_83709;\n                            }\n                        }\n                        if (sle32(wave_sizze_83668, skip_threads_83713)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83714) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = eta_p_83707;\n                                eta_p_83708 = eta_p_83707;\n                            }\n                        }\n                        if (sle32(wave_sizze_83668, skip_threads_83713)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83713 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83715 = squot32(local_tid_83666, 32) == 0 || !ltid_in_bounds_83710;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83715) {\n                        eta_p_83704 = eta_p_83703;\n                        eta_p_83703 = ((__local int64_t *) local_mem_83673)[sext_i32_i64(squot32(local_tid_83666, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83715) {\n                        int64_t defunc_0_op_res_83705 = add64(eta_p_83703, eta_p_83704);\n                        \n               ",
                                    "         eta_p_83703 = defunc_0_op_res_83705;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83715) {\n                        ((__local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = eta_p_83703;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83666, 32) == 0 && ltid_in_bounds_83710) {\n                    ((__local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = eta_p_83704;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83666 == 0) {\n                acc_83706 = ((__local int64_t *) local_mem_83673)[segscan_tblock_sizze_75125 - (int64_t) 1];\n            } else {\n                acc_83706 = ((__local int64_t *) local_mem_83673)[sext_i32_i64(local_tid_83666) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83716 = (int64_t) 0;\n        block_new_sgm_83717 = sgm_idx_83685 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83717 && local_tid_83666 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83661)[dynamic_id_83683] = acc_83706;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83657)[dynamic_id_83683] = (int8_t) 2;\n                acc_83706 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83717 && slt32(local_tid_83666, wave_sizze_83668)) {\n                if (local_tid_83666 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83659)[dynamic_id_83683] = acc_83706;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83657)[dynamic_id_83683] = (int8_t) 1;\n                    \n ", "                   int8_t tmp_83718 = ((volatile __global int8_t *) status_flags_mem_83657)[dynamic_id_83683 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83673)[(int64_t) 0] = tmp_83718;\n                }\n                mem_fence_local();\n                \n                int8_t status_83719 = ((__local int8_t *) local_mem_83673)[(int64_t) 0];\n                \n                if (status_83719 == (int8_t) 2) {\n                    if (local_tid_83666 == 0) {\n                        prefix_83716 = ((volatile __global int64_t *) incprefixes_mem_83661)[dynamic_id_83683 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83720 = sext_i64_i32(dynamic_id_83683 - sext_i32_i64(wave_sizze_83668));\n                    \n                    while (slt32(wave_sizze_83668 * -1, readOffset_83720)) {\n                        int32_t read_i_83721 = readOffset_83720 + local_tid_83666;\n                        int64_t aggr_83722 = (int64_t) 0;\n                        int8_t flag_83723 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83721)) {\n                            flag_83723 = ((volatile __global int8_t *) status_flags_mem_83657)[sext_i32_i64(read_i_83721)];\n                            if (flag_83723 == (int8_t) 2) {\n                                aggr_83722 = ((volatile __global int64_t *) incprefixes_mem_83661)[sext_i32_i64(read_i_83721)];\n                            } else if (flag_83723 == (int8_t) 1) {\n                                aggr_83722 = ((volatile __global int64_t *) aggregates_mem_83659)[sext_i32_i64(read_i_83721)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83673)[(int64_t) 4 + sext_i32_i64(local_tid_83666)] = aggr_83722;\n                        ((__local int8_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = flag_83723;\n                        flag_83723 = ((_", "_local int8_t *) local_mem_83673)[sext_i32_i64(wave_sizze_83668) - (int64_t) 1];\n                        if (slt8(flag_83723, (int8_t) 2)) {\n                            int8_t flg_x_83727;\n                            int8_t flg_y_83728;\n                            int64_t eta_p_83724;\n                            int64_t eta_p_83725;\n                            int32_t skip_threads_83729;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83728 = ((volatile __local int8_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)];\n                                eta_p_83725 = ((volatile __local int64_t *) local_mem_83673)[(int64_t) 4 + sext_i32_i64(local_tid_83666)];\n                                if ((local_tid_83666 - squot32(local_tid_83666, 32) * 32) == 0) {\n                                    eta_p_83724 = eta_p_83725;\n                                    flg_x_83727 = flg_y_83728;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83729 = 1;\n                                while (slt32(skip_threads_83729, 32)) {\n                                    if (sle32(skip_threads_83729, local_tid_83666 - squot32(local_tid_83666, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83727 = ((volatile __local int8_t *) local_mem_83673)[sext_i32_i64(local_tid_83666) - sext_i32_i64(skip_threads_83729)];\n                                            eta_p_83724 = ((volatile __local int64_t *) local_mem_83673)[(int64_t) 4 + (sext_i32_i64(local_tid_83666) - sext_i32_i64(skip_threads_83729))];\n                                        }\n                                        // perform operation\n                      ",
                                    "                  {\n                                            if (flg_y_83728 == (int8_t) 2 || flg_y_83728 == (int8_t) 0) {\n                                                flg_x_83727 = flg_y_83728;\n                                                eta_p_83724 = eta_p_83725;\n                                            } else {\n                                                int64_t defunc_0_op_res_83726 = add64(eta_p_83724, eta_p_83725);\n                                                \n                                                eta_p_83724 = defunc_0_op_res_83726;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83673)[sext_i32_i64(local_tid_83666)] = flg_x_83727;\n                                            flg_y_83728 = flg_x_83727;\n                                            ((volatile __local int64_t *) local_mem_83673)[(int64_t) 4 + sext_i32_i64(local_tid_83666)] = eta_p_83724;\n                                            eta_p_83725 = eta_p_83724;\n                                        }\n                                    }\n                                    skip_threads_83729 *= 2;\n                                }\n                            }\n                        }\n                        flag_83723 = ((__local int8_t *) local_mem_83673)[sext_i32_i64(wave_sizze_83668) - (int64_t) 1];\n                        aggr_83722 = ((__local int64_t *) local_mem_83673)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83668) - (int64_t) 1)];\n                        if (flag_83723 == (int8_t) 2) {\n                            readOffset_83720 = wave_sizze_83668 * -1;\n                        } else if (flag_83723 == (int8_t) 1) {\n                            readOffset_83720 -= wave_sizze_83668;\n                        }\n                        if (slt8((int8", "_t) 0, flag_83723)) {\n                            int64_t eta_p_83730 = aggr_83722;\n                            int64_t eta_p_83731 = prefix_83716;\n                            int64_t defunc_0_op_res_83732 = add64(eta_p_83730, eta_p_83731);\n                            \n                            prefix_83716 = defunc_0_op_res_83732;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83666 == 0) {\n                    if (boundary_83686 == sext_i64_i32(segscan_tblock_sizze_75125 * chunk_sizze_83654)) {\n                        int64_t eta_p_83733 = prefix_83716;\n                        int64_t eta_p_83734 = acc_83706;\n                        int64_t defunc_0_op_res_83735 = add64(eta_p_83733, eta_p_83734);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83661)[dynamic_id_83683] = defunc_0_op_res_83735;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83657)[dynamic_id_83683] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83673)[(int64_t) 4] = prefix_83716;\n                    acc_83706 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83683 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83716 = ((__local int64_t *) local_mem_83673)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83736;\n            int64_t eta_p_83737;\n            int64_t eta_p_83739 = prefix_83716;\n            int64_t eta_p_83740 = acc_83706;\n            \n            if (slt32(local_tid_83666 * chunk_sizze_32b_83670, boundary_83686) && !block_new_sgm_83717) {\n                int64_t defunc_0_op_res_83741 = add64(eta_p_83739, eta_p_83740);\n                \n                eta_p_83736 = defunc_0_op_re", "s_83741;\n            } else {\n                eta_p_83736 = acc_83706;\n            }\n            \n            int32_t stopping_point_83742 = segsizze_compact_83687 - srem32(local_tid_83666 * chunk_sizze_32b_83670 - 1 + segsizze_compact_83687 - boundary_83686, segsizze_compact_83687);\n            \n            for (int64_t i_83743 = 0; i_83743 < chunk_sizze_83654; i_83743++) {\n                if (slt32(sext_i64_i32(i_83743), stopping_point_83742 - 1)) {\n                    eta_p_83737 = private_mem_83688[i_83743];\n                    \n                    int64_t defunc_0_op_res_83738 = add64(eta_p_83736, eta_p_83737);\n                    \n                    private_mem_83688[i_83743] = defunc_0_op_res_83738;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83744 = 0; i_83744 < chunk_sizze_83654; i_83744++) {\n                int64_t sharedIdx_83745 = sext_i32_i64(local_tid_83666) * chunk_sizze_83654 + i_83744;\n                int64_t tmp_83746 = private_mem_83688[i_83744];\n                \n                ((__local int64_t *) local_mem_83673)[sharedIdx_83745] = tmp_83746;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83747 = 0; i_83747 < chunk_sizze_83654; i_83747++) {\n                int64_t flat_idx_83748 = thd_offset_83690 + i_83747 * segscan_tblock_sizze_75125;\n                int64_t slice_83749 = partition_sizze_62142;\n                int64_t gtid_75129 = flat_idx_83748;\n                int64_t remnant_83750 = flat_idx_83748 - gtid_75129;\n                \n                if (slt64(flat_idx_83748, partition_sizze_62142)) {\n                    int64_t tmp_83751 = ((__local int64_t *) local_mem_83673)[flat_idx_83748 - block_offset_83684];\n                    \n                    ((__global int64_t *) mem_82039)[gtid_75129] = tmp_83751;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        ",
                                    "}\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75125\n    #undef chunk_sizze_83654\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75146_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75146(__global int *global_failure, int64_t partition_sizze_62142, int64_t j_m_i_62183, int64_t num_tblocks_75143, int64_t num_virt_blocks_83773, int64_t num_virt_threads_83774, __global unsigned char *mem_82022, __global unsigned char *mem_82052, __global unsigned char *mem_82054, __global unsigned char *status_flags_mem_83775, __global unsigned char *aggregates_mem_83777, __global unsigned char *incprefixes_mem_83779, __global unsigned char *global_dynid_mem_83781)\n{\n    #define segscan_tblock_sizze_75141 (do_DBSCAN_doublezisegscan_75146zisegscan_tblock_sizze_75141)\n    #define chunk_sizze_83772 (do_DBSCAN_doublezisegscan_75146zichunk_sizze_83772)\n    \n    volatile __local unsigned char *local_mem_83791_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83791_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75141), chunk_sizze_83772 * segscan_tblock_sizze_75141 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75141), chunk_sizze_83772 * segscan_tblock_sizze_75141 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83784;\n    int32_t tblock_sizze_83787;\n    int32_t wave_sizze_83786;\n    int32_t block_id_83785;\n    int32_t global_tid_83783;\n    int64_t phys_tid_75146;\n    int32_t chunk_sizze_32b_83788;\n    int64_t byte_offsets_83789;\n    int64_t warp_byte_offset_83790;\n    __local unsigned char *local_mem_83791;\n    int64_t trans_arr_len_83792;\n    int64_t phys_block_id_83798;\n    int64_t virtloop_bound_83799;\n    \n    local_tid_83784 = get_local_id(0);\n    tblock_sizze_83787 = get_local_size(0);\n    wave_sizze_83786 = LOCKSTEP_WIDTH;\n    block_id_83785 = get_tblock_id(0);\n    global_tid_83783 = b", "lock_id_83785 * tblock_sizze_83787 + local_tid_83784;\n    phys_tid_75146 = sext_i32_i64(global_tid_83783);\n    chunk_sizze_32b_83788 = sext_i64_i32(chunk_sizze_83772);\n    byte_offsets_83789 = segscan_tblock_sizze_75141 * (int64_t) 8;\n    warp_byte_offset_83790 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83791 = (__local unsigned char *) local_mem_83791_backing_0;\n    trans_arr_len_83792 = chunk_sizze_83772 * segscan_tblock_sizze_75141;\n    phys_block_id_83798 = get_tblock_id(0);\n    virtloop_bound_83799 = sdiv_up64(num_virt_blocks_83773 - phys_block_id_83798, num_tblocks_75143);\n    for (int64_t virtloop_i_83800 = 0; virtloop_i_83800 < virtloop_bound_83799; virtloop_i_83800++) {\n        int64_t dynamic_id_83801;\n        int64_t block_offset_83802;\n        int64_t sgm_idx_83803;\n        int32_t boundary_83804;\n        int32_t segsizze_compact_83805;\n        int64_t private_mem_83806[chunk_sizze_83772];\n        int64_t thd_offset_83808;\n        int64_t acc_83824;\n        int64_t prefix_83834;\n        bool block_new_sgm_83835;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83784 == 0) {\n                dynamic_id_83801 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83781)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83791)[(int64_t) 0] = dynamic_id_83801;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83801 == num_virt_blocks_83773 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83781)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83801 = ((__local int32_t *) local_mem_83791)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n   ", "     block_offset_83802 = dynamic_id_83801 * chunk_sizze_83772 * segscan_tblock_sizze_75141;\n        sgm_idx_83803 = smod64(block_offset_83802, j_m_i_62183);\n        boundary_83804 = sext_i64_i32(smin64(chunk_sizze_83772 * segscan_tblock_sizze_75141, j_m_i_62183 - sgm_idx_83803));\n        segsizze_compact_83805 = sext_i64_i32(smin64(chunk_sizze_83772 * segscan_tblock_sizze_75141, j_m_i_62183));\n        thd_offset_83808 = block_offset_83802 + sext_i32_i64(local_tid_83784);\n        // Load and map\n        {\n            for (int64_t i_83809 = 0; i_83809 < chunk_sizze_83772; i_83809++) {\n                int64_t virt_tid_83810 = thd_offset_83808 + i_83809 * segscan_tblock_sizze_75141;\n                int64_t slice_83811 = j_m_i_62183;\n                int64_t gtid_75145 = virt_tid_83810;\n                int64_t remnant_83812 = virt_tid_83810 - gtid_75145;\n                \n                if (slt64(virt_tid_83810, j_m_i_62183)) {\n                    int64_t slice_78058 = partition_sizze_62142 + gtid_75145;\n                    bool eta_p_65213 = ((__global bool *) mem_82022)[slice_78058];\n                    int64_t defunc_0_f_res_65214 = btoi_bool_i64(eta_p_65213);\n                    \n                    ((__global int64_t *) mem_82054)[gtid_75145] = defunc_0_f_res_65214;\n                    private_mem_83806[i_83809] = defunc_0_f_res_65214;\n                } else {\n                    private_mem_83806[i_83809] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83813 = 0; i_83813 < chunk_sizze_83772; i_83813++) {\n                int64_t sharedIdx_83814 = sext_i32_i64(local_tid_83784) + i_83813 * segscan_tblock_sizze_75141;\n                int64_t tmp_83815 = private_mem_83806[i_83813];\n                \n                ((__local int64_t *) local_mem_83791)[sharedIdx_83814] = tmp_83815;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (in",
                                    "t64_t i_83816 = 0; i_83816 < chunk_sizze_83772; i_83816++) {\n                int64_t sharedIdx_83817 = sext_i32_i64(local_tid_83784) * chunk_sizze_83772 + i_83816;\n                int64_t tmp_83818 = ((__local int64_t *) local_mem_83791)[sharedIdx_83817];\n                \n                private_mem_83806[i_83816] = tmp_83818;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83819 = 0; i_83819 < chunk_sizze_83772 - (int64_t) 1; i_83819++) {\n                int64_t eta_p_62339;\n                int64_t eta_p_62340;\n                \n                eta_p_62339 = private_mem_83806[i_83819];\n                eta_p_62340 = private_mem_83806[i_83819 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_62341 = add64(eta_p_62339, eta_p_62340);\n                \n                private_mem_83806[i_83819 + (int64_t) 1] = defunc_0_op_res_62341;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83820 = private_mem_83806[chunk_sizze_83772 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = tmp_83820;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83821;\n            int64_t eta_p_83822;\n            int64_t eta_p_83825;\n            int64_t eta_p_83826;\n            bool ltid_in_bounds_83828 = slt64(sext_i32_i64(local_tid_83784), num_virt_threads_83774);\n            int32_t skip_threads_83829;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83828) {\n                    eta_p_83822 = ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)];\n                    if ((local_tid_83784 - squot32(local_tid_83784, 32) * 32) == 0) {\n                        eta_p_83821 = eta_p_83822;\n                    }\n                }\n     ", "       }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83829 = 1;\n                while (slt32(skip_threads_83829, 32)) {\n                    bool thread_active_83830 = sle32(skip_threads_83829, local_tid_83784 - squot32(local_tid_83784, 32) * 32) && ltid_in_bounds_83828;\n                    \n                    if (thread_active_83830) {\n                        // read operands\n                        {\n                            eta_p_83821 = ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784) - sext_i32_i64(skip_threads_83829)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83830) {\n                            int64_t defunc_0_op_res_83823 = add64(eta_p_83821, eta_p_83822);\n                            \n                            eta_p_83821 = defunc_0_op_res_83823;\n                        }\n                    }\n                    if (sle32(wave_sizze_83786, skip_threads_83829)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83830) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = eta_p_83821;\n                            eta_p_83822 = eta_p_83821;\n                        }\n                    }\n                    if (sle32(wave_sizze_83786, skip_threads_83829)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83829 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83784 - squot32(local_tid_83784, 32) * 32) == 31 && ltid_in_bounds_83828) {\n                    ((volatile __local ", "int64_t *) local_mem_83791)[sext_i32_i64(squot32(local_tid_83784, 32))] = eta_p_83821;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83831;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83784, 32) == 0 && ltid_in_bounds_83828) {\n                        eta_p_83826 = ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)];\n                        if ((local_tid_83784 - squot32(local_tid_83784, 32) * 32) == 0) {\n                            eta_p_83825 = eta_p_83826;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83831 = 1;\n                    while (slt32(skip_threads_83831, 32)) {\n                        bool thread_active_83832 = sle32(skip_threads_83831, local_tid_83784 - squot32(local_tid_83784, 32) * 32) && (squot32(local_tid_83784, 32) == 0 && ltid_in_bounds_83828);\n                        \n                        if (thread_active_83832) {\n                            // read operands\n                            {\n                                eta_p_83825 = ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784) - sext_i32_i64(skip_threads_83831)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83832) {\n                                int64_t defunc_0_op_res_83827 = add64(eta_p_83825, eta_p_83826);\n                                \n                                eta_p_83825 = defunc_0_op_res_83827;\n                            }\n                        }\n                        if (sle32(wave_sizze_83786, skip_thread",
                                    "s_83831)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83832) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = eta_p_83825;\n                                eta_p_83826 = eta_p_83825;\n                            }\n                        }\n                        if (sle32(wave_sizze_83786, skip_threads_83831)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83831 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83833 = squot32(local_tid_83784, 32) == 0 || !ltid_in_bounds_83828;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83833) {\n                        eta_p_83822 = eta_p_83821;\n                        eta_p_83821 = ((__local int64_t *) local_mem_83791)[sext_i32_i64(squot32(local_tid_83784, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83833) {\n                        int64_t defunc_0_op_res_83823 = add64(eta_p_83821, eta_p_83822);\n                        \n                        eta_p_83821 = defunc_0_op_res_83823;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83833) {\n                        ((__local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = eta_p_83821;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(", "local_tid_83784, 32) == 0 && ltid_in_bounds_83828) {\n                    ((__local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = eta_p_83822;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83784 == 0) {\n                acc_83824 = ((__local int64_t *) local_mem_83791)[segscan_tblock_sizze_75141 - (int64_t) 1];\n            } else {\n                acc_83824 = ((__local int64_t *) local_mem_83791)[sext_i32_i64(local_tid_83784) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83834 = (int64_t) 0;\n        block_new_sgm_83835 = sgm_idx_83803 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83835 && local_tid_83784 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83779)[dynamic_id_83801] = acc_83824;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83775)[dynamic_id_83801] = (int8_t) 2;\n                acc_83824 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83835 && slt32(local_tid_83784, wave_sizze_83786)) {\n                if (local_tid_83784 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83777)[dynamic_id_83801] = acc_83824;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83775)[dynamic_id_83801] = (int8_t) 1;\n                    \n                    int8_t tmp_83836 = ((volatile __global int8_t *) status_flags_mem_83775)[dynamic_id_83801 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83791)[(int64_t) 0] = tmp_83836;\n                }\n                mem_fence_local();\n                \n                int8_t status_83837 = ((__local int8_t *) local_mem_83791)[(int64_t) 0];\n                \n                if (status_83837 == (int8_t) 2) {\n                    if (", "local_tid_83784 == 0) {\n                        prefix_83834 = ((volatile __global int64_t *) incprefixes_mem_83779)[dynamic_id_83801 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83838 = sext_i64_i32(dynamic_id_83801 - sext_i32_i64(wave_sizze_83786));\n                    \n                    while (slt32(wave_sizze_83786 * -1, readOffset_83838)) {\n                        int32_t read_i_83839 = readOffset_83838 + local_tid_83784;\n                        int64_t aggr_83840 = (int64_t) 0;\n                        int8_t flag_83841 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83839)) {\n                            flag_83841 = ((volatile __global int8_t *) status_flags_mem_83775)[sext_i32_i64(read_i_83839)];\n                            if (flag_83841 == (int8_t) 2) {\n                                aggr_83840 = ((volatile __global int64_t *) incprefixes_mem_83779)[sext_i32_i64(read_i_83839)];\n                            } else if (flag_83841 == (int8_t) 1) {\n                                aggr_83840 = ((volatile __global int64_t *) aggregates_mem_83777)[sext_i32_i64(read_i_83839)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83791)[(int64_t) 4 + sext_i32_i64(local_tid_83784)] = aggr_83840;\n                        ((__local int8_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = flag_83841;\n                        flag_83841 = ((__local int8_t *) local_mem_83791)[sext_i32_i64(wave_sizze_83786) - (int64_t) 1];\n                        if (slt8(flag_83841, (int8_t) 2)) {\n                            int8_t flg_x_83845;\n                            int8_t flg_y_83846;\n                            int64_t eta_p_83842;\n                            int64_t eta_p_83843;\n                            int32_t skip_threads_83847;\n                            \n                            // read input for in-block scan\n        ",
                                    "                    {\n                                flg_y_83846 = ((volatile __local int8_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)];\n                                eta_p_83843 = ((volatile __local int64_t *) local_mem_83791)[(int64_t) 4 + sext_i32_i64(local_tid_83784)];\n                                if ((local_tid_83784 - squot32(local_tid_83784, 32) * 32) == 0) {\n                                    eta_p_83842 = eta_p_83843;\n                                    flg_x_83845 = flg_y_83846;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83847 = 1;\n                                while (slt32(skip_threads_83847, 32)) {\n                                    if (sle32(skip_threads_83847, local_tid_83784 - squot32(local_tid_83784, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83845 = ((volatile __local int8_t *) local_mem_83791)[sext_i32_i64(local_tid_83784) - sext_i32_i64(skip_threads_83847)];\n                                            eta_p_83842 = ((volatile __local int64_t *) local_mem_83791)[(int64_t) 4 + (sext_i32_i64(local_tid_83784) - sext_i32_i64(skip_threads_83847))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83846 == (int8_t) 2 || flg_y_83846 == (int8_t) 0) {\n                                                flg_x_83845 = flg_y_83846;\n                                                eta_p_83842 = eta_p_83843;\n                                            } else {\n                                                int64_t defunc_0_op_res_83844 = add64(eta_p_83842, eta_p_83843);\n                                              ", "  \n                                                eta_p_83842 = defunc_0_op_res_83844;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83791)[sext_i32_i64(local_tid_83784)] = flg_x_83845;\n                                            flg_y_83846 = flg_x_83845;\n                                            ((volatile __local int64_t *) local_mem_83791)[(int64_t) 4 + sext_i32_i64(local_tid_83784)] = eta_p_83842;\n                                            eta_p_83843 = eta_p_83842;\n                                        }\n                                    }\n                                    skip_threads_83847 *= 2;\n                                }\n                            }\n                        }\n                        flag_83841 = ((__local int8_t *) local_mem_83791)[sext_i32_i64(wave_sizze_83786) - (int64_t) 1];\n                        aggr_83840 = ((__local int64_t *) local_mem_83791)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83786) - (int64_t) 1)];\n                        if (flag_83841 == (int8_t) 2) {\n                            readOffset_83838 = wave_sizze_83786 * -1;\n                        } else if (flag_83841 == (int8_t) 1) {\n                            readOffset_83838 -= wave_sizze_83786;\n                        }\n                        if (slt8((int8_t) 0, flag_83841)) {\n                            int64_t eta_p_83848 = aggr_83840;\n                            int64_t eta_p_83849 = prefix_83834;\n                            int64_t defunc_0_op_res_83850 = add64(eta_p_83848, eta_p_83849);\n                            \n                            prefix_83834 = defunc_0_op_res_83850;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83784 == 0) {", "\n                    if (boundary_83804 == sext_i64_i32(segscan_tblock_sizze_75141 * chunk_sizze_83772)) {\n                        int64_t eta_p_83851 = prefix_83834;\n                        int64_t eta_p_83852 = acc_83824;\n                        int64_t defunc_0_op_res_83853 = add64(eta_p_83851, eta_p_83852);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83779)[dynamic_id_83801] = defunc_0_op_res_83853;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83775)[dynamic_id_83801] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83791)[(int64_t) 4] = prefix_83834;\n                    acc_83824 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83801 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83834 = ((__local int64_t *) local_mem_83791)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83854;\n            int64_t eta_p_83855;\n            int64_t eta_p_83857 = prefix_83834;\n            int64_t eta_p_83858 = acc_83824;\n            \n            if (slt32(local_tid_83784 * chunk_sizze_32b_83788, boundary_83804) && !block_new_sgm_83835) {\n                int64_t defunc_0_op_res_83859 = add64(eta_p_83857, eta_p_83858);\n                \n                eta_p_83854 = defunc_0_op_res_83859;\n            } else {\n                eta_p_83854 = acc_83824;\n            }\n            \n            int32_t stopping_point_83860 = segsizze_compact_83805 - srem32(local_tid_83784 * chunk_sizze_32b_83788 - 1 + segsizze_compact_83805 - boundary_83804, segsizze_compact_83805);\n            \n            for (int64_t i_83861 = 0; i_83861 < chunk_sizze_83772; i_83861++) {\n                if (slt32(sext_i64_i32(i_83861), stopping_point_83860 - 1)) {\n                    eta_p_83855 ",
                                    "= private_mem_83806[i_83861];\n                    \n                    int64_t defunc_0_op_res_83856 = add64(eta_p_83854, eta_p_83855);\n                    \n                    private_mem_83806[i_83861] = defunc_0_op_res_83856;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83862 = 0; i_83862 < chunk_sizze_83772; i_83862++) {\n                int64_t sharedIdx_83863 = sext_i32_i64(local_tid_83784) * chunk_sizze_83772 + i_83862;\n                int64_t tmp_83864 = private_mem_83806[i_83862];\n                \n                ((__local int64_t *) local_mem_83791)[sharedIdx_83863] = tmp_83864;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83865 = 0; i_83865 < chunk_sizze_83772; i_83865++) {\n                int64_t flat_idx_83866 = thd_offset_83808 + i_83865 * segscan_tblock_sizze_75141;\n                int64_t slice_83867 = j_m_i_62183;\n                int64_t gtid_75145 = flat_idx_83866;\n                int64_t remnant_83868 = flat_idx_83866 - gtid_75145;\n                \n                if (slt64(flat_idx_83866, j_m_i_62183)) {\n                    int64_t tmp_83869 = ((__local int64_t *) local_mem_83791)[flat_idx_83866 - block_offset_83802];\n                    \n                    ((__global int64_t *) mem_82052)[gtid_75145] = tmp_83869;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75141\n    #undef chunk_sizze_83772\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75194_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75194(__global int *global_failure, int64_t n_48679, int64_t num_tblocks_75191, int64_t num_virt_blocks_83910, int64_t num_virt_threads_83911, __global unsigned char *mem_82070, __global unsigned char *mem_82073, __global unsigned char *mem_82075, __global unsigned char *status_flags_mem_83912, __global un", "signed char *aggregates_mem_83914, __global unsigned char *incprefixes_mem_83916, __global unsigned char *global_dynid_mem_83918)\n{\n    #define segscan_tblock_sizze_75189 (do_DBSCAN_doublezisegscan_75194zisegscan_tblock_sizze_75189)\n    #define chunk_sizze_83909 (do_DBSCAN_doublezisegscan_75194zichunk_sizze_83909)\n    \n    volatile __local unsigned char *local_mem_83928_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83928_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75189), chunk_sizze_83909 * segscan_tblock_sizze_75189 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75189), chunk_sizze_83909 * segscan_tblock_sizze_75189 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83921;\n    int32_t tblock_sizze_83924;\n    int32_t wave_sizze_83923;\n    int32_t block_id_83922;\n    int32_t global_tid_83920;\n    int64_t phys_tid_75194;\n    int32_t chunk_sizze_32b_83925;\n    int64_t byte_offsets_83926;\n    int64_t warp_byte_offset_83927;\n    __local unsigned char *local_mem_83928;\n    int64_t trans_arr_len_83929;\n    int64_t phys_block_id_83935;\n    int64_t virtloop_bound_83936;\n    \n    local_tid_83921 = get_local_id(0);\n    tblock_sizze_83924 = get_local_size(0);\n    wave_sizze_83923 = LOCKSTEP_WIDTH;\n    block_id_83922 = get_tblock_id(0);\n    global_tid_83920 = block_id_83922 * tblock_sizze_83924 + local_tid_83921;\n    phys_tid_75194 = sext_i32_i64(global_tid_83920);\n    chunk_sizze_32b_83925 = sext_i64_i32(chunk_sizze_83909);\n    byte_offsets_83926 = segscan_tblock_sizze_75189 * (int64_t) 8;\n    warp_byte_offset_83927 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83928 = (__local unsigned char *) local_mem_83928_backing_0;\n    trans_arr_len_83929 = chunk_sizze_83909 * segscan_tblock_sizze_75189;\n    phys_block_id_83935 = get_tblock_id(0);\n    virtloop_bound_83936", " = sdiv_up64(num_virt_blocks_83910 - phys_block_id_83935, num_tblocks_75191);\n    for (int64_t virtloop_i_83937 = 0; virtloop_i_83937 < virtloop_bound_83936; virtloop_i_83937++) {\n        int64_t dynamic_id_83938;\n        int64_t block_offset_83939;\n        int64_t sgm_idx_83940;\n        int32_t boundary_83941;\n        int32_t segsizze_compact_83942;\n        int64_t private_mem_83943[chunk_sizze_83909];\n        int64_t thd_offset_83945;\n        int64_t acc_83961;\n        int64_t prefix_83971;\n        bool block_new_sgm_83972;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83921 == 0) {\n                dynamic_id_83938 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83918)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83928)[(int64_t) 0] = dynamic_id_83938;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83938 == num_virt_blocks_83910 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83918)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83938 = ((__local int32_t *) local_mem_83928)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83939 = dynamic_id_83938 * chunk_sizze_83909 * segscan_tblock_sizze_75189;\n        sgm_idx_83940 = smod64(block_offset_83939, n_48679);\n        boundary_83941 = sext_i64_i32(smin64(chunk_sizze_83909 * segscan_tblock_sizze_75189, n_48679 - sgm_idx_83940));\n        segsizze_compact_83942 = sext_i64_i32(smin64(chunk_sizze_83909 * segscan_tblock_sizze_75189, n_48679));\n        thd_offset_83945 = block_offset_83939 + sext_i32_i64(local_tid_83921);\n        // Load and map\n        {\n            for (int64_t i_83946 = 0; i_8394",
                                    "6 < chunk_sizze_83909; i_83946++) {\n                int64_t virt_tid_83947 = thd_offset_83945 + i_83946 * segscan_tblock_sizze_75189;\n                int64_t slice_83948 = n_48679;\n                int64_t gtid_75193 = virt_tid_83947;\n                int64_t remnant_83949 = virt_tid_83947 - gtid_75193;\n                \n                if (slt64(virt_tid_83947, n_48679)) {\n                    bool eta_p_64401 = ((__global bool *) mem_82070)[gtid_75193];\n                    int64_t defunc_0_f_res_64402 = btoi_bool_i64(eta_p_64401);\n                    \n                    ((__global int64_t *) mem_82075)[gtid_75193] = defunc_0_f_res_64402;\n                    private_mem_83943[i_83946] = defunc_0_f_res_64402;\n                } else {\n                    private_mem_83943[i_83946] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83950 = 0; i_83950 < chunk_sizze_83909; i_83950++) {\n                int64_t sharedIdx_83951 = sext_i32_i64(local_tid_83921) + i_83950 * segscan_tblock_sizze_75189;\n                int64_t tmp_83952 = private_mem_83943[i_83950];\n                \n                ((__local int64_t *) local_mem_83928)[sharedIdx_83951] = tmp_83952;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83953 = 0; i_83953 < chunk_sizze_83909; i_83953++) {\n                int64_t sharedIdx_83954 = sext_i32_i64(local_tid_83921) * chunk_sizze_83909 + i_83953;\n                int64_t tmp_83955 = ((__local int64_t *) local_mem_83928)[sharedIdx_83954];\n                \n                private_mem_83943[i_83953] = tmp_83955;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83956 = 0; i_83956 < chunk_sizze_83909 - (int64_t) 1; i_83956++) {\n                int64_t eta_p_62284;\n                int64_t eta_p_62285;\n                \n                eta_p_622", "84 = private_mem_83943[i_83956];\n                eta_p_62285 = private_mem_83943[i_83956 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_62286 = add64(eta_p_62284, eta_p_62285);\n                \n                private_mem_83943[i_83956 + (int64_t) 1] = defunc_0_op_res_62286;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83957 = private_mem_83943[chunk_sizze_83909 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = tmp_83957;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83958;\n            int64_t eta_p_83959;\n            int64_t eta_p_83962;\n            int64_t eta_p_83963;\n            bool ltid_in_bounds_83965 = slt64(sext_i32_i64(local_tid_83921), num_virt_threads_83911);\n            int32_t skip_threads_83966;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83965) {\n                    eta_p_83959 = ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)];\n                    if ((local_tid_83921 - squot32(local_tid_83921, 32) * 32) == 0) {\n                        eta_p_83958 = eta_p_83959;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83966 = 1;\n                while (slt32(skip_threads_83966, 32)) {\n                    bool thread_active_83967 = sle32(skip_threads_83966, local_tid_83921 - squot32(local_tid_83921, 32) * 32) && ltid_in_bounds_83965;\n                    \n                    if (thread_active_83967) {\n                        // read operands\n                        {\n                            eta_p_83958 = ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921) - sext_i32_i64(skip_threads_83966)];\n                     ", "   }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83967) {\n                            int64_t defunc_0_op_res_83960 = add64(eta_p_83958, eta_p_83959);\n                            \n                            eta_p_83958 = defunc_0_op_res_83960;\n                        }\n                    }\n                    if (sle32(wave_sizze_83923, skip_threads_83966)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83967) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = eta_p_83958;\n                            eta_p_83959 = eta_p_83958;\n                        }\n                    }\n                    if (sle32(wave_sizze_83923, skip_threads_83966)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83966 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83921 - squot32(local_tid_83921, 32) * 32) == 31 && ltid_in_bounds_83965) {\n                    ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(squot32(local_tid_83921, 32))] = eta_p_83958;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83968;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83921, 32) == 0 && ltid_in_bounds_83965) {\n                        eta_p_83963 = ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)];\n                        if ((local_tid_83921",
                                    " - squot32(local_tid_83921, 32) * 32) == 0) {\n                            eta_p_83962 = eta_p_83963;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83968 = 1;\n                    while (slt32(skip_threads_83968, 32)) {\n                        bool thread_active_83969 = sle32(skip_threads_83968, local_tid_83921 - squot32(local_tid_83921, 32) * 32) && (squot32(local_tid_83921, 32) == 0 && ltid_in_bounds_83965);\n                        \n                        if (thread_active_83969) {\n                            // read operands\n                            {\n                                eta_p_83962 = ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921) - sext_i32_i64(skip_threads_83968)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83969) {\n                                int64_t defunc_0_op_res_83964 = add64(eta_p_83962, eta_p_83963);\n                                \n                                eta_p_83962 = defunc_0_op_res_83964;\n                            }\n                        }\n                        if (sle32(wave_sizze_83923, skip_threads_83968)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83969) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = eta_p_83962;\n                                eta_p_83963 = eta_p_83962;\n                            }\n                        }\n                        if (sle32(wave_sizze_83923, skip_threads_83968)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                      ", "  skip_threads_83968 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83970 = squot32(local_tid_83921, 32) == 0 || !ltid_in_bounds_83965;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83970) {\n                        eta_p_83959 = eta_p_83958;\n                        eta_p_83958 = ((__local int64_t *) local_mem_83928)[sext_i32_i64(squot32(local_tid_83921, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83970) {\n                        int64_t defunc_0_op_res_83960 = add64(eta_p_83958, eta_p_83959);\n                        \n                        eta_p_83958 = defunc_0_op_res_83960;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83970) {\n                        ((__local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = eta_p_83958;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83921, 32) == 0 && ltid_in_bounds_83965) {\n                    ((__local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = eta_p_83959;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83921 == 0) {\n                acc_83961 = ((__local int64_t *) local_mem_83928)[segscan_tblock_sizze_75189 - (int64_t) 1];\n            } else {\n                acc_83961 = ((__local int64_t *) local_mem_83928)[sext_i32_i64(local_tid_83921) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83971 ", "= (int64_t) 0;\n        block_new_sgm_83972 = sgm_idx_83940 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83972 && local_tid_83921 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83916)[dynamic_id_83938] = acc_83961;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83912)[dynamic_id_83938] = (int8_t) 2;\n                acc_83961 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83972 && slt32(local_tid_83921, wave_sizze_83923)) {\n                if (local_tid_83921 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83914)[dynamic_id_83938] = acc_83961;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83912)[dynamic_id_83938] = (int8_t) 1;\n                    \n                    int8_t tmp_83973 = ((volatile __global int8_t *) status_flags_mem_83912)[dynamic_id_83938 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83928)[(int64_t) 0] = tmp_83973;\n                }\n                mem_fence_local();\n                \n                int8_t status_83974 = ((__local int8_t *) local_mem_83928)[(int64_t) 0];\n                \n                if (status_83974 == (int8_t) 2) {\n                    if (local_tid_83921 == 0) {\n                        prefix_83971 = ((volatile __global int64_t *) incprefixes_mem_83916)[dynamic_id_83938 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83975 = sext_i64_i32(dynamic_id_83938 - sext_i32_i64(wave_sizze_83923));\n                    \n                    while (slt32(wave_sizze_83923 * -1, readOffset_83975)) {\n                        int32_t read_i_83976 = readOffset_83975 + local_tid_83921;\n                        int64_t aggr_83977 = (int64_t) 0;\n                        int8_t flag_83978 = (int8_t) 0;\n                        \n             ",
                                    "           if (sle32(0, read_i_83976)) {\n                            flag_83978 = ((volatile __global int8_t *) status_flags_mem_83912)[sext_i32_i64(read_i_83976)];\n                            if (flag_83978 == (int8_t) 2) {\n                                aggr_83977 = ((volatile __global int64_t *) incprefixes_mem_83916)[sext_i32_i64(read_i_83976)];\n                            } else if (flag_83978 == (int8_t) 1) {\n                                aggr_83977 = ((volatile __global int64_t *) aggregates_mem_83914)[sext_i32_i64(read_i_83976)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83928)[(int64_t) 4 + sext_i32_i64(local_tid_83921)] = aggr_83977;\n                        ((__local int8_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = flag_83978;\n                        flag_83978 = ((__local int8_t *) local_mem_83928)[sext_i32_i64(wave_sizze_83923) - (int64_t) 1];\n                        if (slt8(flag_83978, (int8_t) 2)) {\n                            int8_t flg_x_83982;\n                            int8_t flg_y_83983;\n                            int64_t eta_p_83979;\n                            int64_t eta_p_83980;\n                            int32_t skip_threads_83984;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83983 = ((volatile __local int8_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)];\n                                eta_p_83980 = ((volatile __local int64_t *) local_mem_83928)[(int64_t) 4 + sext_i32_i64(local_tid_83921)];\n                                if ((local_tid_83921 - squot32(local_tid_83921, 32) * 32) == 0) {\n                                    eta_p_83979 = eta_p_83980;\n                                    flg_x_83982 = flg_y_83983;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers n", "eeded)\n                            {\n                                skip_threads_83984 = 1;\n                                while (slt32(skip_threads_83984, 32)) {\n                                    if (sle32(skip_threads_83984, local_tid_83921 - squot32(local_tid_83921, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83982 = ((volatile __local int8_t *) local_mem_83928)[sext_i32_i64(local_tid_83921) - sext_i32_i64(skip_threads_83984)];\n                                            eta_p_83979 = ((volatile __local int64_t *) local_mem_83928)[(int64_t) 4 + (sext_i32_i64(local_tid_83921) - sext_i32_i64(skip_threads_83984))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83983 == (int8_t) 2 || flg_y_83983 == (int8_t) 0) {\n                                                flg_x_83982 = flg_y_83983;\n                                                eta_p_83979 = eta_p_83980;\n                                            } else {\n                                                int64_t defunc_0_op_res_83981 = add64(eta_p_83979, eta_p_83980);\n                                                \n                                                eta_p_83979 = defunc_0_op_res_83981;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83928)[sext_i32_i64(local_tid_83921)] = flg_x_83982;\n                                            flg_y_83983 = flg_x_83982;\n                                            ((volatile __local int64_t *) local_mem_83928)[(int64_t) 4 + sext_i32_i64(local_tid_83921)] = eta_p_83979;\n          ", "                                  eta_p_83980 = eta_p_83979;\n                                        }\n                                    }\n                                    skip_threads_83984 *= 2;\n                                }\n                            }\n                        }\n                        flag_83978 = ((__local int8_t *) local_mem_83928)[sext_i32_i64(wave_sizze_83923) - (int64_t) 1];\n                        aggr_83977 = ((__local int64_t *) local_mem_83928)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83923) - (int64_t) 1)];\n                        if (flag_83978 == (int8_t) 2) {\n                            readOffset_83975 = wave_sizze_83923 * -1;\n                        } else if (flag_83978 == (int8_t) 1) {\n                            readOffset_83975 -= wave_sizze_83923;\n                        }\n                        if (slt8((int8_t) 0, flag_83978)) {\n                            int64_t eta_p_83985 = aggr_83977;\n                            int64_t eta_p_83986 = prefix_83971;\n                            int64_t defunc_0_op_res_83987 = add64(eta_p_83985, eta_p_83986);\n                            \n                            prefix_83971 = defunc_0_op_res_83987;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83921 == 0) {\n                    if (boundary_83941 == sext_i64_i32(segscan_tblock_sizze_75189 * chunk_sizze_83909)) {\n                        int64_t eta_p_83988 = prefix_83971;\n                        int64_t eta_p_83989 = acc_83961;\n                        int64_t defunc_0_op_res_83990 = add64(eta_p_83988, eta_p_83989);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83916)[dynamic_id_83938] = defunc_0_op_res_83990;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83912)[dynamic_id_83938] = (int8_t) 2;\n                    }\n       ",
                                    "             ((__local int64_t *) local_mem_83928)[(int64_t) 4] = prefix_83971;\n                    acc_83961 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83938 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83971 = ((__local int64_t *) local_mem_83928)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83991;\n            int64_t eta_p_83992;\n            int64_t eta_p_83994 = prefix_83971;\n            int64_t eta_p_83995 = acc_83961;\n            \n            if (slt32(local_tid_83921 * chunk_sizze_32b_83925, boundary_83941) && !block_new_sgm_83972) {\n                int64_t defunc_0_op_res_83996 = add64(eta_p_83994, eta_p_83995);\n                \n                eta_p_83991 = defunc_0_op_res_83996;\n            } else {\n                eta_p_83991 = acc_83961;\n            }\n            \n            int32_t stopping_point_83997 = segsizze_compact_83942 - srem32(local_tid_83921 * chunk_sizze_32b_83925 - 1 + segsizze_compact_83942 - boundary_83941, segsizze_compact_83942);\n            \n            for (int64_t i_83998 = 0; i_83998 < chunk_sizze_83909; i_83998++) {\n                if (slt32(sext_i64_i32(i_83998), stopping_point_83997 - 1)) {\n                    eta_p_83992 = private_mem_83943[i_83998];\n                    \n                    int64_t defunc_0_op_res_83993 = add64(eta_p_83991, eta_p_83992);\n                    \n                    private_mem_83943[i_83998] = defunc_0_op_res_83993;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83999 = 0; i_83999 < chunk_sizze_83909; i_83999++) {\n                int64_t sharedIdx_84000 = sext_i32_i64(local_tid_83921) * chunk_sizze_83909 + i_83999;\n                int64_t tmp_84001 = private_mem_83943[i_83999];\n                \n             ", "   ((__local int64_t *) local_mem_83928)[sharedIdx_84000] = tmp_84001;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84002 = 0; i_84002 < chunk_sizze_83909; i_84002++) {\n                int64_t flat_idx_84003 = thd_offset_83945 + i_84002 * segscan_tblock_sizze_75189;\n                int64_t slice_84004 = n_48679;\n                int64_t gtid_75193 = flat_idx_84003;\n                int64_t remnant_84005 = flat_idx_84003 - gtid_75193;\n                \n                if (slt64(flat_idx_84003, n_48679)) {\n                    int64_t tmp_84006 = ((__local int64_t *) local_mem_83928)[flat_idx_84003 - block_offset_83939];\n                    \n                    ((__global int64_t *) mem_82073)[gtid_75193] = tmp_84006;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75189\n    #undef chunk_sizze_83909\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75433_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75433(__global int *global_failure, int64_t conc_tmp_62382, int64_t dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, int64_t num_tblocks_75430, int64_t num_virt_blocks_84054, int64_t num_virt_threads_84055, __global unsigned char *mem_82193, __global unsigned char *mem_82203, __global unsigned char *mem_82205, __global unsigned char *status_flags_mem_84056, __global unsigned char *aggregates_mem_84058, __global unsigned char *incprefixes_mem_84060, __global unsigned char *global_dynid_mem_84062)\n{\n    #define segscan_tblock_sizze_75428 (do_DBSCAN_doublezisegscan_75433zisegscan_tblock_sizze_75428)\n    #define chunk_sizze_84053 (do_DBSCAN_doublezisegscan_75433zichunk_sizze_84053)\n    \n    volatile __local unsigned char *local_mem_84072_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84072_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75428), chunk_sizze_84053 * segscan_tblock_sizze_754", "28 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75428), chunk_sizze_84053 * segscan_tblock_sizze_75428 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84065;\n    int32_t tblock_sizze_84068;\n    int32_t wave_sizze_84067;\n    int32_t block_id_84066;\n    int32_t global_tid_84064;\n    int64_t phys_tid_75433;\n    int32_t chunk_sizze_32b_84069;\n    int64_t byte_offsets_84070;\n    int64_t warp_byte_offset_84071;\n    __local unsigned char *local_mem_84072;\n    int64_t trans_arr_len_84073;\n    int64_t phys_block_id_84079;\n    int64_t virtloop_bound_84080;\n    \n    local_tid_84065 = get_local_id(0);\n    tblock_sizze_84068 = get_local_size(0);\n    wave_sizze_84067 = LOCKSTEP_WIDTH;\n    block_id_84066 = get_tblock_id(0);\n    global_tid_84064 = block_id_84066 * tblock_sizze_84068 + local_tid_84065;\n    phys_tid_75433 = sext_i32_i64(global_tid_84064);\n    chunk_sizze_32b_84069 = sext_i64_i32(chunk_sizze_84053);\n    byte_offsets_84070 = segscan_tblock_sizze_75428 * (int64_t) 8;\n    warp_byte_offset_84071 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84072 = (__local unsigned char *) local_mem_84072_backing_0;\n    trans_arr_len_84073 = chunk_sizze_84053 * segscan_tblock_sizze_75428;\n    phys_block_id_84079 = get_tblock_id(0);\n    virtloop_bound_84080 = sdiv_up64(num_virt_blocks_84054 - phys_block_id_84079, num_tblocks_75430);\n    for (int64_t virtloop_i_84081 = 0; virtloop_i_84081 < virtloop_bound_84080; virtloop_i_84081++) {\n        int64_t dynamic_id_84082;\n        int64_t block_offset_84083;\n        int64_t sgm_idx_84084;\n        int32_t boundary_84085;\n        int32_t segsizze_compact_84086;\n        int64_t private_mem_84087[chunk_sizze_84053];\n        int64_t thd_offset_84089;\n        int64_t acc_84105;\n        int64_t prefix_84115;\n        bool block_new_sgm_84116;\n        \n        // First thread in block f",
                                    "etches this block's dynamic_id\n        {\n            if (local_tid_84065 == 0) {\n                dynamic_id_84082 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84062)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_84072)[(int64_t) 0] = dynamic_id_84082;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_84082 == num_virt_blocks_84054 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84062)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_84082 = ((__local int32_t *) local_mem_84072)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_84083 = dynamic_id_84082 * chunk_sizze_84053 * segscan_tblock_sizze_75428;\n        sgm_idx_84084 = smod64(block_offset_84083, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345);\n        boundary_84085 = sext_i64_i32(smin64(chunk_sizze_84053 * segscan_tblock_sizze_75428, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345 - sgm_idx_84084));\n        segsizze_compact_84086 = sext_i64_i32(smin64(chunk_sizze_84053 * segscan_tblock_sizze_75428, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345));\n        thd_offset_84089 = block_offset_84083 + sext_i32_i64(local_tid_84065);\n        // Load and map\n        {\n            for (int64_t i_84090 = 0; i_84090 < chunk_sizze_84053; i_84090++) {\n                int64_t virt_tid_84091 = thd_offset_84089 + i_84090 * segscan_tblock_sizze_75428;\n                int64_t slice_84092 = dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345;\n                int64_t gtid_75432 = virt_tid_84091;\n                int64_t remnant_84093 = virt_tid_84091 - gtid_75432;\n                \n                if (slt64(virt_tid_84091, dzlz7bUZL", "ztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345)) {\n                    int64_t new_index_77881 = squot64(gtid_75432, conc_tmp_62382);\n                    int64_t binop_y_77883 = conc_tmp_62382 * new_index_77881;\n                    int64_t new_index_77884 = gtid_75432 - binop_y_77883;\n                    bool eta_p_66432 = ((__global bool *) mem_82193)[new_index_77881 * conc_tmp_62382 + new_index_77884];\n                    int64_t defunc_0_f_res_66433 = btoi_bool_i64(eta_p_66432);\n                    \n                    ((__global int64_t *) mem_82205)[gtid_75432] = defunc_0_f_res_66433;\n                    private_mem_84087[i_84090] = defunc_0_f_res_66433;\n                } else {\n                    private_mem_84087[i_84090] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_84094 = 0; i_84094 < chunk_sizze_84053; i_84094++) {\n                int64_t sharedIdx_84095 = sext_i32_i64(local_tid_84065) + i_84094 * segscan_tblock_sizze_75428;\n                int64_t tmp_84096 = private_mem_84087[i_84094];\n                \n                ((__local int64_t *) local_mem_84072)[sharedIdx_84095] = tmp_84096;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84097 = 0; i_84097 < chunk_sizze_84053; i_84097++) {\n                int64_t sharedIdx_84098 = sext_i32_i64(local_tid_84065) * chunk_sizze_84053 + i_84097;\n                int64_t tmp_84099 = ((__local int64_t *) local_mem_84072)[sharedIdx_84098];\n                \n                private_mem_84087[i_84097] = tmp_84099;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_84100 = 0; i_84100 < chunk_sizze_84053 - (int64_t) 1; i_84100++) {\n                int64_t eta_p_66434;\n                int64_t eta_p_66435;\n                \n                eta_p_66434 = private_mem_84087[i_84100];\n            ", "    eta_p_66435 = private_mem_84087[i_84100 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_66436 = add64(eta_p_66434, eta_p_66435);\n                \n                private_mem_84087[i_84100 + (int64_t) 1] = defunc_0_op_res_66436;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_84101 = private_mem_84087[chunk_sizze_84053 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = tmp_84101;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_84102;\n            int64_t eta_p_84103;\n            int64_t eta_p_84106;\n            int64_t eta_p_84107;\n            bool ltid_in_bounds_84109 = slt64(sext_i32_i64(local_tid_84065), num_virt_threads_84055);\n            int32_t skip_threads_84110;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_84109) {\n                    eta_p_84103 = ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)];\n                    if ((local_tid_84065 - squot32(local_tid_84065, 32) * 32) == 0) {\n                        eta_p_84102 = eta_p_84103;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_84110 = 1;\n                while (slt32(skip_threads_84110, 32)) {\n                    bool thread_active_84111 = sle32(skip_threads_84110, local_tid_84065 - squot32(local_tid_84065, 32) * 32) && ltid_in_bounds_84109;\n                    \n                    if (thread_active_84111) {\n                        // read operands\n                        {\n                            eta_p_84102 = ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065) - sext_i32_i64(skip_threads_84110)];\n                        }\n                    }\n                  ",
                                    "  // perform operation\n                    {\n                        if (thread_active_84111) {\n                            int64_t defunc_0_op_res_84104 = add64(eta_p_84102, eta_p_84103);\n                            \n                            eta_p_84102 = defunc_0_op_res_84104;\n                        }\n                    }\n                    if (sle32(wave_sizze_84067, skip_threads_84110)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_84111) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = eta_p_84102;\n                            eta_p_84103 = eta_p_84102;\n                        }\n                    }\n                    if (sle32(wave_sizze_84067, skip_threads_84110)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_84110 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84065 - squot32(local_tid_84065, 32) * 32) == 31 && ltid_in_bounds_84109) {\n                    ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(squot32(local_tid_84065, 32))] = eta_p_84102;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_84112;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84065, 32) == 0 && ltid_in_bounds_84109) {\n                        eta_p_84107 = ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)];\n                        if ((local_tid_84065 - squot32(local_tid_84065, 32) * 32) == 0) {", "\n                            eta_p_84106 = eta_p_84107;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84112 = 1;\n                    while (slt32(skip_threads_84112, 32)) {\n                        bool thread_active_84113 = sle32(skip_threads_84112, local_tid_84065 - squot32(local_tid_84065, 32) * 32) && (squot32(local_tid_84065, 32) == 0 && ltid_in_bounds_84109);\n                        \n                        if (thread_active_84113) {\n                            // read operands\n                            {\n                                eta_p_84106 = ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065) - sext_i32_i64(skip_threads_84112)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_84113) {\n                                int64_t defunc_0_op_res_84108 = add64(eta_p_84106, eta_p_84107);\n                                \n                                eta_p_84106 = defunc_0_op_res_84108;\n                            }\n                        }\n                        if (sle32(wave_sizze_84067, skip_threads_84112)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84113) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = eta_p_84106;\n                                eta_p_84107 = eta_p_84106;\n                            }\n                        }\n                        if (sle32(wave_sizze_84067, skip_threads_84112)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84112 *= 2;\n                  ", "  }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_84114 = squot32(local_tid_84065, 32) == 0 || !ltid_in_bounds_84109;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_84114) {\n                        eta_p_84103 = eta_p_84102;\n                        eta_p_84102 = ((__local int64_t *) local_mem_84072)[sext_i32_i64(squot32(local_tid_84065, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_84114) {\n                        int64_t defunc_0_op_res_84104 = add64(eta_p_84102, eta_p_84103);\n                        \n                        eta_p_84102 = defunc_0_op_res_84104;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_84114) {\n                        ((__local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = eta_p_84102;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84065, 32) == 0 && ltid_in_bounds_84109) {\n                    ((__local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = eta_p_84103;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84065 == 0) {\n                acc_84105 = ((__local int64_t *) local_mem_84072)[segscan_tblock_sizze_75428 - (int64_t) 1];\n            } else {\n                acc_84105 = ((__local int64_t *) local_mem_84072)[sext_i32_i64(local_tid_84065) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_84115 = (int64_t) 0;\n        block_new_sgm_84116 = ",
                                    "sgm_idx_84084 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_84116 && local_tid_84065 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_84060)[dynamic_id_84082] = acc_84105;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84056)[dynamic_id_84082] = (int8_t) 2;\n                acc_84105 = (int64_t) 0;\n            }\n            if (!block_new_sgm_84116 && slt32(local_tid_84065, wave_sizze_84067)) {\n                if (local_tid_84065 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_84058)[dynamic_id_84082] = acc_84105;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_84056)[dynamic_id_84082] = (int8_t) 1;\n                    \n                    int8_t tmp_84117 = ((volatile __global int8_t *) status_flags_mem_84056)[dynamic_id_84082 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84072)[(int64_t) 0] = tmp_84117;\n                }\n                mem_fence_local();\n                \n                int8_t status_84118 = ((__local int8_t *) local_mem_84072)[(int64_t) 0];\n                \n                if (status_84118 == (int8_t) 2) {\n                    if (local_tid_84065 == 0) {\n                        prefix_84115 = ((volatile __global int64_t *) incprefixes_mem_84060)[dynamic_id_84082 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_84119 = sext_i64_i32(dynamic_id_84082 - sext_i32_i64(wave_sizze_84067));\n                    \n                    while (slt32(wave_sizze_84067 * -1, readOffset_84119)) {\n                        int32_t read_i_84120 = readOffset_84119 + local_tid_84065;\n                        int64_t aggr_84121 = (int64_t) 0;\n                        int8_t flag_84122 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_84120)) {\n    ", "                        flag_84122 = ((volatile __global int8_t *) status_flags_mem_84056)[sext_i32_i64(read_i_84120)];\n                            if (flag_84122 == (int8_t) 2) {\n                                aggr_84121 = ((volatile __global int64_t *) incprefixes_mem_84060)[sext_i32_i64(read_i_84120)];\n                            } else if (flag_84122 == (int8_t) 1) {\n                                aggr_84121 = ((volatile __global int64_t *) aggregates_mem_84058)[sext_i32_i64(read_i_84120)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_84072)[(int64_t) 4 + sext_i32_i64(local_tid_84065)] = aggr_84121;\n                        ((__local int8_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = flag_84122;\n                        flag_84122 = ((__local int8_t *) local_mem_84072)[sext_i32_i64(wave_sizze_84067) - (int64_t) 1];\n                        if (slt8(flag_84122, (int8_t) 2)) {\n                            int8_t flg_x_84126;\n                            int8_t flg_y_84127;\n                            int64_t eta_p_84123;\n                            int64_t eta_p_84124;\n                            int32_t skip_threads_84128;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84127 = ((volatile __local int8_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)];\n                                eta_p_84124 = ((volatile __local int64_t *) local_mem_84072)[(int64_t) 4 + sext_i32_i64(local_tid_84065)];\n                                if ((local_tid_84065 - squot32(local_tid_84065, 32) * 32) == 0) {\n                                    eta_p_84123 = eta_p_84124;\n                                    flg_x_84126 = flg_y_84127;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n        ", "                        skip_threads_84128 = 1;\n                                while (slt32(skip_threads_84128, 32)) {\n                                    if (sle32(skip_threads_84128, local_tid_84065 - squot32(local_tid_84065, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_84126 = ((volatile __local int8_t *) local_mem_84072)[sext_i32_i64(local_tid_84065) - sext_i32_i64(skip_threads_84128)];\n                                            eta_p_84123 = ((volatile __local int64_t *) local_mem_84072)[(int64_t) 4 + (sext_i32_i64(local_tid_84065) - sext_i32_i64(skip_threads_84128))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84127 == (int8_t) 2 || flg_y_84127 == (int8_t) 0) {\n                                                flg_x_84126 = flg_y_84127;\n                                                eta_p_84123 = eta_p_84124;\n                                            } else {\n                                                int64_t defunc_0_op_res_84125 = add64(eta_p_84123, eta_p_84124);\n                                                \n                                                eta_p_84123 = defunc_0_op_res_84125;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84072)[sext_i32_i64(local_tid_84065)] = flg_x_84126;\n                                            flg_y_84127 = flg_x_84126;\n                                            ((volatile __local int64_t *) local_mem_84072)[(int64_t) 4 + sext_i32_i64(local_tid_84065)] = eta_p_84123;\n                                            eta_p_84124",
                                    " = eta_p_84123;\n                                        }\n                                    }\n                                    skip_threads_84128 *= 2;\n                                }\n                            }\n                        }\n                        flag_84122 = ((__local int8_t *) local_mem_84072)[sext_i32_i64(wave_sizze_84067) - (int64_t) 1];\n                        aggr_84121 = ((__local int64_t *) local_mem_84072)[(int64_t) 4 + (sext_i32_i64(wave_sizze_84067) - (int64_t) 1)];\n                        if (flag_84122 == (int8_t) 2) {\n                            readOffset_84119 = wave_sizze_84067 * -1;\n                        } else if (flag_84122 == (int8_t) 1) {\n                            readOffset_84119 -= wave_sizze_84067;\n                        }\n                        if (slt8((int8_t) 0, flag_84122)) {\n                            int64_t eta_p_84129 = aggr_84121;\n                            int64_t eta_p_84130 = prefix_84115;\n                            int64_t defunc_0_op_res_84131 = add64(eta_p_84129, eta_p_84130);\n                            \n                            prefix_84115 = defunc_0_op_res_84131;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84065 == 0) {\n                    if (boundary_84085 == sext_i64_i32(segscan_tblock_sizze_75428 * chunk_sizze_84053)) {\n                        int64_t eta_p_84132 = prefix_84115;\n                        int64_t eta_p_84133 = acc_84105;\n                        int64_t defunc_0_op_res_84134 = add64(eta_p_84132, eta_p_84133);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_84060)[dynamic_id_84082] = defunc_0_op_res_84134;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84056)[dynamic_id_84082] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_8", "4072)[(int64_t) 4] = prefix_84115;\n                    acc_84105 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_84082 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_84115 = ((__local int64_t *) local_mem_84072)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_84135;\n            int64_t eta_p_84136;\n            int64_t eta_p_84138 = prefix_84115;\n            int64_t eta_p_84139 = acc_84105;\n            \n            if (slt32(local_tid_84065 * chunk_sizze_32b_84069, boundary_84085) && !block_new_sgm_84116) {\n                int64_t defunc_0_op_res_84140 = add64(eta_p_84138, eta_p_84139);\n                \n                eta_p_84135 = defunc_0_op_res_84140;\n            } else {\n                eta_p_84135 = acc_84105;\n            }\n            \n            int32_t stopping_point_84141 = segsizze_compact_84086 - srem32(local_tid_84065 * chunk_sizze_32b_84069 - 1 + segsizze_compact_84086 - boundary_84085, segsizze_compact_84086);\n            \n            for (int64_t i_84142 = 0; i_84142 < chunk_sizze_84053; i_84142++) {\n                if (slt32(sext_i64_i32(i_84142), stopping_point_84141 - 1)) {\n                    eta_p_84136 = private_mem_84087[i_84142];\n                    \n                    int64_t defunc_0_op_res_84137 = add64(eta_p_84135, eta_p_84136);\n                    \n                    private_mem_84087[i_84142] = defunc_0_op_res_84137;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84143 = 0; i_84143 < chunk_sizze_84053; i_84143++) {\n                int64_t sharedIdx_84144 = sext_i32_i64(local_tid_84065) * chunk_sizze_84053 + i_84143;\n                int64_t tmp_84145 = private_mem_84087[i_84143];\n                \n                ((__local int64_t *) local_mem_84072)[shar", "edIdx_84144] = tmp_84145;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84146 = 0; i_84146 < chunk_sizze_84053; i_84146++) {\n                int64_t flat_idx_84147 = thd_offset_84089 + i_84146 * segscan_tblock_sizze_75428;\n                int64_t slice_84148 = dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345;\n                int64_t gtid_75432 = flat_idx_84147;\n                int64_t remnant_84149 = flat_idx_84147 - gtid_75432;\n                \n                if (slt64(flat_idx_84147, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345)) {\n                    int64_t tmp_84150 = ((__local int64_t *) local_mem_84072)[flat_idx_84147 - block_offset_84083];\n                    \n                    ((__global int64_t *) mem_82203)[gtid_75432] = tmp_84150;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75428\n    #undef chunk_sizze_84053\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75465_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75465(__global int *global_failure, int64_t conc_tmp_62382, int64_t num_tblocks_75462, int64_t num_virt_blocks_84372, int64_t num_virt_threads_84373, __global unsigned char *mem_82169, __global unsigned char *mem_82224, __global unsigned char *status_flags_mem_84374, __global unsigned char *aggregates_mem_84376, __global unsigned char *incprefixes_mem_84378, __global unsigned char *global_dynid_mem_84380)\n{\n    #define segscan_tblock_sizze_75460 (do_DBSCAN_doublezisegscan_75465zisegscan_tblock_sizze_75460)\n    #define chunk_sizze_84371 (do_DBSCAN_doublezisegscan_75465zichunk_sizze_84371)\n    \n    volatile __local unsigned char *local_mem_84390_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84390_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75460), chunk_sizze_84371 * segscan_tblock_sizze_75460 * (int64_t) 8) + srem64((int64_t) 8 - srem6",
                                    "4(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75460), chunk_sizze_84371 * segscan_tblock_sizze_75460 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84383;\n    int32_t tblock_sizze_84386;\n    int32_t wave_sizze_84385;\n    int32_t block_id_84384;\n    int32_t global_tid_84382;\n    int64_t phys_tid_75465;\n    int32_t chunk_sizze_32b_84387;\n    int64_t byte_offsets_84388;\n    int64_t warp_byte_offset_84389;\n    __local unsigned char *local_mem_84390;\n    int64_t trans_arr_len_84391;\n    int64_t phys_block_id_84397;\n    int64_t virtloop_bound_84398;\n    \n    local_tid_84383 = get_local_id(0);\n    tblock_sizze_84386 = get_local_size(0);\n    wave_sizze_84385 = LOCKSTEP_WIDTH;\n    block_id_84384 = get_tblock_id(0);\n    global_tid_84382 = block_id_84384 * tblock_sizze_84386 + local_tid_84383;\n    phys_tid_75465 = sext_i32_i64(global_tid_84382);\n    chunk_sizze_32b_84387 = sext_i64_i32(chunk_sizze_84371);\n    byte_offsets_84388 = segscan_tblock_sizze_75460 * (int64_t) 8;\n    warp_byte_offset_84389 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84390 = (__local unsigned char *) local_mem_84390_backing_0;\n    trans_arr_len_84391 = chunk_sizze_84371 * segscan_tblock_sizze_75460;\n    phys_block_id_84397 = get_tblock_id(0);\n    virtloop_bound_84398 = sdiv_up64(num_virt_blocks_84372 - phys_block_id_84397, num_tblocks_75462);\n    for (int64_t virtloop_i_84399 = 0; virtloop_i_84399 < virtloop_bound_84398; virtloop_i_84399++) {\n        int64_t dynamic_id_84400;\n        int64_t block_offset_84401;\n        int64_t sgm_idx_84402;\n        int32_t boundary_84403;\n        int32_t segsizze_compact_84404;\n        int64_t private_mem_84405[chunk_sizze_84371];\n        int64_t thd_offset_84407;\n        int64_t acc_84423;\n        int64_t prefix_84433;\n        bool block_new_sgm_84434;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n     ", "       if (local_tid_84383 == 0) {\n                dynamic_id_84400 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84380)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_84390)[(int64_t) 0] = dynamic_id_84400;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_84400 == num_virt_blocks_84372 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84380)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_84400 = ((__local int32_t *) local_mem_84390)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_84401 = dynamic_id_84400 * chunk_sizze_84371 * segscan_tblock_sizze_75460;\n        sgm_idx_84402 = smod64(block_offset_84401, conc_tmp_62382);\n        boundary_84403 = sext_i64_i32(smin64(chunk_sizze_84371 * segscan_tblock_sizze_75460, conc_tmp_62382 - sgm_idx_84402));\n        segsizze_compact_84404 = sext_i64_i32(smin64(chunk_sizze_84371 * segscan_tblock_sizze_75460, conc_tmp_62382));\n        thd_offset_84407 = block_offset_84401 + sext_i32_i64(local_tid_84383);\n        // Load and map\n        {\n            for (int64_t i_84408 = 0; i_84408 < chunk_sizze_84371; i_84408++) {\n                int64_t virt_tid_84409 = thd_offset_84407 + i_84408 * segscan_tblock_sizze_75460;\n                int64_t slice_84410 = conc_tmp_62382;\n                int64_t gtid_75464 = virt_tid_84409;\n                int64_t remnant_84411 = virt_tid_84409 - gtid_75464;\n                \n                if (slt64(virt_tid_84409, conc_tmp_62382)) {\n                    int64_t x_66500 = ((__global int64_t *) mem_82169)[gtid_75464];\n                    \n                    private_mem_84405[i_84408] = x_66500;\n                } else {\n                    priv", "ate_mem_84405[i_84408] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_84412 = 0; i_84412 < chunk_sizze_84371; i_84412++) {\n                int64_t sharedIdx_84413 = sext_i32_i64(local_tid_84383) + i_84412 * segscan_tblock_sizze_75460;\n                int64_t tmp_84414 = private_mem_84405[i_84412];\n                \n                ((__local int64_t *) local_mem_84390)[sharedIdx_84413] = tmp_84414;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84415 = 0; i_84415 < chunk_sizze_84371; i_84415++) {\n                int64_t sharedIdx_84416 = sext_i32_i64(local_tid_84383) * chunk_sizze_84371 + i_84415;\n                int64_t tmp_84417 = ((__local int64_t *) local_mem_84390)[sharedIdx_84416];\n                \n                private_mem_84405[i_84415] = tmp_84417;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_84418 = 0; i_84418 < chunk_sizze_84371 - (int64_t) 1; i_84418++) {\n                int64_t eta_p_66501;\n                int64_t eta_p_66502;\n                \n                eta_p_66501 = private_mem_84405[i_84418];\n                eta_p_66502 = private_mem_84405[i_84418 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_66503 = add64(eta_p_66501, eta_p_66502);\n                \n                private_mem_84405[i_84418 + (int64_t) 1] = defunc_0_op_res_66503;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_84419 = private_mem_84405[chunk_sizze_84371 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = tmp_84419;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_84420;\n            int64_t eta_p_84421;\n            int64_t eta_p",
                                    "_84424;\n            int64_t eta_p_84425;\n            bool ltid_in_bounds_84427 = slt64(sext_i32_i64(local_tid_84383), num_virt_threads_84373);\n            int32_t skip_threads_84428;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_84427) {\n                    eta_p_84421 = ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)];\n                    if ((local_tid_84383 - squot32(local_tid_84383, 32) * 32) == 0) {\n                        eta_p_84420 = eta_p_84421;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_84428 = 1;\n                while (slt32(skip_threads_84428, 32)) {\n                    bool thread_active_84429 = sle32(skip_threads_84428, local_tid_84383 - squot32(local_tid_84383, 32) * 32) && ltid_in_bounds_84427;\n                    \n                    if (thread_active_84429) {\n                        // read operands\n                        {\n                            eta_p_84420 = ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383) - sext_i32_i64(skip_threads_84428)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_84429) {\n                            int64_t defunc_0_op_res_84422 = add64(eta_p_84420, eta_p_84421);\n                            \n                            eta_p_84420 = defunc_0_op_res_84422;\n                        }\n                    }\n                    if (sle32(wave_sizze_84385, skip_threads_84428)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_84429) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = eta_p_84420;\n        ", "                    eta_p_84421 = eta_p_84420;\n                        }\n                    }\n                    if (sle32(wave_sizze_84385, skip_threads_84428)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_84428 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84383 - squot32(local_tid_84383, 32) * 32) == 31 && ltid_in_bounds_84427) {\n                    ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(squot32(local_tid_84383, 32))] = eta_p_84420;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_84430;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84383, 32) == 0 && ltid_in_bounds_84427) {\n                        eta_p_84425 = ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)];\n                        if ((local_tid_84383 - squot32(local_tid_84383, 32) * 32) == 0) {\n                            eta_p_84424 = eta_p_84425;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84430 = 1;\n                    while (slt32(skip_threads_84430, 32)) {\n                        bool thread_active_84431 = sle32(skip_threads_84430, local_tid_84383 - squot32(local_tid_84383, 32) * 32) && (squot32(local_tid_84383, 32) == 0 && ltid_in_bounds_84427);\n                        \n                        if (thread_active_84431) {\n                            // read operands\n                            {\n                                eta_p_84424 = ((volatile __local in", "t64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383) - sext_i32_i64(skip_threads_84430)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_84431) {\n                                int64_t defunc_0_op_res_84426 = add64(eta_p_84424, eta_p_84425);\n                                \n                                eta_p_84424 = defunc_0_op_res_84426;\n                            }\n                        }\n                        if (sle32(wave_sizze_84385, skip_threads_84430)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84431) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = eta_p_84424;\n                                eta_p_84425 = eta_p_84424;\n                            }\n                        }\n                        if (sle32(wave_sizze_84385, skip_threads_84430)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84430 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_84432 = squot32(local_tid_84383, 32) == 0 || !ltid_in_bounds_84427;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_84432) {\n                        eta_p_84421 = eta_p_84420;\n                        eta_p_84420 = ((__local int64_t *) local_mem_84390)[sext_i32_i64(squot32(local_tid_84383, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_84432) {\n                        ",
                                    "int64_t defunc_0_op_res_84422 = add64(eta_p_84420, eta_p_84421);\n                        \n                        eta_p_84420 = defunc_0_op_res_84422;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_84432) {\n                        ((__local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = eta_p_84420;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84383, 32) == 0 && ltid_in_bounds_84427) {\n                    ((__local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = eta_p_84421;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84383 == 0) {\n                acc_84423 = ((__local int64_t *) local_mem_84390)[segscan_tblock_sizze_75460 - (int64_t) 1];\n            } else {\n                acc_84423 = ((__local int64_t *) local_mem_84390)[sext_i32_i64(local_tid_84383) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_84433 = (int64_t) 0;\n        block_new_sgm_84434 = sgm_idx_84402 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_84434 && local_tid_84383 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_84378)[dynamic_id_84400] = acc_84423;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84374)[dynamic_id_84400] = (int8_t) 2;\n                acc_84423 = (int64_t) 0;\n            }\n            if (!block_new_sgm_84434 && slt32(local_tid_84383, wave_sizze_84385)) {\n                if (local_tid_84383 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_84376)[dynamic_id_84400] = acc_84423;\n                    mem_fence_global();\n                    ((v", "olatile __global int8_t *) status_flags_mem_84374)[dynamic_id_84400] = (int8_t) 1;\n                    \n                    int8_t tmp_84435 = ((volatile __global int8_t *) status_flags_mem_84374)[dynamic_id_84400 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84390)[(int64_t) 0] = tmp_84435;\n                }\n                mem_fence_local();\n                \n                int8_t status_84436 = ((__local int8_t *) local_mem_84390)[(int64_t) 0];\n                \n                if (status_84436 == (int8_t) 2) {\n                    if (local_tid_84383 == 0) {\n                        prefix_84433 = ((volatile __global int64_t *) incprefixes_mem_84378)[dynamic_id_84400 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_84437 = sext_i64_i32(dynamic_id_84400 - sext_i32_i64(wave_sizze_84385));\n                    \n                    while (slt32(wave_sizze_84385 * -1, readOffset_84437)) {\n                        int32_t read_i_84438 = readOffset_84437 + local_tid_84383;\n                        int64_t aggr_84439 = (int64_t) 0;\n                        int8_t flag_84440 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_84438)) {\n                            flag_84440 = ((volatile __global int8_t *) status_flags_mem_84374)[sext_i32_i64(read_i_84438)];\n                            if (flag_84440 == (int8_t) 2) {\n                                aggr_84439 = ((volatile __global int64_t *) incprefixes_mem_84378)[sext_i32_i64(read_i_84438)];\n                            } else if (flag_84440 == (int8_t) 1) {\n                                aggr_84439 = ((volatile __global int64_t *) aggregates_mem_84376)[sext_i32_i64(read_i_84438)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_84390)[(int64_t) 4 + sext_i32_i64(local_tid_84383)] = aggr_84439;\n                        ((__local int8_t ", "*) local_mem_84390)[sext_i32_i64(local_tid_84383)] = flag_84440;\n                        flag_84440 = ((__local int8_t *) local_mem_84390)[sext_i32_i64(wave_sizze_84385) - (int64_t) 1];\n                        if (slt8(flag_84440, (int8_t) 2)) {\n                            int8_t flg_x_84444;\n                            int8_t flg_y_84445;\n                            int64_t eta_p_84441;\n                            int64_t eta_p_84442;\n                            int32_t skip_threads_84446;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84445 = ((volatile __local int8_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)];\n                                eta_p_84442 = ((volatile __local int64_t *) local_mem_84390)[(int64_t) 4 + sext_i32_i64(local_tid_84383)];\n                                if ((local_tid_84383 - squot32(local_tid_84383, 32) * 32) == 0) {\n                                    eta_p_84441 = eta_p_84442;\n                                    flg_x_84444 = flg_y_84445;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_84446 = 1;\n                                while (slt32(skip_threads_84446, 32)) {\n                                    if (sle32(skip_threads_84446, local_tid_84383 - squot32(local_tid_84383, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_84444 = ((volatile __local int8_t *) local_mem_84390)[sext_i32_i64(local_tid_84383) - sext_i32_i64(skip_threads_84446)];\n                                            eta_p_84441 = ((volatile __local int64_t *) local_mem_84390)[(int64_t) 4 + (sext_i32_i64(local_tid_84383) - sext_i32_i64(skip_threads_84446))];\n                    ",
                                    "                    }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84445 == (int8_t) 2 || flg_y_84445 == (int8_t) 0) {\n                                                flg_x_84444 = flg_y_84445;\n                                                eta_p_84441 = eta_p_84442;\n                                            } else {\n                                                int64_t defunc_0_op_res_84443 = add64(eta_p_84441, eta_p_84442);\n                                                \n                                                eta_p_84441 = defunc_0_op_res_84443;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84390)[sext_i32_i64(local_tid_84383)] = flg_x_84444;\n                                            flg_y_84445 = flg_x_84444;\n                                            ((volatile __local int64_t *) local_mem_84390)[(int64_t) 4 + sext_i32_i64(local_tid_84383)] = eta_p_84441;\n                                            eta_p_84442 = eta_p_84441;\n                                        }\n                                    }\n                                    skip_threads_84446 *= 2;\n                                }\n                            }\n                        }\n                        flag_84440 = ((__local int8_t *) local_mem_84390)[sext_i32_i64(wave_sizze_84385) - (int64_t) 1];\n                        aggr_84439 = ((__local int64_t *) local_mem_84390)[(int64_t) 4 + (sext_i32_i64(wave_sizze_84385) - (int64_t) 1)];\n                        if (flag_84440 == (int8_t) 2) {\n                            readOffset_84437 = wave_sizze_84385 * -1;\n                        } else if (flag_84440 == (int8_t) 1) {\n                         ", "   readOffset_84437 -= wave_sizze_84385;\n                        }\n                        if (slt8((int8_t) 0, flag_84440)) {\n                            int64_t eta_p_84447 = aggr_84439;\n                            int64_t eta_p_84448 = prefix_84433;\n                            int64_t defunc_0_op_res_84449 = add64(eta_p_84447, eta_p_84448);\n                            \n                            prefix_84433 = defunc_0_op_res_84449;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84383 == 0) {\n                    if (boundary_84403 == sext_i64_i32(segscan_tblock_sizze_75460 * chunk_sizze_84371)) {\n                        int64_t eta_p_84450 = prefix_84433;\n                        int64_t eta_p_84451 = acc_84423;\n                        int64_t defunc_0_op_res_84452 = add64(eta_p_84450, eta_p_84451);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_84378)[dynamic_id_84400] = defunc_0_op_res_84452;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84374)[dynamic_id_84400] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_84390)[(int64_t) 4] = prefix_84433;\n                    acc_84423 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_84400 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_84433 = ((__local int64_t *) local_mem_84390)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_84453;\n            int64_t eta_p_84454;\n            int64_t eta_p_84456 = prefix_84433;\n            int64_t eta_p_84457 = acc_84423;\n            \n            if (slt32(local_tid_84383 * chunk_sizze_32b_84387, boundary_84403) && !block_new_sgm_84434) {\n                int64_t defunc_0_op_r", "es_84458 = add64(eta_p_84456, eta_p_84457);\n                \n                eta_p_84453 = defunc_0_op_res_84458;\n            } else {\n                eta_p_84453 = acc_84423;\n            }\n            \n            int32_t stopping_point_84459 = segsizze_compact_84404 - srem32(local_tid_84383 * chunk_sizze_32b_84387 - 1 + segsizze_compact_84404 - boundary_84403, segsizze_compact_84404);\n            \n            for (int64_t i_84460 = 0; i_84460 < chunk_sizze_84371; i_84460++) {\n                if (slt32(sext_i64_i32(i_84460), stopping_point_84459 - 1)) {\n                    eta_p_84454 = private_mem_84405[i_84460];\n                    \n                    int64_t defunc_0_op_res_84455 = add64(eta_p_84453, eta_p_84454);\n                    \n                    private_mem_84405[i_84460] = defunc_0_op_res_84455;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84461 = 0; i_84461 < chunk_sizze_84371; i_84461++) {\n                int64_t sharedIdx_84462 = sext_i32_i64(local_tid_84383) * chunk_sizze_84371 + i_84461;\n                int64_t tmp_84463 = private_mem_84405[i_84461];\n                \n                ((__local int64_t *) local_mem_84390)[sharedIdx_84462] = tmp_84463;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84464 = 0; i_84464 < chunk_sizze_84371; i_84464++) {\n                int64_t flat_idx_84465 = thd_offset_84407 + i_84464 * segscan_tblock_sizze_75460;\n                int64_t slice_84466 = conc_tmp_62382;\n                int64_t gtid_75464 = flat_idx_84465;\n                int64_t remnant_84467 = flat_idx_84465 - gtid_75464;\n                \n                if (slt64(flat_idx_84465, conc_tmp_62382)) {\n                    int64_t tmp_84468 = ((__local int64_t *) local_mem_84390)[flat_idx_84465 - block_offset_84401];\n                    \n                    ((__global int64_t *) mem_82224)[gtid_75464] = tm",
                                    "p_84468;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75460\n    #undef chunk_sizze_84371\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75491_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75491(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75488, int64_t num_virt_blocks_84754, int64_t num_virt_threads_84755, __global unsigned char *mem_82225, __global unsigned char *mem_param_82235, __global unsigned char *mem_82237, __global unsigned char *mem_82239, __global unsigned char *status_flags_mem_84756, __global unsigned char *aggregates_mem_84758, __global unsigned char *incprefixes_mem_84760, __global unsigned char *aggregates_mem_84762, __global unsigned char *incprefixes_mem_84764, __global unsigned char *global_dynid_mem_84766)\n{\n    #define segscan_tblock_sizze_75486 (do_DBSCAN_doublezisegscan_75491zisegscan_tblock_sizze_75486)\n    #define chunk_sizze_84753 (do_DBSCAN_doublezisegscan_75491zichunk_sizze_84753)\n    \n    volatile __local unsigned char *local_mem_84778_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84778_backing_0_offset = 0 + (smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75486, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75486), smax64(chunk_sizze_84753 * segscan_tblock_sizze_75486, chunk_sizze_84753 * segscan_tblock_sizze_75486 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75486, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75486), smax64(chunk_sizze_84753 * segscan_tblock_sizze_75486, chunk_sizze_84753 * segscan_tblock_sizze_75486 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84769;\n    int32_t tblock_sizze_84772;\n    int32_t wave_sizze_84771;\n    int32_t block_id_84770;\n    int32_t global_tid_84768;\n    int64", "_t phys_tid_75491;\n    int32_t chunk_sizze_32b_84773;\n    int64_t byte_offsets_84774;\n    int64_t byte_offsets_84775;\n    int64_t warp_byte_offset_84776;\n    int64_t warp_byte_offset_84777;\n    __local unsigned char *local_mem_84778;\n    int64_t trans_arr_len_84779;\n    int64_t phys_block_id_84788;\n    int64_t virtloop_bound_84789;\n    \n    local_tid_84769 = get_local_id(0);\n    tblock_sizze_84772 = get_local_size(0);\n    wave_sizze_84771 = LOCKSTEP_WIDTH;\n    block_id_84770 = get_tblock_id(0);\n    global_tid_84768 = block_id_84770 * tblock_sizze_84772 + local_tid_84769;\n    phys_tid_75491 = sext_i32_i64(global_tid_84768);\n    chunk_sizze_32b_84773 = sext_i64_i32(chunk_sizze_84753);\n    byte_offsets_84774 = segscan_tblock_sizze_75486;\n    byte_offsets_84775 = sdiv_up64(byte_offsets_84774, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_75486 * (int64_t) 8;\n    warp_byte_offset_84776 = (int64_t) 64;\n    warp_byte_offset_84777 = sdiv_up64(warp_byte_offset_84776, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84778 = (__local unsigned char *) local_mem_84778_backing_0;\n    trans_arr_len_84779 = chunk_sizze_84753 * segscan_tblock_sizze_75486;\n    phys_block_id_84788 = get_tblock_id(0);\n    virtloop_bound_84789 = sdiv_up64(num_virt_blocks_84754 - phys_block_id_84788, num_tblocks_75488);\n    for (int64_t virtloop_i_84790 = 0; virtloop_i_84790 < virtloop_bound_84789; virtloop_i_84790++) {\n        int64_t dynamic_id_84791;\n        int64_t block_offset_84792;\n        int64_t sgm_idx_84793;\n        int32_t boundary_84794;\n        int32_t segsizze_compact_84795;\n        bool private_mem_84796[chunk_sizze_84753];\n        int64_t private_mem_84798[chunk_sizze_84753];\n        int64_t thd_offset_84800;\n        bool acc_84828;\n        int64_t acc_84829;\n        bool prefix_84844;\n        int64_t prefix_84845;\n        bool block_new_sgm_84846;\n        \n        // First thread in block fetches this block's dynamic_id\n       ", " {\n            if (local_tid_84769 == 0) {\n                dynamic_id_84791 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84766)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_84778)[(int64_t) 0] = dynamic_id_84791;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_84791 == num_virt_blocks_84754 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84766)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_84791 = ((__local int32_t *) local_mem_84778)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_84792 = dynamic_id_84791 * chunk_sizze_84753 * segscan_tblock_sizze_75486;\n        sgm_idx_84793 = smod64(block_offset_84792, mk_adjacency_list_res_66334);\n        boundary_84794 = sext_i64_i32(smin64(chunk_sizze_84753 * segscan_tblock_sizze_75486, mk_adjacency_list_res_66334 - sgm_idx_84793));\n        segsizze_compact_84795 = sext_i64_i32(smin64(chunk_sizze_84753 * segscan_tblock_sizze_75486, mk_adjacency_list_res_66334));\n        thd_offset_84800 = block_offset_84792 + sext_i32_i64(local_tid_84769);\n        // Load and map\n        {\n            for (int64_t i_84801 = 0; i_84801 < chunk_sizze_84753; i_84801++) {\n                int64_t virt_tid_84802 = thd_offset_84800 + i_84801 * segscan_tblock_sizze_75486;\n                int64_t slice_84803 = mk_adjacency_list_res_66334;\n                int64_t gtid_75490 = virt_tid_84802;\n                int64_t remnant_84804 = virt_tid_84802 - gtid_75490;\n                \n                if (slt64(virt_tid_84802, mk_adjacency_list_res_66334)) {\n                    bool x_66533 = ((__global bool *) mem_82225)[gtid_75490];\n                    int64_t x_66534 = ((__global int64_t *) m",
                                    "em_param_82235)[gtid_75490];\n                    \n                    private_mem_84796[i_84801] = x_66533;\n                    private_mem_84798[i_84801] = x_66534;\n                } else {\n                    private_mem_84796[i_84801] = 0;\n                    private_mem_84798[i_84801] = (int64_t) 9223372036854775807;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_84805 = 0; i_84805 < chunk_sizze_84753; i_84805++) {\n                int64_t sharedIdx_84806 = sext_i32_i64(local_tid_84769) + i_84805 * segscan_tblock_sizze_75486;\n                bool tmp_84807 = private_mem_84796[i_84805];\n                \n                ((__local bool *) local_mem_84778)[sharedIdx_84806] = tmp_84807;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84808 = 0; i_84808 < chunk_sizze_84753; i_84808++) {\n                int64_t sharedIdx_84809 = sext_i32_i64(local_tid_84769) * chunk_sizze_84753 + i_84808;\n                bool tmp_84810 = ((__local bool *) local_mem_84778)[sharedIdx_84809];\n                \n                private_mem_84796[i_84808] = tmp_84810;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84811 = 0; i_84811 < chunk_sizze_84753; i_84811++) {\n                int64_t sharedIdx_84812 = sext_i32_i64(local_tid_84769) + i_84811 * segscan_tblock_sizze_75486;\n                int64_t tmp_84813 = private_mem_84798[i_84811];\n                \n                ((__local int64_t *) local_mem_84778)[sharedIdx_84812] = tmp_84813;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84814 = 0; i_84814 < chunk_sizze_84753; i_84814++) {\n                int64_t sharedIdx_84815 = sext_i32_i64(local_tid_84769) * chunk_sizze_84753 + i_84814;\n                int64_t tmp_84816 = ((__local int64_t *) local_mem_84778)[sharedIdx_84815];\n                \n                private_mem_84798[i_84814] =", " tmp_84816;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_84817 = 0; i_84817 < chunk_sizze_84753 - (int64_t) 1; i_84817++) {\n                bool eta_p_66535;\n                bool eta_p_66537;\n                \n                eta_p_66535 = private_mem_84796[i_84817];\n                eta_p_66537 = private_mem_84796[i_84817 + (int64_t) 1];\n                \n                int64_t eta_p_66536;\n                int64_t eta_p_66538;\n                \n                eta_p_66536 = private_mem_84798[i_84817];\n                eta_p_66538 = private_mem_84798[i_84817 + (int64_t) 1];\n                \n                bool tmp_66539 = eta_p_66535 || eta_p_66537;\n                int64_t tmp_66540;\n                \n                if (eta_p_66537) {\n                    tmp_66540 = eta_p_66538;\n                } else {\n                    bool cond_66541 = slt64(eta_p_66536, eta_p_66538);\n                    int64_t lifted_lambda_res_66542;\n                    \n                    if (cond_66541) {\n                        lifted_lambda_res_66542 = eta_p_66536;\n                    } else {\n                        lifted_lambda_res_66542 = eta_p_66538;\n                    }\n                    tmp_66540 = lifted_lambda_res_66542;\n                }\n                private_mem_84796[i_84817 + (int64_t) 1] = tmp_66539;\n                private_mem_84798[i_84817 + (int64_t) 1] = tmp_66540;\n            }\n        }\n        // Publish results in shared memory\n        {\n            bool tmp_84818 = private_mem_84796[chunk_sizze_84753 - (int64_t) 1];\n            \n            ((__local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = tmp_84818;\n            \n            int64_t tmp_84819 = private_mem_84798[chunk_sizze_84753 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = tmp_84819;\n            barrie", "r(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            bool eta_p_84820;\n            int64_t eta_p_84821;\n            bool eta_p_84822;\n            int64_t eta_p_84823;\n            bool eta_p_84830;\n            int64_t eta_p_84831;\n            bool eta_p_84832;\n            int64_t eta_p_84833;\n            bool ltid_in_bounds_84838 = slt64(sext_i32_i64(local_tid_84769), num_virt_threads_84755);\n            int32_t skip_threads_84839;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_84838) {\n                    eta_p_84822 = ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)];\n                    eta_p_84823 = ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)];\n                    if ((local_tid_84769 - squot32(local_tid_84769, 32) * 32) == 0) {\n                        eta_p_84820 = eta_p_84822;\n                        eta_p_84821 = eta_p_84823;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_84839 = 1;\n                while (slt32(skip_threads_84839, 32)) {\n                    bool thread_active_84840 = sle32(skip_threads_84839, local_tid_84769 - squot32(local_tid_84769, 32) * 32) && ltid_in_bounds_84838;\n                    \n                    if (thread_active_84840) {\n                        // read operands\n                        {\n                            eta_p_84820 = ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84839)];\n                            eta_p_84821 = ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + (sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84839))];\n                        }\n                    }\n                    // perform operation",
                                    "\n                    {\n                        if (thread_active_84840) {\n                            bool tmp_84824 = eta_p_84820 || eta_p_84822;\n                            int64_t tmp_84825;\n                            \n                            if (eta_p_84822) {\n                                tmp_84825 = eta_p_84823;\n                            } else {\n                                bool cond_84826 = slt64(eta_p_84821, eta_p_84823);\n                                int64_t lifted_lambda_res_84827;\n                                \n                                if (cond_84826) {\n                                    lifted_lambda_res_84827 = eta_p_84821;\n                                } else {\n                                    lifted_lambda_res_84827 = eta_p_84823;\n                                }\n                                tmp_84825 = lifted_lambda_res_84827;\n                            }\n                            eta_p_84820 = tmp_84824;\n                            eta_p_84821 = tmp_84825;\n                        }\n                    }\n                    if (sle32(wave_sizze_84771, skip_threads_84839)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_84840) {\n                        // write result\n                        {\n                            ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = eta_p_84820;\n                            eta_p_84822 = eta_p_84820;\n                            ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = eta_p_84821;\n                            eta_p_84823 = eta_p_84821;\n                        }\n                    }\n                    if (sle32(wave_sizze_84771, skip_threads_84839)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_84839 *= 2;\n                }\n            }\n   ", "         barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84769 - squot32(local_tid_84769, 32) * 32) == 31 && ltid_in_bounds_84838) {\n                    ((volatile __local bool *) local_mem_84778)[sext_i32_i64(squot32(local_tid_84769, 32))] = eta_p_84820;\n                    ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(squot32(local_tid_84769, 32))] = eta_p_84821;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_84841;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84769, 32) == 0 && ltid_in_bounds_84838) {\n                        eta_p_84832 = ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)];\n                        eta_p_84833 = ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)];\n                        if ((local_tid_84769 - squot32(local_tid_84769, 32) * 32) == 0) {\n                            eta_p_84830 = eta_p_84832;\n                            eta_p_84831 = eta_p_84833;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84841 = 1;\n                    while (slt32(skip_threads_84841, 32)) {\n                        bool thread_active_84842 = sle32(skip_threads_84841, local_tid_84769 - squot32(local_tid_84769, 32) * 32) && (squot32(local_tid_84769, 32) == 0 && ltid_in_bounds_84838);\n                        \n                        if (thread_active_84842) {\n                            // read operands\n                            {\n           ", "                     eta_p_84830 = ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84841)];\n                                eta_p_84831 = ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + (sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84841))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_84842) {\n                                bool tmp_84834 = eta_p_84830 || eta_p_84832;\n                                int64_t tmp_84835;\n                                \n                                if (eta_p_84832) {\n                                    tmp_84835 = eta_p_84833;\n                                } else {\n                                    bool cond_84836 = slt64(eta_p_84831, eta_p_84833);\n                                    int64_t lifted_lambda_res_84837;\n                                    \n                                    if (cond_84836) {\n                                        lifted_lambda_res_84837 = eta_p_84831;\n                                    } else {\n                                        lifted_lambda_res_84837 = eta_p_84833;\n                                    }\n                                    tmp_84835 = lifted_lambda_res_84837;\n                                }\n                                eta_p_84830 = tmp_84834;\n                                eta_p_84831 = tmp_84835;\n                            }\n                        }\n                        if (sle32(wave_sizze_84771, skip_threads_84841)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84842) {\n                            // write result\n                            {\n                                ((volatile __local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769",
                                    ")] = eta_p_84830;\n                                eta_p_84832 = eta_p_84830;\n                                ((volatile __local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = eta_p_84831;\n                                eta_p_84833 = eta_p_84831;\n                            }\n                        }\n                        if (sle32(wave_sizze_84771, skip_threads_84841)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84841 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_84843 = squot32(local_tid_84769, 32) == 0 || !ltid_in_bounds_84838;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_84843) {\n                        eta_p_84822 = eta_p_84820;\n                        eta_p_84823 = eta_p_84821;\n                        eta_p_84820 = ((__local bool *) local_mem_84778)[sext_i32_i64(squot32(local_tid_84769, 32)) - (int64_t) 1];\n                        eta_p_84821 = ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_84769, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_84843) {\n                        bool tmp_84824 = eta_p_84820 || eta_p_84822;\n                        int64_t tmp_84825;\n                        \n                        if (eta_p_84822) {\n                            tmp_84825 = eta_p_84823;\n                        } else {\n                            bool cond_84826 = slt64(eta_p_84821, eta_p_84823);\n                            int64_t lifted_lambda_res_84827;\n                            \n                            if (cond_84826) {\n         ", "                       lifted_lambda_res_84827 = eta_p_84821;\n                            } else {\n                                lifted_lambda_res_84827 = eta_p_84823;\n                            }\n                            tmp_84825 = lifted_lambda_res_84827;\n                        }\n                        eta_p_84820 = tmp_84824;\n                        eta_p_84821 = tmp_84825;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_84843) {\n                        ((__local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = eta_p_84820;\n                        ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = eta_p_84821;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84769, 32) == 0 && ltid_in_bounds_84838) {\n                    ((__local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = eta_p_84822;\n                    ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = eta_p_84823;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84769 == 0) {\n                acc_84828 = ((__local bool *) local_mem_84778)[segscan_tblock_sizze_75486 - (int64_t) 1];\n                acc_84829 = ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + (segscan_tblock_sizze_75486 - (int64_t) 1)];\n            } else {\n                acc_84828 = ((__local bool *) local_mem_84778)[sext_i32_i64(local_tid_84769) - (int64_t) 1];\n                acc_84829 = ((__local int64_t *) local_mem_84778)[squot64(byte_offsets_84774, (int64_t) 8) + (sext_i32_i64(local_tid_84769) - (int64_t) 1)];\n            }\n   ", "         barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_84844 = 0;\n        prefix_84845 = (int64_t) 9223372036854775807;\n        block_new_sgm_84846 = sgm_idx_84793 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_84846 && local_tid_84769 == 0) {\n                ((volatile __global bool *) incprefixes_mem_84760)[dynamic_id_84791] = acc_84828;\n                ((volatile __global int64_t *) incprefixes_mem_84764)[dynamic_id_84791] = acc_84829;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84756)[dynamic_id_84791] = (int8_t) 2;\n                acc_84828 = 0;\n                acc_84829 = (int64_t) 9223372036854775807;\n            }\n            if (!block_new_sgm_84846 && slt32(local_tid_84769, wave_sizze_84771)) {\n                if (local_tid_84769 == 0) {\n                    ((volatile __global bool *) aggregates_mem_84758)[dynamic_id_84791] = acc_84828;\n                    ((volatile __global int64_t *) aggregates_mem_84762)[dynamic_id_84791] = acc_84829;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_84756)[dynamic_id_84791] = (int8_t) 1;\n                    \n                    int8_t tmp_84847 = ((volatile __global int8_t *) status_flags_mem_84756)[dynamic_id_84791 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84778)[(int64_t) 0] = tmp_84847;\n                }\n                mem_fence_local();\n                \n                int8_t status_84848 = ((__local int8_t *) local_mem_84778)[(int64_t) 0];\n                \n                if (status_84848 == (int8_t) 2) {\n                    if (local_tid_84769 == 0) {\n                        prefix_84844 = ((volatile __global bool *) incprefixes_mem_84760)[dynamic_id_84791 - (int64_t) 1];\n                        prefix_84845 = ((volatile __global int64_t *) incprefixes_mem_84764)[dynamic_id_84791 - (int64_t) 1];\n       ",
                                    "             }\n                } else {\n                    int32_t readOffset_84849 = sext_i64_i32(dynamic_id_84791 - sext_i32_i64(wave_sizze_84771));\n                    \n                    while (slt32(wave_sizze_84771 * -1, readOffset_84849)) {\n                        int32_t read_i_84850 = readOffset_84849 + local_tid_84769;\n                        bool aggr_84851 = 0;\n                        int64_t aggr_84852 = (int64_t) 9223372036854775807;\n                        int8_t flag_84853 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_84850)) {\n                            flag_84853 = ((volatile __global int8_t *) status_flags_mem_84756)[sext_i32_i64(read_i_84850)];\n                            if (flag_84853 == (int8_t) 2) {\n                                aggr_84851 = ((volatile __global bool *) incprefixes_mem_84760)[sext_i32_i64(read_i_84850)];\n                                aggr_84852 = ((volatile __global int64_t *) incprefixes_mem_84764)[sext_i32_i64(read_i_84850)];\n                            } else if (flag_84853 == (int8_t) 1) {\n                                aggr_84851 = ((volatile __global bool *) aggregates_mem_84758)[sext_i32_i64(read_i_84850)];\n                                aggr_84852 = ((volatile __global int64_t *) aggregates_mem_84762)[sext_i32_i64(read_i_84850)];\n                            }\n                        }\n                        ((__local bool *) local_mem_84778)[(int64_t) 32 + sext_i32_i64(local_tid_84769)] = aggr_84851;\n                        ((__local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = aggr_84852;\n                        ((__local int8_t *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = flag_84853;\n                        flag_84853 = ((__local int8_t *) local_mem_84778)[sext_i32_i64(wave_sizze_84771) - (int64_t) 1];\n                        if (slt8(flag_84853, (int8_t) 2)) {\n                            int8_t flg_x", "_84862;\n                            int8_t flg_y_84863;\n                            bool eta_p_84854;\n                            int64_t eta_p_84855;\n                            bool eta_p_84856;\n                            int64_t eta_p_84857;\n                            int32_t skip_threads_84864;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84863 = ((volatile __local int8_t *) local_mem_84778)[sext_i32_i64(local_tid_84769)];\n                                eta_p_84856 = ((volatile __local bool *) local_mem_84778)[(int64_t) 32 + sext_i32_i64(local_tid_84769)];\n                                eta_p_84857 = ((volatile __local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8) + sext_i32_i64(local_tid_84769)];\n                                if ((local_tid_84769 - squot32(local_tid_84769, 32) * 32) == 0) {\n                                    eta_p_84854 = eta_p_84856;\n                                    eta_p_84855 = eta_p_84857;\n                                    flg_x_84862 = flg_y_84863;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_84864 = 1;\n                                while (slt32(skip_threads_84864, 32)) {\n                                    if (sle32(skip_threads_84864, local_tid_84769 - squot32(local_tid_84769, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_84862 = ((volatile __local int8_t *) local_mem_84778)[sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84864)];\n                                            eta_p_84854 = ((volatile __local bool *) local_mem_84778)[(int64_t) 32 + (sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_t", "hreads_84864))];\n                                            eta_p_84855 = ((volatile __local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8) + (sext_i32_i64(local_tid_84769) - sext_i32_i64(skip_threads_84864))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84863 == (int8_t) 2 || flg_y_84863 == (int8_t) 0) {\n                                                flg_x_84862 = flg_y_84863;\n                                                eta_p_84854 = eta_p_84856;\n                                                eta_p_84855 = eta_p_84857;\n                                            } else {\n                                                bool tmp_84858 = eta_p_84854 || eta_p_84856;\n                                                int64_t tmp_84859;\n                                                \n                                                if (eta_p_84856) {\n                                                    tmp_84859 = eta_p_84857;\n                                                } else {\n                                                    bool cond_84860 = slt64(eta_p_84855, eta_p_84857);\n                                                    int64_t lifted_lambda_res_84861;\n                                                    \n                                                    if (cond_84860) {\n                                                        lifted_lambda_res_84861 = eta_p_84855;\n                                                    } else {\n                                                        lifted_lambda_res_84861 = eta_p_84857;\n                                                    }\n                                                    tmp_84859 = lifted_lambda_res_84861;\n                                                }\n                                                eta_p_84854 = tmp_84",
                                    "858;\n                                                eta_p_84855 = tmp_84859;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84778)[sext_i32_i64(local_tid_84769)] = flg_x_84862;\n                                            flg_y_84863 = flg_x_84862;\n                                            ((volatile __local bool *) local_mem_84778)[(int64_t) 32 + sext_i32_i64(local_tid_84769)] = eta_p_84854;\n                                            eta_p_84856 = eta_p_84854;\n                                            ((volatile __local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8) + sext_i32_i64(local_tid_84769)] = eta_p_84855;\n                                            eta_p_84857 = eta_p_84855;\n                                        }\n                                    }\n                                    skip_threads_84864 *= 2;\n                                }\n                            }\n                        }\n                        flag_84853 = ((__local int8_t *) local_mem_84778)[sext_i32_i64(wave_sizze_84771) - (int64_t) 1];\n                        aggr_84851 = ((__local bool *) local_mem_84778)[(int64_t) 32 + (sext_i32_i64(wave_sizze_84771) - (int64_t) 1)];\n                        aggr_84852 = ((__local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8) + (sext_i32_i64(wave_sizze_84771) - (int64_t) 1)];\n                        if (flag_84853 == (int8_t) 2) {\n                            readOffset_84849 = wave_sizze_84771 * -1;\n                        } else if (flag_84853 == (int8_t) 1) {\n                            readOffset_84849 -= wave_sizze_84771;\n                        }\n                        if (slt8((int8_t) 0, flag_84853)) {\n                            bool eta_p_84865 = aggr_84", "851;\n                            int64_t eta_p_84866 = aggr_84852;\n                            bool eta_p_84867 = prefix_84844;\n                            int64_t eta_p_84868 = prefix_84845;\n                            bool tmp_84869 = eta_p_84865 || eta_p_84867;\n                            int64_t tmp_84870;\n                            \n                            if (eta_p_84867) {\n                                tmp_84870 = eta_p_84868;\n                            } else {\n                                bool cond_84871 = slt64(eta_p_84866, eta_p_84868);\n                                int64_t lifted_lambda_res_84872;\n                                \n                                if (cond_84871) {\n                                    lifted_lambda_res_84872 = eta_p_84866;\n                                } else {\n                                    lifted_lambda_res_84872 = eta_p_84868;\n                                }\n                                tmp_84870 = lifted_lambda_res_84872;\n                            }\n                            prefix_84844 = tmp_84869;\n                            prefix_84845 = tmp_84870;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84769 == 0) {\n                    if (boundary_84794 == sext_i64_i32(segscan_tblock_sizze_75486 * chunk_sizze_84753)) {\n                        bool eta_p_84873 = prefix_84844;\n                        int64_t eta_p_84874 = prefix_84845;\n                        bool eta_p_84875 = acc_84828;\n                        int64_t eta_p_84876 = acc_84829;\n                        bool tmp_84877 = eta_p_84873 || eta_p_84875;\n                        int64_t tmp_84878;\n                        \n                        if (eta_p_84875) {\n                            tmp_84878 = eta_p_84876;\n                        } else {\n                            bool cond_84879 = slt64(eta_p_84874, eta_p_84876);\n                       ", "     int64_t lifted_lambda_res_84880;\n                            \n                            if (cond_84879) {\n                                lifted_lambda_res_84880 = eta_p_84874;\n                            } else {\n                                lifted_lambda_res_84880 = eta_p_84876;\n                            }\n                            tmp_84878 = lifted_lambda_res_84880;\n                        }\n                        ((volatile __global bool *) incprefixes_mem_84760)[dynamic_id_84791] = tmp_84877;\n                        ((volatile __global int64_t *) incprefixes_mem_84764)[dynamic_id_84791] = tmp_84878;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84756)[dynamic_id_84791] = (int8_t) 2;\n                    }\n                    ((__local bool *) local_mem_84778)[(int64_t) 32] = prefix_84844;\n                    ((__local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8)] = prefix_84845;\n                    acc_84828 = 0;\n                    acc_84829 = (int64_t) 9223372036854775807;\n                }\n            }\n            if (!(dynamic_id_84791 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_84844 = ((__local bool *) local_mem_84778)[(int64_t) 32];\n                prefix_84845 = ((__local int64_t *) local_mem_84778)[squot64(warp_byte_offset_84776, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            bool eta_p_84881;\n            bool eta_p_84883;\n            bool eta_p_84889 = prefix_84844;\n            bool eta_p_84891 = acc_84828;\n            int64_t eta_p_84882;\n            int64_t eta_p_84884;\n            int64_t eta_p_84890 = prefix_84845;\n            int64_t eta_p_84892 = acc_84829;\n            \n            if (slt32(local_tid_84769 * chunk_sizze_32b_84773, boundary_84794) && !block_new_sgm_84846) {\n                bool tmp_8489",
                                    "3 = eta_p_84889 || eta_p_84891;\n                int64_t tmp_84894;\n                \n                if (eta_p_84891) {\n                    tmp_84894 = eta_p_84892;\n                } else {\n                    bool cond_84895 = slt64(eta_p_84890, eta_p_84892);\n                    int64_t lifted_lambda_res_84896;\n                    \n                    if (cond_84895) {\n                        lifted_lambda_res_84896 = eta_p_84890;\n                    } else {\n                        lifted_lambda_res_84896 = eta_p_84892;\n                    }\n                    tmp_84894 = lifted_lambda_res_84896;\n                }\n                eta_p_84881 = tmp_84893;\n                eta_p_84882 = tmp_84894;\n            } else {\n                eta_p_84881 = acc_84828;\n                eta_p_84882 = acc_84829;\n            }\n            \n            int32_t stopping_point_84897 = segsizze_compact_84795 - srem32(local_tid_84769 * chunk_sizze_32b_84773 - 1 + segsizze_compact_84795 - boundary_84794, segsizze_compact_84795);\n            \n            for (int64_t i_84898 = 0; i_84898 < chunk_sizze_84753; i_84898++) {\n                if (slt32(sext_i64_i32(i_84898), stopping_point_84897 - 1)) {\n                    eta_p_84883 = private_mem_84796[i_84898];\n                    eta_p_84884 = private_mem_84798[i_84898];\n                    \n                    bool tmp_84885 = eta_p_84881 || eta_p_84883;\n                    int64_t tmp_84886;\n                    \n                    if (eta_p_84883) {\n                        tmp_84886 = eta_p_84884;\n                    } else {\n                        bool cond_84887 = slt64(eta_p_84882, eta_p_84884);\n                        int64_t lifted_lambda_res_84888;\n                        \n                        if (cond_84887) {\n                            lifted_lambda_res_84888 = eta_p_84882;\n                        } else {\n                            lifted_lambda_res_84888 = eta_p_84884;\n                        }\n                        tmp", "_84886 = lifted_lambda_res_84888;\n                    }\n                    private_mem_84796[i_84898] = tmp_84885;\n                    private_mem_84798[i_84898] = tmp_84886;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84899 = 0; i_84899 < chunk_sizze_84753; i_84899++) {\n                int64_t sharedIdx_84900 = sext_i32_i64(local_tid_84769) * chunk_sizze_84753 + i_84899;\n                bool tmp_84901 = private_mem_84796[i_84899];\n                \n                ((__local bool *) local_mem_84778)[sharedIdx_84900] = tmp_84901;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84902 = 0; i_84902 < chunk_sizze_84753; i_84902++) {\n                int64_t flat_idx_84903 = thd_offset_84800 + i_84902 * segscan_tblock_sizze_75486;\n                int64_t slice_84904 = mk_adjacency_list_res_66334;\n                int64_t gtid_75490 = flat_idx_84903;\n                int64_t remnant_84905 = flat_idx_84903 - gtid_75490;\n                \n                if (slt64(flat_idx_84903, mk_adjacency_list_res_66334)) {\n                    bool tmp_84906 = ((__local bool *) local_mem_84778)[flat_idx_84903 - block_offset_84792];\n                    \n                    ((__global bool *) mem_82237)[gtid_75490] = tmp_84906;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84907 = 0; i_84907 < chunk_sizze_84753; i_84907++) {\n                int64_t sharedIdx_84908 = sext_i32_i64(local_tid_84769) * chunk_sizze_84753 + i_84907;\n                int64_t tmp_84909 = private_mem_84798[i_84907];\n                \n                ((__local int64_t *) local_mem_84778)[sharedIdx_84908] = tmp_84909;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84910 = 0; i_84910 < chunk_sizze_84753; i_84910++) {\n                int64_t flat_idx_84911 = thd_offset_84800 + i_84910 ", "* segscan_tblock_sizze_75486;\n                int64_t slice_84912 = mk_adjacency_list_res_66334;\n                int64_t gtid_75490 = flat_idx_84911;\n                int64_t remnant_84913 = flat_idx_84911 - gtid_75490;\n                \n                if (slt64(flat_idx_84911, mk_adjacency_list_res_66334)) {\n                    int64_t tmp_84914 = ((__local int64_t *) local_mem_84778)[flat_idx_84911 - block_offset_84792];\n                    \n                    ((__global int64_t *) mem_82239)[gtid_75490] = tmp_84914;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75486\n    #undef chunk_sizze_84753\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75499_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75499(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75496, int64_t num_virt_blocks_84543, int64_t num_virt_threads_84544, __global unsigned char *mem_82225, __global unsigned char *mem_82231, __global unsigned char *mem_82232, __global unsigned char *status_flags_mem_84545, __global unsigned char *aggregates_mem_84547, __global unsigned char *incprefixes_mem_84549, __global unsigned char *global_dynid_mem_84551)\n{\n    #define segscan_tblock_sizze_75494 (do_DBSCAN_doublezisegscan_75499zisegscan_tblock_sizze_75494)\n    #define chunk_sizze_84542 (do_DBSCAN_doublezisegscan_75499zichunk_sizze_84542)\n    \n    volatile __local unsigned char *local_mem_84561_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84561_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75494), chunk_sizze_84542 * segscan_tblock_sizze_75494 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75494), chunk_sizze_84542 * segscan_tblock_sizze_75494 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_",
                                    "84554;\n    int32_t tblock_sizze_84557;\n    int32_t wave_sizze_84556;\n    int32_t block_id_84555;\n    int32_t global_tid_84553;\n    int64_t phys_tid_75499;\n    int32_t chunk_sizze_32b_84558;\n    int64_t byte_offsets_84559;\n    int64_t warp_byte_offset_84560;\n    __local unsigned char *local_mem_84561;\n    int64_t trans_arr_len_84562;\n    int64_t phys_block_id_84568;\n    int64_t virtloop_bound_84569;\n    \n    local_tid_84554 = get_local_id(0);\n    tblock_sizze_84557 = get_local_size(0);\n    wave_sizze_84556 = LOCKSTEP_WIDTH;\n    block_id_84555 = get_tblock_id(0);\n    global_tid_84553 = block_id_84555 * tblock_sizze_84557 + local_tid_84554;\n    phys_tid_75499 = sext_i32_i64(global_tid_84553);\n    chunk_sizze_32b_84558 = sext_i64_i32(chunk_sizze_84542);\n    byte_offsets_84559 = segscan_tblock_sizze_75494 * (int64_t) 8;\n    warp_byte_offset_84560 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84561 = (__local unsigned char *) local_mem_84561_backing_0;\n    trans_arr_len_84562 = chunk_sizze_84542 * segscan_tblock_sizze_75494;\n    phys_block_id_84568 = get_tblock_id(0);\n    virtloop_bound_84569 = sdiv_up64(num_virt_blocks_84543 - phys_block_id_84568, num_tblocks_75496);\n    for (int64_t virtloop_i_84570 = 0; virtloop_i_84570 < virtloop_bound_84569; virtloop_i_84570++) {\n        int64_t dynamic_id_84571;\n        int64_t block_offset_84572;\n        int64_t sgm_idx_84573;\n        int32_t boundary_84574;\n        int32_t segsizze_compact_84575;\n        int64_t private_mem_84576[chunk_sizze_84542];\n        int64_t thd_offset_84578;\n        int64_t acc_84594;\n        int64_t prefix_84604;\n        bool block_new_sgm_84605;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_84554 == 0) {\n                dynamic_id_84571 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84551)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n         ", "           ((__local int64_t *) local_mem_84561)[(int64_t) 0] = dynamic_id_84571;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_84571 == num_virt_blocks_84543 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84551)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_84571 = ((__local int32_t *) local_mem_84561)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_84572 = dynamic_id_84571 * chunk_sizze_84542 * segscan_tblock_sizze_75494;\n        sgm_idx_84573 = smod64(block_offset_84572, mk_adjacency_list_res_66334);\n        boundary_84574 = sext_i64_i32(smin64(chunk_sizze_84542 * segscan_tblock_sizze_75494, mk_adjacency_list_res_66334 - sgm_idx_84573));\n        segsizze_compact_84575 = sext_i64_i32(smin64(chunk_sizze_84542 * segscan_tblock_sizze_75494, mk_adjacency_list_res_66334));\n        thd_offset_84578 = block_offset_84572 + sext_i32_i64(local_tid_84554);\n        // Load and map\n        {\n            for (int64_t i_84579 = 0; i_84579 < chunk_sizze_84542; i_84579++) {\n                int64_t virt_tid_84580 = thd_offset_84578 + i_84579 * segscan_tblock_sizze_75494;\n                int64_t slice_84581 = mk_adjacency_list_res_66334;\n                int64_t gtid_75498 = virt_tid_84580;\n                int64_t remnant_84582 = virt_tid_84580 - gtid_75498;\n                \n                if (slt64(virt_tid_84580, mk_adjacency_list_res_66334)) {\n                    int64_t zv_lhs_66552 = add64((int64_t) 1, gtid_75498);\n                    int64_t tmp_66553 = smod64(zv_lhs_66552, mk_adjacency_list_res_66334);\n                    bool lifted_lambda_res_66554 = ((__global bool *) mem_82225)[tmp_66553];\n                    int64_t bool_res_66555 = btoi_bool_i64(lifted_lambda_res_66554);\n                    \n                    ((__gl", "obal bool *) mem_82232)[gtid_75498] = lifted_lambda_res_66554;\n                    private_mem_84576[i_84579] = bool_res_66555;\n                } else {\n                    private_mem_84576[i_84579] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_84583 = 0; i_84583 < chunk_sizze_84542; i_84583++) {\n                int64_t sharedIdx_84584 = sext_i32_i64(local_tid_84554) + i_84583 * segscan_tblock_sizze_75494;\n                int64_t tmp_84585 = private_mem_84576[i_84583];\n                \n                ((__local int64_t *) local_mem_84561)[sharedIdx_84584] = tmp_84585;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84586 = 0; i_84586 < chunk_sizze_84542; i_84586++) {\n                int64_t sharedIdx_84587 = sext_i32_i64(local_tid_84554) * chunk_sizze_84542 + i_84586;\n                int64_t tmp_84588 = ((__local int64_t *) local_mem_84561)[sharedIdx_84587];\n                \n                private_mem_84576[i_84586] = tmp_84588;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_84589 = 0; i_84589 < chunk_sizze_84542 - (int64_t) 1; i_84589++) {\n                int64_t eta_p_66556;\n                int64_t eta_p_66557;\n                \n                eta_p_66556 = private_mem_84576[i_84589];\n                eta_p_66557 = private_mem_84576[i_84589 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_66558 = add64(eta_p_66556, eta_p_66557);\n                \n                private_mem_84576[i_84589 + (int64_t) 1] = defunc_0_op_res_66558;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_84590 = private_mem_84576[chunk_sizze_84542 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = tmp_84590;\n            barri",
                                    "er(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_84591;\n            int64_t eta_p_84592;\n            int64_t eta_p_84595;\n            int64_t eta_p_84596;\n            bool ltid_in_bounds_84598 = slt64(sext_i32_i64(local_tid_84554), num_virt_threads_84544);\n            int32_t skip_threads_84599;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_84598) {\n                    eta_p_84592 = ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)];\n                    if ((local_tid_84554 - squot32(local_tid_84554, 32) * 32) == 0) {\n                        eta_p_84591 = eta_p_84592;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_84599 = 1;\n                while (slt32(skip_threads_84599, 32)) {\n                    bool thread_active_84600 = sle32(skip_threads_84599, local_tid_84554 - squot32(local_tid_84554, 32) * 32) && ltid_in_bounds_84598;\n                    \n                    if (thread_active_84600) {\n                        // read operands\n                        {\n                            eta_p_84591 = ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554) - sext_i32_i64(skip_threads_84599)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_84600) {\n                            int64_t defunc_0_op_res_84593 = add64(eta_p_84591, eta_p_84592);\n                            \n                            eta_p_84591 = defunc_0_op_res_84593;\n                        }\n                    }\n                    if (sle32(wave_sizze_84556, skip_threads_84599)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_84600) {\n                  ", "      // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = eta_p_84591;\n                            eta_p_84592 = eta_p_84591;\n                        }\n                    }\n                    if (sle32(wave_sizze_84556, skip_threads_84599)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_84599 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84554 - squot32(local_tid_84554, 32) * 32) == 31 && ltid_in_bounds_84598) {\n                    ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(squot32(local_tid_84554, 32))] = eta_p_84591;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_84601;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84554, 32) == 0 && ltid_in_bounds_84598) {\n                        eta_p_84596 = ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)];\n                        if ((local_tid_84554 - squot32(local_tid_84554, 32) * 32) == 0) {\n                            eta_p_84595 = eta_p_84596;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84601 = 1;\n                    while (slt32(skip_threads_84601, 32)) {\n                        bool thread_active_84602 = sle32(skip_threads_84601, local_tid_84554 - squot32(local_tid_84554, 32) * 32) && (squot32(local_tid_84554, 32) == 0 && ltid_in_bounds_84598);\n                        \n                ", "        if (thread_active_84602) {\n                            // read operands\n                            {\n                                eta_p_84595 = ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554) - sext_i32_i64(skip_threads_84601)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_84602) {\n                                int64_t defunc_0_op_res_84597 = add64(eta_p_84595, eta_p_84596);\n                                \n                                eta_p_84595 = defunc_0_op_res_84597;\n                            }\n                        }\n                        if (sle32(wave_sizze_84556, skip_threads_84601)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84602) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = eta_p_84595;\n                                eta_p_84596 = eta_p_84595;\n                            }\n                        }\n                        if (sle32(wave_sizze_84556, skip_threads_84601)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84601 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_84603 = squot32(local_tid_84554, 32) == 0 || !ltid_in_bounds_84598;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_84603) {\n                        eta_p_84592 = eta_p_84591;\n                        eta_p_84591 = ((__local int64_t *) local_mem_84561)[sext_i32_i64(squot32(local_tid_84554, 32)) - (i",
                                    "nt64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_84603) {\n                        int64_t defunc_0_op_res_84593 = add64(eta_p_84591, eta_p_84592);\n                        \n                        eta_p_84591 = defunc_0_op_res_84593;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_84603) {\n                        ((__local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = eta_p_84591;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84554, 32) == 0 && ltid_in_bounds_84598) {\n                    ((__local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = eta_p_84592;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84554 == 0) {\n                acc_84594 = ((__local int64_t *) local_mem_84561)[segscan_tblock_sizze_75494 - (int64_t) 1];\n            } else {\n                acc_84594 = ((__local int64_t *) local_mem_84561)[sext_i32_i64(local_tid_84554) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_84604 = (int64_t) 0;\n        block_new_sgm_84605 = sgm_idx_84573 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_84605 && local_tid_84554 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_84549)[dynamic_id_84571] = acc_84594;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84545)[dynamic_id_84571] = (int8_t) 2;\n                acc_84594 = (int64_t) 0;\n            }\n            if (!block_new_sgm_84605 && slt32(local_tid_84554, wave_sizze_84556)) {\n                if (local_tid_8455", "4 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_84547)[dynamic_id_84571] = acc_84594;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_84545)[dynamic_id_84571] = (int8_t) 1;\n                    \n                    int8_t tmp_84606 = ((volatile __global int8_t *) status_flags_mem_84545)[dynamic_id_84571 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84561)[(int64_t) 0] = tmp_84606;\n                }\n                mem_fence_local();\n                \n                int8_t status_84607 = ((__local int8_t *) local_mem_84561)[(int64_t) 0];\n                \n                if (status_84607 == (int8_t) 2) {\n                    if (local_tid_84554 == 0) {\n                        prefix_84604 = ((volatile __global int64_t *) incprefixes_mem_84549)[dynamic_id_84571 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_84608 = sext_i64_i32(dynamic_id_84571 - sext_i32_i64(wave_sizze_84556));\n                    \n                    while (slt32(wave_sizze_84556 * -1, readOffset_84608)) {\n                        int32_t read_i_84609 = readOffset_84608 + local_tid_84554;\n                        int64_t aggr_84610 = (int64_t) 0;\n                        int8_t flag_84611 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_84609)) {\n                            flag_84611 = ((volatile __global int8_t *) status_flags_mem_84545)[sext_i32_i64(read_i_84609)];\n                            if (flag_84611 == (int8_t) 2) {\n                                aggr_84610 = ((volatile __global int64_t *) incprefixes_mem_84549)[sext_i32_i64(read_i_84609)];\n                            } else if (flag_84611 == (int8_t) 1) {\n                                aggr_84610 = ((volatile __global int64_t *) aggregates_mem_84547)[sext_i32_i64(read_i_84609)];\n                            }\n           ", "             }\n                        ((__local int64_t *) local_mem_84561)[(int64_t) 4 + sext_i32_i64(local_tid_84554)] = aggr_84610;\n                        ((__local int8_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = flag_84611;\n                        flag_84611 = ((__local int8_t *) local_mem_84561)[sext_i32_i64(wave_sizze_84556) - (int64_t) 1];\n                        if (slt8(flag_84611, (int8_t) 2)) {\n                            int8_t flg_x_84615;\n                            int8_t flg_y_84616;\n                            int64_t eta_p_84612;\n                            int64_t eta_p_84613;\n                            int32_t skip_threads_84617;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84616 = ((volatile __local int8_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)];\n                                eta_p_84613 = ((volatile __local int64_t *) local_mem_84561)[(int64_t) 4 + sext_i32_i64(local_tid_84554)];\n                                if ((local_tid_84554 - squot32(local_tid_84554, 32) * 32) == 0) {\n                                    eta_p_84612 = eta_p_84613;\n                                    flg_x_84615 = flg_y_84616;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_84617 = 1;\n                                while (slt32(skip_threads_84617, 32)) {\n                                    if (sle32(skip_threads_84617, local_tid_84554 - squot32(local_tid_84554, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_84615 = ((volatile __local int8_t *) local_mem_84561)[sext_i32_i64(local_tid_84554) - sext_i32_i64(skip_threads_84617)];\n                               ",
                                    "             eta_p_84612 = ((volatile __local int64_t *) local_mem_84561)[(int64_t) 4 + (sext_i32_i64(local_tid_84554) - sext_i32_i64(skip_threads_84617))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84616 == (int8_t) 2 || flg_y_84616 == (int8_t) 0) {\n                                                flg_x_84615 = flg_y_84616;\n                                                eta_p_84612 = eta_p_84613;\n                                            } else {\n                                                int64_t defunc_0_op_res_84614 = add64(eta_p_84612, eta_p_84613);\n                                                \n                                                eta_p_84612 = defunc_0_op_res_84614;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84561)[sext_i32_i64(local_tid_84554)] = flg_x_84615;\n                                            flg_y_84616 = flg_x_84615;\n                                            ((volatile __local int64_t *) local_mem_84561)[(int64_t) 4 + sext_i32_i64(local_tid_84554)] = eta_p_84612;\n                                            eta_p_84613 = eta_p_84612;\n                                        }\n                                    }\n                                    skip_threads_84617 *= 2;\n                                }\n                            }\n                        }\n                        flag_84611 = ((__local int8_t *) local_mem_84561)[sext_i32_i64(wave_sizze_84556) - (int64_t) 1];\n                        aggr_84610 = ((__local int64_t *) local_mem_84561)[(int64_t) 4 + (sext_i32_i64(wave_sizze_84556) - (int64_t) 1)];\n                        if (flag_8461", "1 == (int8_t) 2) {\n                            readOffset_84608 = wave_sizze_84556 * -1;\n                        } else if (flag_84611 == (int8_t) 1) {\n                            readOffset_84608 -= wave_sizze_84556;\n                        }\n                        if (slt8((int8_t) 0, flag_84611)) {\n                            int64_t eta_p_84618 = aggr_84610;\n                            int64_t eta_p_84619 = prefix_84604;\n                            int64_t defunc_0_op_res_84620 = add64(eta_p_84618, eta_p_84619);\n                            \n                            prefix_84604 = defunc_0_op_res_84620;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84554 == 0) {\n                    if (boundary_84574 == sext_i64_i32(segscan_tblock_sizze_75494 * chunk_sizze_84542)) {\n                        int64_t eta_p_84621 = prefix_84604;\n                        int64_t eta_p_84622 = acc_84594;\n                        int64_t defunc_0_op_res_84623 = add64(eta_p_84621, eta_p_84622);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_84549)[dynamic_id_84571] = defunc_0_op_res_84623;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84545)[dynamic_id_84571] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_84561)[(int64_t) 4] = prefix_84604;\n                    acc_84594 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_84571 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_84604 = ((__local int64_t *) local_mem_84561)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_84624;\n            int64_t eta_p_84625;\n            int64_t eta_p_84627 = prefix_84604;\n            int64_t eta_", "p_84628 = acc_84594;\n            \n            if (slt32(local_tid_84554 * chunk_sizze_32b_84558, boundary_84574) && !block_new_sgm_84605) {\n                int64_t defunc_0_op_res_84629 = add64(eta_p_84627, eta_p_84628);\n                \n                eta_p_84624 = defunc_0_op_res_84629;\n            } else {\n                eta_p_84624 = acc_84594;\n            }\n            \n            int32_t stopping_point_84630 = segsizze_compact_84575 - srem32(local_tid_84554 * chunk_sizze_32b_84558 - 1 + segsizze_compact_84575 - boundary_84574, segsizze_compact_84575);\n            \n            for (int64_t i_84631 = 0; i_84631 < chunk_sizze_84542; i_84631++) {\n                if (slt32(sext_i64_i32(i_84631), stopping_point_84630 - 1)) {\n                    eta_p_84625 = private_mem_84576[i_84631];\n                    \n                    int64_t defunc_0_op_res_84626 = add64(eta_p_84624, eta_p_84625);\n                    \n                    private_mem_84576[i_84631] = defunc_0_op_res_84626;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84632 = 0; i_84632 < chunk_sizze_84542; i_84632++) {\n                int64_t sharedIdx_84633 = sext_i32_i64(local_tid_84554) * chunk_sizze_84542 + i_84632;\n                int64_t tmp_84634 = private_mem_84576[i_84632];\n                \n                ((__local int64_t *) local_mem_84561)[sharedIdx_84633] = tmp_84634;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84635 = 0; i_84635 < chunk_sizze_84542; i_84635++) {\n                int64_t flat_idx_84636 = thd_offset_84578 + i_84635 * segscan_tblock_sizze_75494;\n                int64_t slice_84637 = mk_adjacency_list_res_66334;\n                int64_t gtid_75498 = flat_idx_84636;\n                int64_t remnant_84638 = flat_idx_84636 - gtid_75498;\n                \n                if (slt64(flat_idx_84636, mk_adjacency_list_res_66334)) {\n   ",
                                    "                 int64_t tmp_84639 = ((__local int64_t *) local_mem_84561)[flat_idx_84636 - block_offset_84572];\n                    \n                    ((__global int64_t *) mem_82231)[gtid_75498] = tmp_84639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75494\n    #undef chunk_sizze_84542\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75526_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75526(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75523, int64_t num_virt_blocks_84968, int64_t num_virt_threads_84969, __global unsigned char *mem_82225, __global unsigned char *ext_mem_82249, __global unsigned char *mem_82251, __global unsigned char *mem_82253, __global unsigned char *status_flags_mem_84970, __global unsigned char *aggregates_mem_84972, __global unsigned char *incprefixes_mem_84974, __global unsigned char *aggregates_mem_84976, __global unsigned char *incprefixes_mem_84978, __global unsigned char *global_dynid_mem_84980)\n{\n    #define segscan_tblock_sizze_75521 (do_DBSCAN_doublezisegscan_75526zisegscan_tblock_sizze_75521)\n    #define chunk_sizze_84967 (do_DBSCAN_doublezisegscan_75526zichunk_sizze_84967)\n    \n    volatile __local unsigned char *local_mem_84992_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84992_backing_0_offset = 0 + (smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75521, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75521), smax64(chunk_sizze_84967 * segscan_tblock_sizze_75521, chunk_sizze_84967 * segscan_tblock_sizze_75521 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75521, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75521), smax64(chunk_sizze_84967 * segscan_tblock_sizze_75521, chunk_sizze_84967 * segscan_tblock_sizze_75521 * (int64_t) 8)), (int64_t) 8), (int64_t) 8));\n    \n    if (", "*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84983;\n    int32_t tblock_sizze_84986;\n    int32_t wave_sizze_84985;\n    int32_t block_id_84984;\n    int32_t global_tid_84982;\n    int64_t phys_tid_75526;\n    int32_t chunk_sizze_32b_84987;\n    int64_t byte_offsets_84988;\n    int64_t byte_offsets_84989;\n    int64_t warp_byte_offset_84990;\n    int64_t warp_byte_offset_84991;\n    __local unsigned char *local_mem_84992;\n    int64_t trans_arr_len_84993;\n    int64_t phys_block_id_85002;\n    int64_t virtloop_bound_85003;\n    \n    local_tid_84983 = get_local_id(0);\n    tblock_sizze_84986 = get_local_size(0);\n    wave_sizze_84985 = LOCKSTEP_WIDTH;\n    block_id_84984 = get_tblock_id(0);\n    global_tid_84982 = block_id_84984 * tblock_sizze_84986 + local_tid_84983;\n    phys_tid_75526 = sext_i32_i64(global_tid_84982);\n    chunk_sizze_32b_84987 = sext_i64_i32(chunk_sizze_84967);\n    byte_offsets_84988 = segscan_tblock_sizze_75521;\n    byte_offsets_84989 = sdiv_up64(byte_offsets_84988, (int64_t) 8) * (int64_t) 8 + segscan_tblock_sizze_75521 * (int64_t) 8;\n    warp_byte_offset_84990 = (int64_t) 64;\n    warp_byte_offset_84991 = sdiv_up64(warp_byte_offset_84990, (int64_t) 8) * (int64_t) 8 + (int64_t) 256;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84992 = (__local unsigned char *) local_mem_84992_backing_0;\n    trans_arr_len_84993 = chunk_sizze_84967 * segscan_tblock_sizze_75521;\n    phys_block_id_85002 = get_tblock_id(0);\n    virtloop_bound_85003 = sdiv_up64(num_virt_blocks_84968 - phys_block_id_85002, num_tblocks_75523);\n    for (int64_t virtloop_i_85004 = 0; virtloop_i_85004 < virtloop_bound_85003; virtloop_i_85004++) {\n        int64_t dynamic_id_85005;\n        int64_t block_offset_85006;\n        int64_t sgm_idx_85007;\n        int32_t boundary_85008;\n        int32_t segsizze_compact_85009;\n        bool private_mem_85010[chunk_sizze_84967];\n        int64_t private_mem_85012[chunk_sizze_84967];\n        int64_t thd_offset_85014;\n        bool acc_85042", ";\n        int64_t acc_85043;\n        bool prefix_85058;\n        int64_t prefix_85059;\n        bool block_new_sgm_85060;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_84983 == 0) {\n                dynamic_id_85005 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84980)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_84992)[(int64_t) 0] = dynamic_id_85005;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_85005 == num_virt_blocks_84968 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84980)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_85005 = ((__local int32_t *) local_mem_84992)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_85006 = dynamic_id_85005 * chunk_sizze_84967 * segscan_tblock_sizze_75521;\n        sgm_idx_85007 = smod64(block_offset_85006, mk_adjacency_list_res_66334);\n        boundary_85008 = sext_i64_i32(smin64(chunk_sizze_84967 * segscan_tblock_sizze_75521, mk_adjacency_list_res_66334 - sgm_idx_85007));\n        segsizze_compact_85009 = sext_i64_i32(smin64(chunk_sizze_84967 * segscan_tblock_sizze_75521, mk_adjacency_list_res_66334));\n        thd_offset_85014 = block_offset_85006 + sext_i32_i64(local_tid_84983);\n        // Load and map\n        {\n            for (int64_t i_85015 = 0; i_85015 < chunk_sizze_84967; i_85015++) {\n                int64_t virt_tid_85016 = thd_offset_85014 + i_85015 * segscan_tblock_sizze_75521;\n                int64_t slice_85017 = mk_adjacency_list_res_66334;\n                int64_t gtid_75525 = virt_tid_85016;\n                int64_t remnant_85018 = virt_tid_85016 - gtid_75525;\n                \n            ",
                                    "    if (slt64(virt_tid_85016, mk_adjacency_list_res_66334)) {\n                    bool x_66604 = ((__global bool *) mem_82225)[gtid_75525];\n                    int64_t x_66605 = ((__global int64_t *) ext_mem_82249)[gtid_75525];\n                    \n                    private_mem_85010[i_85015] = x_66604;\n                    private_mem_85012[i_85015] = x_66605;\n                } else {\n                    private_mem_85010[i_85015] = 0;\n                    private_mem_85012[i_85015] = (int64_t) 9223372036854775807;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_85019 = 0; i_85019 < chunk_sizze_84967; i_85019++) {\n                int64_t sharedIdx_85020 = sext_i32_i64(local_tid_84983) + i_85019 * segscan_tblock_sizze_75521;\n                bool tmp_85021 = private_mem_85010[i_85019];\n                \n                ((__local bool *) local_mem_84992)[sharedIdx_85020] = tmp_85021;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85022 = 0; i_85022 < chunk_sizze_84967; i_85022++) {\n                int64_t sharedIdx_85023 = sext_i32_i64(local_tid_84983) * chunk_sizze_84967 + i_85022;\n                bool tmp_85024 = ((__local bool *) local_mem_84992)[sharedIdx_85023];\n                \n                private_mem_85010[i_85022] = tmp_85024;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85025 = 0; i_85025 < chunk_sizze_84967; i_85025++) {\n                int64_t sharedIdx_85026 = sext_i32_i64(local_tid_84983) + i_85025 * segscan_tblock_sizze_75521;\n                int64_t tmp_85027 = private_mem_85012[i_85025];\n                \n                ((__local int64_t *) local_mem_84992)[sharedIdx_85026] = tmp_85027;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85028 = 0; i_85028 < chunk_sizze_84967; i_85028++) {\n                int64_t sharedIdx_85029 = sext_i32_i64(lo", "cal_tid_84983) * chunk_sizze_84967 + i_85028;\n                int64_t tmp_85030 = ((__local int64_t *) local_mem_84992)[sharedIdx_85029];\n                \n                private_mem_85012[i_85028] = tmp_85030;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_85031 = 0; i_85031 < chunk_sizze_84967 - (int64_t) 1; i_85031++) {\n                bool eta_p_66606;\n                bool eta_p_66608;\n                \n                eta_p_66606 = private_mem_85010[i_85031];\n                eta_p_66608 = private_mem_85010[i_85031 + (int64_t) 1];\n                \n                int64_t eta_p_66607;\n                int64_t eta_p_66609;\n                \n                eta_p_66607 = private_mem_85012[i_85031];\n                eta_p_66609 = private_mem_85012[i_85031 + (int64_t) 1];\n                \n                bool tmp_66610 = eta_p_66606 || eta_p_66608;\n                int64_t tmp_66611;\n                \n                if (eta_p_66608) {\n                    tmp_66611 = eta_p_66609;\n                } else {\n                    bool cond_66612 = slt64(eta_p_66607, eta_p_66609);\n                    int64_t lifted_lambda_res_66613;\n                    \n                    if (cond_66612) {\n                        lifted_lambda_res_66613 = eta_p_66607;\n                    } else {\n                        lifted_lambda_res_66613 = eta_p_66609;\n                    }\n                    tmp_66611 = lifted_lambda_res_66613;\n                }\n                private_mem_85010[i_85031 + (int64_t) 1] = tmp_66610;\n                private_mem_85012[i_85031 + (int64_t) 1] = tmp_66611;\n            }\n        }\n        // Publish results in shared memory\n        {\n            bool tmp_85032 = private_mem_85010[chunk_sizze_84967 - (int64_t) 1];\n            \n            ((__local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = tmp_85032;\n            \n            int64_t tmp_85033 = private_mem_85012[chu", "nk_sizze_84967 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = tmp_85033;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            bool eta_p_85034;\n            int64_t eta_p_85035;\n            bool eta_p_85036;\n            int64_t eta_p_85037;\n            bool eta_p_85044;\n            int64_t eta_p_85045;\n            bool eta_p_85046;\n            int64_t eta_p_85047;\n            bool ltid_in_bounds_85052 = slt64(sext_i32_i64(local_tid_84983), num_virt_threads_84969);\n            int32_t skip_threads_85053;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_85052) {\n                    eta_p_85036 = ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)];\n                    eta_p_85037 = ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)];\n                    if ((local_tid_84983 - squot32(local_tid_84983, 32) * 32) == 0) {\n                        eta_p_85034 = eta_p_85036;\n                        eta_p_85035 = eta_p_85037;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_85053 = 1;\n                while (slt32(skip_threads_85053, 32)) {\n                    bool thread_active_85054 = sle32(skip_threads_85053, local_tid_84983 - squot32(local_tid_84983, 32) * 32) && ltid_in_bounds_85052;\n                    \n                    if (thread_active_85054) {\n                        // read operands\n                        {\n                            eta_p_85034 = ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85053)];\n                            eta_p_85035 = ((volatile __local int64_t *) local_mem_84992)[s",
                                    "quot64(byte_offsets_84988, (int64_t) 8) + (sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85053))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_85054) {\n                            bool tmp_85038 = eta_p_85034 || eta_p_85036;\n                            int64_t tmp_85039;\n                            \n                            if (eta_p_85036) {\n                                tmp_85039 = eta_p_85037;\n                            } else {\n                                bool cond_85040 = slt64(eta_p_85035, eta_p_85037);\n                                int64_t lifted_lambda_res_85041;\n                                \n                                if (cond_85040) {\n                                    lifted_lambda_res_85041 = eta_p_85035;\n                                } else {\n                                    lifted_lambda_res_85041 = eta_p_85037;\n                                }\n                                tmp_85039 = lifted_lambda_res_85041;\n                            }\n                            eta_p_85034 = tmp_85038;\n                            eta_p_85035 = tmp_85039;\n                        }\n                    }\n                    if (sle32(wave_sizze_84985, skip_threads_85053)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_85054) {\n                        // write result\n                        {\n                            ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = eta_p_85034;\n                            eta_p_85036 = eta_p_85034;\n                            ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = eta_p_85035;\n                            eta_p_85037 = eta_p_85035;\n                        }\n                    }\n                    if (sle3", "2(wave_sizze_84985, skip_threads_85053)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_85053 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84983 - squot32(local_tid_84983, 32) * 32) == 31 && ltid_in_bounds_85052) {\n                    ((volatile __local bool *) local_mem_84992)[sext_i32_i64(squot32(local_tid_84983, 32))] = eta_p_85034;\n                    ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(squot32(local_tid_84983, 32))] = eta_p_85035;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_85055;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84983, 32) == 0 && ltid_in_bounds_85052) {\n                        eta_p_85046 = ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)];\n                        eta_p_85047 = ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)];\n                        if ((local_tid_84983 - squot32(local_tid_84983, 32) * 32) == 0) {\n                            eta_p_85044 = eta_p_85046;\n                            eta_p_85045 = eta_p_85047;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_85055 = 1;\n                    while (slt32(skip_threads_85055, 32)) {\n                        bool thread_active_85056 = sle32(skip_threads_85055, local_tid_84983 - squot32(local_tid_84983, 32) * 32) && (squot32(local_tid_84983", ", 32) == 0 && ltid_in_bounds_85052);\n                        \n                        if (thread_active_85056) {\n                            // read operands\n                            {\n                                eta_p_85044 = ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85055)];\n                                eta_p_85045 = ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + (sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85055))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_85056) {\n                                bool tmp_85048 = eta_p_85044 || eta_p_85046;\n                                int64_t tmp_85049;\n                                \n                                if (eta_p_85046) {\n                                    tmp_85049 = eta_p_85047;\n                                } else {\n                                    bool cond_85050 = slt64(eta_p_85045, eta_p_85047);\n                                    int64_t lifted_lambda_res_85051;\n                                    \n                                    if (cond_85050) {\n                                        lifted_lambda_res_85051 = eta_p_85045;\n                                    } else {\n                                        lifted_lambda_res_85051 = eta_p_85047;\n                                    }\n                                    tmp_85049 = lifted_lambda_res_85051;\n                                }\n                                eta_p_85044 = tmp_85048;\n                                eta_p_85045 = tmp_85049;\n                            }\n                        }\n                        if (sle32(wave_sizze_84985, skip_threads_85055)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (th",
                                    "read_active_85056) {\n                            // write result\n                            {\n                                ((volatile __local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = eta_p_85044;\n                                eta_p_85046 = eta_p_85044;\n                                ((volatile __local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = eta_p_85045;\n                                eta_p_85047 = eta_p_85045;\n                            }\n                        }\n                        if (sle32(wave_sizze_84985, skip_threads_85055)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_85055 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_85057 = squot32(local_tid_84983, 32) == 0 || !ltid_in_bounds_85052;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_85057) {\n                        eta_p_85036 = eta_p_85034;\n                        eta_p_85037 = eta_p_85035;\n                        eta_p_85034 = ((__local bool *) local_mem_84992)[sext_i32_i64(squot32(local_tid_84983, 32)) - (int64_t) 1];\n                        eta_p_85035 = ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + (sext_i32_i64(squot32(local_tid_84983, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_85057) {\n                        bool tmp_85038 = eta_p_85034 || eta_p_85036;\n                        int64_t tmp_85039;\n                        \n                        if (eta_p_85036) {\n                            tmp_85039 = eta_p_85037;\n                        } else {\n                         ", "   bool cond_85040 = slt64(eta_p_85035, eta_p_85037);\n                            int64_t lifted_lambda_res_85041;\n                            \n                            if (cond_85040) {\n                                lifted_lambda_res_85041 = eta_p_85035;\n                            } else {\n                                lifted_lambda_res_85041 = eta_p_85037;\n                            }\n                            tmp_85039 = lifted_lambda_res_85041;\n                        }\n                        eta_p_85034 = tmp_85038;\n                        eta_p_85035 = tmp_85039;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_85057) {\n                        ((__local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = eta_p_85034;\n                        ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = eta_p_85035;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84983, 32) == 0 && ltid_in_bounds_85052) {\n                    ((__local bool *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = eta_p_85036;\n                    ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = eta_p_85037;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84983 == 0) {\n                acc_85042 = ((__local bool *) local_mem_84992)[segscan_tblock_sizze_75521 - (int64_t) 1];\n                acc_85043 = ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + (segscan_tblock_sizze_75521 - (int64_t) 1)];\n            } else {\n                acc_85042 = ((__local bool *) local_mem_84992)[sext_i32_i64(local_ti", "d_84983) - (int64_t) 1];\n                acc_85043 = ((__local int64_t *) local_mem_84992)[squot64(byte_offsets_84988, (int64_t) 8) + (sext_i32_i64(local_tid_84983) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_85058 = 0;\n        prefix_85059 = (int64_t) 9223372036854775807;\n        block_new_sgm_85060 = sgm_idx_85007 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_85060 && local_tid_84983 == 0) {\n                ((volatile __global bool *) incprefixes_mem_84974)[dynamic_id_85005] = acc_85042;\n                ((volatile __global int64_t *) incprefixes_mem_84978)[dynamic_id_85005] = acc_85043;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84970)[dynamic_id_85005] = (int8_t) 2;\n                acc_85042 = 0;\n                acc_85043 = (int64_t) 9223372036854775807;\n            }\n            if (!block_new_sgm_85060 && slt32(local_tid_84983, wave_sizze_84985)) {\n                if (local_tid_84983 == 0) {\n                    ((volatile __global bool *) aggregates_mem_84972)[dynamic_id_85005] = acc_85042;\n                    ((volatile __global int64_t *) aggregates_mem_84976)[dynamic_id_85005] = acc_85043;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_84970)[dynamic_id_85005] = (int8_t) 1;\n                    \n                    int8_t tmp_85061 = ((volatile __global int8_t *) status_flags_mem_84970)[dynamic_id_85005 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84992)[(int64_t) 0] = tmp_85061;\n                }\n                mem_fence_local();\n                \n                int8_t status_85062 = ((__local int8_t *) local_mem_84992)[(int64_t) 0];\n                \n                if (status_85062 == (int8_t) 2) {\n                    if (local_tid_84983 == 0) {\n                        prefix_85058 = ((volatile __globa",
                                    "l bool *) incprefixes_mem_84974)[dynamic_id_85005 - (int64_t) 1];\n                        prefix_85059 = ((volatile __global int64_t *) incprefixes_mem_84978)[dynamic_id_85005 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_85063 = sext_i64_i32(dynamic_id_85005 - sext_i32_i64(wave_sizze_84985));\n                    \n                    while (slt32(wave_sizze_84985 * -1, readOffset_85063)) {\n                        int32_t read_i_85064 = readOffset_85063 + local_tid_84983;\n                        bool aggr_85065 = 0;\n                        int64_t aggr_85066 = (int64_t) 9223372036854775807;\n                        int8_t flag_85067 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_85064)) {\n                            flag_85067 = ((volatile __global int8_t *) status_flags_mem_84970)[sext_i32_i64(read_i_85064)];\n                            if (flag_85067 == (int8_t) 2) {\n                                aggr_85065 = ((volatile __global bool *) incprefixes_mem_84974)[sext_i32_i64(read_i_85064)];\n                                aggr_85066 = ((volatile __global int64_t *) incprefixes_mem_84978)[sext_i32_i64(read_i_85064)];\n                            } else if (flag_85067 == (int8_t) 1) {\n                                aggr_85065 = ((volatile __global bool *) aggregates_mem_84972)[sext_i32_i64(read_i_85064)];\n                                aggr_85066 = ((volatile __global int64_t *) aggregates_mem_84976)[sext_i32_i64(read_i_85064)];\n                            }\n                        }\n                        ((__local bool *) local_mem_84992)[(int64_t) 32 + sext_i32_i64(local_tid_84983)] = aggr_85065;\n                        ((__local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = aggr_85066;\n                        ((__local int8_t *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = flag_85067;\n                      ", "  flag_85067 = ((__local int8_t *) local_mem_84992)[sext_i32_i64(wave_sizze_84985) - (int64_t) 1];\n                        if (slt8(flag_85067, (int8_t) 2)) {\n                            int8_t flg_x_85076;\n                            int8_t flg_y_85077;\n                            bool eta_p_85068;\n                            int64_t eta_p_85069;\n                            bool eta_p_85070;\n                            int64_t eta_p_85071;\n                            int32_t skip_threads_85078;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_85077 = ((volatile __local int8_t *) local_mem_84992)[sext_i32_i64(local_tid_84983)];\n                                eta_p_85070 = ((volatile __local bool *) local_mem_84992)[(int64_t) 32 + sext_i32_i64(local_tid_84983)];\n                                eta_p_85071 = ((volatile __local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8) + sext_i32_i64(local_tid_84983)];\n                                if ((local_tid_84983 - squot32(local_tid_84983, 32) * 32) == 0) {\n                                    eta_p_85068 = eta_p_85070;\n                                    eta_p_85069 = eta_p_85071;\n                                    flg_x_85076 = flg_y_85077;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_85078 = 1;\n                                while (slt32(skip_threads_85078, 32)) {\n                                    if (sle32(skip_threads_85078, local_tid_84983 - squot32(local_tid_84983, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_85076 = ((volatile __local int8_t *) local_mem_84992)[sext_i32_i64(local_tid_84983) - sext_", "i32_i64(skip_threads_85078)];\n                                            eta_p_85068 = ((volatile __local bool *) local_mem_84992)[(int64_t) 32 + (sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85078))];\n                                            eta_p_85069 = ((volatile __local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8) + (sext_i32_i64(local_tid_84983) - sext_i32_i64(skip_threads_85078))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_85077 == (int8_t) 2 || flg_y_85077 == (int8_t) 0) {\n                                                flg_x_85076 = flg_y_85077;\n                                                eta_p_85068 = eta_p_85070;\n                                                eta_p_85069 = eta_p_85071;\n                                            } else {\n                                                bool tmp_85072 = eta_p_85068 || eta_p_85070;\n                                                int64_t tmp_85073;\n                                                \n                                                if (eta_p_85070) {\n                                                    tmp_85073 = eta_p_85071;\n                                                } else {\n                                                    bool cond_85074 = slt64(eta_p_85069, eta_p_85071);\n                                                    int64_t lifted_lambda_res_85075;\n                                                    \n                                                    if (cond_85074) {\n                                                        lifted_lambda_res_85075 = eta_p_85069;\n                                                    } else {\n                                                        lifted_lambda_res_85075 = eta_p_85071;\n                                                    }\n        ",
                                    "                                            tmp_85073 = lifted_lambda_res_85075;\n                                                }\n                                                eta_p_85068 = tmp_85072;\n                                                eta_p_85069 = tmp_85073;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84992)[sext_i32_i64(local_tid_84983)] = flg_x_85076;\n                                            flg_y_85077 = flg_x_85076;\n                                            ((volatile __local bool *) local_mem_84992)[(int64_t) 32 + sext_i32_i64(local_tid_84983)] = eta_p_85068;\n                                            eta_p_85070 = eta_p_85068;\n                                            ((volatile __local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8) + sext_i32_i64(local_tid_84983)] = eta_p_85069;\n                                            eta_p_85071 = eta_p_85069;\n                                        }\n                                    }\n                                    skip_threads_85078 *= 2;\n                                }\n                            }\n                        }\n                        flag_85067 = ((__local int8_t *) local_mem_84992)[sext_i32_i64(wave_sizze_84985) - (int64_t) 1];\n                        aggr_85065 = ((__local bool *) local_mem_84992)[(int64_t) 32 + (sext_i32_i64(wave_sizze_84985) - (int64_t) 1)];\n                        aggr_85066 = ((__local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8) + (sext_i32_i64(wave_sizze_84985) - (int64_t) 1)];\n                        if (flag_85067 == (int8_t) 2) {\n                            readOffset_85063 = wave_sizze_84985 * -1;\n                        } else if (flag_85067 == (int8_t) 1) {\n       ", "                     readOffset_85063 -= wave_sizze_84985;\n                        }\n                        if (slt8((int8_t) 0, flag_85067)) {\n                            bool eta_p_85079 = aggr_85065;\n                            int64_t eta_p_85080 = aggr_85066;\n                            bool eta_p_85081 = prefix_85058;\n                            int64_t eta_p_85082 = prefix_85059;\n                            bool tmp_85083 = eta_p_85079 || eta_p_85081;\n                            int64_t tmp_85084;\n                            \n                            if (eta_p_85081) {\n                                tmp_85084 = eta_p_85082;\n                            } else {\n                                bool cond_85085 = slt64(eta_p_85080, eta_p_85082);\n                                int64_t lifted_lambda_res_85086;\n                                \n                                if (cond_85085) {\n                                    lifted_lambda_res_85086 = eta_p_85080;\n                                } else {\n                                    lifted_lambda_res_85086 = eta_p_85082;\n                                }\n                                tmp_85084 = lifted_lambda_res_85086;\n                            }\n                            prefix_85058 = tmp_85083;\n                            prefix_85059 = tmp_85084;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84983 == 0) {\n                    if (boundary_85008 == sext_i64_i32(segscan_tblock_sizze_75521 * chunk_sizze_84967)) {\n                        bool eta_p_85087 = prefix_85058;\n                        int64_t eta_p_85088 = prefix_85059;\n                        bool eta_p_85089 = acc_85042;\n                        int64_t eta_p_85090 = acc_85043;\n                        bool tmp_85091 = eta_p_85087 || eta_p_85089;\n                        int64_t tmp_85092;\n                        \n                        if (eta_", "p_85089) {\n                            tmp_85092 = eta_p_85090;\n                        } else {\n                            bool cond_85093 = slt64(eta_p_85088, eta_p_85090);\n                            int64_t lifted_lambda_res_85094;\n                            \n                            if (cond_85093) {\n                                lifted_lambda_res_85094 = eta_p_85088;\n                            } else {\n                                lifted_lambda_res_85094 = eta_p_85090;\n                            }\n                            tmp_85092 = lifted_lambda_res_85094;\n                        }\n                        ((volatile __global bool *) incprefixes_mem_84974)[dynamic_id_85005] = tmp_85091;\n                        ((volatile __global int64_t *) incprefixes_mem_84978)[dynamic_id_85005] = tmp_85092;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84970)[dynamic_id_85005] = (int8_t) 2;\n                    }\n                    ((__local bool *) local_mem_84992)[(int64_t) 32] = prefix_85058;\n                    ((__local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8)] = prefix_85059;\n                    acc_85042 = 0;\n                    acc_85043 = (int64_t) 9223372036854775807;\n                }\n            }\n            if (!(dynamic_id_85005 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_85058 = ((__local bool *) local_mem_84992)[(int64_t) 32];\n                prefix_85059 = ((__local int64_t *) local_mem_84992)[squot64(warp_byte_offset_84990, (int64_t) 8)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            bool eta_p_85095;\n            bool eta_p_85097;\n            bool eta_p_85103 = prefix_85058;\n            bool eta_p_85105 = acc_85042;\n            int64_t eta_p_85096;\n            int64_t eta_p_85098;\n            int64_t eta_p_85104 = prefix_8",
                                    "5059;\n            int64_t eta_p_85106 = acc_85043;\n            \n            if (slt32(local_tid_84983 * chunk_sizze_32b_84987, boundary_85008) && !block_new_sgm_85060) {\n                bool tmp_85107 = eta_p_85103 || eta_p_85105;\n                int64_t tmp_85108;\n                \n                if (eta_p_85105) {\n                    tmp_85108 = eta_p_85106;\n                } else {\n                    bool cond_85109 = slt64(eta_p_85104, eta_p_85106);\n                    int64_t lifted_lambda_res_85110;\n                    \n                    if (cond_85109) {\n                        lifted_lambda_res_85110 = eta_p_85104;\n                    } else {\n                        lifted_lambda_res_85110 = eta_p_85106;\n                    }\n                    tmp_85108 = lifted_lambda_res_85110;\n                }\n                eta_p_85095 = tmp_85107;\n                eta_p_85096 = tmp_85108;\n            } else {\n                eta_p_85095 = acc_85042;\n                eta_p_85096 = acc_85043;\n            }\n            \n            int32_t stopping_point_85111 = segsizze_compact_85009 - srem32(local_tid_84983 * chunk_sizze_32b_84987 - 1 + segsizze_compact_85009 - boundary_85008, segsizze_compact_85009);\n            \n            for (int64_t i_85112 = 0; i_85112 < chunk_sizze_84967; i_85112++) {\n                if (slt32(sext_i64_i32(i_85112), stopping_point_85111 - 1)) {\n                    eta_p_85097 = private_mem_85010[i_85112];\n                    eta_p_85098 = private_mem_85012[i_85112];\n                    \n                    bool tmp_85099 = eta_p_85095 || eta_p_85097;\n                    int64_t tmp_85100;\n                    \n                    if (eta_p_85097) {\n                        tmp_85100 = eta_p_85098;\n                    } else {\n                        bool cond_85101 = slt64(eta_p_85096, eta_p_85098);\n                        int64_t lifted_lambda_res_85102;\n                        \n                        if (cond_85101) {\n                     ", "       lifted_lambda_res_85102 = eta_p_85096;\n                        } else {\n                            lifted_lambda_res_85102 = eta_p_85098;\n                        }\n                        tmp_85100 = lifted_lambda_res_85102;\n                    }\n                    private_mem_85010[i_85112] = tmp_85099;\n                    private_mem_85012[i_85112] = tmp_85100;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_85113 = 0; i_85113 < chunk_sizze_84967; i_85113++) {\n                int64_t sharedIdx_85114 = sext_i32_i64(local_tid_84983) * chunk_sizze_84967 + i_85113;\n                bool tmp_85115 = private_mem_85010[i_85113];\n                \n                ((__local bool *) local_mem_84992)[sharedIdx_85114] = tmp_85115;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85116 = 0; i_85116 < chunk_sizze_84967; i_85116++) {\n                int64_t flat_idx_85117 = thd_offset_85014 + i_85116 * segscan_tblock_sizze_75521;\n                int64_t slice_85118 = mk_adjacency_list_res_66334;\n                int64_t gtid_75525 = flat_idx_85117;\n                int64_t remnant_85119 = flat_idx_85117 - gtid_75525;\n                \n                if (slt64(flat_idx_85117, mk_adjacency_list_res_66334)) {\n                    bool tmp_85120 = ((__local bool *) local_mem_84992)[flat_idx_85117 - block_offset_85006];\n                    \n                    ((__global bool *) mem_82251)[gtid_75525] = tmp_85120;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85121 = 0; i_85121 < chunk_sizze_84967; i_85121++) {\n                int64_t sharedIdx_85122 = sext_i32_i64(local_tid_84983) * chunk_sizze_84967 + i_85121;\n                int64_t tmp_85123 = private_mem_85012[i_85121];\n                \n                ((__local int64_t *) local_mem_84992)[sharedIdx_85122] = tmp_85123;\n     ", "       }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85124 = 0; i_85124 < chunk_sizze_84967; i_85124++) {\n                int64_t flat_idx_85125 = thd_offset_85014 + i_85124 * segscan_tblock_sizze_75521;\n                int64_t slice_85126 = mk_adjacency_list_res_66334;\n                int64_t gtid_75525 = flat_idx_85125;\n                int64_t remnant_85127 = flat_idx_85125 - gtid_75525;\n                \n                if (slt64(flat_idx_85125, mk_adjacency_list_res_66334)) {\n                    int64_t tmp_85128 = ((__local int64_t *) local_mem_84992)[flat_idx_85125 - block_offset_85006];\n                    \n                    ((__global int64_t *) mem_82253)[gtid_75525] = tmp_85128;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75521\n    #undef chunk_sizze_84967\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75534_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75534(__global int *global_failure, int64_t mk_adjacency_list_res_66334, int64_t num_tblocks_75531, int64_t num_virt_blocks_84646, int64_t num_virt_threads_84647, __global unsigned char *mem_82225, __global unsigned char *mem_82256, __global unsigned char *mem_82257, __global unsigned char *status_flags_mem_84648, __global unsigned char *aggregates_mem_84650, __global unsigned char *incprefixes_mem_84652, __global unsigned char *global_dynid_mem_84654)\n{\n    #define segscan_tblock_sizze_75529 (do_DBSCAN_doublezisegscan_75534zisegscan_tblock_sizze_75529)\n    #define chunk_sizze_84645 (do_DBSCAN_doublezisegscan_75534zichunk_sizze_84645)\n    \n    volatile __local unsigned char *local_mem_84664_backing_0 = &shared_mem[0];\n    const int64_t local_mem_84664_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75529), chunk_sizze_84645 * segscan_tblock_sizze_75529 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * ",
                                    "segscan_tblock_sizze_75529), chunk_sizze_84645 * segscan_tblock_sizze_75529 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_84657;\n    int32_t tblock_sizze_84660;\n    int32_t wave_sizze_84659;\n    int32_t block_id_84658;\n    int32_t global_tid_84656;\n    int64_t phys_tid_75534;\n    int32_t chunk_sizze_32b_84661;\n    int64_t byte_offsets_84662;\n    int64_t warp_byte_offset_84663;\n    __local unsigned char *local_mem_84664;\n    int64_t trans_arr_len_84665;\n    int64_t phys_block_id_84671;\n    int64_t virtloop_bound_84672;\n    \n    local_tid_84657 = get_local_id(0);\n    tblock_sizze_84660 = get_local_size(0);\n    wave_sizze_84659 = LOCKSTEP_WIDTH;\n    block_id_84658 = get_tblock_id(0);\n    global_tid_84656 = block_id_84658 * tblock_sizze_84660 + local_tid_84657;\n    phys_tid_75534 = sext_i32_i64(global_tid_84656);\n    chunk_sizze_32b_84661 = sext_i64_i32(chunk_sizze_84645);\n    byte_offsets_84662 = segscan_tblock_sizze_75529 * (int64_t) 8;\n    warp_byte_offset_84663 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_84664 = (__local unsigned char *) local_mem_84664_backing_0;\n    trans_arr_len_84665 = chunk_sizze_84645 * segscan_tblock_sizze_75529;\n    phys_block_id_84671 = get_tblock_id(0);\n    virtloop_bound_84672 = sdiv_up64(num_virt_blocks_84646 - phys_block_id_84671, num_tblocks_75531);\n    for (int64_t virtloop_i_84673 = 0; virtloop_i_84673 < virtloop_bound_84672; virtloop_i_84673++) {\n        int64_t dynamic_id_84674;\n        int64_t block_offset_84675;\n        int64_t sgm_idx_84676;\n        int32_t boundary_84677;\n        int32_t segsizze_compact_84678;\n        int64_t private_mem_84679[chunk_sizze_84645];\n        int64_t thd_offset_84681;\n        int64_t acc_84697;\n        int64_t prefix_84707;\n        bool block_new_sgm_84708;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_84657 == 0) {\n          ", "      dynamic_id_84674 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_84654)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_84664)[(int64_t) 0] = dynamic_id_84674;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_84674 == num_virt_blocks_84646 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_84654)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_84674 = ((__local int32_t *) local_mem_84664)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_84675 = dynamic_id_84674 * chunk_sizze_84645 * segscan_tblock_sizze_75529;\n        sgm_idx_84676 = smod64(block_offset_84675, mk_adjacency_list_res_66334);\n        boundary_84677 = sext_i64_i32(smin64(chunk_sizze_84645 * segscan_tblock_sizze_75529, mk_adjacency_list_res_66334 - sgm_idx_84676));\n        segsizze_compact_84678 = sext_i64_i32(smin64(chunk_sizze_84645 * segscan_tblock_sizze_75529, mk_adjacency_list_res_66334));\n        thd_offset_84681 = block_offset_84675 + sext_i32_i64(local_tid_84657);\n        // Load and map\n        {\n            for (int64_t i_84682 = 0; i_84682 < chunk_sizze_84645; i_84682++) {\n                int64_t virt_tid_84683 = thd_offset_84681 + i_84682 * segscan_tblock_sizze_75529;\n                int64_t slice_84684 = mk_adjacency_list_res_66334;\n                int64_t gtid_75533 = virt_tid_84683;\n                int64_t remnant_84685 = virt_tid_84683 - gtid_75533;\n                \n                if (slt64(virt_tid_84683, mk_adjacency_list_res_66334)) {\n                    int64_t zv_lhs_66621 = add64((int64_t) 1, gtid_75533);\n                    int64_t tmp_66622 = smod64(zv_lhs_66621, mk_adjacency_list_res_66334);\n                    bool l", "ifted_lambda_res_66623 = ((__global bool *) mem_82225)[tmp_66622];\n                    int64_t bool_res_66624 = btoi_bool_i64(lifted_lambda_res_66623);\n                    \n                    ((__global bool *) mem_82257)[gtid_75533] = lifted_lambda_res_66623;\n                    private_mem_84679[i_84682] = bool_res_66624;\n                } else {\n                    private_mem_84679[i_84682] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_84686 = 0; i_84686 < chunk_sizze_84645; i_84686++) {\n                int64_t sharedIdx_84687 = sext_i32_i64(local_tid_84657) + i_84686 * segscan_tblock_sizze_75529;\n                int64_t tmp_84688 = private_mem_84679[i_84686];\n                \n                ((__local int64_t *) local_mem_84664)[sharedIdx_84687] = tmp_84688;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84689 = 0; i_84689 < chunk_sizze_84645; i_84689++) {\n                int64_t sharedIdx_84690 = sext_i32_i64(local_tid_84657) * chunk_sizze_84645 + i_84689;\n                int64_t tmp_84691 = ((__local int64_t *) local_mem_84664)[sharedIdx_84690];\n                \n                private_mem_84679[i_84689] = tmp_84691;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_84692 = 0; i_84692 < chunk_sizze_84645 - (int64_t) 1; i_84692++) {\n                int64_t eta_p_66625;\n                int64_t eta_p_66626;\n                \n                eta_p_66625 = private_mem_84679[i_84692];\n                eta_p_66626 = private_mem_84679[i_84692 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_66627 = add64(eta_p_66625, eta_p_66626);\n                \n                private_mem_84679[i_84692 + (int64_t) 1] = defunc_0_op_res_66627;\n            }\n        }\n        // Publish results in shared memory\n        {\n         ",
                                    "   int64_t tmp_84693 = private_mem_84679[chunk_sizze_84645 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = tmp_84693;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_84694;\n            int64_t eta_p_84695;\n            int64_t eta_p_84698;\n            int64_t eta_p_84699;\n            bool ltid_in_bounds_84701 = slt64(sext_i32_i64(local_tid_84657), num_virt_threads_84647);\n            int32_t skip_threads_84702;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_84701) {\n                    eta_p_84695 = ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)];\n                    if ((local_tid_84657 - squot32(local_tid_84657, 32) * 32) == 0) {\n                        eta_p_84694 = eta_p_84695;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_84702 = 1;\n                while (slt32(skip_threads_84702, 32)) {\n                    bool thread_active_84703 = sle32(skip_threads_84702, local_tid_84657 - squot32(local_tid_84657, 32) * 32) && ltid_in_bounds_84701;\n                    \n                    if (thread_active_84703) {\n                        // read operands\n                        {\n                            eta_p_84694 = ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657) - sext_i32_i64(skip_threads_84702)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_84703) {\n                            int64_t defunc_0_op_res_84696 = add64(eta_p_84694, eta_p_84695);\n                            \n                            eta_p_84694 = defunc_0_op_res_84696;\n                        }\n                    }\n             ", "       if (sle32(wave_sizze_84659, skip_threads_84702)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_84703) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = eta_p_84694;\n                            eta_p_84695 = eta_p_84694;\n                        }\n                    }\n                    if (sle32(wave_sizze_84659, skip_threads_84702)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_84702 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_84657 - squot32(local_tid_84657, 32) * 32) == 31 && ltid_in_bounds_84701) {\n                    ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(squot32(local_tid_84657, 32))] = eta_p_84694;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_84704;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_84657, 32) == 0 && ltid_in_bounds_84701) {\n                        eta_p_84699 = ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)];\n                        if ((local_tid_84657 - squot32(local_tid_84657, 32) * 32) == 0) {\n                            eta_p_84698 = eta_p_84699;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_84704 = 1;\n                    while (slt32(skip_threads_84704, 32)) {\n                        bool thread_", "active_84705 = sle32(skip_threads_84704, local_tid_84657 - squot32(local_tid_84657, 32) * 32) && (squot32(local_tid_84657, 32) == 0 && ltid_in_bounds_84701);\n                        \n                        if (thread_active_84705) {\n                            // read operands\n                            {\n                                eta_p_84698 = ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657) - sext_i32_i64(skip_threads_84704)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_84705) {\n                                int64_t defunc_0_op_res_84700 = add64(eta_p_84698, eta_p_84699);\n                                \n                                eta_p_84698 = defunc_0_op_res_84700;\n                            }\n                        }\n                        if (sle32(wave_sizze_84659, skip_threads_84704)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_84705) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = eta_p_84698;\n                                eta_p_84699 = eta_p_84698;\n                            }\n                        }\n                        if (sle32(wave_sizze_84659, skip_threads_84704)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_84704 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_84706 = squot32(local_tid_84657, 32) == 0 || !ltid_in_bounds_84701;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    i",
                                    "f (!no_carry_in_84706) {\n                        eta_p_84695 = eta_p_84694;\n                        eta_p_84694 = ((__local int64_t *) local_mem_84664)[sext_i32_i64(squot32(local_tid_84657, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_84706) {\n                        int64_t defunc_0_op_res_84696 = add64(eta_p_84694, eta_p_84695);\n                        \n                        eta_p_84694 = defunc_0_op_res_84696;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_84706) {\n                        ((__local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = eta_p_84694;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_84657, 32) == 0 && ltid_in_bounds_84701) {\n                    ((__local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = eta_p_84695;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_84657 == 0) {\n                acc_84697 = ((__local int64_t *) local_mem_84664)[segscan_tblock_sizze_75529 - (int64_t) 1];\n            } else {\n                acc_84697 = ((__local int64_t *) local_mem_84664)[sext_i32_i64(local_tid_84657) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_84707 = (int64_t) 0;\n        block_new_sgm_84708 = sgm_idx_84676 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_84708 && local_tid_84657 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_84652)[dynamic_id_84674] = acc_84697;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_84648)[dynami", "c_id_84674] = (int8_t) 2;\n                acc_84697 = (int64_t) 0;\n            }\n            if (!block_new_sgm_84708 && slt32(local_tid_84657, wave_sizze_84659)) {\n                if (local_tid_84657 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_84650)[dynamic_id_84674] = acc_84697;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_84648)[dynamic_id_84674] = (int8_t) 1;\n                    \n                    int8_t tmp_84709 = ((volatile __global int8_t *) status_flags_mem_84648)[dynamic_id_84674 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_84664)[(int64_t) 0] = tmp_84709;\n                }\n                mem_fence_local();\n                \n                int8_t status_84710 = ((__local int8_t *) local_mem_84664)[(int64_t) 0];\n                \n                if (status_84710 == (int8_t) 2) {\n                    if (local_tid_84657 == 0) {\n                        prefix_84707 = ((volatile __global int64_t *) incprefixes_mem_84652)[dynamic_id_84674 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_84711 = sext_i64_i32(dynamic_id_84674 - sext_i32_i64(wave_sizze_84659));\n                    \n                    while (slt32(wave_sizze_84659 * -1, readOffset_84711)) {\n                        int32_t read_i_84712 = readOffset_84711 + local_tid_84657;\n                        int64_t aggr_84713 = (int64_t) 0;\n                        int8_t flag_84714 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_84712)) {\n                            flag_84714 = ((volatile __global int8_t *) status_flags_mem_84648)[sext_i32_i64(read_i_84712)];\n                            if (flag_84714 == (int8_t) 2) {\n                                aggr_84713 = ((volatile __global int64_t *) incprefixes_mem_84652)[sext_i32_i64(read_i_84712)];\n                            } else i", "f (flag_84714 == (int8_t) 1) {\n                                aggr_84713 = ((volatile __global int64_t *) aggregates_mem_84650)[sext_i32_i64(read_i_84712)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_84664)[(int64_t) 4 + sext_i32_i64(local_tid_84657)] = aggr_84713;\n                        ((__local int8_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = flag_84714;\n                        flag_84714 = ((__local int8_t *) local_mem_84664)[sext_i32_i64(wave_sizze_84659) - (int64_t) 1];\n                        if (slt8(flag_84714, (int8_t) 2)) {\n                            int8_t flg_x_84718;\n                            int8_t flg_y_84719;\n                            int64_t eta_p_84715;\n                            int64_t eta_p_84716;\n                            int32_t skip_threads_84720;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_84719 = ((volatile __local int8_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)];\n                                eta_p_84716 = ((volatile __local int64_t *) local_mem_84664)[(int64_t) 4 + sext_i32_i64(local_tid_84657)];\n                                if ((local_tid_84657 - squot32(local_tid_84657, 32) * 32) == 0) {\n                                    eta_p_84715 = eta_p_84716;\n                                    flg_x_84718 = flg_y_84719;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_84720 = 1;\n                                while (slt32(skip_threads_84720, 32)) {\n                                    if (sle32(skip_threads_84720, local_tid_84657 - squot32(local_tid_84657, 32) * 32)) {\n                                        // read operands\n                                        {\n   ",
                                    "                                         flg_x_84718 = ((volatile __local int8_t *) local_mem_84664)[sext_i32_i64(local_tid_84657) - sext_i32_i64(skip_threads_84720)];\n                                            eta_p_84715 = ((volatile __local int64_t *) local_mem_84664)[(int64_t) 4 + (sext_i32_i64(local_tid_84657) - sext_i32_i64(skip_threads_84720))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_84719 == (int8_t) 2 || flg_y_84719 == (int8_t) 0) {\n                                                flg_x_84718 = flg_y_84719;\n                                                eta_p_84715 = eta_p_84716;\n                                            } else {\n                                                int64_t defunc_0_op_res_84717 = add64(eta_p_84715, eta_p_84716);\n                                                \n                                                eta_p_84715 = defunc_0_op_res_84717;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_84664)[sext_i32_i64(local_tid_84657)] = flg_x_84718;\n                                            flg_y_84719 = flg_x_84718;\n                                            ((volatile __local int64_t *) local_mem_84664)[(int64_t) 4 + sext_i32_i64(local_tid_84657)] = eta_p_84715;\n                                            eta_p_84716 = eta_p_84715;\n                                        }\n                                    }\n                                    skip_threads_84720 *= 2;\n                                }\n                            }\n                        }\n                        flag_84714 = ((__local int8_t *) local_mem_84664)[sext_i32_i64(wave_sizze", "_84659) - (int64_t) 1];\n                        aggr_84713 = ((__local int64_t *) local_mem_84664)[(int64_t) 4 + (sext_i32_i64(wave_sizze_84659) - (int64_t) 1)];\n                        if (flag_84714 == (int8_t) 2) {\n                            readOffset_84711 = wave_sizze_84659 * -1;\n                        } else if (flag_84714 == (int8_t) 1) {\n                            readOffset_84711 -= wave_sizze_84659;\n                        }\n                        if (slt8((int8_t) 0, flag_84714)) {\n                            int64_t eta_p_84721 = aggr_84713;\n                            int64_t eta_p_84722 = prefix_84707;\n                            int64_t defunc_0_op_res_84723 = add64(eta_p_84721, eta_p_84722);\n                            \n                            prefix_84707 = defunc_0_op_res_84723;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_84657 == 0) {\n                    if (boundary_84677 == sext_i64_i32(segscan_tblock_sizze_75529 * chunk_sizze_84645)) {\n                        int64_t eta_p_84724 = prefix_84707;\n                        int64_t eta_p_84725 = acc_84697;\n                        int64_t defunc_0_op_res_84726 = add64(eta_p_84724, eta_p_84725);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_84652)[dynamic_id_84674] = defunc_0_op_res_84726;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_84648)[dynamic_id_84674] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_84664)[(int64_t) 4] = prefix_84707;\n                    acc_84697 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_84674 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_84707 = ((__local int64_t *) local_mem_84664)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n   ", "         }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_84727;\n            int64_t eta_p_84728;\n            int64_t eta_p_84730 = prefix_84707;\n            int64_t eta_p_84731 = acc_84697;\n            \n            if (slt32(local_tid_84657 * chunk_sizze_32b_84661, boundary_84677) && !block_new_sgm_84708) {\n                int64_t defunc_0_op_res_84732 = add64(eta_p_84730, eta_p_84731);\n                \n                eta_p_84727 = defunc_0_op_res_84732;\n            } else {\n                eta_p_84727 = acc_84697;\n            }\n            \n            int32_t stopping_point_84733 = segsizze_compact_84678 - srem32(local_tid_84657 * chunk_sizze_32b_84661 - 1 + segsizze_compact_84678 - boundary_84677, segsizze_compact_84678);\n            \n            for (int64_t i_84734 = 0; i_84734 < chunk_sizze_84645; i_84734++) {\n                if (slt32(sext_i64_i32(i_84734), stopping_point_84733 - 1)) {\n                    eta_p_84728 = private_mem_84679[i_84734];\n                    \n                    int64_t defunc_0_op_res_84729 = add64(eta_p_84727, eta_p_84728);\n                    \n                    private_mem_84679[i_84734] = defunc_0_op_res_84729;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_84735 = 0; i_84735 < chunk_sizze_84645; i_84735++) {\n                int64_t sharedIdx_84736 = sext_i32_i64(local_tid_84657) * chunk_sizze_84645 + i_84735;\n                int64_t tmp_84737 = private_mem_84679[i_84735];\n                \n                ((__local int64_t *) local_mem_84664)[sharedIdx_84736] = tmp_84737;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_84738 = 0; i_84738 < chunk_sizze_84645; i_84738++) {\n                int64_t flat_idx_84739 = thd_offset_84681 + i_84738 * segscan_tblock_sizze_75529;\n                int64_t slice_84740 = mk_adjacency_list_res_66334;\n                i",
                                    "nt64_t gtid_75533 = flat_idx_84739;\n                int64_t remnant_84741 = flat_idx_84739 - gtid_75533;\n                \n                if (slt64(flat_idx_84739, mk_adjacency_list_res_66334)) {\n                    int64_t tmp_84742 = ((__local int64_t *) local_mem_84664)[flat_idx_84739 - block_offset_84675];\n                    \n                    ((__global int64_t *) mem_82256)[gtid_75533] = tmp_84742;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75529\n    #undef chunk_sizze_84645\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_75834_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75834(__global int *global_failure, int64_t conc_tmp_62382, int64_t num_tblocks_75831, int64_t num_virt_blocks_85288, int64_t num_virt_threads_85289, __global unsigned char *ext_mem_82263, __global unsigned char *mem_82266, __global unsigned char *status_flags_mem_85290, __global unsigned char *aggregates_mem_85292, __global unsigned char *incprefixes_mem_85294, __global unsigned char *global_dynid_mem_85296)\n{\n    #define segscan_tblock_sizze_75829 (do_DBSCAN_doublezisegscan_75834zisegscan_tblock_sizze_75829)\n    #define chunk_sizze_85287 (do_DBSCAN_doublezisegscan_75834zichunk_sizze_85287)\n    \n    volatile __local unsigned char *local_mem_85306_backing_0 = &shared_mem[0];\n    const int64_t local_mem_85306_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75829), chunk_sizze_85287 * segscan_tblock_sizze_75829 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75829), chunk_sizze_85287 * segscan_tblock_sizze_75829 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85299;\n    int32_t tblock_sizze_85302;\n    int32_t wave_sizze_85301;\n    int32_t block_id_85300;\n    int32_t global_tid_85298;\n    int64_t phys_tid_75834;\n   ", " int32_t chunk_sizze_32b_85303;\n    int64_t byte_offsets_85304;\n    int64_t warp_byte_offset_85305;\n    __local unsigned char *local_mem_85306;\n    int64_t trans_arr_len_85307;\n    int64_t phys_block_id_85313;\n    int64_t virtloop_bound_85314;\n    \n    local_tid_85299 = get_local_id(0);\n    tblock_sizze_85302 = get_local_size(0);\n    wave_sizze_85301 = LOCKSTEP_WIDTH;\n    block_id_85300 = get_tblock_id(0);\n    global_tid_85298 = block_id_85300 * tblock_sizze_85302 + local_tid_85299;\n    phys_tid_75834 = sext_i32_i64(global_tid_85298);\n    chunk_sizze_32b_85303 = sext_i64_i32(chunk_sizze_85287);\n    byte_offsets_85304 = segscan_tblock_sizze_75829 * (int64_t) 8;\n    warp_byte_offset_85305 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_85306 = (__local unsigned char *) local_mem_85306_backing_0;\n    trans_arr_len_85307 = chunk_sizze_85287 * segscan_tblock_sizze_75829;\n    phys_block_id_85313 = get_tblock_id(0);\n    virtloop_bound_85314 = sdiv_up64(num_virt_blocks_85288 - phys_block_id_85313, num_tblocks_75831);\n    for (int64_t virtloop_i_85315 = 0; virtloop_i_85315 < virtloop_bound_85314; virtloop_i_85315++) {\n        int64_t dynamic_id_85316;\n        int64_t block_offset_85317;\n        int64_t sgm_idx_85318;\n        int32_t boundary_85319;\n        int32_t segsizze_compact_85320;\n        int64_t private_mem_85321[chunk_sizze_85287];\n        int64_t thd_offset_85323;\n        int64_t acc_85339;\n        int64_t prefix_85349;\n        bool block_new_sgm_85350;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_85299 == 0) {\n                dynamic_id_85316 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_85296)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_85306)[(int64_t) 0] = dynamic_id_85316;\n                }\n                // First thread in last (virtual) block re", "sets global dynamic_id\n                {\n                    if (dynamic_id_85316 == num_virt_blocks_85288 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_85296)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_85316 = ((__local int32_t *) local_mem_85306)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_85317 = dynamic_id_85316 * chunk_sizze_85287 * segscan_tblock_sizze_75829;\n        sgm_idx_85318 = smod64(block_offset_85317, conc_tmp_62382);\n        boundary_85319 = sext_i64_i32(smin64(chunk_sizze_85287 * segscan_tblock_sizze_75829, conc_tmp_62382 - sgm_idx_85318));\n        segsizze_compact_85320 = sext_i64_i32(smin64(chunk_sizze_85287 * segscan_tblock_sizze_75829, conc_tmp_62382));\n        thd_offset_85323 = block_offset_85317 + sext_i32_i64(local_tid_85299);\n        // Load and map\n        {\n            for (int64_t i_85324 = 0; i_85324 < chunk_sizze_85287; i_85324++) {\n                int64_t virt_tid_85325 = thd_offset_85323 + i_85324 * segscan_tblock_sizze_75829;\n                int64_t slice_85326 = conc_tmp_62382;\n                int64_t gtid_75833 = virt_tid_85325;\n                int64_t remnant_85327 = virt_tid_85325 - gtid_75833;\n                \n                if (slt64(virt_tid_85325, conc_tmp_62382)) {\n                    int64_t eta_p_64386 = ((__global int64_t *) ext_mem_82263)[gtid_75833];\n                    bool defunc_0_f_res_64387 = gtid_75833 == eta_p_64386;\n                    int64_t lifted_lambda_res_64389 = btoi_bool_i64(defunc_0_f_res_64387);\n                    \n                    private_mem_85321[i_85324] = lifted_lambda_res_64389;\n                } else {\n                    private_mem_85321[i_85324] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_85328 = 0; i_85328 < chu",
                                    "nk_sizze_85287; i_85328++) {\n                int64_t sharedIdx_85329 = sext_i32_i64(local_tid_85299) + i_85328 * segscan_tblock_sizze_75829;\n                int64_t tmp_85330 = private_mem_85321[i_85328];\n                \n                ((__local int64_t *) local_mem_85306)[sharedIdx_85329] = tmp_85330;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85331 = 0; i_85331 < chunk_sizze_85287; i_85331++) {\n                int64_t sharedIdx_85332 = sext_i32_i64(local_tid_85299) * chunk_sizze_85287 + i_85331;\n                int64_t tmp_85333 = ((__local int64_t *) local_mem_85306)[sharedIdx_85332];\n                \n                private_mem_85321[i_85331] = tmp_85333;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_85334 = 0; i_85334 < chunk_sizze_85287 - (int64_t) 1; i_85334++) {\n                int64_t eta_p_62806;\n                int64_t eta_p_62807;\n                \n                eta_p_62806 = private_mem_85321[i_85334];\n                eta_p_62807 = private_mem_85321[i_85334 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_62808 = add64(eta_p_62806, eta_p_62807);\n                \n                private_mem_85321[i_85334 + (int64_t) 1] = defunc_0_op_res_62808;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_85335 = private_mem_85321[chunk_sizze_85287 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = tmp_85335;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_85336;\n            int64_t eta_p_85337;\n            int64_t eta_p_85340;\n            int64_t eta_p_85341;\n            bool ltid_in_bounds_85343 = slt64(sext_i32_i64(local_tid_85299), num_virt_threads_85289);\n            int32_t skip_threads_85344;\n            \n            // r", "ead input for in-block scan\n            {\n                if (ltid_in_bounds_85343) {\n                    eta_p_85337 = ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)];\n                    if ((local_tid_85299 - squot32(local_tid_85299, 32) * 32) == 0) {\n                        eta_p_85336 = eta_p_85337;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_85344 = 1;\n                while (slt32(skip_threads_85344, 32)) {\n                    bool thread_active_85345 = sle32(skip_threads_85344, local_tid_85299 - squot32(local_tid_85299, 32) * 32) && ltid_in_bounds_85343;\n                    \n                    if (thread_active_85345) {\n                        // read operands\n                        {\n                            eta_p_85336 = ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299) - sext_i32_i64(skip_threads_85344)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_85345) {\n                            int64_t defunc_0_op_res_85338 = add64(eta_p_85336, eta_p_85337);\n                            \n                            eta_p_85336 = defunc_0_op_res_85338;\n                        }\n                    }\n                    if (sle32(wave_sizze_85301, skip_threads_85344)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_85345) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = eta_p_85336;\n                            eta_p_85337 = eta_p_85336;\n                        }\n                    }\n                    if (sle32(wave_sizze_85301, skip_threads_85344)) {\n                        barrier(CLK_LOCAL_MEM_", "FENCE);\n                    }\n                    skip_threads_85344 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_85299 - squot32(local_tid_85299, 32) * 32) == 31 && ltid_in_bounds_85343) {\n                    ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(squot32(local_tid_85299, 32))] = eta_p_85336;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_85346;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_85299, 32) == 0 && ltid_in_bounds_85343) {\n                        eta_p_85341 = ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)];\n                        if ((local_tid_85299 - squot32(local_tid_85299, 32) * 32) == 0) {\n                            eta_p_85340 = eta_p_85341;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_85346 = 1;\n                    while (slt32(skip_threads_85346, 32)) {\n                        bool thread_active_85347 = sle32(skip_threads_85346, local_tid_85299 - squot32(local_tid_85299, 32) * 32) && (squot32(local_tid_85299, 32) == 0 && ltid_in_bounds_85343);\n                        \n                        if (thread_active_85347) {\n                            // read operands\n                            {\n                                eta_p_85340 = ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299) - sext_i32_i64(skip_threads_85346)];\n                            }\n                        }\n                        // perform operation\n                  ",
                                    "      {\n                            if (thread_active_85347) {\n                                int64_t defunc_0_op_res_85342 = add64(eta_p_85340, eta_p_85341);\n                                \n                                eta_p_85340 = defunc_0_op_res_85342;\n                            }\n                        }\n                        if (sle32(wave_sizze_85301, skip_threads_85346)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_85347) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = eta_p_85340;\n                                eta_p_85341 = eta_p_85340;\n                            }\n                        }\n                        if (sle32(wave_sizze_85301, skip_threads_85346)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_85346 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_85348 = squot32(local_tid_85299, 32) == 0 || !ltid_in_bounds_85343;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_85348) {\n                        eta_p_85337 = eta_p_85336;\n                        eta_p_85336 = ((__local int64_t *) local_mem_85306)[sext_i32_i64(squot32(local_tid_85299, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_85348) {\n                        int64_t defunc_0_op_res_85338 = add64(eta_p_85336, eta_p_85337);\n                        \n                        eta_p_85336 = defunc_0_op_res_85338;\n                    }\n                }\n                // wr", "ite final result\n                {\n                    if (!no_carry_in_85348) {\n                        ((__local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = eta_p_85336;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_85299, 32) == 0 && ltid_in_bounds_85343) {\n                    ((__local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = eta_p_85337;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_85299 == 0) {\n                acc_85339 = ((__local int64_t *) local_mem_85306)[segscan_tblock_sizze_75829 - (int64_t) 1];\n            } else {\n                acc_85339 = ((__local int64_t *) local_mem_85306)[sext_i32_i64(local_tid_85299) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_85349 = (int64_t) 0;\n        block_new_sgm_85350 = sgm_idx_85318 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_85350 && local_tid_85299 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_85294)[dynamic_id_85316] = acc_85339;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_85290)[dynamic_id_85316] = (int8_t) 2;\n                acc_85339 = (int64_t) 0;\n            }\n            if (!block_new_sgm_85350 && slt32(local_tid_85299, wave_sizze_85301)) {\n                if (local_tid_85299 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_85292)[dynamic_id_85316] = acc_85339;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_85290)[dynamic_id_85316] = (int8_t) 1;\n                    \n                    int8_t tmp_85351 = ((volatile __global int8_t *) status_flags_mem_85290)[dynamic_id_8531", "6 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_85306)[(int64_t) 0] = tmp_85351;\n                }\n                mem_fence_local();\n                \n                int8_t status_85352 = ((__local int8_t *) local_mem_85306)[(int64_t) 0];\n                \n                if (status_85352 == (int8_t) 2) {\n                    if (local_tid_85299 == 0) {\n                        prefix_85349 = ((volatile __global int64_t *) incprefixes_mem_85294)[dynamic_id_85316 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_85353 = sext_i64_i32(dynamic_id_85316 - sext_i32_i64(wave_sizze_85301));\n                    \n                    while (slt32(wave_sizze_85301 * -1, readOffset_85353)) {\n                        int32_t read_i_85354 = readOffset_85353 + local_tid_85299;\n                        int64_t aggr_85355 = (int64_t) 0;\n                        int8_t flag_85356 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_85354)) {\n                            flag_85356 = ((volatile __global int8_t *) status_flags_mem_85290)[sext_i32_i64(read_i_85354)];\n                            if (flag_85356 == (int8_t) 2) {\n                                aggr_85355 = ((volatile __global int64_t *) incprefixes_mem_85294)[sext_i32_i64(read_i_85354)];\n                            } else if (flag_85356 == (int8_t) 1) {\n                                aggr_85355 = ((volatile __global int64_t *) aggregates_mem_85292)[sext_i32_i64(read_i_85354)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_85306)[(int64_t) 4 + sext_i32_i64(local_tid_85299)] = aggr_85355;\n                        ((__local int8_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = flag_85356;\n                        flag_85356 = ((__local int8_t *) local_mem_85306)[sext_i32_i64(wave_sizze_85301) - (int64_t) 1];\n                        if",
                                    " (slt8(flag_85356, (int8_t) 2)) {\n                            int8_t flg_x_85360;\n                            int8_t flg_y_85361;\n                            int64_t eta_p_85357;\n                            int64_t eta_p_85358;\n                            int32_t skip_threads_85362;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_85361 = ((volatile __local int8_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)];\n                                eta_p_85358 = ((volatile __local int64_t *) local_mem_85306)[(int64_t) 4 + sext_i32_i64(local_tid_85299)];\n                                if ((local_tid_85299 - squot32(local_tid_85299, 32) * 32) == 0) {\n                                    eta_p_85357 = eta_p_85358;\n                                    flg_x_85360 = flg_y_85361;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_85362 = 1;\n                                while (slt32(skip_threads_85362, 32)) {\n                                    if (sle32(skip_threads_85362, local_tid_85299 - squot32(local_tid_85299, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_85360 = ((volatile __local int8_t *) local_mem_85306)[sext_i32_i64(local_tid_85299) - sext_i32_i64(skip_threads_85362)];\n                                            eta_p_85357 = ((volatile __local int64_t *) local_mem_85306)[(int64_t) 4 + (sext_i32_i64(local_tid_85299) - sext_i32_i64(skip_threads_85362))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_85361 == (int8_t) 2 || flg_y_8536", "1 == (int8_t) 0) {\n                                                flg_x_85360 = flg_y_85361;\n                                                eta_p_85357 = eta_p_85358;\n                                            } else {\n                                                int64_t defunc_0_op_res_85359 = add64(eta_p_85357, eta_p_85358);\n                                                \n                                                eta_p_85357 = defunc_0_op_res_85359;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_85306)[sext_i32_i64(local_tid_85299)] = flg_x_85360;\n                                            flg_y_85361 = flg_x_85360;\n                                            ((volatile __local int64_t *) local_mem_85306)[(int64_t) 4 + sext_i32_i64(local_tid_85299)] = eta_p_85357;\n                                            eta_p_85358 = eta_p_85357;\n                                        }\n                                    }\n                                    skip_threads_85362 *= 2;\n                                }\n                            }\n                        }\n                        flag_85356 = ((__local int8_t *) local_mem_85306)[sext_i32_i64(wave_sizze_85301) - (int64_t) 1];\n                        aggr_85355 = ((__local int64_t *) local_mem_85306)[(int64_t) 4 + (sext_i32_i64(wave_sizze_85301) - (int64_t) 1)];\n                        if (flag_85356 == (int8_t) 2) {\n                            readOffset_85353 = wave_sizze_85301 * -1;\n                        } else if (flag_85356 == (int8_t) 1) {\n                            readOffset_85353 -= wave_sizze_85301;\n                        }\n                        if (slt8((int8_t) 0, flag_85356)) {\n                            int64_t eta_p_85363 = aggr_85355;\n                       ", "     int64_t eta_p_85364 = prefix_85349;\n                            int64_t defunc_0_op_res_85365 = add64(eta_p_85363, eta_p_85364);\n                            \n                            prefix_85349 = defunc_0_op_res_85365;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_85299 == 0) {\n                    if (boundary_85319 == sext_i64_i32(segscan_tblock_sizze_75829 * chunk_sizze_85287)) {\n                        int64_t eta_p_85366 = prefix_85349;\n                        int64_t eta_p_85367 = acc_85339;\n                        int64_t defunc_0_op_res_85368 = add64(eta_p_85366, eta_p_85367);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_85294)[dynamic_id_85316] = defunc_0_op_res_85368;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_85290)[dynamic_id_85316] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_85306)[(int64_t) 4] = prefix_85349;\n                    acc_85339 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_85316 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_85349 = ((__local int64_t *) local_mem_85306)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_85369;\n            int64_t eta_p_85370;\n            int64_t eta_p_85372 = prefix_85349;\n            int64_t eta_p_85373 = acc_85339;\n            \n            if (slt32(local_tid_85299 * chunk_sizze_32b_85303, boundary_85319) && !block_new_sgm_85350) {\n                int64_t defunc_0_op_res_85374 = add64(eta_p_85372, eta_p_85373);\n                \n                eta_p_85369 = defunc_0_op_res_85374;\n            } else {\n                eta_p_85369 = acc_85339;\n            }\n            \n         ",
                                    "   int32_t stopping_point_85375 = segsizze_compact_85320 - srem32(local_tid_85299 * chunk_sizze_32b_85303 - 1 + segsizze_compact_85320 - boundary_85319, segsizze_compact_85320);\n            \n            for (int64_t i_85376 = 0; i_85376 < chunk_sizze_85287; i_85376++) {\n                if (slt32(sext_i64_i32(i_85376), stopping_point_85375 - 1)) {\n                    eta_p_85370 = private_mem_85321[i_85376];\n                    \n                    int64_t defunc_0_op_res_85371 = add64(eta_p_85369, eta_p_85370);\n                    \n                    private_mem_85321[i_85376] = defunc_0_op_res_85371;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_85377 = 0; i_85377 < chunk_sizze_85287; i_85377++) {\n                int64_t sharedIdx_85378 = sext_i32_i64(local_tid_85299) * chunk_sizze_85287 + i_85377;\n                int64_t tmp_85379 = private_mem_85321[i_85377];\n                \n                ((__local int64_t *) local_mem_85306)[sharedIdx_85378] = tmp_85379;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85380 = 0; i_85380 < chunk_sizze_85287; i_85380++) {\n                int64_t flat_idx_85381 = thd_offset_85323 + i_85380 * segscan_tblock_sizze_75829;\n                int64_t slice_85382 = conc_tmp_62382;\n                int64_t gtid_75833 = flat_idx_85381;\n                int64_t remnant_85383 = flat_idx_85381 - gtid_75833;\n                \n                if (slt64(flat_idx_85381, conc_tmp_62382)) {\n                    int64_t tmp_85384 = ((__local int64_t *) local_mem_85306)[flat_idx_85381 - block_offset_85317];\n                    \n                    ((__global int64_t *) mem_82266)[gtid_75833] = tmp_85384;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75829\n    #undef chunk_sizze_85287\n}\nFUTHARK_KERNEL_S", "IZED(do_DBSCAN_doublezisegscan_75908_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_75908(__global int *global_failure, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62382, int64_t num_tblocks_75905, int64_t num_virt_blocks_85409, int64_t num_virt_threads_85410, __global unsigned char *mem_82044, __global unsigned char *ext_mem_82064, __global unsigned char *mem_82077, __global unsigned char *mem_82275, __global unsigned char *mem_82277, __global unsigned char *status_flags_mem_85411, __global unsigned char *aggregates_mem_85413, __global unsigned char *incprefixes_mem_85415, __global unsigned char *global_dynid_mem_85417)\n{\n    #define segscan_tblock_sizze_75903 (do_DBSCAN_doublezisegscan_75908zisegscan_tblock_sizze_75903)\n    #define chunk_sizze_85408 (do_DBSCAN_doublezisegscan_75908zichunk_sizze_85408)\n    \n    volatile __local unsigned char *local_mem_85427_backing_0 = &shared_mem[0];\n    const int64_t local_mem_85427_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75903), chunk_sizze_85408 * segscan_tblock_sizze_75903 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75903), chunk_sizze_85408 * segscan_tblock_sizze_75903 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85420;\n    int32_t tblock_sizze_85423;\n    int32_t wave_sizze_85422;\n    int32_t block_id_85421;\n    int32_t global_tid_85419;\n    int64_t phys_tid_75908;\n    int32_t chunk_sizze_32b_85424;\n    int64_t byte_offsets_85425;\n    int64_t warp_byte_offset_85426;\n    __local unsigned char *local_mem_85427;\n    int64_t trans_arr_len_85428;\n    int64_t phys_block_id_85434;\n    int64_t virtloop_bound_85435;\n    \n    local_tid_85420 = get_local_id(0);\n    tblock_sizze_85423 = get_local_size(0);\n    wave_sizze_85422 = LOCKSTEP_WIDTH;\n    block_id_85421 = get_tblock_id(0);\n    global_tid_85419 = block_id_85421 * tblock_sizze_85423", " + local_tid_85420;\n    phys_tid_75908 = sext_i32_i64(global_tid_85419);\n    chunk_sizze_32b_85424 = sext_i64_i32(chunk_sizze_85408);\n    byte_offsets_85425 = segscan_tblock_sizze_75903 * (int64_t) 8;\n    warp_byte_offset_85426 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_85427 = (__local unsigned char *) local_mem_85427_backing_0;\n    trans_arr_len_85428 = chunk_sizze_85408 * segscan_tblock_sizze_75903;\n    phys_block_id_85434 = get_tblock_id(0);\n    virtloop_bound_85435 = sdiv_up64(num_virt_blocks_85409 - phys_block_id_85434, num_tblocks_75905);\n    for (int64_t virtloop_i_85436 = 0; virtloop_i_85436 < virtloop_bound_85435; virtloop_i_85436++) {\n        int64_t dynamic_id_85437;\n        int64_t block_offset_85438;\n        int64_t sgm_idx_85439;\n        int32_t boundary_85440;\n        int32_t segsizze_compact_85441;\n        int64_t private_mem_85442[chunk_sizze_85408];\n        int64_t thd_offset_85444;\n        int64_t acc_85460;\n        int64_t prefix_85470;\n        bool block_new_sgm_85471;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_85420 == 0) {\n                dynamic_id_85437 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_85417)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_85427)[(int64_t) 0] = dynamic_id_85437;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_85437 == num_virt_blocks_85409 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_85417)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_85437 = ((__local int32_t *) local_mem_85427)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_85438 = dynamic_",
                                    "id_85437 * chunk_sizze_85408 * segscan_tblock_sizze_75903;\n        sgm_idx_85439 = smod64(block_offset_85438, conc_tmp_62382);\n        boundary_85440 = sext_i64_i32(smin64(chunk_sizze_85408 * segscan_tblock_sizze_75903, conc_tmp_62382 - sgm_idx_85439));\n        segsizze_compact_85441 = sext_i64_i32(smin64(chunk_sizze_85408 * segscan_tblock_sizze_75903, conc_tmp_62382));\n        thd_offset_85444 = block_offset_85438 + sext_i32_i64(local_tid_85420);\n        // Load and map\n        {\n            for (int64_t i_85445 = 0; i_85445 < chunk_sizze_85408; i_85445++) {\n                int64_t virt_tid_85446 = thd_offset_85444 + i_85445 * segscan_tblock_sizze_75903;\n                int64_t slice_85447 = conc_tmp_62382;\n                int64_t gtid_75907 = virt_tid_85446;\n                int64_t remnant_85448 = virt_tid_85446 - gtid_75907;\n                \n                if (slt64(virt_tid_85446, conc_tmp_62382)) {\n                    bool index_concat_cmp_77849 = sle64(conc_tmp_62375, gtid_75907);\n                    int64_t index_concat_branch_77857;\n                    \n                    if (index_concat_cmp_77849) {\n                        int64_t index_concat_i_77850 = sub64(gtid_75907, conc_tmp_62375);\n                        int64_t index_concat_77851 = ((__global int64_t *) ext_mem_82064)[index_concat_i_77850];\n                        \n                        index_concat_branch_77857 = index_concat_77851;\n                    } else {\n                        bool index_concat_cmp_77852 = sle64(m_62289, gtid_75907);\n                        int64_t index_concat_branch_77856;\n                        \n                        if (index_concat_cmp_77852) {\n                            int64_t index_concat_i_77853 = sub64(gtid_75907, m_62289);\n                            int64_t index_concat_77854 = ((__global int64_t *) mem_82044)[index_concat_i_77853];\n                            \n                            index_concat_branch_77856 = index_concat_77854;\n                 ", "       } else {\n                            int64_t index_concat_77855 = ((__global int64_t *) mem_82077)[gtid_75907];\n                            \n                            index_concat_branch_77856 = index_concat_77855;\n                        }\n                        index_concat_branch_77857 = index_concat_branch_77856;\n                    }\n                    \n                    bool lifted_lambda_res_64353 = sle64((int64_t) 0, index_concat_branch_77857);\n                    int64_t defunc_0_f_res_64354 = btoi_bool_i64(lifted_lambda_res_64353);\n                    \n                    ((__global int64_t *) mem_82277)[gtid_75907] = defunc_0_f_res_64354;\n                    private_mem_85442[i_85445] = defunc_0_f_res_64354;\n                } else {\n                    private_mem_85442[i_85445] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_85449 = 0; i_85449 < chunk_sizze_85408; i_85449++) {\n                int64_t sharedIdx_85450 = sext_i32_i64(local_tid_85420) + i_85449 * segscan_tblock_sizze_75903;\n                int64_t tmp_85451 = private_mem_85442[i_85449];\n                \n                ((__local int64_t *) local_mem_85427)[sharedIdx_85450] = tmp_85451;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85452 = 0; i_85452 < chunk_sizze_85408; i_85452++) {\n                int64_t sharedIdx_85453 = sext_i32_i64(local_tid_85420) * chunk_sizze_85408 + i_85452;\n                int64_t tmp_85454 = ((__local int64_t *) local_mem_85427)[sharedIdx_85453];\n                \n                private_mem_85442[i_85452] = tmp_85454;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_85455 = 0; i_85455 < chunk_sizze_85408 - (int64_t) 1; i_85455++) {\n                int64_t eta_p_62830;\n                int64_t eta_p_62831;\n                ", "\n                eta_p_62830 = private_mem_85442[i_85455];\n                eta_p_62831 = private_mem_85442[i_85455 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_62832 = add64(eta_p_62830, eta_p_62831);\n                \n                private_mem_85442[i_85455 + (int64_t) 1] = defunc_0_op_res_62832;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_85456 = private_mem_85442[chunk_sizze_85408 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = tmp_85456;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_85457;\n            int64_t eta_p_85458;\n            int64_t eta_p_85461;\n            int64_t eta_p_85462;\n            bool ltid_in_bounds_85464 = slt64(sext_i32_i64(local_tid_85420), num_virt_threads_85410);\n            int32_t skip_threads_85465;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_85464) {\n                    eta_p_85458 = ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)];\n                    if ((local_tid_85420 - squot32(local_tid_85420, 32) * 32) == 0) {\n                        eta_p_85457 = eta_p_85458;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_85465 = 1;\n                while (slt32(skip_threads_85465, 32)) {\n                    bool thread_active_85466 = sle32(skip_threads_85465, local_tid_85420 - squot32(local_tid_85420, 32) * 32) && ltid_in_bounds_85464;\n                    \n                    if (thread_active_85466) {\n                        // read operands\n                        {\n                            eta_p_85457 = ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420) - sext_i32_i64(skip_threads_8546",
                                    "5)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_85466) {\n                            int64_t defunc_0_op_res_85459 = add64(eta_p_85457, eta_p_85458);\n                            \n                            eta_p_85457 = defunc_0_op_res_85459;\n                        }\n                    }\n                    if (sle32(wave_sizze_85422, skip_threads_85465)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_85466) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = eta_p_85457;\n                            eta_p_85458 = eta_p_85457;\n                        }\n                    }\n                    if (sle32(wave_sizze_85422, skip_threads_85465)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_85465 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_85420 - squot32(local_tid_85420, 32) * 32) == 31 && ltid_in_bounds_85464) {\n                    ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(squot32(local_tid_85420, 32))] = eta_p_85457;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_85467;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_85420, 32) == 0 && ltid_in_bounds_85464) {\n                        eta_p_85462 = ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)];\n                  ", "      if ((local_tid_85420 - squot32(local_tid_85420, 32) * 32) == 0) {\n                            eta_p_85461 = eta_p_85462;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_85467 = 1;\n                    while (slt32(skip_threads_85467, 32)) {\n                        bool thread_active_85468 = sle32(skip_threads_85467, local_tid_85420 - squot32(local_tid_85420, 32) * 32) && (squot32(local_tid_85420, 32) == 0 && ltid_in_bounds_85464);\n                        \n                        if (thread_active_85468) {\n                            // read operands\n                            {\n                                eta_p_85461 = ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420) - sext_i32_i64(skip_threads_85467)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_85468) {\n                                int64_t defunc_0_op_res_85463 = add64(eta_p_85461, eta_p_85462);\n                                \n                                eta_p_85461 = defunc_0_op_res_85463;\n                            }\n                        }\n                        if (sle32(wave_sizze_85422, skip_threads_85467)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_85468) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = eta_p_85461;\n                                eta_p_85462 = eta_p_85461;\n                            }\n                        }\n                        if (sle32(wave_sizze_85422, skip_threads_85467)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                      ", "  }\n                        skip_threads_85467 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_85469 = squot32(local_tid_85420, 32) == 0 || !ltid_in_bounds_85464;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_85469) {\n                        eta_p_85458 = eta_p_85457;\n                        eta_p_85457 = ((__local int64_t *) local_mem_85427)[sext_i32_i64(squot32(local_tid_85420, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_85469) {\n                        int64_t defunc_0_op_res_85459 = add64(eta_p_85457, eta_p_85458);\n                        \n                        eta_p_85457 = defunc_0_op_res_85459;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_85469) {\n                        ((__local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = eta_p_85457;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_85420, 32) == 0 && ltid_in_bounds_85464) {\n                    ((__local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = eta_p_85458;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_85420 == 0) {\n                acc_85460 = ((__local int64_t *) local_mem_85427)[segscan_tblock_sizze_75903 - (int64_t) 1];\n            } else {\n                acc_85460 = ((__local int64_t *) local_mem_85427)[sext_i32_i64(local_tid_85420) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n     ",
                                    "   }\n        prefix_85470 = (int64_t) 0;\n        block_new_sgm_85471 = sgm_idx_85439 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_85471 && local_tid_85420 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_85415)[dynamic_id_85437] = acc_85460;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_85411)[dynamic_id_85437] = (int8_t) 2;\n                acc_85460 = (int64_t) 0;\n            }\n            if (!block_new_sgm_85471 && slt32(local_tid_85420, wave_sizze_85422)) {\n                if (local_tid_85420 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_85413)[dynamic_id_85437] = acc_85460;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_85411)[dynamic_id_85437] = (int8_t) 1;\n                    \n                    int8_t tmp_85472 = ((volatile __global int8_t *) status_flags_mem_85411)[dynamic_id_85437 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_85427)[(int64_t) 0] = tmp_85472;\n                }\n                mem_fence_local();\n                \n                int8_t status_85473 = ((__local int8_t *) local_mem_85427)[(int64_t) 0];\n                \n                if (status_85473 == (int8_t) 2) {\n                    if (local_tid_85420 == 0) {\n                        prefix_85470 = ((volatile __global int64_t *) incprefixes_mem_85415)[dynamic_id_85437 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_85474 = sext_i64_i32(dynamic_id_85437 - sext_i32_i64(wave_sizze_85422));\n                    \n                    while (slt32(wave_sizze_85422 * -1, readOffset_85474)) {\n                        int32_t read_i_85475 = readOffset_85474 + local_tid_85420;\n                        int64_t aggr_85476 = (int64_t) 0;\n                        int8_t flag_85477 = (int8_t) 0;\n            ", "            \n                        if (sle32(0, read_i_85475)) {\n                            flag_85477 = ((volatile __global int8_t *) status_flags_mem_85411)[sext_i32_i64(read_i_85475)];\n                            if (flag_85477 == (int8_t) 2) {\n                                aggr_85476 = ((volatile __global int64_t *) incprefixes_mem_85415)[sext_i32_i64(read_i_85475)];\n                            } else if (flag_85477 == (int8_t) 1) {\n                                aggr_85476 = ((volatile __global int64_t *) aggregates_mem_85413)[sext_i32_i64(read_i_85475)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_85427)[(int64_t) 4 + sext_i32_i64(local_tid_85420)] = aggr_85476;\n                        ((__local int8_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = flag_85477;\n                        flag_85477 = ((__local int8_t *) local_mem_85427)[sext_i32_i64(wave_sizze_85422) - (int64_t) 1];\n                        if (slt8(flag_85477, (int8_t) 2)) {\n                            int8_t flg_x_85481;\n                            int8_t flg_y_85482;\n                            int64_t eta_p_85478;\n                            int64_t eta_p_85479;\n                            int32_t skip_threads_85483;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_85482 = ((volatile __local int8_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)];\n                                eta_p_85479 = ((volatile __local int64_t *) local_mem_85427)[(int64_t) 4 + sext_i32_i64(local_tid_85420)];\n                                if ((local_tid_85420 - squot32(local_tid_85420, 32) * 32) == 0) {\n                                    eta_p_85478 = eta_p_85479;\n                                    flg_x_85481 = flg_y_85482;\n                                }\n                            }\n                            // in-block sca", "n (hopefully no barriers needed)\n                            {\n                                skip_threads_85483 = 1;\n                                while (slt32(skip_threads_85483, 32)) {\n                                    if (sle32(skip_threads_85483, local_tid_85420 - squot32(local_tid_85420, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_85481 = ((volatile __local int8_t *) local_mem_85427)[sext_i32_i64(local_tid_85420) - sext_i32_i64(skip_threads_85483)];\n                                            eta_p_85478 = ((volatile __local int64_t *) local_mem_85427)[(int64_t) 4 + (sext_i32_i64(local_tid_85420) - sext_i32_i64(skip_threads_85483))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_85482 == (int8_t) 2 || flg_y_85482 == (int8_t) 0) {\n                                                flg_x_85481 = flg_y_85482;\n                                                eta_p_85478 = eta_p_85479;\n                                            } else {\n                                                int64_t defunc_0_op_res_85480 = add64(eta_p_85478, eta_p_85479);\n                                                \n                                                eta_p_85478 = defunc_0_op_res_85480;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_85427)[sext_i32_i64(local_tid_85420)] = flg_x_85481;\n                                            flg_y_85482 = flg_x_85481;\n                                            ((volatile __local int64_t *) local_mem_85427)[(int64_t) 4 + sext_i32_i64(local_tid_85420)]",
                                    " = eta_p_85478;\n                                            eta_p_85479 = eta_p_85478;\n                                        }\n                                    }\n                                    skip_threads_85483 *= 2;\n                                }\n                            }\n                        }\n                        flag_85477 = ((__local int8_t *) local_mem_85427)[sext_i32_i64(wave_sizze_85422) - (int64_t) 1];\n                        aggr_85476 = ((__local int64_t *) local_mem_85427)[(int64_t) 4 + (sext_i32_i64(wave_sizze_85422) - (int64_t) 1)];\n                        if (flag_85477 == (int8_t) 2) {\n                            readOffset_85474 = wave_sizze_85422 * -1;\n                        } else if (flag_85477 == (int8_t) 1) {\n                            readOffset_85474 -= wave_sizze_85422;\n                        }\n                        if (slt8((int8_t) 0, flag_85477)) {\n                            int64_t eta_p_85484 = aggr_85476;\n                            int64_t eta_p_85485 = prefix_85470;\n                            int64_t defunc_0_op_res_85486 = add64(eta_p_85484, eta_p_85485);\n                            \n                            prefix_85470 = defunc_0_op_res_85486;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_85420 == 0) {\n                    if (boundary_85440 == sext_i64_i32(segscan_tblock_sizze_75903 * chunk_sizze_85408)) {\n                        int64_t eta_p_85487 = prefix_85470;\n                        int64_t eta_p_85488 = acc_85460;\n                        int64_t defunc_0_op_res_85489 = add64(eta_p_85487, eta_p_85488);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_85415)[dynamic_id_85437] = defunc_0_op_res_85489;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_85411)[dynamic_id_85437] = (int8_t) 2;\n   ", "                 }\n                    ((__local int64_t *) local_mem_85427)[(int64_t) 4] = prefix_85470;\n                    acc_85460 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_85437 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_85470 = ((__local int64_t *) local_mem_85427)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_85490;\n            int64_t eta_p_85491;\n            int64_t eta_p_85493 = prefix_85470;\n            int64_t eta_p_85494 = acc_85460;\n            \n            if (slt32(local_tid_85420 * chunk_sizze_32b_85424, boundary_85440) && !block_new_sgm_85471) {\n                int64_t defunc_0_op_res_85495 = add64(eta_p_85493, eta_p_85494);\n                \n                eta_p_85490 = defunc_0_op_res_85495;\n            } else {\n                eta_p_85490 = acc_85460;\n            }\n            \n            int32_t stopping_point_85496 = segsizze_compact_85441 - srem32(local_tid_85420 * chunk_sizze_32b_85424 - 1 + segsizze_compact_85441 - boundary_85440, segsizze_compact_85441);\n            \n            for (int64_t i_85497 = 0; i_85497 < chunk_sizze_85408; i_85497++) {\n                if (slt32(sext_i64_i32(i_85497), stopping_point_85496 - 1)) {\n                    eta_p_85491 = private_mem_85442[i_85497];\n                    \n                    int64_t defunc_0_op_res_85492 = add64(eta_p_85490, eta_p_85491);\n                    \n                    private_mem_85442[i_85497] = defunc_0_op_res_85492;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_85498 = 0; i_85498 < chunk_sizze_85408; i_85498++) {\n                int64_t sharedIdx_85499 = sext_i32_i64(local_tid_85420) * chunk_sizze_85408 + i_85498;\n                int64_t tmp_85500 = private_mem_85442[i_85498];\n    ", "            \n                ((__local int64_t *) local_mem_85427)[sharedIdx_85499] = tmp_85500;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85501 = 0; i_85501 < chunk_sizze_85408; i_85501++) {\n                int64_t flat_idx_85502 = thd_offset_85444 + i_85501 * segscan_tblock_sizze_75903;\n                int64_t slice_85503 = conc_tmp_62382;\n                int64_t gtid_75907 = flat_idx_85502;\n                int64_t remnant_85504 = flat_idx_85502 - gtid_75907;\n                \n                if (slt64(flat_idx_85502, conc_tmp_62382)) {\n                    int64_t tmp_85505 = ((__local int64_t *) local_mem_85427)[flat_idx_85502 - block_offset_85438];\n                    \n                    ((__global int64_t *) mem_82275)[gtid_75907] = tmp_85505;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_75903\n    #undef chunk_sizze_85408\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_76315_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_76315(__global int *global_failure, int64_t m_62843, int64_t num_tblocks_76311, int64_t num_virt_blocks_85683, int64_t num_virt_threads_85684, __global unsigned char *ext_mem_82407, __global unsigned char *mem_82412, __global unsigned char *status_flags_mem_85685, __global unsigned char *aggregates_mem_85687, __global unsigned char *incprefixes_mem_85689, __global unsigned char *global_dynid_mem_85691)\n{\n    #define segscan_tblock_sizze_76310 (do_DBSCAN_doublezisegscan_76315zisegscan_tblock_sizze_76310)\n    #define chunk_sizze_85682 (do_DBSCAN_doublezisegscan_76315zichunk_sizze_85682)\n    \n    volatile __local unsigned char *local_mem_85701_backing_0 = &shared_mem[0];\n    const int64_t local_mem_85701_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76310), chunk_sizze_85682 * segscan_tblock_sizze_76310 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int",
                                    "64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76310), chunk_sizze_85682 * segscan_tblock_sizze_76310 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85694;\n    int32_t tblock_sizze_85697;\n    int32_t wave_sizze_85696;\n    int32_t block_id_85695;\n    int32_t global_tid_85693;\n    int64_t phys_tid_76315;\n    int32_t chunk_sizze_32b_85698;\n    int64_t byte_offsets_85699;\n    int64_t warp_byte_offset_85700;\n    __local unsigned char *local_mem_85701;\n    int64_t trans_arr_len_85702;\n    int64_t phys_block_id_85708;\n    int64_t virtloop_bound_85709;\n    \n    local_tid_85694 = get_local_id(0);\n    tblock_sizze_85697 = get_local_size(0);\n    wave_sizze_85696 = LOCKSTEP_WIDTH;\n    block_id_85695 = get_tblock_id(0);\n    global_tid_85693 = block_id_85695 * tblock_sizze_85697 + local_tid_85694;\n    phys_tid_76315 = sext_i32_i64(global_tid_85693);\n    chunk_sizze_32b_85698 = sext_i64_i32(chunk_sizze_85682);\n    byte_offsets_85699 = segscan_tblock_sizze_76310 * (int64_t) 8;\n    warp_byte_offset_85700 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_85701 = (__local unsigned char *) local_mem_85701_backing_0;\n    trans_arr_len_85702 = chunk_sizze_85682 * segscan_tblock_sizze_76310;\n    phys_block_id_85708 = get_tblock_id(0);\n    virtloop_bound_85709 = sdiv_up64(num_virt_blocks_85683 - phys_block_id_85708, num_tblocks_76311);\n    for (int64_t virtloop_i_85710 = 0; virtloop_i_85710 < virtloop_bound_85709; virtloop_i_85710++) {\n        int64_t dynamic_id_85711;\n        int64_t block_offset_85712;\n        int64_t sgm_idx_85713;\n        int32_t boundary_85714;\n        int32_t segsizze_compact_85715;\n        int64_t private_mem_85716[chunk_sizze_85682];\n        int64_t thd_offset_85718;\n        int64_t acc_85734;\n        int64_t prefix_85744;\n        bool block_new_sgm_85745;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid", "_85694 == 0) {\n                dynamic_id_85711 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_85691)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_85701)[(int64_t) 0] = dynamic_id_85711;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_85711 == num_virt_blocks_85683 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_85691)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_85711 = ((__local int32_t *) local_mem_85701)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_85712 = dynamic_id_85711 * chunk_sizze_85682 * segscan_tblock_sizze_76310;\n        sgm_idx_85713 = smod64(block_offset_85712, m_62843);\n        boundary_85714 = sext_i64_i32(smin64(chunk_sizze_85682 * segscan_tblock_sizze_76310, m_62843 - sgm_idx_85713));\n        segsizze_compact_85715 = sext_i64_i32(smin64(chunk_sizze_85682 * segscan_tblock_sizze_76310, m_62843));\n        thd_offset_85718 = block_offset_85712 + sext_i32_i64(local_tid_85694);\n        // Load and map\n        {\n            for (int64_t i_85719 = 0; i_85719 < chunk_sizze_85682; i_85719++) {\n                int64_t virt_tid_85720 = thd_offset_85718 + i_85719 * segscan_tblock_sizze_76310;\n                int64_t slice_85721 = m_62843;\n                int64_t gtid_76314 = virt_tid_85720;\n                int64_t remnant_85722 = virt_tid_85720 - gtid_76314;\n                \n                if (slt64(virt_tid_85720, m_62843)) {\n                    int64_t x_76319 = ((__global int64_t *) ext_mem_82407)[gtid_76314];\n                    \n                    private_mem_85716[i_85719] = x_76319;\n                } else {\n                    private_mem_85716[i_85719] = (int64_t) 0;\n             ", "   }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_85723 = 0; i_85723 < chunk_sizze_85682; i_85723++) {\n                int64_t sharedIdx_85724 = sext_i32_i64(local_tid_85694) + i_85723 * segscan_tblock_sizze_76310;\n                int64_t tmp_85725 = private_mem_85716[i_85723];\n                \n                ((__local int64_t *) local_mem_85701)[sharedIdx_85724] = tmp_85725;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85726 = 0; i_85726 < chunk_sizze_85682; i_85726++) {\n                int64_t sharedIdx_85727 = sext_i32_i64(local_tid_85694) * chunk_sizze_85682 + i_85726;\n                int64_t tmp_85728 = ((__local int64_t *) local_mem_85701)[sharedIdx_85727];\n                \n                private_mem_85716[i_85726] = tmp_85728;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_85729 = 0; i_85729 < chunk_sizze_85682 - (int64_t) 1; i_85729++) {\n                int64_t eta_p_76316;\n                int64_t eta_p_76317;\n                \n                eta_p_76316 = private_mem_85716[i_85729];\n                eta_p_76317 = private_mem_85716[i_85729 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_76318 = add64(eta_p_76316, eta_p_76317);\n                \n                private_mem_85716[i_85729 + (int64_t) 1] = defunc_0_op_res_76318;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_85730 = private_mem_85716[chunk_sizze_85682 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = tmp_85730;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_85731;\n            int64_t eta_p_85732;\n            int64_t eta_p_85735;\n            int64_t eta_p_85736;\n          ",
                                    "  bool ltid_in_bounds_85738 = slt64(sext_i32_i64(local_tid_85694), num_virt_threads_85684);\n            int32_t skip_threads_85739;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_85738) {\n                    eta_p_85732 = ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)];\n                    if ((local_tid_85694 - squot32(local_tid_85694, 32) * 32) == 0) {\n                        eta_p_85731 = eta_p_85732;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_85739 = 1;\n                while (slt32(skip_threads_85739, 32)) {\n                    bool thread_active_85740 = sle32(skip_threads_85739, local_tid_85694 - squot32(local_tid_85694, 32) * 32) && ltid_in_bounds_85738;\n                    \n                    if (thread_active_85740) {\n                        // read operands\n                        {\n                            eta_p_85731 = ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694) - sext_i32_i64(skip_threads_85739)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_85740) {\n                            int64_t defunc_0_op_res_85733 = add64(eta_p_85731, eta_p_85732);\n                            \n                            eta_p_85731 = defunc_0_op_res_85733;\n                        }\n                    }\n                    if (sle32(wave_sizze_85696, skip_threads_85739)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_85740) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = eta_p_85731;\n                            eta_p_85732 = eta_p_85731;\n    ", "                    }\n                    }\n                    if (sle32(wave_sizze_85696, skip_threads_85739)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_85739 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_85694 - squot32(local_tid_85694, 32) * 32) == 31 && ltid_in_bounds_85738) {\n                    ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(squot32(local_tid_85694, 32))] = eta_p_85731;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_85741;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_85694, 32) == 0 && ltid_in_bounds_85738) {\n                        eta_p_85736 = ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)];\n                        if ((local_tid_85694 - squot32(local_tid_85694, 32) * 32) == 0) {\n                            eta_p_85735 = eta_p_85736;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_85741 = 1;\n                    while (slt32(skip_threads_85741, 32)) {\n                        bool thread_active_85742 = sle32(skip_threads_85741, local_tid_85694 - squot32(local_tid_85694, 32) * 32) && (squot32(local_tid_85694, 32) == 0 && ltid_in_bounds_85738);\n                        \n                        if (thread_active_85742) {\n                            // read operands\n                            {\n                                eta_p_85735 = ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85", "694) - sext_i32_i64(skip_threads_85741)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_85742) {\n                                int64_t defunc_0_op_res_85737 = add64(eta_p_85735, eta_p_85736);\n                                \n                                eta_p_85735 = defunc_0_op_res_85737;\n                            }\n                        }\n                        if (sle32(wave_sizze_85696, skip_threads_85741)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_85742) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = eta_p_85735;\n                                eta_p_85736 = eta_p_85735;\n                            }\n                        }\n                        if (sle32(wave_sizze_85696, skip_threads_85741)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_85741 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_85743 = squot32(local_tid_85694, 32) == 0 || !ltid_in_bounds_85738;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_85743) {\n                        eta_p_85732 = eta_p_85731;\n                        eta_p_85731 = ((__local int64_t *) local_mem_85701)[sext_i32_i64(squot32(local_tid_85694, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_85743) {\n                        int64_t defunc_0_op_res_85733 = add64(eta_p_85731, ",
                                    "eta_p_85732);\n                        \n                        eta_p_85731 = defunc_0_op_res_85733;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_85743) {\n                        ((__local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = eta_p_85731;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_85694, 32) == 0 && ltid_in_bounds_85738) {\n                    ((__local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = eta_p_85732;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_85694 == 0) {\n                acc_85734 = ((__local int64_t *) local_mem_85701)[segscan_tblock_sizze_76310 - (int64_t) 1];\n            } else {\n                acc_85734 = ((__local int64_t *) local_mem_85701)[sext_i32_i64(local_tid_85694) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_85744 = (int64_t) 0;\n        block_new_sgm_85745 = sgm_idx_85713 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_85745 && local_tid_85694 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_85689)[dynamic_id_85711] = acc_85734;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_85685)[dynamic_id_85711] = (int8_t) 2;\n                acc_85734 = (int64_t) 0;\n            }\n            if (!block_new_sgm_85745 && slt32(local_tid_85694, wave_sizze_85696)) {\n                if (local_tid_85694 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_85687)[dynamic_id_85711] = acc_85734;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_85685)[", "dynamic_id_85711] = (int8_t) 1;\n                    \n                    int8_t tmp_85746 = ((volatile __global int8_t *) status_flags_mem_85685)[dynamic_id_85711 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_85701)[(int64_t) 0] = tmp_85746;\n                }\n                mem_fence_local();\n                \n                int8_t status_85747 = ((__local int8_t *) local_mem_85701)[(int64_t) 0];\n                \n                if (status_85747 == (int8_t) 2) {\n                    if (local_tid_85694 == 0) {\n                        prefix_85744 = ((volatile __global int64_t *) incprefixes_mem_85689)[dynamic_id_85711 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_85748 = sext_i64_i32(dynamic_id_85711 - sext_i32_i64(wave_sizze_85696));\n                    \n                    while (slt32(wave_sizze_85696 * -1, readOffset_85748)) {\n                        int32_t read_i_85749 = readOffset_85748 + local_tid_85694;\n                        int64_t aggr_85750 = (int64_t) 0;\n                        int8_t flag_85751 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_85749)) {\n                            flag_85751 = ((volatile __global int8_t *) status_flags_mem_85685)[sext_i32_i64(read_i_85749)];\n                            if (flag_85751 == (int8_t) 2) {\n                                aggr_85750 = ((volatile __global int64_t *) incprefixes_mem_85689)[sext_i32_i64(read_i_85749)];\n                            } else if (flag_85751 == (int8_t) 1) {\n                                aggr_85750 = ((volatile __global int64_t *) aggregates_mem_85687)[sext_i32_i64(read_i_85749)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_85701)[(int64_t) 4 + sext_i32_i64(local_tid_85694)] = aggr_85750;\n                        ((__local int8_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] ", "= flag_85751;\n                        flag_85751 = ((__local int8_t *) local_mem_85701)[sext_i32_i64(wave_sizze_85696) - (int64_t) 1];\n                        if (slt8(flag_85751, (int8_t) 2)) {\n                            int8_t flg_x_85755;\n                            int8_t flg_y_85756;\n                            int64_t eta_p_85752;\n                            int64_t eta_p_85753;\n                            int32_t skip_threads_85757;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_85756 = ((volatile __local int8_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)];\n                                eta_p_85753 = ((volatile __local int64_t *) local_mem_85701)[(int64_t) 4 + sext_i32_i64(local_tid_85694)];\n                                if ((local_tid_85694 - squot32(local_tid_85694, 32) * 32) == 0) {\n                                    eta_p_85752 = eta_p_85753;\n                                    flg_x_85755 = flg_y_85756;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_85757 = 1;\n                                while (slt32(skip_threads_85757, 32)) {\n                                    if (sle32(skip_threads_85757, local_tid_85694 - squot32(local_tid_85694, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_85755 = ((volatile __local int8_t *) local_mem_85701)[sext_i32_i64(local_tid_85694) - sext_i32_i64(skip_threads_85757)];\n                                            eta_p_85752 = ((volatile __local int64_t *) local_mem_85701)[(int64_t) 4 + (sext_i32_i64(local_tid_85694) - sext_i32_i64(skip_threads_85757))];\n                                        }\n                             ",
                                    "           // perform operation\n                                        {\n                                            if (flg_y_85756 == (int8_t) 2 || flg_y_85756 == (int8_t) 0) {\n                                                flg_x_85755 = flg_y_85756;\n                                                eta_p_85752 = eta_p_85753;\n                                            } else {\n                                                int64_t defunc_0_op_res_85754 = add64(eta_p_85752, eta_p_85753);\n                                                \n                                                eta_p_85752 = defunc_0_op_res_85754;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_85701)[sext_i32_i64(local_tid_85694)] = flg_x_85755;\n                                            flg_y_85756 = flg_x_85755;\n                                            ((volatile __local int64_t *) local_mem_85701)[(int64_t) 4 + sext_i32_i64(local_tid_85694)] = eta_p_85752;\n                                            eta_p_85753 = eta_p_85752;\n                                        }\n                                    }\n                                    skip_threads_85757 *= 2;\n                                }\n                            }\n                        }\n                        flag_85751 = ((__local int8_t *) local_mem_85701)[sext_i32_i64(wave_sizze_85696) - (int64_t) 1];\n                        aggr_85750 = ((__local int64_t *) local_mem_85701)[(int64_t) 4 + (sext_i32_i64(wave_sizze_85696) - (int64_t) 1)];\n                        if (flag_85751 == (int8_t) 2) {\n                            readOffset_85748 = wave_sizze_85696 * -1;\n                        } else if (flag_85751 == (int8_t) 1) {\n                            readOffset_85748 -= wave_sizze_85696;\n          ", "              }\n                        if (slt8((int8_t) 0, flag_85751)) {\n                            int64_t eta_p_85758 = aggr_85750;\n                            int64_t eta_p_85759 = prefix_85744;\n                            int64_t defunc_0_op_res_85760 = add64(eta_p_85758, eta_p_85759);\n                            \n                            prefix_85744 = defunc_0_op_res_85760;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_85694 == 0) {\n                    if (boundary_85714 == sext_i64_i32(segscan_tblock_sizze_76310 * chunk_sizze_85682)) {\n                        int64_t eta_p_85761 = prefix_85744;\n                        int64_t eta_p_85762 = acc_85734;\n                        int64_t defunc_0_op_res_85763 = add64(eta_p_85761, eta_p_85762);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_85689)[dynamic_id_85711] = defunc_0_op_res_85763;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_85685)[dynamic_id_85711] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_85701)[(int64_t) 4] = prefix_85744;\n                    acc_85734 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_85711 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_85744 = ((__local int64_t *) local_mem_85701)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_85764;\n            int64_t eta_p_85765;\n            int64_t eta_p_85767 = prefix_85744;\n            int64_t eta_p_85768 = acc_85734;\n            \n            if (slt32(local_tid_85694 * chunk_sizze_32b_85698, boundary_85714) && !block_new_sgm_85745) {\n                int64_t defunc_0_op_res_85769 = add64(eta_p_85767, eta_p_85768);\n       ", "         \n                eta_p_85764 = defunc_0_op_res_85769;\n            } else {\n                eta_p_85764 = acc_85734;\n            }\n            \n            int32_t stopping_point_85770 = segsizze_compact_85715 - srem32(local_tid_85694 * chunk_sizze_32b_85698 - 1 + segsizze_compact_85715 - boundary_85714, segsizze_compact_85715);\n            \n            for (int64_t i_85771 = 0; i_85771 < chunk_sizze_85682; i_85771++) {\n                if (slt32(sext_i64_i32(i_85771), stopping_point_85770 - 1)) {\n                    eta_p_85765 = private_mem_85716[i_85771];\n                    \n                    int64_t defunc_0_op_res_85766 = add64(eta_p_85764, eta_p_85765);\n                    \n                    private_mem_85716[i_85771] = defunc_0_op_res_85766;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_85772 = 0; i_85772 < chunk_sizze_85682; i_85772++) {\n                int64_t sharedIdx_85773 = sext_i32_i64(local_tid_85694) * chunk_sizze_85682 + i_85772;\n                int64_t tmp_85774 = private_mem_85716[i_85772];\n                \n                ((__local int64_t *) local_mem_85701)[sharedIdx_85773] = tmp_85774;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85775 = 0; i_85775 < chunk_sizze_85682; i_85775++) {\n                int64_t flat_idx_85776 = thd_offset_85718 + i_85775 * segscan_tblock_sizze_76310;\n                int64_t slice_85777 = m_62843;\n                int64_t gtid_76314 = flat_idx_85776;\n                int64_t remnant_85778 = flat_idx_85776 - gtid_76314;\n                \n                if (slt64(flat_idx_85776, m_62843)) {\n                    int64_t tmp_85779 = ((__local int64_t *) local_mem_85701)[flat_idx_85776 - block_offset_85712];\n                    \n                    ((__global int64_t *) mem_82412)[gtid_76314] = tmp_85779;\n                }\n            }\n            barrier(CLK_",
                                    "LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_76310\n    #undef chunk_sizze_85682\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_76628_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_76628(__global int *global_failure, int64_t conc_tmp_62382, int64_t num_tblocks_76624, int64_t num_virt_blocks_85950, int64_t num_virt_threads_85951, __global unsigned char *ext_mem_82526, __global unsigned char *mem_82531, __global unsigned char *status_flags_mem_85952, __global unsigned char *aggregates_mem_85954, __global unsigned char *incprefixes_mem_85956, __global unsigned char *global_dynid_mem_85958)\n{\n    #define segscan_tblock_sizze_76623 (do_DBSCAN_doublezisegscan_76628zisegscan_tblock_sizze_76623)\n    #define chunk_sizze_85949 (do_DBSCAN_doublezisegscan_76628zichunk_sizze_85949)\n    \n    volatile __local unsigned char *local_mem_85968_backing_0 = &shared_mem[0];\n    const int64_t local_mem_85968_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76623), chunk_sizze_85949 * segscan_tblock_sizze_76623 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76623), chunk_sizze_85949 * segscan_tblock_sizze_76623 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_85961;\n    int32_t tblock_sizze_85964;\n    int32_t wave_sizze_85963;\n    int32_t block_id_85962;\n    int32_t global_tid_85960;\n    int64_t phys_tid_76628;\n    int32_t chunk_sizze_32b_85965;\n    int64_t byte_offsets_85966;\n    int64_t warp_byte_offset_85967;\n    __local unsigned char *local_mem_85968;\n    int64_t trans_arr_len_85969;\n    int64_t phys_block_id_85975;\n    int64_t virtloop_bound_85976;\n    \n    local_tid_85961 = get_local_id(0);\n    tblock_sizze_85964 = get_local_size(0);\n    wave_sizze_85963 = LOCKSTEP_WIDTH;\n    block_id_85962 = get_tblock_id(0);\n    global_tid_85960 = block_id_85962 * tblock_sizze_8596", "4 + local_tid_85961;\n    phys_tid_76628 = sext_i32_i64(global_tid_85960);\n    chunk_sizze_32b_85965 = sext_i64_i32(chunk_sizze_85949);\n    byte_offsets_85966 = segscan_tblock_sizze_76623 * (int64_t) 8;\n    warp_byte_offset_85967 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_85968 = (__local unsigned char *) local_mem_85968_backing_0;\n    trans_arr_len_85969 = chunk_sizze_85949 * segscan_tblock_sizze_76623;\n    phys_block_id_85975 = get_tblock_id(0);\n    virtloop_bound_85976 = sdiv_up64(num_virt_blocks_85950 - phys_block_id_85975, num_tblocks_76624);\n    for (int64_t virtloop_i_85977 = 0; virtloop_i_85977 < virtloop_bound_85976; virtloop_i_85977++) {\n        int64_t dynamic_id_85978;\n        int64_t block_offset_85979;\n        int64_t sgm_idx_85980;\n        int32_t boundary_85981;\n        int32_t segsizze_compact_85982;\n        int64_t private_mem_85983[chunk_sizze_85949];\n        int64_t thd_offset_85985;\n        int64_t acc_86001;\n        int64_t prefix_86011;\n        bool block_new_sgm_86012;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_85961 == 0) {\n                dynamic_id_85978 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_85958)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_85968)[(int64_t) 0] = dynamic_id_85978;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_85978 == num_virt_blocks_85950 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_85958)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_85978 = ((__local int32_t *) local_mem_85968)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_85979 = dynamic", "_id_85978 * chunk_sizze_85949 * segscan_tblock_sizze_76623;\n        sgm_idx_85980 = smod64(block_offset_85979, conc_tmp_62382);\n        boundary_85981 = sext_i64_i32(smin64(chunk_sizze_85949 * segscan_tblock_sizze_76623, conc_tmp_62382 - sgm_idx_85980));\n        segsizze_compact_85982 = sext_i64_i32(smin64(chunk_sizze_85949 * segscan_tblock_sizze_76623, conc_tmp_62382));\n        thd_offset_85985 = block_offset_85979 + sext_i32_i64(local_tid_85961);\n        // Load and map\n        {\n            for (int64_t i_85986 = 0; i_85986 < chunk_sizze_85949; i_85986++) {\n                int64_t virt_tid_85987 = thd_offset_85985 + i_85986 * segscan_tblock_sizze_76623;\n                int64_t slice_85988 = conc_tmp_62382;\n                int64_t gtid_76627 = virt_tid_85987;\n                int64_t remnant_85989 = virt_tid_85987 - gtid_76627;\n                \n                if (slt64(virt_tid_85987, conc_tmp_62382)) {\n                    int64_t x_76632 = ((__global int64_t *) ext_mem_82526)[gtid_76627];\n                    \n                    private_mem_85983[i_85986] = x_76632;\n                } else {\n                    private_mem_85983[i_85986] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_85990 = 0; i_85990 < chunk_sizze_85949; i_85990++) {\n                int64_t sharedIdx_85991 = sext_i32_i64(local_tid_85961) + i_85990 * segscan_tblock_sizze_76623;\n                int64_t tmp_85992 = private_mem_85983[i_85990];\n                \n                ((__local int64_t *) local_mem_85968)[sharedIdx_85991] = tmp_85992;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_85993 = 0; i_85993 < chunk_sizze_85949; i_85993++) {\n                int64_t sharedIdx_85994 = sext_i32_i64(local_tid_85961) * chunk_sizze_85949 + i_85993;\n                int64_t tmp_85995 = ((__local int64_t *) local_mem_85968)[sharedIdx_85994];\n                ",
                                    "\n                private_mem_85983[i_85993] = tmp_85995;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_85996 = 0; i_85996 < chunk_sizze_85949 - (int64_t) 1; i_85996++) {\n                int64_t eta_p_76629;\n                int64_t eta_p_76630;\n                \n                eta_p_76629 = private_mem_85983[i_85996];\n                eta_p_76630 = private_mem_85983[i_85996 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_76631 = add64(eta_p_76629, eta_p_76630);\n                \n                private_mem_85983[i_85996 + (int64_t) 1] = defunc_0_op_res_76631;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_85997 = private_mem_85983[chunk_sizze_85949 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = tmp_85997;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_85998;\n            int64_t eta_p_85999;\n            int64_t eta_p_86002;\n            int64_t eta_p_86003;\n            bool ltid_in_bounds_86005 = slt64(sext_i32_i64(local_tid_85961), num_virt_threads_85951);\n            int32_t skip_threads_86006;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_86005) {\n                    eta_p_85999 = ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)];\n                    if ((local_tid_85961 - squot32(local_tid_85961, 32) * 32) == 0) {\n                        eta_p_85998 = eta_p_85999;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_86006 = 1;\n                while (slt32(skip_threads_86006, 32)) {\n                    bool thread_active_86007 = sle32(skip_threads_86006, local_tid_85961 - sq", "uot32(local_tid_85961, 32) * 32) && ltid_in_bounds_86005;\n                    \n                    if (thread_active_86007) {\n                        // read operands\n                        {\n                            eta_p_85998 = ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961) - sext_i32_i64(skip_threads_86006)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_86007) {\n                            int64_t defunc_0_op_res_86000 = add64(eta_p_85998, eta_p_85999);\n                            \n                            eta_p_85998 = defunc_0_op_res_86000;\n                        }\n                    }\n                    if (sle32(wave_sizze_85963, skip_threads_86006)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_86007) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = eta_p_85998;\n                            eta_p_85999 = eta_p_85998;\n                        }\n                    }\n                    if (sle32(wave_sizze_85963, skip_threads_86006)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_86006 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_85961 - squot32(local_tid_85961, 32) * 32) == 31 && ltid_in_bounds_86005) {\n                    ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(squot32(local_tid_85961, 32))] = eta_p_85998;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n   ", "             int32_t skip_threads_86008;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_85961, 32) == 0 && ltid_in_bounds_86005) {\n                        eta_p_86003 = ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)];\n                        if ((local_tid_85961 - squot32(local_tid_85961, 32) * 32) == 0) {\n                            eta_p_86002 = eta_p_86003;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_86008 = 1;\n                    while (slt32(skip_threads_86008, 32)) {\n                        bool thread_active_86009 = sle32(skip_threads_86008, local_tid_85961 - squot32(local_tid_85961, 32) * 32) && (squot32(local_tid_85961, 32) == 0 && ltid_in_bounds_86005);\n                        \n                        if (thread_active_86009) {\n                            // read operands\n                            {\n                                eta_p_86002 = ((volatile __local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961) - sext_i32_i64(skip_threads_86008)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_86009) {\n                                int64_t defunc_0_op_res_86004 = add64(eta_p_86002, eta_p_86003);\n                                \n                                eta_p_86002 = defunc_0_op_res_86004;\n                            }\n                        }\n                        if (sle32(wave_sizze_85963, skip_threads_86008)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_86009) {\n                            // write result\n                            {\n                                ((volatile __local ",
                                    "int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = eta_p_86002;\n                                eta_p_86003 = eta_p_86002;\n                            }\n                        }\n                        if (sle32(wave_sizze_85963, skip_threads_86008)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_86008 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_86010 = squot32(local_tid_85961, 32) == 0 || !ltid_in_bounds_86005;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_86010) {\n                        eta_p_85999 = eta_p_85998;\n                        eta_p_85998 = ((__local int64_t *) local_mem_85968)[sext_i32_i64(squot32(local_tid_85961, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_86010) {\n                        int64_t defunc_0_op_res_86000 = add64(eta_p_85998, eta_p_85999);\n                        \n                        eta_p_85998 = defunc_0_op_res_86000;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_86010) {\n                        ((__local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = eta_p_85998;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_85961, 32) == 0 && ltid_in_bounds_86005) {\n                    ((__local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = eta_p_85999;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);", "\n            if (local_tid_85961 == 0) {\n                acc_86001 = ((__local int64_t *) local_mem_85968)[segscan_tblock_sizze_76623 - (int64_t) 1];\n            } else {\n                acc_86001 = ((__local int64_t *) local_mem_85968)[sext_i32_i64(local_tid_85961) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_86011 = (int64_t) 0;\n        block_new_sgm_86012 = sgm_idx_85980 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_86012 && local_tid_85961 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_85956)[dynamic_id_85978] = acc_86001;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_85952)[dynamic_id_85978] = (int8_t) 2;\n                acc_86001 = (int64_t) 0;\n            }\n            if (!block_new_sgm_86012 && slt32(local_tid_85961, wave_sizze_85963)) {\n                if (local_tid_85961 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_85954)[dynamic_id_85978] = acc_86001;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_85952)[dynamic_id_85978] = (int8_t) 1;\n                    \n                    int8_t tmp_86013 = ((volatile __global int8_t *) status_flags_mem_85952)[dynamic_id_85978 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_85968)[(int64_t) 0] = tmp_86013;\n                }\n                mem_fence_local();\n                \n                int8_t status_86014 = ((__local int8_t *) local_mem_85968)[(int64_t) 0];\n                \n                if (status_86014 == (int8_t) 2) {\n                    if (local_tid_85961 == 0) {\n                        prefix_86011 = ((volatile __global int64_t *) incprefixes_mem_85956)[dynamic_id_85978 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_86015 = sext_i64_i32(dynamic_id_8597", "8 - sext_i32_i64(wave_sizze_85963));\n                    \n                    while (slt32(wave_sizze_85963 * -1, readOffset_86015)) {\n                        int32_t read_i_86016 = readOffset_86015 + local_tid_85961;\n                        int64_t aggr_86017 = (int64_t) 0;\n                        int8_t flag_86018 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_86016)) {\n                            flag_86018 = ((volatile __global int8_t *) status_flags_mem_85952)[sext_i32_i64(read_i_86016)];\n                            if (flag_86018 == (int8_t) 2) {\n                                aggr_86017 = ((volatile __global int64_t *) incprefixes_mem_85956)[sext_i32_i64(read_i_86016)];\n                            } else if (flag_86018 == (int8_t) 1) {\n                                aggr_86017 = ((volatile __global int64_t *) aggregates_mem_85954)[sext_i32_i64(read_i_86016)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_85968)[(int64_t) 4 + sext_i32_i64(local_tid_85961)] = aggr_86017;\n                        ((__local int8_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = flag_86018;\n                        flag_86018 = ((__local int8_t *) local_mem_85968)[sext_i32_i64(wave_sizze_85963) - (int64_t) 1];\n                        if (slt8(flag_86018, (int8_t) 2)) {\n                            int8_t flg_x_86022;\n                            int8_t flg_y_86023;\n                            int64_t eta_p_86019;\n                            int64_t eta_p_86020;\n                            int32_t skip_threads_86024;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_86023 = ((volatile __local int8_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)];\n                                eta_p_86020 = ((volatile __local int64_t *) local_mem_85968)[(int64_t) 4 + sext_i32_i64(local_",
                                    "tid_85961)];\n                                if ((local_tid_85961 - squot32(local_tid_85961, 32) * 32) == 0) {\n                                    eta_p_86019 = eta_p_86020;\n                                    flg_x_86022 = flg_y_86023;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_86024 = 1;\n                                while (slt32(skip_threads_86024, 32)) {\n                                    if (sle32(skip_threads_86024, local_tid_85961 - squot32(local_tid_85961, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_86022 = ((volatile __local int8_t *) local_mem_85968)[sext_i32_i64(local_tid_85961) - sext_i32_i64(skip_threads_86024)];\n                                            eta_p_86019 = ((volatile __local int64_t *) local_mem_85968)[(int64_t) 4 + (sext_i32_i64(local_tid_85961) - sext_i32_i64(skip_threads_86024))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_86023 == (int8_t) 2 || flg_y_86023 == (int8_t) 0) {\n                                                flg_x_86022 = flg_y_86023;\n                                                eta_p_86019 = eta_p_86020;\n                                            } else {\n                                                int64_t defunc_0_op_res_86021 = add64(eta_p_86019, eta_p_86020);\n                                                \n                                                eta_p_86019 = defunc_0_op_res_86021;\n                                            }\n                                        }\n                                        // write result\n                                        ", "{\n                                            ((volatile __local int8_t *) local_mem_85968)[sext_i32_i64(local_tid_85961)] = flg_x_86022;\n                                            flg_y_86023 = flg_x_86022;\n                                            ((volatile __local int64_t *) local_mem_85968)[(int64_t) 4 + sext_i32_i64(local_tid_85961)] = eta_p_86019;\n                                            eta_p_86020 = eta_p_86019;\n                                        }\n                                    }\n                                    skip_threads_86024 *= 2;\n                                }\n                            }\n                        }\n                        flag_86018 = ((__local int8_t *) local_mem_85968)[sext_i32_i64(wave_sizze_85963) - (int64_t) 1];\n                        aggr_86017 = ((__local int64_t *) local_mem_85968)[(int64_t) 4 + (sext_i32_i64(wave_sizze_85963) - (int64_t) 1)];\n                        if (flag_86018 == (int8_t) 2) {\n                            readOffset_86015 = wave_sizze_85963 * -1;\n                        } else if (flag_86018 == (int8_t) 1) {\n                            readOffset_86015 -= wave_sizze_85963;\n                        }\n                        if (slt8((int8_t) 0, flag_86018)) {\n                            int64_t eta_p_86025 = aggr_86017;\n                            int64_t eta_p_86026 = prefix_86011;\n                            int64_t defunc_0_op_res_86027 = add64(eta_p_86025, eta_p_86026);\n                            \n                            prefix_86011 = defunc_0_op_res_86027;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_85961 == 0) {\n                    if (boundary_85981 == sext_i64_i32(segscan_tblock_sizze_76623 * chunk_sizze_85949)) {\n                        int64_t eta_p_86028 = prefix_86011;\n                        int64_t eta_p_86029 = acc_86001;\n                        int64_t defunc_0_op_res_", "86030 = add64(eta_p_86028, eta_p_86029);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_85956)[dynamic_id_85978] = defunc_0_op_res_86030;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_85952)[dynamic_id_85978] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_85968)[(int64_t) 4] = prefix_86011;\n                    acc_86001 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_85978 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_86011 = ((__local int64_t *) local_mem_85968)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_86031;\n            int64_t eta_p_86032;\n            int64_t eta_p_86034 = prefix_86011;\n            int64_t eta_p_86035 = acc_86001;\n            \n            if (slt32(local_tid_85961 * chunk_sizze_32b_85965, boundary_85981) && !block_new_sgm_86012) {\n                int64_t defunc_0_op_res_86036 = add64(eta_p_86034, eta_p_86035);\n                \n                eta_p_86031 = defunc_0_op_res_86036;\n            } else {\n                eta_p_86031 = acc_86001;\n            }\n            \n            int32_t stopping_point_86037 = segsizze_compact_85982 - srem32(local_tid_85961 * chunk_sizze_32b_85965 - 1 + segsizze_compact_85982 - boundary_85981, segsizze_compact_85982);\n            \n            for (int64_t i_86038 = 0; i_86038 < chunk_sizze_85949; i_86038++) {\n                if (slt32(sext_i64_i32(i_86038), stopping_point_86037 - 1)) {\n                    eta_p_86032 = private_mem_85983[i_86038];\n                    \n                    int64_t defunc_0_op_res_86033 = add64(eta_p_86031, eta_p_86032);\n                    \n                    private_mem_85983[i_86038] = defunc_0_op_res_86033;\n                }\n            }\n        }\n ",
                                    "       // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_86039 = 0; i_86039 < chunk_sizze_85949; i_86039++) {\n                int64_t sharedIdx_86040 = sext_i32_i64(local_tid_85961) * chunk_sizze_85949 + i_86039;\n                int64_t tmp_86041 = private_mem_85983[i_86039];\n                \n                ((__local int64_t *) local_mem_85968)[sharedIdx_86040] = tmp_86041;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_86042 = 0; i_86042 < chunk_sizze_85949; i_86042++) {\n                int64_t flat_idx_86043 = thd_offset_85985 + i_86042 * segscan_tblock_sizze_76623;\n                int64_t slice_86044 = conc_tmp_62382;\n                int64_t gtid_76627 = flat_idx_86043;\n                int64_t remnant_86045 = flat_idx_86043 - gtid_76627;\n                \n                if (slt64(flat_idx_86043, conc_tmp_62382)) {\n                    int64_t tmp_86046 = ((__local int64_t *) local_mem_85968)[flat_idx_86043 - block_offset_85979];\n                    \n                    ((__global int64_t *) mem_82531)[gtid_76627] = tmp_86046;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_76623\n    #undef chunk_sizze_85949\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_77081_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_77081(__global int *global_failure, int64_t m_63000, int64_t num_tblocks_77077, int64_t num_virt_blocks_86224, int64_t num_virt_threads_86225, __global unsigned char *ext_mem_82691, __global unsigned char *mem_82696, __global unsigned char *status_flags_mem_86226, __global unsigned char *aggregates_mem_86228, __global unsigned char *incprefixes_mem_86230, __global unsigned char *global_dynid_mem_86232)\n{\n    #define segscan_tblock_sizze_77076 (do_DBSCAN_doublezisegscan_77081zisegscan_tblock_sizze_77076)\n    #define chunk_sizze_86223 (do_DBSCAN_doublezisegscan_77081zi", "chunk_sizze_86223)\n    \n    volatile __local unsigned char *local_mem_86242_backing_0 = &shared_mem[0];\n    const int64_t local_mem_86242_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77076), chunk_sizze_86223 * segscan_tblock_sizze_77076 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77076), chunk_sizze_86223 * segscan_tblock_sizze_77076 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_86235;\n    int32_t tblock_sizze_86238;\n    int32_t wave_sizze_86237;\n    int32_t block_id_86236;\n    int32_t global_tid_86234;\n    int64_t phys_tid_77081;\n    int32_t chunk_sizze_32b_86239;\n    int64_t byte_offsets_86240;\n    int64_t warp_byte_offset_86241;\n    __local unsigned char *local_mem_86242;\n    int64_t trans_arr_len_86243;\n    int64_t phys_block_id_86249;\n    int64_t virtloop_bound_86250;\n    \n    local_tid_86235 = get_local_id(0);\n    tblock_sizze_86238 = get_local_size(0);\n    wave_sizze_86237 = LOCKSTEP_WIDTH;\n    block_id_86236 = get_tblock_id(0);\n    global_tid_86234 = block_id_86236 * tblock_sizze_86238 + local_tid_86235;\n    phys_tid_77081 = sext_i32_i64(global_tid_86234);\n    chunk_sizze_32b_86239 = sext_i64_i32(chunk_sizze_86223);\n    byte_offsets_86240 = segscan_tblock_sizze_77076 * (int64_t) 8;\n    warp_byte_offset_86241 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_86242 = (__local unsigned char *) local_mem_86242_backing_0;\n    trans_arr_len_86243 = chunk_sizze_86223 * segscan_tblock_sizze_77076;\n    phys_block_id_86249 = get_tblock_id(0);\n    virtloop_bound_86250 = sdiv_up64(num_virt_blocks_86224 - phys_block_id_86249, num_tblocks_77077);\n    for (int64_t virtloop_i_86251 = 0; virtloop_i_86251 < virtloop_bound_86250; virtloop_i_86251++) {\n        int64_t dynamic_id_86252;\n        int64_t block_offset_86253;\n        int64_t sgm_idx_86254;\n        int32_t ", "boundary_86255;\n        int32_t segsizze_compact_86256;\n        int64_t private_mem_86257[chunk_sizze_86223];\n        int64_t thd_offset_86259;\n        int64_t acc_86275;\n        int64_t prefix_86285;\n        bool block_new_sgm_86286;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_86235 == 0) {\n                dynamic_id_86252 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_86232)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_86242)[(int64_t) 0] = dynamic_id_86252;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_86252 == num_virt_blocks_86224 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_86232)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_86252 = ((__local int32_t *) local_mem_86242)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_86253 = dynamic_id_86252 * chunk_sizze_86223 * segscan_tblock_sizze_77076;\n        sgm_idx_86254 = smod64(block_offset_86253, m_63000);\n        boundary_86255 = sext_i64_i32(smin64(chunk_sizze_86223 * segscan_tblock_sizze_77076, m_63000 - sgm_idx_86254));\n        segsizze_compact_86256 = sext_i64_i32(smin64(chunk_sizze_86223 * segscan_tblock_sizze_77076, m_63000));\n        thd_offset_86259 = block_offset_86253 + sext_i32_i64(local_tid_86235);\n        // Load and map\n        {\n            for (int64_t i_86260 = 0; i_86260 < chunk_sizze_86223; i_86260++) {\n                int64_t virt_tid_86261 = thd_offset_86259 + i_86260 * segscan_tblock_sizze_77076;\n                int64_t slice_86262 = m_63000;\n                int64_t gtid_77080 = virt_tid_86261;\n                int64_t remnant_86263 = virt_tid_86261 - gtid_7",
                                    "7080;\n                \n                if (slt64(virt_tid_86261, m_63000)) {\n                    int64_t x_77085 = ((__global int64_t *) ext_mem_82691)[gtid_77080];\n                    \n                    private_mem_86257[i_86260] = x_77085;\n                } else {\n                    private_mem_86257[i_86260] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_86264 = 0; i_86264 < chunk_sizze_86223; i_86264++) {\n                int64_t sharedIdx_86265 = sext_i32_i64(local_tid_86235) + i_86264 * segscan_tblock_sizze_77076;\n                int64_t tmp_86266 = private_mem_86257[i_86264];\n                \n                ((__local int64_t *) local_mem_86242)[sharedIdx_86265] = tmp_86266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_86267 = 0; i_86267 < chunk_sizze_86223; i_86267++) {\n                int64_t sharedIdx_86268 = sext_i32_i64(local_tid_86235) * chunk_sizze_86223 + i_86267;\n                int64_t tmp_86269 = ((__local int64_t *) local_mem_86242)[sharedIdx_86268];\n                \n                private_mem_86257[i_86267] = tmp_86269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_86270 = 0; i_86270 < chunk_sizze_86223 - (int64_t) 1; i_86270++) {\n                int64_t eta_p_77082;\n                int64_t eta_p_77083;\n                \n                eta_p_77082 = private_mem_86257[i_86270];\n                eta_p_77083 = private_mem_86257[i_86270 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_77084 = add64(eta_p_77082, eta_p_77083);\n                \n                private_mem_86257[i_86270 + (int64_t) 1] = defunc_0_op_res_77084;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_86271 = private_mem_86257[chunk_sizze_86223 - (int64_t) 1];\n        ", "    \n            ((__local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = tmp_86271;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_86272;\n            int64_t eta_p_86273;\n            int64_t eta_p_86276;\n            int64_t eta_p_86277;\n            bool ltid_in_bounds_86279 = slt64(sext_i32_i64(local_tid_86235), num_virt_threads_86225);\n            int32_t skip_threads_86280;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_86279) {\n                    eta_p_86273 = ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)];\n                    if ((local_tid_86235 - squot32(local_tid_86235, 32) * 32) == 0) {\n                        eta_p_86272 = eta_p_86273;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_86280 = 1;\n                while (slt32(skip_threads_86280, 32)) {\n                    bool thread_active_86281 = sle32(skip_threads_86280, local_tid_86235 - squot32(local_tid_86235, 32) * 32) && ltid_in_bounds_86279;\n                    \n                    if (thread_active_86281) {\n                        // read operands\n                        {\n                            eta_p_86272 = ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235) - sext_i32_i64(skip_threads_86280)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_86281) {\n                            int64_t defunc_0_op_res_86274 = add64(eta_p_86272, eta_p_86273);\n                            \n                            eta_p_86272 = defunc_0_op_res_86274;\n                        }\n                    }\n                    if (sle32(wave_sizze_86237, skip_threads_86280)) {\n                        b", "arrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_86281) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = eta_p_86272;\n                            eta_p_86273 = eta_p_86272;\n                        }\n                    }\n                    if (sle32(wave_sizze_86237, skip_threads_86280)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_86280 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_86235 - squot32(local_tid_86235, 32) * 32) == 31 && ltid_in_bounds_86279) {\n                    ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(squot32(local_tid_86235, 32))] = eta_p_86272;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_86282;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_86235, 32) == 0 && ltid_in_bounds_86279) {\n                        eta_p_86277 = ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)];\n                        if ((local_tid_86235 - squot32(local_tid_86235, 32) * 32) == 0) {\n                            eta_p_86276 = eta_p_86277;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_86282 = 1;\n                    while (slt32(skip_threads_86282, 32)) {\n                        bool thread_active_86283 = sle32(skip_threads_86282, local_tid_86235 - squot32(local_tid_86235,",
                                    " 32) * 32) && (squot32(local_tid_86235, 32) == 0 && ltid_in_bounds_86279);\n                        \n                        if (thread_active_86283) {\n                            // read operands\n                            {\n                                eta_p_86276 = ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235) - sext_i32_i64(skip_threads_86282)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_86283) {\n                                int64_t defunc_0_op_res_86278 = add64(eta_p_86276, eta_p_86277);\n                                \n                                eta_p_86276 = defunc_0_op_res_86278;\n                            }\n                        }\n                        if (sle32(wave_sizze_86237, skip_threads_86282)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_86283) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = eta_p_86276;\n                                eta_p_86277 = eta_p_86276;\n                            }\n                        }\n                        if (sle32(wave_sizze_86237, skip_threads_86282)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_86282 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_86284 = squot32(local_tid_86235, 32) == 0 || !ltid_in_bounds_86279;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_86284) {\n                        eta_p_86273 = eta_p_86272;\n       ", "                 eta_p_86272 = ((__local int64_t *) local_mem_86242)[sext_i32_i64(squot32(local_tid_86235, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_86284) {\n                        int64_t defunc_0_op_res_86274 = add64(eta_p_86272, eta_p_86273);\n                        \n                        eta_p_86272 = defunc_0_op_res_86274;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_86284) {\n                        ((__local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = eta_p_86272;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_86235, 32) == 0 && ltid_in_bounds_86279) {\n                    ((__local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = eta_p_86273;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_86235 == 0) {\n                acc_86275 = ((__local int64_t *) local_mem_86242)[segscan_tblock_sizze_77076 - (int64_t) 1];\n            } else {\n                acc_86275 = ((__local int64_t *) local_mem_86242)[sext_i32_i64(local_tid_86235) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_86285 = (int64_t) 0;\n        block_new_sgm_86286 = sgm_idx_86254 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_86286 && local_tid_86235 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_86230)[dynamic_id_86252] = acc_86275;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_86226)[dynamic_id_86252] = (int8_t) 2;\n                acc_86275 = (int64_t) 0;\n            }\n  ", "          if (!block_new_sgm_86286 && slt32(local_tid_86235, wave_sizze_86237)) {\n                if (local_tid_86235 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_86228)[dynamic_id_86252] = acc_86275;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_86226)[dynamic_id_86252] = (int8_t) 1;\n                    \n                    int8_t tmp_86287 = ((volatile __global int8_t *) status_flags_mem_86226)[dynamic_id_86252 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_86242)[(int64_t) 0] = tmp_86287;\n                }\n                mem_fence_local();\n                \n                int8_t status_86288 = ((__local int8_t *) local_mem_86242)[(int64_t) 0];\n                \n                if (status_86288 == (int8_t) 2) {\n                    if (local_tid_86235 == 0) {\n                        prefix_86285 = ((volatile __global int64_t *) incprefixes_mem_86230)[dynamic_id_86252 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_86289 = sext_i64_i32(dynamic_id_86252 - sext_i32_i64(wave_sizze_86237));\n                    \n                    while (slt32(wave_sizze_86237 * -1, readOffset_86289)) {\n                        int32_t read_i_86290 = readOffset_86289 + local_tid_86235;\n                        int64_t aggr_86291 = (int64_t) 0;\n                        int8_t flag_86292 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_86290)) {\n                            flag_86292 = ((volatile __global int8_t *) status_flags_mem_86226)[sext_i32_i64(read_i_86290)];\n                            if (flag_86292 == (int8_t) 2) {\n                                aggr_86291 = ((volatile __global int64_t *) incprefixes_mem_86230)[sext_i32_i64(read_i_86290)];\n                            } else if (flag_86292 == (int8_t) 1) {\n                                aggr_86291 = ((volat",
                                    "ile __global int64_t *) aggregates_mem_86228)[sext_i32_i64(read_i_86290)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_86242)[(int64_t) 4 + sext_i32_i64(local_tid_86235)] = aggr_86291;\n                        ((__local int8_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = flag_86292;\n                        flag_86292 = ((__local int8_t *) local_mem_86242)[sext_i32_i64(wave_sizze_86237) - (int64_t) 1];\n                        if (slt8(flag_86292, (int8_t) 2)) {\n                            int8_t flg_x_86296;\n                            int8_t flg_y_86297;\n                            int64_t eta_p_86293;\n                            int64_t eta_p_86294;\n                            int32_t skip_threads_86298;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_86297 = ((volatile __local int8_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)];\n                                eta_p_86294 = ((volatile __local int64_t *) local_mem_86242)[(int64_t) 4 + sext_i32_i64(local_tid_86235)];\n                                if ((local_tid_86235 - squot32(local_tid_86235, 32) * 32) == 0) {\n                                    eta_p_86293 = eta_p_86294;\n                                    flg_x_86296 = flg_y_86297;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_86298 = 1;\n                                while (slt32(skip_threads_86298, 32)) {\n                                    if (sle32(skip_threads_86298, local_tid_86235 - squot32(local_tid_86235, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_86296 = ((volatile __local int8_t *)", " local_mem_86242)[sext_i32_i64(local_tid_86235) - sext_i32_i64(skip_threads_86298)];\n                                            eta_p_86293 = ((volatile __local int64_t *) local_mem_86242)[(int64_t) 4 + (sext_i32_i64(local_tid_86235) - sext_i32_i64(skip_threads_86298))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_86297 == (int8_t) 2 || flg_y_86297 == (int8_t) 0) {\n                                                flg_x_86296 = flg_y_86297;\n                                                eta_p_86293 = eta_p_86294;\n                                            } else {\n                                                int64_t defunc_0_op_res_86295 = add64(eta_p_86293, eta_p_86294);\n                                                \n                                                eta_p_86293 = defunc_0_op_res_86295;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_86242)[sext_i32_i64(local_tid_86235)] = flg_x_86296;\n                                            flg_y_86297 = flg_x_86296;\n                                            ((volatile __local int64_t *) local_mem_86242)[(int64_t) 4 + sext_i32_i64(local_tid_86235)] = eta_p_86293;\n                                            eta_p_86294 = eta_p_86293;\n                                        }\n                                    }\n                                    skip_threads_86298 *= 2;\n                                }\n                            }\n                        }\n                        flag_86292 = ((__local int8_t *) local_mem_86242)[sext_i32_i64(wave_sizze_86237) - (int64_t) 1];\n                        aggr_86291 = ((__local int64_t *) l", "ocal_mem_86242)[(int64_t) 4 + (sext_i32_i64(wave_sizze_86237) - (int64_t) 1)];\n                        if (flag_86292 == (int8_t) 2) {\n                            readOffset_86289 = wave_sizze_86237 * -1;\n                        } else if (flag_86292 == (int8_t) 1) {\n                            readOffset_86289 -= wave_sizze_86237;\n                        }\n                        if (slt8((int8_t) 0, flag_86292)) {\n                            int64_t eta_p_86299 = aggr_86291;\n                            int64_t eta_p_86300 = prefix_86285;\n                            int64_t defunc_0_op_res_86301 = add64(eta_p_86299, eta_p_86300);\n                            \n                            prefix_86285 = defunc_0_op_res_86301;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_86235 == 0) {\n                    if (boundary_86255 == sext_i64_i32(segscan_tblock_sizze_77076 * chunk_sizze_86223)) {\n                        int64_t eta_p_86302 = prefix_86285;\n                        int64_t eta_p_86303 = acc_86275;\n                        int64_t defunc_0_op_res_86304 = add64(eta_p_86302, eta_p_86303);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_86230)[dynamic_id_86252] = defunc_0_op_res_86304;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_86226)[dynamic_id_86252] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_86242)[(int64_t) 4] = prefix_86285;\n                    acc_86275 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_86252 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_86285 = ((__local int64_t *) local_mem_86242)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t et",
                                    "a_p_86305;\n            int64_t eta_p_86306;\n            int64_t eta_p_86308 = prefix_86285;\n            int64_t eta_p_86309 = acc_86275;\n            \n            if (slt32(local_tid_86235 * chunk_sizze_32b_86239, boundary_86255) && !block_new_sgm_86286) {\n                int64_t defunc_0_op_res_86310 = add64(eta_p_86308, eta_p_86309);\n                \n                eta_p_86305 = defunc_0_op_res_86310;\n            } else {\n                eta_p_86305 = acc_86275;\n            }\n            \n            int32_t stopping_point_86311 = segsizze_compact_86256 - srem32(local_tid_86235 * chunk_sizze_32b_86239 - 1 + segsizze_compact_86256 - boundary_86255, segsizze_compact_86256);\n            \n            for (int64_t i_86312 = 0; i_86312 < chunk_sizze_86223; i_86312++) {\n                if (slt32(sext_i64_i32(i_86312), stopping_point_86311 - 1)) {\n                    eta_p_86306 = private_mem_86257[i_86312];\n                    \n                    int64_t defunc_0_op_res_86307 = add64(eta_p_86305, eta_p_86306);\n                    \n                    private_mem_86257[i_86312] = defunc_0_op_res_86307;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_86313 = 0; i_86313 < chunk_sizze_86223; i_86313++) {\n                int64_t sharedIdx_86314 = sext_i32_i64(local_tid_86235) * chunk_sizze_86223 + i_86313;\n                int64_t tmp_86315 = private_mem_86257[i_86313];\n                \n                ((__local int64_t *) local_mem_86242)[sharedIdx_86314] = tmp_86315;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_86316 = 0; i_86316 < chunk_sizze_86223; i_86316++) {\n                int64_t flat_idx_86317 = thd_offset_86259 + i_86316 * segscan_tblock_sizze_77076;\n                int64_t slice_86318 = m_63000;\n                int64_t gtid_77080 = flat_idx_86317;\n                int64_t remnant_86319 = flat_idx_86317 - gtid_77080", ";\n                \n                if (slt64(flat_idx_86317, m_63000)) {\n                    int64_t tmp_86320 = ((__local int64_t *) local_mem_86242)[flat_idx_86317 - block_offset_86253];\n                    \n                    ((__global int64_t *) mem_82696)[gtid_77080] = tmp_86320;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_77076\n    #undef chunk_sizze_86223\n}\nFUTHARK_KERNEL_SIZED(do_DBSCAN_doublezisegscan_77103_dim1, 1, 1)\nvoid do_DBSCAN_doublezisegscan_77103(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, double clBase_48698, int64_t m_62289, int64_t conc_tmp_62375, int64_t conc_tmp_62379, int64_t conc_tmp_62382, int64_t num_tblocks_77100, double d_haversine_res_81627, double d_haversine_res_81628, double d_haversine_res_81629, double d_haversine_res_81630, double cos_res_81631, double cos_res_81632, int64_t num_virt_blocks_86327, int64_t num_virt_threads_86328, __global unsigned char *mem_81979, __global unsigned char *mem_81981, __global unsigned char *mem_81983, __global unsigned char *mem_81985, __global unsigned char *mem_82046, __global unsigned char *mem_82048, __global unsigned char *ext_mem_82065, __global unsigned char *ext_mem_82066, __global unsigned char *mem_82079, __global unsigned char *mem_82081, __global unsigned char *ext_mem_82539, __global unsigned char *mem_82720, __global unsigned char *mem_82722, __global unsigned char *mem_82724, __global unsigned char *mem_82726, __global unsigned char *mem_82728, __global unsigned char *status_flags_mem_86329, __global unsigned char *aggregates_mem_86331, __global unsigned char *incprefixes_mem_86333, __global unsigned char *global_dynid_mem_86335)\n{\n    #define segscan_tblock_sizze_77098 (do_DBSCAN_doublezisegscan_77103zisegscan_tblock_sizze_77098)\n    #define chunk_sizze_86326 (do_DBS", "CAN_doublezisegscan_77103zichunk_sizze_86326)\n    \n    volatile __local unsigned char *local_mem_86345_backing_0 = &shared_mem[0];\n    const int64_t local_mem_86345_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77098), chunk_sizze_86326 * segscan_tblock_sizze_77098 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77098), chunk_sizze_86326 * segscan_tblock_sizze_77098 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_86338;\n    int32_t tblock_sizze_86341;\n    int32_t wave_sizze_86340;\n    int32_t block_id_86339;\n    int32_t global_tid_86337;\n    int64_t phys_tid_77103;\n    int32_t chunk_sizze_32b_86342;\n    int64_t byte_offsets_86343;\n    int64_t warp_byte_offset_86344;\n    __local unsigned char *local_mem_86345;\n    int64_t trans_arr_len_86346;\n    int64_t phys_block_id_86352;\n    int64_t virtloop_bound_86353;\n    \n    local_tid_86338 = get_local_id(0);\n    tblock_sizze_86341 = get_local_size(0);\n    wave_sizze_86340 = LOCKSTEP_WIDTH;\n    block_id_86339 = get_tblock_id(0);\n    global_tid_86337 = block_id_86339 * tblock_sizze_86341 + local_tid_86338;\n    phys_tid_77103 = sext_i32_i64(global_tid_86337);\n    chunk_sizze_32b_86342 = sext_i64_i32(chunk_sizze_86326);\n    byte_offsets_86343 = segscan_tblock_sizze_77098 * (int64_t) 8;\n    warp_byte_offset_86344 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_86345 = (__local unsigned char *) local_mem_86345_backing_0;\n    trans_arr_len_86346 = chunk_sizze_86326 * segscan_tblock_sizze_77098;\n    phys_block_id_86352 = get_tblock_id(0);\n    virtloop_bound_86353 = sdiv_up64(num_virt_blocks_86327 - phys_block_id_86352, num_tblocks_77100);\n    for (in",
                                    "t64_t virtloop_i_86354 = 0; virtloop_i_86354 < virtloop_bound_86353; virtloop_i_86354++) {\n        int64_t dynamic_id_86355;\n        int64_t block_offset_86356;\n        int64_t sgm_idx_86357;\n        int32_t boundary_86358;\n        int32_t segsizze_compact_86359;\n        int64_t private_mem_86360[chunk_sizze_86326];\n        int64_t thd_offset_86362;\n        int64_t acc_86378;\n        int64_t prefix_86388;\n        bool block_new_sgm_86389;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_86338 == 0) {\n                dynamic_id_86355 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_86335)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_86345)[(int64_t) 0] = dynamic_id_86355;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_86355 == num_virt_blocks_86327 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_86335)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_86355 = ((__local int32_t *) local_mem_86345)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_86356 = dynamic_id_86355 * chunk_sizze_86326 * segscan_tblock_sizze_77098;\n        sgm_idx_86357 = smod64(block_offset_86356, conc_tmp_62379);\n        boundary_86358 = sext_i64_i32(smin64(chunk_sizze_86326 * segscan_tblock_sizze_77098, conc_tmp_62379 - sgm_idx_86357));\n        segsizze_compact_86359 = sext_i64_i32(smin64(chunk_sizze_86326 * segscan_tblock_sizze_77098, conc_tmp_62379));\n        thd_offset_86362 = block_offset_86356 + sext_i32_i64(local_tid_86338);\n        // Load and map\n        {\n            for (int64_t i_86363 = 0; i_86363 < chunk_sizze_86326; i_86363++) {\n                int64_t virt_tid", "_86364 = thd_offset_86362 + i_86363 * segscan_tblock_sizze_77098;\n                int64_t slice_86365 = conc_tmp_62379;\n                int64_t gtid_77102 = virt_tid_86364;\n                int64_t remnant_86366 = virt_tid_86364 - gtid_77102;\n                \n                if (slt64(virt_tid_86364, conc_tmp_62379)) {\n                    bool y_63959 = slt64(gtid_77102, conc_tmp_62382);\n                    bool index_certs_63961;\n                    \n                    if (!y_63959) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 24) == -1) {\n                                global_failure_args[0] = (int64_t) gtid_77102;\n                                global_failure_args[1] = (int64_t) conc_tmp_62382;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    double isWithinMargins_arg3_81623 = ((__global double *) mem_81983)[(int64_t) 0];\n                    double isWithinMargins_arg2_81624 = ((__global double *) mem_81979)[(int64_t) 0];\n                    double isWithinMargins_arg1_81625 = ((__global double *) mem_81985)[(int64_t) 0];\n                    double isWithinMargins_arg0_81626 = ((__global double *) mem_81981)[(int64_t) 0];\n                    int64_t tmp_63962 = ((__global int64_t *) ext_mem_82539)[gtid_77102];\n                    bool index_concat_cmp_63967 = sle64(conc_tmp_62375, gtid_77102);\n                    double index_concat_branch_63968;\n                    \n                    if (index_concat_cmp_63967) {\n                        int64_t index_concat_i_66693 = sub64(gtid_77102, conc_tmp_62375);\n                        double index_concat_66694 = ((__global double *) ext_mem_82066)[index_concat_i_66693];\n                        \n                        index_concat_branch_63968 = index_concat_66694;\n  ", "                  } else {\n                        bool index_concat_cmp_63971 = sle64(m_62289, gtid_77102);\n                        double index_concat_branch_63972;\n                        \n                        if (index_concat_cmp_63971) {\n                            int64_t index_concat_i_66695 = sub64(gtid_77102, m_62289);\n                            double index_concat_66696 = ((__global double *) mem_82048)[index_concat_i_66695];\n                            \n                            index_concat_branch_63972 = index_concat_66696;\n                        } else {\n                            double index_concat_63975 = ((__global double *) mem_82081)[gtid_77102];\n                            \n                            index_concat_branch_63972 = index_concat_63975;\n                        }\n                        index_concat_branch_63968 = index_concat_branch_63972;\n                    }\n                    \n                    double index_concat_branch_63976;\n                    \n                    if (index_concat_cmp_63967) {\n                        int64_t index_concat_i_66697 = sub64(gtid_77102, conc_tmp_62375);\n                        double index_concat_66698 = ((__global double *) ext_mem_82065)[index_concat_i_66697];\n                        \n                        index_concat_branch_63976 = index_concat_66698;\n                    } else {\n                        bool index_concat_cmp_63979 = sle64(m_62289, gtid_77102);\n                        double index_concat_branch_63980;\n                        \n                        if (index_concat_cmp_63979) {\n                            int64_t index_concat_i_66699 = sub64(gtid_77102, m_62289);\n                            double index_concat_66700 = ((__global double *) mem_82046)[index_concat_i_66699];\n                            \n                            index_concat_branch_63980 = index_concat_66700;\n                        } else {\n                            double index_concat_63983 = (",
                                    "(__global double *) mem_82079)[gtid_77102];\n                            \n                            index_concat_branch_63980 = index_concat_63983;\n                        }\n                        index_concat_branch_63976 = index_concat_branch_63980;\n                    }\n                    \n                    bool zgze_res_63987 = isWithinMargins_arg1_81625 <= index_concat_branch_63976;\n                    bool zlze_res_63988 = index_concat_branch_63976 <= isWithinMargins_arg3_81623;\n                    bool x_63989 = zgze_res_63987 && zlze_res_63988;\n                    double dist_res_63990;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_66703 = index_concat_branch_63968 == isWithinMargins_arg0_81626;\n                        double d_euclidean_res_66704;\n                        \n                        if (zeze_res_66703) {\n                            double zm_res_66705 = index_concat_branch_63976 - index_concat_branch_63976;\n                            double abs_res_66706 = fabs64(zm_res_66705);\n                            \n                            d_euclidean_res_66704 = abs_res_66706;\n                        } else {\n                            double zm_res_66707 = index_concat_branch_63968 - isWithinMargins_arg0_81626;\n                            double abs_res_66708 = fabs64(zm_res_66707);\n                            \n                            d_euclidean_res_66704 = abs_res_66708;\n                        }\n                        dist_res_63990 = d_euclidean_res_66704;\n                    } else {\n                        double d_haversine_res_63997;\n                        double d_haversine_res_63998;\n                        double d_haversine_res_63999;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_63997 = index_concat_branch_63968;\n                            d_haversine_res_63998 = index_concat_", "branch_63976;\n                            d_haversine_res_63999 = index_concat_branch_63976;\n                        } else {\n                            double zt_res_64000 = 3.141592653589793 * index_concat_branch_63968;\n                            double zs_res_64001 = zt_res_64000 / 180.0;\n                            double zt_res_64002 = 3.141592653589793 * index_concat_branch_63976;\n                            double zs_res_64003 = zt_res_64002 / 180.0;\n                            \n                            d_haversine_res_63997 = zs_res_64001;\n                            d_haversine_res_63998 = zs_res_64003;\n                            d_haversine_res_63999 = zs_res_64003;\n                        }\n                        \n                        double zm_res_64004 = d_haversine_res_63997 - d_haversine_res_81627;\n                        double cos_res_64005 = futrts_cos64(zm_res_64004);\n                        double zm_res_64006 = 1.0 - cos_res_64005;\n                        double cos_res_64007 = futrts_cos64(d_haversine_res_63997);\n                        double zt_res_64008 = cos_res_64007 * cos_res_81631;\n                        double zm_res_64009 = d_haversine_res_63998 - d_haversine_res_63999;\n                        double zm_res_64010 = 1.0 - zm_res_64009;\n                        double zt_res_64011 = zt_res_64008 * zm_res_64010;\n                        double zp_res_64012 = zm_res_64006 + zt_res_64011;\n                        double zs_res_64013 = zp_res_64012 / 2.0;\n                        double min_res_64014 = fmin64(1.0, zs_res_64013);\n                        double zt_res_64015 = 2.0 * min_res_64014;\n                        double zm_res_64016 = 1.0 - zt_res_64015;\n                        double acos_res_64017 = futrts_acos64(zm_res_64016);\n                        double zt_res_64018 = clBase_48698 * acos_res_64017;\n                        \n                        dist_res_63990 = zt_res_64018;\n                    }\n                    \n   ", "                 bool zlze_res_64019 = dist_res_63990 <= clBase_48692;\n                    double dist_res_64020;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool zeze_res_66711 = index_concat_branch_63968 == isWithinMargins_arg2_81624;\n                        double d_euclidean_res_66712;\n                        \n                        if (zeze_res_66711) {\n                            double zm_res_66713 = index_concat_branch_63976 - index_concat_branch_63976;\n                            double abs_res_66714 = fabs64(zm_res_66713);\n                            \n                            d_euclidean_res_66712 = abs_res_66714;\n                        } else {\n                            double zm_res_66715 = index_concat_branch_63968 - isWithinMargins_arg2_81624;\n                            double abs_res_66716 = fabs64(zm_res_66715);\n                            \n                            d_euclidean_res_66712 = abs_res_66716;\n                        }\n                        dist_res_64020 = d_euclidean_res_66712;\n                    } else {\n                        double d_haversine_res_64027;\n                        double d_haversine_res_64028;\n                        double d_haversine_res_64029;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64027 = index_concat_branch_63968;\n                            d_haversine_res_64028 = index_concat_branch_63976;\n                            d_haversine_res_64029 = index_concat_branch_63976;\n                        } else {\n                            double zt_res_64030 = 3.141592653589793 * index_concat_branch_63968;\n                            double zs_res_64031 = zt_res_64030 / 180.0;\n                            double zt_res_64032 = 3.141592653589793 * index_concat_branch_63976;\n                            double zs_res_64033 = zt_res_64032 / 180.0;\n                            \n",
                                    "                            d_haversine_res_64027 = zs_res_64031;\n                            d_haversine_res_64028 = zs_res_64033;\n                            d_haversine_res_64029 = zs_res_64033;\n                        }\n                        \n                        double zm_res_64034 = d_haversine_res_64027 - d_haversine_res_81628;\n                        double cos_res_64035 = futrts_cos64(zm_res_64034);\n                        double zm_res_64036 = 1.0 - cos_res_64035;\n                        double cos_res_64037 = futrts_cos64(d_haversine_res_64027);\n                        double zt_res_64038 = cos_res_64037 * cos_res_81632;\n                        double zm_res_64039 = d_haversine_res_64028 - d_haversine_res_64029;\n                        double zm_res_64040 = 1.0 - zm_res_64039;\n                        double zt_res_64041 = zt_res_64038 * zm_res_64040;\n                        double zp_res_64042 = zm_res_64036 + zt_res_64041;\n                        double zs_res_64043 = zp_res_64042 / 2.0;\n                        double min_res_64044 = fmin64(1.0, zs_res_64043);\n                        double zt_res_64045 = 2.0 * min_res_64044;\n                        double zm_res_64046 = 1.0 - zt_res_64045;\n                        double acos_res_64047 = futrts_acos64(zm_res_64046);\n                        double zt_res_64048 = clBase_48698 * acos_res_64047;\n                        \n                        dist_res_64020 = zt_res_64048;\n                    }\n                    \n                    bool zlze_res_64049 = dist_res_64020 <= clBase_48692;\n                    bool x_64050 = !zlze_res_64019;\n                    bool y_64051 = zlze_res_64049 && x_64050;\n                    bool cond_t_res_64052 = zlze_res_64019 || y_64051;\n                    bool x_64053 = x_63989 && cond_t_res_64052;\n                    bool zgze_res_64054 = isWithinMargins_arg0_81626 <= index_concat_branch_63968;\n                    bool zlze_res_64055 = index_concat_branch_63968 <= isW", "ithinMargins_arg2_81624;\n                    bool x_64056 = zgze_res_64054 && zlze_res_64055;\n                    double dist_res_64057;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double zm_res_66717 = index_concat_branch_63976 - isWithinMargins_arg1_81625;\n                        double abs_res_66718 = fabs64(zm_res_66717);\n                        \n                        dist_res_64057 = abs_res_66718;\n                    } else {\n                        double d_haversine_res_64060;\n                        double d_haversine_res_64061;\n                        double d_haversine_res_64062;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64060 = index_concat_branch_63968;\n                            d_haversine_res_64061 = index_concat_branch_63976;\n                            d_haversine_res_64062 = index_concat_branch_63968;\n                        } else {\n                            double zt_res_64063 = 3.141592653589793 * index_concat_branch_63968;\n                            double zs_res_64064 = zt_res_64063 / 180.0;\n                            double zt_res_64065 = 3.141592653589793 * index_concat_branch_63976;\n                            double zs_res_64066 = zt_res_64065 / 180.0;\n                            \n                            d_haversine_res_64060 = zs_res_64064;\n                            d_haversine_res_64061 = zs_res_64066;\n                            d_haversine_res_64062 = zs_res_64064;\n                        }\n                        \n                        double zm_res_64067 = d_haversine_res_64060 - d_haversine_res_64062;\n                        double cos_res_64068 = futrts_cos64(zm_res_64067);\n                        double zm_res_64069 = 1.0 - cos_res_64068;\n                        double cos_res_64070 = futrts_cos64(d_haversine_res_64062);\n                        double cos_res_64071 = futrts_cos", "64(d_haversine_res_64060);\n                        double zt_res_64072 = cos_res_64070 * cos_res_64071;\n                        double zm_res_64073 = d_haversine_res_64061 - d_haversine_res_81629;\n                        double zm_res_64074 = 1.0 - zm_res_64073;\n                        double zt_res_64075 = zt_res_64072 * zm_res_64074;\n                        double zp_res_64076 = zm_res_64069 + zt_res_64075;\n                        double zs_res_64077 = zp_res_64076 / 2.0;\n                        double min_res_64078 = fmin64(1.0, zs_res_64077);\n                        double zt_res_64079 = 2.0 * min_res_64078;\n                        double zm_res_64080 = 1.0 - zt_res_64079;\n                        double acos_res_64081 = futrts_acos64(zm_res_64080);\n                        double zt_res_64082 = clBase_48698 * acos_res_64081;\n                        \n                        dist_res_64057 = zt_res_64082;\n                    }\n                    \n                    bool zlze_res_64083 = dist_res_64057 <= clBase_48692;\n                    double dist_res_64084;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        double zm_res_66719 = index_concat_branch_63976 - isWithinMargins_arg3_81623;\n                        double abs_res_66720 = fabs64(zm_res_66719);\n                        \n                        dist_res_64084 = abs_res_66720;\n                    } else {\n                        double d_haversine_res_64087;\n                        double d_haversine_res_64088;\n                        double d_haversine_res_64089;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64087 = index_concat_branch_63968;\n                            d_haversine_res_64088 = index_concat_branch_63976;\n                            d_haversine_res_64089 = index_concat_branch_63968;\n                        } else {\n                            double zt_res_64090 =",
                                    " 3.141592653589793 * index_concat_branch_63968;\n                            double zs_res_64091 = zt_res_64090 / 180.0;\n                            double zt_res_64092 = 3.141592653589793 * index_concat_branch_63976;\n                            double zs_res_64093 = zt_res_64092 / 180.0;\n                            \n                            d_haversine_res_64087 = zs_res_64091;\n                            d_haversine_res_64088 = zs_res_64093;\n                            d_haversine_res_64089 = zs_res_64091;\n                        }\n                        \n                        double zm_res_64094 = d_haversine_res_64087 - d_haversine_res_64089;\n                        double cos_res_64095 = futrts_cos64(zm_res_64094);\n                        double zm_res_64096 = 1.0 - cos_res_64095;\n                        double cos_res_64097 = futrts_cos64(d_haversine_res_64089);\n                        double cos_res_64098 = futrts_cos64(d_haversine_res_64087);\n                        double zt_res_64099 = cos_res_64097 * cos_res_64098;\n                        double zm_res_64100 = d_haversine_res_64088 - d_haversine_res_81630;\n                        double zm_res_64101 = 1.0 - zm_res_64100;\n                        double zt_res_64102 = zt_res_64099 * zm_res_64101;\n                        double zp_res_64103 = zm_res_64096 + zt_res_64102;\n                        double zs_res_64104 = zp_res_64103 / 2.0;\n                        double min_res_64105 = fmin64(1.0, zs_res_64104);\n                        double zt_res_64106 = 2.0 * min_res_64105;\n                        double zm_res_64107 = 1.0 - zt_res_64106;\n                        double acos_res_64108 = futrts_acos64(zm_res_64107);\n                        double zt_res_64109 = clBase_48698 * acos_res_64108;\n                        \n                        dist_res_64084 = zt_res_64109;\n                    }\n                    \n                    bool zlze_res_64110 = dist_res_64084 <= clBase_48692;\n                    ", "bool x_64111 = !zlze_res_64083;\n                    bool y_64112 = zlze_res_64110 && x_64111;\n                    bool cond_f_res_t_res_64113 = zlze_res_64083 || y_64112;\n                    bool x_64114 = x_64056 && cond_f_res_t_res_64113;\n                    bool x_64115 = !x_64053;\n                    bool y_64116 = x_64114 && x_64115;\n                    bool cond_64117 = x_64053 || y_64116;\n                    bool zlze_res_64118 = index_concat_branch_63968 <= isWithinMargins_arg0_81626;\n                    double corn_x_64119;\n                    \n                    if (zlze_res_64118) {\n                        corn_x_64119 = isWithinMargins_arg0_81626;\n                    } else {\n                        corn_x_64119 = isWithinMargins_arg2_81624;\n                    }\n                    \n                    bool zlze_res_64120 = index_concat_branch_63976 <= isWithinMargins_arg1_81625;\n                    double corn_y_64121;\n                    \n                    if (zlze_res_64120) {\n                        corn_y_64121 = isWithinMargins_arg1_81625;\n                    } else {\n                        corn_y_64121 = isWithinMargins_arg3_81623;\n                    }\n                    \n                    double dist_res_64122;\n                    \n                    if (clBase_48691 == (int8_t) 0) {\n                        bool eq_x_y_66725 = index_concat_branch_63968 == isWithinMargins_arg0_81626;\n                        bool eq_x_zz_66726 = index_concat_branch_63968 == isWithinMargins_arg2_81624;\n                        bool p_and_eq_x_y_66727 = zlze_res_64118 && eq_x_y_66725;\n                        bool not_p_66728 = !zlze_res_64118;\n                        bool p_and_eq_x_y_66729 = eq_x_zz_66726 && not_p_66728;\n                        bool zeze_res_66730 = p_and_eq_x_y_66727 || p_and_eq_x_y_66729;\n                        double d_euclidean_res_66731;\n                        \n                        if (zeze_res_66730) {\n                           ", " double zm_res_66732 = index_concat_branch_63976 - corn_y_64121;\n                            double abs_res_66733 = fabs64(zm_res_66732);\n                            \n                            d_euclidean_res_66731 = abs_res_66733;\n                        } else {\n                            bool eq_x_y_66734 = index_concat_branch_63976 == isWithinMargins_arg1_81625;\n                            bool eq_x_zz_66735 = index_concat_branch_63976 == isWithinMargins_arg3_81623;\n                            bool p_and_eq_x_y_66736 = zlze_res_64120 && eq_x_y_66734;\n                            bool not_p_66737 = !zlze_res_64120;\n                            bool p_and_eq_x_y_66738 = eq_x_zz_66735 && not_p_66737;\n                            bool zeze_res_66739 = p_and_eq_x_y_66736 || p_and_eq_x_y_66738;\n                            double d_euclidean_res_f_res_66740;\n                            \n                            if (zeze_res_66739) {\n                                double zm_res_66741 = index_concat_branch_63968 - corn_x_64119;\n                                double abs_res_66742 = fabs64(zm_res_66741);\n                                \n                                d_euclidean_res_f_res_66740 = abs_res_66742;\n                            } else {\n                                double zm_res_66743 = index_concat_branch_63976 - corn_y_64121;\n                                double zm_res_66744 = index_concat_branch_63968 - corn_x_64119;\n                                double hypot_res_66745 = futrts_hypot64(zm_res_66744, zm_res_66743);\n                                \n                                d_euclidean_res_f_res_66740 = hypot_res_66745;\n                            }\n                            d_euclidean_res_66731 = d_euclidean_res_f_res_66740;\n                        }\n                        dist_res_64122 = d_euclidean_res_66731;\n                    } else {\n                        double d_haversine_res_64144;\n                        double d_haversine_r",
                                    "es_64145;\n                        double d_haversine_res_64146;\n                        double d_haversine_res_64147;\n                        \n                        if (clBase_48690 == (int8_t) 1) {\n                            d_haversine_res_64144 = index_concat_branch_63968;\n                            d_haversine_res_64145 = index_concat_branch_63976;\n                            d_haversine_res_64146 = corn_x_64119;\n                            d_haversine_res_64147 = corn_y_64121;\n                        } else {\n                            double zt_res_64148 = 3.141592653589793 * index_concat_branch_63968;\n                            double zs_res_64149 = zt_res_64148 / 180.0;\n                            double zt_res_64150 = 3.141592653589793 * index_concat_branch_63976;\n                            double zs_res_64151 = zt_res_64150 / 180.0;\n                            double zt_res_64152 = 3.141592653589793 * corn_x_64119;\n                            double zs_res_64153 = zt_res_64152 / 180.0;\n                            double zt_res_64154 = 3.141592653589793 * corn_y_64121;\n                            double zs_res_64155 = zt_res_64154 / 180.0;\n                            \n                            d_haversine_res_64144 = zs_res_64149;\n                            d_haversine_res_64145 = zs_res_64151;\n                            d_haversine_res_64146 = zs_res_64153;\n                            d_haversine_res_64147 = zs_res_64155;\n                        }\n                        \n                        double zm_res_64156 = d_haversine_res_64144 - d_haversine_res_64146;\n                        double cos_res_64157 = futrts_cos64(zm_res_64156);\n                        double zm_res_64158 = 1.0 - cos_res_64157;\n                        double cos_res_64159 = futrts_cos64(d_haversine_res_64146);\n                        double cos_res_64160 = futrts_cos64(d_haversine_res_64144);\n                        double zt_res_64161 = cos_res_64159 * cos_res_64160;\n  ", "                      double zm_res_64162 = d_haversine_res_64145 - d_haversine_res_64147;\n                        double zm_res_64163 = 1.0 - zm_res_64162;\n                        double zt_res_64164 = zt_res_64161 * zm_res_64163;\n                        double zp_res_64165 = zm_res_64158 + zt_res_64164;\n                        double zs_res_64166 = zp_res_64165 / 2.0;\n                        double min_res_64167 = fmin64(1.0, zs_res_64166);\n                        double zt_res_64168 = 2.0 * min_res_64167;\n                        double zm_res_64169 = 1.0 - zt_res_64168;\n                        double acos_res_64170 = futrts_acos64(zm_res_64169);\n                        double zt_res_64171 = clBase_48698 * acos_res_64170;\n                        \n                        dist_res_64122 = zt_res_64171;\n                    }\n                    \n                    bool zlze_res_64172 = dist_res_64122 <= clBase_48692;\n                    bool x_64173 = !cond_64117;\n                    bool y_64174 = zlze_res_64172 && x_64173;\n                    bool is_pt_marginal_res_64175 = cond_64117 || y_64174;\n                    int64_t defunc_0_f_res_64176 = btoi_bool_i64(is_pt_marginal_res_64175);\n                    \n                    ((__global int64_t *) mem_82722)[gtid_77102] = defunc_0_f_res_64176;\n                    ((__global int64_t *) mem_82724)[gtid_77102] = tmp_63962;\n                    ((__global double *) mem_82726)[gtid_77102] = index_concat_branch_63968;\n                    ((__global double *) mem_82728)[gtid_77102] = index_concat_branch_63976;\n                    private_mem_86360[i_86363] = defunc_0_f_res_64176;\n                } else {\n                    private_mem_86360[i_86363] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_8", "6367 = 0; i_86367 < chunk_sizze_86326; i_86367++) {\n                int64_t sharedIdx_86368 = sext_i32_i64(local_tid_86338) + i_86367 * segscan_tblock_sizze_77098;\n                int64_t tmp_86369 = private_mem_86360[i_86367];\n                \n                ((__local int64_t *) local_mem_86345)[sharedIdx_86368] = tmp_86369;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_86370 = 0; i_86370 < chunk_sizze_86326; i_86370++) {\n                int64_t sharedIdx_86371 = sext_i32_i64(local_tid_86338) * chunk_sizze_86326 + i_86370;\n                int64_t tmp_86372 = ((__local int64_t *) local_mem_86345)[sharedIdx_86371];\n                \n                private_mem_86360[i_86370] = tmp_86372;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_86373 = 0; i_86373 < chunk_sizze_86326 - (int64_t) 1; i_86373++) {\n                int64_t eta_p_63387;\n                int64_t eta_p_63388;\n                \n                eta_p_63387 = private_mem_86360[i_86373];\n                eta_p_63388 = private_mem_86360[i_86373 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_63389 = add64(eta_p_63387, eta_p_63388);\n                \n                private_mem_86360[i_86373 + (int64_t) 1] = defunc_0_op_res_63389;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_86374 = private_mem_86360[chunk_sizze_86326 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = tmp_86374;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_86375;\n            int64_t eta_p_86376;\n            int64_t eta_p_86379;\n            int64_t eta_p_86380;\n            bool ltid_in_bounds_86382 = slt64(sext_i32_i64(local_tid_86338), num_virt_threads_86328);\n            int32_t skip_threads_86383;\n      ",
                                    "      \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_86382) {\n                    eta_p_86376 = ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)];\n                    if ((local_tid_86338 - squot32(local_tid_86338, 32) * 32) == 0) {\n                        eta_p_86375 = eta_p_86376;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_86383 = 1;\n                while (slt32(skip_threads_86383, 32)) {\n                    bool thread_active_86384 = sle32(skip_threads_86383, local_tid_86338 - squot32(local_tid_86338, 32) * 32) && ltid_in_bounds_86382;\n                    \n                    if (thread_active_86384) {\n                        // read operands\n                        {\n                            eta_p_86375 = ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338) - sext_i32_i64(skip_threads_86383)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_86384) {\n                            int64_t defunc_0_op_res_86377 = add64(eta_p_86375, eta_p_86376);\n                            \n                            eta_p_86375 = defunc_0_op_res_86377;\n                        }\n                    }\n                    if (sle32(wave_sizze_86340, skip_threads_86383)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_86384) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = eta_p_86375;\n                            eta_p_86376 = eta_p_86375;\n                        }\n                    }\n                    if (sle32(wave_sizze_86340, skip_threads_86383)) {\n                       ", " barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_86383 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_86338 - squot32(local_tid_86338, 32) * 32) == 31 && ltid_in_bounds_86382) {\n                    ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(squot32(local_tid_86338, 32))] = eta_p_86375;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_86385;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_86338, 32) == 0 && ltid_in_bounds_86382) {\n                        eta_p_86380 = ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)];\n                        if ((local_tid_86338 - squot32(local_tid_86338, 32) * 32) == 0) {\n                            eta_p_86379 = eta_p_86380;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_86385 = 1;\n                    while (slt32(skip_threads_86385, 32)) {\n                        bool thread_active_86386 = sle32(skip_threads_86385, local_tid_86338 - squot32(local_tid_86338, 32) * 32) && (squot32(local_tid_86338, 32) == 0 && ltid_in_bounds_86382);\n                        \n                        if (thread_active_86386) {\n                            // read operands\n                            {\n                                eta_p_86379 = ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338) - sext_i32_i64(skip_threads_86385)];\n                            }\n                        }\n                        // perform opera", "tion\n                        {\n                            if (thread_active_86386) {\n                                int64_t defunc_0_op_res_86381 = add64(eta_p_86379, eta_p_86380);\n                                \n                                eta_p_86379 = defunc_0_op_res_86381;\n                            }\n                        }\n                        if (sle32(wave_sizze_86340, skip_threads_86385)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_86386) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = eta_p_86379;\n                                eta_p_86380 = eta_p_86379;\n                            }\n                        }\n                        if (sle32(wave_sizze_86340, skip_threads_86385)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_86385 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_86387 = squot32(local_tid_86338, 32) == 0 || !ltid_in_bounds_86382;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_86387) {\n                        eta_p_86376 = eta_p_86375;\n                        eta_p_86375 = ((__local int64_t *) local_mem_86345)[sext_i32_i64(squot32(local_tid_86338, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_86387) {\n                        int64_t defunc_0_op_res_86377 = add64(eta_p_86375, eta_p_86376);\n                        \n                        eta_p_86375 = defunc_0_op_res_86377;\n                    }\n                ",
                                    "}\n                // write final result\n                {\n                    if (!no_carry_in_86387) {\n                        ((__local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = eta_p_86375;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_86338, 32) == 0 && ltid_in_bounds_86382) {\n                    ((__local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = eta_p_86376;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_86338 == 0) {\n                acc_86378 = ((__local int64_t *) local_mem_86345)[segscan_tblock_sizze_77098 - (int64_t) 1];\n            } else {\n                acc_86378 = ((__local int64_t *) local_mem_86345)[sext_i32_i64(local_tid_86338) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_86388 = (int64_t) 0;\n        block_new_sgm_86389 = sgm_idx_86357 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_86389 && local_tid_86338 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_86333)[dynamic_id_86355] = acc_86378;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_86329)[dynamic_id_86355] = (int8_t) 2;\n                acc_86378 = (int64_t) 0;\n            }\n            if (!block_new_sgm_86389 && slt32(local_tid_86338, wave_sizze_86340)) {\n                if (local_tid_86338 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_86331)[dynamic_id_86355] = acc_86378;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_86329)[dynamic_id_86355] = (int8_t) 1;\n                    \n                    int8_t tmp_86390 = ((volatile __global int8_t *) status_flags_mem", "_86329)[dynamic_id_86355 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_86345)[(int64_t) 0] = tmp_86390;\n                }\n                mem_fence_local();\n                \n                int8_t status_86391 = ((__local int8_t *) local_mem_86345)[(int64_t) 0];\n                \n                if (status_86391 == (int8_t) 2) {\n                    if (local_tid_86338 == 0) {\n                        prefix_86388 = ((volatile __global int64_t *) incprefixes_mem_86333)[dynamic_id_86355 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_86392 = sext_i64_i32(dynamic_id_86355 - sext_i32_i64(wave_sizze_86340));\n                    \n                    while (slt32(wave_sizze_86340 * -1, readOffset_86392)) {\n                        int32_t read_i_86393 = readOffset_86392 + local_tid_86338;\n                        int64_t aggr_86394 = (int64_t) 0;\n                        int8_t flag_86395 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_86393)) {\n                            flag_86395 = ((volatile __global int8_t *) status_flags_mem_86329)[sext_i32_i64(read_i_86393)];\n                            if (flag_86395 == (int8_t) 2) {\n                                aggr_86394 = ((volatile __global int64_t *) incprefixes_mem_86333)[sext_i32_i64(read_i_86393)];\n                            } else if (flag_86395 == (int8_t) 1) {\n                                aggr_86394 = ((volatile __global int64_t *) aggregates_mem_86331)[sext_i32_i64(read_i_86393)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_86345)[(int64_t) 4 + sext_i32_i64(local_tid_86338)] = aggr_86394;\n                        ((__local int8_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = flag_86395;\n                        flag_86395 = ((__local int8_t *) local_mem_86345)[sext_i32_i64(wave_sizze_86340) - (int64_t) 1];\n   ", "                     if (slt8(flag_86395, (int8_t) 2)) {\n                            int8_t flg_x_86399;\n                            int8_t flg_y_86400;\n                            int64_t eta_p_86396;\n                            int64_t eta_p_86397;\n                            int32_t skip_threads_86401;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_86400 = ((volatile __local int8_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)];\n                                eta_p_86397 = ((volatile __local int64_t *) local_mem_86345)[(int64_t) 4 + sext_i32_i64(local_tid_86338)];\n                                if ((local_tid_86338 - squot32(local_tid_86338, 32) * 32) == 0) {\n                                    eta_p_86396 = eta_p_86397;\n                                    flg_x_86399 = flg_y_86400;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_86401 = 1;\n                                while (slt32(skip_threads_86401, 32)) {\n                                    if (sle32(skip_threads_86401, local_tid_86338 - squot32(local_tid_86338, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_86399 = ((volatile __local int8_t *) local_mem_86345)[sext_i32_i64(local_tid_86338) - sext_i32_i64(skip_threads_86401)];\n                                            eta_p_86396 = ((volatile __local int64_t *) local_mem_86345)[(int64_t) 4 + (sext_i32_i64(local_tid_86338) - sext_i32_i64(skip_threads_86401))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_86400 == (",
                                    "int8_t) 2 || flg_y_86400 == (int8_t) 0) {\n                                                flg_x_86399 = flg_y_86400;\n                                                eta_p_86396 = eta_p_86397;\n                                            } else {\n                                                int64_t defunc_0_op_res_86398 = add64(eta_p_86396, eta_p_86397);\n                                                \n                                                eta_p_86396 = defunc_0_op_res_86398;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_86345)[sext_i32_i64(local_tid_86338)] = flg_x_86399;\n                                            flg_y_86400 = flg_x_86399;\n                                            ((volatile __local int64_t *) local_mem_86345)[(int64_t) 4 + sext_i32_i64(local_tid_86338)] = eta_p_86396;\n                                            eta_p_86397 = eta_p_86396;\n                                        }\n                                    }\n                                    skip_threads_86401 *= 2;\n                                }\n                            }\n                        }\n                        flag_86395 = ((__local int8_t *) local_mem_86345)[sext_i32_i64(wave_sizze_86340) - (int64_t) 1];\n                        aggr_86394 = ((__local int64_t *) local_mem_86345)[(int64_t) 4 + (sext_i32_i64(wave_sizze_86340) - (int64_t) 1)];\n                        if (flag_86395 == (int8_t) 2) {\n                            readOffset_86392 = wave_sizze_86340 * -1;\n                        } else if (flag_86395 == (int8_t) 1) {\n                            readOffset_86392 -= wave_sizze_86340;\n                        }\n                        if (slt8((int8_t) 0, flag_86395)) {\n                            int64_t eta_p_86402 = aggr_86394;\n", "                            int64_t eta_p_86403 = prefix_86388;\n                            int64_t defunc_0_op_res_86404 = add64(eta_p_86402, eta_p_86403);\n                            \n                            prefix_86388 = defunc_0_op_res_86404;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_86338 == 0) {\n                    if (boundary_86358 == sext_i64_i32(segscan_tblock_sizze_77098 * chunk_sizze_86326)) {\n                        int64_t eta_p_86405 = prefix_86388;\n                        int64_t eta_p_86406 = acc_86378;\n                        int64_t defunc_0_op_res_86407 = add64(eta_p_86405, eta_p_86406);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_86333)[dynamic_id_86355] = defunc_0_op_res_86407;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_86329)[dynamic_id_86355] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_86345)[(int64_t) 4] = prefix_86388;\n                    acc_86378 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_86355 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_86388 = ((__local int64_t *) local_mem_86345)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_86408;\n            int64_t eta_p_86409;\n            int64_t eta_p_86411 = prefix_86388;\n            int64_t eta_p_86412 = acc_86378;\n            \n            if (slt32(local_tid_86338 * chunk_sizze_32b_86342, boundary_86358) && !block_new_sgm_86389) {\n                int64_t defunc_0_op_res_86413 = add64(eta_p_86411, eta_p_86412);\n                \n                eta_p_86408 = defunc_0_op_res_86413;\n            } else {\n                eta_p_86408 = acc_86378;\n            }", "\n            \n            int32_t stopping_point_86414 = segsizze_compact_86359 - srem32(local_tid_86338 * chunk_sizze_32b_86342 - 1 + segsizze_compact_86359 - boundary_86358, segsizze_compact_86359);\n            \n            for (int64_t i_86415 = 0; i_86415 < chunk_sizze_86326; i_86415++) {\n                if (slt32(sext_i64_i32(i_86415), stopping_point_86414 - 1)) {\n                    eta_p_86409 = private_mem_86360[i_86415];\n                    \n                    int64_t defunc_0_op_res_86410 = add64(eta_p_86408, eta_p_86409);\n                    \n                    private_mem_86360[i_86415] = defunc_0_op_res_86410;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_86416 = 0; i_86416 < chunk_sizze_86326; i_86416++) {\n                int64_t sharedIdx_86417 = sext_i32_i64(local_tid_86338) * chunk_sizze_86326 + i_86416;\n                int64_t tmp_86418 = private_mem_86360[i_86416];\n                \n                ((__local int64_t *) local_mem_86345)[sharedIdx_86417] = tmp_86418;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_86419 = 0; i_86419 < chunk_sizze_86326; i_86419++) {\n                int64_t flat_idx_86420 = thd_offset_86362 + i_86419 * segscan_tblock_sizze_77098;\n                int64_t slice_86421 = conc_tmp_62379;\n                int64_t gtid_77102 = flat_idx_86420;\n                int64_t remnant_86422 = flat_idx_86420 - gtid_77102;\n                \n                if (slt64(flat_idx_86420, conc_tmp_62379)) {\n                    int64_t tmp_86423 = ((__local int64_t *) local_mem_86345)[flat_idx_86420 - block_offset_86356];\n                    \n                    ((__global int64_t *) mem_82720)[gtid_77102] = tmp_86423;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_77098\n    #undef chunk_sizze_8",
                                    "6326\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11932zisegmap_74600_dim1, 1, 1)\nvoid get_num_neighbours_against_11932zisegmap_74600(__global int *global_failure, int8_t angle_t_37907, int64_t inf_37935, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942)\n{\n    #define segmap_tblock_sizze_74594 (get_num_neighbours_against_11932zisegmap_74600zisegmap_tblock_sizze_74594)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83159;\n    int32_t tblock_sizze_83162;\n    int32_t wave_sizze_83161;\n    int32_t block_id_83160;\n    int32_t global_tid_83158;\n    int64_t phys_tid_74600;\n    int64_t global_tid_83163;\n    int64_t slice_83164;\n    int64_t gtid_74599;\n    int64_t remnant_83165;\n    \n    local_tid_83159 = get_local_id(0);\n    tblock_sizze_83162 = get_local_size(0);\n    wave_sizze_83161 = LOCKSTEP_WIDTH;\n    block_id_83160 = get_tblock_id(0);\n    global_tid_83158 = block_id_83160 * tblock_sizze_83162 + local_tid_83159;\n    phys_tid_74600 = sext_i32_i64(global_tid_83158);\n    global_tid_83163 = sext_i32_i64(block_id_83160) * segmap_tblock_sizze_74594 + sext_i32_i64(local_tid_83159);\n    slice_83164 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;\n    gtid_74599 = global_tid_83163;\n    remnant_83165 = global_tid_83163 - gtid_74599;\n    if (slt64(gtid_74599, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941)) {\n        int64_t slice_77757;\n        double eta_p_74601;\n        double eta_p_74602;\n        double zt_res_74603;\n        double zt_res_74604;\n        double zs_res_74605;\n        double zs_res_74606;\n        double d_haversine_res_74607;\n        double d_haversine_res_74608;\n        double cos_res_74609;\n        \n        slice_77757 = inf_37935 + gtid_74599;\n        eta_p_74601 = ((__global double *) dat1_mem_81927)[slice_77757];\n        eta_p_74602 = ((__global double *) dat", "1_mem_81928)[slice_77757];\n        zt_res_74603 = 3.141592653589793 * eta_p_74601;\n        zt_res_74604 = 3.141592653589793 * eta_p_74602;\n        zs_res_74605 = zt_res_74603 / 180.0;\n        zs_res_74606 = zt_res_74604 / 180.0;\n        if (angle_t_37907 == (int8_t) 1) {\n            d_haversine_res_74607 = eta_p_74601;\n        } else {\n            d_haversine_res_74607 = zs_res_74605;\n        }\n        if (angle_t_37907 == (int8_t) 1) {\n            d_haversine_res_74608 = eta_p_74602;\n        } else {\n            d_haversine_res_74608 = zs_res_74606;\n        }\n        cos_res_74609 = futrts_cos64(d_haversine_res_74607);\n        ((__global double *) mem_81938)[gtid_74599] = d_haversine_res_74607;\n        ((__global double *) mem_81940)[gtid_74599] = d_haversine_res_74608;\n        ((__global double *) mem_81942)[gtid_74599] = cos_res_74609;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74594\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11932zisegmap_intrablock_78070_dim1, 1, 1)\nvoid get_num_neighbours_against_11932zisegmap_intrablock_78070(__global int *global_failure, int64_t n2_37900, double eps_37905, int8_t dist_t_37906, int8_t angle_t_37907, double radius_37908, int64_t inf_37935, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, int64_t ldim_78073, int64_t num_whole_tiles_78117, int64_t residual_input_78330, unsigned char cond_78331_bits, int64_t binop_x_78344, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932)\n{\n    bool cond_78331 = cond_78331_bits;\n    \n    #define tile_sizze_78072 (get_num_neighbours_against_11932zisegmap_intrablock_78070zitile_sizze_78072)\n    #define bytes_81972 (get_num_neighbours_against_11932zisegmap_intrablock_78070zibytes_81972)\n    \n    volatile __local unsigned char *color_83088_backing_1 = &shared_mem[0];\n    const int64_t color_83088_backing_1_offset = 0 + (bytes_819", "72 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83087_backing_0 = &shared_mem[color_83088_backing_1_offset];\n    const int64_t color_83087_backing_0_offset = color_83088_backing_1_offset + (bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83143;\n    int32_t tblock_sizze_83146;\n    int32_t wave_sizze_83145;\n    int32_t block_id_83144;\n    int32_t global_tid_83142;\n    int64_t gid_flat_78070;\n    int64_t slice_83148;\n    int64_t ltid_pre_83147;\n    int64_t remnant_83149;\n    int64_t slice_83150;\n    int64_t gid_78069;\n    int64_t remnant_83151;\n    __local unsigned char *color_83087;\n    __local unsigned char *color_83088;\n    int64_t binop_x_78088;\n    double mem_81950[1];\n    double mem_81954[1];\n    double mem_81958[1];\n    double mem_81962[1];\n    double mem_81966[1];\n    int64_t ltid_flat_78075;\n    int64_t ltid_78074;\n    int64_t gtid_78089;\n    bool cond_78090;\n    double pre_78091;\n    double pre_78092;\n    double pre_78093;\n    double pre_78094;\n    double pre_78095;\n    int64_t mem_81970[1];\n    int64_t ltid_flat_78119;\n    int64_t ltid_78118;\n    int64_t ext_mem_81980[1];\n    int64_t mem_param_81971[1];\n    int64_t mem_81988[1];\n    int64_t ext_mem_81989[1];\n    \n    local_tid_83143 = get_local_id(0);\n    tblock_sizze_83146 = get_local_size(0);\n    wave_sizze_83145 = LOCKSTEP_WIDTH;\n    block_id_83144 = get_tblock_id(0);\n    global_tid_83142 = block_id_83144 * tblock_sizze_83146 + local_tid_83143;\n    gid_flat_78070 = sext_i32_i64(block_id_83144);\n    slice_83148 = tile_sizze_78072;\n    ltid_pre_83147 = sext_i32_i64(local_tid_83143);\n    remnant_83149 = sext_i32_i64(local_tid_83143) - ltid_pre_83147;\n    slice_83150 = ldim_78073;\n    gid_78069 = sext_i32_i64(block_id_83144);\n    remnant_83151 = sext_i32_i64(block_id_83144) - gid_78069;\n    color_83087 = (__local unsigned char *)",
                                    " color_83087_backing_0;\n    color_83088 = (__local unsigned char *) color_83088_backing_1;\n    binop_x_78088 = gid_78069 * tile_sizze_78072;\n    ltid_flat_78075 = sext_i32_i64(local_tid_83143);\n    ltid_78074 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n    gtid_78089 = ltid_78074 + binop_x_78088;\n    cond_78090 = slt64(gtid_78089, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941);\n    if (cond_78090) {\n        int64_t slice_78096;\n        double eta_p_78097;\n        double eta_p_78099;\n        double zt_res_78100;\n        double zt_res_78101;\n        double zs_res_78102;\n        double zs_res_78103;\n        double d_haversine_res_78104;\n        double d_haversine_res_78105;\n        double cos_res_78106;\n        \n        slice_78096 = inf_37935 + gtid_78089;\n        eta_p_78097 = ((__global double *) dat1_mem_81927)[slice_78096];\n        eta_p_78099 = ((__global double *) dat1_mem_81928)[slice_78096];\n        zt_res_78100 = 3.141592653589793 * eta_p_78097;\n        zt_res_78101 = 3.141592653589793 * eta_p_78099;\n        zs_res_78102 = zt_res_78100 / 180.0;\n        zs_res_78103 = zt_res_78101 / 180.0;\n        if (angle_t_37907 == (int8_t) 1) {\n            d_haversine_res_78104 = eta_p_78097;\n        } else {\n            d_haversine_res_78104 = zs_res_78102;\n        }\n        if (angle_t_37907 == (int8_t) 1) {\n            d_haversine_res_78105 = eta_p_78099;\n        } else {\n            d_haversine_res_78105 = zs_res_78103;\n        }\n        cos_res_78106 = futrts_cos64(d_haversine_res_78104);\n        pre_78091 = eta_p_78097;\n        pre_78092 = eta_p_78099;\n        pre_78093 = d_haversine_res_78104;\n        pre_78094 = d_haversine_res_78105;\n        pre_78095 = cos_res_78106;\n    } else {\n        pre_78091 = 0.0;\n        pre_78092 = 0.0;\n        pre_78093 = 0.0;\n        pre_78094 = 0.0;\n        pre_78095 = 0.0;\n    }\n    mem_81950[(int64_t) 0] = pre_78091;\n    mem_81954[(int64_t) 0] = pre_78092;\n    mem_81958[(int64_t) 0] = pre_78093;\n    mem_81962[(int64_t) 0] = pre_78094;\n ", "   mem_81966[(int64_t) 0] = pre_78095;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78119 = sext_i32_i64(local_tid_83143);\n    ltid_78118 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n    mem_81970[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_2 = 0; i_2 < 1; i_2++)\n        mem_param_81971[i_2] = mem_81970[i_2];\n    for (int64_t tile_id_78125 = 0; tile_id_78125 < num_whole_tiles_78117; tile_id_78125++) {\n        int64_t binop_x_78219;\n        int64_t ltid_flat_78218;\n        int64_t ltid_78217;\n        int64_t j_78220;\n        bool cond_78228;\n        double pre1d_78229;\n        double pre1d_78230;\n        int64_t mem_81979[1];\n        int64_t ltid_flat_78237;\n        int64_t ltid_78236;\n        int64_t gtid_78239;\n        int64_t acc_78245;\n        bool cond_78246;\n        int64_t acc_78247;\n        int64_t mem_param_tmp_83152[1];\n        \n        binop_x_78219 = tile_sizze_78072 * tile_id_78125;\n        ltid_flat_78218 = sext_i32_i64(local_tid_83143);\n        ltid_78217 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        j_78220 = ltid_78217 + binop_x_78219;\n        cond_78228 = slt64(j_78220, n2_37900);\n        if (cond_78228) {\n            double tile_elem_78231;\n            double tile_elem_78232;\n            \n            tile_elem_78231 = ((__global double *) dat2_mem_81929)[j_78220];\n            tile_elem_78232 = ((__global double *) dat2_mem_81930)[j_78220];\n            pre1d_78229 = tile_elem_78231;\n            pre1d_78230 = tile_elem_78232;\n        } else {\n            pre1d_78229 = 0.0;\n            pre1d_78230 = 0.0;\n        }\n        ((__local double *) color_83088)[ltid_78217] = pre1d_78229;\n        ((__local double *) color_83087)[ltid_78217] = pre1d_78230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78237 = sext_i32_i64(local_tid_83143);\n        ltid_78236 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        gtid_78239 = binop_x_78088 + ltid_78236;\n        acc_78245", " = mem_param_81971[(int64_t) 0];\n        cond_78246 = slt64(gtid_78239, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941);\n        if (cond_78246) {\n            double eta_p_78240;\n            double eta_p_78241;\n            double d_haversine_res_78242;\n            double d_haversine_res_78243;\n            double cos_res_78244;\n            int64_t x_78248;\n            int64_t redout_81486;\n            \n            eta_p_78240 = mem_81950[(int64_t) 0];\n            eta_p_78241 = mem_81954[(int64_t) 0];\n            d_haversine_res_78242 = mem_81958[(int64_t) 0];\n            d_haversine_res_78243 = mem_81962[(int64_t) 0];\n            cos_res_78244 = mem_81966[(int64_t) 0];\n            redout_81486 = acc_78245;\n            for (int64_t i_81487 = 0; i_81487 < tile_sizze_78072; i_81487++) {\n                double eta_p_78249;\n                double eta_p_78250;\n                double dist_res_78251;\n                bool zlze_res_78284;\n                int64_t bool_res_78285;\n                int64_t zp_res_78288;\n                int64_t redout_tmp_83154;\n                \n                eta_p_78249 = ((__local double *) color_83088)[i_81487];\n                eta_p_78250 = ((__local double *) color_83087)[i_81487];\n                if (dist_t_37906 == (int8_t) 0) {\n                    bool zeze_res_78252;\n                    double d_euclidean_res_78253;\n                    \n                    zeze_res_78252 = eta_p_78240 == eta_p_78249;\n                    if (zeze_res_78252) {\n                        double zm_res_78254;\n                        double abs_res_78255;\n                        \n                        zm_res_78254 = eta_p_78241 - eta_p_78250;\n                        abs_res_78255 = fabs64(zm_res_78254);\n                        d_euclidean_res_78253 = abs_res_78255;\n                    } else {\n                        bool zeze_res_78256;\n                        double d_euclidean_res_f_res_78257;\n                        \n                        zeze_res_78256 = eta_p_",
                                    "78241 == eta_p_78250;\n                        if (zeze_res_78256) {\n                            double zm_res_78258;\n                            double abs_res_78259;\n                            \n                            zm_res_78258 = eta_p_78240 - eta_p_78249;\n                            abs_res_78259 = fabs64(zm_res_78258);\n                            d_euclidean_res_f_res_78257 = abs_res_78259;\n                        } else {\n                            double zm_res_78260;\n                            double zm_res_78261;\n                            double hypot_res_78262;\n                            \n                            zm_res_78260 = eta_p_78241 - eta_p_78250;\n                            zm_res_78261 = eta_p_78240 - eta_p_78249;\n                            hypot_res_78262 = futrts_hypot64(zm_res_78261, zm_res_78260);\n                            d_euclidean_res_f_res_78257 = hypot_res_78262;\n                        }\n                        d_euclidean_res_78253 = d_euclidean_res_f_res_78257;\n                    }\n                    dist_res_78251 = d_euclidean_res_78253;\n                } else {\n                    double d_haversine_res_78263;\n                    double d_haversine_res_78264;\n                    double zm_res_78269;\n                    double cos_res_78270;\n                    double zm_res_78271;\n                    double cos_res_78272;\n                    double zt_res_78273;\n                    double zm_res_78274;\n                    double zm_res_78275;\n                    double zt_res_78276;\n                    double zp_res_78277;\n                    double zs_res_78278;\n                    double min_res_78279;\n                    double zt_res_78280;\n                    double zm_res_78281;\n                    double acos_res_78282;\n                    double zt_res_78283;\n                    \n                    if (angle_t_37907 == (int8_t) 1) {\n                        d_haversine_res_78263 = eta_p_78249;\n           ", "             d_haversine_res_78264 = eta_p_78250;\n                    } else {\n                        double zt_res_78265;\n                        double zs_res_78266;\n                        double zt_res_78267;\n                        double zs_res_78268;\n                        \n                        zt_res_78265 = 3.141592653589793 * eta_p_78249;\n                        zs_res_78266 = zt_res_78265 / 180.0;\n                        zt_res_78267 = 3.141592653589793 * eta_p_78250;\n                        zs_res_78268 = zt_res_78267 / 180.0;\n                        d_haversine_res_78263 = zs_res_78266;\n                        d_haversine_res_78264 = zs_res_78268;\n                    }\n                    zm_res_78269 = d_haversine_res_78242 - d_haversine_res_78263;\n                    cos_res_78270 = futrts_cos64(zm_res_78269);\n                    zm_res_78271 = 1.0 - cos_res_78270;\n                    cos_res_78272 = futrts_cos64(d_haversine_res_78263);\n                    zt_res_78273 = cos_res_78244 * cos_res_78272;\n                    zm_res_78274 = d_haversine_res_78243 - d_haversine_res_78264;\n                    zm_res_78275 = 1.0 - zm_res_78274;\n                    zt_res_78276 = zt_res_78273 * zm_res_78275;\n                    zp_res_78277 = zm_res_78271 + zt_res_78276;\n                    zs_res_78278 = zp_res_78277 / 2.0;\n                    min_res_78279 = fmin64(1.0, zs_res_78278);\n                    zt_res_78280 = 2.0 * min_res_78279;\n                    zm_res_78281 = 1.0 - zt_res_78280;\n                    acos_res_78282 = futrts_acos64(zm_res_78281);\n                    zt_res_78283 = radius_37908 * acos_res_78282;\n                    dist_res_78251 = zt_res_78283;\n                }\n                zlze_res_78284 = dist_res_78251 <= eps_37905;\n                bool_res_78285 = btoi_bool_i64(zlze_res_78284);\n                zp_res_78288 = add64(bool_res_78285, redout_81486);\n                redout_tmp_83154 = zp_res_78288;\n                redout_81", "486 = redout_tmp_83154;\n            }\n            x_78248 = redout_81486;\n            acc_78247 = x_78248;\n        } else {\n            acc_78247 = acc_78245;\n        }\n        mem_81979[(int64_t) 0] = acc_78247;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_3 = 0; i_3 < 1; i_3++)\n            mem_param_tmp_83152[i_3] = mem_81979[i_3];\n        for (int32_t i_4 = 0; i_4 < 1; i_4++)\n            mem_param_81971[i_4] = mem_param_tmp_83152[i_4];\n    }\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        ext_mem_81980[i_5] = mem_param_81971[i_5];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_78331) {\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            ext_mem_81989[i_6] = ext_mem_81980[i_6];\n    } else {\n        int64_t ltid_flat_78333;\n        int64_t ltid_78332;\n        int64_t j_78345;\n        bool cond_78353;\n        double pre1d_78354;\n        double pre1d_78355;\n        int64_t ltid_flat_78365;\n        int64_t ltid_78364;\n        int64_t gtid_78372;\n        int64_t acc_78378;\n        bool cond_78379;\n        int64_t acc_78380;\n        \n        ltid_flat_78333 = sext_i32_i64(local_tid_83143);\n        ltid_78332 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        j_78345 = ltid_78332 + binop_x_78344;\n        cond_78353 = slt64(j_78345, n2_37900);\n        if (cond_78353) {\n            double tile_elem_78356;\n            double tile_elem_78357;\n            \n            tile_elem_78356 = ((__global double *) dat2_mem_81929)[j_78345];\n            tile_elem_78357 = ((__global double *) dat2_mem_81930)[j_78345];\n            pre1d_78354 = tile_elem_78356;\n            pre1d_78355 = tile_elem_78357;\n        } else {\n            pre1d_78354 = 0.0;\n            pre1d_78355 = 0.0;\n        }\n        ((__local double *) color_83088)[ltid_78332] = pre1d_78354;\n        ((__local double *) color_83087)[ltid_78332] = pre1d_78355;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78365 = sext_i32_i64(local_tid_83143);\n        ltid_78364 = sext_i32_i64(sext_i64_i",
                                    "32(ltid_pre_83147));\n        gtid_78372 = binop_x_78088 + ltid_78364;\n        acc_78378 = ext_mem_81980[(int64_t) 0];\n        cond_78379 = slt64(gtid_78372, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941);\n        if (cond_78379) {\n            double eta_p_78373;\n            double eta_p_78374;\n            double d_haversine_res_78375;\n            double d_haversine_res_78376;\n            double cos_res_78377;\n            int64_t x_78381;\n            int64_t redout_81488;\n            \n            eta_p_78373 = mem_81950[(int64_t) 0];\n            eta_p_78374 = mem_81954[(int64_t) 0];\n            d_haversine_res_78375 = mem_81958[(int64_t) 0];\n            d_haversine_res_78376 = mem_81962[(int64_t) 0];\n            cos_res_78377 = mem_81966[(int64_t) 0];\n            redout_81488 = acc_78378;\n            for (int64_t i_81489 = 0; i_81489 < residual_input_78330; i_81489++) {\n                double eta_p_78382;\n                double eta_p_78383;\n                double dist_res_78384;\n                bool zlze_res_78417;\n                int64_t bool_res_78418;\n                int64_t zp_res_78421;\n                int64_t redout_tmp_83155;\n                \n                eta_p_78382 = ((__local double *) color_83088)[i_81489];\n                eta_p_78383 = ((__local double *) color_83087)[i_81489];\n                if (dist_t_37906 == (int8_t) 0) {\n                    bool zeze_res_78385;\n                    double d_euclidean_res_78386;\n                    \n                    zeze_res_78385 = eta_p_78373 == eta_p_78382;\n                    if (zeze_res_78385) {\n                        double zm_res_78387;\n                        double abs_res_78388;\n                        \n                        zm_res_78387 = eta_p_78374 - eta_p_78383;\n                        abs_res_78388 = fabs64(zm_res_78387);\n                        d_euclidean_res_78386 = abs_res_78388;\n                    } else {\n                        bool zeze_res_78389;\n                        double d_euclidean_", "res_f_res_78390;\n                        \n                        zeze_res_78389 = eta_p_78374 == eta_p_78383;\n                        if (zeze_res_78389) {\n                            double zm_res_78391;\n                            double abs_res_78392;\n                            \n                            zm_res_78391 = eta_p_78373 - eta_p_78382;\n                            abs_res_78392 = fabs64(zm_res_78391);\n                            d_euclidean_res_f_res_78390 = abs_res_78392;\n                        } else {\n                            double zm_res_78393;\n                            double zm_res_78394;\n                            double hypot_res_78395;\n                            \n                            zm_res_78393 = eta_p_78374 - eta_p_78383;\n                            zm_res_78394 = eta_p_78373 - eta_p_78382;\n                            hypot_res_78395 = futrts_hypot64(zm_res_78394, zm_res_78393);\n                            d_euclidean_res_f_res_78390 = hypot_res_78395;\n                        }\n                        d_euclidean_res_78386 = d_euclidean_res_f_res_78390;\n                    }\n                    dist_res_78384 = d_euclidean_res_78386;\n                } else {\n                    double d_haversine_res_78396;\n                    double d_haversine_res_78397;\n                    double zm_res_78402;\n                    double cos_res_78403;\n                    double zm_res_78404;\n                    double cos_res_78405;\n                    double zt_res_78406;\n                    double zm_res_78407;\n                    double zm_res_78408;\n                    double zt_res_78409;\n                    double zp_res_78410;\n                    double zs_res_78411;\n                    double min_res_78412;\n                    double zt_res_78413;\n                    double zm_res_78414;\n                    double acos_res_78415;\n                    double zt_res_78416;\n                    \n                    if (angle_t_37907 ", "== (int8_t) 1) {\n                        d_haversine_res_78396 = eta_p_78382;\n                        d_haversine_res_78397 = eta_p_78383;\n                    } else {\n                        double zt_res_78398;\n                        double zs_res_78399;\n                        double zt_res_78400;\n                        double zs_res_78401;\n                        \n                        zt_res_78398 = 3.141592653589793 * eta_p_78382;\n                        zs_res_78399 = zt_res_78398 / 180.0;\n                        zt_res_78400 = 3.141592653589793 * eta_p_78383;\n                        zs_res_78401 = zt_res_78400 / 180.0;\n                        d_haversine_res_78396 = zs_res_78399;\n                        d_haversine_res_78397 = zs_res_78401;\n                    }\n                    zm_res_78402 = d_haversine_res_78375 - d_haversine_res_78396;\n                    cos_res_78403 = futrts_cos64(zm_res_78402);\n                    zm_res_78404 = 1.0 - cos_res_78403;\n                    cos_res_78405 = futrts_cos64(d_haversine_res_78396);\n                    zt_res_78406 = cos_res_78377 * cos_res_78405;\n                    zm_res_78407 = d_haversine_res_78376 - d_haversine_res_78397;\n                    zm_res_78408 = 1.0 - zm_res_78407;\n                    zt_res_78409 = zt_res_78406 * zm_res_78408;\n                    zp_res_78410 = zm_res_78404 + zt_res_78409;\n                    zs_res_78411 = zp_res_78410 / 2.0;\n                    min_res_78412 = fmin64(1.0, zs_res_78411);\n                    zt_res_78413 = 2.0 * min_res_78412;\n                    zm_res_78414 = 1.0 - zt_res_78413;\n                    acos_res_78415 = futrts_acos64(zm_res_78414);\n                    zt_res_78416 = radius_37908 * acos_res_78415;\n                    dist_res_78384 = zt_res_78416;\n                }\n                zlze_res_78417 = dist_res_78384 <= eps_37905;\n                bool_res_78418 = btoi_bool_i64(zlze_res_78417);\n                zp_res_78421 = add64(bool_res_78418, ",
                                    "redout_81488);\n                redout_tmp_83155 = zp_res_78421;\n                redout_81488 = redout_tmp_83155;\n            }\n            x_78381 = redout_81488;\n            acc_78380 = x_78381;\n        } else {\n            acc_78380 = acc_78378;\n        }\n        mem_81988[(int64_t) 0] = acc_78380;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            ext_mem_81989[i_7] = mem_81988[i_7];\n    }\n    if (slt64(sext_i32_i64(local_tid_83143) + tile_sizze_78072 * sext_i32_i64(block_id_83144), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941)) {\n        int64_t tmp_83156 = ext_mem_81989[(int64_t) 0];\n        \n        ((__global int64_t *) mem_81932)[inf_37935 + (sext_i32_i64(local_tid_83143) + tile_sizze_78072 * sext_i32_i64(block_id_83144))] = tmp_83156;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_78072\n    #undef bytes_81972\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11932zisegred_large_74618_dim1, 1, 1)\nvoid get_num_neighbours_against_11932zisegred_large_74618(__global int *global_failure, int64_t n2_37900, double eps_37905, int8_t dist_t_37906, int8_t angle_t_37907, double radius_37908, int64_t inf_37935, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, int64_t num_tblocks_74613, unsigned char x_81814_bits, int64_t blocks_per_segment_83195, int64_t q_83196, int64_t num_virtblocks_83197, int64_t threads_per_segment_83198, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942, __global unsigned char *segred_tmp_mem_83199, __global unsigned char *counters_mem_83201)\n{\n    bool x_81814 = x_81814_bits;\n    \n    #define segred_tblock_sizze_74612 (get_num_neighbours_against_11932zisegred_large_74618zisegred_tblock_sizze_74612)\n    #define chunk_sizze_83166 (get_num_neighbours_agains", "t_11932zisegred_large_74618zichunk_sizze_83166)\n    \n    volatile __local unsigned char *sync_arr_mem_83230_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_83230_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_83228_backing_0 = &shared_mem[sync_arr_mem_83230_backing_1_offset];\n    const int64_t red_arr_i64_mem_83228_backing_0_offset = sync_arr_mem_83230_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_74612 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74612, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83224;\n    int32_t tblock_sizze_83227;\n    int32_t wave_sizze_83226;\n    int32_t block_id_83225;\n    int32_t global_tid_83223;\n    int64_t phys_tid_74618;\n    __local unsigned char *red_arr_i64_mem_83228;\n    __local unsigned char *sync_arr_mem_83230;\n    int32_t phys_tblock_id_83232;\n    int32_t iterations_83233;\n    \n    local_tid_83224 = get_local_id(0);\n    tblock_sizze_83227 = get_local_size(0);\n    wave_sizze_83226 = LOCKSTEP_WIDTH;\n    block_id_83225 = get_tblock_id(0);\n    global_tid_83223 = block_id_83225 * tblock_sizze_83227 + local_tid_83224;\n    phys_tid_74618 = sext_i32_i64(global_tid_83223);\n    red_arr_i64_mem_83228 = (__local unsigned char *) red_arr_i64_mem_83228_backing_0;\n    sync_arr_mem_83230 = (__local unsigned char *) sync_arr_mem_83230_backing_1;\n    phys_tblock_id_83232 = get_tblock_id(0);\n    iterations_83233 = sdiv_up32(sext_i64_i32(num_virtblocks_83197) - phys_tblock_id_83232, sext_i64_i32(num_tblocks_74613));\n    for (int32_t i_83234 = 0; i_83234 < iterations_83233; i_83234++) {\n        int32_t virt_tblock_id_83235;\n        int64_t flat_segment_id_83236;\n        int64_t global_tid_83237;\n        int64_t slice_83238;\n        int64_t gtid_74616;\n        int64_t remnant_83239;\n        int64_t gtid_74617;\n        int64_t eta_p_block_res_acc_83240;\n        int64_t eta_p_74619;\n        int64_t eta_p_74620;\n        int64_", "t tblock_id_in_segment_83244;\n        int64_t block_base_offset_83245;\n        int32_t offset_83248;\n        int32_t skip_waves_83249;\n        int64_t eta_p_83241;\n        int64_t eta_p_83242;\n        \n        virt_tblock_id_83235 = phys_tblock_id_83232 + i_83234 * sext_i64_i32(num_tblocks_74613);\n        flat_segment_id_83236 = squot64(sext_i32_i64(virt_tblock_id_83235), blocks_per_segment_83195);\n        global_tid_83237 = srem64(sext_i32_i64(virt_tblock_id_83235) * segred_tblock_sizze_74612 + sext_i32_i64(local_tid_83224), threads_per_segment_83198);\n        slice_83238 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;\n        gtid_74616 = flat_segment_id_83236;\n        remnant_83239 = flat_segment_id_83236 - gtid_74616;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_83240 = (int64_t) 0;\n        }\n        tblock_id_in_segment_83244 = squot64(global_tid_83237, segred_tblock_sizze_74612);\n        block_base_offset_83245 = tblock_id_in_segment_83244 * q_83196 * segred_tblock_sizze_74612;\n        for (int64_t i_83246 = 0; i_83246 < q_83196; i_83246++) {\n            int64_t block_offset_83247 = block_base_offset_83245 + i_83246 * segred_tblock_sizze_74612;\n            \n            gtid_74617 = global_tid_83237 + threads_per_segment_83198 * i_83246;\n            if (slt64(gtid_74617, n2_37900)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_77755 = inf_37935 + gtid_74616;\n                        double eta_p_74627 = ((__global double *) dat2_mem_81929)[gtid_74617];\n                        double eta_p_74628 = ((__global double *) dat2_mem_81930)[gtid_74617];\n                        double d_haversine_res_74624;\n                        \n                        if (x_81814) {\n                            double x_81816 = ((__global double *) mem_81938)[gtid_74616];\n                            \n                ",
                                    "            d_haversine_res_74624 = x_81816;\n                        } else {\n                            d_haversine_res_74624 = 0.0;\n                        }\n                        \n                        double d_haversine_res_74625;\n                        \n                        if (x_81814) {\n                            double x_81818 = ((__global double *) mem_81940)[gtid_74616];\n                            \n                            d_haversine_res_74625 = x_81818;\n                        } else {\n                            d_haversine_res_74625 = 0.0;\n                        }\n                        \n                        double cos_res_74626;\n                        \n                        if (x_81814) {\n                            double x_81820 = ((__global double *) mem_81942)[gtid_74616];\n                            \n                            cos_res_74626 = x_81820;\n                        } else {\n                            cos_res_74626 = 0.0;\n                        }\n                        \n                        double dist_res_74629;\n                        \n                        if (dist_t_37906 == (int8_t) 0) {\n                            double eta_p_74622 = ((__global double *) dat1_mem_81927)[slice_77755];\n                            double eta_p_74623 = ((__global double *) dat1_mem_81928)[slice_77755];\n                            bool zeze_res_74630 = eta_p_74622 == eta_p_74627;\n                            double d_euclidean_res_74631;\n                            \n                            if (zeze_res_74630) {\n                                double zm_res_74632 = eta_p_74623 - eta_p_74628;\n                                double abs_res_74633 = fabs64(zm_res_74632);\n                                \n                                d_euclidean_res_74631 = abs_res_74633;\n                            } else {\n                                bool zeze_res_74634 = eta_p_74623 == eta_p_74628;\n                                do", "uble d_euclidean_res_f_res_74635;\n                                \n                                if (zeze_res_74634) {\n                                    double zm_res_74636 = eta_p_74622 - eta_p_74627;\n                                    double abs_res_74637 = fabs64(zm_res_74636);\n                                    \n                                    d_euclidean_res_f_res_74635 = abs_res_74637;\n                                } else {\n                                    double zm_res_74638 = eta_p_74623 - eta_p_74628;\n                                    double zm_res_74639 = eta_p_74622 - eta_p_74627;\n                                    double hypot_res_74640 = futrts_hypot64(zm_res_74639, zm_res_74638);\n                                    \n                                    d_euclidean_res_f_res_74635 = hypot_res_74640;\n                                }\n                                d_euclidean_res_74631 = d_euclidean_res_f_res_74635;\n                            }\n                            dist_res_74629 = d_euclidean_res_74631;\n                        } else {\n                            double d_haversine_res_74641;\n                            double d_haversine_res_74642;\n                            \n                            if (angle_t_37907 == (int8_t) 1) {\n                                d_haversine_res_74641 = eta_p_74627;\n                                d_haversine_res_74642 = eta_p_74628;\n                            } else {\n                                double zt_res_74643 = 3.141592653589793 * eta_p_74627;\n                                double zs_res_74644 = zt_res_74643 / 180.0;\n                                double zt_res_74645 = 3.141592653589793 * eta_p_74628;\n                                double zs_res_74646 = zt_res_74645 / 180.0;\n                                \n                                d_haversine_res_74641 = zs_res_74644;\n                                d_haversine_res_74642 = zs_res_74646;\n                           ", " }\n                            \n                            double zm_res_74647 = d_haversine_res_74624 - d_haversine_res_74641;\n                            double cos_res_74648 = futrts_cos64(zm_res_74647);\n                            double zm_res_74649 = 1.0 - cos_res_74648;\n                            double cos_res_74650 = futrts_cos64(d_haversine_res_74641);\n                            double zt_res_74651 = cos_res_74626 * cos_res_74650;\n                            double zm_res_74652 = d_haversine_res_74625 - d_haversine_res_74642;\n                            double zm_res_74653 = 1.0 - zm_res_74652;\n                            double zt_res_74654 = zt_res_74651 * zm_res_74653;\n                            double zp_res_74655 = zm_res_74649 + zt_res_74654;\n                            double zs_res_74656 = zp_res_74655 / 2.0;\n                            double min_res_74657 = fmin64(1.0, zs_res_74656);\n                            double zt_res_74658 = 2.0 * min_res_74657;\n                            double zm_res_74659 = 1.0 - zt_res_74658;\n                            double acos_res_74660 = futrts_acos64(zm_res_74659);\n                            double zt_res_74661 = radius_37908 * acos_res_74660;\n                            \n                            dist_res_74629 = zt_res_74661;\n                        }\n                        \n                        bool zlze_res_74662 = dist_res_74629 <= eps_37905;\n                        int64_t bool_res_74663 = btoi_bool_i64(zlze_res_74662);\n                        \n                        // load accumulator(s)\n                        {\n                            eta_p_74619 = eta_p_block_res_acc_83240;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_74620 = bool_res_74663;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            int64_t zp_res_74621 = a",
                                    "dd64(eta_p_74619, eta_p_74620);\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_83240 = zp_res_74621;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_block_res_acc_83240;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_83249 = 1;\n        offset_83248 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_83224, sext_i64_i32(segred_tblock_sizze_74612))) {\n                eta_p_83241 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n            }\n        }\n        offset_83248 = 1;\n        while (slt32(offset_83248, wave_sizze_83226)) {\n            if (slt32(local_tid_83224 + offset_83248, sext_i64_i32(segred_tblock_sizze_74612)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) & (2 * offset_83248 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_83242 = ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n                }\n                // apply reduction operation\n                {\n                    int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                    \n                    eta_p_83241 = zp_res_83243;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                }\n            }\n            offset_83248 *= 2;\n        }\n        while (slt32(skip_waves_8", "3249, squot32(sext_i64_i32(segred_tblock_sizze_74612) + wave_sizze_83226 - 1, wave_sizze_83226))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_83248 = skip_waves_83249 * wave_sizze_83226;\n            if (slt32(local_tid_83224 + offset_83248, sext_i64_i32(segred_tblock_sizze_74612)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) == 0 && (squot32(local_tid_83224, wave_sizze_83226) & (2 * skip_waves_83249 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_83242 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n                }\n                // apply reduction operation\n                {\n                    int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                    \n                    eta_p_83241 = zp_res_83243;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                }\n            }\n            skip_waves_83249 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_83224) == (int64_t) 0) {\n                eta_p_block_res_acc_83240 = eta_p_83241;\n            } else {\n                eta_p_block_res_acc_83240 = (int64_t) 0;\n            }\n        }\n        if (blocks_per_segment_83195 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_83224 == 0) {\n                    ((__global int64_t *) mem_81932)[inf_37935 + gtid_74616] = eta_p_block_res_acc_83240;\n                }\n            }\n        } else {\n            int32_t old_counter_83250;\n            bool is_last_block_83251;\n            \n            // first thread in block saves block re", "sult to global memory\n            {\n                if (local_tid_83224 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_83199)[sext_i32_i64(virt_tblock_id_83235)] = eta_p_block_res_acc_83240;\n                    mem_fence_global();\n                    old_counter_83250 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83201)[srem64(flat_segment_id_83236, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_83230)[(int64_t) 0] = old_counter_83250 == sext_i64_i32(blocks_per_segment_83195 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_83251 = ((__local bool *) sync_arr_mem_83230)[(int64_t) 0];\n            if (is_last_block_83251) {\n                if (local_tid_83224 == 0) {\n                    old_counter_83250 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83201)[srem64(flat_segment_id_83236, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_83195));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_83252 = sdiv_up64(blocks_per_segment_83195, segred_tblock_sizze_74612);\n                    \n                    eta_p_74619 = (int64_t) 0;\n                    for (int64_t i_83253 = 0; i_83253 < read_per_thread_83252; i_83253++) {\n                        int64_t block_res_id_83254 = sext_i32_i64(local_tid_83224) * read_per_thread_83252 + i_83253;\n                        int64_t index_of_block_res_83255 = flat_segment_id_83236 * blocks_per_segment_83195 + block_res_id_83254;\n                        \n                        if (slt64(block_res_id_83254, blocks_per_segment_83195)) {\n                            eta_p_74620 = ((__global int64_t *) segred_tmp_mem_83199)[index_of_block_res_83255];\n                            \n                            int64_t zp_res_74621 = add64(eta_p_74619, eta_p_74620);\n     ",
                                    "                       \n                            eta_p_74619 = zp_res_74621;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_74619;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_83256;\n                    int32_t skip_waves_83257 = 1;\n                    int64_t eta_p_83241;\n                    int64_t eta_p_83242;\n                    \n                    offset_83256 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_83224, sext_i64_i32(segred_tblock_sizze_74612))) {\n                            eta_p_83241 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                        }\n                    }\n                    offset_83256 = 1;\n                    while (slt32(offset_83256, wave_sizze_83226)) {\n                        if (slt32(local_tid_83224 + offset_83256, sext_i64_i32(segred_tblock_sizze_74612)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) & (2 * offset_83256 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_83242 = ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                                \n                                eta_p_83241 = zp_res_83243;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *)", " red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                            }\n                        }\n                        offset_83256 *= 2;\n                    }\n                    while (slt32(skip_waves_83257, squot32(sext_i64_i32(segred_tblock_sizze_74612) + wave_sizze_83226 - 1, wave_sizze_83226))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_83256 = skip_waves_83257 * wave_sizze_83226;\n                        if (slt32(local_tid_83224 + offset_83256, sext_i64_i32(segred_tblock_sizze_74612)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) == 0 && (squot32(local_tid_83224, wave_sizze_83226) & (2 * skip_waves_83257 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_83242 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                                \n                                eta_p_83241 = zp_res_83243;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                            }\n                        }\n                        skip_waves_83257 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_83224 == 0) {\n                            ((__global int64_t *) mem_81932)[inf_37935 + gtid_74616] = eta_p_83241;\n                        }\n                    }\n                }\n            }\n   ", "     }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_74612\n    #undef chunk_sizze_83166\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11932zisegred_small_74618_dim1, 1, 1)\nvoid get_num_neighbours_against_11932zisegred_small_74618(__global int *global_failure, int64_t n2_37900, double eps_37905, int8_t dist_t_37906, int8_t angle_t_37907, double radius_37908, int64_t inf_37935, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, int64_t num_tblocks_74613, unsigned char x_81814_bits, int64_t segment_sizze_nonzzero_83167, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942)\n{\n    bool x_81814 = x_81814_bits;\n    \n    #define segred_tblock_sizze_74612 (get_num_neighbours_against_11932zisegred_small_74618zisegred_tblock_sizze_74612)\n    \n    volatile __local unsigned char *red_arr_i64_mem_83174_backing_0 = &shared_mem[0];\n    const int64_t red_arr_i64_mem_83174_backing_0_offset = 0 + ((int64_t) 8 * segred_tblock_sizze_74612 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74612, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83170;\n    int32_t tblock_sizze_83173;\n    int32_t wave_sizze_83172;\n    int32_t block_id_83171;\n    int32_t global_tid_83169;\n    int64_t phys_tid_74618;\n    __local unsigned char *red_arr_i64_mem_83174;\n    int32_t phys_tblock_id_83176;\n    int32_t iterations_83177;\n    \n    local_tid_83170 = get_local_id(0);\n    tblock_sizze_83173 = get_local_size(0);\n    wave_sizze_83172 = LOCKSTEP_WIDTH;\n    block_id_83171 = get_tblock_id(0);\n    global_tid_83169 = block_id_83171 * tblock_sizze_83173 + local_tid_83170;\n    phys_tid_74618 = sext_i32_i64(global_tid_8316",
                                    "9);\n    red_arr_i64_mem_83174 = (__local unsigned char *) red_arr_i64_mem_83174_backing_0;\n    phys_tblock_id_83176 = get_tblock_id(0);\n    iterations_83177 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167))) - phys_tblock_id_83176, sext_i64_i32(num_tblocks_74613));\n    for (int32_t i_83178 = 0; i_83178 < iterations_83177; i_83178++) {\n        int32_t virt_tblock_id_83179;\n        int64_t slice_83180;\n        int64_t gtid_74616;\n        int64_t remnant_83181;\n        int64_t gtid_74617;\n        \n        virt_tblock_id_83179 = phys_tblock_id_83176 + i_83178 * sext_i64_i32(num_tblocks_74613);\n        slice_83180 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;\n        gtid_74616 = squot64(sext_i32_i64(local_tid_83170), segment_sizze_nonzzero_83167) + sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167);\n        remnant_83181 = squot64(sext_i32_i64(local_tid_83170), segment_sizze_nonzzero_83167) + sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167) - gtid_74616;\n        gtid_74617 = srem64(sext_i32_i64(local_tid_83170), n2_37900);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, n2_37900) && (slt64(gtid_74616, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941) && slt64(sext_i32_i64(local_tid_83170), n2_37900 * squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167)))) {\n                // apply map function\n                {\n                    int64_t slice_77755 = inf_37935 + gtid_74616;\n                    double eta_p_74627 = ((__global double *) dat2_mem_81929)[gtid_74617];\n                    double eta_p_74628 = ((__global double *) dat2_mem_81930)[gtid_74617];\n                    double d_haversine_res_74624;\n                    \n                    if (x_81814) {\n                        double x_81816 = ((__global double *) mem_81938)[gtid_74", "616];\n                        \n                        d_haversine_res_74624 = x_81816;\n                    } else {\n                        d_haversine_res_74624 = 0.0;\n                    }\n                    \n                    double d_haversine_res_74625;\n                    \n                    if (x_81814) {\n                        double x_81818 = ((__global double *) mem_81940)[gtid_74616];\n                        \n                        d_haversine_res_74625 = x_81818;\n                    } else {\n                        d_haversine_res_74625 = 0.0;\n                    }\n                    \n                    double cos_res_74626;\n                    \n                    if (x_81814) {\n                        double x_81820 = ((__global double *) mem_81942)[gtid_74616];\n                        \n                        cos_res_74626 = x_81820;\n                    } else {\n                        cos_res_74626 = 0.0;\n                    }\n                    \n                    double dist_res_74629;\n                    \n                    if (dist_t_37906 == (int8_t) 0) {\n                        double eta_p_74622 = ((__global double *) dat1_mem_81927)[slice_77755];\n                        double eta_p_74623 = ((__global double *) dat1_mem_81928)[slice_77755];\n                        bool zeze_res_74630 = eta_p_74622 == eta_p_74627;\n                        double d_euclidean_res_74631;\n                        \n                        if (zeze_res_74630) {\n                            double zm_res_74632 = eta_p_74623 - eta_p_74628;\n                            double abs_res_74633 = fabs64(zm_res_74632);\n                            \n                            d_euclidean_res_74631 = abs_res_74633;\n                        } else {\n                            bool zeze_res_74634 = eta_p_74623 == eta_p_74628;\n                            double d_euclidean_res_f_res_74635;\n                            \n                            if (zeze_res_74634) {\n    ", "                            double zm_res_74636 = eta_p_74622 - eta_p_74627;\n                                double abs_res_74637 = fabs64(zm_res_74636);\n                                \n                                d_euclidean_res_f_res_74635 = abs_res_74637;\n                            } else {\n                                double zm_res_74638 = eta_p_74623 - eta_p_74628;\n                                double zm_res_74639 = eta_p_74622 - eta_p_74627;\n                                double hypot_res_74640 = futrts_hypot64(zm_res_74639, zm_res_74638);\n                                \n                                d_euclidean_res_f_res_74635 = hypot_res_74640;\n                            }\n                            d_euclidean_res_74631 = d_euclidean_res_f_res_74635;\n                        }\n                        dist_res_74629 = d_euclidean_res_74631;\n                    } else {\n                        double d_haversine_res_74641;\n                        double d_haversine_res_74642;\n                        \n                        if (angle_t_37907 == (int8_t) 1) {\n                            d_haversine_res_74641 = eta_p_74627;\n                            d_haversine_res_74642 = eta_p_74628;\n                        } else {\n                            double zt_res_74643 = 3.141592653589793 * eta_p_74627;\n                            double zs_res_74644 = zt_res_74643 / 180.0;\n                            double zt_res_74645 = 3.141592653589793 * eta_p_74628;\n                            double zs_res_74646 = zt_res_74645 / 180.0;\n                            \n                            d_haversine_res_74641 = zs_res_74644;\n                            d_haversine_res_74642 = zs_res_74646;\n                        }\n                        \n                        double zm_res_74647 = d_haversine_res_74624 - d_haversine_res_74641;\n                        double cos_res_74648 = futrts_cos64(zm_res_74647);\n                        double zm_res_74649 = 1.0",
                                    " - cos_res_74648;\n                        double cos_res_74650 = futrts_cos64(d_haversine_res_74641);\n                        double zt_res_74651 = cos_res_74626 * cos_res_74650;\n                        double zm_res_74652 = d_haversine_res_74625 - d_haversine_res_74642;\n                        double zm_res_74653 = 1.0 - zm_res_74652;\n                        double zt_res_74654 = zt_res_74651 * zm_res_74653;\n                        double zp_res_74655 = zm_res_74649 + zt_res_74654;\n                        double zs_res_74656 = zp_res_74655 / 2.0;\n                        double min_res_74657 = fmin64(1.0, zs_res_74656);\n                        double zt_res_74658 = 2.0 * min_res_74657;\n                        double zm_res_74659 = 1.0 - zt_res_74658;\n                        double acos_res_74660 = futrts_acos64(zm_res_74659);\n                        double zt_res_74661 = radius_37908 * acos_res_74660;\n                        \n                        dist_res_74629 = zt_res_74661;\n                    }\n                    \n                    bool zlze_res_74662 = dist_res_74629 <= eps_37905;\n                    int64_t bool_res_74663 = btoi_bool_i64(zlze_res_74662);\n                    \n                    // save results to be reduced\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = bool_res_74663;\n                    }\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, n2_37900)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_74619;\n                int64_t eta_p_74620;\n                int64_t eta_p_83182;\n                int64_t eta_p_83183;\n                bool ltid_in_bounds_83185 = slt64(sext_i32_i64(local_tid_83170), n2_37900 * squot64(segred_tblo", "ck_sizze_74612, segment_sizze_nonzzero_83167));\n                int32_t skip_threads_83186;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_83185) {\n                        eta_p_74620 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)];\n                        if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 0) {\n                            eta_p_74619 = eta_p_74620;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83186 = 1;\n                    while (slt32(skip_threads_83186, 32)) {\n                        bool thread_active_83187 = sle32(skip_threads_83186, local_tid_83170 - squot32(local_tid_83170, 32) * 32) && ltid_in_bounds_83185;\n                        \n                        if (thread_active_83187) {\n                            // read operands\n                            {\n                                eta_p_74619 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170) - sext_i32_i64(skip_threads_83186)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_83188 = slt64(srem64(sext_i32_i64(local_tid_83170), n2_37900), sext_i32_i64(local_tid_83170) - sext_i32_i64(local_tid_83170 - skip_threads_83186));\n                            \n                            if (thread_active_83187 && inactive_83188) {\n                                eta_p_74619 = eta_p_74620;\n                            }\n                            if (thread_active_83187) {\n                                if (!inactive_83188) {\n                                    int64_t zp_res_74621 = add64(eta_p_74619, eta_p_74620);\n                                    \n                                    et", "a_p_74619 = zp_res_74621;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_83172, skip_threads_83186)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83187) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74619;\n                                eta_p_74620 = eta_p_74619;\n                            }\n                        }\n                        if (sle32(wave_sizze_83172, skip_threads_83186)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83186 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 31 && ltid_in_bounds_83185) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(squot32(local_tid_83170, 32))] = eta_p_74619;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_83189;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185) {\n                            eta_p_83183 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)];\n                            if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 0) {\n                                eta_p_83182 = eta_p_83183;\n     ",
                                    "                       }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_83189 = 1;\n                        while (slt32(skip_threads_83189, 32)) {\n                            bool thread_active_83190 = sle32(skip_threads_83189, local_tid_83170 - squot32(local_tid_83170, 32) * 32) && (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185);\n                            \n                            if (thread_active_83190) {\n                                // read operands\n                                {\n                                    eta_p_83182 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170) - sext_i32_i64(skip_threads_83189)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_83191 = slt64(srem64(sext_i32_i64(local_tid_83170 * 32 + 32 - 1), n2_37900), sext_i32_i64(local_tid_83170 * 32 + 32 - 1) - sext_i32_i64((local_tid_83170 - skip_threads_83189) * 32 + 32 - 1));\n                                \n                                if (thread_active_83190 && inactive_83191) {\n                                    eta_p_83182 = eta_p_83183;\n                                }\n                                if (thread_active_83190) {\n                                    if (!inactive_83191) {\n                                        int64_t zp_res_83184 = add64(eta_p_83182, eta_p_83183);\n                                        \n                                        eta_p_83182 = zp_res_83184;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_83172, skip_threads_83189)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n      ", "                      if (thread_active_83190) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_83182;\n                                    eta_p_83183 = eta_p_83182;\n                                }\n                            }\n                            if (sle32(wave_sizze_83172, skip_threads_83189)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_83189 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_83192 = squot32(local_tid_83170, 32) == 0 || !ltid_in_bounds_83185;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_83192) {\n                            eta_p_74620 = eta_p_74619;\n                            eta_p_74619 = ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(squot32(local_tid_83170, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_83193 = slt64(srem64(sext_i32_i64(local_tid_83170), n2_37900), sext_i32_i64(local_tid_83170) - sext_i32_i64(squot32(local_tid_83170, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_83192) {\n                            if (inactive_83193) {\n                                eta_p_74619 = eta_p_74620;\n                            }\n                        }\n                        if (!no_carry_in_83192) {\n                            if (!inactive_83193) {\n                                int64_t zp_res_74621 = add64(eta_p_74619, eta_p_74620);\n                     ", "           \n                                eta_p_74619 = zp_res_74621;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_83192) {\n                            ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74619;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185) {\n                        ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74620;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167) + sext_i32_i64(local_tid_83170), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941) && slt64(sext_i32_i64(local_tid_83170), squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167))) {\n                int64_t tmp_83194 = ((__local int64_t *) red_arr_i64_mem_83174)[(sext_i32_i64(local_tid_83170) + (int64_t) 1) * segment_sizze_nonzzero_83167 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_81932)[inf_37935 + (sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167) + sext_i32_i64(local_tid_83170))] = tmp_83194;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_74612\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11935zisegmap_74866_dim1, 1, 1)\nvoid get_num_neighbours_against_11935zisegmap_74",
                                    "866(__global int *global_failure, int8_t angle_t_38168, int64_t inf_38196, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942)\n{\n    #define segmap_tblock_sizze_74860 (get_num_neighbours_against_11935zisegmap_74866zisegmap_tblock_sizze_74860)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83159;\n    int32_t tblock_sizze_83162;\n    int32_t wave_sizze_83161;\n    int32_t block_id_83160;\n    int32_t global_tid_83158;\n    int64_t phys_tid_74866;\n    int64_t global_tid_83163;\n    int64_t slice_83164;\n    int64_t gtid_74865;\n    int64_t remnant_83165;\n    \n    local_tid_83159 = get_local_id(0);\n    tblock_sizze_83162 = get_local_size(0);\n    wave_sizze_83161 = LOCKSTEP_WIDTH;\n    block_id_83160 = get_tblock_id(0);\n    global_tid_83158 = block_id_83160 * tblock_sizze_83162 + local_tid_83159;\n    phys_tid_74866 = sext_i32_i64(global_tid_83158);\n    global_tid_83163 = sext_i32_i64(block_id_83160) * segmap_tblock_sizze_74860 + sext_i32_i64(local_tid_83159);\n    slice_83164 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;\n    gtid_74865 = global_tid_83163;\n    remnant_83165 = global_tid_83163 - gtid_74865;\n    if (slt64(gtid_74865, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202)) {\n        int64_t slice_77757;\n        double eta_p_74867;\n        double eta_p_74868;\n        double zt_res_74869;\n        double zt_res_74870;\n        double zs_res_74871;\n        double zs_res_74872;\n        double d_haversine_res_74873;\n        double d_haversine_res_74874;\n        double cos_res_74875;\n        \n        slice_77757 = inf_38196 + gtid_74865;\n        eta_p_74867 = ((__global double *) dat1_mem_81927)[slice_77757];\n        eta_p_74868 = ((__global double *) dat1_mem_81928)[slice_77757];\n        zt_res_74869 = 3.141592653589793 * eta_p_74867;\n        zt_res_74870 = 3.141592653589793 * eta_p_748", "68;\n        zs_res_74871 = zt_res_74869 / 180.0;\n        zs_res_74872 = zt_res_74870 / 180.0;\n        if (angle_t_38168 == (int8_t) 1) {\n            d_haversine_res_74873 = eta_p_74867;\n        } else {\n            d_haversine_res_74873 = zs_res_74871;\n        }\n        if (angle_t_38168 == (int8_t) 1) {\n            d_haversine_res_74874 = eta_p_74868;\n        } else {\n            d_haversine_res_74874 = zs_res_74872;\n        }\n        cos_res_74875 = futrts_cos64(d_haversine_res_74873);\n        ((__global double *) mem_81938)[gtid_74865] = d_haversine_res_74873;\n        ((__global double *) mem_81940)[gtid_74865] = d_haversine_res_74874;\n        ((__global double *) mem_81942)[gtid_74865] = cos_res_74875;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74860\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11935zisegmap_intrablock_78070_dim1, 1, 1)\nvoid get_num_neighbours_against_11935zisegmap_intrablock_78070(__global int *global_failure, int64_t n2_38161, double eps_38166, int8_t dist_t_38167, int8_t angle_t_38168, double radius_38169, int64_t inf_38196, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, int64_t ldim_78073, int64_t num_whole_tiles_78117, int64_t residual_input_78330, unsigned char cond_78331_bits, int64_t binop_x_78344, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932)\n{\n    bool cond_78331 = cond_78331_bits;\n    \n    #define tile_sizze_78072 (get_num_neighbours_against_11935zisegmap_intrablock_78070zitile_sizze_78072)\n    #define bytes_81972 (get_num_neighbours_against_11935zisegmap_intrablock_78070zibytes_81972)\n    \n    volatile __local unsigned char *color_83088_backing_1 = &shared_mem[0];\n    const int64_t color_83088_backing_1_offset = 0 + (bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83087_backing_0 = ", "&shared_mem[color_83088_backing_1_offset];\n    const int64_t color_83087_backing_0_offset = color_83088_backing_1_offset + (bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83143;\n    int32_t tblock_sizze_83146;\n    int32_t wave_sizze_83145;\n    int32_t block_id_83144;\n    int32_t global_tid_83142;\n    int64_t gid_flat_78070;\n    int64_t slice_83148;\n    int64_t ltid_pre_83147;\n    int64_t remnant_83149;\n    int64_t slice_83150;\n    int64_t gid_78069;\n    int64_t remnant_83151;\n    __local unsigned char *color_83087;\n    __local unsigned char *color_83088;\n    int64_t binop_x_78088;\n    double mem_81950[1];\n    double mem_81954[1];\n    double mem_81958[1];\n    double mem_81962[1];\n    double mem_81966[1];\n    int64_t ltid_flat_78075;\n    int64_t ltid_78074;\n    int64_t gtid_78089;\n    bool cond_78090;\n    double pre_78091;\n    double pre_78092;\n    double pre_78093;\n    double pre_78094;\n    double pre_78095;\n    int64_t mem_81970[1];\n    int64_t ltid_flat_78119;\n    int64_t ltid_78118;\n    int64_t ext_mem_81980[1];\n    int64_t mem_param_81971[1];\n    int64_t mem_81988[1];\n    int64_t ext_mem_81989[1];\n    \n    local_tid_83143 = get_local_id(0);\n    tblock_sizze_83146 = get_local_size(0);\n    wave_sizze_83145 = LOCKSTEP_WIDTH;\n    block_id_83144 = get_tblock_id(0);\n    global_tid_83142 = block_id_83144 * tblock_sizze_83146 + local_tid_83143;\n    gid_flat_78070 = sext_i32_i64(block_id_83144);\n    slice_83148 = tile_sizze_78072;\n    ltid_pre_83147 = sext_i32_i64(local_tid_83143);\n    remnant_83149 = sext_i32_i64(local_tid_83143) - ltid_pre_83147;\n    slice_83150 = ldim_78073;\n    gid_78069 = sext_i32_i64(block_id_83144);\n    remnant_83151 = sext_i32_i64(block_id_83144) - gid_78069;\n    color_83087 = (__local unsigned char *) color_83087_backing_0;\n    color_83088 = (__local unsigned char *) color_83088_backing_1;\n    binop_x_78088 = gid_78069 * tile_sizze_7",
                                    "8072;\n    ltid_flat_78075 = sext_i32_i64(local_tid_83143);\n    ltid_78074 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n    gtid_78089 = ltid_78074 + binop_x_78088;\n    cond_78090 = slt64(gtid_78089, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202);\n    if (cond_78090) {\n        int64_t slice_78096;\n        double eta_p_78097;\n        double eta_p_78099;\n        double zt_res_78100;\n        double zt_res_78101;\n        double zs_res_78102;\n        double zs_res_78103;\n        double d_haversine_res_78104;\n        double d_haversine_res_78105;\n        double cos_res_78106;\n        \n        slice_78096 = inf_38196 + gtid_78089;\n        eta_p_78097 = ((__global double *) dat1_mem_81927)[slice_78096];\n        eta_p_78099 = ((__global double *) dat1_mem_81928)[slice_78096];\n        zt_res_78100 = 3.141592653589793 * eta_p_78097;\n        zt_res_78101 = 3.141592653589793 * eta_p_78099;\n        zs_res_78102 = zt_res_78100 / 180.0;\n        zs_res_78103 = zt_res_78101 / 180.0;\n        if (angle_t_38168 == (int8_t) 1) {\n            d_haversine_res_78104 = eta_p_78097;\n        } else {\n            d_haversine_res_78104 = zs_res_78102;\n        }\n        if (angle_t_38168 == (int8_t) 1) {\n            d_haversine_res_78105 = eta_p_78099;\n        } else {\n            d_haversine_res_78105 = zs_res_78103;\n        }\n        cos_res_78106 = futrts_cos64(d_haversine_res_78104);\n        pre_78091 = eta_p_78097;\n        pre_78092 = eta_p_78099;\n        pre_78093 = d_haversine_res_78104;\n        pre_78094 = d_haversine_res_78105;\n        pre_78095 = cos_res_78106;\n    } else {\n        pre_78091 = 0.0;\n        pre_78092 = 0.0;\n        pre_78093 = 0.0;\n        pre_78094 = 0.0;\n        pre_78095 = 0.0;\n    }\n    mem_81950[(int64_t) 0] = pre_78091;\n    mem_81954[(int64_t) 0] = pre_78092;\n    mem_81958[(int64_t) 0] = pre_78093;\n    mem_81962[(int64_t) 0] = pre_78094;\n    mem_81966[(int64_t) 0] = pre_78095;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_78119 = sext_i32_i64(local_tid_83143);\n    ltid_", "78118 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n    mem_81970[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_2 = 0; i_2 < 1; i_2++)\n        mem_param_81971[i_2] = mem_81970[i_2];\n    for (int64_t tile_id_78125 = 0; tile_id_78125 < num_whole_tiles_78117; tile_id_78125++) {\n        int64_t binop_x_78219;\n        int64_t ltid_flat_78218;\n        int64_t ltid_78217;\n        int64_t j_78220;\n        bool cond_78228;\n        double pre1d_78229;\n        double pre1d_78230;\n        int64_t mem_81979[1];\n        int64_t ltid_flat_78237;\n        int64_t ltid_78236;\n        int64_t gtid_78239;\n        int64_t acc_78245;\n        bool cond_78246;\n        int64_t acc_78247;\n        int64_t mem_param_tmp_83152[1];\n        \n        binop_x_78219 = tile_sizze_78072 * tile_id_78125;\n        ltid_flat_78218 = sext_i32_i64(local_tid_83143);\n        ltid_78217 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        j_78220 = ltid_78217 + binop_x_78219;\n        cond_78228 = slt64(j_78220, n2_38161);\n        if (cond_78228) {\n            double tile_elem_78231;\n            double tile_elem_78232;\n            \n            tile_elem_78231 = ((__global double *) dat2_mem_81929)[j_78220];\n            tile_elem_78232 = ((__global double *) dat2_mem_81930)[j_78220];\n            pre1d_78229 = tile_elem_78231;\n            pre1d_78230 = tile_elem_78232;\n        } else {\n            pre1d_78229 = 0.0;\n            pre1d_78230 = 0.0;\n        }\n        ((__local double *) color_83088)[ltid_78217] = pre1d_78229;\n        ((__local double *) color_83087)[ltid_78217] = pre1d_78230;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78237 = sext_i32_i64(local_tid_83143);\n        ltid_78236 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        gtid_78239 = binop_x_78088 + ltid_78236;\n        acc_78245 = mem_param_81971[(int64_t) 0];\n        cond_78246 = slt64(gtid_78239, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202);\n        if (cond_7824", "6) {\n            double eta_p_78240;\n            double eta_p_78241;\n            double d_haversine_res_78242;\n            double d_haversine_res_78243;\n            double cos_res_78244;\n            int64_t x_78248;\n            int64_t redout_81486;\n            \n            eta_p_78240 = mem_81950[(int64_t) 0];\n            eta_p_78241 = mem_81954[(int64_t) 0];\n            d_haversine_res_78242 = mem_81958[(int64_t) 0];\n            d_haversine_res_78243 = mem_81962[(int64_t) 0];\n            cos_res_78244 = mem_81966[(int64_t) 0];\n            redout_81486 = acc_78245;\n            for (int64_t i_81487 = 0; i_81487 < tile_sizze_78072; i_81487++) {\n                double eta_p_78249;\n                double eta_p_78250;\n                double dist_res_78251;\n                bool zlze_res_78284;\n                int64_t bool_res_78285;\n                int64_t zp_res_78288;\n                int64_t redout_tmp_83154;\n                \n                eta_p_78249 = ((__local double *) color_83088)[i_81487];\n                eta_p_78250 = ((__local double *) color_83087)[i_81487];\n                if (dist_t_38167 == (int8_t) 0) {\n                    bool zeze_res_78252;\n                    double d_euclidean_res_78253;\n                    \n                    zeze_res_78252 = eta_p_78240 == eta_p_78249;\n                    if (zeze_res_78252) {\n                        double zm_res_78254;\n                        double abs_res_78255;\n                        \n                        zm_res_78254 = eta_p_78241 - eta_p_78250;\n                        abs_res_78255 = fabs64(zm_res_78254);\n                        d_euclidean_res_78253 = abs_res_78255;\n                    } else {\n                        bool zeze_res_78256;\n                        double d_euclidean_res_f_res_78257;\n                        \n                        zeze_res_78256 = eta_p_78241 == eta_p_78250;\n                        if (zeze_res_78256) {\n                            double zm_res_78258;\n                  ",
                                    "          double abs_res_78259;\n                            \n                            zm_res_78258 = eta_p_78240 - eta_p_78249;\n                            abs_res_78259 = fabs64(zm_res_78258);\n                            d_euclidean_res_f_res_78257 = abs_res_78259;\n                        } else {\n                            double zm_res_78260;\n                            double zm_res_78261;\n                            double hypot_res_78262;\n                            \n                            zm_res_78260 = eta_p_78241 - eta_p_78250;\n                            zm_res_78261 = eta_p_78240 - eta_p_78249;\n                            hypot_res_78262 = futrts_hypot64(zm_res_78261, zm_res_78260);\n                            d_euclidean_res_f_res_78257 = hypot_res_78262;\n                        }\n                        d_euclidean_res_78253 = d_euclidean_res_f_res_78257;\n                    }\n                    dist_res_78251 = d_euclidean_res_78253;\n                } else {\n                    double d_haversine_res_78263;\n                    double d_haversine_res_78264;\n                    double zm_res_78269;\n                    double cos_res_78270;\n                    double zm_res_78271;\n                    double cos_res_78272;\n                    double zt_res_78273;\n                    double zm_res_78274;\n                    double zm_res_78275;\n                    double zt_res_78276;\n                    double zp_res_78277;\n                    double zs_res_78278;\n                    double min_res_78279;\n                    double zt_res_78280;\n                    double zm_res_78281;\n                    double acos_res_78282;\n                    double zt_res_78283;\n                    \n                    if (angle_t_38168 == (int8_t) 1) {\n                        d_haversine_res_78263 = eta_p_78249;\n                        d_haversine_res_78264 = eta_p_78250;\n                    } else {\n                        double zt_res_78265;\n           ", "             double zs_res_78266;\n                        double zt_res_78267;\n                        double zs_res_78268;\n                        \n                        zt_res_78265 = 3.141592653589793 * eta_p_78249;\n                        zs_res_78266 = zt_res_78265 / 180.0;\n                        zt_res_78267 = 3.141592653589793 * eta_p_78250;\n                        zs_res_78268 = zt_res_78267 / 180.0;\n                        d_haversine_res_78263 = zs_res_78266;\n                        d_haversine_res_78264 = zs_res_78268;\n                    }\n                    zm_res_78269 = d_haversine_res_78242 - d_haversine_res_78263;\n                    cos_res_78270 = futrts_cos64(zm_res_78269);\n                    zm_res_78271 = 1.0 - cos_res_78270;\n                    cos_res_78272 = futrts_cos64(d_haversine_res_78263);\n                    zt_res_78273 = cos_res_78244 * cos_res_78272;\n                    zm_res_78274 = d_haversine_res_78243 - d_haversine_res_78264;\n                    zm_res_78275 = 1.0 - zm_res_78274;\n                    zt_res_78276 = zt_res_78273 * zm_res_78275;\n                    zp_res_78277 = zm_res_78271 + zt_res_78276;\n                    zs_res_78278 = zp_res_78277 / 2.0;\n                    min_res_78279 = fmin64(1.0, zs_res_78278);\n                    zt_res_78280 = 2.0 * min_res_78279;\n                    zm_res_78281 = 1.0 - zt_res_78280;\n                    acos_res_78282 = futrts_acos64(zm_res_78281);\n                    zt_res_78283 = radius_38169 * acos_res_78282;\n                    dist_res_78251 = zt_res_78283;\n                }\n                zlze_res_78284 = dist_res_78251 <= eps_38166;\n                bool_res_78285 = btoi_bool_i64(zlze_res_78284);\n                zp_res_78288 = add64(bool_res_78285, redout_81486);\n                redout_tmp_83154 = zp_res_78288;\n                redout_81486 = redout_tmp_83154;\n            }\n            x_78248 = redout_81486;\n            acc_78247 = x_78248;\n        } else {\n           ", " acc_78247 = acc_78245;\n        }\n        mem_81979[(int64_t) 0] = acc_78247;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_3 = 0; i_3 < 1; i_3++)\n            mem_param_tmp_83152[i_3] = mem_81979[i_3];\n        for (int32_t i_4 = 0; i_4 < 1; i_4++)\n            mem_param_81971[i_4] = mem_param_tmp_83152[i_4];\n    }\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        ext_mem_81980[i_5] = mem_param_81971[i_5];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_78331) {\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            ext_mem_81989[i_6] = ext_mem_81980[i_6];\n    } else {\n        int64_t ltid_flat_78333;\n        int64_t ltid_78332;\n        int64_t j_78345;\n        bool cond_78353;\n        double pre1d_78354;\n        double pre1d_78355;\n        int64_t ltid_flat_78365;\n        int64_t ltid_78364;\n        int64_t gtid_78372;\n        int64_t acc_78378;\n        bool cond_78379;\n        int64_t acc_78380;\n        \n        ltid_flat_78333 = sext_i32_i64(local_tid_83143);\n        ltid_78332 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        j_78345 = ltid_78332 + binop_x_78344;\n        cond_78353 = slt64(j_78345, n2_38161);\n        if (cond_78353) {\n            double tile_elem_78356;\n            double tile_elem_78357;\n            \n            tile_elem_78356 = ((__global double *) dat2_mem_81929)[j_78345];\n            tile_elem_78357 = ((__global double *) dat2_mem_81930)[j_78345];\n            pre1d_78354 = tile_elem_78356;\n            pre1d_78355 = tile_elem_78357;\n        } else {\n            pre1d_78354 = 0.0;\n            pre1d_78355 = 0.0;\n        }\n        ((__local double *) color_83088)[ltid_78332] = pre1d_78354;\n        ((__local double *) color_83087)[ltid_78332] = pre1d_78355;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_78365 = sext_i32_i64(local_tid_83143);\n        ltid_78364 = sext_i32_i64(sext_i64_i32(ltid_pre_83147));\n        gtid_78372 = binop_x_78088 + ltid_78364;\n        acc_78378 = ext_mem_81980[(int64_t) 0];\n        cond_7837",
                                    "9 = slt64(gtid_78372, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202);\n        if (cond_78379) {\n            double eta_p_78373;\n            double eta_p_78374;\n            double d_haversine_res_78375;\n            double d_haversine_res_78376;\n            double cos_res_78377;\n            int64_t x_78381;\n            int64_t redout_81488;\n            \n            eta_p_78373 = mem_81950[(int64_t) 0];\n            eta_p_78374 = mem_81954[(int64_t) 0];\n            d_haversine_res_78375 = mem_81958[(int64_t) 0];\n            d_haversine_res_78376 = mem_81962[(int64_t) 0];\n            cos_res_78377 = mem_81966[(int64_t) 0];\n            redout_81488 = acc_78378;\n            for (int64_t i_81489 = 0; i_81489 < residual_input_78330; i_81489++) {\n                double eta_p_78382;\n                double eta_p_78383;\n                double dist_res_78384;\n                bool zlze_res_78417;\n                int64_t bool_res_78418;\n                int64_t zp_res_78421;\n                int64_t redout_tmp_83155;\n                \n                eta_p_78382 = ((__local double *) color_83088)[i_81489];\n                eta_p_78383 = ((__local double *) color_83087)[i_81489];\n                if (dist_t_38167 == (int8_t) 0) {\n                    bool zeze_res_78385;\n                    double d_euclidean_res_78386;\n                    \n                    zeze_res_78385 = eta_p_78373 == eta_p_78382;\n                    if (zeze_res_78385) {\n                        double zm_res_78387;\n                        double abs_res_78388;\n                        \n                        zm_res_78387 = eta_p_78374 - eta_p_78383;\n                        abs_res_78388 = fabs64(zm_res_78387);\n                        d_euclidean_res_78386 = abs_res_78388;\n                    } else {\n                        bool zeze_res_78389;\n                        double d_euclidean_res_f_res_78390;\n                        \n                        zeze_res_78389 = eta_p_78374 == eta_p_78383;\n                        ", "if (zeze_res_78389) {\n                            double zm_res_78391;\n                            double abs_res_78392;\n                            \n                            zm_res_78391 = eta_p_78373 - eta_p_78382;\n                            abs_res_78392 = fabs64(zm_res_78391);\n                            d_euclidean_res_f_res_78390 = abs_res_78392;\n                        } else {\n                            double zm_res_78393;\n                            double zm_res_78394;\n                            double hypot_res_78395;\n                            \n                            zm_res_78393 = eta_p_78374 - eta_p_78383;\n                            zm_res_78394 = eta_p_78373 - eta_p_78382;\n                            hypot_res_78395 = futrts_hypot64(zm_res_78394, zm_res_78393);\n                            d_euclidean_res_f_res_78390 = hypot_res_78395;\n                        }\n                        d_euclidean_res_78386 = d_euclidean_res_f_res_78390;\n                    }\n                    dist_res_78384 = d_euclidean_res_78386;\n                } else {\n                    double d_haversine_res_78396;\n                    double d_haversine_res_78397;\n                    double zm_res_78402;\n                    double cos_res_78403;\n                    double zm_res_78404;\n                    double cos_res_78405;\n                    double zt_res_78406;\n                    double zm_res_78407;\n                    double zm_res_78408;\n                    double zt_res_78409;\n                    double zp_res_78410;\n                    double zs_res_78411;\n                    double min_res_78412;\n                    double zt_res_78413;\n                    double zm_res_78414;\n                    double acos_res_78415;\n                    double zt_res_78416;\n                    \n                    if (angle_t_38168 == (int8_t) 1) {\n                        d_haversine_res_78396 = eta_p_78382;\n                        d_haversine_res_78397 = eta_p_783", "83;\n                    } else {\n                        double zt_res_78398;\n                        double zs_res_78399;\n                        double zt_res_78400;\n                        double zs_res_78401;\n                        \n                        zt_res_78398 = 3.141592653589793 * eta_p_78382;\n                        zs_res_78399 = zt_res_78398 / 180.0;\n                        zt_res_78400 = 3.141592653589793 * eta_p_78383;\n                        zs_res_78401 = zt_res_78400 / 180.0;\n                        d_haversine_res_78396 = zs_res_78399;\n                        d_haversine_res_78397 = zs_res_78401;\n                    }\n                    zm_res_78402 = d_haversine_res_78375 - d_haversine_res_78396;\n                    cos_res_78403 = futrts_cos64(zm_res_78402);\n                    zm_res_78404 = 1.0 - cos_res_78403;\n                    cos_res_78405 = futrts_cos64(d_haversine_res_78396);\n                    zt_res_78406 = cos_res_78377 * cos_res_78405;\n                    zm_res_78407 = d_haversine_res_78376 - d_haversine_res_78397;\n                    zm_res_78408 = 1.0 - zm_res_78407;\n                    zt_res_78409 = zt_res_78406 * zm_res_78408;\n                    zp_res_78410 = zm_res_78404 + zt_res_78409;\n                    zs_res_78411 = zp_res_78410 / 2.0;\n                    min_res_78412 = fmin64(1.0, zs_res_78411);\n                    zt_res_78413 = 2.0 * min_res_78412;\n                    zm_res_78414 = 1.0 - zt_res_78413;\n                    acos_res_78415 = futrts_acos64(zm_res_78414);\n                    zt_res_78416 = radius_38169 * acos_res_78415;\n                    dist_res_78384 = zt_res_78416;\n                }\n                zlze_res_78417 = dist_res_78384 <= eps_38166;\n                bool_res_78418 = btoi_bool_i64(zlze_res_78417);\n                zp_res_78421 = add64(bool_res_78418, redout_81488);\n                redout_tmp_83155 = zp_res_78421;\n                redout_81488 = redout_tmp_83155;\n            }\n        ",
                                    "    x_78381 = redout_81488;\n            acc_78380 = x_78381;\n        } else {\n            acc_78380 = acc_78378;\n        }\n        mem_81988[(int64_t) 0] = acc_78380;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            ext_mem_81989[i_7] = mem_81988[i_7];\n    }\n    if (slt64(sext_i32_i64(local_tid_83143) + tile_sizze_78072 * sext_i32_i64(block_id_83144), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202)) {\n        int64_t tmp_83156 = ext_mem_81989[(int64_t) 0];\n        \n        ((__global int64_t *) mem_81932)[inf_38196 + (sext_i32_i64(local_tid_83143) + tile_sizze_78072 * sext_i32_i64(block_id_83144))] = tmp_83156;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_78072\n    #undef bytes_81972\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11935zisegred_large_74884_dim1, 1, 1)\nvoid get_num_neighbours_against_11935zisegred_large_74884(__global int *global_failure, int64_t n2_38161, double eps_38166, int8_t dist_t_38167, int8_t angle_t_38168, double radius_38169, int64_t inf_38196, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, int64_t num_tblocks_74879, unsigned char x_81814_bits, int64_t blocks_per_segment_83195, int64_t q_83196, int64_t num_virtblocks_83197, int64_t threads_per_segment_83198, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942, __global unsigned char *segred_tmp_mem_83199, __global unsigned char *counters_mem_83201)\n{\n    bool x_81814 = x_81814_bits;\n    \n    #define segred_tblock_sizze_74878 (get_num_neighbours_against_11935zisegred_large_74884zisegred_tblock_sizze_74878)\n    #define chunk_sizze_83166 (get_num_neighbours_against_11935zisegred_large_74884zichunk_sizze_83166)\n    \n    volatile __local unsigned char *sync_arr_mem_83230_backing_1 = &shared_mem[0];", "\n    const int64_t sync_arr_mem_83230_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_83228_backing_0 = &shared_mem[sync_arr_mem_83230_backing_1_offset];\n    const int64_t red_arr_i64_mem_83228_backing_0_offset = sync_arr_mem_83230_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_74878 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74878, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83224;\n    int32_t tblock_sizze_83227;\n    int32_t wave_sizze_83226;\n    int32_t block_id_83225;\n    int32_t global_tid_83223;\n    int64_t phys_tid_74884;\n    __local unsigned char *red_arr_i64_mem_83228;\n    __local unsigned char *sync_arr_mem_83230;\n    int32_t phys_tblock_id_83232;\n    int32_t iterations_83233;\n    \n    local_tid_83224 = get_local_id(0);\n    tblock_sizze_83227 = get_local_size(0);\n    wave_sizze_83226 = LOCKSTEP_WIDTH;\n    block_id_83225 = get_tblock_id(0);\n    global_tid_83223 = block_id_83225 * tblock_sizze_83227 + local_tid_83224;\n    phys_tid_74884 = sext_i32_i64(global_tid_83223);\n    red_arr_i64_mem_83228 = (__local unsigned char *) red_arr_i64_mem_83228_backing_0;\n    sync_arr_mem_83230 = (__local unsigned char *) sync_arr_mem_83230_backing_1;\n    phys_tblock_id_83232 = get_tblock_id(0);\n    iterations_83233 = sdiv_up32(sext_i64_i32(num_virtblocks_83197) - phys_tblock_id_83232, sext_i64_i32(num_tblocks_74879));\n    for (int32_t i_83234 = 0; i_83234 < iterations_83233; i_83234++) {\n        int32_t virt_tblock_id_83235;\n        int64_t flat_segment_id_83236;\n        int64_t global_tid_83237;\n        int64_t slice_83238;\n        int64_t gtid_74882;\n        int64_t remnant_83239;\n        int64_t gtid_74883;\n        int64_t eta_p_block_res_acc_83240;\n        int64_t eta_p_74885;\n        int64_t eta_p_74886;\n        int64_t tblock_id_in_segment_83244;\n        int64_t block_base_offset_83245;\n        int32_t offset_83248;\n        int32_t skip_waves_83249;\n", "        int64_t eta_p_83241;\n        int64_t eta_p_83242;\n        \n        virt_tblock_id_83235 = phys_tblock_id_83232 + i_83234 * sext_i64_i32(num_tblocks_74879);\n        flat_segment_id_83236 = squot64(sext_i32_i64(virt_tblock_id_83235), blocks_per_segment_83195);\n        global_tid_83237 = srem64(sext_i32_i64(virt_tblock_id_83235) * segred_tblock_sizze_74878 + sext_i32_i64(local_tid_83224), threads_per_segment_83198);\n        slice_83238 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;\n        gtid_74882 = flat_segment_id_83236;\n        remnant_83239 = flat_segment_id_83236 - gtid_74882;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_83240 = (int64_t) 0;\n        }\n        tblock_id_in_segment_83244 = squot64(global_tid_83237, segred_tblock_sizze_74878);\n        block_base_offset_83245 = tblock_id_in_segment_83244 * q_83196 * segred_tblock_sizze_74878;\n        for (int64_t i_83246 = 0; i_83246 < q_83196; i_83246++) {\n            int64_t block_offset_83247 = block_base_offset_83245 + i_83246 * segred_tblock_sizze_74878;\n            \n            gtid_74883 = global_tid_83237 + threads_per_segment_83198 * i_83246;\n            if (slt64(gtid_74883, n2_38161)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_77755 = inf_38196 + gtid_74882;\n                        double eta_p_74893 = ((__global double *) dat2_mem_81929)[gtid_74883];\n                        double eta_p_74894 = ((__global double *) dat2_mem_81930)[gtid_74883];\n                        double d_haversine_res_74890;\n                        \n                        if (x_81814) {\n                            double x_81816 = ((__global double *) mem_81938)[gtid_74882];\n                            \n                            d_haversine_res_74890 = x_81816;\n                        } else {\n                            d_haversine_res_74890 = 0.0;\n",
                                    "                        }\n                        \n                        double d_haversine_res_74891;\n                        \n                        if (x_81814) {\n                            double x_81818 = ((__global double *) mem_81940)[gtid_74882];\n                            \n                            d_haversine_res_74891 = x_81818;\n                        } else {\n                            d_haversine_res_74891 = 0.0;\n                        }\n                        \n                        double cos_res_74892;\n                        \n                        if (x_81814) {\n                            double x_81820 = ((__global double *) mem_81942)[gtid_74882];\n                            \n                            cos_res_74892 = x_81820;\n                        } else {\n                            cos_res_74892 = 0.0;\n                        }\n                        \n                        double dist_res_74895;\n                        \n                        if (dist_t_38167 == (int8_t) 0) {\n                            double eta_p_74888 = ((__global double *) dat1_mem_81927)[slice_77755];\n                            double eta_p_74889 = ((__global double *) dat1_mem_81928)[slice_77755];\n                            bool zeze_res_74896 = eta_p_74888 == eta_p_74893;\n                            double d_euclidean_res_74897;\n                            \n                            if (zeze_res_74896) {\n                                double zm_res_74898 = eta_p_74889 - eta_p_74894;\n                                double abs_res_74899 = fabs64(zm_res_74898);\n                                \n                                d_euclidean_res_74897 = abs_res_74899;\n                            } else {\n                                bool zeze_res_74900 = eta_p_74889 == eta_p_74894;\n                                double d_euclidean_res_f_res_74901;\n                                \n                                if (zeze_res_74900) {\n              ", "                      double zm_res_74902 = eta_p_74888 - eta_p_74893;\n                                    double abs_res_74903 = fabs64(zm_res_74902);\n                                    \n                                    d_euclidean_res_f_res_74901 = abs_res_74903;\n                                } else {\n                                    double zm_res_74904 = eta_p_74889 - eta_p_74894;\n                                    double zm_res_74905 = eta_p_74888 - eta_p_74893;\n                                    double hypot_res_74906 = futrts_hypot64(zm_res_74905, zm_res_74904);\n                                    \n                                    d_euclidean_res_f_res_74901 = hypot_res_74906;\n                                }\n                                d_euclidean_res_74897 = d_euclidean_res_f_res_74901;\n                            }\n                            dist_res_74895 = d_euclidean_res_74897;\n                        } else {\n                            double d_haversine_res_74907;\n                            double d_haversine_res_74908;\n                            \n                            if (angle_t_38168 == (int8_t) 1) {\n                                d_haversine_res_74907 = eta_p_74893;\n                                d_haversine_res_74908 = eta_p_74894;\n                            } else {\n                                double zt_res_74909 = 3.141592653589793 * eta_p_74893;\n                                double zs_res_74910 = zt_res_74909 / 180.0;\n                                double zt_res_74911 = 3.141592653589793 * eta_p_74894;\n                                double zs_res_74912 = zt_res_74911 / 180.0;\n                                \n                                d_haversine_res_74907 = zs_res_74910;\n                                d_haversine_res_74908 = zs_res_74912;\n                            }\n                            \n                            double zm_res_74913 = d_haversine_res_74890 - d_haversine_res_74907;\n      ", "                      double cos_res_74914 = futrts_cos64(zm_res_74913);\n                            double zm_res_74915 = 1.0 - cos_res_74914;\n                            double cos_res_74916 = futrts_cos64(d_haversine_res_74907);\n                            double zt_res_74917 = cos_res_74892 * cos_res_74916;\n                            double zm_res_74918 = d_haversine_res_74891 - d_haversine_res_74908;\n                            double zm_res_74919 = 1.0 - zm_res_74918;\n                            double zt_res_74920 = zt_res_74917 * zm_res_74919;\n                            double zp_res_74921 = zm_res_74915 + zt_res_74920;\n                            double zs_res_74922 = zp_res_74921 / 2.0;\n                            double min_res_74923 = fmin64(1.0, zs_res_74922);\n                            double zt_res_74924 = 2.0 * min_res_74923;\n                            double zm_res_74925 = 1.0 - zt_res_74924;\n                            double acos_res_74926 = futrts_acos64(zm_res_74925);\n                            double zt_res_74927 = radius_38169 * acos_res_74926;\n                            \n                            dist_res_74895 = zt_res_74927;\n                        }\n                        \n                        bool zlze_res_74928 = dist_res_74895 <= eps_38166;\n                        int64_t bool_res_74929 = btoi_bool_i64(zlze_res_74928);\n                        \n                        // load accumulator(s)\n                        {\n                            eta_p_74885 = eta_p_block_res_acc_83240;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_74886 = bool_res_74929;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            int64_t zp_res_74887 = add64(eta_p_74885, eta_p_74886);\n                            \n                            // store in accumulator(s)\n                   ",
                                    "         {\n                                eta_p_block_res_acc_83240 = zp_res_74887;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_block_res_acc_83240;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_83249 = 1;\n        offset_83248 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_83224, sext_i64_i32(segred_tblock_sizze_74878))) {\n                eta_p_83241 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n            }\n        }\n        offset_83248 = 1;\n        while (slt32(offset_83248, wave_sizze_83226)) {\n            if (slt32(local_tid_83224 + offset_83248, sext_i64_i32(segred_tblock_sizze_74878)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) & (2 * offset_83248 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_83242 = ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n                }\n                // apply reduction operation\n                {\n                    int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                    \n                    eta_p_83241 = zp_res_83243;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                }\n            }\n            offset_83248 *= 2;\n        }\n        while (slt32(skip_waves_83249, squot32(sext_i64_i32(segred_tblock_sizze_74878) + wave_sizze_83226 - 1, wave_sizze_83226))) {\n            barrier(CLK_LOCAL_MEM_F", "ENCE);\n            offset_83248 = skip_waves_83249 * wave_sizze_83226;\n            if (slt32(local_tid_83224 + offset_83248, sext_i64_i32(segred_tblock_sizze_74878)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) == 0 && (squot32(local_tid_83224, wave_sizze_83226) & (2 * skip_waves_83249 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_83242 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83248)];\n                }\n                // apply reduction operation\n                {\n                    int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                    \n                    eta_p_83241 = zp_res_83243;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                }\n            }\n            skip_waves_83249 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_83224) == (int64_t) 0) {\n                eta_p_block_res_acc_83240 = eta_p_83241;\n            } else {\n                eta_p_block_res_acc_83240 = (int64_t) 0;\n            }\n        }\n        if (blocks_per_segment_83195 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_83224 == 0) {\n                    ((__global int64_t *) mem_81932)[inf_38196 + gtid_74882] = eta_p_block_res_acc_83240;\n                }\n            }\n        } else {\n            int32_t old_counter_83250;\n            bool is_last_block_83251;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_83224 == 0) {\n                    ((__global int64_t *) segred_tmp_me", "m_83199)[sext_i32_i64(virt_tblock_id_83235)] = eta_p_block_res_acc_83240;\n                    mem_fence_global();\n                    old_counter_83250 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83201)[srem64(flat_segment_id_83236, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_83230)[(int64_t) 0] = old_counter_83250 == sext_i64_i32(blocks_per_segment_83195 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_83251 = ((__local bool *) sync_arr_mem_83230)[(int64_t) 0];\n            if (is_last_block_83251) {\n                if (local_tid_83224 == 0) {\n                    old_counter_83250 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83201)[srem64(flat_segment_id_83236, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_83195));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_83252 = sdiv_up64(blocks_per_segment_83195, segred_tblock_sizze_74878);\n                    \n                    eta_p_74885 = (int64_t) 0;\n                    for (int64_t i_83253 = 0; i_83253 < read_per_thread_83252; i_83253++) {\n                        int64_t block_res_id_83254 = sext_i32_i64(local_tid_83224) * read_per_thread_83252 + i_83253;\n                        int64_t index_of_block_res_83255 = flat_segment_id_83236 * blocks_per_segment_83195 + block_res_id_83254;\n                        \n                        if (slt64(block_res_id_83254, blocks_per_segment_83195)) {\n                            eta_p_74886 = ((__global int64_t *) segred_tmp_mem_83199)[index_of_block_res_83255];\n                            \n                            int64_t zp_res_74887 = add64(eta_p_74885, eta_p_74886);\n                            \n                            eta_p_74885 = zp_res_74887;\n                        }\n                    }\n       ",
                                    "         }\n                ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_74885;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_83256;\n                    int32_t skip_waves_83257 = 1;\n                    int64_t eta_p_83241;\n                    int64_t eta_p_83242;\n                    \n                    offset_83256 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_83224, sext_i64_i32(segred_tblock_sizze_74878))) {\n                            eta_p_83241 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                        }\n                    }\n                    offset_83256 = 1;\n                    while (slt32(offset_83256, wave_sizze_83226)) {\n                        if (slt32(local_tid_83224 + offset_83256, sext_i64_i32(segred_tblock_sizze_74878)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) & (2 * offset_83256 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_83242 = ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                                \n                                eta_p_83241 = zp_res_83243;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                            }\n                        }\n         ", "               offset_83256 *= 2;\n                    }\n                    while (slt32(skip_waves_83257, squot32(sext_i64_i32(segred_tblock_sizze_74878) + wave_sizze_83226 - 1, wave_sizze_83226))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_83256 = skip_waves_83257 * wave_sizze_83226;\n                        if (slt32(local_tid_83224 + offset_83256, sext_i64_i32(segred_tblock_sizze_74878)) && ((local_tid_83224 - squot32(local_tid_83224, wave_sizze_83226) * wave_sizze_83226) == 0 && (squot32(local_tid_83224, wave_sizze_83226) & (2 * skip_waves_83257 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_83242 = ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224 + offset_83256)];\n                            }\n                            // apply reduction operation\n                            {\n                                int64_t zp_res_83243 = add64(eta_p_83241, eta_p_83242);\n                                \n                                eta_p_83241 = zp_res_83243;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_83228)[sext_i32_i64(local_tid_83224)] = eta_p_83241;\n                            }\n                        }\n                        skip_waves_83257 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_83224 == 0) {\n                            ((__global int64_t *) mem_81932)[inf_38196 + gtid_74882] = eta_p_83241;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_74", "878\n    #undef chunk_sizze_83166\n}\nFUTHARK_KERNEL_SIZED(get_num_neighbours_against_11935zisegred_small_74884_dim1, 1, 1)\nvoid get_num_neighbours_against_11935zisegred_small_74884(__global int *global_failure, int64_t n2_38161, double eps_38166, int8_t dist_t_38167, int8_t angle_t_38168, double radius_38169, int64_t inf_38196, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, int64_t num_tblocks_74879, unsigned char x_81814_bits, int64_t segment_sizze_nonzzero_83167, __global unsigned char *dat1_mem_81927, __global unsigned char *dat1_mem_81928, __global unsigned char *dat2_mem_81929, __global unsigned char *dat2_mem_81930, __global unsigned char *mem_81932, __global unsigned char *mem_81938, __global unsigned char *mem_81940, __global unsigned char *mem_81942)\n{\n    bool x_81814 = x_81814_bits;\n    \n    #define segred_tblock_sizze_74878 (get_num_neighbours_against_11935zisegred_small_74884zisegred_tblock_sizze_74878)\n    \n    volatile __local unsigned char *red_arr_i64_mem_83174_backing_0 = &shared_mem[0];\n    const int64_t red_arr_i64_mem_83174_backing_0_offset = 0 + ((int64_t) 8 * segred_tblock_sizze_74878 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74878, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83170;\n    int32_t tblock_sizze_83173;\n    int32_t wave_sizze_83172;\n    int32_t block_id_83171;\n    int32_t global_tid_83169;\n    int64_t phys_tid_74884;\n    __local unsigned char *red_arr_i64_mem_83174;\n    int32_t phys_tblock_id_83176;\n    int32_t iterations_83177;\n    \n    local_tid_83170 = get_local_id(0);\n    tblock_sizze_83173 = get_local_size(0);\n    wave_sizze_83172 = LOCKSTEP_WIDTH;\n    block_id_83171 = get_tblock_id(0);\n    global_tid_83169 = block_id_83171 * tblock_sizze_83173 + local_tid_83170;\n    phys_tid_74884 = sext_i32_i64(global_tid_83169);\n    red_arr_i64_mem_83174 = (__local unsigned char *) red_arr_i64_mem_83174_backing_0;\n    phys_tblock_id_83176 = get_tblock_id(0);",
                                    "\n    iterations_83177 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167))) - phys_tblock_id_83176, sext_i64_i32(num_tblocks_74879));\n    for (int32_t i_83178 = 0; i_83178 < iterations_83177; i_83178++) {\n        int32_t virt_tblock_id_83179;\n        int64_t slice_83180;\n        int64_t gtid_74882;\n        int64_t remnant_83181;\n        int64_t gtid_74883;\n        \n        virt_tblock_id_83179 = phys_tblock_id_83176 + i_83178 * sext_i64_i32(num_tblocks_74879);\n        slice_83180 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;\n        gtid_74882 = squot64(sext_i32_i64(local_tid_83170), segment_sizze_nonzzero_83167) + sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167);\n        remnant_83181 = squot64(sext_i32_i64(local_tid_83170), segment_sizze_nonzzero_83167) + sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167) - gtid_74882;\n        gtid_74883 = srem64(sext_i32_i64(local_tid_83170), n2_38161);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, n2_38161) && (slt64(gtid_74882, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202) && slt64(sext_i32_i64(local_tid_83170), n2_38161 * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167)))) {\n                // apply map function\n                {\n                    int64_t slice_77755 = inf_38196 + gtid_74882;\n                    double eta_p_74893 = ((__global double *) dat2_mem_81929)[gtid_74883];\n                    double eta_p_74894 = ((__global double *) dat2_mem_81930)[gtid_74883];\n                    double d_haversine_res_74890;\n                    \n                    if (x_81814) {\n                        double x_81816 = ((__global double *) mem_81938)[gtid_74882];\n                        \n                        d_haversine_res_74890 = x_81816;\n                    } else {\n                  ", "      d_haversine_res_74890 = 0.0;\n                    }\n                    \n                    double d_haversine_res_74891;\n                    \n                    if (x_81814) {\n                        double x_81818 = ((__global double *) mem_81940)[gtid_74882];\n                        \n                        d_haversine_res_74891 = x_81818;\n                    } else {\n                        d_haversine_res_74891 = 0.0;\n                    }\n                    \n                    double cos_res_74892;\n                    \n                    if (x_81814) {\n                        double x_81820 = ((__global double *) mem_81942)[gtid_74882];\n                        \n                        cos_res_74892 = x_81820;\n                    } else {\n                        cos_res_74892 = 0.0;\n                    }\n                    \n                    double dist_res_74895;\n                    \n                    if (dist_t_38167 == (int8_t) 0) {\n                        double eta_p_74888 = ((__global double *) dat1_mem_81927)[slice_77755];\n                        double eta_p_74889 = ((__global double *) dat1_mem_81928)[slice_77755];\n                        bool zeze_res_74896 = eta_p_74888 == eta_p_74893;\n                        double d_euclidean_res_74897;\n                        \n                        if (zeze_res_74896) {\n                            double zm_res_74898 = eta_p_74889 - eta_p_74894;\n                            double abs_res_74899 = fabs64(zm_res_74898);\n                            \n                            d_euclidean_res_74897 = abs_res_74899;\n                        } else {\n                            bool zeze_res_74900 = eta_p_74889 == eta_p_74894;\n                            double d_euclidean_res_f_res_74901;\n                            \n                            if (zeze_res_74900) {\n                                double zm_res_74902 = eta_p_74888 - eta_p_74893;\n                                double abs_res_74903 = fab", "s64(zm_res_74902);\n                                \n                                d_euclidean_res_f_res_74901 = abs_res_74903;\n                            } else {\n                                double zm_res_74904 = eta_p_74889 - eta_p_74894;\n                                double zm_res_74905 = eta_p_74888 - eta_p_74893;\n                                double hypot_res_74906 = futrts_hypot64(zm_res_74905, zm_res_74904);\n                                \n                                d_euclidean_res_f_res_74901 = hypot_res_74906;\n                            }\n                            d_euclidean_res_74897 = d_euclidean_res_f_res_74901;\n                        }\n                        dist_res_74895 = d_euclidean_res_74897;\n                    } else {\n                        double d_haversine_res_74907;\n                        double d_haversine_res_74908;\n                        \n                        if (angle_t_38168 == (int8_t) 1) {\n                            d_haversine_res_74907 = eta_p_74893;\n                            d_haversine_res_74908 = eta_p_74894;\n                        } else {\n                            double zt_res_74909 = 3.141592653589793 * eta_p_74893;\n                            double zs_res_74910 = zt_res_74909 / 180.0;\n                            double zt_res_74911 = 3.141592653589793 * eta_p_74894;\n                            double zs_res_74912 = zt_res_74911 / 180.0;\n                            \n                            d_haversine_res_74907 = zs_res_74910;\n                            d_haversine_res_74908 = zs_res_74912;\n                        }\n                        \n                        double zm_res_74913 = d_haversine_res_74890 - d_haversine_res_74907;\n                        double cos_res_74914 = futrts_cos64(zm_res_74913);\n                        double zm_res_74915 = 1.0 - cos_res_74914;\n                        double cos_res_74916 = futrts_cos64(d_haversine_res_74907);\n                        double zt",
                                    "_res_74917 = cos_res_74892 * cos_res_74916;\n                        double zm_res_74918 = d_haversine_res_74891 - d_haversine_res_74908;\n                        double zm_res_74919 = 1.0 - zm_res_74918;\n                        double zt_res_74920 = zt_res_74917 * zm_res_74919;\n                        double zp_res_74921 = zm_res_74915 + zt_res_74920;\n                        double zs_res_74922 = zp_res_74921 / 2.0;\n                        double min_res_74923 = fmin64(1.0, zs_res_74922);\n                        double zt_res_74924 = 2.0 * min_res_74923;\n                        double zm_res_74925 = 1.0 - zt_res_74924;\n                        double acos_res_74926 = futrts_acos64(zm_res_74925);\n                        double zt_res_74927 = radius_38169 * acos_res_74926;\n                        \n                        dist_res_74895 = zt_res_74927;\n                    }\n                    \n                    bool zlze_res_74928 = dist_res_74895 <= eps_38166;\n                    int64_t bool_res_74929 = btoi_bool_i64(zlze_res_74928);\n                    \n                    // save results to be reduced\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = bool_res_74929;\n                    }\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = (int64_t) 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, n2_38161)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_74885;\n                int64_t eta_p_74886;\n                int64_t eta_p_83182;\n                int64_t eta_p_83183;\n                bool ltid_in_bounds_83185 = slt64(sext_i32_i64(local_tid_83170), n2_38161 * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167));\n                int32_t skip_threads_83186;\n                \n                // read in", "put for in-block scan\n                {\n                    if (ltid_in_bounds_83185) {\n                        eta_p_74886 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)];\n                        if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 0) {\n                            eta_p_74885 = eta_p_74886;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83186 = 1;\n                    while (slt32(skip_threads_83186, 32)) {\n                        bool thread_active_83187 = sle32(skip_threads_83186, local_tid_83170 - squot32(local_tid_83170, 32) * 32) && ltid_in_bounds_83185;\n                        \n                        if (thread_active_83187) {\n                            // read operands\n                            {\n                                eta_p_74885 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170) - sext_i32_i64(skip_threads_83186)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_83188 = slt64(srem64(sext_i32_i64(local_tid_83170), n2_38161), sext_i32_i64(local_tid_83170) - sext_i32_i64(local_tid_83170 - skip_threads_83186));\n                            \n                            if (thread_active_83187 && inactive_83188) {\n                                eta_p_74885 = eta_p_74886;\n                            }\n                            if (thread_active_83187) {\n                                if (!inactive_83188) {\n                                    int64_t zp_res_74887 = add64(eta_p_74885, eta_p_74886);\n                                    \n                                    eta_p_74885 = zp_res_74887;\n                                }\n                            }\n                        }\n                   ", "     if (sle32(wave_sizze_83172, skip_threads_83186)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83187) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74885;\n                                eta_p_74886 = eta_p_74885;\n                            }\n                        }\n                        if (sle32(wave_sizze_83172, skip_threads_83186)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83186 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 31 && ltid_in_bounds_83185) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(squot32(local_tid_83170, 32))] = eta_p_74885;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_83189;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185) {\n                            eta_p_83183 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)];\n                            if ((local_tid_83170 - squot32(local_tid_83170, 32) * 32) == 0) {\n                                eta_p_83182 = eta_p_83183;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers ne",
                                    "eded)\n                    {\n                        skip_threads_83189 = 1;\n                        while (slt32(skip_threads_83189, 32)) {\n                            bool thread_active_83190 = sle32(skip_threads_83189, local_tid_83170 - squot32(local_tid_83170, 32) * 32) && (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185);\n                            \n                            if (thread_active_83190) {\n                                // read operands\n                                {\n                                    eta_p_83182 = ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170) - sext_i32_i64(skip_threads_83189)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_83191 = slt64(srem64(sext_i32_i64(local_tid_83170 * 32 + 32 - 1), n2_38161), sext_i32_i64(local_tid_83170 * 32 + 32 - 1) - sext_i32_i64((local_tid_83170 - skip_threads_83189) * 32 + 32 - 1));\n                                \n                                if (thread_active_83190 && inactive_83191) {\n                                    eta_p_83182 = eta_p_83183;\n                                }\n                                if (thread_active_83190) {\n                                    if (!inactive_83191) {\n                                        int64_t zp_res_83184 = add64(eta_p_83182, eta_p_83183);\n                                        \n                                        eta_p_83182 = zp_res_83184;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_83172, skip_threads_83189)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_83190) {\n                                // write result\n                                {\n    ", "                                ((volatile __local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_83182;\n                                    eta_p_83183 = eta_p_83182;\n                                }\n                            }\n                            if (sle32(wave_sizze_83172, skip_threads_83189)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_83189 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_83192 = squot32(local_tid_83170, 32) == 0 || !ltid_in_bounds_83185;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_83192) {\n                            eta_p_74886 = eta_p_74885;\n                            eta_p_74885 = ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(squot32(local_tid_83170, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_83193 = slt64(srem64(sext_i32_i64(local_tid_83170), n2_38161), sext_i32_i64(local_tid_83170) - sext_i32_i64(squot32(local_tid_83170, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_83192) {\n                            if (inactive_83193) {\n                                eta_p_74885 = eta_p_74886;\n                            }\n                        }\n                        if (!no_carry_in_83192) {\n                            if (!inactive_83193) {\n                                int64_t zp_res_74887 = add64(eta_p_74885, eta_p_74886);\n                                \n                                eta_p_74885 = zp_res_74887;\n                            }\n                        }\n       ", "             }\n                    // write final result\n                    {\n                        if (!no_carry_in_83192) {\n                            ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74885;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_83170, 32) == 0 && ltid_in_bounds_83185) {\n                        ((__local int64_t *) red_arr_i64_mem_83174)[sext_i32_i64(local_tid_83170)] = eta_p_74886;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167) + sext_i32_i64(local_tid_83170), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202) && slt64(sext_i32_i64(local_tid_83170), squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167))) {\n                int64_t tmp_83194 = ((__local int64_t *) red_arr_i64_mem_83174)[(sext_i32_i64(local_tid_83170) + (int64_t) 1) * segment_sizze_nonzzero_83167 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_81932)[inf_38196 + (sext_i32_i64(virt_tblock_id_83179) * squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167) + sext_i32_i64(local_tid_83170))] = tmp_83194;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_74878\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezigpuseq_83217_dim1, 1, 1)\nvoid make_collisions_compact_doublezigpuseq_83217(__global int *global_failure, __global unsigned char *mem_81954, __global unsigned char *mem_81955, __global unsigned char *mem_81956, ",
                                    "__global unsigned char *mem_81957)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83219;\n    int32_t tblock_sizze_83222;\n    int32_t wave_sizze_83221;\n    int32_t block_id_83220;\n    int32_t global_tid_83218;\n    int64_t tid_83217;\n    int64_t x_81561;\n    int64_t x_81563;\n    \n    local_tid_83219 = get_local_id(0);\n    tblock_sizze_83222 = get_local_size(0);\n    wave_sizze_83221 = LOCKSTEP_WIDTH;\n    block_id_83220 = get_tblock_id(0);\n    global_tid_83218 = block_id_83220 * tblock_sizze_83222 + local_tid_83219;\n    tid_83217 = sext_i32_i64(global_tid_83218);\n    x_81561 = ((__global int64_t *) mem_81954)[(int64_t) 0];\n    x_81563 = ((__global int64_t *) mem_81955)[(int64_t) 0];\n    ((__global int64_t *) mem_81956)[(int64_t) 0] = x_81561;\n    ((__global int64_t *) mem_81957)[(int64_t) 0] = x_81563;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezireplicate_83380(int64_t next_stride_59632, int64_t num_merges_59636, int64_t replicate_n_83379, int64_t virt_num_tblocks_83385, int64_t num_tblocks_83386, __global unsigned char *mem_82251, __global unsigned char *mem_82256)\n{\n    int32_t replicate_ltid_83381;\n    int32_t tblock_sizze_83383;\n    int32_t replicate_gid_83382;\n    int32_t replicate_gtid_83380;\n    int32_t phys_tblock_id_83387;\n    int32_t iterations_83388;\n    \n    replicate_ltid_83381 = get_local_id(0);\n    tblock_sizze_83383 = get_local_size(0);\n    replicate_gid_83382 = get_tblock_id(0);\n    replicate_gtid_83380 = replicate_gid_83382 * tblock_sizze_83383 + replicate_ltid_83381;\n    phys_tblock_id_83387 = get_tblock_id(0);\n    iterations_83388 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83385) - phys_tblock_id_83387, sext_i64_i32(num_tblocks_83386));\n    for (int32_t i_83389 = 0; i_83389 < iterations_83388; i_83389++) {\n        int32_t virt_tblock_id_83390;\n        int64_t global_tid_83391;\n        int64_t slice_83394;\n        int64_t slice_83395;\n        int64_t rep_i_83392;\n        int64_t remnant_", "83396;\n        int64_t rep_i_83393;\n        int64_t remnant_83397;\n        \n        virt_tblock_id_83390 = phys_tblock_id_83387 + i_83389 * sext_i64_i32(num_tblocks_83386);\n        global_tid_83391 = sext_i32_i64(virt_tblock_id_83390) * sext_i32_i64(tblock_sizze_83383) + sext_i32_i64(replicate_ltid_83381);\n        slice_83394 = num_merges_59636;\n        slice_83395 = next_stride_59632 * slice_83394;\n        rep_i_83392 = squot64(global_tid_83391, slice_83394);\n        remnant_83396 = global_tid_83391 - rep_i_83392 * slice_83394;\n        rep_i_83393 = remnant_83396;\n        remnant_83397 = remnant_83396 - rep_i_83393;\n        if (slt64(global_tid_83391, replicate_n_83379)) {\n            int64_t tmp_83398 = ((__global int64_t *) mem_82251)[rep_i_83393];\n            \n            ((__global int64_t *) mem_82256)[rep_i_83392 * num_merges_59636 + rep_i_83393] = tmp_83398;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezireplicate_83400(int64_t next_stride_59632, int64_t num_merges_59636, int64_t replicate_n_83399, int64_t virt_num_tblocks_83405, int64_t num_tblocks_83406, __global unsigned char *mem_82253, __global unsigned char *mem_82259)\n{\n    int32_t replicate_ltid_83401;\n    int32_t tblock_sizze_83403;\n    int32_t replicate_gid_83402;\n    int32_t replicate_gtid_83400;\n    int32_t phys_tblock_id_83407;\n    int32_t iterations_83408;\n    \n    replicate_ltid_83401 = get_local_id(0);\n    tblock_sizze_83403 = get_local_size(0);\n    replicate_gid_83402 = get_tblock_id(0);\n    replicate_gtid_83400 = replicate_gid_83402 * tblock_sizze_83403 + replicate_ltid_83401;\n    phys_tblock_id_83407 = get_tblock_id(0);\n    iterations_83408 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83405) - phys_tblock_id_83407, sext_i64_i32(num_tblocks_83406));\n    for (int32_t i_83409 = 0; i_83409 < iterations_83408; i_83409++) {\n        int32_t virt_tblock_id_83410;\n        int64_t global_tid_", "83411;\n        int64_t slice_83414;\n        int64_t slice_83415;\n        int64_t rep_i_83412;\n        int64_t remnant_83416;\n        int64_t rep_i_83413;\n        int64_t remnant_83417;\n        \n        virt_tblock_id_83410 = phys_tblock_id_83407 + i_83409 * sext_i64_i32(num_tblocks_83406);\n        global_tid_83411 = sext_i32_i64(virt_tblock_id_83410) * sext_i32_i64(tblock_sizze_83403) + sext_i32_i64(replicate_ltid_83401);\n        slice_83414 = num_merges_59636;\n        slice_83415 = next_stride_59632 * slice_83414;\n        rep_i_83412 = squot64(global_tid_83411, slice_83414);\n        remnant_83416 = global_tid_83411 - rep_i_83412 * slice_83414;\n        rep_i_83413 = remnant_83416;\n        remnant_83417 = remnant_83416 - rep_i_83413;\n        if (slt64(global_tid_83411, replicate_n_83399)) {\n            int64_t tmp_83418 = ((__global int64_t *) mem_82253)[rep_i_83413];\n            \n            ((__global int64_t *) mem_82259)[rep_i_83412 * num_merges_59636 + rep_i_83413] = tmp_83418;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezireplicate_83523(int64_t greatest_divisor_leq_than_res_59511, int64_t num_merges_59636, int64_t num_blocks_59653, int64_t replicate_n_83522, int64_t virt_num_tblocks_83528, int64_t num_tblocks_83529, __global unsigned char *mem_82069, __global unsigned char *mem_82090)\n{\n    int32_t replicate_ltid_83524;\n    int32_t tblock_sizze_83526;\n    int32_t replicate_gid_83525;\n    int32_t replicate_gtid_83523;\n    int32_t phys_tblock_id_83530;\n    int32_t iterations_83531;\n    \n    replicate_ltid_83524 = get_local_id(0);\n    tblock_sizze_83526 = get_local_size(0);\n    replicate_gid_83525 = get_tblock_id(0);\n    replicate_gtid_83523 = replicate_gid_83525 * tblock_sizze_83526 + replicate_ltid_83524;\n    phys_tblock_id_83530 = get_tblock_id(0);\n    iterations_83531 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83528) - phys_tblock_id_83530, sext_i64",
                                    "_i32(num_tblocks_83529));\n    for (int32_t i_83532 = 0; i_83532 < iterations_83531; i_83532++) {\n        int32_t virt_tblock_id_83533;\n        int64_t global_tid_83534;\n        int64_t slice_83538;\n        int64_t slice_83539;\n        int64_t slice_83540;\n        int64_t rep_i_83535;\n        int64_t remnant_83541;\n        int64_t rep_i_83536;\n        int64_t remnant_83542;\n        int64_t rep_i_83537;\n        int64_t remnant_83543;\n        \n        virt_tblock_id_83533 = phys_tblock_id_83530 + i_83532 * sext_i64_i32(num_tblocks_83529);\n        global_tid_83534 = sext_i32_i64(virt_tblock_id_83533) * sext_i32_i64(tblock_sizze_83526) + sext_i32_i64(replicate_ltid_83524);\n        slice_83538 = num_blocks_59653;\n        slice_83539 = num_merges_59636 * slice_83538;\n        slice_83540 = greatest_divisor_leq_than_res_59511 * slice_83539;\n        rep_i_83535 = squot64(global_tid_83534, slice_83539);\n        remnant_83541 = global_tid_83534 - rep_i_83535 * slice_83539;\n        rep_i_83536 = squot64(remnant_83541, slice_83538);\n        remnant_83542 = remnant_83541 - rep_i_83536 * slice_83538;\n        rep_i_83537 = remnant_83542;\n        remnant_83543 = remnant_83542 - rep_i_83537;\n        if (slt64(global_tid_83534, replicate_n_83522)) {\n            int64_t tmp_83544 = ((__global int64_t *) mem_82069)[rep_i_83536 * num_blocks_59653 + rep_i_83537];\n            \n            ((__global int64_t *) mem_82090)[rep_i_83535 * (num_blocks_59653 * num_merges_59636) + rep_i_83536 * num_blocks_59653 + rep_i_83537] = tmp_83544;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezireplicate_83546(int64_t greatest_divisor_leq_than_res_59511, int64_t num_merges_59636, int64_t num_blocks_59653, int64_t replicate_n_83545, int64_t virt_num_tblocks_83551, int64_t num_tblocks_83552, __global unsigned char *mem_82072, __global unsigned char *mem_82094)\n{\n    int32_t replicate_ltid_83547;\n   ", " int32_t tblock_sizze_83549;\n    int32_t replicate_gid_83548;\n    int32_t replicate_gtid_83546;\n    int32_t phys_tblock_id_83553;\n    int32_t iterations_83554;\n    \n    replicate_ltid_83547 = get_local_id(0);\n    tblock_sizze_83549 = get_local_size(0);\n    replicate_gid_83548 = get_tblock_id(0);\n    replicate_gtid_83546 = replicate_gid_83548 * tblock_sizze_83549 + replicate_ltid_83547;\n    phys_tblock_id_83553 = get_tblock_id(0);\n    iterations_83554 = sdiv_up32(sext_i64_i32(virt_num_tblocks_83551) - phys_tblock_id_83553, sext_i64_i32(num_tblocks_83552));\n    for (int32_t i_83555 = 0; i_83555 < iterations_83554; i_83555++) {\n        int32_t virt_tblock_id_83556;\n        int64_t global_tid_83557;\n        int64_t slice_83561;\n        int64_t slice_83562;\n        int64_t slice_83563;\n        int64_t rep_i_83558;\n        int64_t remnant_83564;\n        int64_t rep_i_83559;\n        int64_t remnant_83565;\n        int64_t rep_i_83560;\n        int64_t remnant_83566;\n        \n        virt_tblock_id_83556 = phys_tblock_id_83553 + i_83555 * sext_i64_i32(num_tblocks_83552);\n        global_tid_83557 = sext_i32_i64(virt_tblock_id_83556) * sext_i32_i64(tblock_sizze_83549) + sext_i32_i64(replicate_ltid_83547);\n        slice_83561 = num_blocks_59653;\n        slice_83562 = num_merges_59636 * slice_83561;\n        slice_83563 = greatest_divisor_leq_than_res_59511 * slice_83562;\n        rep_i_83558 = squot64(global_tid_83557, slice_83562);\n        remnant_83564 = global_tid_83557 - rep_i_83558 * slice_83562;\n        rep_i_83559 = squot64(remnant_83564, slice_83561);\n        remnant_83565 = remnant_83564 - rep_i_83559 * slice_83561;\n        rep_i_83560 = remnant_83565;\n        remnant_83566 = remnant_83565 - rep_i_83560;\n        if (slt64(global_tid_83557, replicate_n_83545)) {\n            int64_t tmp_83567 = ((__global int64_t *) mem_82072)[rep_i_83559 * num_blocks_59653 + rep_i_83560];\n            \n            ((__global int64_t *) mem_82094)[rep_i_83558 * (num_blocks_59653 * num_merges", "_59636) + rep_i_83559 * num_blocks_59653 + rep_i_83560] = tmp_83567;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_71189_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_71189(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2084U_51542, int64_t smallest_pow_2_geq_than_res_59478, int64_t block_sizze_59488, __global unsigned char *chain_collisions_mem_81927, __global unsigned char *chain_collisions_mem_81928, __global unsigned char *ext_mem_81958, __global unsigned char *ext_mem_81959, __global unsigned char *mem_81963, __global unsigned char *mem_81966)\n{\n    #define segmap_tblock_sizze_71183 (make_collisions_compact_doublezisegmap_71189zisegmap_tblock_sizze_71183)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83246;\n    int32_t tblock_sizze_83249;\n    int32_t wave_sizze_83248;\n    int32_t block_id_83247;\n    int32_t global_tid_83245;\n    int64_t phys_tid_71189;\n    int64_t global_tid_83250;\n    int64_t slice_83251;\n    int64_t slice_83252;\n    int64_t gtid_71187;\n    int64_t remnant_83253;\n    int64_t gtid_71188;\n    int64_t remnant_83254;\n    \n    local_tid_83246 = get_local_id(0);\n    tblock_sizze_83249 = get_local_size(0);\n    wave_sizze_83248 = LOCKSTEP_WIDTH;\n    block_id_83247 = get_tblock_id(0);\n    global_tid_83245 = block_id_83247 * tblock_sizze_83249 + local_tid_83246;\n    phys_tid_71189 = sext_i32_i64(global_tid_83245);\n    global_tid_83250 = sext_i32_i64(block_id_83247) * segmap_tblock_sizze_71183 + sext_i32_i64(local_tid_83246);\n    slice_83251 = block_sizze_59488;\n    slice_83252 = smallest_pow_2_geq_than_res_59478 * slice_83251;\n    gtid_71187 = squot64(global_tid_83250, slice_83251);\n    remnant_83253 = global_tid_83250 - gtid_71187 * slice_83251;\n    gtid_71188 = remnant_83253;\n    remnant_83254 = remnant_83253 - gtid_71188;\n    if (slt64(gt",
                                    "id_71187, smallest_pow_2_geq_than_res_59478) && slt64(gtid_71188, block_sizze_59488)) {\n        int64_t index_primexp_77798;\n        int64_t k_71192;\n        bool cond_71193;\n        int64_t lifted_lambda_res_71194;\n        int64_t lifted_lambda_res_71195;\n        \n        index_primexp_77798 = mul64(block_sizze_59488, gtid_71187);\n        k_71192 = add64(gtid_71188, index_primexp_77798);\n        cond_71193 = slt64(k_71192, dz2084U_51542);\n        if (cond_71193) {\n            bool x_71196;\n            bool bounds_check_71197;\n            bool index_certs_71198;\n            int64_t lifted_lambda_res_t_res_71199;\n            int64_t lifted_lambda_res_t_res_71200;\n            \n            x_71196 = sle64((int64_t) 0, k_71192);\n            bounds_check_71197 = cond_71193 && x_71196;\n            if (!bounds_check_71197) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 25) == -1) {\n                        global_failure_args[0] = (int64_t) k_71192;\n                        global_failure_args[1] = (int64_t) dz2084U_51542;\n                        ;\n                    }\n                    return;\n                }\n            }\n            lifted_lambda_res_t_res_71199 = ((__global int64_t *) chain_collisions_mem_81927)[k_71192];\n            lifted_lambda_res_t_res_71200 = ((__global int64_t *) chain_collisions_mem_81928)[k_71192];\n            lifted_lambda_res_71194 = lifted_lambda_res_t_res_71199;\n            lifted_lambda_res_71195 = lifted_lambda_res_t_res_71200;\n        } else {\n            int64_t defunc_0_reduce_res_81569;\n            int64_t defunc_0_reduce_res_81570;\n            \n            defunc_0_reduce_res_81569 = ((__global int64_t *) ext_mem_81959)[(int64_t) 0];\n            defunc_0_reduce_res_81570 = ((__global int64_t *) ext_mem_81958)[(int64_t) 0];\n            lifted_lambda_res_71194 = defunc_0_reduce_res_81569;\n            lifted_lambda_res_71195 = defunc_0_reduce_res_81570;\n        }\n        ((__global int64_t ", "*) mem_81963)[gtid_71187 * block_sizze_59488 + gtid_71188] = lifted_lambda_res_71194;\n        ((__global int64_t *) mem_81966)[gtid_71187 * block_sizze_59488 + gtid_71188] = lifted_lambda_res_71195;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_71183\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_71214_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_71214(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t smallest_pow_2_geq_than_res_59478, int64_t block_sizze_59488, int64_t distance_59538, int64_t num_tblocks_71209, int32_t virt_num_tblocks_83255, __global unsigned char *mem_81977, __global unsigned char *mem_81988, __global unsigned char *mem_82024, __global unsigned char *mem_82035)\n{\n    #define segmap_tblock_sizze_71208 (make_collisions_compact_doublezisegmap_71214zisegmap_tblock_sizze_71208)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_83257;\n    int32_t tblock_sizze_83260;\n    int32_t wave_sizze_83259;\n    int32_t block_id_83258;\n    int32_t global_tid_83256;\n    int64_t phys_tid_71214;\n    int32_t phys_tblock_id_83261;\n    int32_t iterations_83262;\n    \n    local_tid_83257 = get_local_id(0);\n    tblock_sizze_83260 = get_local_size(0);\n    wave_sizze_83259 = LOCKSTEP_WIDTH;\n    block_id_83258 = get_tblock_id(0);\n    global_tid_83256 = block_id_83258 * tblock_sizze_83260 + local_tid_83257;\n    phys_tid_71214 = sext_i32_i64(global_tid_83256);\n    phys_tblock_id_83261 = get_tblock_id(0);\n    iterations_83262 = sdiv_up32(virt_num_tblocks_83255 - phys_tblock_id_83261, sext_i64_i32(num_tblocks_71209));\n    for (int32_t i_83263 = 0; i_83263 < iterations_83262; i_83263++) {\n        int32_t virt_tblock_id_83264;\n        int64_t global_tid_83265;\n        int64_t slice_83266;\n        int64_t gtid_71213;\n        int64_t remnant_83267;\n        \n        virt_tblock_id_83264 = phys_", "tblock_id_83261 + i_83263 * sext_i64_i32(num_tblocks_71209);\n        global_tid_83265 = sext_i32_i64(virt_tblock_id_83264) * segmap_tblock_sizze_71208 + sext_i32_i64(local_tid_83257);\n        slice_83266 = smallest_pow_2_geq_than_res_59478;\n        gtid_71213 = global_tid_83265;\n        remnant_83267 = global_tid_83265 - gtid_71213;\n        if (slt64(gtid_71213, smallest_pow_2_geq_than_res_59478)) {\n            for (int64_t i_71219 = 0; i_71219 < distance_59538; i_71219++) {\n                int64_t gt_arg1_71222;\n                bool x_71223;\n                bool y_71224;\n                bool bounds_check_71225;\n                bool index_certs_71226;\n                bool y_71229;\n                bool index_certs_71230;\n                int64_t gt_arg1_71227;\n                int64_t gt_arg1_71228;\n                int64_t gt_arg0_71231;\n                int64_t gt_arg0_71232;\n                bool defunc_0_leq_res_71233;\n                bool defunc_0_lifted_gt_res_71234;\n                bool s_71235;\n                int64_t s_71238;\n                bool loop_while_71239;\n                int64_t j_71242;\n                \n                gt_arg1_71222 = add64((int64_t) 1, i_71219);\n                x_71223 = sle64((int64_t) 0, gt_arg1_71222);\n                y_71224 = slt64(gt_arg1_71222, block_sizze_59488);\n                bounds_check_71225 = x_71223 && y_71224;\n                if (!bounds_check_71225) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 26) == -1) {\n                            global_failure_args[0] = (int64_t) gt_arg1_71222;\n                            global_failure_args[1] = (int64_t) block_sizze_59488;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_0;\n                    }\n                }\n                y_71229 = slt64(i_71219, block_sizze_59488);\n                if (!y_71229) {\n                    {\n                ",
                                    "        if (atomic_cmpxchg_i32_global(global_failure, -1, 27) == -1) {\n                            global_failure_args[0] = (int64_t) i_71219;\n                            global_failure_args[1] = (int64_t) block_sizze_59488;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_0;\n                    }\n                }\n                gt_arg1_71227 = ((__global int64_t *) mem_81977)[gtid_71213 + gt_arg1_71222 * smallest_pow_2_geq_than_res_59478];\n                gt_arg1_71228 = ((__global int64_t *) mem_81988)[gtid_71213 + gt_arg1_71222 * smallest_pow_2_geq_than_res_59478];\n                gt_arg0_71231 = ((__global int64_t *) mem_81977)[gtid_71213 + i_71219 * smallest_pow_2_geq_than_res_59478];\n                gt_arg0_71232 = ((__global int64_t *) mem_81988)[gtid_71213 + i_71219 * smallest_pow_2_geq_than_res_59478];\n                futrts_lifted_lambda_11636(&defunc_0_leq_res_71233, gt_arg0_71231, gt_arg0_71232, gt_arg1_71227, gt_arg1_71228);\n                defunc_0_lifted_gt_res_71234 = !defunc_0_leq_res_71233;\n                loop_while_71239 = defunc_0_lifted_gt_res_71234;\n                j_71242 = i_71219;\n                while (loop_while_71239) {\n                    bool x_71243;\n                    bool y_71244;\n                    bool bounds_check_71245;\n                    bool index_certs_71246;\n                    int64_t copy_arg0_71249;\n                    bool x_71250;\n                    bool y_71251;\n                    bool bounds_check_71252;\n                    bool index_certs_71253;\n                    int64_t copy_arg0_71247;\n                    int64_t copy_arg0_71248;\n                    int64_t copy_arg0_71254;\n                    int64_t copy_arg0_71255;\n                    int64_t tmp_71260;\n                    bool cond_71261;\n                    bool loop_cond_71262;\n                    bool loop_while_tmp_83270;\n                    int64_t j_tmp_83273;\n ", "                   \n                    x_71243 = sle64((int64_t) 0, j_71242);\n                    y_71244 = slt64(j_71242, block_sizze_59488);\n                    bounds_check_71245 = x_71243 && y_71244;\n                    if (!bounds_check_71245) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 28) == -1) {\n                                global_failure_args[0] = (int64_t) j_71242;\n                                global_failure_args[1] = (int64_t) block_sizze_59488;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    copy_arg0_71249 = add64((int64_t) 1, j_71242);\n                    x_71250 = sle64((int64_t) 0, copy_arg0_71249);\n                    y_71251 = slt64(copy_arg0_71249, block_sizze_59488);\n                    bounds_check_71252 = x_71250 && y_71251;\n                    if (!bounds_check_71252) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 29) == -1) {\n                                global_failure_args[0] = (int64_t) copy_arg0_71249;\n                                global_failure_args[1] = (int64_t) block_sizze_59488;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    copy_arg0_71247 = ((__global int64_t *) mem_81977)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478];\n                    copy_arg0_71248 = ((__global int64_t *) mem_81988)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478];\n                    copy_arg0_71254 = ((__global int64_t *) mem_81977)[gtid_71213 + copy_arg0_71249 * smallest_pow_2_geq_than_res_59478];\n                    copy_arg0_71255 = ((__global int64_t *) mem_819", "88)[gtid_71213 + copy_arg0_71249 * smallest_pow_2_geq_than_res_59478];\n                    ((__global int64_t *) mem_81977)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478] = copy_arg0_71254;\n                    ((__global int64_t *) mem_81988)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478] = copy_arg0_71255;\n                    ((__global int64_t *) mem_81977)[gtid_71213 + copy_arg0_71249 * smallest_pow_2_geq_than_res_59478] = copy_arg0_71247;\n                    ((__global int64_t *) mem_81988)[gtid_71213 + copy_arg0_71249 * smallest_pow_2_geq_than_res_59478] = copy_arg0_71248;\n                    tmp_71260 = sub64(j_71242, (int64_t) 1);\n                    cond_71261 = sle64((int64_t) 0, tmp_71260);\n                    if (cond_71261) {\n                        bool y_71265;\n                        bool bounds_check_71266;\n                        bool index_certs_71267;\n                        int64_t gt_arg1_71263;\n                        int64_t gt_arg1_71264;\n                        int64_t gt_arg0_71268;\n                        int64_t gt_arg0_71269;\n                        bool defunc_0_leq_res_71270;\n                        bool defunc_0_lifted_gt_res_71271;\n                        \n                        y_71265 = slt64(tmp_71260, block_sizze_59488);\n                        bounds_check_71266 = cond_71261 && y_71265;\n                        if (!bounds_check_71266) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 30) == -1) {\n                                    global_failure_args[0] = (int64_t) tmp_71260;\n                                    global_failure_args[1] = (int64_t) block_sizze_59488;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        gt_arg1_71263 = ((__global int64_t",
                                    " *) mem_81977)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478];\n                        gt_arg1_71264 = ((__global int64_t *) mem_81988)[gtid_71213 + j_71242 * smallest_pow_2_geq_than_res_59478];\n                        gt_arg0_71268 = ((__global int64_t *) mem_81977)[gtid_71213 + tmp_71260 * smallest_pow_2_geq_than_res_59478];\n                        gt_arg0_71269 = ((__global int64_t *) mem_81988)[gtid_71213 + tmp_71260 * smallest_pow_2_geq_than_res_59478];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_71270, gt_arg0_71268, gt_arg0_71269, gt_arg1_71263, gt_arg1_71264);\n                        defunc_0_lifted_gt_res_71271 = !defunc_0_leq_res_71270;\n                        loop_cond_71262 = defunc_0_lifted_gt_res_71271;\n                    } else {\n                        loop_cond_71262 = 0;\n                    }\n                    loop_while_tmp_83270 = loop_cond_71262;\n                    j_tmp_83273 = tmp_71260;\n                    loop_while_71239 = loop_while_tmp_83270;\n                    j_71242 = j_tmp_83273;\n                }\n                s_71235 = loop_while_71239;\n                s_71238 = j_71242;\n            }\n            for (int64_t i_0 = 0; i_0 < block_sizze_59488; i_0++) {\n                ((__global int64_t *) mem_82024)[gtid_71213 + i_0 * smallest_pow_2_geq_than_res_59478] = ((__global int64_t *) mem_81977)[gtid_71213 + i_0 * smallest_pow_2_geq_than_res_59478];\n            }\n            for (int64_t i_0 = 0; i_0 < block_sizze_59488; i_0++) {\n                ((__global int64_t *) mem_82035)[gtid_71213 + i_0 * smallest_pow_2_geq_than_res_59478] = ((__global int64_t *) mem_81988)[gtid_71213 + i_0 * smallest_pow_2_geq_than_res_59478];\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_712", "08\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_73717_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_73717(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t loop_dz2084Uz2082U_59627, int64_t next_stride_59632, unsigned char zzero_59633_bits, int64_t num_merges_59636, int64_t m_59641, unsigned char zzero_leq_i_p_m_t_s_59642_bits, unsigned char i_lte_j_59643_bits, __global unsigned char *mem_82057, __global unsigned char *mem_82058)\n{\n    bool zzero_59633 = zzero_59633_bits;\n    bool zzero_leq_i_p_m_t_s_59642 = zzero_leq_i_p_m_t_s_59642_bits;\n    bool i_lte_j_59643 = i_lte_j_59643_bits;\n    \n    #define segmap_tblock_sizze_73711 (make_collisions_compact_doublezisegmap_73717zisegmap_tblock_sizze_73711)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83363;\n    int32_t tblock_sizze_83366;\n    int32_t wave_sizze_83365;\n    int32_t block_id_83364;\n    int32_t global_tid_83362;\n    int64_t phys_tid_73717;\n    int64_t global_tid_83367;\n    int64_t slice_83368;\n    int64_t gtid_73716;\n    int64_t remnant_83369;\n    \n    local_tid_83363 = get_local_id(0);\n    tblock_sizze_83366 = get_local_size(0);\n    wave_sizze_83365 = LOCKSTEP_WIDTH;\n    block_id_83364 = get_tblock_id(0);\n    global_tid_83362 = block_id_83364 * tblock_sizze_83366 + local_tid_83363;\n    phys_tid_73717 = sext_i32_i64(global_tid_83362);\n    global_tid_83367 = sext_i32_i64(block_id_83364) * segmap_tblock_sizze_73711 + sext_i32_i64(local_tid_83363);\n    slice_83368 = num_merges_59636;\n    gtid_73716 = global_tid_83367;\n    remnant_83369 = global_tid_83367 - gtid_73716;\n    if (slt64(gtid_73716, num_merges_59636)) {\n        int64_t start_73719;\n        int64_t j_m_i_73720;\n        bool empty_slice_73721;\n        int64_t m_73722;\n        int64_t i_p_m_t_s_73723;\n        bool zzero_leq_i_p_m_t_s_73724;\n        bool i_p_m_t_s_leq_w_73725;\n        bool zzero_lte_i_73726;\n        bool i_lte_j_73727;\n        bool y_", "73728;\n        bool y_73729;\n        bool forwards_ok_73730;\n        bool ok_or_empty_73731;\n        bool index_certs_73732;\n        bool i_p_m_t_s_leq_w_73733;\n        bool y_73734;\n        bool forwards_ok_73735;\n        bool ok_or_empty_73736;\n        bool index_certs_73737;\n        \n        start_73719 = mul64(next_stride_59632, gtid_73716);\n        j_m_i_73720 = sub64(loop_dz2084Uz2082U_59627, start_73719);\n        empty_slice_73721 = j_m_i_73720 == (int64_t) 0;\n        m_73722 = sub64(j_m_i_73720, (int64_t) 1);\n        i_p_m_t_s_73723 = add64(start_73719, m_73722);\n        zzero_leq_i_p_m_t_s_73724 = sle64((int64_t) 0, i_p_m_t_s_73723);\n        i_p_m_t_s_leq_w_73725 = slt64(i_p_m_t_s_73723, loop_dz2084Uz2082U_59627);\n        zzero_lte_i_73726 = sle64((int64_t) 0, start_73719);\n        i_lte_j_73727 = sle64(start_73719, loop_dz2084Uz2082U_59627);\n        y_73728 = i_p_m_t_s_leq_w_73725 && zzero_lte_i_73726;\n        y_73729 = zzero_leq_i_p_m_t_s_73724 && y_73728;\n        forwards_ok_73730 = i_lte_j_73727 && y_73729;\n        ok_or_empty_73731 = empty_slice_73721 || forwards_ok_73730;\n        if (!ok_or_empty_73731) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 51) == -1) {\n                    global_failure_args[0] = (int64_t) start_73719;\n                    global_failure_args[1] = (int64_t) loop_dz2084Uz2082U_59627;\n                    ;\n                }\n                return;\n            }\n        }\n        i_p_m_t_s_leq_w_73733 = slt64(m_59641, j_m_i_73720);\n        y_73734 = zzero_leq_i_p_m_t_s_59642 && i_p_m_t_s_leq_w_73733;\n        forwards_ok_73735 = i_lte_j_59643 && y_73734;\n        ok_or_empty_73736 = zzero_59633 || forwards_ok_73735;\n        if (!ok_or_empty_73736) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 52) == -1) {\n                    global_failure_args[0] = (int64_t) (int64_t) 0;\n                    global_failure_args[1] = (int64_t) next_stride_59632;\n                ",
                                    "    global_failure_args[2] = (int64_t) j_m_i_73720;\n                    ;\n                }\n                return;\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73711\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_73746_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_73746(__global int *global_failure, int64_t stride_59631, int64_t next_stride_59632, int64_t num_merges_59636, unsigned char cond_59665_bits, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *mem_82058, __global unsigned char *mem_82251, __global unsigned char *mem_82253)\n{\n    bool cond_59665 = cond_59665_bits;\n    \n    #define segmap_tblock_sizze_73741 (make_collisions_compact_doublezisegmap_73746zisegmap_tblock_sizze_73741)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83372;\n    int32_t tblock_sizze_83375;\n    int32_t wave_sizze_83374;\n    int32_t block_id_83373;\n    int32_t global_tid_83371;\n    int64_t phys_tid_73746;\n    int64_t global_tid_83376;\n    int64_t slice_83377;\n    int64_t gtid_73745;\n    int64_t remnant_83378;\n    \n    local_tid_83372 = get_local_id(0);\n    tblock_sizze_83375 = get_local_size(0);\n    wave_sizze_83374 = LOCKSTEP_WIDTH;\n    block_id_83373 = get_tblock_id(0);\n    global_tid_83371 = block_id_83373 * tblock_sizze_83375 + local_tid_83372;\n    phys_tid_73746 = sext_i32_i64(global_tid_83371);\n    global_tid_83376 = sext_i32_i64(block_id_83373) * segmap_tblock_sizze_73741 + sext_i32_i64(local_tid_83372);\n    slice_83377 = num_merges_59636;\n    gtid_73745 = global_tid_83376;\n    remnant_83378 = global_tid_83376 - gtid_73745;\n    if (slt64(gtid_73745, num_merges_59636)) {\n        int64_t index_primexp_77783;\n        bool index_certs_73748;\n        bool index_certs_73749;\n        int64_t dummy_73750;\n        int64_t dummy_73751;\n        \n        index_primexp_77783 = mul64(next_stride_59632, gtid_73", "745);\n        index_certs_73748 = 0;\n        index_certs_73749 = 0;\n        if (cond_59665) {\n            int64_t head_res_73752;\n            int64_t head_res_73753;\n            \n            head_res_73752 = ((__global int64_t *) mem_param_82052)[index_primexp_77783];\n            head_res_73753 = ((__global int64_t *) mem_param_82055)[index_primexp_77783];\n            dummy_73750 = head_res_73752;\n            dummy_73751 = head_res_73753;\n        } else {\n            int64_t slice_73754;\n            int64_t head_res_73755;\n            int64_t head_res_73756;\n            \n            slice_73754 = stride_59631 + index_primexp_77783;\n            head_res_73755 = ((__global int64_t *) mem_param_82052)[slice_73754];\n            head_res_73756 = ((__global int64_t *) mem_param_82055)[slice_73754];\n            dummy_73750 = head_res_73755;\n            dummy_73751 = head_res_73756;\n        }\n        ((__global int64_t *) mem_82251)[gtid_73745] = dummy_73750;\n        ((__global int64_t *) mem_82253)[gtid_73745] = dummy_73751;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_73741\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_73770_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_73770(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t stride_59631, int64_t next_stride_59632, int64_t num_merges_59636, int64_t j_m_i_59655, int64_t num_tblocks_73765, int32_t virt_num_tblocks_83420, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *mem_82058, __global unsigned char *mem_82270, __global unsigned char *mem_82281, __global unsigned char *mem_82305, __global unsigned char *mem_82316)\n{\n    #define segmap_tblock_sizze_73764 (make_collisions_compact_doublezisegmap_73770zisegmap_tblock_sizze_73764)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_fa", "ilure = 0;\n    \n    int32_t local_tid_83422;\n    int32_t tblock_sizze_83425;\n    int32_t wave_sizze_83424;\n    int32_t block_id_83423;\n    int32_t global_tid_83421;\n    int64_t phys_tid_73770;\n    int32_t phys_tblock_id_83426;\n    int32_t iterations_83427;\n    \n    local_tid_83422 = get_local_id(0);\n    tblock_sizze_83425 = get_local_size(0);\n    wave_sizze_83424 = LOCKSTEP_WIDTH;\n    block_id_83423 = get_tblock_id(0);\n    global_tid_83421 = block_id_83423 * tblock_sizze_83425 + local_tid_83422;\n    phys_tid_73770 = sext_i32_i64(global_tid_83421);\n    phys_tblock_id_83426 = get_tblock_id(0);\n    iterations_83427 = sdiv_up32(virt_num_tblocks_83420 - phys_tblock_id_83426, sext_i64_i32(num_tblocks_73765));\n    for (int32_t i_83428 = 0; i_83428 < iterations_83427; i_83428++) {\n        int32_t virt_tblock_id_83429;\n        int64_t global_tid_83430;\n        int64_t slice_83431;\n        int64_t gtid_73769;\n        int64_t remnant_83432;\n        \n        virt_tblock_id_83429 = phys_tblock_id_83426 + i_83428 * sext_i64_i32(num_tblocks_73765);\n        global_tid_83430 = sext_i32_i64(virt_tblock_id_83429) * segmap_tblock_sizze_73764 + sext_i32_i64(local_tid_83422);\n        slice_83431 = num_merges_59636;\n        gtid_73769 = global_tid_83430;\n        remnant_83432 = global_tid_83430 - gtid_73769;\n        if (slt64(gtid_73769, num_merges_59636)) {\n            int64_t index_primexp_77780;\n            bool index_certs_73772;\n            bool index_certs_73773;\n            int64_t data_73776;\n            int64_t i_73780;\n            \n            index_primexp_77780 = mul64(next_stride_59632, gtid_73769);\n            index_certs_73772 = 0;\n            index_certs_73773 = 0;\n            i_73780 = (int64_t) 0;\n            for (int64_t k_73779 = 0; k_73779 < next_stride_59632; k_73779++) {\n                int64_t j_73783;\n                bool cond_73784;\n                bool cond_73785;\n                int64_t loopres_73803;\n                int64_t loopres_73804;\n                int64",
                                    "_t loopres_73805;\n                int64_t i_tmp_83433;\n                \n                j_73783 = sub64(k_73779, i_73780);\n                cond_73784 = j_73783 == j_m_i_59655;\n                if (cond_73784) {\n                    cond_73785 = 1;\n                } else {\n                    bool cond_73786;\n                    bool cond_f_res_73787;\n                    \n                    cond_73786 = slt64(i_73780, stride_59631);\n                    if (cond_73786) {\n                        bool x_73788;\n                        bool y_73789;\n                        bool bounds_check_73790;\n                        bool index_certs_73791;\n                        bool x_73796;\n                        bool bounds_check_73797;\n                        bool index_certs_73798;\n                        int64_t slice_73792;\n                        int64_t slice_73793;\n                        int64_t leq_arg1_73794;\n                        int64_t leq_arg1_73795;\n                        int64_t slice_73799;\n                        int64_t leq_arg0_73800;\n                        int64_t leq_arg0_73801;\n                        bool defunc_0_leq_res_73802;\n                        \n                        x_73788 = sle64((int64_t) 0, j_73783);\n                        y_73789 = slt64(j_73783, j_m_i_59655);\n                        bounds_check_73790 = x_73788 && y_73789;\n                        if (!bounds_check_73790) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 53) == -1) {\n                                    global_failure_args[0] = (int64_t) j_73783;\n                                    global_failure_args[1] = (int64_t) j_m_i_59655;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        x_73796 = sle64((int64_t) 0, i_737", "80);\n                        bounds_check_73797 = cond_73786 && x_73796;\n                        if (!bounds_check_73797) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 54) == -1) {\n                                    global_failure_args[0] = (int64_t) i_73780;\n                                    global_failure_args[1] = (int64_t) stride_59631;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        slice_73792 = stride_59631 + j_73783;\n                        slice_73793 = slice_73792 + index_primexp_77780;\n                        leq_arg1_73794 = ((__global int64_t *) mem_param_82052)[slice_73793];\n                        leq_arg1_73795 = ((__global int64_t *) mem_param_82055)[slice_73793];\n                        slice_73799 = i_73780 + index_primexp_77780;\n                        leq_arg0_73800 = ((__global int64_t *) mem_param_82052)[slice_73799];\n                        leq_arg0_73801 = ((__global int64_t *) mem_param_82055)[slice_73799];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_73802, leq_arg0_73800, leq_arg0_73801, leq_arg1_73794, leq_arg1_73795);\n                        cond_f_res_73787 = defunc_0_leq_res_73802;\n                    } else {\n                        cond_f_res_73787 = 0;\n                    }\n                    cond_73785 = cond_f_res_73787;\n                }\n                if (cond_73785) {\n                    bool x_73807;\n                    bool y_73808;\n                    bool bounds_check_73809;\n                    bool index_certs_73810;\n                    int64_t tmp_73806;\n                    int64_t slice_73811;\n                    int64_t tmp_73812;\n                    int64_t tmp_73813;\n                    \n                    x_73807 = sle64((", "int64_t) 0, i_73780);\n                    y_73808 = slt64(i_73780, stride_59631);\n                    bounds_check_73809 = x_73807 && y_73808;\n                    if (!bounds_check_73809) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 55) == -1) {\n                                global_failure_args[0] = (int64_t) i_73780;\n                                global_failure_args[1] = (int64_t) stride_59631;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    tmp_73806 = add64((int64_t) 1, i_73780);\n                    slice_73811 = i_73780 + index_primexp_77780;\n                    tmp_73812 = ((__global int64_t *) mem_param_82052)[slice_73811];\n                    tmp_73813 = ((__global int64_t *) mem_param_82055)[slice_73811];\n                    loopres_73803 = tmp_73806;\n                    loopres_73804 = tmp_73812;\n                    loopres_73805 = tmp_73813;\n                } else {\n                    bool x_73814;\n                    bool y_73815;\n                    bool bounds_check_73816;\n                    bool index_certs_73817;\n                    int64_t slice_73818;\n                    int64_t slice_73819;\n                    int64_t tmp_73820;\n                    int64_t tmp_73821;\n                    \n                    x_73814 = sle64((int64_t) 0, j_73783);\n                    y_73815 = slt64(j_73783, j_m_i_59655);\n                    bounds_check_73816 = x_73814 && y_73815;\n                    if (!bounds_check_73816) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 56) == -1) {\n                                global_failure_args[0] = (int64_t) j_73783;\n                                global_failure_args[1] = (int64_t) j_m_i_59655;\n                                ;\n  ",
                                    "                          }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    slice_73818 = stride_59631 + j_73783;\n                    slice_73819 = slice_73818 + index_primexp_77780;\n                    tmp_73820 = ((__global int64_t *) mem_param_82052)[slice_73819];\n                    tmp_73821 = ((__global int64_t *) mem_param_82055)[slice_73819];\n                    loopres_73803 = i_73780;\n                    loopres_73804 = tmp_73820;\n                    loopres_73805 = tmp_73821;\n                }\n                ((__global int64_t *) mem_82270)[gtid_73769 + k_73779 * num_merges_59636] = loopres_73804;\n                ((__global int64_t *) mem_82281)[gtid_73769 + k_73779 * num_merges_59636] = loopres_73805;\n                i_tmp_83433 = loopres_73803;\n                i_73780 = i_tmp_83433;\n            }\n            data_73776 = i_73780;\n            for (int64_t i_0 = 0; i_0 < next_stride_59632; i_0++) {\n                ((__global int64_t *) mem_82305)[gtid_73769 + i_0 * num_merges_59636] = ((__global int64_t *) mem_82270)[gtid_73769 + i_0 * num_merges_59636];\n            }\n            for (int64_t i_0 = 0; i_0 < next_stride_59632; i_0++) {\n                ((__global int64_t *) mem_82316)[gtid_73769 + i_0 * num_merges_59636] = ((__global int64_t *) mem_82281)[gtid_73769 + i_0 * num_merges_59636];\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_73764\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_74095_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_74095(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t greatest_divisor_leq_than_res_59511, int64_t s", "tride_59631, int64_t next_stride_59632, int64_t num_merges_59636, int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, int64_t j_m_i_59655, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *mem_82058, __global unsigned char *mem_82062, __global unsigned char *mem_82065)\n{\n    #define segmap_tblock_sizze_74089 (make_collisions_compact_doublezisegmap_74095zisegmap_tblock_sizze_74089)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_83496;\n    int32_t tblock_sizze_83499;\n    int32_t wave_sizze_83498;\n    int32_t block_id_83497;\n    int32_t global_tid_83495;\n    int64_t phys_tid_74095;\n    int64_t global_tid_83500;\n    int64_t slice_83501;\n    int64_t slice_83502;\n    int64_t gtid_74093;\n    int64_t remnant_83503;\n    int64_t gtid_74094;\n    int64_t remnant_83504;\n    \n    local_tid_83496 = get_local_id(0);\n    tblock_sizze_83499 = get_local_size(0);\n    wave_sizze_83498 = LOCKSTEP_WIDTH;\n    block_id_83497 = get_tblock_id(0);\n    global_tid_83495 = block_id_83497 * tblock_sizze_83499 + local_tid_83496;\n    phys_tid_74095 = sext_i32_i64(global_tid_83495);\n    global_tid_83500 = sext_i32_i64(block_id_83497) * segmap_tblock_sizze_74089 + sext_i32_i64(local_tid_83496);\n    slice_83501 = dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n    slice_83502 = num_merges_59636 * slice_83501;\n    gtid_74093 = squot64(global_tid_83500, slice_83501);\n    remnant_83503 = global_tid_83500 - gtid_74093 * slice_83501;\n    gtid_74094 = remnant_83503;\n    remnant_83504 = remnant_83503 - gtid_74094;\n    if (slt64(gtid_74093, num_merges_59636) && slt64(gtid_74094, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654)) {\n        int64_t index_primexp_77795;\n        bool index_certs_74097;\n        bool index_certs_74098;\n        int64_t split_count_arg3_74100;\n        int64_t defunc_0_split_count_res_74101;\n        in", "t64_t defunc_0_split_count_res_74102;\n        int64_t defunc_0_split_count_res_74103;\n        int64_t defunc_0_split_count_res_74104;\n        int64_t defunc_0_split_count_res_74105;\n        bool loop_cond_74106;\n        bool defunc_0_split_count_res_74107;\n        int64_t defunc_0_split_count_res_74108;\n        int64_t defunc_0_split_count_res_74109;\n        int64_t defunc_0_split_count_res_74110;\n        int64_t defunc_0_split_count_res_74111;\n        int64_t defunc_0_split_count_res_74112;\n        bool loop_while_74113;\n        int64_t ss_74114;\n        int64_t ss_74115;\n        int64_t tt_74116;\n        int64_t tt_74117;\n        int64_t count_74118;\n        \n        index_primexp_77795 = mul64(next_stride_59632, gtid_74093);\n        index_certs_74097 = 0;\n        index_certs_74098 = 0;\n        split_count_arg3_74100 = mul64(greatest_divisor_leq_than_res_59511, gtid_74094);\n        futrts_lifted_normalizze_11537(&defunc_0_split_count_res_74101, &defunc_0_split_count_res_74102, &defunc_0_split_count_res_74103, &defunc_0_split_count_res_74104, &defunc_0_split_count_res_74105, (int64_t) 0, stride_59631, (int64_t) 0, j_m_i_59655, split_count_arg3_74100);\n        loop_cond_74106 = slt64((int64_t) 0, defunc_0_split_count_res_74105);\n        loop_while_74113 = loop_cond_74106;\n        ss_74114 = defunc_0_split_count_res_74101;\n        ss_74115 = defunc_0_split_count_res_74102;\n        tt_74116 = defunc_0_split_count_res_74103;\n        tt_74117 = defunc_0_split_count_res_74104;\n        count_74118 = defunc_0_split_count_res_74105;\n        while (loop_while_74113) {\n            int64_t zlze_lhs_74119;\n            bool cond_74120;\n            int64_t defunc_0_lifted_step_res_74121;\n            int64_t defunc_0_lifted_step_res_74122;\n            int64_t defunc_0_lifted_step_res_74123;\n            int64_t defunc_0_lifted_step_res_74124;\n            int64_t loopres_74191;\n            int64_t loopres_74192;\n            int64_t loopres_74193;\n            int64_t loopres_74194;\n ",
                                    "           int64_t loopres_74195;\n            bool loop_cond_74196;\n            bool loop_while_tmp_83505;\n            int64_t ss_tmp_83506;\n            int64_t ss_tmp_83507;\n            int64_t tt_tmp_83508;\n            int64_t tt_tmp_83509;\n            int64_t count_tmp_83510;\n            \n            zlze_lhs_74119 = sub64(ss_74115, ss_74114);\n            cond_74120 = sle64(zlze_lhs_74119, (int64_t) 0);\n            if (cond_74120) {\n                int64_t tmp_74125 = add64(tt_74116, count_74118);\n                \n                defunc_0_lifted_step_res_74121 = ss_74114;\n                defunc_0_lifted_step_res_74122 = tmp_74125;\n                defunc_0_lifted_step_res_74123 = tt_74117;\n                defunc_0_lifted_step_res_74124 = (int64_t) 0;\n            } else {\n                int64_t zlze_lhs_74126;\n                bool cond_74127;\n                int64_t defunc_0_lifted_step_res_f_res_74128;\n                int64_t defunc_0_lifted_step_res_f_res_74129;\n                int64_t defunc_0_lifted_step_res_f_res_74130;\n                int64_t defunc_0_lifted_step_res_f_res_74131;\n                \n                zlze_lhs_74126 = sub64(tt_74117, tt_74116);\n                cond_74127 = sle64(zlze_lhs_74126, (int64_t) 0);\n                if (cond_74127) {\n                    int64_t tmp_74132 = add64(ss_74114, count_74118);\n                    \n                    defunc_0_lifted_step_res_f_res_74128 = tmp_74132;\n                    defunc_0_lifted_step_res_f_res_74129 = tt_74116;\n                    defunc_0_lifted_step_res_f_res_74130 = tt_74117;\n                    defunc_0_lifted_step_res_f_res_74131 = (int64_t) 0;\n                } else {\n                    bool cond_74133;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_74134;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_74135;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_74136;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_74137", ";\n                    \n                    cond_74133 = count_74118 == (int64_t) 1;\n                    if (cond_74133) {\n                        bool x_74138;\n                        bool y_74139;\n                        bool bounds_check_74140;\n                        bool index_certs_74141;\n                        bool x_74145;\n                        bool y_74146;\n                        bool bounds_check_74147;\n                        bool index_certs_74148;\n                        int64_t slice_74142;\n                        int64_t leq_arg1_74143;\n                        int64_t leq_arg1_74144;\n                        int64_t slice_74149;\n                        int64_t slice_74150;\n                        int64_t leq_arg0_74151;\n                        int64_t leq_arg0_74152;\n                        bool defunc_0_leq_res_74153;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_74154;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_74155;\n                        \n                        x_74138 = sle64((int64_t) 0, ss_74114);\n                        y_74139 = slt64(ss_74114, stride_59631);\n                        bounds_check_74140 = x_74138 && y_74139;\n                        if (!bounds_check_74140) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 71) == -1) {\n                                    global_failure_args[0] = (int64_t) ss_74114;\n                                    global_failure_args[1] = (int64_t) stride_59631;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        x_74145 = sle64((int64_t) 0, tt_74116);\n                        y_74146 = slt64(tt_74116, j_m_i_59655);\n                        bounds_check_74147 = x_74145 && y_74146;\n                        if (!bounds_check_74147) {\n               ", "             {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 72) == -1) {\n                                    global_failure_args[0] = (int64_t) tt_74116;\n                                    global_failure_args[1] = (int64_t) j_m_i_59655;\n                                    ;\n                                }\n                                return;\n                            }\n                        }\n                        slice_74142 = ss_74114 + index_primexp_77795;\n                        leq_arg1_74143 = ((__global int64_t *) mem_param_82052)[slice_74142];\n                        leq_arg1_74144 = ((__global int64_t *) mem_param_82055)[slice_74142];\n                        slice_74149 = stride_59631 + tt_74116;\n                        slice_74150 = slice_74149 + index_primexp_77795;\n                        leq_arg0_74151 = ((__global int64_t *) mem_param_82052)[slice_74150];\n                        leq_arg0_74152 = ((__global int64_t *) mem_param_82055)[slice_74150];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_74153, leq_arg0_74151, leq_arg0_74152, leq_arg1_74143, leq_arg1_74144);\n                        if (defunc_0_leq_res_74153) {\n                            int64_t tmp_74156 = add64((int64_t) 1, tt_74116);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_t_res_74154 = ss_74114;\n                            defunc_0_lifted_step_res_f_res_f_res_t_res_74155 = tmp_74156;\n                        } else {\n                            int64_t tmp_74157 = add64((int64_t) 1, ss_74114);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_t_res_74154 = tmp_74157;\n                            defunc_0_lifted_step_res_f_res_f_res_t_res_74155 = tt_74116;\n                        }\n                        defunc_0_lifted_step_res_f_res_f_res_74134 = defunc_0_lifted_step_res_f_res_f_res_t_res_74154;\n                        defunc",
                                    "_0_lifted_step_res_f_res_f_res_74135 = defunc_0_lifted_step_res_f_res_f_res_t_res_74155;\n                        defunc_0_lifted_step_res_f_res_f_res_74136 = tt_74117;\n                        defunc_0_lifted_step_res_f_res_f_res_74137 = (int64_t) 0;\n                    } else {\n                        int64_t m_74158;\n                        int64_t n_74159;\n                        bool cond_74160;\n                        int64_t zgze_lhs_74161;\n                        bool cond_f_res_74162;\n                        bool x_74163;\n                        bool y_74164;\n                        bool cond_74165;\n                        bool leq_y_x_74166;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_74185;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_74186;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_74187;\n                        \n                        m_74158 = sdiv64(count_74118, (int64_t) 2);\n                        n_74159 = sub64(count_74118, m_74158);\n                        cond_74160 = n_74159 == (int64_t) 0;\n                        zgze_lhs_74161 = add64(ss_74114, m_74158);\n                        cond_f_res_74162 = sle64(ss_74115, zgze_lhs_74161);\n                        x_74163 = !cond_74160;\n                        y_74164 = cond_f_res_74162 && x_74163;\n                        cond_74165 = cond_74160 || y_74164;\n                        if (cond_74165) {\n                            leq_y_x_74166 = 1;\n                        } else {\n                            bool x_74167;\n                            bool y_74168;\n                            bool bounds_check_74169;\n                            bool index_certs_74170;\n                            int64_t zm_lhs_74174;\n                            int64_t leq_arg0_74175;\n                            bool x_74176;\n                            bool y_74177;\n                            bool bounds_check_74178;\n                ", "            bool index_certs_74179;\n                            int64_t slice_74171;\n                            int64_t leq_arg1_74172;\n                            int64_t leq_arg1_74173;\n                            int64_t slice_74180;\n                            int64_t slice_74181;\n                            int64_t leq_arg0_74182;\n                            int64_t leq_arg0_74183;\n                            bool defunc_0_leq_res_74184;\n                            \n                            x_74167 = sle64((int64_t) 0, zgze_lhs_74161);\n                            y_74168 = slt64(zgze_lhs_74161, stride_59631);\n                            bounds_check_74169 = x_74167 && y_74168;\n                            if (!bounds_check_74169) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 73) == -1) {\n                                        global_failure_args[0] = (int64_t) zgze_lhs_74161;\n                                        global_failure_args[1] = (int64_t) stride_59631;\n                                        ;\n                                    }\n                                    return;\n                                }\n                            }\n                            zm_lhs_74174 = add64(tt_74116, n_74159);\n                            leq_arg0_74175 = sub64(zm_lhs_74174, (int64_t) 1);\n                            x_74176 = sle64((int64_t) 0, leq_arg0_74175);\n                            y_74177 = slt64(leq_arg0_74175, j_m_i_59655);\n                            bounds_check_74178 = x_74176 && y_74177;\n                            if (!bounds_check_74178) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 74) == -1) {\n                                        global_failure_args[0] = (int64_t) leq_arg0_74175;\n                                        global_failure_args[1] = (int64_t) j_m_i_59655;\n                 ", "                       ;\n                                    }\n                                    return;\n                                }\n                            }\n                            slice_74171 = zgze_lhs_74161 + index_primexp_77795;\n                            leq_arg1_74172 = ((__global int64_t *) mem_param_82052)[slice_74171];\n                            leq_arg1_74173 = ((__global int64_t *) mem_param_82055)[slice_74171];\n                            slice_74180 = stride_59631 + leq_arg0_74175;\n                            slice_74181 = slice_74180 + index_primexp_77795;\n                            leq_arg0_74182 = ((__global int64_t *) mem_param_82052)[slice_74181];\n                            leq_arg0_74183 = ((__global int64_t *) mem_param_82055)[slice_74181];\n                            futrts_lifted_lambda_11636(&defunc_0_leq_res_74184, leq_arg0_74182, leq_arg0_74183, leq_arg1_74172, leq_arg1_74173);\n                            leq_y_x_74166 = defunc_0_leq_res_74184;\n                        }\n                        if (leq_y_x_74166) {\n                            int64_t tmp_74188;\n                            int64_t tmp_74189;\n                            \n                            tmp_74188 = add64(tt_74116, n_74159);\n                            tmp_74189 = sub64(count_74118, n_74159);\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74185 = tmp_74188;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74186 = tt_74117;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74187 = tmp_74189;\n                        } else {\n                            int64_t tmp_74190 = add64(tt_74116, n_74159);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74185 = tt_74116;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74186 = tmp_74190;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_74187 = co",
                                    "unt_74118;\n                        }\n                        defunc_0_lifted_step_res_f_res_f_res_74134 = ss_74114;\n                        defunc_0_lifted_step_res_f_res_f_res_74135 = defunc_0_lifted_step_res_f_res_f_res_f_res_74185;\n                        defunc_0_lifted_step_res_f_res_f_res_74136 = defunc_0_lifted_step_res_f_res_f_res_f_res_74186;\n                        defunc_0_lifted_step_res_f_res_f_res_74137 = defunc_0_lifted_step_res_f_res_f_res_f_res_74187;\n                    }\n                    defunc_0_lifted_step_res_f_res_74128 = defunc_0_lifted_step_res_f_res_f_res_74134;\n                    defunc_0_lifted_step_res_f_res_74129 = defunc_0_lifted_step_res_f_res_f_res_74135;\n                    defunc_0_lifted_step_res_f_res_74130 = defunc_0_lifted_step_res_f_res_f_res_74136;\n                    defunc_0_lifted_step_res_f_res_74131 = defunc_0_lifted_step_res_f_res_f_res_74137;\n                }\n                defunc_0_lifted_step_res_74121 = defunc_0_lifted_step_res_f_res_74128;\n                defunc_0_lifted_step_res_74122 = defunc_0_lifted_step_res_f_res_74129;\n                defunc_0_lifted_step_res_74123 = defunc_0_lifted_step_res_f_res_74130;\n                defunc_0_lifted_step_res_74124 = defunc_0_lifted_step_res_f_res_74131;\n            }\n            futrts_lifted_normalizze_11537(&loopres_74191, &loopres_74192, &loopres_74193, &loopres_74194, &loopres_74195, defunc_0_lifted_step_res_74121, ss_74115, defunc_0_lifted_step_res_74122, defunc_0_lifted_step_res_74123, defunc_0_lifted_step_res_74124);\n            loop_cond_74196 = slt64((int64_t) 0, loopres_74195);\n            loop_while_tmp_83505 = loop_cond_74196;\n            ss_tmp_83506 = loopres_74191;\n            ss_tmp_83507 = loopres_74192;\n            tt_tmp_83508 = loopres_74193;\n            tt_tmp_83509 = loopres_74194;\n            count_tmp_83510 = loopres_74195;\n            loop_while_74113 = loop_while_tmp_83505;\n            ss_74114 = ss_tmp_83506;\n            ss_74115 = ss_tmp_8", "3507;\n            tt_74116 = tt_tmp_83508;\n            tt_74117 = tt_tmp_83509;\n            count_74118 = count_tmp_83510;\n        }\n        defunc_0_split_count_res_74107 = loop_while_74113;\n        defunc_0_split_count_res_74108 = ss_74114;\n        defunc_0_split_count_res_74109 = ss_74115;\n        defunc_0_split_count_res_74110 = tt_74116;\n        defunc_0_split_count_res_74111 = tt_74117;\n        defunc_0_split_count_res_74112 = count_74118;\n        ((__global int64_t *) mem_82062)[gtid_74093 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 + gtid_74094] = defunc_0_split_count_res_74108;\n        ((__global int64_t *) mem_82065)[gtid_74093 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 + gtid_74094] = defunc_0_split_count_res_74110;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74089\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_74218_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_74218(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t stride_59631, int64_t next_stride_59632, int64_t num_merges_59636, int64_t num_blocks_59653, int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *mem_82058, __global unsigned char *mem_82062, __global unsigned char *mem_82065, __global unsigned char *mem_82069, __global unsigned char *mem_82072, __global unsigned char *mem_82075, __global unsigned char *mem_82078, __global unsigned char *mem_82081, __global unsigned char *mem_82082, __global unsigned char *mem_82085, __global unsigned char *mem_82086)\n{\n    #define segmap_tblock_sizze_74206 (make_collisions_compact_doublezisegmap_74218zisegmap_tblock_sizze_74206)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83513;\n    int32_t tblock_sizze_83516;\n    int32_t wave_sizze_83515;\n    int32_t block_id_83514;\n    int32_t global_", "tid_83512;\n    int64_t phys_tid_74218;\n    int64_t global_tid_83517;\n    int64_t slice_83518;\n    int64_t slice_83519;\n    int64_t gtid_74216;\n    int64_t remnant_83520;\n    int64_t gtid_74217;\n    int64_t remnant_83521;\n    \n    local_tid_83513 = get_local_id(0);\n    tblock_sizze_83516 = get_local_size(0);\n    wave_sizze_83515 = LOCKSTEP_WIDTH;\n    block_id_83514 = get_tblock_id(0);\n    global_tid_83512 = block_id_83514 * tblock_sizze_83516 + local_tid_83513;\n    phys_tid_74218 = sext_i32_i64(global_tid_83512);\n    global_tid_83517 = sext_i32_i64(block_id_83514) * segmap_tblock_sizze_74206 + sext_i32_i64(local_tid_83513);\n    slice_83518 = num_blocks_59653;\n    slice_83519 = num_merges_59636 * slice_83518;\n    gtid_74216 = squot64(global_tid_83517, slice_83518);\n    remnant_83520 = global_tid_83517 - gtid_74216 * slice_83518;\n    gtid_74217 = remnant_83520;\n    remnant_83521 = remnant_83520 - gtid_74217;\n    if (slt64(gtid_74216, num_merges_59636) && slt64(gtid_74217, num_blocks_59653)) {\n        bool y_74226;\n        bool index_certs_74228;\n        int64_t defunc_0_f_res_74229;\n        int64_t defunc_0_f_res_74230;\n        int64_t tmp_74231;\n        bool x_74232;\n        bool y_74233;\n        bool bounds_check_74234;\n        bool index_certs_74235;\n        int64_t defunc_0_f_res_74236;\n        int64_t defunc_0_f_res_74237;\n        int64_t merge_sequential_arg2_74238;\n        int64_t merge_sequential_arg2_74239;\n        int64_t j_m_i_74240;\n        bool empty_slice_74241;\n        int64_t m_74242;\n        int64_t i_p_m_t_s_74243;\n        bool zzero_leq_i_p_m_t_s_74244;\n        bool i_p_m_t_s_leq_w_74245;\n        bool zzero_lte_i_74246;\n        bool i_lte_j_74247;\n        bool y_74248;\n        bool y_74249;\n        bool forwards_ok_74250;\n        bool ok_or_empty_74251;\n        bool index_certs_74252;\n        int64_t j_m_i_74253;\n        bool empty_slice_74254;\n        int64_t m_74255;\n        int64_t i_p_m_t_s_74256;\n        bool zzero_leq_i_p_m_t_s_74257;\n        b",
                                    "ool i_p_m_t_s_leq_w_74258;\n        bool zzero_lte_i_74259;\n        bool i_lte_j_74260;\n        bool y_74261;\n        bool y_74262;\n        bool forwards_ok_74263;\n        bool ok_or_empty_74264;\n        bool index_certs_74265;\n        int64_t index_primexp_77792;\n        bool index_certs_74220;\n        bool index_certs_74221;\n        bool cond_74266;\n        int64_t dummy_74267;\n        int64_t dummy_74268;\n        \n        y_74226 = slt64(gtid_74217, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n        if (!y_74226) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 75) == -1) {\n                    global_failure_args[0] = (int64_t) gtid_74217;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                    ;\n                }\n                return;\n            }\n        }\n        defunc_0_f_res_74229 = ((__global int64_t *) mem_82062)[gtid_74216 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 + gtid_74217];\n        defunc_0_f_res_74230 = ((__global int64_t *) mem_82065)[gtid_74216 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 + gtid_74217];\n        tmp_74231 = add64((int64_t) 1, gtid_74217);\n        x_74232 = sle64((int64_t) 0, tmp_74231);\n        y_74233 = slt64(tmp_74231, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n        bounds_check_74234 = x_74232 && y_74233;\n        if (!bounds_check_74234) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 76) == -1) {\n                    global_failure_args[0] = (int64_t) tmp_74231;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                    ;\n                }\n                return;\n            }\n        }\n        defunc_0_f_res_74236 = ((__global int64_t *) mem_82062)[gtid_74216 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 + tmp_74231];\n        defunc_0_f_res_74237 = ((__global int64_t *) mem_82065)[gtid_74216 * dzlz7bUZLzpZRz20U1z20U", "num_blocksz7dUzg_59654 + tmp_74231];\n        merge_sequential_arg2_74238 = add64(stride_59631, defunc_0_f_res_74230);\n        merge_sequential_arg2_74239 = add64(stride_59631, defunc_0_f_res_74237);\n        j_m_i_74240 = sub64(merge_sequential_arg2_74239, merge_sequential_arg2_74238);\n        empty_slice_74241 = j_m_i_74240 == (int64_t) 0;\n        m_74242 = sub64(j_m_i_74240, (int64_t) 1);\n        i_p_m_t_s_74243 = add64(merge_sequential_arg2_74238, m_74242);\n        zzero_leq_i_p_m_t_s_74244 = sle64((int64_t) 0, i_p_m_t_s_74243);\n        i_p_m_t_s_leq_w_74245 = slt64(i_p_m_t_s_74243, next_stride_59632);\n        zzero_lte_i_74246 = sle64((int64_t) 0, merge_sequential_arg2_74238);\n        i_lte_j_74247 = sle64(merge_sequential_arg2_74238, merge_sequential_arg2_74239);\n        y_74248 = i_p_m_t_s_leq_w_74245 && zzero_lte_i_74246;\n        y_74249 = zzero_leq_i_p_m_t_s_74244 && y_74248;\n        forwards_ok_74250 = i_lte_j_74247 && y_74249;\n        ok_or_empty_74251 = empty_slice_74241 || forwards_ok_74250;\n        if (!ok_or_empty_74251) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 77) == -1) {\n                    global_failure_args[0] = (int64_t) merge_sequential_arg2_74238;\n                    global_failure_args[1] = (int64_t) merge_sequential_arg2_74239;\n                    global_failure_args[2] = (int64_t) next_stride_59632;\n                    ;\n                }\n                return;\n            }\n        }\n        j_m_i_74253 = sub64(defunc_0_f_res_74236, defunc_0_f_res_74229);\n        empty_slice_74254 = j_m_i_74253 == (int64_t) 0;\n        m_74255 = sub64(j_m_i_74253, (int64_t) 1);\n        i_p_m_t_s_74256 = add64(defunc_0_f_res_74229, m_74255);\n        zzero_leq_i_p_m_t_s_74257 = sle64((int64_t) 0, i_p_m_t_s_74256);\n        i_p_m_t_s_leq_w_74258 = slt64(i_p_m_t_s_74256, next_stride_59632);\n        zzero_lte_i_74259 = sle64((int64_t) 0, defunc_0_f_res_74229);\n        i_lte_j_74260 = sle64(defunc_0_f_res_74229, defunc_0_f_", "res_74236);\n        y_74261 = i_p_m_t_s_leq_w_74258 && zzero_lte_i_74259;\n        y_74262 = zzero_leq_i_p_m_t_s_74257 && y_74261;\n        forwards_ok_74263 = i_lte_j_74260 && y_74262;\n        ok_or_empty_74264 = empty_slice_74254 || forwards_ok_74263;\n        if (!ok_or_empty_74264) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 78) == -1) {\n                    global_failure_args[0] = (int64_t) defunc_0_f_res_74229;\n                    global_failure_args[1] = (int64_t) defunc_0_f_res_74236;\n                    global_failure_args[2] = (int64_t) next_stride_59632;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_77792 = mul64(next_stride_59632, gtid_74216);\n        index_certs_74220 = 0;\n        index_certs_74221 = 0;\n        cond_74266 = slt64((int64_t) 0, j_m_i_74253);\n        if (cond_74266) {\n            bool index_certs_74269;\n            int64_t slice_74270;\n            int64_t head_res_74271;\n            int64_t head_res_74272;\n            \n            if (!cond_74266) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 79) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) j_m_i_74253;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_74270 = defunc_0_f_res_74229 + index_primexp_77792;\n            head_res_74271 = ((__global int64_t *) mem_param_82052)[slice_74270];\n            head_res_74272 = ((__global int64_t *) mem_param_82055)[slice_74270];\n            dummy_74267 = head_res_74271;\n            dummy_74268 = head_res_74272;\n        } else {\n            bool y_74273;\n            bool index_certs_74274;\n            int64_t slice_74275;\n            int64_t head_res_74276;\n            int64_t head_res_74277;\n            \n            y_74273 = slt64((int64_t) 0, j",
                                    "_m_i_74240);\n            if (!y_74273) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 80) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) j_m_i_74240;\n                        ;\n                    }\n                    return;\n                }\n            }\n            slice_74275 = merge_sequential_arg2_74238 + index_primexp_77792;\n            head_res_74276 = ((__global int64_t *) mem_param_82052)[slice_74275];\n            head_res_74277 = ((__global int64_t *) mem_param_82055)[slice_74275];\n            dummy_74267 = head_res_74276;\n            dummy_74268 = head_res_74277;\n        }\n        ((__global int64_t *) mem_82069)[gtid_74216 * num_blocks_59653 + gtid_74217] = dummy_74267;\n        ((__global int64_t *) mem_82072)[gtid_74216 * num_blocks_59653 + gtid_74217] = dummy_74268;\n        ((__global int64_t *) mem_82075)[gtid_74216 * num_blocks_59653 + gtid_74217] = defunc_0_f_res_74229;\n        ((__global int64_t *) mem_82078)[gtid_74216 * num_blocks_59653 + gtid_74217] = merge_sequential_arg2_74238;\n        ((__global int64_t *) mem_82081)[gtid_74216 * num_blocks_59653 + gtid_74217] = j_m_i_74240;\n        ((__global int64_t *) mem_82085)[gtid_74216 * num_blocks_59653 + gtid_74217] = j_m_i_74253;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74206\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegmap_74293_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_74293(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t greatest_divisor_leq_than_res_59511, int64_t next_stride_59632, int64_t num_merges_59636, int64_t num_blocks_59653, int64_t nest_sizze_74205, int64_t num_tblocks_74287, int32_t virt_num_tblocks_83568, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *", "mem_82058, __global unsigned char *mem_82075, __global unsigned char *mem_82078, __global unsigned char *mem_82081, __global unsigned char *mem_82082, __global unsigned char *mem_82085, __global unsigned char *mem_82086, __global unsigned char *mem_82111, __global unsigned char *mem_82128, __global unsigned char *mem_82164, __global unsigned char *mem_82181)\n{\n    #define segmap_tblock_sizze_74286 (make_collisions_compact_doublezisegmap_74293zisegmap_tblock_sizze_74286)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_83570;\n    int32_t tblock_sizze_83573;\n    int32_t wave_sizze_83572;\n    int32_t block_id_83571;\n    int32_t global_tid_83569;\n    int64_t phys_tid_74293;\n    int32_t phys_tblock_id_83574;\n    int32_t iterations_83575;\n    \n    local_tid_83570 = get_local_id(0);\n    tblock_sizze_83573 = get_local_size(0);\n    wave_sizze_83572 = LOCKSTEP_WIDTH;\n    block_id_83571 = get_tblock_id(0);\n    global_tid_83569 = block_id_83571 * tblock_sizze_83573 + local_tid_83570;\n    phys_tid_74293 = sext_i32_i64(global_tid_83569);\n    phys_tblock_id_83574 = get_tblock_id(0);\n    iterations_83575 = sdiv_up32(virt_num_tblocks_83568 - phys_tblock_id_83574, sext_i64_i32(num_tblocks_74287));\n    for (int32_t i_83576 = 0; i_83576 < iterations_83575; i_83576++) {\n        int32_t virt_tblock_id_83577;\n        int64_t global_tid_83578;\n        int64_t slice_83579;\n        int64_t slice_83580;\n        int64_t gtid_74291;\n        int64_t remnant_83581;\n        int64_t gtid_74292;\n        int64_t remnant_83582;\n        \n        virt_tblock_id_83577 = phys_tblock_id_83574 + i_83576 * sext_i64_i32(num_tblocks_74287);\n        global_tid_83578 = sext_i32_i64(virt_tblock_id_83577) * segmap_tblock_sizze_74286 + sext_i32_i64(local_tid_83570);\n        slice_83579 = num_blocks_59653;\n        slice_83580 = num_merges_59636 * slice_83579;\n        gtid_74291 = squot64(global_tid_83578, slice_83579);\n", "        remnant_83581 = global_tid_83578 - gtid_74291 * slice_83579;\n        gtid_74292 = remnant_83581;\n        remnant_83582 = remnant_83581 - gtid_74292;\n        if (slt64(gtid_74291, num_merges_59636) && slt64(gtid_74292, num_blocks_59653)) {\n            int64_t index_primexp_77789;\n            bool index_certs_74295;\n            bool index_certs_74296;\n            int64_t defunc_0_f_res_74297;\n            int64_t merge_sequential_arg2_74298;\n            int64_t j_m_i_74299;\n            bool index_certs_74300;\n            int64_t j_m_i_74301;\n            bool index_certs_74302;\n            int64_t binop_x_82136;\n            int64_t lmad_arg_82137;\n            int64_t data_74305;\n            int64_t i_74309;\n            \n            index_primexp_77789 = mul64(next_stride_59632, gtid_74291);\n            index_certs_74295 = 0;\n            index_certs_74296 = 0;\n            defunc_0_f_res_74297 = ((__global int64_t *) mem_82075)[gtid_74291 * num_blocks_59653 + gtid_74292];\n            merge_sequential_arg2_74298 = ((__global int64_t *) mem_82078)[gtid_74291 * num_blocks_59653 + gtid_74292];\n            j_m_i_74299 = ((__global int64_t *) mem_82081)[gtid_74291 * num_blocks_59653 + gtid_74292];\n            index_certs_74300 = 0;\n            j_m_i_74301 = ((__global int64_t *) mem_82085)[gtid_74291 * num_blocks_59653 + gtid_74292];\n            index_certs_74302 = 0;\n            binop_x_82136 = num_blocks_59653 * gtid_74291;\n            lmad_arg_82137 = gtid_74292 + binop_x_82136;\n            i_74309 = (int64_t) 0;\n            for (int64_t k_74308 = 0; k_74308 < greatest_divisor_leq_than_res_59511; k_74308++) {\n                int64_t j_74312;\n                bool cond_74313;\n                bool cond_74314;\n                int64_t loopres_74333;\n                int64_t loopres_74334;\n                int64_t loopres_74335;\n                int64_t i_tmp_83583;\n                \n                j_74312 = sub64(k_74308, i_74309);\n                cond_74313 = j_74312 == j_m",
                                    "_i_74299;\n                if (cond_74313) {\n                    cond_74314 = 1;\n                } else {\n                    bool cond_74315;\n                    bool cond_f_res_74316;\n                    \n                    cond_74315 = slt64(i_74309, j_m_i_74301);\n                    if (cond_74315) {\n                        bool x_74317;\n                        bool y_74318;\n                        bool bounds_check_74319;\n                        bool index_certs_74320;\n                        bool x_74325;\n                        bool bounds_check_74326;\n                        bool index_certs_74327;\n                        int64_t slice_74321;\n                        int64_t slice_74322;\n                        int64_t leq_arg1_74323;\n                        int64_t leq_arg1_74324;\n                        int64_t slice_74328;\n                        int64_t slice_74329;\n                        int64_t leq_arg0_74330;\n                        int64_t leq_arg0_74331;\n                        bool defunc_0_leq_res_74332;\n                        \n                        x_74317 = sle64((int64_t) 0, j_74312);\n                        y_74318 = slt64(j_74312, j_m_i_74299);\n                        bounds_check_74319 = x_74317 && y_74318;\n                        if (!bounds_check_74319) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 81) == -1) {\n                                    global_failure_args[0] = (int64_t) j_74312;\n                                    global_failure_args[1] = (int64_t) j_m_i_74299;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        x_74325 = sle64((int64_t) 0, i_74309);\n                        bounds_check_74326 = cond_74315 && x_74325;\n                        if (!bounds_check_74326) ", "{\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 82) == -1) {\n                                    global_failure_args[0] = (int64_t) i_74309;\n                                    global_failure_args[1] = (int64_t) j_m_i_74301;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        slice_74321 = merge_sequential_arg2_74298 + j_74312;\n                        slice_74322 = slice_74321 + index_primexp_77789;\n                        leq_arg1_74323 = ((__global int64_t *) mem_param_82052)[slice_74322];\n                        leq_arg1_74324 = ((__global int64_t *) mem_param_82055)[slice_74322];\n                        slice_74328 = defunc_0_f_res_74297 + i_74309;\n                        slice_74329 = slice_74328 + index_primexp_77789;\n                        leq_arg0_74330 = ((__global int64_t *) mem_param_82052)[slice_74329];\n                        leq_arg0_74331 = ((__global int64_t *) mem_param_82055)[slice_74329];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_74332, leq_arg0_74330, leq_arg0_74331, leq_arg1_74323, leq_arg1_74324);\n                        cond_f_res_74316 = defunc_0_leq_res_74332;\n                    } else {\n                        cond_f_res_74316 = 0;\n                    }\n                    cond_74314 = cond_f_res_74316;\n                }\n                if (cond_74314) {\n                    bool x_74337;\n                    bool y_74338;\n                    bool bounds_check_74339;\n                    bool index_certs_74340;\n                    int64_t tmp_74336;\n                    int64_t slice_74341;\n                    int64_t slice_74342;\n                    int64_t tmp_74343;\n                    int64_t tmp_74344;\n                    \n                    x_74337 = ", "sle64((int64_t) 0, i_74309);\n                    y_74338 = slt64(i_74309, j_m_i_74301);\n                    bounds_check_74339 = x_74337 && y_74338;\n                    if (!bounds_check_74339) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 83) == -1) {\n                                global_failure_args[0] = (int64_t) i_74309;\n                                global_failure_args[1] = (int64_t) j_m_i_74301;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    tmp_74336 = add64((int64_t) 1, i_74309);\n                    slice_74341 = defunc_0_f_res_74297 + i_74309;\n                    slice_74342 = slice_74341 + index_primexp_77789;\n                    tmp_74343 = ((__global int64_t *) mem_param_82052)[slice_74342];\n                    tmp_74344 = ((__global int64_t *) mem_param_82055)[slice_74342];\n                    loopres_74333 = tmp_74336;\n                    loopres_74334 = tmp_74343;\n                    loopres_74335 = tmp_74344;\n                } else {\n                    bool x_74345;\n                    bool y_74346;\n                    bool bounds_check_74347;\n                    bool index_certs_74348;\n                    int64_t slice_74349;\n                    int64_t slice_74350;\n                    int64_t tmp_74351;\n                    int64_t tmp_74352;\n                    \n                    x_74345 = sle64((int64_t) 0, j_74312);\n                    y_74346 = slt64(j_74312, j_m_i_74299);\n                    bounds_check_74347 = x_74345 && y_74346;\n                    if (!bounds_check_74347) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 84) == -1) {\n                                global_failure_args[0] = (int64_t) j_74312;\n                                global_fa",
                                    "ilure_args[1] = (int64_t) j_m_i_74299;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    slice_74349 = merge_sequential_arg2_74298 + j_74312;\n                    slice_74350 = slice_74349 + index_primexp_77789;\n                    tmp_74351 = ((__global int64_t *) mem_param_82052)[slice_74350];\n                    tmp_74352 = ((__global int64_t *) mem_param_82055)[slice_74350];\n                    loopres_74333 = i_74309;\n                    loopres_74334 = tmp_74351;\n                    loopres_74335 = tmp_74352;\n                }\n                ((__global int64_t *) mem_82111)[lmad_arg_82137 + k_74308 * nest_sizze_74205] = loopres_74334;\n                ((__global int64_t *) mem_82128)[lmad_arg_82137 + k_74308 * nest_sizze_74205] = loopres_74335;\n                i_tmp_83583 = loopres_74333;\n                i_74309 = i_tmp_83583;\n            }\n            data_74305 = i_74309;\n            for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n                ((__global int64_t *) mem_82164)[gtid_74291 * num_blocks_59653 + gtid_74292 + i_0 * (num_blocks_59653 * num_merges_59636)] = ((__global int64_t *) mem_82111)[lmad_arg_82137 + i_0 * nest_sizze_74205];\n            }\n            for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n                ((__global int64_t *) mem_82181)[gtid_74291 * num_blocks_59653 + gtid_74292 + i_0 * (num_blocks_59653 * num_merges_59636)] = ((__global int64_t *) mem_82128)[lmad_arg_82137 + i_0 * nest_sizze_74205];\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_74286\n}\nFUTHARK_KERNEL_SIZED(make_col", "lisions_compact_doublezisegmap_74392_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegmap_74392(__global int *global_failure, int64_t dz2084U_51542, int64_t m_60051, int64_t num_tblocks_74397, int32_t virt_num_tblocks_83712, __global unsigned char *ext_mem_82416, __global unsigned char *ext_mem_82419, __global unsigned char *mem_82422, __global unsigned char *mem_82424, __global unsigned char *mem_82426, __global unsigned char *mem_82428)\n{\n    #define segmap_tblock_sizze_74395 (make_collisions_compact_doublezisegmap_74392zisegmap_tblock_sizze_74395)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83714;\n    int32_t tblock_sizze_83717;\n    int32_t wave_sizze_83716;\n    int32_t block_id_83715;\n    int32_t global_tid_83713;\n    int64_t phys_tid_74392;\n    int32_t phys_tblock_id_83718;\n    int32_t iterations_83719;\n    \n    local_tid_83714 = get_local_id(0);\n    tblock_sizze_83717 = get_local_size(0);\n    wave_sizze_83716 = LOCKSTEP_WIDTH;\n    block_id_83715 = get_tblock_id(0);\n    global_tid_83713 = block_id_83715 * tblock_sizze_83717 + local_tid_83714;\n    phys_tid_74392 = sext_i32_i64(global_tid_83713);\n    phys_tblock_id_83718 = get_tblock_id(0);\n    iterations_83719 = sdiv_up32(virt_num_tblocks_83712 - phys_tblock_id_83718, sext_i64_i32(num_tblocks_74397));\n    for (int32_t i_83720 = 0; i_83720 < iterations_83719; i_83720++) {\n        int32_t virt_tblock_id_83721;\n        int64_t global_tid_83722;\n        int64_t slice_83723;\n        int64_t write_i_74391;\n        int64_t remnant_83724;\n        \n        virt_tblock_id_83721 = phys_tblock_id_83718 + i_83720 * sext_i64_i32(num_tblocks_74397);\n        global_tid_83722 = sext_i32_i64(virt_tblock_id_83721) * segmap_tblock_sizze_74395 + sext_i32_i64(local_tid_83714);\n        slice_83723 = dz2084U_51542;\n        write_i_74391 = global_tid_83722;\n        remnant_83724 = global_tid_83722 - write_i_74391;\n        if (slt64(write_i_74391, dz2084U_51542)) {\n            int64_t eta_p_63751;\n        ", "    int64_t write_value_63753;\n            int64_t write_value_63754;\n            bool cond_63755;\n            int64_t lifted_lambda_res_63756;\n            \n            eta_p_63751 = ((__global int64_t *) mem_82424)[write_i_74391];\n            write_value_63753 = ((__global int64_t *) ext_mem_82419)[write_i_74391];\n            write_value_63754 = ((__global int64_t *) ext_mem_82416)[write_i_74391];\n            cond_63755 = eta_p_63751 == (int64_t) 1;\n            if (cond_63755) {\n                int64_t eta_p_63752;\n                int64_t lifted_lambda_res_t_res_64170;\n                \n                eta_p_63752 = ((__global int64_t *) mem_82422)[write_i_74391];\n                lifted_lambda_res_t_res_64170 = sub64(eta_p_63752, (int64_t) 1);\n                lifted_lambda_res_63756 = lifted_lambda_res_t_res_64170;\n            } else {\n                lifted_lambda_res_63756 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63756) && slt64(lifted_lambda_res_63756, m_60051)) {\n                ((__global int64_t *) mem_82428)[lifted_lambda_res_63756] = write_value_63753;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63756) && slt64(lifted_lambda_res_63756, m_60051)) {\n                ((__global int64_t *) mem_82426)[lifted_lambda_res_63756] = write_value_63754;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_74395\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezisegmap_intrablock_71523(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t greatest_divisor_leq_than_res_59511, int64_t loop_dz2084Uz2082U_59627, int64_t stride_59631, int64_t next_stride_59632, unsigned char zzero_59633_bits, int64_t num_merges_59636, int64_t m_59641, unsigned char zzero_leq_i_p_m_t_s_59642_bits, unsigned char i_lte_j_59643_bits, unsigned char cond_59644_bits, int64_t num_blocks_5965",
                                    "3, int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, int64_t j_m_i_59655, unsigned char cond_59665_bits, int64_t computed_tblock_sizze_71276, int64_t bytes_82199, int64_t bytes_82203, int64_t bytes_82236, int64_t binop_x_82254, int64_t maxSubHelper_83087, int64_t maxSubHelper_83088, int32_t num_chunks_83284, int32_t num_chunks_83285, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82390, __global unsigned char *mem_82393)\n{\n    bool zzero_59633 = zzero_59633_bits;\n    bool zzero_leq_i_p_m_t_s_59642 = zzero_leq_i_p_m_t_s_59642_bits;\n    bool i_lte_j_59643 = i_lte_j_59643_bits;\n    bool cond_59644 = cond_59644_bits;\n    bool cond_59665 = cond_59665_bits;\n    volatile __local unsigned char *color_83102_backing_13 = &shared_mem[0];\n    const int64_t color_83102_backing_13_offset = 0 + (bytes_82199 + srem64((int64_t) 8 - srem64(bytes_82199, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83101_backing_12 = &shared_mem[color_83102_backing_13_offset];\n    const int64_t color_83101_backing_12_offset = color_83102_backing_13_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83100_backing_11 = &shared_mem[color_83101_backing_12_offset];\n    const int64_t color_83100_backing_11_offset = color_83101_backing_12_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83099_backing_10 = &shared_mem[color_83100_backing_11_offset];\n    const int64_t color_83099_backing_10_offset = color_83100_backing_11_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83098_backing_9 = &shared_mem[color_83099_backing_10_offset];\n    const int64_t color_83098_backing_9_offset = color_83099_backing_10_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, ", "(int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83097_backing_8 = &shared_mem[color_83098_backing_9_offset];\n    const int64_t color_83097_backing_8_offset = color_83098_backing_9_offset + (int64_t) 0;\n    volatile __local unsigned char *color_83096_backing_7 = &shared_mem[color_83097_backing_8_offset];\n    const int64_t color_83096_backing_7_offset = color_83097_backing_8_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83095_backing_6 = &shared_mem[color_83096_backing_7_offset];\n    const int64_t color_83095_backing_6_offset = color_83096_backing_7_offset + (int64_t) 0;\n    volatile __local unsigned char *color_83094_backing_5 = &shared_mem[color_83095_backing_6_offset];\n    const int64_t color_83094_backing_5_offset = color_83095_backing_6_offset + (maxSubHelper_83088 + srem64((int64_t) 8 - srem64(maxSubHelper_83088, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83093_backing_4 = &shared_mem[color_83094_backing_5_offset];\n    const int64_t color_83093_backing_4_offset = color_83094_backing_5_offset + (maxSubHelper_83087 + srem64((int64_t) 8 - srem64(maxSubHelper_83087, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83092_backing_3 = &shared_mem[color_83093_backing_4_offset];\n    const int64_t color_83092_backing_3_offset = color_83093_backing_4_offset + (bytes_82236 + srem64((int64_t) 8 - srem64(bytes_82236, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83091_backing_2 = &shared_mem[color_83092_backing_3_offset];\n    const int64_t color_83091_backing_2_offset = color_83092_backing_3_offset + (bytes_82236 + srem64((int64_t) 8 - srem64(bytes_82236, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83090_backing_1 = &shared_mem[color_83091_backing_2_offset];\n    const int64_t color_83090_backing_1_offset = color_83091_backing_2_offset + (binop_x_82254 + srem64((int", "64_t) 8 - srem64(binop_x_82254, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83089_backing_0 = &shared_mem[color_83090_backing_1_offset];\n    const int64_t color_83089_backing_0_offset = color_83090_backing_1_offset + (binop_x_82254 + srem64((int64_t) 8 - srem64(binop_x_82254, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_83290;\n    int32_t tblock_sizze_83293;\n    int32_t wave_sizze_83292;\n    int32_t block_id_83291;\n    int32_t global_tid_83289;\n    int64_t phys_tblock_id_71523;\n    int64_t slice_83296;\n    int64_t slice_83297;\n    int64_t ltid_pre_83294;\n    int64_t remnant_83298;\n    int64_t ltid_pre_83295;\n    int64_t remnant_83299;\n    int64_t slice_83301;\n    int64_t ltid_pre_83300;\n    int64_t remnant_83302;\n    int64_t slice_83304;\n    int64_t ltid_pre_83303;\n    int64_t remnant_83305;\n    int64_t slice_83307;\n    int64_t ltid_pre_83306;\n    int64_t remnant_83308;\n    int64_t slice_83309;\n    int64_t gtid_71522;\n    int64_t remnant_83310;\n    __local unsigned char *color_83089;\n    __local unsigned char *color_83090;\n    __local unsigned char *color_83091;\n    __local unsigned char *color_83092;\n    __local unsigned char *color_83093;\n    __local unsigned char *color_83094;\n    __local unsigned char *color_83095;\n    __local unsigned char *color_83096;\n    __local unsigned char *color_83097;\n    __local unsigned char *color_83098;\n    __local unsigned char *color_83099;\n    __local unsigned char *color_83100;\n    __local unsigned char *color_83101;\n    __local unsigned char *color_83102;\n    int64_t start_71525;\n    int64_t j_m_i_71526;\n    bool empty_slice_71527;\n    int64_t m_71528;\n    int64_t i_p_m_t_s_71529;\n    bool zzero_leq_i_p_m_t_s_71530;\n    bool i_p_m_t_s_leq_w_71531;\n    bool zzero_lte_i_71532;\n    bool i_lte_j_71533;\n    bool y_71534;\n    bool y_71535;\n    bool forwards_ok_71536;\n    bool ok_or_e",
                                    "mpty_71537;\n    bool index_certs_71538;\n    bool i_p_m_t_s_leq_w_71539;\n    bool y_71540;\n    bool forwards_ok_71541;\n    bool ok_or_empty_71542;\n    bool index_certs_71543;\n    __local unsigned char *ext_mem_82387;\n    __local unsigned char *ext_mem_82384;\n    int32_t num_chunks_83355;\n    int32_t num_chunks_83358;\n    \n    local_tid_83290 = get_local_id(0);\n    tblock_sizze_83293 = get_local_size(0);\n    wave_sizze_83292 = LOCKSTEP_WIDTH;\n    block_id_83291 = get_tblock_id(0);\n    global_tid_83289 = block_id_83291 * tblock_sizze_83293 + local_tid_83290;\n    phys_tblock_id_71523 = sext_i32_i64(block_id_83291);\n    slice_83296 = num_blocks_59653;\n    slice_83297 = greatest_divisor_leq_than_res_59511 * slice_83296;\n    ltid_pre_83294 = squot64(sext_i32_i64(local_tid_83290), slice_83296);\n    remnant_83298 = sext_i32_i64(local_tid_83290) - ltid_pre_83294 * slice_83296;\n    ltid_pre_83295 = remnant_83298;\n    remnant_83299 = remnant_83298 - ltid_pre_83295;\n    slice_83301 = next_stride_59632;\n    ltid_pre_83300 = sext_i32_i64(local_tid_83290);\n    remnant_83302 = sext_i32_i64(local_tid_83290) - ltid_pre_83300;\n    slice_83304 = num_blocks_59653;\n    ltid_pre_83303 = sext_i32_i64(local_tid_83290);\n    remnant_83305 = sext_i32_i64(local_tid_83290) - ltid_pre_83303;\n    slice_83307 = dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n    ltid_pre_83306 = sext_i32_i64(local_tid_83290);\n    remnant_83308 = sext_i32_i64(local_tid_83290) - ltid_pre_83306;\n    slice_83309 = num_merges_59636;\n    gtid_71522 = sext_i32_i64(block_id_83291);\n    remnant_83310 = sext_i32_i64(block_id_83291) - gtid_71522;\n    color_83089 = (__local unsigned char *) color_83089_backing_0;\n    color_83090 = (__local unsigned char *) color_83090_backing_1;\n    color_83091 = (__local unsigned char *) color_83091_backing_2;\n    color_83092 = (__local unsigned char *) color_83092_backing_3;\n    color_83093 = (__local unsigned char *) color_83093_backing_4;\n    color_83094 = (__local unsigned char *) color_8309", "4_backing_5;\n    color_83095 = (__local unsigned char *) color_83095_backing_6;\n    color_83096 = (__local unsigned char *) color_83096_backing_7;\n    color_83097 = (__local unsigned char *) color_83097_backing_8;\n    color_83098 = (__local unsigned char *) color_83098_backing_9;\n    color_83099 = (__local unsigned char *) color_83099_backing_10;\n    color_83100 = (__local unsigned char *) color_83100_backing_11;\n    color_83101 = (__local unsigned char *) color_83101_backing_12;\n    color_83102 = (__local unsigned char *) color_83102_backing_13;\n    start_71525 = mul64(next_stride_59632, gtid_71522);\n    j_m_i_71526 = sub64(loop_dz2084Uz2082U_59627, start_71525);\n    empty_slice_71527 = j_m_i_71526 == (int64_t) 0;\n    m_71528 = sub64(j_m_i_71526, (int64_t) 1);\n    i_p_m_t_s_71529 = add64(start_71525, m_71528);\n    zzero_leq_i_p_m_t_s_71530 = sle64((int64_t) 0, i_p_m_t_s_71529);\n    i_p_m_t_s_leq_w_71531 = slt64(i_p_m_t_s_71529, loop_dz2084Uz2082U_59627);\n    zzero_lte_i_71532 = sle64((int64_t) 0, start_71525);\n    i_lte_j_71533 = sle64(start_71525, loop_dz2084Uz2082U_59627);\n    y_71534 = i_p_m_t_s_leq_w_71531 && zzero_lte_i_71532;\n    y_71535 = zzero_leq_i_p_m_t_s_71530 && y_71534;\n    forwards_ok_71536 = i_lte_j_71533 && y_71535;\n    ok_or_empty_71537 = empty_slice_71527 || forwards_ok_71536;\n    if (!ok_or_empty_71537) {\n        {\n            if (atomic_cmpxchg_i32_global(global_failure, -1, 31) == -1) {\n                global_failure_args[0] = (int64_t) start_71525;\n                global_failure_args[1] = (int64_t) loop_dz2084Uz2082U_59627;\n                ;\n            }\n            local_failure = 1;\n            goto error_0;\n        }\n    }\n    i_p_m_t_s_leq_w_71539 = slt64(m_59641, j_m_i_71526);\n    y_71540 = zzero_leq_i_p_m_t_s_59642 && i_p_m_t_s_leq_w_71539;\n    forwards_ok_71541 = i_lte_j_59643 && y_71540;\n    ok_or_empty_71542 = zzero_59633 || forwards_ok_71541;\n    if (!ok_or_empty_71542) {\n        {\n            if (atomic_cmpxchg_i32_global(global_fa", "ilure, -1, 32) == -1) {\n                global_failure_args[0] = (int64_t) (int64_t) 0;\n                global_failure_args[1] = (int64_t) next_stride_59632;\n                global_failure_args[2] = (int64_t) j_m_i_71526;\n                ;\n            }\n            local_failure = 1;\n            goto error_0;\n        }\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_59644) {\n        int64_t dummy_71546;\n        int64_t dummy_71547;\n        int64_t data_71555;\n        int64_t i_71559;\n        \n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (cond_59665) {\n            int64_t head_res_71548;\n            int64_t head_res_71549;\n            \n            head_res_71548 = ((__global int64_t *) mem_param_82052)[start_71525];\n            head_res_71549 = ((__global int64_t *) mem_param_82055)[start_71525];\n            dummy_71546 = head_res_71548;\n            dummy_71547 = head_res_71549;\n        } else {\n            int64_t slice_71550;\n            int64_t head_res_71551;\n            int64_t head_res_71552;\n            \n            slice_71550 = stride_59631 + start_71525;\n            head_res_71551 = ((__global int64_t *) mem_param_82052)[slice_71550];\n            head_res_71552 = ((__global int64_t *) mem_param_82055)[slice_71550];\n            dummy_71546 = head_res_71551;\n            dummy_71547 = head_res_71552;\n        }\n        for (int32_t chunk_i_83313 = 0; chunk_i_83313 < num_chunks_83285; chunk_i_83313++) {\n            int32_t i_83314;\n            int64_t slice_83315;\n            int64_t rep_i_83312;\n            int64_t remnant_83316;\n            \n            i_83314 = chunk_i_83313 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n            slice_83315 = next_stride_59632;\n            rep_i_83312 = sext_i32_i64(i_83314);\n            remnant_83316 = sext_i32_i64(i_83314) - rep_i_83312;\n            if (sle64((int64_t) 0, rep_i_83312) && slt64(rep_i_83312, ",
                                    "next_stride_59632)) {\n                ((__local int64_t *) color_83090)[rep_i_83312] = dummy_71546;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t chunk_i_83319 = 0; chunk_i_83319 < num_chunks_83285; chunk_i_83319++) {\n            int32_t i_83320;\n            int64_t slice_83321;\n            int64_t rep_i_83318;\n            int64_t remnant_83322;\n            \n            i_83320 = chunk_i_83319 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n            slice_83321 = next_stride_59632;\n            rep_i_83318 = sext_i32_i64(i_83320);\n            remnant_83322 = sext_i32_i64(i_83320) - rep_i_83318;\n            if (sle64((int64_t) 0, rep_i_83318) && slt64(rep_i_83318, next_stride_59632)) {\n                ((__local int64_t *) color_83089)[rep_i_83318] = dummy_71547;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        i_71559 = (int64_t) 0;\n        for (int64_t k_71558 = 0; k_71558 < next_stride_59632; k_71558++) {\n            int64_t j_71562;\n            bool cond_71563;\n            bool cond_71564;\n            int64_t loopres_71582;\n            int64_t loopres_71583;\n            int64_t loopres_71584;\n            int64_t i_tmp_83323;\n            \n            j_71562 = sub64(k_71558, i_71559);\n            cond_71563 = j_71562 == j_m_i_59655;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (cond_71563) {\n                cond_71564 = 1;\n            } else {\n                bool cond_71565;\n                bool cond_f_res_71566;\n                \n                cond_71565 = slt64(i_71559, stride_59631);\n                barrier(CLK_LOCAL_MEM_FENCE);\n                if (cond_71565) {\n                    bool x_71567;\n                    bool y_71568;\n                    bool bounds_check_71569;\n                    bool index_certs_71570;\n                    bool x_71575;\n                    bool bounds_check_71576;\n                    bool index_certs_71577;\n", "                    int64_t slice_71571;\n                    int64_t slice_71572;\n                    int64_t leq_arg1_71573;\n                    int64_t leq_arg1_71574;\n                    int64_t slice_71578;\n                    int64_t leq_arg0_71579;\n                    int64_t leq_arg0_71580;\n                    bool defunc_0_leq_res_71581;\n                    \n                    x_71567 = sle64((int64_t) 0, j_71562);\n                    y_71568 = slt64(j_71562, j_m_i_59655);\n                    bounds_check_71569 = x_71567 && y_71568;\n                    if (!bounds_check_71569) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 33) == -1) {\n                                global_failure_args[0] = (int64_t) j_71562;\n                                global_failure_args[1] = (int64_t) j_m_i_59655;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_5;\n                        }\n                    }\n                    x_71575 = sle64((int64_t) 0, i_71559);\n                    bounds_check_71576 = cond_71565 && x_71575;\n                    if (!bounds_check_71576) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 34) == -1) {\n                                global_failure_args[0] = (int64_t) i_71559;\n                                global_failure_args[1] = (int64_t) stride_59631;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_5;\n                        }\n                    }\n                    slice_71571 = stride_59631 + j_71562;\n                    slice_71572 = start_71525 + slice_71571;\n                    leq_arg1_71573 = ((__global int64_t *) mem_param_82052)[slice_71572];\n                    leq_arg1_71574 = ((__global int64_t *) mem_param_82055)[s", "lice_71572];\n                    slice_71578 = start_71525 + i_71559;\n                    leq_arg0_71579 = ((__global int64_t *) mem_param_82052)[slice_71578];\n                    leq_arg0_71580 = ((__global int64_t *) mem_param_82055)[slice_71578];\n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_71581, leq_arg0_71579, leq_arg0_71580, leq_arg1_71573, leq_arg1_71574);\n                    cond_f_res_71566 = defunc_0_leq_res_71581;\n                } else {\n                    cond_f_res_71566 = 0;\n                }\n                cond_71564 = cond_f_res_71566;\n            }\n            \n          error_5:\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_failure)\n                return;\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (cond_71564) {\n                bool x_71586;\n                bool y_71587;\n                bool bounds_check_71588;\n                bool index_certs_71589;\n                int64_t tmp_71585;\n                int64_t slice_71590;\n                int64_t tmp_71591;\n                int64_t tmp_71592;\n                \n                x_71586 = sle64((int64_t) 0, i_71559);\n                y_71587 = slt64(i_71559, stride_59631);\n                bounds_check_71588 = x_71586 && y_71587;\n                if (!bounds_check_71588) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 35) == -1) {\n                            global_failure_args[0] = (int64_t) i_71559;\n                            global_failure_args[1] = (int64_t) stride_59631;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_6;\n                    }\n                }\n                tmp_71585 = add64((int64_t) 1, i_71559);\n                slice_71590 = start_71525 + i_71559;\n                tmp_71591 = ((__global int64_t *) mem_param_82052)[slice_71590];\n                tmp_71592 = ((__global int64_t *) mem_param_82055)",
                                    "[slice_71590];\n                loopres_71582 = tmp_71585;\n                loopres_71583 = tmp_71591;\n                loopres_71584 = tmp_71592;\n            } else {\n                bool x_71593;\n                bool y_71594;\n                bool bounds_check_71595;\n                bool index_certs_71596;\n                int64_t slice_71597;\n                int64_t slice_71598;\n                int64_t tmp_71599;\n                int64_t tmp_71600;\n                \n                x_71593 = sle64((int64_t) 0, j_71562);\n                y_71594 = slt64(j_71562, j_m_i_59655);\n                bounds_check_71595 = x_71593 && y_71594;\n                if (!bounds_check_71595) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 36) == -1) {\n                            global_failure_args[0] = (int64_t) j_71562;\n                            global_failure_args[1] = (int64_t) j_m_i_59655;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_6;\n                    }\n                }\n                slice_71597 = stride_59631 + j_71562;\n                slice_71598 = start_71525 + slice_71597;\n                tmp_71599 = ((__global int64_t *) mem_param_82052)[slice_71598];\n                tmp_71600 = ((__global int64_t *) mem_param_82055)[slice_71598];\n                loopres_71582 = i_71559;\n                loopres_71583 = tmp_71599;\n                loopres_71584 = tmp_71600;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83290 == 0) {\n                ((__local int64_t *) color_83090)[k_71558] = loopres_71583;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83290 == 0) {\n                ((__local int64_t *) color_83089)[k_71558] = loopres_71584;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            i_tmp_83323 = loopres_71582;\n      ", "      i_71559 = i_tmp_83323;\n        }\n        data_71555 = i_71559;\n        ext_mem_82387 = color_83090;\n        ext_mem_82384 = color_83089;\n    } else {\n        int64_t phys_tid_71607;\n        int64_t gtid_71606;\n        int64_t phys_tid_71716;\n        int64_t gtid_71715;\n        int64_t phys_tid_71780;\n        int64_t gtid_71779;\n        \n        phys_tid_71607 = sext_i32_i64(local_tid_83290);\n        gtid_71606 = sext_i32_i64(sext_i64_i32(ltid_pre_83306));\n        if (slt64(gtid_71606, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654)) {\n            int64_t split_count_arg3_71609;\n            int64_t defunc_0_split_count_res_71610;\n            int64_t defunc_0_split_count_res_71611;\n            int64_t defunc_0_split_count_res_71612;\n            int64_t defunc_0_split_count_res_71613;\n            int64_t defunc_0_split_count_res_71614;\n            bool loop_cond_71615;\n            bool defunc_0_split_count_res_71616;\n            int64_t defunc_0_split_count_res_71617;\n            int64_t defunc_0_split_count_res_71618;\n            int64_t defunc_0_split_count_res_71619;\n            int64_t defunc_0_split_count_res_71620;\n            int64_t defunc_0_split_count_res_71621;\n            bool loop_while_71622;\n            int64_t ss_71623;\n            int64_t ss_71624;\n            int64_t tt_71625;\n            int64_t tt_71626;\n            int64_t count_71627;\n            \n            split_count_arg3_71609 = mul64(greatest_divisor_leq_than_res_59511, gtid_71606);\n            futrts_lifted_normalizze_11537(&defunc_0_split_count_res_71610, &defunc_0_split_count_res_71611, &defunc_0_split_count_res_71612, &defunc_0_split_count_res_71613, &defunc_0_split_count_res_71614, (int64_t) 0, stride_59631, (int64_t) 0, j_m_i_59655, split_count_arg3_71609);\n            loop_cond_71615 = slt64((int64_t) 0, defunc_0_split_count_res_71614);\n            loop_while_71622 = loop_cond_71615;\n            ss_71623 = defunc_0_split_count_res_71610;\n            ss_71624 = defunc_0_split_count", "_res_71611;\n            tt_71625 = defunc_0_split_count_res_71612;\n            tt_71626 = defunc_0_split_count_res_71613;\n            count_71627 = defunc_0_split_count_res_71614;\n            while (loop_while_71622) {\n                int64_t zlze_lhs_71628;\n                bool cond_71629;\n                int64_t defunc_0_lifted_step_res_71630;\n                int64_t defunc_0_lifted_step_res_71631;\n                int64_t defunc_0_lifted_step_res_71632;\n                int64_t defunc_0_lifted_step_res_71633;\n                int64_t loopres_71700;\n                int64_t loopres_71701;\n                int64_t loopres_71702;\n                int64_t loopres_71703;\n                int64_t loopres_71704;\n                bool loop_cond_71705;\n                bool loop_while_tmp_83326;\n                int64_t ss_tmp_83327;\n                int64_t ss_tmp_83328;\n                int64_t tt_tmp_83329;\n                int64_t tt_tmp_83330;\n                int64_t count_tmp_83331;\n                \n                zlze_lhs_71628 = sub64(ss_71624, ss_71623);\n                cond_71629 = sle64(zlze_lhs_71628, (int64_t) 0);\n                if (cond_71629) {\n                    int64_t tmp_71634 = add64(tt_71625, count_71627);\n                    \n                    defunc_0_lifted_step_res_71630 = ss_71623;\n                    defunc_0_lifted_step_res_71631 = tmp_71634;\n                    defunc_0_lifted_step_res_71632 = tt_71626;\n                    defunc_0_lifted_step_res_71633 = (int64_t) 0;\n                } else {\n                    int64_t zlze_lhs_71635;\n                    bool cond_71636;\n                    int64_t defunc_0_lifted_step_res_f_res_71637;\n                    int64_t defunc_0_lifted_step_res_f_res_71638;\n                    int64_t defunc_0_lifted_step_res_f_res_71639;\n                    int64_t defunc_0_lifted_step_res_f_res_71640;\n                    \n                    zlze_lhs_71635 = sub64(tt_71626, tt_71625);\n                    cond_71636 = sle6",
                                    "4(zlze_lhs_71635, (int64_t) 0);\n                    if (cond_71636) {\n                        int64_t tmp_71641 = add64(ss_71623, count_71627);\n                        \n                        defunc_0_lifted_step_res_f_res_71637 = tmp_71641;\n                        defunc_0_lifted_step_res_f_res_71638 = tt_71625;\n                        defunc_0_lifted_step_res_f_res_71639 = tt_71626;\n                        defunc_0_lifted_step_res_f_res_71640 = (int64_t) 0;\n                    } else {\n                        bool cond_71642;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_71643;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_71644;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_71645;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_71646;\n                        \n                        cond_71642 = count_71627 == (int64_t) 1;\n                        if (cond_71642) {\n                            bool x_71647;\n                            bool y_71648;\n                            bool bounds_check_71649;\n                            bool index_certs_71650;\n                            bool x_71654;\n                            bool y_71655;\n                            bool bounds_check_71656;\n                            bool index_certs_71657;\n                            int64_t slice_71651;\n                            int64_t leq_arg1_71652;\n                            int64_t leq_arg1_71653;\n                            int64_t slice_71658;\n                            int64_t slice_71659;\n                            int64_t leq_arg0_71660;\n                            int64_t leq_arg0_71661;\n                            bool defunc_0_leq_res_71662;\n                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_71663;\n                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_71664;\n                            \n                            x_71647 = ", "sle64((int64_t) 0, ss_71623);\n                            y_71648 = slt64(ss_71623, stride_59631);\n                            bounds_check_71649 = x_71647 && y_71648;\n                            if (!bounds_check_71649) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 37) == -1) {\n                                        global_failure_args[0] = (int64_t) ss_71623;\n                                        global_failure_args[1] = (int64_t) stride_59631;\n                                        ;\n                                    }\n                                    local_failure = 1;\n                                    goto error_6;\n                                }\n                            }\n                            x_71654 = sle64((int64_t) 0, tt_71625);\n                            y_71655 = slt64(tt_71625, j_m_i_59655);\n                            bounds_check_71656 = x_71654 && y_71655;\n                            if (!bounds_check_71656) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 38) == -1) {\n                                        global_failure_args[0] = (int64_t) tt_71625;\n                                        global_failure_args[1] = (int64_t) j_m_i_59655;\n                                        ;\n                                    }\n                                    local_failure = 1;\n                                    goto error_6;\n                                }\n                            }\n                            slice_71651 = start_71525 + ss_71623;\n                            leq_arg1_71652 = ((__global int64_t *) mem_param_82052)[slice_71651];\n                            leq_arg1_71653 = ((__global int64_t *) mem_param_82055)[slice_71651];\n                            slice_71658 = stride_59631 + tt_71625;\n                            slice_71659 = start_71525 + slice_71658;\n        ", "                    leq_arg0_71660 = ((__global int64_t *) mem_param_82052)[slice_71659];\n                            leq_arg0_71661 = ((__global int64_t *) mem_param_82055)[slice_71659];\n                            futrts_lifted_lambda_11636(&defunc_0_leq_res_71662, leq_arg0_71660, leq_arg0_71661, leq_arg1_71652, leq_arg1_71653);\n                            if (defunc_0_leq_res_71662) {\n                                int64_t tmp_71665 = add64((int64_t) 1, tt_71625);\n                                \n                                defunc_0_lifted_step_res_f_res_f_res_t_res_71663 = ss_71623;\n                                defunc_0_lifted_step_res_f_res_f_res_t_res_71664 = tmp_71665;\n                            } else {\n                                int64_t tmp_71666 = add64((int64_t) 1, ss_71623);\n                                \n                                defunc_0_lifted_step_res_f_res_f_res_t_res_71663 = tmp_71666;\n                                defunc_0_lifted_step_res_f_res_f_res_t_res_71664 = tt_71625;\n                            }\n                            defunc_0_lifted_step_res_f_res_f_res_71643 = defunc_0_lifted_step_res_f_res_f_res_t_res_71663;\n                            defunc_0_lifted_step_res_f_res_f_res_71644 = defunc_0_lifted_step_res_f_res_f_res_t_res_71664;\n                            defunc_0_lifted_step_res_f_res_f_res_71645 = tt_71626;\n                            defunc_0_lifted_step_res_f_res_f_res_71646 = (int64_t) 0;\n                        } else {\n                            int64_t m_71667;\n                            int64_t n_71668;\n                            bool cond_71669;\n                            int64_t zgze_lhs_71670;\n                            bool cond_f_res_71671;\n                            bool x_71672;\n                            bool y_71673;\n                            bool cond_71674;\n                            bool leq_y_x_71675;\n                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_",
                                    "res_71694;\n                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_71695;\n                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_71696;\n                            \n                            m_71667 = sdiv64(count_71627, (int64_t) 2);\n                            n_71668 = sub64(count_71627, m_71667);\n                            cond_71669 = n_71668 == (int64_t) 0;\n                            zgze_lhs_71670 = add64(ss_71623, m_71667);\n                            cond_f_res_71671 = sle64(ss_71624, zgze_lhs_71670);\n                            x_71672 = !cond_71669;\n                            y_71673 = cond_f_res_71671 && x_71672;\n                            cond_71674 = cond_71669 || y_71673;\n                            if (cond_71674) {\n                                leq_y_x_71675 = 1;\n                            } else {\n                                bool x_71676;\n                                bool y_71677;\n                                bool bounds_check_71678;\n                                bool index_certs_71679;\n                                int64_t zm_lhs_71683;\n                                int64_t leq_arg0_71684;\n                                bool x_71685;\n                                bool y_71686;\n                                bool bounds_check_71687;\n                                bool index_certs_71688;\n                                int64_t slice_71680;\n                                int64_t leq_arg1_71681;\n                                int64_t leq_arg1_71682;\n                                int64_t slice_71689;\n                                int64_t slice_71690;\n                                int64_t leq_arg0_71691;\n                                int64_t leq_arg0_71692;\n                                bool defunc_0_leq_res_71693;\n                                \n                                x_71676 = sle64((int64_t) 0, zgze_lhs_71670);\n                                y_71677 = ", "slt64(zgze_lhs_71670, stride_59631);\n                                bounds_check_71678 = x_71676 && y_71677;\n                                if (!bounds_check_71678) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 39) == -1) {\n                                            global_failure_args[0] = (int64_t) zgze_lhs_71670;\n                                            global_failure_args[1] = (int64_t) stride_59631;\n                                            ;\n                                        }\n                                        local_failure = 1;\n                                        goto error_6;\n                                    }\n                                }\n                                zm_lhs_71683 = add64(tt_71625, n_71668);\n                                leq_arg0_71684 = sub64(zm_lhs_71683, (int64_t) 1);\n                                x_71685 = sle64((int64_t) 0, leq_arg0_71684);\n                                y_71686 = slt64(leq_arg0_71684, j_m_i_59655);\n                                bounds_check_71687 = x_71685 && y_71686;\n                                if (!bounds_check_71687) {\n                                    {\n                                        if (atomic_cmpxchg_i32_global(global_failure, -1, 40) == -1) {\n                                            global_failure_args[0] = (int64_t) leq_arg0_71684;\n                                            global_failure_args[1] = (int64_t) j_m_i_59655;\n                                            ;\n                                        }\n                                        local_failure = 1;\n                                        goto error_6;\n                                    }\n                                }\n                                slice_71680 = start_71525 + zgze_lhs_71670;\n                                leq_arg1_71681 = ((__global int64_t *) mem_param_82052)[slice_71680];\n      ", "                          leq_arg1_71682 = ((__global int64_t *) mem_param_82055)[slice_71680];\n                                slice_71689 = stride_59631 + leq_arg0_71684;\n                                slice_71690 = start_71525 + slice_71689;\n                                leq_arg0_71691 = ((__global int64_t *) mem_param_82052)[slice_71690];\n                                leq_arg0_71692 = ((__global int64_t *) mem_param_82055)[slice_71690];\n                                futrts_lifted_lambda_11636(&defunc_0_leq_res_71693, leq_arg0_71691, leq_arg0_71692, leq_arg1_71681, leq_arg1_71682);\n                                leq_y_x_71675 = defunc_0_leq_res_71693;\n                            }\n                            if (leq_y_x_71675) {\n                                int64_t tmp_71697;\n                                int64_t tmp_71698;\n                                \n                                tmp_71697 = add64(tt_71625, n_71668);\n                                tmp_71698 = sub64(count_71627, n_71668);\n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71694 = tmp_71697;\n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71695 = tt_71626;\n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71696 = tmp_71698;\n                            } else {\n                                int64_t tmp_71699 = add64(tt_71625, n_71668);\n                                \n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71694 = tt_71625;\n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71695 = tmp_71699;\n                                defunc_0_lifted_step_res_f_res_f_res_f_res_71696 = count_71627;\n                            }\n                            defunc_0_lifted_step_res_f_res_f_res_71643 = ss_71623;\n                            defunc_0_lifted_step_res_f_res_f_res_71644 = defunc_0_lifted_step_res_f_res_f_res_f_res_71694;\n                        ",
                                    "    defunc_0_lifted_step_res_f_res_f_res_71645 = defunc_0_lifted_step_res_f_res_f_res_f_res_71695;\n                            defunc_0_lifted_step_res_f_res_f_res_71646 = defunc_0_lifted_step_res_f_res_f_res_f_res_71696;\n                        }\n                        defunc_0_lifted_step_res_f_res_71637 = defunc_0_lifted_step_res_f_res_f_res_71643;\n                        defunc_0_lifted_step_res_f_res_71638 = defunc_0_lifted_step_res_f_res_f_res_71644;\n                        defunc_0_lifted_step_res_f_res_71639 = defunc_0_lifted_step_res_f_res_f_res_71645;\n                        defunc_0_lifted_step_res_f_res_71640 = defunc_0_lifted_step_res_f_res_f_res_71646;\n                    }\n                    defunc_0_lifted_step_res_71630 = defunc_0_lifted_step_res_f_res_71637;\n                    defunc_0_lifted_step_res_71631 = defunc_0_lifted_step_res_f_res_71638;\n                    defunc_0_lifted_step_res_71632 = defunc_0_lifted_step_res_f_res_71639;\n                    defunc_0_lifted_step_res_71633 = defunc_0_lifted_step_res_f_res_71640;\n                }\n                futrts_lifted_normalizze_11537(&loopres_71700, &loopres_71701, &loopres_71702, &loopres_71703, &loopres_71704, defunc_0_lifted_step_res_71630, ss_71624, defunc_0_lifted_step_res_71631, defunc_0_lifted_step_res_71632, defunc_0_lifted_step_res_71633);\n                loop_cond_71705 = slt64((int64_t) 0, loopres_71704);\n                loop_while_tmp_83326 = loop_cond_71705;\n                ss_tmp_83327 = loopres_71700;\n                ss_tmp_83328 = loopres_71701;\n                tt_tmp_83329 = loopres_71702;\n                tt_tmp_83330 = loopres_71703;\n                count_tmp_83331 = loopres_71704;\n                loop_while_71622 = loop_while_tmp_83326;\n                ss_71623 = ss_tmp_83327;\n                ss_71624 = ss_tmp_83328;\n                tt_71625 = tt_tmp_83329;\n                tt_71626 = tt_tmp_83330;\n                count_71627 = count_tmp_83331;\n            }\n            de", "func_0_split_count_res_71616 = loop_while_71622;\n            defunc_0_split_count_res_71617 = ss_71623;\n            defunc_0_split_count_res_71618 = ss_71624;\n            defunc_0_split_count_res_71619 = tt_71625;\n            defunc_0_split_count_res_71620 = tt_71626;\n            defunc_0_split_count_res_71621 = count_71627;\n            ((__local int64_t *) color_83102)[gtid_71606] = defunc_0_split_count_res_71617;\n            ((__local int64_t *) color_83094)[gtid_71606] = defunc_0_split_count_res_71619;\n        }\n        \n      error_6:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        phys_tid_71716 = sext_i32_i64(local_tid_83290);\n        gtid_71715 = sext_i32_i64(sext_i64_i32(ltid_pre_83303));\n        if (slt64(gtid_71715, num_blocks_59653)) {\n            bool y_71719;\n            bool index_certs_71721;\n            int64_t defunc_0_f_res_71722;\n            int64_t defunc_0_f_res_71723;\n            int64_t tmp_71724;\n            bool x_71725;\n            bool y_71726;\n            bool bounds_check_71727;\n            bool index_certs_71728;\n            int64_t defunc_0_f_res_71729;\n            int64_t defunc_0_f_res_71730;\n            int64_t merge_sequential_arg2_71731;\n            int64_t merge_sequential_arg2_71732;\n            int64_t j_m_i_71733;\n            bool empty_slice_71734;\n            int64_t m_71735;\n            int64_t i_p_m_t_s_71736;\n            bool zzero_leq_i_p_m_t_s_71737;\n            bool i_p_m_t_s_leq_w_71738;\n            bool zzero_lte_i_71739;\n            bool i_lte_j_71740;\n            bool y_71741;\n            bool y_71742;\n            bool forwards_ok_71743;\n            bool ok_or_empty_71744;\n            bool index_certs_71745;\n            int64_t j_m_i_71746;\n            bool empty_slice_71747;\n            int64_t m_71748;\n            int64_t i_p_m_t_s_71749;\n            bool zzero_leq_i_p_m_t_s_71750;\n            bool i_p_m_t_s_leq_w_71751;\n          ", "  bool zzero_lte_i_71752;\n            bool i_lte_j_71753;\n            bool y_71754;\n            bool y_71755;\n            bool forwards_ok_71756;\n            bool ok_or_empty_71757;\n            bool index_certs_71758;\n            bool cond_71759;\n            int64_t dummy_71760;\n            int64_t dummy_71761;\n            \n            y_71719 = slt64(gtid_71715, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n            if (!y_71719) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 41) == -1) {\n                        global_failure_args[0] = (int64_t) gtid_71715;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_7;\n                }\n            }\n            defunc_0_f_res_71722 = ((__local int64_t *) color_83102)[gtid_71715];\n            defunc_0_f_res_71723 = ((__local int64_t *) color_83094)[gtid_71715];\n            tmp_71724 = add64((int64_t) 1, gtid_71715);\n            x_71725 = sle64((int64_t) 0, tmp_71724);\n            y_71726 = slt64(tmp_71724, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n            bounds_check_71727 = x_71725 && y_71726;\n            if (!bounds_check_71727) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 42) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_71724;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_7;\n                }\n            }\n            defunc_0_f_res_71729 = ((__local int64_t *) color_83102)[tmp_71724];\n            defunc_0_f_res_71730 = ((__local int64_t *) color_83094)[tmp_71724];\n            merge_sequential_arg2_71731 = add64(stride_59631, defunc_0_f_res_71723);\n  ",
                                    "          merge_sequential_arg2_71732 = add64(stride_59631, defunc_0_f_res_71730);\n            j_m_i_71733 = sub64(merge_sequential_arg2_71732, merge_sequential_arg2_71731);\n            empty_slice_71734 = j_m_i_71733 == (int64_t) 0;\n            m_71735 = sub64(j_m_i_71733, (int64_t) 1);\n            i_p_m_t_s_71736 = add64(merge_sequential_arg2_71731, m_71735);\n            zzero_leq_i_p_m_t_s_71737 = sle64((int64_t) 0, i_p_m_t_s_71736);\n            i_p_m_t_s_leq_w_71738 = slt64(i_p_m_t_s_71736, next_stride_59632);\n            zzero_lte_i_71739 = sle64((int64_t) 0, merge_sequential_arg2_71731);\n            i_lte_j_71740 = sle64(merge_sequential_arg2_71731, merge_sequential_arg2_71732);\n            y_71741 = i_p_m_t_s_leq_w_71738 && zzero_lte_i_71739;\n            y_71742 = zzero_leq_i_p_m_t_s_71737 && y_71741;\n            forwards_ok_71743 = i_lte_j_71740 && y_71742;\n            ok_or_empty_71744 = empty_slice_71734 || forwards_ok_71743;\n            if (!ok_or_empty_71744) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 43) == -1) {\n                        global_failure_args[0] = (int64_t) merge_sequential_arg2_71731;\n                        global_failure_args[1] = (int64_t) merge_sequential_arg2_71732;\n                        global_failure_args[2] = (int64_t) next_stride_59632;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_7;\n                }\n            }\n            j_m_i_71746 = sub64(defunc_0_f_res_71729, defunc_0_f_res_71722);\n            empty_slice_71747 = j_m_i_71746 == (int64_t) 0;\n            m_71748 = sub64(j_m_i_71746, (int64_t) 1);\n            i_p_m_t_s_71749 = add64(defunc_0_f_res_71722, m_71748);\n            zzero_leq_i_p_m_t_s_71750 = sle64((int64_t) 0, i_p_m_t_s_71749);\n            i_p_m_t_s_leq_w_71751 = slt64(i_p_m_t_s_71749, next_stride_59632);\n            zzero_lte_i_71752 = sle64((int64_t) 0, defunc_0_f_res_71722);\n            i_", "lte_j_71753 = sle64(defunc_0_f_res_71722, defunc_0_f_res_71729);\n            y_71754 = i_p_m_t_s_leq_w_71751 && zzero_lte_i_71752;\n            y_71755 = zzero_leq_i_p_m_t_s_71750 && y_71754;\n            forwards_ok_71756 = i_lte_j_71753 && y_71755;\n            ok_or_empty_71757 = empty_slice_71747 || forwards_ok_71756;\n            if (!ok_or_empty_71757) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 44) == -1) {\n                        global_failure_args[0] = (int64_t) defunc_0_f_res_71722;\n                        global_failure_args[1] = (int64_t) defunc_0_f_res_71729;\n                        global_failure_args[2] = (int64_t) next_stride_59632;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_7;\n                }\n            }\n            cond_71759 = slt64((int64_t) 0, j_m_i_71746);\n            if (cond_71759) {\n                bool index_certs_71762;\n                int64_t slice_71763;\n                int64_t head_res_71764;\n                int64_t head_res_71765;\n                \n                if (!cond_71759) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 45) == -1) {\n                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                            global_failure_args[1] = (int64_t) j_m_i_71746;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_7;\n                    }\n                }\n                slice_71763 = start_71525 + defunc_0_f_res_71722;\n                head_res_71764 = ((__global int64_t *) mem_param_82052)[slice_71763];\n                head_res_71765 = ((__global int64_t *) mem_param_82055)[slice_71763];\n                dummy_71760 = head_res_71764;\n                dummy_71761 = head_res_71765;\n            } else {\n                bool y_71766;\n                bool index_cert", "s_71767;\n                int64_t slice_71768;\n                int64_t head_res_71769;\n                int64_t head_res_71770;\n                \n                y_71766 = slt64((int64_t) 0, j_m_i_71733);\n                if (!y_71766) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 46) == -1) {\n                            global_failure_args[0] = (int64_t) (int64_t) 0;\n                            global_failure_args[1] = (int64_t) j_m_i_71733;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_7;\n                    }\n                }\n                slice_71768 = start_71525 + merge_sequential_arg2_71731;\n                head_res_71769 = ((__global int64_t *) mem_param_82052)[slice_71768];\n                head_res_71770 = ((__global int64_t *) mem_param_82055)[slice_71768];\n                dummy_71760 = head_res_71769;\n                dummy_71761 = head_res_71770;\n            }\n            ((__local int64_t *) color_83093)[gtid_71715] = dummy_71760;\n            ((__local int64_t *) color_83101)[gtid_71715] = dummy_71761;\n            ((__local int64_t *) color_83100)[gtid_71715] = defunc_0_f_res_71722;\n            ((__local int64_t *) color_83099)[gtid_71715] = merge_sequential_arg2_71731;\n            ((__local int64_t *) color_83098)[gtid_71715] = j_m_i_71733;\n            ((__local int64_t *) color_83096)[gtid_71715] = j_m_i_71746;\n        }\n        \n      error_7:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t chunk_i_83335 = 0; chunk_i_83335 < num_chunks_83284; chunk_i_83335++) {\n            int32_t i_83336;\n            int64_t slice_83337;\n            int64_t slice_83338;\n            int64_t rep_i_83333;\n            int64_t remnant_83339;\n            int64_t rep_i_83334;\n            int64_t remnant_83340;\n            \n            i_83336 ",
                                    "= chunk_i_83335 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n            slice_83337 = num_blocks_59653;\n            slice_83338 = greatest_divisor_leq_than_res_59511 * slice_83337;\n            rep_i_83333 = squot64(sext_i32_i64(i_83336), slice_83337);\n            remnant_83339 = sext_i32_i64(i_83336) - rep_i_83333 * slice_83337;\n            rep_i_83334 = remnant_83339;\n            remnant_83340 = remnant_83339 - rep_i_83334;\n            if ((sle64((int64_t) 0, rep_i_83333) && slt64(rep_i_83333, greatest_divisor_leq_than_res_59511)) && (sle64((int64_t) 0, rep_i_83334) && slt64(rep_i_83334, num_blocks_59653))) {\n                int64_t tmp_83341 = ((__local int64_t *) color_83093)[rep_i_83334];\n                \n                ((__local int64_t *) color_83094)[rep_i_83333 * num_blocks_59653 + rep_i_83334] = tmp_83341;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t chunk_i_83345 = 0; chunk_i_83345 < num_chunks_83284; chunk_i_83345++) {\n            int32_t i_83346;\n            int64_t slice_83347;\n            int64_t slice_83348;\n            int64_t rep_i_83343;\n            int64_t remnant_83349;\n            int64_t rep_i_83344;\n            int64_t remnant_83350;\n            \n            i_83346 = chunk_i_83345 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n            slice_83347 = num_blocks_59653;\n            slice_83348 = greatest_divisor_leq_than_res_59511 * slice_83347;\n            rep_i_83343 = squot64(sext_i32_i64(i_83346), slice_83347);\n            remnant_83349 = sext_i32_i64(i_83346) - rep_i_83343 * slice_83347;\n            rep_i_83344 = remnant_83349;\n            remnant_83350 = remnant_83349 - rep_i_83344;\n            if ((sle64((int64_t) 0, rep_i_83343) && slt64(rep_i_83343, greatest_divisor_leq_than_res_59511)) && (sle64((int64_t) 0, rep_i_83344) && slt64(rep_i_83344, num_blocks_59653))) {\n                int64_t tmp_83351 = ((__local int64_t *) color_83101)[rep_i_83344];\n             ", "   \n                ((__local int64_t *) color_83093)[rep_i_83343 * num_blocks_59653 + rep_i_83344] = tmp_83351;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        phys_tid_71780 = sext_i32_i64(local_tid_83290);\n        gtid_71779 = sext_i32_i64(sext_i64_i32(ltid_pre_83303));\n        if (slt64(gtid_71779, num_blocks_59653)) {\n            int64_t defunc_0_f_res_71781;\n            int64_t merge_sequential_arg2_71782;\n            int64_t j_m_i_71783;\n            bool index_certs_71784;\n            int64_t j_m_i_71785;\n            bool index_certs_71786;\n            int64_t data_71789;\n            int64_t i_71793;\n            \n            defunc_0_f_res_71781 = ((__local int64_t *) color_83100)[gtid_71779];\n            merge_sequential_arg2_71782 = ((__local int64_t *) color_83099)[gtid_71779];\n            j_m_i_71783 = ((__local int64_t *) color_83098)[gtid_71779];\n            index_certs_71784 = 0;\n            j_m_i_71785 = ((__local int64_t *) color_83096)[gtid_71779];\n            index_certs_71786 = 0;\n            i_71793 = (int64_t) 0;\n            for (int64_t k_71792 = 0; k_71792 < greatest_divisor_leq_than_res_59511; k_71792++) {\n                int64_t j_71796;\n                bool cond_71797;\n                bool cond_71798;\n                int64_t loopres_71817;\n                int64_t loopres_71818;\n                int64_t loopres_71819;\n                int64_t i_tmp_83352;\n                \n                j_71796 = sub64(k_71792, i_71793);\n                cond_71797 = j_71796 == j_m_i_71783;\n                if (cond_71797) {\n                    cond_71798 = 1;\n                } else {\n                    bool cond_71799;\n                    bool cond_f_res_71800;\n                    \n                    cond_71799 = slt64(i_71793, j_m_i_71785);\n                    if (cond_71799) {\n                        bool x_71801;\n                        bool y_71802;\n                        bool bounds_check_71803;\n                        bool index_", "certs_71804;\n                        bool x_71809;\n                        bool bounds_check_71810;\n                        bool index_certs_71811;\n                        int64_t slice_71805;\n                        int64_t slice_71806;\n                        int64_t leq_arg1_71807;\n                        int64_t leq_arg1_71808;\n                        int64_t slice_71812;\n                        int64_t slice_71813;\n                        int64_t leq_arg0_71814;\n                        int64_t leq_arg0_71815;\n                        bool defunc_0_leq_res_71816;\n                        \n                        x_71801 = sle64((int64_t) 0, j_71796);\n                        y_71802 = slt64(j_71796, j_m_i_71783);\n                        bounds_check_71803 = x_71801 && y_71802;\n                        if (!bounds_check_71803) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 47) == -1) {\n                                    global_failure_args[0] = (int64_t) j_71796;\n                                    global_failure_args[1] = (int64_t) j_m_i_71783;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_8;\n                            }\n                        }\n                        x_71809 = sle64((int64_t) 0, i_71793);\n                        bounds_check_71810 = cond_71799 && x_71809;\n                        if (!bounds_check_71810) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 48) == -1) {\n                                    global_failure_args[0] = (int64_t) i_71793;\n                                    global_failure_args[1] = (int64_t) j_m_i_71785;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_8;\n      ",
                                    "                      }\n                        }\n                        slice_71805 = merge_sequential_arg2_71782 + j_71796;\n                        slice_71806 = start_71525 + slice_71805;\n                        leq_arg1_71807 = ((__global int64_t *) mem_param_82052)[slice_71806];\n                        leq_arg1_71808 = ((__global int64_t *) mem_param_82055)[slice_71806];\n                        slice_71812 = defunc_0_f_res_71781 + i_71793;\n                        slice_71813 = start_71525 + slice_71812;\n                        leq_arg0_71814 = ((__global int64_t *) mem_param_82052)[slice_71813];\n                        leq_arg0_71815 = ((__global int64_t *) mem_param_82055)[slice_71813];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_71816, leq_arg0_71814, leq_arg0_71815, leq_arg1_71807, leq_arg1_71808);\n                        cond_f_res_71800 = defunc_0_leq_res_71816;\n                    } else {\n                        cond_f_res_71800 = 0;\n                    }\n                    cond_71798 = cond_f_res_71800;\n                }\n                if (cond_71798) {\n                    bool x_71821;\n                    bool y_71822;\n                    bool bounds_check_71823;\n                    bool index_certs_71824;\n                    int64_t tmp_71820;\n                    int64_t slice_71825;\n                    int64_t slice_71826;\n                    int64_t tmp_71827;\n                    int64_t tmp_71828;\n                    \n                    x_71821 = sle64((int64_t) 0, i_71793);\n                    y_71822 = slt64(i_71793, j_m_i_71785);\n                    bounds_check_71823 = x_71821 && y_71822;\n                    if (!bounds_check_71823) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 49) == -1) {\n                                global_failure_args[0] = (int64_t) i_71793;\n                                global_failure_args[1] = (int64_t) j_m_i_71785;\n             ", "                   ;\n                            }\n                            local_failure = 1;\n                            goto error_8;\n                        }\n                    }\n                    tmp_71820 = add64((int64_t) 1, i_71793);\n                    slice_71825 = defunc_0_f_res_71781 + i_71793;\n                    slice_71826 = start_71525 + slice_71825;\n                    tmp_71827 = ((__global int64_t *) mem_param_82052)[slice_71826];\n                    tmp_71828 = ((__global int64_t *) mem_param_82055)[slice_71826];\n                    loopres_71817 = tmp_71820;\n                    loopres_71818 = tmp_71827;\n                    loopres_71819 = tmp_71828;\n                } else {\n                    bool x_71829;\n                    bool y_71830;\n                    bool bounds_check_71831;\n                    bool index_certs_71832;\n                    int64_t slice_71833;\n                    int64_t slice_71834;\n                    int64_t tmp_71835;\n                    int64_t tmp_71836;\n                    \n                    x_71829 = sle64((int64_t) 0, j_71796);\n                    y_71830 = slt64(j_71796, j_m_i_71783);\n                    bounds_check_71831 = x_71829 && y_71830;\n                    if (!bounds_check_71831) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 50) == -1) {\n                                global_failure_args[0] = (int64_t) j_71796;\n                                global_failure_args[1] = (int64_t) j_m_i_71783;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_8;\n                        }\n                    }\n                    slice_71833 = merge_sequential_arg2_71782 + j_71796;\n                    slice_71834 = start_71525 + slice_71833;\n                    tmp_71835 = ((__global int64_t *) mem_param_82052)[slice_71834];\n                    tmp_71836 =", " ((__global int64_t *) mem_param_82055)[slice_71834];\n                    loopres_71817 = i_71793;\n                    loopres_71818 = tmp_71835;\n                    loopres_71819 = tmp_71836;\n                }\n                ((__local int64_t *) color_83094)[gtid_71779 + k_71792 * num_blocks_59653] = loopres_71818;\n                ((__local int64_t *) color_83093)[gtid_71779 + k_71792 * num_blocks_59653] = loopres_71819;\n                i_tmp_83352 = loopres_71817;\n                i_71793 = i_tmp_83352;\n            }\n            data_71789 = i_71793;\n            for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n                ((__local int64_t *) color_83092)[gtid_71779 * greatest_divisor_leq_than_res_59511 + i_0] = ((__local int64_t *) color_83094)[gtid_71779 + i_0 * num_blocks_59653];\n            }\n            for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n                ((__local int64_t *) color_83091)[gtid_71779 * greatest_divisor_leq_than_res_59511 + i_0] = ((__local int64_t *) color_83093)[gtid_71779 + i_0 * num_blocks_59653];\n            }\n        }\n        \n      error_8:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ext_mem_82387 = color_83092;\n        ext_mem_82384 = color_83091;\n    }\n    num_chunks_83355 = sdiv_up32(sext_i64_i32(next_stride_59632), sext_i64_i32(computed_tblock_sizze_71276));\n    for (int32_t chunk_i_83356 = 0; chunk_i_83356 < num_chunks_83355; chunk_i_83356++) {\n        int32_t i_83357 = chunk_i_83356 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n        \n        if (slt32(i_83357, sext_i64_i32(next_stride_59632))) {\n            ((__global int64_t *) mem_82390)[gtid_71522 * next_stride_59632 + sext_i32_i64(i_83357)] = ((__local int64_t *) ext_mem_82387)[sext_i32_i64(i_83357)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_83358 = sdiv_up32(sext_i64_i32(next_stride",
                                    "_59632), sext_i64_i32(computed_tblock_sizze_71276));\n    for (int32_t chunk_i_83359 = 0; chunk_i_83359 < num_chunks_83358; chunk_i_83359++) {\n        int32_t i_83360 = chunk_i_83359 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83290;\n        \n        if (slt32(i_83360, sext_i64_i32(next_stride_59632))) {\n            ((__global int64_t *) mem_82393)[gtid_71522 * next_stride_59632 + sext_i32_i64(i_83360)] = ((__local int64_t *) ext_mem_82384)[sext_i32_i64(i_83360)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_9:\n    return;\n}\nFUTHARK_KERNEL\nvoid make_collisions_compact_doublezisegmap_intrablock_73841(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t greatest_divisor_leq_than_res_59511, int64_t stride_59631, int64_t next_stride_59632, int64_t num_merges_59636, int64_t num_blocks_59653, int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, int64_t j_m_i_59655, int64_t computed_tblock_sizze_71276, int64_t bytes_82203, int64_t maxSubHelper_83103, int64_t maxSubHelper_83104, int64_t maxSubHelper_83105, int64_t maxSubHelper_83106, int32_t num_chunks_83436, __global unsigned char *mem_param_82052, __global unsigned char *mem_param_82055, __global unsigned char *mem_82057, __global unsigned char *mem_82058, __global unsigned char *mem_82243, __global unsigned char *mem_82246)\n{\n    volatile __local unsigned char *color_83116_backing_9 = &shared_mem[0];\n    const int64_t color_83116_backing_9_offset = 0 + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83115_backing_8 = &shared_mem[color_83116_backing_9_offset];\n    const int64_t color_83115_backing_8_offset = color_83116_backing_9_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83114_backing_7 = &shared_mem[color_83115_backing_8_offset];\n    const int64_t color_83114_backing_7_off", "set = color_83115_backing_8_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83113_backing_6 = &shared_mem[color_83114_backing_7_offset];\n    const int64_t color_83113_backing_6_offset = color_83114_backing_7_offset + (int64_t) 0;\n    volatile __local unsigned char *color_83112_backing_5 = &shared_mem[color_83113_backing_6_offset];\n    const int64_t color_83112_backing_5_offset = color_83113_backing_6_offset + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83111_backing_4 = &shared_mem[color_83112_backing_5_offset];\n    const int64_t color_83111_backing_4_offset = color_83112_backing_5_offset + (int64_t) 0;\n    volatile __local unsigned char *color_83110_backing_3 = &shared_mem[color_83111_backing_4_offset];\n    const int64_t color_83110_backing_3_offset = color_83111_backing_4_offset + (maxSubHelper_83106 + srem64((int64_t) 8 - srem64(maxSubHelper_83106, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83109_backing_2 = &shared_mem[color_83110_backing_3_offset];\n    const int64_t color_83109_backing_2_offset = color_83110_backing_3_offset + (maxSubHelper_83105 + srem64((int64_t) 8 - srem64(maxSubHelper_83105, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83108_backing_1 = &shared_mem[color_83109_backing_2_offset];\n    const int64_t color_83108_backing_1_offset = color_83109_backing_2_offset + (maxSubHelper_83104 + srem64((int64_t) 8 - srem64(maxSubHelper_83104, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_83107_backing_0 = &shared_mem[color_83108_backing_1_offset];\n    const int64_t color_83107_backing_0_offset = color_83108_backing_1_offset + (maxSubHelper_83103 + srem64((int64_t) 8 - srem64(maxSubHelper_83103, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this", ".\n    local_failure = 0;\n    \n    int32_t local_tid_83441;\n    int32_t tblock_sizze_83444;\n    int32_t wave_sizze_83443;\n    int32_t block_id_83442;\n    int32_t global_tid_83440;\n    int64_t phys_tblock_id_73841;\n    int64_t slice_83447;\n    int64_t slice_83448;\n    int64_t ltid_pre_83445;\n    int64_t remnant_83449;\n    int64_t ltid_pre_83446;\n    int64_t remnant_83450;\n    int64_t slice_83452;\n    int64_t ltid_pre_83451;\n    int64_t remnant_83453;\n    int64_t slice_83455;\n    int64_t ltid_pre_83454;\n    int64_t remnant_83456;\n    int64_t slice_83457;\n    int64_t gtid_73840;\n    int64_t remnant_83458;\n    __local unsigned char *color_83107;\n    __local unsigned char *color_83108;\n    __local unsigned char *color_83109;\n    __local unsigned char *color_83110;\n    __local unsigned char *color_83111;\n    __local unsigned char *color_83112;\n    __local unsigned char *color_83113;\n    __local unsigned char *color_83114;\n    __local unsigned char *color_83115;\n    __local unsigned char *color_83116;\n    int64_t index_primexp_77786;\n    bool index_certs_73843;\n    bool index_certs_73844;\n    int64_t phys_tid_73848;\n    int64_t gtid_73847;\n    int64_t phys_tid_73956;\n    int64_t gtid_73955;\n    int64_t phys_tid_74020;\n    int64_t gtid_74019;\n    int32_t num_chunks_83488;\n    int32_t num_chunks_83491;\n    \n    local_tid_83441 = get_local_id(0);\n    tblock_sizze_83444 = get_local_size(0);\n    wave_sizze_83443 = LOCKSTEP_WIDTH;\n    block_id_83442 = get_tblock_id(0);\n    global_tid_83440 = block_id_83442 * tblock_sizze_83444 + local_tid_83441;\n    phys_tblock_id_73841 = sext_i32_i64(block_id_83442);\n    slice_83447 = num_blocks_59653;\n    slice_83448 = greatest_divisor_leq_than_res_59511 * slice_83447;\n    ltid_pre_83445 = squot64(sext_i32_i64(local_tid_83441), slice_83447);\n    remnant_83449 = sext_i32_i64(local_tid_83441) - ltid_pre_83445 * slice_83447;\n    ltid_pre_83446 = remnant_83449;\n    remnant_83450 = remnant_83449 - ltid_pre_83446;\n    slice_83452 = num_blocks_59653;\n",
                                    "    ltid_pre_83451 = sext_i32_i64(local_tid_83441);\n    remnant_83453 = sext_i32_i64(local_tid_83441) - ltid_pre_83451;\n    slice_83455 = dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n    ltid_pre_83454 = sext_i32_i64(local_tid_83441);\n    remnant_83456 = sext_i32_i64(local_tid_83441) - ltid_pre_83454;\n    slice_83457 = num_merges_59636;\n    gtid_73840 = sext_i32_i64(block_id_83442);\n    remnant_83458 = sext_i32_i64(block_id_83442) - gtid_73840;\n    color_83107 = (__local unsigned char *) color_83107_backing_0;\n    color_83108 = (__local unsigned char *) color_83108_backing_1;\n    color_83109 = (__local unsigned char *) color_83109_backing_2;\n    color_83110 = (__local unsigned char *) color_83110_backing_3;\n    color_83111 = (__local unsigned char *) color_83111_backing_4;\n    color_83112 = (__local unsigned char *) color_83112_backing_5;\n    color_83113 = (__local unsigned char *) color_83113_backing_6;\n    color_83114 = (__local unsigned char *) color_83114_backing_7;\n    color_83115 = (__local unsigned char *) color_83115_backing_8;\n    color_83116 = (__local unsigned char *) color_83116_backing_9;\n    index_primexp_77786 = mul64(next_stride_59632, gtid_73840);\n    index_certs_73843 = 0;\n    index_certs_73844 = 0;\n    phys_tid_73848 = sext_i32_i64(local_tid_83441);\n    gtid_73847 = sext_i32_i64(sext_i64_i32(ltid_pre_83454));\n    if (slt64(gtid_73847, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654)) {\n        int64_t split_count_arg3_73850;\n        int64_t defunc_0_split_count_res_73851;\n        int64_t defunc_0_split_count_res_73852;\n        int64_t defunc_0_split_count_res_73853;\n        int64_t defunc_0_split_count_res_73854;\n        int64_t defunc_0_split_count_res_73855;\n        bool loop_cond_73856;\n        bool defunc_0_split_count_res_73857;\n        int64_t defunc_0_split_count_res_73858;\n        int64_t defunc_0_split_count_res_73859;\n        int64_t defunc_0_split_count_res_73860;\n        int64_t defunc_0_split_count_res_73861;\n        int64_t defunc_0_sp", "lit_count_res_73862;\n        bool loop_while_73863;\n        int64_t ss_73864;\n        int64_t ss_73865;\n        int64_t tt_73866;\n        int64_t tt_73867;\n        int64_t count_73868;\n        \n        split_count_arg3_73850 = mul64(greatest_divisor_leq_than_res_59511, gtid_73847);\n        futrts_lifted_normalizze_11537(&defunc_0_split_count_res_73851, &defunc_0_split_count_res_73852, &defunc_0_split_count_res_73853, &defunc_0_split_count_res_73854, &defunc_0_split_count_res_73855, (int64_t) 0, stride_59631, (int64_t) 0, j_m_i_59655, split_count_arg3_73850);\n        loop_cond_73856 = slt64((int64_t) 0, defunc_0_split_count_res_73855);\n        loop_while_73863 = loop_cond_73856;\n        ss_73864 = defunc_0_split_count_res_73851;\n        ss_73865 = defunc_0_split_count_res_73852;\n        tt_73866 = defunc_0_split_count_res_73853;\n        tt_73867 = defunc_0_split_count_res_73854;\n        count_73868 = defunc_0_split_count_res_73855;\n        while (loop_while_73863) {\n            int64_t zlze_lhs_73869;\n            bool cond_73870;\n            int64_t defunc_0_lifted_step_res_73871;\n            int64_t defunc_0_lifted_step_res_73872;\n            int64_t defunc_0_lifted_step_res_73873;\n            int64_t defunc_0_lifted_step_res_73874;\n            int64_t loopres_73941;\n            int64_t loopres_73942;\n            int64_t loopres_73943;\n            int64_t loopres_73944;\n            int64_t loopres_73945;\n            bool loop_cond_73946;\n            bool loop_while_tmp_83459;\n            int64_t ss_tmp_83460;\n            int64_t ss_tmp_83461;\n            int64_t tt_tmp_83462;\n            int64_t tt_tmp_83463;\n            int64_t count_tmp_83464;\n            \n            zlze_lhs_73869 = sub64(ss_73865, ss_73864);\n            cond_73870 = sle64(zlze_lhs_73869, (int64_t) 0);\n            if (cond_73870) {\n                int64_t tmp_73875 = add64(tt_73866, count_73868);\n                \n                defunc_0_lifted_step_res_73871 = ss_73864;\n                defunc_0", "_lifted_step_res_73872 = tmp_73875;\n                defunc_0_lifted_step_res_73873 = tt_73867;\n                defunc_0_lifted_step_res_73874 = (int64_t) 0;\n            } else {\n                int64_t zlze_lhs_73876;\n                bool cond_73877;\n                int64_t defunc_0_lifted_step_res_f_res_73878;\n                int64_t defunc_0_lifted_step_res_f_res_73879;\n                int64_t defunc_0_lifted_step_res_f_res_73880;\n                int64_t defunc_0_lifted_step_res_f_res_73881;\n                \n                zlze_lhs_73876 = sub64(tt_73867, tt_73866);\n                cond_73877 = sle64(zlze_lhs_73876, (int64_t) 0);\n                if (cond_73877) {\n                    int64_t tmp_73882 = add64(ss_73864, count_73868);\n                    \n                    defunc_0_lifted_step_res_f_res_73878 = tmp_73882;\n                    defunc_0_lifted_step_res_f_res_73879 = tt_73866;\n                    defunc_0_lifted_step_res_f_res_73880 = tt_73867;\n                    defunc_0_lifted_step_res_f_res_73881 = (int64_t) 0;\n                } else {\n                    bool cond_73883;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_73884;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_73885;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_73886;\n                    int64_t defunc_0_lifted_step_res_f_res_f_res_73887;\n                    \n                    cond_73883 = count_73868 == (int64_t) 1;\n                    if (cond_73883) {\n                        bool x_73888;\n                        bool y_73889;\n                        bool bounds_check_73890;\n                        bool index_certs_73891;\n                        bool x_73895;\n                        bool y_73896;\n                        bool bounds_check_73897;\n                        bool index_certs_73898;\n                        int64_t slice_73892;\n                        int64_t leq_arg1_73893;\n                        int64_t leq_arg1_7389",
                                    "4;\n                        int64_t slice_73899;\n                        int64_t slice_73900;\n                        int64_t leq_arg0_73901;\n                        int64_t leq_arg0_73902;\n                        bool defunc_0_leq_res_73903;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_73904;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_73905;\n                        \n                        x_73888 = sle64((int64_t) 0, ss_73864);\n                        y_73889 = slt64(ss_73864, stride_59631);\n                        bounds_check_73890 = x_73888 && y_73889;\n                        if (!bounds_check_73890) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 57) == -1) {\n                                    global_failure_args[0] = (int64_t) ss_73864;\n                                    global_failure_args[1] = (int64_t) stride_59631;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        x_73895 = sle64((int64_t) 0, tt_73866);\n                        y_73896 = slt64(tt_73866, j_m_i_59655);\n                        bounds_check_73897 = x_73895 && y_73896;\n                        if (!bounds_check_73897) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 58) == -1) {\n                                    global_failure_args[0] = (int64_t) tt_73866;\n                                    global_failure_args[1] = (int64_t) j_m_i_59655;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        slice_73892 = ss_73864 + ", "index_primexp_77786;\n                        leq_arg1_73893 = ((__global int64_t *) mem_param_82052)[slice_73892];\n                        leq_arg1_73894 = ((__global int64_t *) mem_param_82055)[slice_73892];\n                        slice_73899 = stride_59631 + tt_73866;\n                        slice_73900 = slice_73899 + index_primexp_77786;\n                        leq_arg0_73901 = ((__global int64_t *) mem_param_82052)[slice_73900];\n                        leq_arg0_73902 = ((__global int64_t *) mem_param_82055)[slice_73900];\n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_73903, leq_arg0_73901, leq_arg0_73902, leq_arg1_73893, leq_arg1_73894);\n                        if (defunc_0_leq_res_73903) {\n                            int64_t tmp_73906 = add64((int64_t) 1, tt_73866);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_t_res_73904 = ss_73864;\n                            defunc_0_lifted_step_res_f_res_f_res_t_res_73905 = tmp_73906;\n                        } else {\n                            int64_t tmp_73907 = add64((int64_t) 1, ss_73864);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_t_res_73904 = tmp_73907;\n                            defunc_0_lifted_step_res_f_res_f_res_t_res_73905 = tt_73866;\n                        }\n                        defunc_0_lifted_step_res_f_res_f_res_73884 = defunc_0_lifted_step_res_f_res_f_res_t_res_73904;\n                        defunc_0_lifted_step_res_f_res_f_res_73885 = defunc_0_lifted_step_res_f_res_f_res_t_res_73905;\n                        defunc_0_lifted_step_res_f_res_f_res_73886 = tt_73867;\n                        defunc_0_lifted_step_res_f_res_f_res_73887 = (int64_t) 0;\n                    } else {\n                        int64_t m_73908;\n                        int64_t n_73909;\n                        bool cond_73910;\n                        int64_t zgze_lhs_73911;\n                        bool cond_f_res_73", "912;\n                        bool x_73913;\n                        bool y_73914;\n                        bool cond_73915;\n                        bool leq_y_x_73916;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_73935;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_73936;\n                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_73937;\n                        \n                        m_73908 = sdiv64(count_73868, (int64_t) 2);\n                        n_73909 = sub64(count_73868, m_73908);\n                        cond_73910 = n_73909 == (int64_t) 0;\n                        zgze_lhs_73911 = add64(ss_73864, m_73908);\n                        cond_f_res_73912 = sle64(ss_73865, zgze_lhs_73911);\n                        x_73913 = !cond_73910;\n                        y_73914 = cond_f_res_73912 && x_73913;\n                        cond_73915 = cond_73910 || y_73914;\n                        if (cond_73915) {\n                            leq_y_x_73916 = 1;\n                        } else {\n                            bool x_73917;\n                            bool y_73918;\n                            bool bounds_check_73919;\n                            bool index_certs_73920;\n                            int64_t zm_lhs_73924;\n                            int64_t leq_arg0_73925;\n                            bool x_73926;\n                            bool y_73927;\n                            bool bounds_check_73928;\n                            bool index_certs_73929;\n                            int64_t slice_73921;\n                            int64_t leq_arg1_73922;\n                            int64_t leq_arg1_73923;\n                            int64_t slice_73930;\n                            int64_t slice_73931;\n                            int64_t leq_arg0_73932;\n                            int64_t leq_arg0_73933;\n                            bool defunc_0_leq_res_73934;\n                            \n               ",
                                    "             x_73917 = sle64((int64_t) 0, zgze_lhs_73911);\n                            y_73918 = slt64(zgze_lhs_73911, stride_59631);\n                            bounds_check_73919 = x_73917 && y_73918;\n                            if (!bounds_check_73919) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 59) == -1) {\n                                        global_failure_args[0] = (int64_t) zgze_lhs_73911;\n                                        global_failure_args[1] = (int64_t) stride_59631;\n                                        ;\n                                    }\n                                    local_failure = 1;\n                                    goto error_0;\n                                }\n                            }\n                            zm_lhs_73924 = add64(tt_73866, n_73909);\n                            leq_arg0_73925 = sub64(zm_lhs_73924, (int64_t) 1);\n                            x_73926 = sle64((int64_t) 0, leq_arg0_73925);\n                            y_73927 = slt64(leq_arg0_73925, j_m_i_59655);\n                            bounds_check_73928 = x_73926 && y_73927;\n                            if (!bounds_check_73928) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure, -1, 60) == -1) {\n                                        global_failure_args[0] = (int64_t) leq_arg0_73925;\n                                        global_failure_args[1] = (int64_t) j_m_i_59655;\n                                        ;\n                                    }\n                                    local_failure = 1;\n                                    goto error_0;\n                                }\n                            }\n                            slice_73921 = zgze_lhs_73911 + index_primexp_77786;\n                            leq_arg1_73922 = ((__global int64_t *) mem_param_82052)[slice_73921];\n                     ", "       leq_arg1_73923 = ((__global int64_t *) mem_param_82055)[slice_73921];\n                            slice_73930 = stride_59631 + leq_arg0_73925;\n                            slice_73931 = slice_73930 + index_primexp_77786;\n                            leq_arg0_73932 = ((__global int64_t *) mem_param_82052)[slice_73931];\n                            leq_arg0_73933 = ((__global int64_t *) mem_param_82055)[slice_73931];\n                            futrts_lifted_lambda_11636(&defunc_0_leq_res_73934, leq_arg0_73932, leq_arg0_73933, leq_arg1_73922, leq_arg1_73923);\n                            leq_y_x_73916 = defunc_0_leq_res_73934;\n                        }\n                        if (leq_y_x_73916) {\n                            int64_t tmp_73938;\n                            int64_t tmp_73939;\n                            \n                            tmp_73938 = add64(tt_73866, n_73909);\n                            tmp_73939 = sub64(count_73868, n_73909);\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73935 = tmp_73938;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73936 = tt_73867;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73937 = tmp_73939;\n                        } else {\n                            int64_t tmp_73940 = add64(tt_73866, n_73909);\n                            \n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73935 = tt_73866;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73936 = tmp_73940;\n                            defunc_0_lifted_step_res_f_res_f_res_f_res_73937 = count_73868;\n                        }\n                        defunc_0_lifted_step_res_f_res_f_res_73884 = ss_73864;\n                        defunc_0_lifted_step_res_f_res_f_res_73885 = defunc_0_lifted_step_res_f_res_f_res_f_res_73935;\n                        defunc_0_lifted_step_res_f_res_f_res_73886 = defunc_0_lifted_step_res_f_res_f_res_f_res_73936;\n                ", "        defunc_0_lifted_step_res_f_res_f_res_73887 = defunc_0_lifted_step_res_f_res_f_res_f_res_73937;\n                    }\n                    defunc_0_lifted_step_res_f_res_73878 = defunc_0_lifted_step_res_f_res_f_res_73884;\n                    defunc_0_lifted_step_res_f_res_73879 = defunc_0_lifted_step_res_f_res_f_res_73885;\n                    defunc_0_lifted_step_res_f_res_73880 = defunc_0_lifted_step_res_f_res_f_res_73886;\n                    defunc_0_lifted_step_res_f_res_73881 = defunc_0_lifted_step_res_f_res_f_res_73887;\n                }\n                defunc_0_lifted_step_res_73871 = defunc_0_lifted_step_res_f_res_73878;\n                defunc_0_lifted_step_res_73872 = defunc_0_lifted_step_res_f_res_73879;\n                defunc_0_lifted_step_res_73873 = defunc_0_lifted_step_res_f_res_73880;\n                defunc_0_lifted_step_res_73874 = defunc_0_lifted_step_res_f_res_73881;\n            }\n            futrts_lifted_normalizze_11537(&loopres_73941, &loopres_73942, &loopres_73943, &loopres_73944, &loopres_73945, defunc_0_lifted_step_res_73871, ss_73865, defunc_0_lifted_step_res_73872, defunc_0_lifted_step_res_73873, defunc_0_lifted_step_res_73874);\n            loop_cond_73946 = slt64((int64_t) 0, loopres_73945);\n            loop_while_tmp_83459 = loop_cond_73946;\n            ss_tmp_83460 = loopres_73941;\n            ss_tmp_83461 = loopres_73942;\n            tt_tmp_83462 = loopres_73943;\n            tt_tmp_83463 = loopres_73944;\n            count_tmp_83464 = loopres_73945;\n            loop_while_73863 = loop_while_tmp_83459;\n            ss_73864 = ss_tmp_83460;\n            ss_73865 = ss_tmp_83461;\n            tt_73866 = tt_tmp_83462;\n            tt_73867 = tt_tmp_83463;\n            count_73868 = count_tmp_83464;\n        }\n        defunc_0_split_count_res_73857 = loop_while_73863;\n        defunc_0_split_count_res_73858 = ss_73864;\n        defunc_0_split_count_res_73859 = ss_73865;\n        defunc_0_split_count_res_73860 = tt_73866;\n        defunc_0_split_co",
                                    "unt_res_73861 = tt_73867;\n        defunc_0_split_count_res_73862 = count_73868;\n        ((__local int64_t *) color_83110)[gtid_73847] = defunc_0_split_count_res_73858;\n        ((__local int64_t *) color_83109)[gtid_73847] = defunc_0_split_count_res_73860;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    phys_tid_73956 = sext_i32_i64(local_tid_83441);\n    gtid_73955 = sext_i32_i64(sext_i64_i32(ltid_pre_83451));\n    if (slt64(gtid_73955, num_blocks_59653)) {\n        bool y_73959;\n        bool index_certs_73961;\n        int64_t defunc_0_f_res_73962;\n        int64_t defunc_0_f_res_73963;\n        int64_t tmp_73964;\n        bool x_73965;\n        bool y_73966;\n        bool bounds_check_73967;\n        bool index_certs_73968;\n        int64_t defunc_0_f_res_73969;\n        int64_t defunc_0_f_res_73970;\n        int64_t merge_sequential_arg2_73971;\n        int64_t merge_sequential_arg2_73972;\n        int64_t j_m_i_73973;\n        bool empty_slice_73974;\n        int64_t m_73975;\n        int64_t i_p_m_t_s_73976;\n        bool zzero_leq_i_p_m_t_s_73977;\n        bool i_p_m_t_s_leq_w_73978;\n        bool zzero_lte_i_73979;\n        bool i_lte_j_73980;\n        bool y_73981;\n        bool y_73982;\n        bool forwards_ok_73983;\n        bool ok_or_empty_73984;\n        bool index_certs_73985;\n        int64_t j_m_i_73986;\n        bool empty_slice_73987;\n        int64_t m_73988;\n        int64_t i_p_m_t_s_73989;\n        bool zzero_leq_i_p_m_t_s_73990;\n        bool i_p_m_t_s_leq_w_73991;\n        bool zzero_lte_i_73992;\n        bool i_lte_j_73993;\n        bool y_73994;\n        bool y_73995;\n        bool forwards_ok_73996;\n        bool ok_or_empty_73997;\n        bool index_certs_73998;\n        bool cond_73999;\n        int64_t dummy_74000;\n        int64_t dummy_74001;\n        \n        y_73959 = slt64(gtid_73955, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n        if (!y_73959) {\n            {\n                if (", "atomic_cmpxchg_i32_global(global_failure, -1, 61) == -1) {\n                    global_failure_args[0] = (int64_t) gtid_73955;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                    ;\n                }\n                local_failure = 1;\n                goto error_1;\n            }\n        }\n        defunc_0_f_res_73962 = ((__local int64_t *) color_83110)[gtid_73955];\n        defunc_0_f_res_73963 = ((__local int64_t *) color_83109)[gtid_73955];\n        tmp_73964 = add64((int64_t) 1, gtid_73955);\n        x_73965 = sle64((int64_t) 0, tmp_73964);\n        y_73966 = slt64(tmp_73964, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);\n        bounds_check_73967 = x_73965 && y_73966;\n        if (!bounds_check_73967) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 62) == -1) {\n                    global_failure_args[0] = (int64_t) tmp_73964;\n                    global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;\n                    ;\n                }\n                local_failure = 1;\n                goto error_1;\n            }\n        }\n        defunc_0_f_res_73969 = ((__local int64_t *) color_83110)[tmp_73964];\n        defunc_0_f_res_73970 = ((__local int64_t *) color_83109)[tmp_73964];\n        merge_sequential_arg2_73971 = add64(stride_59631, defunc_0_f_res_73963);\n        merge_sequential_arg2_73972 = add64(stride_59631, defunc_0_f_res_73970);\n        j_m_i_73973 = sub64(merge_sequential_arg2_73972, merge_sequential_arg2_73971);\n        empty_slice_73974 = j_m_i_73973 == (int64_t) 0;\n        m_73975 = sub64(j_m_i_73973, (int64_t) 1);\n        i_p_m_t_s_73976 = add64(merge_sequential_arg2_73971, m_73975);\n        zzero_leq_i_p_m_t_s_73977 = sle64((int64_t) 0, i_p_m_t_s_73976);\n        i_p_m_t_s_leq_w_73978 = slt64(i_p_m_t_s_73976, next_stride_59632);\n        zzero_lte_i_73979 = sle64((int64_t) 0, merge_sequential_arg2_73971);\n        i_lte_j_73980 = sl", "e64(merge_sequential_arg2_73971, merge_sequential_arg2_73972);\n        y_73981 = i_p_m_t_s_leq_w_73978 && zzero_lte_i_73979;\n        y_73982 = zzero_leq_i_p_m_t_s_73977 && y_73981;\n        forwards_ok_73983 = i_lte_j_73980 && y_73982;\n        ok_or_empty_73984 = empty_slice_73974 || forwards_ok_73983;\n        if (!ok_or_empty_73984) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 63) == -1) {\n                    global_failure_args[0] = (int64_t) merge_sequential_arg2_73971;\n                    global_failure_args[1] = (int64_t) merge_sequential_arg2_73972;\n                    global_failure_args[2] = (int64_t) next_stride_59632;\n                    ;\n                }\n                local_failure = 1;\n                goto error_1;\n            }\n        }\n        j_m_i_73986 = sub64(defunc_0_f_res_73969, defunc_0_f_res_73962);\n        empty_slice_73987 = j_m_i_73986 == (int64_t) 0;\n        m_73988 = sub64(j_m_i_73986, (int64_t) 1);\n        i_p_m_t_s_73989 = add64(defunc_0_f_res_73962, m_73988);\n        zzero_leq_i_p_m_t_s_73990 = sle64((int64_t) 0, i_p_m_t_s_73989);\n        i_p_m_t_s_leq_w_73991 = slt64(i_p_m_t_s_73989, next_stride_59632);\n        zzero_lte_i_73992 = sle64((int64_t) 0, defunc_0_f_res_73962);\n        i_lte_j_73993 = sle64(defunc_0_f_res_73962, defunc_0_f_res_73969);\n        y_73994 = i_p_m_t_s_leq_w_73991 && zzero_lte_i_73992;\n        y_73995 = zzero_leq_i_p_m_t_s_73990 && y_73994;\n        forwards_ok_73996 = i_lte_j_73993 && y_73995;\n        ok_or_empty_73997 = empty_slice_73987 || forwards_ok_73996;\n        if (!ok_or_empty_73997) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 64) == -1) {\n                    global_failure_args[0] = (int64_t) defunc_0_f_res_73962;\n                    global_failure_args[1] = (int64_t) defunc_0_f_res_73969;\n                    global_failure_args[2] = (int64_t) next_stride_59632;\n                    ;\n                }\n                local_failu",
                                    "re = 1;\n                goto error_1;\n            }\n        }\n        cond_73999 = slt64((int64_t) 0, j_m_i_73986);\n        if (cond_73999) {\n            bool index_certs_74002;\n            int64_t slice_74003;\n            int64_t head_res_74004;\n            int64_t head_res_74005;\n            \n            if (!cond_73999) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 65) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) j_m_i_73986;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_1;\n                }\n            }\n            slice_74003 = defunc_0_f_res_73962 + index_primexp_77786;\n            head_res_74004 = ((__global int64_t *) mem_param_82052)[slice_74003];\n            head_res_74005 = ((__global int64_t *) mem_param_82055)[slice_74003];\n            dummy_74000 = head_res_74004;\n            dummy_74001 = head_res_74005;\n        } else {\n            bool y_74006;\n            bool index_certs_74007;\n            int64_t slice_74008;\n            int64_t head_res_74009;\n            int64_t head_res_74010;\n            \n            y_74006 = slt64((int64_t) 0, j_m_i_73973);\n            if (!y_74006) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 66) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) j_m_i_73973;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_1;\n                }\n            }\n            slice_74008 = merge_sequential_arg2_73971 + index_primexp_77786;\n            head_res_74009 = ((__global int64_t *) mem_param_82052)[slice_74008];\n            head_res_74010 = ((__global int64_t *) mem_param_82055)[slice_74008];\n            dummy_74000 = head_res_740", "09;\n            dummy_74001 = head_res_74010;\n        }\n        ((__local int64_t *) color_83108)[gtid_73955] = dummy_74000;\n        ((__local int64_t *) color_83107)[gtid_73955] = dummy_74001;\n        ((__local int64_t *) color_83116)[gtid_73955] = defunc_0_f_res_73962;\n        ((__local int64_t *) color_83115)[gtid_73955] = merge_sequential_arg2_73971;\n        ((__local int64_t *) color_83114)[gtid_73955] = j_m_i_73973;\n        ((__local int64_t *) color_83112)[gtid_73955] = j_m_i_73986;\n    }\n    \n  error_1:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t chunk_i_83468 = 0; chunk_i_83468 < num_chunks_83436; chunk_i_83468++) {\n        int32_t i_83469;\n        int64_t slice_83470;\n        int64_t slice_83471;\n        int64_t rep_i_83466;\n        int64_t remnant_83472;\n        int64_t rep_i_83467;\n        int64_t remnant_83473;\n        \n        i_83469 = chunk_i_83468 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83441;\n        slice_83470 = num_blocks_59653;\n        slice_83471 = greatest_divisor_leq_than_res_59511 * slice_83470;\n        rep_i_83466 = squot64(sext_i32_i64(i_83469), slice_83470);\n        remnant_83472 = sext_i32_i64(i_83469) - rep_i_83466 * slice_83470;\n        rep_i_83467 = remnant_83472;\n        remnant_83473 = remnant_83472 - rep_i_83467;\n        if ((sle64((int64_t) 0, rep_i_83466) && slt64(rep_i_83466, greatest_divisor_leq_than_res_59511)) && (sle64((int64_t) 0, rep_i_83467) && slt64(rep_i_83467, num_blocks_59653))) {\n            int64_t tmp_83474 = ((__local int64_t *) color_83108)[rep_i_83467];\n            \n            ((__local int64_t *) color_83110)[rep_i_83466 * num_blocks_59653 + rep_i_83467] = tmp_83474;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t chunk_i_83478 = 0; chunk_i_83478 < num_chunks_83436; chunk_i_83478++) {\n        int32_t i_83479;\n        int64_t slice_83480;\n        int64_t slice_83481;\n        int64_t rep_i_83476;\n ", "       int64_t remnant_83482;\n        int64_t rep_i_83477;\n        int64_t remnant_83483;\n        \n        i_83479 = chunk_i_83478 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83441;\n        slice_83480 = num_blocks_59653;\n        slice_83481 = greatest_divisor_leq_than_res_59511 * slice_83480;\n        rep_i_83476 = squot64(sext_i32_i64(i_83479), slice_83480);\n        remnant_83482 = sext_i32_i64(i_83479) - rep_i_83476 * slice_83480;\n        rep_i_83477 = remnant_83482;\n        remnant_83483 = remnant_83482 - rep_i_83477;\n        if ((sle64((int64_t) 0, rep_i_83476) && slt64(rep_i_83476, greatest_divisor_leq_than_res_59511)) && (sle64((int64_t) 0, rep_i_83477) && slt64(rep_i_83477, num_blocks_59653))) {\n            int64_t tmp_83484 = ((__local int64_t *) color_83107)[rep_i_83477];\n            \n            ((__local int64_t *) color_83109)[rep_i_83476 * num_blocks_59653 + rep_i_83477] = tmp_83484;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    phys_tid_74020 = sext_i32_i64(local_tid_83441);\n    gtid_74019 = sext_i32_i64(sext_i64_i32(ltid_pre_83451));\n    if (slt64(gtid_74019, num_blocks_59653)) {\n        int64_t defunc_0_f_res_74021;\n        int64_t merge_sequential_arg2_74022;\n        int64_t j_m_i_74023;\n        bool index_certs_74024;\n        int64_t j_m_i_74025;\n        bool index_certs_74026;\n        int64_t data_74029;\n        int64_t i_74033;\n        \n        defunc_0_f_res_74021 = ((__local int64_t *) color_83116)[gtid_74019];\n        merge_sequential_arg2_74022 = ((__local int64_t *) color_83115)[gtid_74019];\n        j_m_i_74023 = ((__local int64_t *) color_83114)[gtid_74019];\n        index_certs_74024 = 0;\n        j_m_i_74025 = ((__local int64_t *) color_83112)[gtid_74019];\n        index_certs_74026 = 0;\n        i_74033 = (int64_t) 0;\n        for (int64_t k_74032 = 0; k_74032 < greatest_divisor_leq_than_res_59511; k_74032++) {\n            int64_t j_74036;\n            bool cond_74037;\n            bool cond_74038;\n            int64_t loopre",
                                    "s_74057;\n            int64_t loopres_74058;\n            int64_t loopres_74059;\n            int64_t i_tmp_83485;\n            \n            j_74036 = sub64(k_74032, i_74033);\n            cond_74037 = j_74036 == j_m_i_74023;\n            if (cond_74037) {\n                cond_74038 = 1;\n            } else {\n                bool cond_74039;\n                bool cond_f_res_74040;\n                \n                cond_74039 = slt64(i_74033, j_m_i_74025);\n                if (cond_74039) {\n                    bool x_74041;\n                    bool y_74042;\n                    bool bounds_check_74043;\n                    bool index_certs_74044;\n                    bool x_74049;\n                    bool bounds_check_74050;\n                    bool index_certs_74051;\n                    int64_t slice_74045;\n                    int64_t slice_74046;\n                    int64_t leq_arg1_74047;\n                    int64_t leq_arg1_74048;\n                    int64_t slice_74052;\n                    int64_t slice_74053;\n                    int64_t leq_arg0_74054;\n                    int64_t leq_arg0_74055;\n                    bool defunc_0_leq_res_74056;\n                    \n                    x_74041 = sle64((int64_t) 0, j_74036);\n                    y_74042 = slt64(j_74036, j_m_i_74023);\n                    bounds_check_74043 = x_74041 && y_74042;\n                    if (!bounds_check_74043) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 67) == -1) {\n                                global_failure_args[0] = (int64_t) j_74036;\n                                global_failure_args[1] = (int64_t) j_m_i_74023;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_2;\n                        }\n                    }\n                    x_74049 = sle64((int64_t) 0, i_74033);\n                    bounds_check_74050 = cond_74039 && x_74049;\n  ", "                  if (!bounds_check_74050) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 68) == -1) {\n                                global_failure_args[0] = (int64_t) i_74033;\n                                global_failure_args[1] = (int64_t) j_m_i_74025;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_2;\n                        }\n                    }\n                    slice_74045 = merge_sequential_arg2_74022 + j_74036;\n                    slice_74046 = slice_74045 + index_primexp_77786;\n                    leq_arg1_74047 = ((__global int64_t *) mem_param_82052)[slice_74046];\n                    leq_arg1_74048 = ((__global int64_t *) mem_param_82055)[slice_74046];\n                    slice_74052 = defunc_0_f_res_74021 + i_74033;\n                    slice_74053 = slice_74052 + index_primexp_77786;\n                    leq_arg0_74054 = ((__global int64_t *) mem_param_82052)[slice_74053];\n                    leq_arg0_74055 = ((__global int64_t *) mem_param_82055)[slice_74053];\n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_74056, leq_arg0_74054, leq_arg0_74055, leq_arg1_74047, leq_arg1_74048);\n                    cond_f_res_74040 = defunc_0_leq_res_74056;\n                } else {\n                    cond_f_res_74040 = 0;\n                }\n                cond_74038 = cond_f_res_74040;\n            }\n            if (cond_74038) {\n                bool x_74061;\n                bool y_74062;\n                bool bounds_check_74063;\n                bool index_certs_74064;\n                int64_t tmp_74060;\n                int64_t slice_74065;\n                int64_t slice_74066;\n                int64_t tmp_74067;\n                int64_t tmp_74068;\n                \n                x_74061 = sle64((int64_t) 0, i_74033);\n                y_74062 = slt64(i_74033, j_m_i_74025);\n                bound", "s_check_74063 = x_74061 && y_74062;\n                if (!bounds_check_74063) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 69) == -1) {\n                            global_failure_args[0] = (int64_t) i_74033;\n                            global_failure_args[1] = (int64_t) j_m_i_74025;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_2;\n                    }\n                }\n                tmp_74060 = add64((int64_t) 1, i_74033);\n                slice_74065 = defunc_0_f_res_74021 + i_74033;\n                slice_74066 = slice_74065 + index_primexp_77786;\n                tmp_74067 = ((__global int64_t *) mem_param_82052)[slice_74066];\n                tmp_74068 = ((__global int64_t *) mem_param_82055)[slice_74066];\n                loopres_74057 = tmp_74060;\n                loopres_74058 = tmp_74067;\n                loopres_74059 = tmp_74068;\n            } else {\n                bool x_74069;\n                bool y_74070;\n                bool bounds_check_74071;\n                bool index_certs_74072;\n                int64_t slice_74073;\n                int64_t slice_74074;\n                int64_t tmp_74075;\n                int64_t tmp_74076;\n                \n                x_74069 = sle64((int64_t) 0, j_74036);\n                y_74070 = slt64(j_74036, j_m_i_74023);\n                bounds_check_74071 = x_74069 && y_74070;\n                if (!bounds_check_74071) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 70) == -1) {\n                            global_failure_args[0] = (int64_t) j_74036;\n                            global_failure_args[1] = (int64_t) j_m_i_74023;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_2;\n                    }\n                }\n                slice_74073 = merge_sequentia",
                                    "l_arg2_74022 + j_74036;\n                slice_74074 = slice_74073 + index_primexp_77786;\n                tmp_74075 = ((__global int64_t *) mem_param_82052)[slice_74074];\n                tmp_74076 = ((__global int64_t *) mem_param_82055)[slice_74074];\n                loopres_74057 = i_74033;\n                loopres_74058 = tmp_74075;\n                loopres_74059 = tmp_74076;\n            }\n            ((__local int64_t *) color_83110)[gtid_74019 + k_74032 * num_blocks_59653] = loopres_74058;\n            ((__local int64_t *) color_83109)[gtid_74019 + k_74032 * num_blocks_59653] = loopres_74059;\n            i_tmp_83485 = loopres_74057;\n            i_74033 = i_tmp_83485;\n        }\n        data_74029 = i_74033;\n        for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n            ((__local int64_t *) color_83108)[gtid_74019 * greatest_divisor_leq_than_res_59511 + i_0] = ((__local int64_t *) color_83110)[gtid_74019 + i_0 * num_blocks_59653];\n        }\n        for (int64_t i_0 = 0; i_0 < greatest_divisor_leq_than_res_59511; i_0++) {\n            ((__local int64_t *) color_83107)[gtid_74019 * greatest_divisor_leq_than_res_59511 + i_0] = ((__local int64_t *) color_83109)[gtid_74019 + i_0 * num_blocks_59653];\n        }\n    }\n    \n  error_2:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_83488 = sdiv_up32(sext_i64_i32(next_stride_59632), sext_i64_i32(computed_tblock_sizze_71276));\n    for (int32_t chunk_i_83489 = 0; chunk_i_83489 < num_chunks_83488; chunk_i_83489++) {\n        int32_t i_83490 = chunk_i_83489 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83441;\n        \n        if (slt32(i_83490, sext_i64_i32(next_stride_59632))) {\n            ((__global int64_t *) mem_82243)[gtid_73840 * next_stride_59632 + sext_i32_i64(i_83490)] = ((__local int64_t *) color_83108)[sext_i32_i64(i_83490)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_83491 = sdiv_up32(s", "ext_i64_i32(next_stride_59632), sext_i64_i32(computed_tblock_sizze_71276));\n    for (int32_t chunk_i_83492 = 0; chunk_i_83492 < num_chunks_83491; chunk_i_83492++) {\n        int32_t i_83493 = chunk_i_83492 * sext_i64_i32(computed_tblock_sizze_71276) + local_tid_83441;\n        \n        if (slt32(i_83493, sext_i64_i32(next_stride_59632))) {\n            ((__global int64_t *) mem_82246)[gtid_73840 * next_stride_59632 + sext_i32_i64(i_83493)] = ((__local int64_t *) color_83107)[sext_i32_i64(i_83493)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_3:\n    return;\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegred_nonseg_70910_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegred_nonseg_70910(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2084U_51542, int64_t reduce_arg1_59514, int64_t reduce_arg1_59515, int64_t num_tblocks_70904, __global unsigned char *chain_collisions_mem_81927, __global unsigned char *chain_collisions_mem_81928, __global unsigned char *mem_81954, __global unsigned char *mem_81955, __global unsigned char *counters_mem_83131, __global unsigned char *segred_tmp_mem_83153, __global unsigned char *segred_tmp_mem_83155)\n{\n    #define segred_tblock_sizze_70902 (make_collisions_compact_doublezisegred_nonseg_70910zisegred_tblock_sizze_70902)\n    #define chunk_sizze_83130 (make_collisions_compact_doublezisegred_nonseg_70910zichunk_sizze_83130)\n    \n    volatile __local unsigned char *sync_arr_mem_83175_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_83175_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *local_mem_83166_backing_0 = &shared_mem[sync_arr_mem_83175_backing_1_offset];\n    const int64_t local_mem_83166_backing_0_offset = sync_arr_mem_83175_backing_1_offset + (smax64(segred_tblock_sizze_70902 * chunk_sizze_83130 * (int64_t) 8, sdiv_up64(segred_tblock_sizze_70902 * (int64_t) 8, (int64_t) 8) * (int64_t) 8 + segred_tblock_sizze_70902 * (int64_t) 8", ") + srem64((int64_t) 8 - srem64(smax64(segred_tblock_sizze_70902 * chunk_sizze_83130 * (int64_t) 8, sdiv_up64(segred_tblock_sizze_70902 * (int64_t) 8, (int64_t) 8) * (int64_t) 8 + segred_tblock_sizze_70902 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_83159;\n    int32_t tblock_sizze_83162;\n    int32_t wave_sizze_83161;\n    int32_t block_id_83160;\n    int32_t global_tid_83158;\n    int64_t phys_tid_70910;\n    int64_t block_worksizze_83163;\n    int64_t offset_83164;\n    int64_t offset_83165;\n    __local unsigned char *local_mem_83166;\n    int64_t chunk_i64_mem_83169[chunk_sizze_83130];\n    int64_t chunk_i64_mem_83173[chunk_sizze_83130];\n    __local unsigned char *sync_arr_mem_83175;\n    int64_t dummy_70908;\n    int64_t gtid_70909;\n    int64_t q_83177;\n    int64_t eta_p_block_res_acc_83178;\n    int64_t eta_p_block_res_acc_83179;\n    int64_t eta_p_63998;\n    int64_t eta_p_63999;\n    int64_t eta_p_64000;\n    int64_t eta_p_64001;\n    int64_t block_offset_in_segment_83187;\n    int64_t block_stride_83188;\n    int64_t block_base_offset_83189;\n    int32_t old_counter_83209;\n    bool is_last_block_83210;\n    \n    local_tid_83159 = get_local_id(0);\n    tblock_sizze_83162 = get_local_size(0);\n    wave_sizze_83161 = LOCKSTEP_WIDTH;\n    block_id_83160 = get_tblock_id(0);\n    global_tid_83158 = block_id_83160 * tblock_sizze_83162 + local_tid_83159;\n    phys_tid_70910 = sext_i32_i64(global_tid_83158);\n    block_worksizze_83163 = segred_tblock_sizze_70902 * chunk_sizze_83130;\n    offset_83164 = segred_tblock_sizze_70902 * (int64_t) 8;\n    offset_83165 = sdiv_up64(offset_83164, (int64_t) 8) * (int64_t) 8 + segred_tblock_sizze_70902 * (int64_t) 8;\n    local_mem_83166 = (__local unsigned char *) local_mem_83166_backing_0;\n    sync_arr_mem_83175 = (__local unsigned char *) sync_arr_mem_83175_backing_1;\n    dummy_70908 = (int64_t) 0;\n    gtid_70909 = ",
                                    "(int64_t) 0;\n    q_83177 = sdiv_up64(dz2084U_51542, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_70902 * num_tblocks_70904)) * chunk_sizze_83130);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_83178 = reduce_arg1_59514;\n        eta_p_block_res_acc_83179 = reduce_arg1_59515;\n    }\n    block_offset_in_segment_83187 = squot64(phys_tid_70910, segred_tblock_sizze_70902);\n    block_stride_83188 = segred_tblock_sizze_70902 * chunk_sizze_83130;\n    block_base_offset_83189 = block_offset_in_segment_83187 * q_83177 * block_stride_83188;\n    for (int64_t i_83190 = 0; i_83190 < q_83177; i_83190++) {\n        int64_t block_offset_83191;\n        int32_t offset_83207;\n        int32_t skip_waves_83208;\n        int64_t eta_p_83180;\n        int64_t eta_p_83181;\n        int64_t eta_p_83182;\n        int64_t eta_p_83183;\n        \n        block_offset_83191 = block_base_offset_83189 + i_83190 * block_stride_83188;\n        for (int64_t k_83192 = 0; k_83192 < chunk_sizze_83130; k_83192++) {\n            int64_t loc_ind_83193 = k_83192 * segred_tblock_sizze_70902 + sext_i32_i64(local_tid_83159);\n            \n            gtid_70909 = block_offset_83191 + loc_ind_83193;\n            if (slt64(gtid_70909, dz2084U_51542)) {\n                // apply map function\n                {\n                    int64_t x_63996 = ((__global int64_t *) chain_collisions_mem_81927)[gtid_70909];\n                    int64_t x_63997 = ((__global int64_t *) chain_collisions_mem_81928)[gtid_70909];\n                    \n                    // write map result(s) to private chunk(s)\n                    {\n                        chunk_i64_mem_83169[k_83192] = x_63996;\n                        chunk_i64_mem_83173[k_83192] = x_63997;\n                    }\n                }\n            } else {\n                chunk_i64_mem_83169[k_83192] = reduce_arg1_59514;\n                chunk_i64_mem_83173[k_83192] = reduce_arg1_59515;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FE", "NCE);\n        // effectualize collective copies in shared memory\n        {\n            for (int64_t k_83194 = 0; k_83194 < chunk_sizze_83130; k_83194++) {\n                int64_t lmem_idx_83195 = sext_i32_i64(local_tid_83159) + k_83194 * segred_tblock_sizze_70902;\n                int64_t tmp_83196 = chunk_i64_mem_83169[k_83194];\n                \n                ((__local int64_t *) local_mem_83166)[lmem_idx_83195] = tmp_83196;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t k_83197 = 0; k_83197 < chunk_sizze_83130; k_83197++) {\n                int64_t lmem_idx_83198 = sext_i32_i64(local_tid_83159) * chunk_sizze_83130 + k_83197;\n                int64_t tmp_83199 = ((__local int64_t *) local_mem_83166)[lmem_idx_83198];\n                \n                chunk_i64_mem_83169[k_83197] = tmp_83199;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t k_83200 = 0; k_83200 < chunk_sizze_83130; k_83200++) {\n                int64_t lmem_idx_83201 = sext_i32_i64(local_tid_83159) + k_83200 * segred_tblock_sizze_70902;\n                int64_t tmp_83202 = chunk_i64_mem_83173[k_83200];\n                \n                ((__local int64_t *) local_mem_83166)[lmem_idx_83201] = tmp_83202;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t k_83203 = 0; k_83203 < chunk_sizze_83130; k_83203++) {\n                int64_t lmem_idx_83204 = sext_i32_i64(local_tid_83159) * chunk_sizze_83130 + k_83203;\n                int64_t tmp_83205 = ((__local int64_t *) local_mem_83166)[lmem_idx_83204];\n                \n                chunk_i64_mem_83173[k_83203] = tmp_83205;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // per-thread sequential reduction of private chunk(s)\n        {\n            for (int64_t k_83206 = 0; k_83206 < chunk_sizze_83130; k_83206++) {\n                // load params for all reductions\n                {\n                    eta_p_63998 = eta_p_block_res_acc_83178;\n ", "                   eta_p_64000 = chunk_i64_mem_83169[k_83206];\n                    eta_p_63999 = eta_p_block_res_acc_83179;\n                    eta_p_64001 = chunk_i64_mem_83173[k_83206];\n                }\n                // apply reduction operator(s)\n                {\n                    bool defunc_0_leq_res_64002;\n                    \n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_64002, eta_p_63998, eta_p_63999, eta_p_64000, eta_p_64001);\n                    \n                    int64_t defunc_0_op_res_64003;\n                    \n                    if (defunc_0_leq_res_64002) {\n                        defunc_0_op_res_64003 = eta_p_64000;\n                    } else {\n                        defunc_0_op_res_64003 = eta_p_63998;\n                    }\n                    \n                    int64_t defunc_0_op_res_64004;\n                    \n                    if (defunc_0_leq_res_64002) {\n                        defunc_0_op_res_64004 = eta_p_64001;\n                    } else {\n                        defunc_0_op_res_64004 = eta_p_63999;\n                    }\n                    eta_p_block_res_acc_83178 = defunc_0_op_res_64003;\n                    eta_p_block_res_acc_83179 = defunc_0_op_res_64004;\n                }\n            }\n        }\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159)] = eta_p_block_res_acc_83178;\n            ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_block_res_acc_83179;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_83208 = 1;\n        offset_83207 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_83159, sext_i64_i32(segred_tblock_sizze_70902))) {\n                eta_p_83180 = ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83207)];\n    ",
                                    "            eta_p_83181 = ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83207)];\n            }\n        }\n        offset_83207 = 1;\n        while (slt32(offset_83207, wave_sizze_83161)) {\n            if (slt32(local_tid_83159 + offset_83207, sext_i64_i32(segred_tblock_sizze_70902)) && ((local_tid_83159 - squot32(local_tid_83159, wave_sizze_83161) * wave_sizze_83161) & (2 * offset_83207 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_83182 = ((volatile __local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83207)];\n                    eta_p_83183 = ((volatile __local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83207)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_leq_res_83184;\n                    \n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_83184, eta_p_83180, eta_p_83181, eta_p_83182, eta_p_83183);\n                    \n                    int64_t defunc_0_op_res_83185;\n                    \n                    if (defunc_0_leq_res_83184) {\n                        defunc_0_op_res_83185 = eta_p_83182;\n                    } else {\n                        defunc_0_op_res_83185 = eta_p_83180;\n                    }\n                    \n                    int64_t defunc_0_op_res_83186;\n                    \n                    if (defunc_0_leq_res_83184) {\n                        defunc_0_op_res_83186 = eta_p_83183;\n                    } else {\n                        defunc_0_op_res_83186 = eta_p_83181;\n                    }\n                    eta_p_83180 = defunc_0_op_res_83185;\n                    eta_p_83181 = defunc_0_op_res_83186;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) local_mem_83166)[sext_i32_i64", "(local_tid_83159)] = eta_p_83180;\n                    ((volatile __local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_83181;\n                }\n            }\n            offset_83207 *= 2;\n        }\n        while (slt32(skip_waves_83208, squot32(sext_i64_i32(segred_tblock_sizze_70902) + wave_sizze_83161 - 1, wave_sizze_83161))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_83207 = skip_waves_83208 * wave_sizze_83161;\n            if (slt32(local_tid_83159 + offset_83207, sext_i64_i32(segred_tblock_sizze_70902)) && ((local_tid_83159 - squot32(local_tid_83159, wave_sizze_83161) * wave_sizze_83161) == 0 && (squot32(local_tid_83159, wave_sizze_83161) & (2 * skip_waves_83208 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_83182 = ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83207)];\n                    eta_p_83183 = ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83207)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_leq_res_83184;\n                    \n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_83184, eta_p_83180, eta_p_83181, eta_p_83182, eta_p_83183);\n                    \n                    int64_t defunc_0_op_res_83185;\n                    \n                    if (defunc_0_leq_res_83184) {\n                        defunc_0_op_res_83185 = eta_p_83182;\n                    } else {\n                        defunc_0_op_res_83185 = eta_p_83180;\n                    }\n                    \n                    int64_t defunc_0_op_res_83186;\n                    \n                    if (defunc_0_leq_res_83184) {\n                        defunc_0_op_res_83186 = eta_p_83183;\n                    } else {\n                        defunc_0_op_res_83186 = eta_p_83181;\n               ", "     }\n                    eta_p_83180 = defunc_0_op_res_83185;\n                    eta_p_83181 = defunc_0_op_res_83186;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159)] = eta_p_83180;\n                    ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_83181;\n                }\n            }\n            skip_waves_83208 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_83159) == (int64_t) 0) {\n                eta_p_block_res_acc_83178 = eta_p_83180;\n                eta_p_block_res_acc_83179 = eta_p_83181;\n            } else {\n                eta_p_block_res_acc_83178 = reduce_arg1_59514;\n                eta_p_block_res_acc_83179 = reduce_arg1_59515;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_83159 == 0) {\n            ((__global int64_t *) segred_tmp_mem_83153)[sext_i32_i64(block_id_83160)] = eta_p_block_res_acc_83178;\n            mem_fence_global();\n            ((__global int64_t *) segred_tmp_mem_83155)[sext_i32_i64(block_id_83160)] = eta_p_block_res_acc_83179;\n            mem_fence_global();\n            old_counter_83209 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83131)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_83175)[(int64_t) 0] = old_counter_83209 == sext_i64_i32(num_tblocks_70904 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_83210 = ((__local bool *) sync_arr_mem_83175)[(int64_t) 0];\n    if (is_last_block_83210) {\n        if (local_tid_83159 == 0) {\n            old_counter_83209 = atomic_add_i32_global(&((vol",
                                    "atile __global int *) counters_mem_83131)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_70904));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_83211 = sdiv_up64(num_tblocks_70904, segred_tblock_sizze_70902);\n            \n            eta_p_63998 = reduce_arg1_59514;\n            eta_p_63999 = reduce_arg1_59515;\n            for (int64_t i_83212 = 0; i_83212 < read_per_thread_83211; i_83212++) {\n                int64_t block_res_id_83213 = sext_i32_i64(local_tid_83159) * read_per_thread_83211 + i_83212;\n                int64_t index_of_block_res_83214 = block_res_id_83213;\n                \n                if (slt64(block_res_id_83213, num_tblocks_70904)) {\n                    eta_p_64000 = ((__global int64_t *) segred_tmp_mem_83153)[index_of_block_res_83214];\n                    eta_p_64001 = ((__global int64_t *) segred_tmp_mem_83155)[index_of_block_res_83214];\n                    \n                    bool defunc_0_leq_res_64002;\n                    \n                    futrts_lifted_lambda_11636(&defunc_0_leq_res_64002, eta_p_63998, eta_p_63999, eta_p_64000, eta_p_64001);\n                    \n                    int64_t defunc_0_op_res_64003;\n                    \n                    if (defunc_0_leq_res_64002) {\n                        defunc_0_op_res_64003 = eta_p_64000;\n                    } else {\n                        defunc_0_op_res_64003 = eta_p_63998;\n                    }\n                    \n                    int64_t defunc_0_op_res_64004;\n                    \n                    if (defunc_0_leq_res_64002) {\n                        defunc_0_op_res_64004 = eta_p_64001;\n                    } else {\n                        defunc_0_op_res_64004 = eta_p_63999;\n                    }\n                    eta_p_63998 = defunc_0_op_res_64003;\n                    eta_p_63999 = defunc_0_op_res_64004;\n                }\n            }\n        }\n        ((__local int64_t *) local_mem_83166)[sext_i32_i64(lo", "cal_tid_83159)] = eta_p_63998;\n        ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_63999;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_83215;\n            int32_t skip_waves_83216 = 1;\n            int64_t eta_p_83180;\n            int64_t eta_p_83181;\n            int64_t eta_p_83182;\n            int64_t eta_p_83183;\n            \n            offset_83215 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_83159, sext_i64_i32(segred_tblock_sizze_70902))) {\n                    eta_p_83180 = ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83215)];\n                    eta_p_83181 = ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83215)];\n                }\n            }\n            offset_83215 = 1;\n            while (slt32(offset_83215, wave_sizze_83161)) {\n                if (slt32(local_tid_83159 + offset_83215, sext_i64_i32(segred_tblock_sizze_70902)) && ((local_tid_83159 - squot32(local_tid_83159, wave_sizze_83161) * wave_sizze_83161) & (2 * offset_83215 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_83182 = ((volatile __local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83215)];\n                        eta_p_83183 = ((volatile __local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83215)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_leq_res_83184;\n                        \n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_83184, eta_p_83180, eta_p_83181, eta_p_83182, eta_p_83183);\n                        \n                        int64_t ", "defunc_0_op_res_83185;\n                        \n                        if (defunc_0_leq_res_83184) {\n                            defunc_0_op_res_83185 = eta_p_83182;\n                        } else {\n                            defunc_0_op_res_83185 = eta_p_83180;\n                        }\n                        \n                        int64_t defunc_0_op_res_83186;\n                        \n                        if (defunc_0_leq_res_83184) {\n                            defunc_0_op_res_83186 = eta_p_83183;\n                        } else {\n                            defunc_0_op_res_83186 = eta_p_83181;\n                        }\n                        eta_p_83180 = defunc_0_op_res_83185;\n                        eta_p_83181 = defunc_0_op_res_83186;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159)] = eta_p_83180;\n                        ((volatile __local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_83181;\n                    }\n                }\n                offset_83215 *= 2;\n            }\n            while (slt32(skip_waves_83216, squot32(sext_i64_i32(segred_tblock_sizze_70902) + wave_sizze_83161 - 1, wave_sizze_83161))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_83215 = skip_waves_83216 * wave_sizze_83161;\n                if (slt32(local_tid_83159 + offset_83215, sext_i64_i32(segred_tblock_sizze_70902)) && ((local_tid_83159 - squot32(local_tid_83159, wave_sizze_83161) * wave_sizze_83161) == 0 && (squot32(local_tid_83159, wave_sizze_83161) & (2 * skip_waves_83216 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_83182 = ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159 + offset_83215)];\n                        eta_p_83183 = ((__local int64_t *) local_mem_831",
                                    "66)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159 + offset_83215)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_leq_res_83184;\n                        \n                        futrts_lifted_lambda_11636(&defunc_0_leq_res_83184, eta_p_83180, eta_p_83181, eta_p_83182, eta_p_83183);\n                        \n                        int64_t defunc_0_op_res_83185;\n                        \n                        if (defunc_0_leq_res_83184) {\n                            defunc_0_op_res_83185 = eta_p_83182;\n                        } else {\n                            defunc_0_op_res_83185 = eta_p_83180;\n                        }\n                        \n                        int64_t defunc_0_op_res_83186;\n                        \n                        if (defunc_0_leq_res_83184) {\n                            defunc_0_op_res_83186 = eta_p_83183;\n                        } else {\n                            defunc_0_op_res_83186 = eta_p_83181;\n                        }\n                        eta_p_83180 = defunc_0_op_res_83185;\n                        eta_p_83181 = defunc_0_op_res_83186;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) local_mem_83166)[sext_i32_i64(local_tid_83159)] = eta_p_83180;\n                        ((__local int64_t *) local_mem_83166)[squot64(offset_83164, (int64_t) 8) + sext_i32_i64(local_tid_83159)] = eta_p_83181;\n                    }\n                }\n                skip_waves_83216 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_83159 == 0) {\n                    ((__global int64_t *) mem_81954)[(int64_t) 0] = eta_p_83180;\n                    ((__global int64_t *) mem_81955)[(int64_t) 0] = eta_p_83181;\n                }\n            }\n     ", "   }\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_70902\n    #undef chunk_sizze_83130\n}\nFUTHARK_KERNEL_SIZED(make_collisions_compact_doublezisegscan_74390_dim1, 1, 1)\nvoid make_collisions_compact_doublezisegscan_74390(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2084U_51542, int64_t num_tblocks_74387, int64_t num_virt_blocks_83594, int64_t num_virt_threads_83595, __global unsigned char *ext_mem_82419, __global unsigned char *mem_82422, __global unsigned char *mem_82424, __global unsigned char *status_flags_mem_83596, __global unsigned char *aggregates_mem_83618, __global unsigned char *incprefixes_mem_83620, __global unsigned char *global_dynid_mem_83622)\n{\n    #define segscan_tblock_sizze_74385 (make_collisions_compact_doublezisegscan_74390zisegscan_tblock_sizze_74385)\n    #define chunk_sizze_83593 (make_collisions_compact_doublezisegscan_74390zichunk_sizze_83593)\n    \n    volatile __local unsigned char *local_mem_83632_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83632_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74385), chunk_sizze_83593 * segscan_tblock_sizze_74385 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74385), chunk_sizze_83593 * segscan_tblock_sizze_74385 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_83625;\n    int32_t tblock_sizze_83628;\n    int32_t wave_sizze_83627;\n    int32_t block_id_83626;\n    int32_t global_tid_83624;\n    int64_t phys_tid_74390;\n    int32_t chunk_sizze_32b_83629;\n    int64_t byte_offsets_83630;\n    int64_t warp_byte_offset_83631;\n    __local unsigned char *local_mem_83632;\n    int64_t", " trans_arr_len_83633;\n    int64_t phys_block_id_83639;\n    int64_t virtloop_bound_83640;\n    \n    local_tid_83625 = get_local_id(0);\n    tblock_sizze_83628 = get_local_size(0);\n    wave_sizze_83627 = LOCKSTEP_WIDTH;\n    block_id_83626 = get_tblock_id(0);\n    global_tid_83624 = block_id_83626 * tblock_sizze_83628 + local_tid_83625;\n    phys_tid_74390 = sext_i32_i64(global_tid_83624);\n    chunk_sizze_32b_83629 = sext_i64_i32(chunk_sizze_83593);\n    byte_offsets_83630 = segscan_tblock_sizze_74385 * (int64_t) 8;\n    warp_byte_offset_83631 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83632 = (__local unsigned char *) local_mem_83632_backing_0;\n    trans_arr_len_83633 = chunk_sizze_83593 * segscan_tblock_sizze_74385;\n    phys_block_id_83639 = get_tblock_id(0);\n    virtloop_bound_83640 = sdiv_up64(num_virt_blocks_83594 - phys_block_id_83639, num_tblocks_74387);\n    for (int64_t virtloop_i_83641 = 0; virtloop_i_83641 < virtloop_bound_83640; virtloop_i_83641++) {\n        int64_t dynamic_id_83642;\n        int64_t block_offset_83643;\n        int64_t sgm_idx_83644;\n        int32_t boundary_83645;\n        int32_t segsizze_compact_83646;\n        int64_t private_mem_83647[chunk_sizze_83593];\n        int64_t thd_offset_83649;\n        int64_t acc_83665;\n        int64_t prefix_83675;\n        bool block_new_sgm_83676;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83625 == 0) {\n                dynamic_id_83642 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83622)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83632)[(int64_t) 0] = dynamic_id_83642;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83642 == num_virt_blocks_83594 - (int64_t) 1) {\n                        ((__glo",
                                    "bal int32_t *) global_dynid_mem_83622)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83642 = ((__local int32_t *) local_mem_83632)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83643 = dynamic_id_83642 * chunk_sizze_83593 * segscan_tblock_sizze_74385;\n        sgm_idx_83644 = smod64(block_offset_83643, dz2084U_51542);\n        boundary_83645 = sext_i64_i32(smin64(chunk_sizze_83593 * segscan_tblock_sizze_74385, dz2084U_51542 - sgm_idx_83644));\n        segsizze_compact_83646 = sext_i64_i32(smin64(chunk_sizze_83593 * segscan_tblock_sizze_74385, dz2084U_51542));\n        thd_offset_83649 = block_offset_83643 + sext_i32_i64(local_tid_83625);\n        // Load and map\n        {\n            for (int64_t i_83650 = 0; i_83650 < chunk_sizze_83593; i_83650++) {\n                int64_t virt_tid_83651 = thd_offset_83649 + i_83650 * segscan_tblock_sizze_74385;\n                int64_t slice_83652 = dz2084U_51542;\n                int64_t gtid_74389 = virt_tid_83651;\n                int64_t remnant_83653 = virt_tid_83651 - gtid_74389;\n                \n                if (slt64(virt_tid_83651, dz2084U_51542)) {\n                    bool cond_63765 = gtid_74389 == (int64_t) 0;\n                    bool lifted_lambda_res_63766;\n                    \n                    if (cond_63765) {\n                        lifted_lambda_res_63766 = 1;\n                    } else {\n                        int64_t znze_rhs_63772 = sub64(gtid_74389, (int64_t) 1);\n                        bool x_63773 = sle64((int64_t) 0, znze_rhs_63772);\n                        bool y_63774 = slt64(znze_rhs_63772, dz2084U_51542);\n                        bool bounds_check_63775 = x_63773 && y_63774;\n                        bool index_certs_63776;\n                        \n                        if (!bounds_check_63775) {\n                            {\n                                if (atomic_cmpxchg_i32_global", "(global_failure, -1, 85) == -1) {\n                                    global_failure_args[0] = (int64_t) znze_rhs_63772;\n                                    global_failure_args[1] = (int64_t) dz2084U_51542;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t lifted_lambda_res_f_res_63771 = ((__global int64_t *) ext_mem_82419)[gtid_74389];\n                        int64_t lifted_lambda_res_f_res_63777 = ((__global int64_t *) ext_mem_82419)[znze_rhs_63772];\n                        bool lifted_lambda_res_f_res_63778 = lifted_lambda_res_f_res_63771 == lifted_lambda_res_f_res_63777;\n                        bool lifted_lambda_res_f_res_63779 = !lifted_lambda_res_f_res_63778;\n                        \n                        lifted_lambda_res_63766 = lifted_lambda_res_f_res_63779;\n                    }\n                    \n                    int64_t defunc_0_f_res_63781 = btoi_bool_i64(lifted_lambda_res_63766);\n                    \n                    ((__global int64_t *) mem_82424)[gtid_74389] = defunc_0_f_res_63781;\n                    private_mem_83647[i_83650] = defunc_0_f_res_63781;\n                } else {\n                    private_mem_83647[i_83650] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83654 = 0; i_83654 < chunk_sizze_83593; i_83654++) {\n                int64_t sharedIdx_83655 = sext_i32_i64(local_tid_83625) + i_83654 * segscan_tblock_sizze_74385;\n                int64_t tmp_83656 = private_mem_83647[i_83654];\n                \n                ((__local int64_t *) local_mem_83632)[sharedIdx_83655] = tmp_836", "56;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83657 = 0; i_83657 < chunk_sizze_83593; i_83657++) {\n                int64_t sharedIdx_83658 = sext_i32_i64(local_tid_83625) * chunk_sizze_83593 + i_83657;\n                int64_t tmp_83659 = ((__local int64_t *) local_mem_83632)[sharedIdx_83658];\n                \n                private_mem_83647[i_83657] = tmp_83659;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83660 = 0; i_83660 < chunk_sizze_83593 - (int64_t) 1; i_83660++) {\n                int64_t eta_p_60038;\n                int64_t eta_p_60039;\n                \n                eta_p_60038 = private_mem_83647[i_83660];\n                eta_p_60039 = private_mem_83647[i_83660 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_60040 = add64(eta_p_60038, eta_p_60039);\n                \n                private_mem_83647[i_83660 + (int64_t) 1] = defunc_0_op_res_60040;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83661 = private_mem_83647[chunk_sizze_83593 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = tmp_83661;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83662;\n            int64_t eta_p_83663;\n            int64_t eta_p_83666;\n            int64_t eta_p_83667;\n            bool ltid_in_bounds_83669 = slt64(sext_i32_i64(local_tid_83625), num_virt_threads_83595);\n            int32_t skip_threads_83670;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83669) {\n                    eta_p_83663 = ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)];\n                    if ((local_tid_83625 - squot32(local_tid_83625, 32) * 32) == 0) {\n                 ",
                                    "       eta_p_83662 = eta_p_83663;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83670 = 1;\n                while (slt32(skip_threads_83670, 32)) {\n                    bool thread_active_83671 = sle32(skip_threads_83670, local_tid_83625 - squot32(local_tid_83625, 32) * 32) && ltid_in_bounds_83669;\n                    \n                    if (thread_active_83671) {\n                        // read operands\n                        {\n                            eta_p_83662 = ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625) - sext_i32_i64(skip_threads_83670)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83671) {\n                            int64_t defunc_0_op_res_83664 = add64(eta_p_83662, eta_p_83663);\n                            \n                            eta_p_83662 = defunc_0_op_res_83664;\n                        }\n                    }\n                    if (sle32(wave_sizze_83627, skip_threads_83670)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83671) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = eta_p_83662;\n                            eta_p_83663 = eta_p_83662;\n                        }\n                    }\n                    if (sle32(wave_sizze_83627, skip_threads_83670)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83670 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83625 - squot32(local_tid_83625, 32)", " * 32) == 31 && ltid_in_bounds_83669) {\n                    ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(squot32(local_tid_83625, 32))] = eta_p_83662;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83672;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83625, 32) == 0 && ltid_in_bounds_83669) {\n                        eta_p_83667 = ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)];\n                        if ((local_tid_83625 - squot32(local_tid_83625, 32) * 32) == 0) {\n                            eta_p_83666 = eta_p_83667;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83672 = 1;\n                    while (slt32(skip_threads_83672, 32)) {\n                        bool thread_active_83673 = sle32(skip_threads_83672, local_tid_83625 - squot32(local_tid_83625, 32) * 32) && (squot32(local_tid_83625, 32) == 0 && ltid_in_bounds_83669);\n                        \n                        if (thread_active_83673) {\n                            // read operands\n                            {\n                                eta_p_83666 = ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625) - sext_i32_i64(skip_threads_83672)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83673) {\n                                int64_t defunc_0_op_res_83668 = add64(eta_p_83666, eta_p_83667);\n                                \n                                eta_p_83666 = defunc_0_op_res_83668;\n                            }\n          ", "              }\n                        if (sle32(wave_sizze_83627, skip_threads_83672)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83673) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = eta_p_83666;\n                                eta_p_83667 = eta_p_83666;\n                            }\n                        }\n                        if (sle32(wave_sizze_83627, skip_threads_83672)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83672 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_83674 = squot32(local_tid_83625, 32) == 0 || !ltid_in_bounds_83669;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83674) {\n                        eta_p_83663 = eta_p_83662;\n                        eta_p_83662 = ((__local int64_t *) local_mem_83632)[sext_i32_i64(squot32(local_tid_83625, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83674) {\n                        int64_t defunc_0_op_res_83664 = add64(eta_p_83662, eta_p_83663);\n                        \n                        eta_p_83662 = defunc_0_op_res_83664;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83674) {\n                        ((__local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = eta_p_83662;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // re",
                                    "store correct values for first block\n            {\n                if (squot32(local_tid_83625, 32) == 0 && ltid_in_bounds_83669) {\n                    ((__local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = eta_p_83663;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83625 == 0) {\n                acc_83665 = ((__local int64_t *) local_mem_83632)[segscan_tblock_sizze_74385 - (int64_t) 1];\n            } else {\n                acc_83665 = ((__local int64_t *) local_mem_83632)[sext_i32_i64(local_tid_83625) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83675 = (int64_t) 0;\n        block_new_sgm_83676 = sgm_idx_83644 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83676 && local_tid_83625 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83620)[dynamic_id_83642] = acc_83665;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83596)[dynamic_id_83642] = (int8_t) 2;\n                acc_83665 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83676 && slt32(local_tid_83625, wave_sizze_83627)) {\n                if (local_tid_83625 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83618)[dynamic_id_83642] = acc_83665;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83596)[dynamic_id_83642] = (int8_t) 1;\n                    \n                    int8_t tmp_83677 = ((volatile __global int8_t *) status_flags_mem_83596)[dynamic_id_83642 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83632)[(int64_t) 0] = tmp_83677;\n                }\n                mem_fence_local();\n                \n                int8_t status_83678 = ((__local int8_t *) local_mem_83632)[(int64_t) 0];\n            ", "    \n                if (status_83678 == (int8_t) 2) {\n                    if (local_tid_83625 == 0) {\n                        prefix_83675 = ((volatile __global int64_t *) incprefixes_mem_83620)[dynamic_id_83642 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83679 = sext_i64_i32(dynamic_id_83642 - sext_i32_i64(wave_sizze_83627));\n                    \n                    while (slt32(wave_sizze_83627 * -1, readOffset_83679)) {\n                        int32_t read_i_83680 = readOffset_83679 + local_tid_83625;\n                        int64_t aggr_83681 = (int64_t) 0;\n                        int8_t flag_83682 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83680)) {\n                            flag_83682 = ((volatile __global int8_t *) status_flags_mem_83596)[sext_i32_i64(read_i_83680)];\n                            if (flag_83682 == (int8_t) 2) {\n                                aggr_83681 = ((volatile __global int64_t *) incprefixes_mem_83620)[sext_i32_i64(read_i_83680)];\n                            } else if (flag_83682 == (int8_t) 1) {\n                                aggr_83681 = ((volatile __global int64_t *) aggregates_mem_83618)[sext_i32_i64(read_i_83680)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83632)[(int64_t) 4 + sext_i32_i64(local_tid_83625)] = aggr_83681;\n                        ((__local int8_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = flag_83682;\n                        flag_83682 = ((__local int8_t *) local_mem_83632)[sext_i32_i64(wave_sizze_83627) - (int64_t) 1];\n                        if (slt8(flag_83682, (int8_t) 2)) {\n                            int8_t flg_x_83686;\n                            int8_t flg_y_83687;\n                            int64_t eta_p_83683;\n                            int64_t eta_p_83684;\n                            int32_t skip_threads_83688;\n                  ", "          \n                            // read input for in-block scan\n                            {\n                                flg_y_83687 = ((volatile __local int8_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)];\n                                eta_p_83684 = ((volatile __local int64_t *) local_mem_83632)[(int64_t) 4 + sext_i32_i64(local_tid_83625)];\n                                if ((local_tid_83625 - squot32(local_tid_83625, 32) * 32) == 0) {\n                                    eta_p_83683 = eta_p_83684;\n                                    flg_x_83686 = flg_y_83687;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83688 = 1;\n                                while (slt32(skip_threads_83688, 32)) {\n                                    if (sle32(skip_threads_83688, local_tid_83625 - squot32(local_tid_83625, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83686 = ((volatile __local int8_t *) local_mem_83632)[sext_i32_i64(local_tid_83625) - sext_i32_i64(skip_threads_83688)];\n                                            eta_p_83683 = ((volatile __local int64_t *) local_mem_83632)[(int64_t) 4 + (sext_i32_i64(local_tid_83625) - sext_i32_i64(skip_threads_83688))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83687 == (int8_t) 2 || flg_y_83687 == (int8_t) 0) {\n                                                flg_x_83686 = flg_y_83687;\n                                                eta_p_83683 = eta_p_83684;\n                                            } else {\n                                                int64_t defunc_0_op_res_83685 = ",
                                    "add64(eta_p_83683, eta_p_83684);\n                                                \n                                                eta_p_83683 = defunc_0_op_res_83685;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83632)[sext_i32_i64(local_tid_83625)] = flg_x_83686;\n                                            flg_y_83687 = flg_x_83686;\n                                            ((volatile __local int64_t *) local_mem_83632)[(int64_t) 4 + sext_i32_i64(local_tid_83625)] = eta_p_83683;\n                                            eta_p_83684 = eta_p_83683;\n                                        }\n                                    }\n                                    skip_threads_83688 *= 2;\n                                }\n                            }\n                        }\n                        flag_83682 = ((__local int8_t *) local_mem_83632)[sext_i32_i64(wave_sizze_83627) - (int64_t) 1];\n                        aggr_83681 = ((__local int64_t *) local_mem_83632)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83627) - (int64_t) 1)];\n                        if (flag_83682 == (int8_t) 2) {\n                            readOffset_83679 = wave_sizze_83627 * -1;\n                        } else if (flag_83682 == (int8_t) 1) {\n                            readOffset_83679 -= wave_sizze_83627;\n                        }\n                        if (slt8((int8_t) 0, flag_83682)) {\n                            int64_t eta_p_83689 = aggr_83681;\n                            int64_t eta_p_83690 = prefix_83675;\n                            int64_t defunc_0_op_res_83691 = add64(eta_p_83689, eta_p_83690);\n                            \n                            prefix_83675 = defunc_0_op_res_83691;\n                        }\n                        mem_fence_local();\n    ", "                }\n                }\n                if (local_tid_83625 == 0) {\n                    if (boundary_83645 == sext_i64_i32(segscan_tblock_sizze_74385 * chunk_sizze_83593)) {\n                        int64_t eta_p_83692 = prefix_83675;\n                        int64_t eta_p_83693 = acc_83665;\n                        int64_t defunc_0_op_res_83694 = add64(eta_p_83692, eta_p_83693);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83620)[dynamic_id_83642] = defunc_0_op_res_83694;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83596)[dynamic_id_83642] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83632)[(int64_t) 4] = prefix_83675;\n                    acc_83665 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_83642 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83675 = ((__local int64_t *) local_mem_83632)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83695;\n            int64_t eta_p_83696;\n            int64_t eta_p_83698 = prefix_83675;\n            int64_t eta_p_83699 = acc_83665;\n            \n            if (slt32(local_tid_83625 * chunk_sizze_32b_83629, boundary_83645) && !block_new_sgm_83676) {\n                int64_t defunc_0_op_res_83700 = add64(eta_p_83698, eta_p_83699);\n                \n                eta_p_83695 = defunc_0_op_res_83700;\n            } else {\n                eta_p_83695 = acc_83665;\n            }\n            \n            int32_t stopping_point_83701 = segsizze_compact_83646 - srem32(local_tid_83625 * chunk_sizze_32b_83629 - 1 + segsizze_compact_83646 - boundary_83645, segsizze_compact_83646);\n            \n            for (int64_t i_83702 = 0; i_83702 < chunk_sizze_83593; i_83702++) {\n                if (slt32(sext_", "i64_i32(i_83702), stopping_point_83701 - 1)) {\n                    eta_p_83696 = private_mem_83647[i_83702];\n                    \n                    int64_t defunc_0_op_res_83697 = add64(eta_p_83695, eta_p_83696);\n                    \n                    private_mem_83647[i_83702] = defunc_0_op_res_83697;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83703 = 0; i_83703 < chunk_sizze_83593; i_83703++) {\n                int64_t sharedIdx_83704 = sext_i32_i64(local_tid_83625) * chunk_sizze_83593 + i_83703;\n                int64_t tmp_83705 = private_mem_83647[i_83703];\n                \n                ((__local int64_t *) local_mem_83632)[sharedIdx_83704] = tmp_83705;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83706 = 0; i_83706 < chunk_sizze_83593; i_83706++) {\n                int64_t flat_idx_83707 = thd_offset_83649 + i_83706 * segscan_tblock_sizze_74385;\n                int64_t slice_83708 = dz2084U_51542;\n                int64_t gtid_74389 = flat_idx_83707;\n                int64_t remnant_83709 = flat_idx_83707 - gtid_74389;\n                \n                if (slt64(flat_idx_83707, dz2084U_51542)) {\n                    int64_t tmp_83710 = ((__local int64_t *) local_mem_83632)[flat_idx_83707 - block_offset_83643];\n                    \n                    ((__global int64_t *) mem_82422)[gtid_74389] = tmp_83710;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_74385\n    #undef chunk_sizze_83593\n}\nFUTHARK_KERNEL_SIZED(mk_dbcHandler_doublezigpuseq_83216_dim1, 1, 1)\nvoid mk_dbcHandler_doublezigpuseq_83216(__global int *global_failure, double min_x_31083, double min_y_31084, double max_x_31085, double max_y_31086, int64_t parts_x_31087, int64_t parts_y_31088, double zs_res_53370, double zs_res_53373, __global unsig",
                                    "ned char *mem_81948, __global unsigned char *mem_81949, __global unsigned char *mem_81950, __global unsigned char *mem_81951, __global unsigned char *mem_81952, __global unsigned char *mem_81953, __global unsigned char *mem_81954, __global unsigned char *mem_81955)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83218;\n    int32_t tblock_sizze_83221;\n    int32_t wave_sizze_83220;\n    int32_t block_id_83219;\n    int32_t global_tid_83217;\n    int64_t tid_83216;\n    \n    local_tid_83218 = get_local_id(0);\n    tblock_sizze_83221 = get_local_size(0);\n    wave_sizze_83220 = LOCKSTEP_WIDTH;\n    block_id_83219 = get_tblock_id(0);\n    global_tid_83217 = block_id_83219 * tblock_sizze_83221 + local_tid_83218;\n    tid_83216 = sext_i32_i64(global_tid_83217);\n    ((__global double *) mem_81948)[(int64_t) 0] = min_x_31083;\n    ((__global double *) mem_81948)[(int64_t) 1] = min_y_31084;\n    ((__global double *) mem_81949)[(int64_t) 0] = max_x_31085;\n    ((__global double *) mem_81949)[(int64_t) 1] = max_y_31086;\n    ((__global double *) mem_81950)[(int64_t) 0] = zs_res_53370;\n    ((__global double *) mem_81950)[(int64_t) 1] = zs_res_53373;\n    ((__global int64_t *) mem_81951)[(int64_t) 0] = parts_x_31087;\n    ((__global int64_t *) mem_81951)[(int64_t) 1] = parts_y_31088;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global double *) mem_81952)[i_0] = ((__global double *) mem_81948)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global double *) mem_81953)[i_0] = ((__global double *) mem_81949)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global double *) mem_81954)[i_0] = ((__global double *) mem_81950)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 2; i_0++) {\n        ((__global int64_t *) mem_81955)[i_0] = ((__global int64_t *) mem_81951)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(next_partition_to_read_doublezigpuseq_83120_dim1, 1, 1)\nvoid nex", "t_partition_to_read_doublezigpuseq_83120(__global int *global_failure, __global unsigned char *clProc_mem_81938, __global unsigned char *mem_81965)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83122;\n    int32_t tblock_sizze_83125;\n    int32_t wave_sizze_83124;\n    int32_t block_id_83123;\n    int32_t global_tid_83121;\n    int64_t tid_83120;\n    int64_t next_partition_to_read_res_f_res_t_res_81561;\n    \n    local_tid_83122 = get_local_id(0);\n    tblock_sizze_83125 = get_local_size(0);\n    wave_sizze_83124 = LOCKSTEP_WIDTH;\n    block_id_83123 = get_tblock_id(0);\n    global_tid_83121 = block_id_83123 * tblock_sizze_83125 + local_tid_83122;\n    tid_83120 = sext_i32_i64(global_tid_83121);\n    next_partition_to_read_res_f_res_t_res_81561 = ((__global int64_t *) clProc_mem_81938)[(int64_t) 0];\n    ((__global int64_t *) mem_81965)[(int64_t) 0] = next_partition_to_read_res_f_res_t_res_81561;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(next_partition_to_read_doublezigpuseq_83333_dim1, 1, 1)\nvoid next_partition_to_read_doublezigpuseq_83333(__global int *global_failure, __global unsigned char *mem_81961, __global unsigned char *mem_81963)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83335;\n    int32_t tblock_sizze_83338;\n    int32_t wave_sizze_83337;\n    int32_t block_id_83336;\n    int32_t global_tid_83334;\n    int64_t tid_83333;\n    int64_t next_partition_to_read_res_f_res_f_res_t_res_81563;\n    \n    local_tid_83335 = get_local_id(0);\n    tblock_sizze_83338 = get_local_size(0);\n    wave_sizze_83337 = LOCKSTEP_WIDTH;\n    block_id_83336 = get_tblock_id(0);\n    global_tid_83334 = block_id_83336 * tblock_sizze_83338 + local_tid_83335;\n    tid_83333 = sext_i32_i64(global_tid_83334);\n    next_partition_to_read_res_f_res_f_res_t_res_81563 = ((__global int64_t *) mem_81961)[(int64_t) 0];\n    ((__global int64_t *) mem_81963)[(int64_t) 0] = next_partition_to_read_res_f_res_f_res_t_res_81563;\n    \n  error_0:\n    return;\n}", "\nFUTHARK_KERNEL_SIZED(next_partition_to_read_doublezisegmap_66881_dim1, 1, 1)\nvoid next_partition_to_read_doublezisegmap_66881(__global int *global_failure, int64_t part_no_31685, int64_t m_63937, int64_t num_tblocks_66886, int32_t virt_num_tblocks_83320, __global unsigned char *mem_81957, __global unsigned char *mem_81959, __global unsigned char *mem_81961)\n{\n    #define segmap_tblock_sizze_66884 (next_partition_to_read_doublezisegmap_66881zisegmap_tblock_sizze_66884)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83322;\n    int32_t tblock_sizze_83325;\n    int32_t wave_sizze_83324;\n    int32_t block_id_83323;\n    int32_t global_tid_83321;\n    int64_t phys_tid_66881;\n    int32_t phys_tblock_id_83326;\n    int32_t iterations_83327;\n    \n    local_tid_83322 = get_local_id(0);\n    tblock_sizze_83325 = get_local_size(0);\n    wave_sizze_83324 = LOCKSTEP_WIDTH;\n    block_id_83323 = get_tblock_id(0);\n    global_tid_83321 = block_id_83323 * tblock_sizze_83325 + local_tid_83322;\n    phys_tid_66881 = sext_i32_i64(global_tid_83321);\n    phys_tblock_id_83326 = get_tblock_id(0);\n    iterations_83327 = sdiv_up32(virt_num_tblocks_83320 - phys_tblock_id_83326, sext_i64_i32(num_tblocks_66886));\n    for (int32_t i_83328 = 0; i_83328 < iterations_83327; i_83328++) {\n        int32_t virt_tblock_id_83329;\n        int64_t global_tid_83330;\n        int64_t slice_83331;\n        int64_t write_i_66880;\n        int64_t remnant_83332;\n        \n        virt_tblock_id_83329 = phys_tblock_id_83326 + i_83328 * sext_i64_i32(num_tblocks_66886);\n        global_tid_83330 = sext_i32_i64(virt_tblock_id_83329) * segmap_tblock_sizze_66884 + sext_i32_i64(local_tid_83322);\n        slice_83331 = part_no_31685;\n        write_i_66880 = global_tid_83330;\n        remnant_83332 = global_tid_83330 - write_i_66880;\n        if (slt64(write_i_66880, part_no_31685)) {\n            int64_t eta_p_63951;\n            bool cond_63954;\n            int64_t lifted_lambda_res_63955;\n            \n       ",
                                    "     eta_p_63951 = ((__global int64_t *) mem_81959)[write_i_66880];\n            cond_63954 = eta_p_63951 == (int64_t) 1;\n            if (cond_63954) {\n                int64_t eta_p_63952;\n                int64_t lifted_lambda_res_t_res_63956;\n                \n                eta_p_63952 = ((__global int64_t *) mem_81957)[write_i_66880];\n                lifted_lambda_res_t_res_63956 = sub64(eta_p_63952, (int64_t) 1);\n                lifted_lambda_res_63955 = lifted_lambda_res_t_res_63956;\n            } else {\n                lifted_lambda_res_63955 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_63955) && slt64(lifted_lambda_res_63955, m_63937)) {\n                ((__global int64_t *) mem_81961)[lifted_lambda_res_63955] = write_i_66880;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_66884\n}\nFUTHARK_KERNEL_SIZED(next_partition_to_read_doublezisegred_nonseg_66871_dim1, 1, 1)\nvoid next_partition_to_read_doublezisegred_nonseg_66871(__global int *global_failure, int64_t part_no_31685, int64_t num_tblocks_66866, int64_t num_threads_83151, __global unsigned char *clProc_mem_81937, __global unsigned char *mem_81953, __global unsigned char *counters_mem_83127, __global unsigned char *segred_tmp_mem_83149)\n{\n    #define segred_tblock_sizze_66864 (next_partition_to_read_doublezisegred_nonseg_66871zisegred_tblock_sizze_66864)\n    #define chunk_sizze_83126 (next_partition_to_read_doublezisegred_nonseg_66871zichunk_sizze_83126)\n    \n    volatile __local unsigned char *sync_arr_mem_83159_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_83159_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_83157_backing_0 = &shared_mem[sync_arr_mem_83159_backing_1_offset];\n    const int64_t red_arr_i64_mem_83157_backing_0_offset = sync_arr_mem_83159_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_66864 + srem64((int64_", "t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66864, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83153;\n    int32_t tblock_sizze_83156;\n    int32_t wave_sizze_83155;\n    int32_t block_id_83154;\n    int32_t global_tid_83152;\n    int64_t phys_tid_66871;\n    __local unsigned char *red_arr_i64_mem_83157;\n    __local unsigned char *sync_arr_mem_83159;\n    int64_t dummy_66869;\n    int64_t gtid_66870;\n    int64_t q_83161;\n    int64_t eta_p_block_res_acc_83162;\n    int64_t eta_p_54156;\n    int64_t eta_p_54157;\n    int64_t tblock_id_in_segment_83166;\n    int64_t block_base_offset_83167;\n    int32_t offset_83170;\n    int32_t skip_waves_83171;\n    int64_t eta_p_83163;\n    int64_t eta_p_83164;\n    int32_t old_counter_83172;\n    bool is_last_block_83173;\n    \n    local_tid_83153 = get_local_id(0);\n    tblock_sizze_83156 = get_local_size(0);\n    wave_sizze_83155 = LOCKSTEP_WIDTH;\n    block_id_83154 = get_tblock_id(0);\n    global_tid_83152 = block_id_83154 * tblock_sizze_83156 + local_tid_83153;\n    phys_tid_66871 = sext_i32_i64(global_tid_83152);\n    red_arr_i64_mem_83157 = (__local unsigned char *) red_arr_i64_mem_83157_backing_0;\n    sync_arr_mem_83159 = (__local unsigned char *) sync_arr_mem_83159_backing_1;\n    dummy_66869 = (int64_t) 0;\n    gtid_66870 = (int64_t) 0;\n    q_83161 = sdiv_up64(part_no_31685, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_66864 * num_tblocks_66866)) * chunk_sizze_83126);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_83162 = (int64_t) 0;\n    }\n    tblock_id_in_segment_83166 = squot64(phys_tid_66871, segred_tblock_sizze_66864);\n    block_base_offset_83167 = tblock_id_in_segment_83166 * q_83161 * segred_tblock_sizze_66864;\n    for (int64_t i_83168 = 0; i_83168 < q_83161; i_83168++) {\n        int64_t block_offset_83169 = block_base_offset_83167 + i_83168 * segred_tblock_sizze_66864;\n        \n        gtid_66870 = phys_tid_66871 + num_threads_8", "3151 * i_83168;\n        if (slt64(gtid_66870, part_no_31685)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    bool eta_p_63753 = ((__global bool *) clProc_mem_81937)[gtid_66870];\n                    bool lifted_lambda_res_63754 = !eta_p_63753;\n                    int64_t bool_res_63755 = btoi_bool_i64(lifted_lambda_res_63754);\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_54156 = eta_p_block_res_acc_83162;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_54157 = bool_res_63755;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t zp_res_54158 = add64(eta_p_54156, eta_p_54157);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_83162 = zp_res_54158;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_block_res_acc_83162;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_83171 = 1;\n    offset_83170 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_83153, sext_i64_i32(segred_tblock_sizze_66864))) {\n            eta_p_83163 = ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83170)];\n        }\n    }\n    offset_83170 = 1;\n    while (slt32(offset_83170, wave_sizze_83155)) {\n        if (slt32(local_tid_83153 + offset_83170, sext_i64_i32(segred_tblock_sizze_66864)) && ((local_tid_83153 - squot32(local_tid_83153, wave_sizze_83155) * wave_sizze_83155) & (2 * offset_83170 ",
                                    "- 1)) == 0) {\n            // read array element\n            {\n                eta_p_83164 = ((volatile __local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83170)];\n            }\n            // apply reduction operation\n            {\n                int64_t zp_res_83165 = add64(eta_p_83163, eta_p_83164);\n                \n                eta_p_83163 = zp_res_83165;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_83163;\n            }\n        }\n        offset_83170 *= 2;\n    }\n    while (slt32(skip_waves_83171, squot32(sext_i64_i32(segred_tblock_sizze_66864) + wave_sizze_83155 - 1, wave_sizze_83155))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_83170 = skip_waves_83171 * wave_sizze_83155;\n        if (slt32(local_tid_83153 + offset_83170, sext_i64_i32(segred_tblock_sizze_66864)) && ((local_tid_83153 - squot32(local_tid_83153, wave_sizze_83155) * wave_sizze_83155) == 0 && (squot32(local_tid_83153, wave_sizze_83155) & (2 * skip_waves_83171 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_83164 = ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83170)];\n            }\n            // apply reduction operation\n            {\n                int64_t zp_res_83165 = add64(eta_p_83163, eta_p_83164);\n                \n                eta_p_83163 = zp_res_83165;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_83163;\n            }\n        }\n        skip_waves_83171 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_83153) == (int64_t) 0) {\n            eta_p_block_res_acc_83162 = eta_p_83163;\n        } else {\n", "            eta_p_block_res_acc_83162 = (int64_t) 0;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_83153 == 0) {\n            ((__global int64_t *) segred_tmp_mem_83149)[sext_i32_i64(block_id_83154)] = eta_p_block_res_acc_83162;\n            mem_fence_global();\n            old_counter_83172 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83127)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_83159)[(int64_t) 0] = old_counter_83172 == sext_i64_i32(num_tblocks_66866 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_83173 = ((__local bool *) sync_arr_mem_83159)[(int64_t) 0];\n    if (is_last_block_83173) {\n        if (local_tid_83153 == 0) {\n            old_counter_83172 = atomic_add_i32_global(&((volatile __global int *) counters_mem_83127)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_66866));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_83174 = sdiv_up64(num_tblocks_66866, segred_tblock_sizze_66864);\n            \n            eta_p_54156 = (int64_t) 0;\n            for (int64_t i_83175 = 0; i_83175 < read_per_thread_83174; i_83175++) {\n                int64_t block_res_id_83176 = sext_i32_i64(local_tid_83153) * read_per_thread_83174 + i_83175;\n                int64_t index_of_block_res_83177 = block_res_id_83176;\n                \n                if (slt64(block_res_id_83176, num_tblocks_66866)) {\n                    eta_p_54157 = ((__global int64_t *) segred_tmp_mem_83149)[index_of_block_res_83177];\n                    \n                    int64_t zp_res_54158 = add64(eta_p_54156, eta_p_54157);\n                    \n                    eta_p_54156 = zp_res_54158;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_54156;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce", " the per-block results\n        {\n            int32_t offset_83178;\n            int32_t skip_waves_83179 = 1;\n            int64_t eta_p_83163;\n            int64_t eta_p_83164;\n            \n            offset_83178 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_83153, sext_i64_i32(segred_tblock_sizze_66864))) {\n                    eta_p_83163 = ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83178)];\n                }\n            }\n            offset_83178 = 1;\n            while (slt32(offset_83178, wave_sizze_83155)) {\n                if (slt32(local_tid_83153 + offset_83178, sext_i64_i32(segred_tblock_sizze_66864)) && ((local_tid_83153 - squot32(local_tid_83153, wave_sizze_83155) * wave_sizze_83155) & (2 * offset_83178 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_83164 = ((volatile __local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83178)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zp_res_83165 = add64(eta_p_83163, eta_p_83164);\n                        \n                        eta_p_83163 = zp_res_83165;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_83163;\n                    }\n                }\n                offset_83178 *= 2;\n            }\n            while (slt32(skip_waves_83179, squot32(sext_i64_i32(segred_tblock_sizze_66864) + wave_sizze_83155 - 1, wave_sizze_83155))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_83178 = skip_waves_83179 * wave_sizze_83155;\n                if (slt32(local_tid_83153 + offset_83178, sext_i64_i32(segred_tblock_sizze_66864)) && ((local_tid_83153 - squot32(local_tid_83153",
                                    ", wave_sizze_83155) * wave_sizze_83155) == 0 && (squot32(local_tid_83153, wave_sizze_83155) & (2 * skip_waves_83179 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_83164 = ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153 + offset_83178)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zp_res_83165 = add64(eta_p_83163, eta_p_83164);\n                        \n                        eta_p_83163 = zp_res_83165;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_83157)[sext_i32_i64(local_tid_83153)] = eta_p_83163;\n                    }\n                }\n                skip_waves_83179 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_83153 == 0) {\n                    ((__global int64_t *) mem_81953)[(int64_t) 0] = eta_p_83163;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_66864\n    #undef chunk_sizze_83126\n}\nFUTHARK_KERNEL_SIZED(next_partition_to_read_doublezisegscan_66879_dim1, 1, 1)\nvoid next_partition_to_read_doublezisegscan_66879(__global int *global_failure, int64_t part_no_31685, int64_t num_tblocks_66876, int64_t num_virt_blocks_83185, int64_t num_virt_threads_83186, __global unsigned char *clProc_mem_81937, __global unsigned char *mem_81957, __global unsigned char *mem_81959, __global unsigned char *status_flags_mem_83187, __global unsigned char *aggregates_mem_83209, __global unsigned char *incprefixes_mem_83211, __global unsigned char *global_dynid_mem_83213)\n{\n    #define segscan_tblock_sizze_66874 (next_partition_to_read_doublezisegscan_66879zisegscan_tblock_sizze_66874)\n    #define chunk_sizze_83184 (next_partition_to_read_dou", "blezisegscan_66879zichunk_sizze_83184)\n    \n    volatile __local unsigned char *local_mem_83223_backing_0 = &shared_mem[0];\n    const int64_t local_mem_83223_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_66874), chunk_sizze_83184 * segscan_tblock_sizze_66874 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_66874), chunk_sizze_83184 * segscan_tblock_sizze_66874 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83216;\n    int32_t tblock_sizze_83219;\n    int32_t wave_sizze_83218;\n    int32_t block_id_83217;\n    int32_t global_tid_83215;\n    int64_t phys_tid_66879;\n    int32_t chunk_sizze_32b_83220;\n    int64_t byte_offsets_83221;\n    int64_t warp_byte_offset_83222;\n    __local unsigned char *local_mem_83223;\n    int64_t trans_arr_len_83224;\n    int64_t phys_block_id_83230;\n    int64_t virtloop_bound_83231;\n    \n    local_tid_83216 = get_local_id(0);\n    tblock_sizze_83219 = get_local_size(0);\n    wave_sizze_83218 = LOCKSTEP_WIDTH;\n    block_id_83217 = get_tblock_id(0);\n    global_tid_83215 = block_id_83217 * tblock_sizze_83219 + local_tid_83216;\n    phys_tid_66879 = sext_i32_i64(global_tid_83215);\n    chunk_sizze_32b_83220 = sext_i64_i32(chunk_sizze_83184);\n    byte_offsets_83221 = segscan_tblock_sizze_66874 * (int64_t) 8;\n    warp_byte_offset_83222 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_83223 = (__local unsigned char *) local_mem_83223_backing_0;\n    trans_arr_len_83224 = chunk_sizze_83184 * segscan_tblock_sizze_66874;\n    phys_block_id_83230 = get_tblock_id(0);\n    virtloop_bound_83231 = sdiv_up64(num_virt_blocks_83185 - phys_block_id_83230, num_tblocks_66876);\n    for (int64_t virtloop_i_83232 = 0; virtloop_i_83232 < virtloop_bound_83231; virtloop_i_83232++) {\n        int64_t dynamic_id_83233;\n        int64_t block_offset_83234;\n        int64_t sgm_idx_832", "35;\n        int32_t boundary_83236;\n        int32_t segsizze_compact_83237;\n        int64_t private_mem_83238[chunk_sizze_83184];\n        int64_t thd_offset_83240;\n        int64_t acc_83256;\n        int64_t prefix_83266;\n        bool block_new_sgm_83267;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_83216 == 0) {\n                dynamic_id_83233 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_83213)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_83223)[(int64_t) 0] = dynamic_id_83233;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_83233 == num_virt_blocks_83185 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_83213)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_83233 = ((__local int32_t *) local_mem_83223)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_83234 = dynamic_id_83233 * chunk_sizze_83184 * segscan_tblock_sizze_66874;\n        sgm_idx_83235 = smod64(block_offset_83234, part_no_31685);\n        boundary_83236 = sext_i64_i32(smin64(chunk_sizze_83184 * segscan_tblock_sizze_66874, part_no_31685 - sgm_idx_83235));\n        segsizze_compact_83237 = sext_i64_i32(smin64(chunk_sizze_83184 * segscan_tblock_sizze_66874, part_no_31685));\n        thd_offset_83240 = block_offset_83234 + sext_i32_i64(local_tid_83216);\n        // Load and map\n        {\n            for (int64_t i_83241 = 0; i_83241 < chunk_sizze_83184; i_83241++) {\n                int64_t virt_tid_83242 = thd_offset_83240 + i_83241 * segscan_tblock_sizze_66874;\n                int64_t slice_83243 = part_no_31685;\n                int64_t gtid_66878 = virt_tid_83242;\n                int",
                                    "64_t remnant_83244 = virt_tid_83242 - gtid_66878;\n                \n                if (slt64(virt_tid_83242, part_no_31685)) {\n                    bool eta_p_63921 = ((__global bool *) clProc_mem_81937)[gtid_66878];\n                    bool lifted_lambda_res_63922 = !eta_p_63921;\n                    int64_t defunc_0_f_res_63923 = btoi_bool_i64(lifted_lambda_res_63922);\n                    \n                    ((__global int64_t *) mem_81959)[gtid_66878] = defunc_0_f_res_63923;\n                    private_mem_83238[i_83241] = defunc_0_f_res_63923;\n                } else {\n                    private_mem_83238[i_83241] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_83245 = 0; i_83245 < chunk_sizze_83184; i_83245++) {\n                int64_t sharedIdx_83246 = sext_i32_i64(local_tid_83216) + i_83245 * segscan_tblock_sizze_66874;\n                int64_t tmp_83247 = private_mem_83238[i_83245];\n                \n                ((__local int64_t *) local_mem_83223)[sharedIdx_83246] = tmp_83247;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83248 = 0; i_83248 < chunk_sizze_83184; i_83248++) {\n                int64_t sharedIdx_83249 = sext_i32_i64(local_tid_83216) * chunk_sizze_83184 + i_83248;\n                int64_t tmp_83250 = ((__local int64_t *) local_mem_83223)[sharedIdx_83249];\n                \n                private_mem_83238[i_83248] = tmp_83250;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_83251 = 0; i_83251 < chunk_sizze_83184 - (int64_t) 1; i_83251++) {\n                int64_t eta_p_63924;\n                int64_t eta_p_63925;\n                \n                eta_p_63924 = private_mem_83238[i_83251];\n                eta_p_63925 = private_mem_83238[i_83251 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_6", "3926 = add64(eta_p_63924, eta_p_63925);\n                \n                private_mem_83238[i_83251 + (int64_t) 1] = defunc_0_op_res_63926;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_83252 = private_mem_83238[chunk_sizze_83184 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = tmp_83252;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_83253;\n            int64_t eta_p_83254;\n            int64_t eta_p_83257;\n            int64_t eta_p_83258;\n            bool ltid_in_bounds_83260 = slt64(sext_i32_i64(local_tid_83216), num_virt_threads_83186);\n            int32_t skip_threads_83261;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_83260) {\n                    eta_p_83254 = ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)];\n                    if ((local_tid_83216 - squot32(local_tid_83216, 32) * 32) == 0) {\n                        eta_p_83253 = eta_p_83254;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_83261 = 1;\n                while (slt32(skip_threads_83261, 32)) {\n                    bool thread_active_83262 = sle32(skip_threads_83261, local_tid_83216 - squot32(local_tid_83216, 32) * 32) && ltid_in_bounds_83260;\n                    \n                    if (thread_active_83262) {\n                        // read operands\n                        {\n                            eta_p_83253 = ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216) - sext_i32_i64(skip_threads_83261)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_83262) {\n                      ", "      int64_t defunc_0_op_res_83255 = add64(eta_p_83253, eta_p_83254);\n                            \n                            eta_p_83253 = defunc_0_op_res_83255;\n                        }\n                    }\n                    if (sle32(wave_sizze_83218, skip_threads_83261)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_83262) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = eta_p_83253;\n                            eta_p_83254 = eta_p_83253;\n                        }\n                    }\n                    if (sle32(wave_sizze_83218, skip_threads_83261)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_83261 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_83216 - squot32(local_tid_83216, 32) * 32) == 31 && ltid_in_bounds_83260) {\n                    ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(squot32(local_tid_83216, 32))] = eta_p_83253;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_83263;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_83216, 32) == 0 && ltid_in_bounds_83260) {\n                        eta_p_83258 = ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)];\n                        if ((local_tid_83216 - squot32(local_tid_83216, 32) * 32) == 0) {\n                            eta_p_83257 = eta_p_83258;\n                        }\n                    }\n              ",
                                    "  }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_83263 = 1;\n                    while (slt32(skip_threads_83263, 32)) {\n                        bool thread_active_83264 = sle32(skip_threads_83263, local_tid_83216 - squot32(local_tid_83216, 32) * 32) && (squot32(local_tid_83216, 32) == 0 && ltid_in_bounds_83260);\n                        \n                        if (thread_active_83264) {\n                            // read operands\n                            {\n                                eta_p_83257 = ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216) - sext_i32_i64(skip_threads_83263)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_83264) {\n                                int64_t defunc_0_op_res_83259 = add64(eta_p_83257, eta_p_83258);\n                                \n                                eta_p_83257 = defunc_0_op_res_83259;\n                            }\n                        }\n                        if (sle32(wave_sizze_83218, skip_threads_83263)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_83264) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = eta_p_83257;\n                                eta_p_83258 = eta_p_83257;\n                            }\n                        }\n                        if (sle32(wave_sizze_83218, skip_threads_83263)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_83263 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_i", "n_83265 = squot32(local_tid_83216, 32) == 0 || !ltid_in_bounds_83260;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_83265) {\n                        eta_p_83254 = eta_p_83253;\n                        eta_p_83253 = ((__local int64_t *) local_mem_83223)[sext_i32_i64(squot32(local_tid_83216, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_83265) {\n                        int64_t defunc_0_op_res_83255 = add64(eta_p_83253, eta_p_83254);\n                        \n                        eta_p_83253 = defunc_0_op_res_83255;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_83265) {\n                        ((__local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = eta_p_83253;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_83216, 32) == 0 && ltid_in_bounds_83260) {\n                    ((__local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = eta_p_83254;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_83216 == 0) {\n                acc_83256 = ((__local int64_t *) local_mem_83223)[segscan_tblock_sizze_66874 - (int64_t) 1];\n            } else {\n                acc_83256 = ((__local int64_t *) local_mem_83223)[sext_i32_i64(local_tid_83216) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_83266 = (int64_t) 0;\n        block_new_sgm_83267 = sgm_idx_83235 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_83267 && local_tid_8", "3216 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_83211)[dynamic_id_83233] = acc_83256;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_83187)[dynamic_id_83233] = (int8_t) 2;\n                acc_83256 = (int64_t) 0;\n            }\n            if (!block_new_sgm_83267 && slt32(local_tid_83216, wave_sizze_83218)) {\n                if (local_tid_83216 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_83209)[dynamic_id_83233] = acc_83256;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_83187)[dynamic_id_83233] = (int8_t) 1;\n                    \n                    int8_t tmp_83268 = ((volatile __global int8_t *) status_flags_mem_83187)[dynamic_id_83233 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_83223)[(int64_t) 0] = tmp_83268;\n                }\n                mem_fence_local();\n                \n                int8_t status_83269 = ((__local int8_t *) local_mem_83223)[(int64_t) 0];\n                \n                if (status_83269 == (int8_t) 2) {\n                    if (local_tid_83216 == 0) {\n                        prefix_83266 = ((volatile __global int64_t *) incprefixes_mem_83211)[dynamic_id_83233 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_83270 = sext_i64_i32(dynamic_id_83233 - sext_i32_i64(wave_sizze_83218));\n                    \n                    while (slt32(wave_sizze_83218 * -1, readOffset_83270)) {\n                        int32_t read_i_83271 = readOffset_83270 + local_tid_83216;\n                        int64_t aggr_83272 = (int64_t) 0;\n                        int8_t flag_83273 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_83271)) {\n                            flag_83273 = ((volatile __global int8_t *) status_flags_mem_83187)[sext_i32_i64(read_i_83271)]",
                                    ";\n                            if (flag_83273 == (int8_t) 2) {\n                                aggr_83272 = ((volatile __global int64_t *) incprefixes_mem_83211)[sext_i32_i64(read_i_83271)];\n                            } else if (flag_83273 == (int8_t) 1) {\n                                aggr_83272 = ((volatile __global int64_t *) aggregates_mem_83209)[sext_i32_i64(read_i_83271)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_83223)[(int64_t) 4 + sext_i32_i64(local_tid_83216)] = aggr_83272;\n                        ((__local int8_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = flag_83273;\n                        flag_83273 = ((__local int8_t *) local_mem_83223)[sext_i32_i64(wave_sizze_83218) - (int64_t) 1];\n                        if (slt8(flag_83273, (int8_t) 2)) {\n                            int8_t flg_x_83277;\n                            int8_t flg_y_83278;\n                            int64_t eta_p_83274;\n                            int64_t eta_p_83275;\n                            int32_t skip_threads_83279;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_83278 = ((volatile __local int8_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)];\n                                eta_p_83275 = ((volatile __local int64_t *) local_mem_83223)[(int64_t) 4 + sext_i32_i64(local_tid_83216)];\n                                if ((local_tid_83216 - squot32(local_tid_83216, 32) * 32) == 0) {\n                                    eta_p_83274 = eta_p_83275;\n                                    flg_x_83277 = flg_y_83278;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_83279 = 1;\n                                while (slt32(skip_threads_83279, 32)) ", "{\n                                    if (sle32(skip_threads_83279, local_tid_83216 - squot32(local_tid_83216, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_83277 = ((volatile __local int8_t *) local_mem_83223)[sext_i32_i64(local_tid_83216) - sext_i32_i64(skip_threads_83279)];\n                                            eta_p_83274 = ((volatile __local int64_t *) local_mem_83223)[(int64_t) 4 + (sext_i32_i64(local_tid_83216) - sext_i32_i64(skip_threads_83279))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_83278 == (int8_t) 2 || flg_y_83278 == (int8_t) 0) {\n                                                flg_x_83277 = flg_y_83278;\n                                                eta_p_83274 = eta_p_83275;\n                                            } else {\n                                                int64_t defunc_0_op_res_83276 = add64(eta_p_83274, eta_p_83275);\n                                                \n                                                eta_p_83274 = defunc_0_op_res_83276;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_83223)[sext_i32_i64(local_tid_83216)] = flg_x_83277;\n                                            flg_y_83278 = flg_x_83277;\n                                            ((volatile __local int64_t *) local_mem_83223)[(int64_t) 4 + sext_i32_i64(local_tid_83216)] = eta_p_83274;\n                                            eta_p_83275 = eta_p_83274;\n                                        }\n                                    }\n                      ", "              skip_threads_83279 *= 2;\n                                }\n                            }\n                        }\n                        flag_83273 = ((__local int8_t *) local_mem_83223)[sext_i32_i64(wave_sizze_83218) - (int64_t) 1];\n                        aggr_83272 = ((__local int64_t *) local_mem_83223)[(int64_t) 4 + (sext_i32_i64(wave_sizze_83218) - (int64_t) 1)];\n                        if (flag_83273 == (int8_t) 2) {\n                            readOffset_83270 = wave_sizze_83218 * -1;\n                        } else if (flag_83273 == (int8_t) 1) {\n                            readOffset_83270 -= wave_sizze_83218;\n                        }\n                        if (slt8((int8_t) 0, flag_83273)) {\n                            int64_t eta_p_83280 = aggr_83272;\n                            int64_t eta_p_83281 = prefix_83266;\n                            int64_t defunc_0_op_res_83282 = add64(eta_p_83280, eta_p_83281);\n                            \n                            prefix_83266 = defunc_0_op_res_83282;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_83216 == 0) {\n                    if (boundary_83236 == sext_i64_i32(segscan_tblock_sizze_66874 * chunk_sizze_83184)) {\n                        int64_t eta_p_83283 = prefix_83266;\n                        int64_t eta_p_83284 = acc_83256;\n                        int64_t defunc_0_op_res_83285 = add64(eta_p_83283, eta_p_83284);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_83211)[dynamic_id_83233] = defunc_0_op_res_83285;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_83187)[dynamic_id_83233] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_83223)[(int64_t) 4] = prefix_83266;\n                    acc_83256 = (int64_t) 0;\n                }\n            }\n      ",
                                    "      if (!(dynamic_id_83233 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_83266 = ((__local int64_t *) local_mem_83223)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_83286;\n            int64_t eta_p_83287;\n            int64_t eta_p_83289 = prefix_83266;\n            int64_t eta_p_83290 = acc_83256;\n            \n            if (slt32(local_tid_83216 * chunk_sizze_32b_83220, boundary_83236) && !block_new_sgm_83267) {\n                int64_t defunc_0_op_res_83291 = add64(eta_p_83289, eta_p_83290);\n                \n                eta_p_83286 = defunc_0_op_res_83291;\n            } else {\n                eta_p_83286 = acc_83256;\n            }\n            \n            int32_t stopping_point_83292 = segsizze_compact_83237 - srem32(local_tid_83216 * chunk_sizze_32b_83220 - 1 + segsizze_compact_83237 - boundary_83236, segsizze_compact_83237);\n            \n            for (int64_t i_83293 = 0; i_83293 < chunk_sizze_83184; i_83293++) {\n                if (slt32(sext_i64_i32(i_83293), stopping_point_83292 - 1)) {\n                    eta_p_83287 = private_mem_83238[i_83293];\n                    \n                    int64_t defunc_0_op_res_83288 = add64(eta_p_83286, eta_p_83287);\n                    \n                    private_mem_83238[i_83293] = defunc_0_op_res_83288;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_83294 = 0; i_83294 < chunk_sizze_83184; i_83294++) {\n                int64_t sharedIdx_83295 = sext_i32_i64(local_tid_83216) * chunk_sizze_83184 + i_83294;\n                int64_t tmp_83296 = private_mem_83238[i_83294];\n                \n                ((__local int64_t *) local_mem_83223)[sharedIdx_83295] = tmp_83296;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_83297 = 0", "; i_83297 < chunk_sizze_83184; i_83297++) {\n                int64_t flat_idx_83298 = thd_offset_83240 + i_83297 * segscan_tblock_sizze_66874;\n                int64_t slice_83299 = part_no_31685;\n                int64_t gtid_66878 = flat_idx_83298;\n                int64_t remnant_83300 = flat_idx_83298 - gtid_66878;\n                \n                if (slt64(flat_idx_83298, part_no_31685)) {\n                    int64_t tmp_83301 = ((__local int64_t *) local_mem_83223)[flat_idx_83298 - block_offset_83234];\n                    \n                    ((__global int64_t *) mem_81957)[gtid_66878] = tmp_83301;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_66874\n    #undef chunk_sizze_83184\n}\nFUTHARK_KERNEL_SIZED(rectify_cluster_ids_doublezisegmap_74989_dim1, 1, 1)\nvoid rectify_cluster_ids_doublezisegmap_74989(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_51920, int64_t dz2081Uz2080U_51921, int64_t ncc_51925, int64_t this_step_53636, __global unsigned char *chain_ids_mem_81927, __global unsigned char *chain_id_mem_81928, __global unsigned char *mem_param_81934, __global unsigned char *mem_81937)\n{\n    #define segmap_tblock_sizze_74985 (rectify_cluster_ids_doublezisegmap_74989zisegmap_tblock_sizze_74985)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83143;\n    int32_t tblock_sizze_83146;\n    int32_t wave_sizze_83145;\n    int32_t block_id_83144;\n    int32_t global_tid_83142;\n    int64_t phys_tid_74989;\n    int64_t global_tid_83147;\n    int64_t slice_83148;\n    int64_t gtid_74988;\n    int64_t remnant_83149;\n    \n    local_tid_83143 = get_local_id(0);\n    tblock_sizze_83146 = get_local_size(0);\n    wave_sizze_83145 = LOCKSTEP_WIDTH;\n    block_id_83144 = get_tblock_id(0);\n    global_tid_83142 = block_id_83144 * tblock_sizze_83146 + local_tid_83143;\n    phys_tid_74989 = sext_i32_i64(global_tid_8", "3142);\n    global_tid_83147 = sext_i32_i64(block_id_83144) * segmap_tblock_sizze_74985 + sext_i32_i64(local_tid_83143);\n    slice_83148 = n_51920;\n    gtid_74988 = global_tid_83147;\n    remnant_83149 = global_tid_83147 - gtid_74988;\n    if (slt64(gtid_74988, n_51920)) {\n        int64_t eta_p_74990;\n        bool cond_74992;\n        int64_t prev_elem_74993;\n        bool cond_75003;\n        int64_t cur_elem_75004;\n        int64_t lifted_lambda_res_75013;\n        \n        eta_p_74990 = ((__global int64_t *) mem_param_81934)[gtid_74988];\n        cond_74992 = sle64(eta_p_74990, (int64_t) 0);\n        if (cond_74992) {\n            bool y_74994;\n            bool index_certs_74995;\n            int64_t prev_elem_t_res_74996;\n            \n            y_74994 = slt64((int64_t) 0, dz2081Uz2080U_51921);\n            if (!y_74994) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 86) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) dz2081Uz2080U_51921;\n                        ;\n                    }\n                    return;\n                }\n            }\n            prev_elem_t_res_74996 = ((__global int64_t *) chain_id_mem_81928)[(int64_t) 0];\n            prev_elem_74993 = prev_elem_t_res_74996;\n        } else {\n            int64_t tmp_74997;\n            bool x_74998;\n            bool y_74999;\n            bool bounds_check_75000;\n            bool index_certs_75001;\n            int64_t prev_elem_f_res_75002;\n            \n            tmp_74997 = sub64(eta_p_74990, (int64_t) 1);\n            x_74998 = sle64((int64_t) 0, tmp_74997);\n            y_74999 = slt64(tmp_74997, dz2081Uz2080U_51921);\n            bounds_check_75000 = x_74998 && y_74999;\n            if (!bounds_check_75000) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 87) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_74997;\n   ",
                                    "                     global_failure_args[1] = (int64_t) dz2081Uz2080U_51921;\n                        ;\n                    }\n                    return;\n                }\n            }\n            prev_elem_f_res_75002 = ((__global int64_t *) chain_id_mem_81928)[tmp_74997];\n            prev_elem_74993 = prev_elem_f_res_75002;\n        }\n        cond_75003 = slt64(eta_p_74990, (int64_t) 0);\n        if (cond_75003) {\n            bool y_75005;\n            bool index_certs_75006;\n            int64_t cur_elem_t_res_75007;\n            \n            y_75005 = slt64((int64_t) 0, dz2081Uz2080U_51921);\n            if (!y_75005) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 88) == -1) {\n                        global_failure_args[0] = (int64_t) (int64_t) 0;\n                        global_failure_args[1] = (int64_t) dz2081Uz2080U_51921;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cur_elem_t_res_75007 = ((__global int64_t *) chain_id_mem_81928)[(int64_t) 0];\n            cur_elem_75004 = cur_elem_t_res_75007;\n        } else {\n            bool x_75008;\n            bool y_75009;\n            bool bounds_check_75010;\n            bool index_certs_75011;\n            int64_t cur_elem_f_res_75012;\n            \n            x_75008 = sle64((int64_t) 0, eta_p_74990);\n            y_75009 = slt64(eta_p_74990, dz2081Uz2080U_51921);\n            bounds_check_75010 = x_75008 && y_75009;\n            if (!bounds_check_75010) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 89) == -1) {\n                        global_failure_args[0] = (int64_t) eta_p_74990;\n                        global_failure_args[1] = (int64_t) dz2081Uz2080U_51921;\n                        ;\n                    }\n                    return;\n                }\n            }\n            cur_elem_f_res_75012 = ((__global int64_t *) chain_id_mem_81928)[eta_p_74990];\n            ", "cur_elem_75004 = cur_elem_f_res_75012;\n        }\n        if (cond_75003) {\n            lifted_lambda_res_75013 = (int64_t) -1;\n        } else {\n            int64_t eta_p_74991;\n            bool cond_75014;\n            bool cond_75015;\n            bool cond_t_res_f_res_75016;\n            bool x_75017;\n            bool y_75018;\n            bool cond_t_res_75019;\n            bool x_75020;\n            int64_t lifted_lambda_res_f_res_75021;\n            \n            eta_p_74991 = ((__global int64_t *) chain_ids_mem_81927)[gtid_74988];\n            cond_75014 = eta_p_74991 == cur_elem_75004;\n            cond_75015 = eta_p_74990 == (int64_t) 0;\n            cond_t_res_f_res_75016 = slt64(prev_elem_74993, eta_p_74991);\n            x_75017 = !cond_75015;\n            y_75018 = cond_t_res_f_res_75016 && x_75017;\n            cond_t_res_75019 = cond_75015 || y_75018;\n            x_75020 = cond_75014 && cond_t_res_75019;\n            if (x_75020) {\n                lifted_lambda_res_f_res_75021 = eta_p_74990;\n            } else {\n                int64_t lifted_lambda_res_f_res_f_res_75022;\n                \n                if (cond_75014) {\n                    int64_t max_arg1_75023;\n                    int64_t max_res_75024;\n                    \n                    max_arg1_75023 = sub64(eta_p_74990, this_step_53636);\n                    max_res_75024 = smax64((int64_t) 0, max_arg1_75023);\n                    lifted_lambda_res_f_res_f_res_75022 = max_res_75024;\n                } else {\n                    bool cond_75025;\n                    int64_t lifted_lambda_res_f_res_f_res_f_res_75026;\n                    \n                    cond_75025 = slt64(cur_elem_75004, eta_p_74991);\n                    if (cond_75025) {\n                        int64_t zeze_rhs_75027;\n                        bool cond_75028;\n                        int64_t lifted_lambda_res_f_res_f_res_f_res_t_res_75029;\n                        \n                        zeze_rhs_75027 = sub64(ncc_51925, (int64_t) 1);\n     ", "                   cond_75028 = eta_p_74990 == zeze_rhs_75027;\n                        if (cond_75028) {\n                            lifted_lambda_res_f_res_f_res_f_res_t_res_75029 = (int64_t) -1;\n                        } else {\n                            int64_t min_arg1_75030;\n                            int64_t min_res_75031;\n                            \n                            min_arg1_75030 = add64(this_step_53636, eta_p_74990);\n                            min_res_75031 = smin64(zeze_rhs_75027, min_arg1_75030);\n                            lifted_lambda_res_f_res_f_res_f_res_t_res_75029 = min_res_75031;\n                        }\n                        lifted_lambda_res_f_res_f_res_f_res_75026 = lifted_lambda_res_f_res_f_res_f_res_t_res_75029;\n                    } else {\n                        int64_t lifted_lambda_res_f_res_f_res_f_res_f_res_75032;\n                        \n                        if (cond_t_res_75019) {\n                            lifted_lambda_res_f_res_f_res_f_res_f_res_75032 = (int64_t) -1;\n                        } else {\n                            int64_t max_arg1_75033;\n                            int64_t max_res_75034;\n                            \n                            max_arg1_75033 = sub64(eta_p_74990, this_step_53636);\n                            max_res_75034 = smax64((int64_t) 0, max_arg1_75033);\n                            lifted_lambda_res_f_res_f_res_f_res_f_res_75032 = max_res_75034;\n                        }\n                        lifted_lambda_res_f_res_f_res_f_res_75026 = lifted_lambda_res_f_res_f_res_f_res_f_res_75032;\n                    }\n                    lifted_lambda_res_f_res_f_res_75022 = lifted_lambda_res_f_res_f_res_f_res_75026;\n                }\n                lifted_lambda_res_f_res_75021 = lifted_lambda_res_f_res_f_res_75022;\n            }\n            lifted_lambda_res_75013 = lifted_lambda_res_f_res_75021;\n        }\n        ((__global int64_t *) mem_81937)[gtid_74988] = lifted_lambda_res_75013",
                                    ";\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_74985\n}\nFUTHARK_KERNEL_SIZED(rectify_cluster_ids_doublezisegmap_75061_dim1, 1, 1)\nvoid rectify_cluster_ids_doublezisegmap_75061(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_51920, int64_t dz2081Uz2081U_51922, __global unsigned char *chain_ids_mem_81927, __global unsigned char *replaceWith_mem_81929, __global unsigned char *ext_mem_81940, __global unsigned char *mem_81943)\n{\n    #define segmap_tblock_sizze_75057 (rectify_cluster_ids_doublezisegmap_75061zisegmap_tblock_sizze_75057)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_83152;\n    int32_t tblock_sizze_83155;\n    int32_t wave_sizze_83154;\n    int32_t block_id_83153;\n    int32_t global_tid_83151;\n    int64_t phys_tid_75061;\n    int64_t global_tid_83156;\n    int64_t slice_83157;\n    int64_t gtid_75060;\n    int64_t remnant_83158;\n    \n    local_tid_83152 = get_local_id(0);\n    tblock_sizze_83155 = get_local_size(0);\n    wave_sizze_83154 = LOCKSTEP_WIDTH;\n    block_id_83153 = get_tblock_id(0);\n    global_tid_83151 = block_id_83153 * tblock_sizze_83155 + local_tid_83152;\n    phys_tid_75061 = sext_i32_i64(global_tid_83151);\n    global_tid_83156 = sext_i32_i64(block_id_83153) * segmap_tblock_sizze_75057 + sext_i32_i64(local_tid_83152);\n    slice_83157 = n_51920;\n    gtid_75060 = global_tid_83156;\n    remnant_83158 = global_tid_83156 - gtid_75060;\n    if (slt64(gtid_75060, n_51920)) {\n        int64_t eta_p_75063;\n        bool cond_75064;\n        bool cond_f_res_75065;\n        bool x_75066;\n        bool y_75067;\n        bool cond_75068;\n        int64_t lifted_lambda_res_75069;\n        \n        eta_p_75063 = ((__global int64_t *) ext_mem_81940)[gtid_75060];\n        cond_75064 = slt64(eta_p_75063, (int64_t) 0);\n        cond_f_res_75065 = sle64(dz2081Uz2081U_51922, eta_p_75063);\n        x_75066 = !cond_75064;\n        y_75067 = cond_f_res_75065 && x_75066;\n        cond_7506", "8 = cond_75064 || y_75067;\n        if (cond_75068) {\n            int64_t eta_p_75062 = ((__global int64_t *) chain_ids_mem_81927)[gtid_75060];\n            \n            lifted_lambda_res_75069 = eta_p_75062;\n        } else {\n            bool x_75070;\n            bool y_75071;\n            bool bounds_check_75072;\n            bool index_certs_75073;\n            int64_t lifted_lambda_res_f_res_75074;\n            \n            x_75070 = sle64((int64_t) 0, eta_p_75063);\n            y_75071 = slt64(eta_p_75063, dz2081Uz2081U_51922);\n            bounds_check_75072 = x_75070 && y_75071;\n            if (!bounds_check_75072) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 90) == -1) {\n                        global_failure_args[0] = (int64_t) eta_p_75063;\n                        global_failure_args[1] = (int64_t) dz2081Uz2081U_51922;\n                        ;\n                    }\n                    return;\n                }\n            }\n            lifted_lambda_res_f_res_75074 = ((__global int64_t *) replaceWith_mem_81929)[eta_p_75063];\n            lifted_lambda_res_75069 = lifted_lambda_res_f_res_75074;\n        }\n        ((__global int64_t *) mem_81943)[gtid_75060] = lifted_lambda_res_75069;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_75057\n}\n", NULL};
// Start of gpu_prototypes.h

// Constants used for transpositions.  In principle these should be configurable.
#define TR_BLOCK_DIM 16
#define TR_TILE_DIM (TR_BLOCK_DIM*2)
#define TR_ELEMS_PER_THREAD 8

// Config stuff included in every GPU backend.
struct gpu_config {
  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_cache;
  size_t default_shared_memory;
  size_t default_registers;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;
};

// The following are dummy sizes that mean the concrete defaults
// will be set during initialisation via hardware-inspection-based
// heuristics.
struct gpu_config gpu_config_initial = {
  0
};

// Must be defined by the user.
static int gpu_macros(struct futhark_context *ctx, char*** names, int64_t** values);

static void gpu_init_log(struct futhark_context *ctx);
struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);
static int gpu_free_all(struct futhark_context *ctx);

// End of gpu_prototypes.h

// Start of backends/cuda.h.

// Forward declarations.
// Invoked by setup_opencl() after the platform and device has been
// found, but before the program is loaded.  Its intended use is to
// tune constants based on the selected platform and device.
static void set_tuning_params(struct futhark_context* ctx);
static char* get_failure_msg(int failure_idx, int64_t args[]);

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_FATAL(x) nvrtc_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_NONFATAL(x) nvrtc_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
// Take care not to override an existing error.
#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                               \
      if (!ctx->error) {                        \
        ctx->error = serror;                    \
      } else {                                  \
        free(serror);                           \
      }                                         \
      return bad;                               \
    }                                           \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
                                          const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
                                       const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed_fatal(nvrtcResult res, const char *call,
                                           const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* nvrtc_api_succeed_nonfatal(nvrtcResult res, const char *call,
                                        const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    return msgprintf("%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char* cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  char* program;
  int num_nvrtc_opts;
  char* *nvrtc_opts;

  char* preferred_device;
  int preferred_device_num;

  int unified_memory;

  char* dump_ptx_to;
  char* load_ptx_from;

  struct gpu_config gpu;
};

static void backend_context_config_setup(struct futhark_context_config *cfg) {
  cfg->num_nvrtc_opts = 0;
  cfg->nvrtc_opts = (char**) malloc(sizeof(char*));
  cfg->nvrtc_opts[0] = NULL;

  cfg->program = strconcat(gpu_program);

  cfg->preferred_device_num = 0;
  cfg->preferred_device = strdup("");

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->unified_memory = 2;

  cfg->gpu = gpu_config_initial;
  cfg->gpu.default_block_size = 256;
  cfg->gpu.default_tile_size = 32;
  cfg->gpu.default_reg_tile_size = 2;
  cfg->gpu.default_threshold = 32*1024;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  for (int i = 0; i < cfg->num_nvrtc_opts; i++) {
    free(cfg->nvrtc_opts[i]);
  }
  free(cfg->nvrtc_opts);
  free(cfg->dump_ptx_to);
  free(cfg->load_ptx_from);
  free(cfg->preferred_device);
  free(cfg->program);
}

void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt) {
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = strdup(opt);
  cfg->num_nvrtc_opts++;
  cfg->nvrtc_opts = (char **) realloc(cfg->nvrtc_opts, (cfg->num_nvrtc_opts + 1) * sizeof(char *));
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}

void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  free(cfg->preferred_device);
  cfg->preferred_device = strdup(s);
  cfg->preferred_device_num = x;
}

const char* futhark_context_config_get_program(struct futhark_context_config *cfg) {
  return cfg->program;
}

void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s) {
  free(cfg->program);
  cfg->program = strdup(s);
}

void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *path) {
  free(cfg->dump_ptx_to);
  cfg->dump_ptx_to = strdup(path);
}

void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *path) {
  free(cfg->load_ptx_from);
  cfg->load_ptx_from = strdup(path);
}

void futhark_context_config_set_unified_memory(struct futhark_context_config* cfg, int flag) {
  cfg->unified_memory = flag;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  const char *name;
};

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
  // Uniform fields above.

  CUdeviceptr global_failure;
  CUdeviceptr global_failure_args;
  struct tuning_params tuning_params;
  // True if a potentially failing kernel has been enqueued.
  int32_t failure_is_an_option;
  int total_runs;
  long int total_runtime;
  int64_t peak_mem_usage_device;
  int64_t cur_mem_usage_device;

  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;
  CUstream stream;

  struct free_list gpu_free_list;

  size_t max_thread_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;
  size_t max_registers;
  size_t max_cache;

  size_t lockstep_width;

  struct builtin_kernels* kernels;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static int cuda_device_setup(struct futhark_context *ctx) {
  struct futhark_context_config *cfg = ctx->cfg;
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best = 0, cc_minor_best = 0;
  int cc_major = 0, cc_minor = 0;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (cfg->logging) {
      fprintf(ctx->log, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
              i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (cfg->logging) {
        fprintf(ctx->log, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, cfg->preferred_device) != NULL &&
        num_device_matches++ == cfg->preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (cfg->logging) {
    fprintf(ctx->log, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  static struct {
    int major;
    int minor;
    const char *arch_str;
  } const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" },
    { 8, 6, "compute_80" },
    { 8, 7, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  int num_archs = sizeof(x)/sizeof(x[0]);
  for (int i = 0; i < num_archs; i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static void cuda_nvrtc_mk_build_options(struct futhark_context *ctx, const char *extra_opts[],
                                        char*** opts_out, size_t *n_opts) {
  int arch_set = 0, num_extra_opts;
  struct futhark_context_config *cfg = ctx->cfg;

  char** macro_names;
  int64_t* macro_vals;
  int num_macros = gpu_macros(ctx, &macro_names, &macro_vals);

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t i = 0, n_opts_alloc = 20 + num_macros + num_extra_opts + cfg->num_tuning_params;
  char **opts = (char**) malloc(n_opts_alloc * sizeof(char *));
  if (!arch_set) {
    opts[i++] = strdup("-arch");
    opts[i++] = strdup(cuda_nvrtc_get_arch(ctx->dev));
  }
  opts[i++] = strdup("-default-device");
  if (cfg->debugging) {
    opts[i++] = strdup("-G");
    opts[i++] = strdup("-lineinfo");
  } else {
    opts[i++] = strdup("--disable-warnings");
  }
  opts[i++] = msgprintf("-D%s=%d",
                        "max_thread_block_size",
                        (int)ctx->max_thread_block_size);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_shared_memory",
                        (int)ctx->max_shared_memory);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_registers",
                        (int)ctx->max_registers);

  for (int j = 0; j < num_macros; j++) {
    opts[i++] = msgprintf("-D%s=%zu", macro_names[j], macro_vals[j]);
  }

  for (int j = 0; j < cfg->num_tuning_params; j++) {
    opts[i++] = msgprintf("-D%s=%zu", cfg->tuning_param_vars[j],
                          cfg->tuning_params[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_thread_block_size);

  // Time for the best lines of the code in the entire compiler.
  if (getenv("CUDA_HOME") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_HOME"));
  }
  if (getenv("CUDA_ROOT") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_ROOT"));
  }
  if (getenv("CUDA_PATH") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_PATH"));
  }
  opts[i++] = msgprintf("-I/usr/local/cuda/include");
  opts[i++] = msgprintf("-I/usr/include");

  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = strdup(extra_opts[j]);
  }

  opts[i++] = msgprintf("-DTR_BLOCK_DIM=%d", TR_BLOCK_DIM);
  opts[i++] = msgprintf("-DTR_TILE_DIM=%d", TR_TILE_DIM);
  opts[i++] = msgprintf("-DTR_ELEMS_PER_THREAD=%d", TR_ELEMS_PER_THREAD);

  free(macro_names);
  free(macro_vals);

  *n_opts = i;
  *opts_out = opts;
}

static char* cuda_nvrtc_build(const char *src, const char *opts[], size_t n_opts,
                              char **ptx) {
  nvrtcProgram prog;
  char *problem = NULL;

  problem = NVRTC_SUCCEED_NONFATAL(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));

  if (problem) {
    return problem;
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        problem = msgprintf("NVRTC compilation failed.\n\n%s\n", log);
      } else {
        problem = msgprintf("Could not retrieve compilation log\n");
      }
      free(log);
    }
    return problem;
  }

  size_t ptx_size;
  NVRTC_SUCCEED_FATAL(nvrtcGetPTXSize(prog, &ptx_size));
  *ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED_FATAL(nvrtcGetPTX(prog, *ptx));

  NVRTC_SUCCEED_FATAL(nvrtcDestroyProgram(&prog));

  return NULL;
}

static void cuda_load_ptx_from_cache(struct futhark_context_config *cfg,
                                     const char *src,
                                     const char *opts[], size_t n_opts,
                                     struct cache_hash *h, const char *cache_fname,
                                     char **ptx) {
  if (cfg->logging) {
    fprintf(stderr, "Restoring cache from from %s...\n", cache_fname);
  }
  cache_hash_init(h);
  for (size_t i = 0; i < n_opts; i++) {
    cache_hash(h, opts[i], strlen(opts[i]));
  }
  cache_hash(h, src, strlen(src));
  size_t ptxsize;
  errno = 0;
  if (cache_restore(cache_fname, h, (unsigned char**)ptx, &ptxsize) != 0) {
    if (cfg->logging) {
      fprintf(stderr, "Failed to restore cache (errno: %s)\n", strerror(errno));
    }
  }
}

static void cuda_size_setup(struct futhark_context *ctx)
{
  struct futhark_context_config *cfg = ctx->cfg;
  if (cfg->gpu.default_block_size > ctx->max_thread_block_size) {
    if (cfg->gpu.default_block_size_changed) {
      fprintf(stderr,
              "Note: Device limits default block size to %zu (down from %zu).\n",
              ctx->max_thread_block_size, cfg->gpu.default_block_size);
    }
    cfg->gpu.default_block_size = ctx->max_thread_block_size;
  }
  if (cfg->gpu.default_grid_size > ctx->max_grid_size) {
    if (cfg->gpu.default_grid_size_changed) {
      fprintf(stderr,
              "Note: Device limits default grid size to %zu (down from %zu).\n",
              ctx->max_grid_size, cfg->gpu.default_grid_size);
    }
    cfg->gpu.default_grid_size = ctx->max_grid_size;
  }
  if (cfg->gpu.default_tile_size > ctx->max_tile_size) {
    if (cfg->gpu.default_tile_size_changed) {
      fprintf(stderr,
              "Note: Device limits default tile size to %zu (down from %zu).\n",
              ctx->max_tile_size, cfg->gpu.default_tile_size);
    }
    cfg->gpu.default_tile_size = ctx->max_tile_size;
  }

  if (!cfg->gpu.default_grid_size_changed) {
    cfg->gpu.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / cfg->gpu.default_block_size;
  }

  for (int i = 0; i < cfg->num_tuning_params; i++) {
    const char *size_class = cfg->tuning_param_classes[i];
    int64_t *size_value = &cfg->tuning_params[i];
    const char* size_name = cfg->tuning_param_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "thread_block_size") == size_class) {
      max_value = ctx->max_thread_block_size;
      default_value = cfg->gpu.default_block_size;
    } else if (strstr(size_class, "grid_size") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = cfg->gpu.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = cfg->gpu.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = cfg->gpu.default_reg_tile_size;
    } else if (strstr(size_class, "shared_memory") == size_class) {
      max_value = ctx->max_shared_memory;
      default_value = ctx->max_shared_memory;
    } else if (strstr(size_class, "cache") == size_class) {
      max_value = ctx->max_cache;
      default_value = ctx->max_cache;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = cfg->gpu.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static char* cuda_module_setup(struct futhark_context *ctx,
                               const char *src,
                               const char *extra_opts[],
                               const char* cache_fname) {
  char *ptx = NULL;
  struct futhark_context_config *cfg = ctx->cfg;

  if (cfg->load_ptx_from) {
    ptx = slurp_file(cfg->load_ptx_from, NULL);
  }

  char **opts;
  size_t n_opts;
  cuda_nvrtc_mk_build_options(ctx, extra_opts, &opts, &n_opts);

  if (cfg->logging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  struct cache_hash h;
  int loaded_ptx_from_cache = 0;
  if (cache_fname != NULL) {
    cuda_load_ptx_from_cache(cfg, src, (const char**)opts, n_opts, &h, cache_fname, &ptx);

    if (ptx != NULL) {
      if (cfg->logging) {
        fprintf(stderr, "Restored PTX from cache; now loading module...\n");
      }
      if (cuModuleLoadData(&ctx->module, ptx) == CUDA_SUCCESS) {
        if (cfg->logging) {
          fprintf(stderr, "Success!\n");
        }
        loaded_ptx_from_cache = 1;
      } else {
        if (cfg->logging) {
          fprintf(stderr, "Failed!\n");
        }
        free(ptx);
        ptx = NULL;
      }
    }
  }

  if (ptx == NULL) {
    char* problem = cuda_nvrtc_build(src, (const char**)opts, n_opts, &ptx);
    if (problem != NULL) {
      return problem;
    }
  }

  if (cfg->dump_ptx_to != NULL) {
    dump_file(cfg->dump_ptx_to, ptx, strlen(ptx));
  }

  if (!loaded_ptx_from_cache) {
    CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));
  }

  if (cache_fname != NULL && !loaded_ptx_from_cache) {
    if (cfg->logging) {
      fprintf(stderr, "Caching PTX in %s...\n", cache_fname);
    }
    errno = 0;
    if (cache_store(cache_fname, &h, (const unsigned char*)ptx, strlen(ptx)) != 0) {
      fprintf(stderr, "Failed to cache PTX: %s\n", strerror(errno));
    }
  }

  for (size_t i = 0; i < n_opts; i++) {
    free((char *)opts[i]);
  }
  free(opts);
  free(ptx);

  return NULL;
}

struct cuda_event {
  cudaEvent_t start;
  cudaEvent_t end;
};

static struct cuda_event* cuda_event_new(struct futhark_context* ctx) {
  if (ctx->profiling && !ctx->profiling_paused) {
    struct cuda_event* e = malloc(sizeof(struct cuda_event));
    cudaEventCreate(&e->start);
    cudaEventCreate(&e->end);
    return e;
  } else {
    return NULL;
  }
}

static int cuda_event_report(struct str_builder* sb, struct cuda_event* e) {
  float ms;
  CUresult err;
  if ((err = cuEventElapsedTime(&ms, e->start, e->end)) != CUDA_SUCCESS) {
    return err;
  }

  // CUDA provides milisecond resolution, but we want microseconds.
  str_builder(sb, ",\"duration\":%f", ms*1000);

  if ((err = cuEventDestroy(e->start)) != CUDA_SUCCESS) {
    return 1;
  }

  if ((err = cuEventDestroy(e->end)) != CUDA_SUCCESS) {
    return 1;
  }

  free(e);

  return 0;
}

int futhark_context_sync(struct futhark_context* ctx) {
  CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cu_ctx));
  CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
  if (ctx->failure_is_an_option) {
    // Check for any delayed error.
    int32_t failure_idx;
    CUDA_SUCCEED_OR_RETURN(
                           cuMemcpyDtoH(&failure_idx,
                                        ctx->global_failure,
                                        sizeof(int32_t)));
    ctx->failure_is_an_option = 0;

    if (failure_idx >= 0) {
      // We have to clear global_failure so that the next entry point
      // is not considered a failure from the start.
      int32_t no_failure = -1;
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyHtoD(ctx->global_failure,
                                          &no_failure,
                                          sizeof(int32_t)));

      int64_t args[max_failure_args+1];
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyDtoH(&args,
                                          ctx->global_failure_args,
                                          sizeof(args)));

      ctx->error = get_failure_msg(failure_idx, args);

      return FUTHARK_PROGRAM_ERROR;
    }
  }

  CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cu_ctx));
  return 0;
}

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);

int backend_context_setup(struct futhark_context* ctx) {
  ctx->failure_is_an_option = 0;
  ctx->total_runs = 0;
  ctx->total_runtime = 0;
  ctx->peak_mem_usage_device = 0;
  ctx->cur_mem_usage_device = 0;
  ctx->kernels = NULL;

  CUDA_SUCCEED_FATAL(cuInit(0));
  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->gpu_free_list);

  if (ctx->cfg->unified_memory == 2) {
    ctx->cfg->unified_memory = device_query(ctx->dev, MANAGED_MEMORY);
  }

  if (ctx->cfg->logging) {
    if (ctx->cfg->unified_memory) {
      fprintf(ctx->log, "Using managed memory\n");
    } else {
      fprintf(ctx->log, "Using unmanaged memory\n");
    }
  }

  ctx->max_thread_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_thread_block_size);
  ctx->max_threshold = 1U<<31; // No limit.
  ctx->max_bespoke = 1U<<31; // No limit.

  if (ctx->cfg->gpu.default_registers != 0) {
    ctx->max_registers = ctx->cfg->gpu.default_registers;
  } else {
    ctx->max_registers = device_query(ctx->dev, MAX_REGISTERS_PER_BLOCK);
  }

  if (ctx->cfg->gpu.default_shared_memory != 0) {
    ctx->max_shared_memory = ctx->cfg->gpu.default_shared_memory;
  } else {
    // MAX_SHARED_MEMORY_PER_BLOCK gives bogus numbers (48KiB); probably
    // for backwards compatibility.  Add _OPTIN and you seem to get the
    // right number.
    ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK_OPTIN);
#if CUDART_VERSION >= 12000
    ctx->max_shared_memory -= device_query(ctx->dev, RESERVED_SHARED_MEMORY_PER_BLOCK);
#endif
  }

  if (ctx->cfg->gpu.default_cache != 0) {
    ctx->max_cache = ctx->cfg->gpu.default_cache;
  } else {
    ctx->max_cache = device_query(ctx->dev, L2_CACHE_SIZE);
  }

  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);
  CUDA_SUCCEED_FATAL(cuStreamCreate(&ctx->stream, CU_STREAM_DEFAULT));
  cuda_size_setup(ctx);

  gpu_init_log(ctx);

  ctx->error = cuda_module_setup(ctx,
                                 ctx->cfg->program,
                                 (const char**)ctx->cfg->nvrtc_opts,
                                 ctx->cfg->cache_fname);

  if (ctx->error != NULL) {
    futhark_panic(1, "During CUDA initialisation:\n%s\n", ctx->error);
  }

  int32_t no_error = -1;
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
  CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error, sizeof(no_error)));
  // The +1 is to avoid zero-byte allocations.
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t)*(max_failure_args+1)));

  if ((ctx->kernels = init_builtin_kernels(ctx)) == NULL) {
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  if (ctx->kernels != NULL) {
    free_builtin_kernels(ctx, ctx->kernels);
    cuMemFree(ctx->global_failure);
    cuMemFree(ctx->global_failure_args);
    CUDA_SUCCEED_FATAL(gpu_free_all(ctx));
    CUDA_SUCCEED_FATAL(cuStreamDestroy(ctx->stream));
    CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
    CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
  }
  free_list_destroy(&ctx->gpu_free_list);
}

// GPU ABSTRACTION LAYER

// Types.

typedef CUfunction gpu_kernel;
typedef CUdeviceptr gpu_mem;

static void gpu_create_kernel(struct futhark_context *ctx,
                              gpu_kernel* kernel,
                              const char* name) {
  if (ctx->debugging) {
    fprintf(ctx->log, "Creating kernel %s.\n", name);
  }
  CUDA_SUCCEED_FATAL(cuModuleGetFunction(kernel, ctx->module, name));
  // Unless the below is set, the kernel is limited to 48KiB of memory.
  CUDA_SUCCEED_FATAL(cuFuncSetAttribute(*kernel,
                                        cudaFuncAttributeMaxDynamicSharedMemorySize,
                                        ctx->max_shared_memory));
}

static void gpu_free_kernel(struct futhark_context *ctx,
                            gpu_kernel kernel) {
  (void)ctx;
  (void)kernel;
}

static int gpu_scalar_to_device(struct futhark_context* ctx,
                                gpu_mem dst, size_t offset, size_t size,
                                void *src) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(dst + offset, src, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_scalar_from_device(struct futhark_context* ctx,
                                  void *dst,
                                  gpu_mem src, size_t offset, size_t size) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_from_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(dst, src + offset, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_memcpy(struct futhark_context* ctx,
                      gpu_mem dst, int64_t dst_offset,
                      gpu_mem src, int64_t src_offset,
                      int64_t nbytes) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_dev_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyAsync(dst+dst_offset, src+src_offset, nbytes, ctx->stream));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_host2gpu(struct futhark_context* ctx, bool sync,
                           gpu_mem dst, int64_t dst_offset,
                           const unsigned char* src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_host_to_dev",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoD(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoDAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_gpu2host(struct futhark_context* ctx, bool sync,
                           unsigned char* dst, int64_t dst_offset,
                           gpu_mem src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_dev_to_host",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoH(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoHAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
    if (sync &&
        ctx->failure_is_an_option &&
        futhark_context_sync(ctx) != 0) {
      return 1;
    }
  }
  return FUTHARK_SUCCESS;
}

static int gpu_launch_kernel(struct futhark_context* ctx,
                             gpu_kernel kernel, const char *name,
                             const int32_t grid[3],
                             const int32_t block[3],
                             unsigned int shared_mem_bytes,
                             int num_args,
                             void* args[num_args],
                             size_t args_sizes[num_args]) {
  (void) args_sizes;

  if (shared_mem_bytes > ctx->max_shared_memory) {
    set_error(ctx, msgprintf("Kernel %s with %d bytes of memory exceeds device limit of %d\n",
                             name, shared_mem_bytes, (int)ctx->max_shared_memory));
    return 1;
  }

  int64_t time_start = 0, time_end = 0;
  if (ctx->debugging) {
    time_start = get_wall_time();
  }

  struct cuda_event *event = cuda_event_new(ctx);

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    add_event(ctx,
              name,
              msgprintf("Kernel %s with\n"
                        "  grid=(%d,%d,%d)\n"
                        "  block=(%d,%d,%d)\n"
                        "  shared memory=%d",
                        name,
                        grid[0], grid[1], grid[2],
                        block[0], block[1], block[2],
                        shared_mem_bytes),
              event,
              (event_report_fn)cuda_event_report);
  }

  CUDA_SUCCEED_OR_RETURN
    (cuLaunchKernel(kernel,
                    grid[0], grid[1], grid[2],
                    block[0], block[1], block[2],
                    shared_mem_bytes, ctx->stream,
                    args, NULL));

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }

  if (ctx->debugging) {
    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
    time_end = get_wall_time();
    long int time_diff = time_end - time_start;
    fprintf(ctx->log, "  runtime: %ldus\n", time_diff);
  }
  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return FUTHARK_SUCCESS;
}

static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out) {
  CUresult res;
  if (ctx->cfg->unified_memory) {
    res = cuMemAllocManaged(mem_out, size, CU_MEM_ATTACH_GLOBAL);
  } else {
    res = cuMemAlloc(mem_out, size);
  }

  if (res == CUDA_ERROR_OUT_OF_MEMORY) {
    return FUTHARK_OUT_OF_MEMORY;
  }

  CUDA_SUCCEED_OR_RETURN(res);
  return FUTHARK_SUCCESS;
}

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem) {
  (void)ctx;
  CUDA_SUCCEED_OR_RETURN(cuMemFree(mem));
  return FUTHARK_SUCCESS;
}

// End of backends/cuda.h.

// Start of gpu.h

// Generic functions that use our tiny GPU abstraction layer.  The
// entire context must be defined before this header is included.  In
// particular we expect the following functions to be available:

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem);
static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out);
int gpu_launch_kernel(struct futhark_context* ctx,
                      gpu_kernel kernel, const char *name,
                      const int32_t grid[3],
                      const int32_t block[3],
                      unsigned int shared_mem_bytes,
                      int num_args,
                      void* args[num_args],
                      size_t args_sizes[num_args]);
int gpu_memcpy(struct futhark_context* ctx,
               gpu_mem dst, int64_t dst_offset,
               gpu_mem src, int64_t src_offset,
               int64_t nbytes);
int gpu_scalar_from_device(struct futhark_context* ctx,
                           void *dst,
                           gpu_mem src, size_t offset, size_t size);
int gpu_scalar_to_device(struct futhark_context* ctx,
                         gpu_mem dst, size_t offset, size_t size,
                         void *src);
void gpu_create_kernel(struct futhark_context *ctx,
                       gpu_kernel* kernel,
                       const char* name);

static void gpu_init_log(struct futhark_context *ctx) {
  if (ctx->cfg->logging) {
    fprintf(ctx->log, "Default block size: %ld\n", (long)ctx->cfg->gpu.default_block_size);
    fprintf(ctx->log, "Default grid size: %ld\n", (long)ctx->cfg->gpu.default_grid_size);
    fprintf(ctx->log, "Default tile size: %ld\n", (long)ctx->cfg->gpu.default_tile_size);
    fprintf(ctx->log, "Default register tile size: %ld\n", (long)ctx->cfg->gpu.default_reg_tile_size);
    fprintf(ctx->log, "Default cache: %ld\n", (long)ctx->cfg->gpu.default_cache);
    fprintf(ctx->log, "Default registers: %ld\n", (long)ctx->cfg->gpu.default_registers);
    fprintf(ctx->log, "Default threshold: %ld\n", (long)ctx->cfg->gpu.default_threshold);
    fprintf(ctx->log, "Max thread block size: %ld\n", (long)ctx->max_thread_block_size);
    fprintf(ctx->log, "Max grid size: %ld\n", (long)ctx->max_grid_size);
    fprintf(ctx->log, "Max tile size: %ld\n", (long)ctx->max_tile_size);
    fprintf(ctx->log, "Max threshold: %ld\n", (long)ctx->max_threshold);
    fprintf(ctx->log, "Max shared memory: %ld\n", (long)ctx->max_shared_memory);
    fprintf(ctx->log, "Max registers: %ld\n", (long)ctx->max_registers);
    fprintf(ctx->log, "Max cache: %ld\n", (long)ctx->max_cache);
    fprintf(ctx->log, "Lockstep width: %ld\n", (long)ctx->lockstep_width);
  }
}

// Generic GPU command line options.

void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_block_size = size;
  cfg->gpu.default_block_size_changed = 1;
}

void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size) {
  futhark_context_config_set_default_thread_block_size(cfg, size);
}

void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int num) {
  cfg->gpu.default_grid_size = num;
  cfg->gpu.default_grid_size_changed = 1;
}

void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int num) {
  futhark_context_config_set_default_grid_size(cfg, num);
}

void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_tile_size = size;
  cfg->gpu.default_tile_size_changed = 1;
}

void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_reg_tile_size = size;
}

void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_cache = size;
}

void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_registers = size;
}

void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_threshold = size;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t new_value) {
  for (int i = 0; i < cfg->num_tuning_params; i++) {
    if (strcmp(param_name, cfg->tuning_param_names[i]) == 0) {
      cfg->tuning_params[i] = new_value;
      return 0;
    }
  }
  if (strcmp(param_name, "default_thread_block_size") == 0 ||
      strcmp(param_name, "default_group_size") == 0) {
    cfg->gpu.default_block_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_grid_size") == 0 ||
      strcmp(param_name, "default_num_groups") == 0) {
    cfg->gpu.default_grid_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_threshold") == 0) {
    cfg->gpu.default_threshold = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_tile_size") == 0) {
    cfg->gpu.default_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_reg_tile_size") == 0) {
    cfg->gpu.default_reg_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_cache") == 0) {
    cfg->gpu.default_cache = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_shared_memory") == 0) {
    cfg->gpu.default_shared_memory = new_value;
    return 0;
  }

  return 1;
}

// End of GPU command line optiopns.

// Max number of thead blocks we allow along the second or third
// dimension for transpositions.
#define MAX_TR_THREAD_BLOCKS 65535

struct builtin_kernels {
  // We have a lot of ways to transpose arrays.
  gpu_kernel map_transpose_1b;
  gpu_kernel map_transpose_1b_low_height;
  gpu_kernel map_transpose_1b_low_width;
  gpu_kernel map_transpose_1b_small;
  gpu_kernel map_transpose_1b_large;
  gpu_kernel map_transpose_2b;
  gpu_kernel map_transpose_2b_low_height;
  gpu_kernel map_transpose_2b_low_width;
  gpu_kernel map_transpose_2b_small;
  gpu_kernel map_transpose_2b_large;
  gpu_kernel map_transpose_4b;
  gpu_kernel map_transpose_4b_low_height;
  gpu_kernel map_transpose_4b_low_width;
  gpu_kernel map_transpose_4b_small;
  gpu_kernel map_transpose_4b_large;
  gpu_kernel map_transpose_8b;
  gpu_kernel map_transpose_8b_low_height;
  gpu_kernel map_transpose_8b_low_width;
  gpu_kernel map_transpose_8b_small;
  gpu_kernel map_transpose_8b_large;

  // And a few ways of copying.
  gpu_kernel lmad_copy_1b;
  gpu_kernel lmad_copy_2b;
  gpu_kernel lmad_copy_4b;
  gpu_kernel lmad_copy_8b;
};

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx) {
  struct builtin_kernels *kernels = malloc(sizeof(struct builtin_kernels));
  gpu_create_kernel(ctx, &kernels->map_transpose_1b, "map_transpose_1b");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_large, "map_transpose_1b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_height, "map_transpose_1b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_width, "map_transpose_1b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_small, "map_transpose_1b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_2b, "map_transpose_2b");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_large, "map_transpose_2b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_height, "map_transpose_2b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_width, "map_transpose_2b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_small, "map_transpose_2b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_4b, "map_transpose_4b");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_large, "map_transpose_4b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_height, "map_transpose_4b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_width, "map_transpose_4b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_small, "map_transpose_4b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_8b, "map_transpose_8b");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_large, "map_transpose_8b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_height, "map_transpose_8b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_width, "map_transpose_8b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_small, "map_transpose_8b_small");

  gpu_create_kernel(ctx, &kernels->lmad_copy_1b, "lmad_copy_1b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_2b, "lmad_copy_2b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_4b, "lmad_copy_4b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_8b, "lmad_copy_8b");

  return kernels;
}

void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels) {
  gpu_free_kernel(ctx, kernels->map_transpose_1b);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_2b);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_4b);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_8b);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_small);

  gpu_free_kernel(ctx, kernels->lmad_copy_1b);
  gpu_free_kernel(ctx, kernels->lmad_copy_2b);
  gpu_free_kernel(ctx, kernels->lmad_copy_4b);
  gpu_free_kernel(ctx, kernels->lmad_copy_8b);

  free(kernels);
}

static int gpu_alloc(struct futhark_context *ctx, FILE *log,
                     size_t min_size, const char *tag,
                     gpu_mem *mem_out, size_t *size_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  gpu_mem* memptr;
  if (free_list_find(&ctx->gpu_free_list, min_size, tag, size_out, (fl_mem*)&memptr) == 0) {
    // Successfully found a free block.  Is it big enough?
    if (*size_out >= min_size) {
      if (ctx->cfg->debugging) {
        fprintf(log, "No need to allocate: Found a block in the free list.\n");
      }
      *mem_out = *memptr;
      free(memptr);
      return FUTHARK_SUCCESS;
    } else {
      if (ctx->cfg->debugging) {
        fprintf(log, "Found a free block, but it was too small.\n");
      }
      int error = gpu_free_actual(ctx, *memptr);
      free(memptr);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    }
  }

  *size_out = min_size;

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg->debugging) {
    fprintf(log, "Actually allocating the desired block.\n");
  }

  int error = gpu_alloc_actual(ctx, min_size, mem_out);

  while (error == FUTHARK_OUT_OF_MEMORY) {
    if (ctx->cfg->debugging) {
      fprintf(log, "Out of GPU memory: releasing entry from the free list...\n");
    }
    gpu_mem* memptr;
    if (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
      gpu_mem mem = *memptr;
      free(memptr);
      error = gpu_free_actual(ctx, mem);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = gpu_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int gpu_free(struct futhark_context *ctx,
                    gpu_mem mem, size_t size, const char *tag) {
  gpu_mem* memptr = malloc(sizeof(gpu_mem));
  *memptr = mem;
  free_list_insert(&ctx->gpu_free_list, size, (fl_mem)memptr, tag);
  return FUTHARK_SUCCESS;
}

static int gpu_free_all(struct futhark_context *ctx) {
  free_list_pack(&ctx->gpu_free_list);
  gpu_mem* memptr;
  while (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
    gpu_mem mem = *memptr;
    free(memptr);
    int error = gpu_free_actual(ctx, mem);
    if (error != FUTHARK_SUCCESS) {
      return error;
    }
  }

  return FUTHARK_SUCCESS;
}

static int gpu_map_transpose(struct futhark_context* ctx,
                             gpu_kernel kernel_default,
                             gpu_kernel kernel_low_height,
                             gpu_kernel kernel_low_width,
                             gpu_kernel kernel_small,
                             gpu_kernel kernel_large,
                             const char *name, size_t elem_size,
                             gpu_mem dst, int64_t dst_offset,
                             gpu_mem src, int64_t src_offset,
                             int64_t k, int64_t n, int64_t m) {
  int64_t mulx = TR_BLOCK_DIM / n;
  int64_t muly = TR_BLOCK_DIM / m;
  int32_t mulx32 = mulx;
  int32_t muly32 = muly;
  int32_t k32 = k;
  int32_t n32 = n;
  int32_t m32 = m;

  gpu_kernel kernel = kernel_default;
  int32_t grid[3];
  int32_t block[3];

  void* args[11];
  size_t args_sizes[11] = {
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t)
  };

  args[0] = &dst;
  args[1] = &dst_offset;
  args[2] = &src;
  args[3] = &src_offset;
  args[7] = &mulx;
  args[8] = &muly;

  if (dst_offset + k * n * m <= 2147483647L &&
      src_offset + k * n * m <= 2147483647L) {
    if (m <= TR_BLOCK_DIM/2 && n <= TR_BLOCK_DIM/2) {
      if (ctx->logging) { fprintf(ctx->log, "Using small kernel\n"); }
      kernel = kernel_small;
      grid[0] = ((k * n * m) + (TR_BLOCK_DIM*TR_BLOCK_DIM) - 1) / (TR_BLOCK_DIM*TR_BLOCK_DIM);
      grid[1] = 1;
      grid[2] = 1;
      block[0] = TR_BLOCK_DIM*TR_BLOCK_DIM;
      block[1] = 1;
      block[2] = 1;
    } else if (m <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < n) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-width kernel\n"); }
      kernel = kernel_low_width;
      int64_t x_elems = m;
      int64_t y_elems = (n + muly - 1) / muly;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else if (n <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < m) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-height kernel\n"); }
      kernel = kernel_low_height;
      int64_t x_elems = (m + mulx - 1) / mulx;
      int64_t y_elems = n;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else {
      if (ctx->logging) { fprintf(ctx->log, "Using default kernel\n"); }
      kernel = kernel_default;
      grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[2] = k;
      block[0] = TR_TILE_DIM;
      block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
      block[2] = 1;
    }
    args[4] = &k32;
    args[5] = &m32;
    args[6] = &n32;
    args[7] = &mulx32;
    args[8] = &muly32;
  } else {
    if (ctx->logging) { fprintf(ctx->log, "Using large kernel\n"); }
    kernel = kernel_large;
    grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[2] = k;
    block[0] = TR_TILE_DIM;
    block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
    block[2] = 1;
    args[4] = &k;
    args[5] = &m;
    args[6] = &n;
    args[7] = &mulx;
    args[8] = &muly;
    args_sizes[4] = sizeof(int64_t);
    args_sizes[5] = sizeof(int64_t);
    args_sizes[6] = sizeof(int64_t);
    args_sizes[7] = sizeof(int64_t);
    args_sizes[8] = sizeof(int64_t);
  }

  // Cap the number of thead blocks we launch and figure out how many
  // repeats we need alongside each dimension.
  int32_t repeat_1 = grid[1] / MAX_TR_THREAD_BLOCKS;
  int32_t repeat_2 = grid[2] / MAX_TR_THREAD_BLOCKS;
  grid[1] = repeat_1 > 0 ? MAX_TR_THREAD_BLOCKS : grid[1];
  grid[2] = repeat_2 > 0 ? MAX_TR_THREAD_BLOCKS : grid[2];
  args[9] = &repeat_1;
  args[10] = &repeat_2;
  args_sizes[9] = sizeof(repeat_1);
  args_sizes[10] = sizeof(repeat_2);

  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return gpu_launch_kernel(ctx, kernel, name, grid, block,
                           TR_TILE_DIM*(TR_TILE_DIM+1)*elem_size,
                           sizeof(args)/sizeof(args[0]), args, args_sizes);
}

#define GEN_MAP_TRANSPOSE_GPU2GPU(NAME, ELEM_TYPE)                      \
  static int map_transpose_gpu2gpu_##NAME                               \
  (struct futhark_context* ctx,                                         \
   gpu_mem dst, int64_t dst_offset,                                     \
   gpu_mem src, int64_t src_offset,                                     \
   int64_t k, int64_t m, int64_t n)                                     \
  {                                                                     \
    return                                                              \
      gpu_map_transpose                                                 \
      (ctx,                                                             \
       ctx->kernels->map_transpose_##NAME,                              \
       ctx->kernels->map_transpose_##NAME##_low_height,                 \
       ctx->kernels->map_transpose_##NAME##_low_width,                  \
       ctx->kernels->map_transpose_##NAME##_small,                      \
       ctx->kernels->map_transpose_##NAME##_large,                      \
       "map_transpose_" #NAME, sizeof(ELEM_TYPE),                       \
       dst, dst_offset, src, src_offset,                                \
       k, n, m);                                                        \
  }

static int gpu_lmad_copy(struct futhark_context* ctx,
                         gpu_kernel kernel, int r,
                         gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                         gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                         int64_t shape[r]) {
  if (r > 8) {
    set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy array of greater than rank 8.\n"));
    return 1;
  }

  int64_t n = 1;
  for (int i = 0; i < r; i++) { n *= shape[i]; }

  void* args[6+(8*3)];
  size_t args_sizes[6+(8*3)];

  args[0] = &dst;
  args_sizes[0] = sizeof(gpu_mem);
  args[1] = &dst_offset;
  args_sizes[1] = sizeof(dst_offset);
  args[2] = &src;
  args_sizes[2] = sizeof(gpu_mem);
  args[3] = &src_offset;
  args_sizes[3] = sizeof(src_offset);
  args[4] = &n;
  args_sizes[4] = sizeof(n);
  args[5] = &r;
  args_sizes[5] = sizeof(r);

  int64_t zero = 0;

  for (int i = 0; i < 8; i++) {
    args_sizes[6+i*3] = sizeof(int64_t);
    args_sizes[6+i*3+1] = sizeof(int64_t);
    args_sizes[6+i*3+2] = sizeof(int64_t);
    if (i < r) {
      args[6+i*3] = &shape[i];
      args[6+i*3+1] = &dst_strides[i];
      args[6+i*3+2] = &src_strides[i];
    } else {
      args[6+i*3] = &zero;
      args[6+i*3+1] = &zero;
      args[6+i*3+2] = &zero;
    }
  }
  const size_t w = 256; // XXX: hardcoded thread block size.

  return gpu_launch_kernel(ctx, kernel, "copy_lmad_dev_to_dev",
                           (const int32_t[3]) {(n+w-1)/w,1,1},
                           (const int32_t[3]) {w,1,1},
                           0, 6+(8*3), args, args_sizes);
}

#define GEN_LMAD_COPY_ELEMENTS_GPU2GPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return gpu_lmad_copy(ctx, ctx->kernels->lmad_copy_##NAME, r,        \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \

#define GEN_LMAD_COPY_GPU2GPU(NAME, ELEM_TYPE)                          \
  static int lmad_copy_gpu2gpu_##NAME                                   \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "GPU to GPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return FUTHARK_SUCCESS; }                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                       r, dst_strides, src_strides, shape)) {           \
      log_transpose(ctx, k, n, m);                                      \
      return map_transpose_gpu2gpu_##NAME                               \
        (ctx, dst, dst_offset, src, src_offset, k, n, m);               \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}        \
      return gpu_memcpy(ctx,                                            \
                        dst, dst_offset*sizeof(ELEM_TYPE),              \
                        src, src_offset*sizeof(ELEM_TYPE),              \
                        size * sizeof(ELEM_TYPE));                      \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}     \
      return lmad_copy_elements_gpu2gpu_##NAME                          \
        (ctx, r,                                                        \
         dst, dst_offset, dst_strides,                                  \
         src, src_offset, src_strides,                                  \
         shape);                                                        \
    }                                                                   \
  }

static int
lmad_copy_elements_host2gpu(struct futhark_context *ctx, size_t elem_size,
                            int r,
                            gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                            unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                            int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from host to GPU.\n"));
  return 1;
}

static int
lmad_copy_elements_gpu2host (struct futhark_context *ctx, size_t elem_size,
                             int r,
                             unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                             gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                             int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from GPU to host.\n"));
  return 1;
}

#define GEN_LMAD_COPY_ELEMENTS_HOSTGPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return (ctx, ctx->kernels->lmad_copy_##NAME, r,                     \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \


static int lmad_copy_host2gpu(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                              unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_host2gpu(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_host2gpu
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

static int lmad_copy_gpu2host(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                              gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_gpu2host(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_gpu2host
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

GEN_MAP_TRANSPOSE_GPU2GPU(1b, uint8_t)
GEN_MAP_TRANSPOSE_GPU2GPU(2b, uint16_t)
GEN_MAP_TRANSPOSE_GPU2GPU(4b, uint32_t)
GEN_MAP_TRANSPOSE_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_GPU2GPU(8b, uint64_t)

// End of gpu.h

static int gpu_macros(struct futhark_context *ctx, char ***names_out, int64_t **values_out)
{
    int num_macros = 293;
    char **names = malloc(num_macros * sizeof(char *));
    int64_t *values = malloc(num_macros * sizeof(int64_t));
    
    {
        names[0] = "get_num_neighbours_against_11935zisegred_large_74884_dim1";
        values[0] = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    }
    {
        names[1] = "get_num_neighbours_against_11935zisegred_large_74884zisegred_tblock_sizze_74878";
        values[1] = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    }
    {
        names[2] = "get_num_neighbours_against_11935zisegred_large_74884zichunk_sizze_83166";
        values[2] = (int64_t) 1;
    }
    {
        names[3] = "get_num_neighbours_against_11935zisegred_small_74884_dim1";
        values[3] = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    }
    {
        names[4] = "get_num_neighbours_against_11935zisegred_small_74884zisegred_tblock_sizze_74878";
        values[4] = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    }
    {
        names[5] = "get_num_neighbours_against_11935zisegmap_74866_dim1";
        values[5] = *ctx->tuning_params.get_num_neighbours_against_11935zisegmap_tblock_sizze_74845;
    }
    {
        names[6] = "get_num_neighbours_against_11935zisegmap_74866zisegmap_tblock_sizze_74860";
        values[6] = *ctx->tuning_params.get_num_neighbours_against_11935zisegmap_tblock_sizze_74845;
    }
    {
        names[7] = "get_num_neighbours_against_11935zisegmap_intrablock_78070_dim1";
        values[7] = *ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071;
    }
    {
        names[8] = "get_num_neighbours_against_11935zisegmap_intrablock_78070zitile_sizze_78072";
        values[8] = *ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071;
    }
    {
        names[9] = "get_num_neighbours_against_11935zisegmap_intrablock_78070zibytes_81972";
        values[9] = (int64_t) 8 * *ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071;
    }
    {
        names[10] = "get_num_neighbours_against_11932zisegred_large_74618_dim1";
        values[10] = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    }
    {
        names[11] = "get_num_neighbours_against_11932zisegred_large_74618zisegred_tblock_sizze_74612";
        values[11] = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    }
    {
        names[12] = "get_num_neighbours_against_11932zisegred_large_74618zichunk_sizze_83166";
        values[12] = (int64_t) 1;
    }
    {
        names[13] = "get_num_neighbours_against_11932zisegred_small_74618_dim1";
        values[13] = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    }
    {
        names[14] = "get_num_neighbours_against_11932zisegred_small_74618zisegred_tblock_sizze_74612";
        values[14] = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    }
    {
        names[15] = "get_num_neighbours_against_11932zisegmap_74600_dim1";
        values[15] = *ctx->tuning_params.get_num_neighbours_against_11932zisegmap_tblock_sizze_74579;
    }
    {
        names[16] = "get_num_neighbours_against_11932zisegmap_74600zisegmap_tblock_sizze_74594";
        values[16] = *ctx->tuning_params.get_num_neighbours_against_11932zisegmap_tblock_sizze_74579;
    }
    {
        names[17] = "get_num_neighbours_against_11932zisegmap_intrablock_78070_dim1";
        values[17] = *ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071;
    }
    {
        names[18] = "get_num_neighbours_against_11932zisegmap_intrablock_78070zitile_sizze_78072";
        values[18] = *ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071;
    }
    {
        names[19] = "get_num_neighbours_against_11932zisegmap_intrablock_78070zibytes_81972";
        values[19] = (int64_t) 8 * *ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071;
    }
    {
        names[20] = "rectify_cluster_ids_doublezisegmap_75061_dim1";
        values[20] = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_75038;
    }
    {
        names[21] = "rectify_cluster_ids_doublezisegmap_75061zisegmap_tblock_sizze_75057";
        values[21] = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_75038;
    }
    {
        names[22] = "rectify_cluster_ids_doublezisegmap_74989_dim1";
        values[22] = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_74934;
    }
    {
        names[23] = "rectify_cluster_ids_doublezisegmap_74989zisegmap_tblock_sizze_74985";
        values[23] = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_74934;
    }
    {
        names[24] = "next_partition_to_read_doublezigpuseq_83333_dim1";
        values[24] = (int64_t) 1;
    }
    {
        names[25] = "next_partition_to_read_doublezisegmap_66881_dim1";
        values[25] = *ctx->tuning_params.next_partition_to_read_doublezisegmap_tblock_sizze_66883;
    }
    {
        names[26] = "next_partition_to_read_doublezisegmap_66881zisegmap_tblock_sizze_66884";
        values[26] = *ctx->tuning_params.next_partition_to_read_doublezisegmap_tblock_sizze_66883;
    }
    {
        names[27] = "next_partition_to_read_doublezisegscan_66879_dim1";
        values[27] = *ctx->tuning_params.next_partition_to_read_doublezisegscan_tblock_sizze_66873;
    }
    {
        names[28] = "next_partition_to_read_doublezisegscan_66879zisegscan_tblock_sizze_66874";
        values[28] = *ctx->tuning_params.next_partition_to_read_doublezisegscan_tblock_sizze_66873;
    }
    {
        names[29] = "next_partition_to_read_doublezisegscan_66879zichunk_sizze_83184";
        values[29] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[30] = "next_partition_to_read_doublezisegred_nonseg_66871_dim1";
        values[30] = *ctx->tuning_params.next_partition_to_read_doublezisegred_tblock_sizze_66863;
    }
    {
        names[31] = "next_partition_to_read_doublezisegred_nonseg_66871zisegred_tblock_sizze_66864";
        values[31] = *ctx->tuning_params.next_partition_to_read_doublezisegred_tblock_sizze_66863;
    }
    {
        names[32] = "next_partition_to_read_doublezisegred_nonseg_66871zichunk_sizze_83126";
        values[32] = (int64_t) 1;
    }
    {
        names[33] = "next_partition_to_read_doublezigpuseq_83120_dim1";
        values[33] = (int64_t) 1;
    }
    {
        names[34] = "mk_dbcHandler_doublezigpuseq_83216_dim1";
        values[34] = (int64_t) 1;
    }
    {
        names[35] = "make_collisions_compact_doublezisegmap_74392_dim1";
        values[35] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_74394;
    }
    {
        names[36] = "make_collisions_compact_doublezisegmap_74392zisegmap_tblock_sizze_74395";
        values[36] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_74394;
    }
    {
        names[37] = "make_collisions_compact_doublezisegscan_74390_dim1";
        values[37] = *ctx->tuning_params.make_collisions_compact_doublezisegscan_tblock_sizze_74384;
    }
    {
        names[38] = "make_collisions_compact_doublezisegscan_74390zisegscan_tblock_sizze_74385";
        values[38] = *ctx->tuning_params.make_collisions_compact_doublezisegscan_tblock_sizze_74384;
    }
    {
        names[39] = "make_collisions_compact_doublezisegscan_74390zichunk_sizze_83593";
        values[39] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[40] = "make_collisions_compact_doublezisegmap_74293_dim1";
        values[40] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72856;
    }
    {
        names[41] = "make_collisions_compact_doublezisegmap_74293zisegmap_tblock_sizze_74286";
        values[41] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72856;
    }
    {
        names[42] = "make_collisions_compact_doublezisegmap_74218_dim1";
        values[42] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72938;
    }
    {
        names[43] = "make_collisions_compact_doublezisegmap_74218zisegmap_tblock_sizze_74206";
        values[43] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72938;
    }
    {
        names[44] = "make_collisions_compact_doublezisegmap_74095_dim1";
        values[44] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73167;
    }
    {
        names[45] = "make_collisions_compact_doublezisegmap_74095zisegmap_tblock_sizze_74089";
        values[45] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73167;
    }
    {
        names[46] = "make_collisions_compact_doublezisegmap_73770_dim1";
        values[46] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72132;
    }
    {
        names[47] = "make_collisions_compact_doublezisegmap_73770zisegmap_tblock_sizze_73764";
        values[47] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72132;
    }
    {
        names[48] = "make_collisions_compact_doublezisegmap_73746_dim1";
        values[48] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72201;
    }
    {
        names[49] = "make_collisions_compact_doublezisegmap_73746zisegmap_tblock_sizze_73741";
        values[49] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72201;
    }
    {
        names[50] = "make_collisions_compact_doublezisegmap_73717_dim1";
        values[50] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73685;
    }
    {
        names[51] = "make_collisions_compact_doublezisegmap_73717zisegmap_tblock_sizze_73711";
        values[51] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73685;
    }
    {
        names[52] = "make_collisions_compact_doublezisegmap_71214_dim1";
        values[52] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_70979;
    }
    {
        names[53] = "make_collisions_compact_doublezisegmap_71214zisegmap_tblock_sizze_71208";
        values[53] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_70979;
    }
    {
        names[54] = "make_collisions_compact_doublezisegmap_71189_dim1";
        values[54] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_71122;
    }
    {
        names[55] = "make_collisions_compact_doublezisegmap_71189zisegmap_tblock_sizze_71183";
        values[55] = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_71122;
    }
    {
        names[56] = "make_collisions_compact_doublezigpuseq_83217_dim1";
        values[56] = (int64_t) 1;
    }
    {
        names[57] = "make_collisions_compact_doublezisegred_nonseg_70910_dim1";
        values[57] = *ctx->tuning_params.make_collisions_compact_doublezisegred_tblock_sizze_70901;
    }
    {
        names[58] = "make_collisions_compact_doublezisegred_nonseg_70910zisegred_tblock_sizze_70902";
        values[58] = *ctx->tuning_params.make_collisions_compact_doublezisegred_tblock_sizze_70901;
    }
    {
        names[59] = "make_collisions_compact_doublezisegred_nonseg_70910zichunk_sizze_83130";
        values[59] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[60] = "do_DBSCAN_doublezigpuseq_86817_dim1";
        values[60] = (int64_t) 1;
    }
    {
        names[61] = "do_DBSCAN_doublezisegred_nonseg_77751_dim1";
        values[61] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77743;
    }
    {
        names[62] = "do_DBSCAN_doublezisegred_nonseg_77751zisegred_tblock_sizze_77744";
        values[62] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77743;
    }
    {
        names[63] = "do_DBSCAN_doublezisegred_nonseg_77751zichunk_sizze_86781";
        values[63] = (int64_t) 1;
    }
    {
        names[64] = "do_DBSCAN_doublezisegred_nonseg_77741_dim1";
        values[64] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77733;
    }
    {
        names[65] = "do_DBSCAN_doublezisegred_nonseg_77741zisegred_tblock_sizze_77734";
        values[65] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77733;
    }
    {
        names[66] = "do_DBSCAN_doublezisegred_nonseg_77741zichunk_sizze_86746";
        values[66] = (int64_t) 1;
    }
    {
        names[67] = "do_DBSCAN_doublezisegmap_77725_dim1";
        values[67] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77727;
    }
    {
        names[68] = "do_DBSCAN_doublezisegmap_77725zisegmap_tblock_sizze_77728";
        values[68] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77727;
    }
    {
        names[69] = "do_DBSCAN_doublezisegmap_77717_dim1";
        values[69] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77719;
    }
    {
        names[70] = "do_DBSCAN_doublezisegmap_77717zisegmap_tblock_sizze_77720";
        values[70] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77719;
    }
    {
        names[71] = "do_DBSCAN_doublezisegred_large_77661_dim1";
        values[71] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555;
    }
    {
        names[72] = "do_DBSCAN_doublezisegred_large_77661zisegred_tblock_sizze_77654";
        values[72] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555;
    }
    {
        names[73] = "do_DBSCAN_doublezisegred_large_77661zichunk_sizze_86619";
        values[73] = (int64_t) 1;
    }
    {
        names[74] = "do_DBSCAN_doublezisegred_small_77661_dim1";
        values[74] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555;
    }
    {
        names[75] = "do_DBSCAN_doublezisegred_small_77661zisegred_tblock_sizze_77654";
        values[75] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555;
    }
    {
        names[76] = "do_DBSCAN_doublezisegmap_77642_dim1";
        values[76] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77621;
    }
    {
        names[77] = "do_DBSCAN_doublezisegmap_77642zisegmap_tblock_sizze_77636";
        values[77] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77621;
    }
    {
        names[78] = "do_DBSCAN_doublezisegmap_intrablock_80971_dim1";
        values[78] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972;
    }
    {
        names[79] = "do_DBSCAN_doublezisegmap_intrablock_80971zitile_sizze_80973";
        values[79] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972;
    }
    {
        names[80] = "do_DBSCAN_doublezisegmap_intrablock_80971zibytes_82863";
        values[80] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972;
    }
    {
        names[81] = "do_DBSCAN_doublezisegred_large_77359_dim1";
        values[81] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253;
    }
    {
        names[82] = "do_DBSCAN_doublezisegred_large_77359zisegred_tblock_sizze_77352";
        values[82] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253;
    }
    {
        names[83] = "do_DBSCAN_doublezisegred_large_77359zichunk_sizze_86488";
        values[83] = (int64_t) 1;
    }
    {
        names[84] = "do_DBSCAN_doublezisegred_small_77359_dim1";
        values[84] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253;
    }
    {
        names[85] = "do_DBSCAN_doublezisegred_small_77359zisegred_tblock_sizze_77352";
        values[85] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253;
    }
    {
        names[86] = "do_DBSCAN_doublezisegmap_77340_dim1";
        values[86] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77319;
    }
    {
        names[87] = "do_DBSCAN_doublezisegmap_77340zisegmap_tblock_sizze_77334";
        values[87] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77319;
    }
    {
        names[88] = "do_DBSCAN_doublezisegmap_intrablock_80530_dim1";
        values[88] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531;
    }
    {
        names[89] = "do_DBSCAN_doublezisegmap_intrablock_80530zitile_sizze_80532";
        values[89] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531;
    }
    {
        names[90] = "do_DBSCAN_doublezisegmap_intrablock_80530zibytes_82784";
        values[90] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531;
    }
    {
        names[91] = "do_DBSCAN_doublezisegmap_77105_dim1";
        values[91] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77107;
    }
    {
        names[92] = "do_DBSCAN_doublezisegmap_77105zisegmap_tblock_sizze_77108";
        values[92] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77107;
    }
    {
        names[93] = "do_DBSCAN_doublezisegmap_77089_dim1";
        values[93] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77091;
    }
    {
        names[94] = "do_DBSCAN_doublezisegmap_77089zisegmap_tblock_sizze_77092";
        values[94] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77091;
    }
    {
        names[95] = "do_DBSCAN_doublezisegscan_77103_dim1";
        values[95] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_77097;
    }
    {
        names[96] = "do_DBSCAN_doublezisegscan_77103zisegscan_tblock_sizze_77098";
        values[96] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_77097;
    }
    {
        names[97] = "do_DBSCAN_doublezisegscan_77103zichunk_sizze_86326";
        values[97] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[98] = "do_DBSCAN_doublezisegscan_77081_dim1";
        values[98] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76957;
    }
    {
        names[99] = "do_DBSCAN_doublezisegscan_77081zisegscan_tblock_sizze_77076";
        values[99] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76957;
    }
    {
        names[100] = "do_DBSCAN_doublezisegscan_77081zichunk_sizze_86223";
        values[100] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[101] = "do_DBSCAN_doublezisegmap_intrablock_80148_dim1";
        values[101] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149;
    }
    {
        names[102] = "do_DBSCAN_doublezisegmap_intrablock_80148zitile_sizze_80150";
        values[102] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149;
    }
    {
        names[103] = "do_DBSCAN_doublezisegmap_intrablock_80148zibytes_82571";
        values[103] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149;
    }
    {
        names[104] = "do_DBSCAN_doublezisegmap_intrablock_79766_dim1";
        values[104] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767;
    }
    {
        names[105] = "do_DBSCAN_doublezisegmap_intrablock_79766zitile_sizze_79768";
        values[105] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767;
    }
    {
        names[106] = "do_DBSCAN_doublezisegmap_intrablock_79766zibytes_82643";
        values[106] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767;
    }
    {
        names[107] = "do_DBSCAN_doublezisegmap_76637_dim1";
        values[107] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76639;
    }
    {
        names[108] = "do_DBSCAN_doublezisegmap_76637zisegmap_tblock_sizze_76640";
        values[108] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76639;
    }
    {
        names[109] = "do_DBSCAN_doublezisegscan_76628_dim1";
        values[109] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76540;
    }
    {
        names[110] = "do_DBSCAN_doublezisegscan_76628zisegscan_tblock_sizze_76623";
        values[110] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76540;
    }
    {
        names[111] = "do_DBSCAN_doublezisegscan_76628zichunk_sizze_85949";
        values[111] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[112] = "do_DBSCAN_doublezisegmap_intrablock_79483_dim1";
        values[112] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484;
    }
    {
        names[113] = "do_DBSCAN_doublezisegmap_intrablock_79483zitile_sizze_79485";
        values[113] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484;
    }
    {
        names[114] = "do_DBSCAN_doublezisegmap_intrablock_79483zibytes_82440";
        values[114] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484;
    }
    {
        names[115] = "do_DBSCAN_doublezisegmap_intrablock_79200_dim1";
        values[115] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201;
    }
    {
        names[116] = "do_DBSCAN_doublezisegmap_intrablock_79200zitile_sizze_79202";
        values[116] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201;
    }
    {
        names[117] = "do_DBSCAN_doublezisegmap_intrablock_79200zibytes_82490";
        values[117] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201;
    }
    {
        names[118] = "do_DBSCAN_doublezisegmap_76323_dim1";
        values[118] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76325;
    }
    {
        names[119] = "do_DBSCAN_doublezisegmap_76323zisegmap_tblock_sizze_76326";
        values[119] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76325;
    }
    {
        names[120] = "do_DBSCAN_doublezisegscan_76315_dim1";
        values[120] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76209;
    }
    {
        names[121] = "do_DBSCAN_doublezisegscan_76315zisegscan_tblock_sizze_76310";
        values[121] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76209;
    }
    {
        names[122] = "do_DBSCAN_doublezisegscan_76315zichunk_sizze_85682";
        values[122] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[123] = "do_DBSCAN_doublezisegmap_intrablock_78845_dim1";
        values[123] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846;
    }
    {
        names[124] = "do_DBSCAN_doublezisegmap_intrablock_78845zitile_sizze_78847";
        values[124] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846;
    }
    {
        names[125] = "do_DBSCAN_doublezisegmap_intrablock_78845zibytes_82307";
        values[125] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846;
    }
    {
        names[126] = "do_DBSCAN_doublezisegmap_intrablock_78490_dim1";
        values[126] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491;
    }
    {
        names[127] = "do_DBSCAN_doublezisegmap_intrablock_78490zitile_sizze_78492";
        values[127] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491;
    }
    {
        names[128] = "do_DBSCAN_doublezisegmap_intrablock_78490zibytes_82369";
        values[128] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491;
    }
    {
        names[129] = "do_DBSCAN_doublezisegmap_75910_dim1";
        values[129] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75912;
    }
    {
        names[130] = "do_DBSCAN_doublezisegmap_75910zisegmap_tblock_sizze_75913";
        values[130] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75912;
    }
    {
        names[131] = "do_DBSCAN_doublezisegscan_75908_dim1";
        values[131] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75902;
    }
    {
        names[132] = "do_DBSCAN_doublezisegscan_75908zisegscan_tblock_sizze_75903";
        values[132] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75902;
    }
    {
        names[133] = "do_DBSCAN_doublezisegscan_75908zichunk_sizze_85408";
        values[133] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[134] = "do_DBSCAN_doublezisegmap_75887_dim1";
        values[134] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75864;
    }
    {
        names[135] = "do_DBSCAN_doublezisegmap_75887zisegmap_tblock_sizze_75883";
        values[135] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75864;
    }
    {
        names[136] = "do_DBSCAN_doublezisegmap_75854_dim1";
        values[136] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75838;
    }
    {
        names[137] = "do_DBSCAN_doublezisegmap_75854zisegmap_tblock_sizze_75850";
        values[137] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75838;
    }
    {
        names[138] = "do_DBSCAN_doublezisegscan_75834_dim1";
        values[138] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75828;
    }
    {
        names[139] = "do_DBSCAN_doublezisegscan_75834zisegscan_tblock_sizze_75829";
        values[139] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75828;
    }
    {
        names[140] = "do_DBSCAN_doublezisegscan_75834zichunk_sizze_85287";
        values[140] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[141] = "do_DBSCAN_doublezisegred_nonseg_75826_dim1";
        values[141] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75818;
    }
    {
        names[142] = "do_DBSCAN_doublezisegred_nonseg_75826zisegred_tblock_sizze_75819";
        values[142] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75818;
    }
    {
        names[143] = "do_DBSCAN_doublezisegred_nonseg_75826zichunk_sizze_85248";
        values[143] = (int64_t) 1;
    }
    {
        names[144] = "do_DBSCAN_doublezisegred_large_75768_dim1";
        values[144] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669;
    }
    {
        names[145] = "do_DBSCAN_doublezisegred_large_75768zisegred_tblock_sizze_75762";
        values[145] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669;
    }
    {
        names[146] = "do_DBSCAN_doublezisegred_large_75768zichunk_sizze_85175";
        values[146] = (int64_t) 1;
    }
    {
        names[147] = "do_DBSCAN_doublezisegred_small_75768_dim1";
        values[147] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669;
    }
    {
        names[148] = "do_DBSCAN_doublezisegred_small_75768zisegred_tblock_sizze_75762";
        values[148] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669;
    }
    {
        names[149] = "do_DBSCAN_doublezisegmap_75750_dim1";
        values[149] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75729;
    }
    {
        names[150] = "do_DBSCAN_doublezisegmap_75750zisegmap_tblock_sizze_75744";
        values[150] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75729;
    }
    {
        names[151] = "do_DBSCAN_doublezisegmap_intrablock_78070_dim1";
        values[151] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071;
    }
    {
        names[152] = "do_DBSCAN_doublezisegmap_intrablock_78070zitile_sizze_78072";
        values[152] = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071;
    }
    {
        names[153] = "do_DBSCAN_doublezisegmap_intrablock_78070zibytes_82133";
        values[153] = (int64_t) 8 * *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071;
    }
    {
        names[154] = "do_DBSCAN_doublezisegmap_75536_dim1";
        values[154] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75538;
    }
    {
        names[155] = "do_DBSCAN_doublezisegmap_75536zisegmap_tblock_sizze_75539";
        values[155] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75538;
    }
    {
        names[156] = "do_DBSCAN_doublezisegscan_75526_dim1";
        values[156] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75520;
    }
    {
        names[157] = "do_DBSCAN_doublezisegscan_75526zisegscan_tblock_sizze_75521";
        values[157] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75520;
    }
    {
        names[158] = "do_DBSCAN_doublezisegscan_75526zichunk_sizze_84967";
        values[158] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[159] = "do_DBSCAN_doublezisegred_nonseg_75518_dim1";
        values[159] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75509;
    }
    {
        names[160] = "do_DBSCAN_doublezisegred_nonseg_75518zisegred_tblock_sizze_75510";
        values[160] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75509;
    }
    {
        names[161] = "do_DBSCAN_doublezisegred_nonseg_75518zichunk_sizze_84928";
        values[161] = (int64_t) 1;
    }
    {
        names[162] = "do_DBSCAN_doublezisegmap_75501_dim1";
        values[162] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75503;
    }
    {
        names[163] = "do_DBSCAN_doublezisegmap_75501zisegmap_tblock_sizze_75504";
        values[163] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75503;
    }
    {
        names[164] = "do_DBSCAN_doublezisegscan_75491_dim1";
        values[164] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75485;
    }
    {
        names[165] = "do_DBSCAN_doublezisegscan_75491zisegscan_tblock_sizze_75486";
        values[165] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75485;
    }
    {
        names[166] = "do_DBSCAN_doublezisegscan_75491zichunk_sizze_84753";
        values[166] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[167] = "do_DBSCAN_doublezisegscan_75534_dim1";
        values[167] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75528;
    }
    {
        names[168] = "do_DBSCAN_doublezisegscan_75534zisegscan_tblock_sizze_75529";
        values[168] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75528;
    }
    {
        names[169] = "do_DBSCAN_doublezisegscan_75534zichunk_sizze_84645";
        values[169] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[170] = "do_DBSCAN_doublezisegscan_75499_dim1";
        values[170] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75493;
    }
    {
        names[171] = "do_DBSCAN_doublezisegscan_75499zisegscan_tblock_sizze_75494";
        values[171] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75493;
    }
    {
        names[172] = "do_DBSCAN_doublezisegscan_75499zichunk_sizze_84542";
        values[172] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[173] = "do_DBSCAN_doublezisegred_nonseg_75483_dim1";
        values[173] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75475;
    }
    {
        names[174] = "do_DBSCAN_doublezisegred_nonseg_75483zisegred_tblock_sizze_75476";
        values[174] = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75475;
    }
    {
        names[175] = "do_DBSCAN_doublezisegred_nonseg_75483zichunk_sizze_84503";
        values[175] = (int64_t) 1;
    }
    {
        names[176] = "do_DBSCAN_doublezisegmap_75467_dim1";
        values[176] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75469;
    }
    {
        names[177] = "do_DBSCAN_doublezisegmap_75467zisegmap_tblock_sizze_75470";
        values[177] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75469;
    }
    {
        names[178] = "do_DBSCAN_doublezisegscan_75465_dim1";
        values[178] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75459;
    }
    {
        names[179] = "do_DBSCAN_doublezisegscan_75465zisegscan_tblock_sizze_75460";
        values[179] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75459;
    }
    {
        names[180] = "do_DBSCAN_doublezisegscan_75465zichunk_sizze_84371";
        values[180] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[181] = "do_DBSCAN_doublezisegred_large_84292_dim1";
        values[181] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[182] = "do_DBSCAN_doublezisegred_large_84292ziseghist_tblock_sizze_75444";
        values[182] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[183] = "do_DBSCAN_doublezisegred_large_84292zichunk_sizze_84293";
        values[183] = (int64_t) 1;
    }
    {
        names[184] = "do_DBSCAN_doublezisegred_small_84292_dim1";
        values[184] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[185] = "do_DBSCAN_doublezisegred_small_84292ziseghist_tblock_sizze_75444";
        values[185] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[186] = "do_DBSCAN_doubleziseghist_global_75451_dim1";
        values[186] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[187] = "do_DBSCAN_doubleziseghist_global_75451ziseghist_tblock_sizze_75444";
        values[187] = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    }
    {
        names[188] = "do_DBSCAN_doubleziseghist_local_75451_dim1";
        values[188] = ctx->max_thread_block_size;
    }
    {
        names[189] = "do_DBSCAN_doubleziseghist_local_75451zimax_tblock_sizze_84216";
        values[189] = ctx->max_thread_block_size;
    }
    {
        names[190] = "do_DBSCAN_doublezisegmap_75435_dim1";
        values[190] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75437;
    }
    {
        names[191] = "do_DBSCAN_doublezisegmap_75435zisegmap_tblock_sizze_75438";
        values[191] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75437;
    }
    {
        names[192] = "do_DBSCAN_doublezisegscan_75433_dim1";
        values[192] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75427;
    }
    {
        names[193] = "do_DBSCAN_doublezisegscan_75433zisegscan_tblock_sizze_75428";
        values[193] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75427;
    }
    {
        names[194] = "do_DBSCAN_doublezisegscan_75433zichunk_sizze_84053";
        values[194] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[195] = "do_DBSCAN_doublezisegmap_75377_dim1";
        values[195] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75219;
    }
    {
        names[196] = "do_DBSCAN_doublezisegmap_75377zisegmap_tblock_sizze_75372";
        values[196] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75219;
    }
    {
        names[197] = "do_DBSCAN_doublezisegmap_75356_dim1";
        values[197] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75330;
    }
    {
        names[198] = "do_DBSCAN_doublezisegmap_75356zisegmap_tblock_sizze_75350";
        values[198] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75330;
    }
    {
        names[199] = "do_DBSCAN_doublezisegmap_75196_dim1";
        values[199] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75198;
    }
    {
        names[200] = "do_DBSCAN_doublezisegmap_75196zisegmap_tblock_sizze_75199";
        values[200] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75198;
    }
    {
        names[201] = "do_DBSCAN_doublezisegscan_75194_dim1";
        values[201] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75188;
    }
    {
        names[202] = "do_DBSCAN_doublezisegscan_75194zisegscan_tblock_sizze_75189";
        values[202] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75188;
    }
    {
        names[203] = "do_DBSCAN_doublezisegscan_75194zichunk_sizze_83909";
        values[203] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[204] = "do_DBSCAN_doublezisegmap_75181_dim1";
        values[204] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75166;
    }
    {
        names[205] = "do_DBSCAN_doublezisegmap_75181zisegmap_tblock_sizze_75177";
        values[205] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75166;
    }
    {
        names[206] = "do_DBSCAN_doublezisegmap_75156_dim1";
        values[206] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75158;
    }
    {
        names[207] = "do_DBSCAN_doublezisegmap_75156zisegmap_tblock_sizze_75159";
        values[207] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75158;
    }
    {
        names[208] = "do_DBSCAN_doublezisegmap_75148_dim1";
        values[208] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75150;
    }
    {
        names[209] = "do_DBSCAN_doublezisegmap_75148zisegmap_tblock_sizze_75151";
        values[209] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75150;
    }
    {
        names[210] = "do_DBSCAN_doublezisegscan_75146_dim1";
        values[210] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75140;
    }
    {
        names[211] = "do_DBSCAN_doublezisegscan_75146zisegscan_tblock_sizze_75141";
        values[211] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75140;
    }
    {
        names[212] = "do_DBSCAN_doublezisegscan_75146zichunk_sizze_83772";
        values[212] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[213] = "do_DBSCAN_doublezisegmap_75132_dim1";
        values[213] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75134;
    }
    {
        names[214] = "do_DBSCAN_doublezisegmap_75132zisegmap_tblock_sizze_75135";
        values[214] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75134;
    }
    {
        names[215] = "do_DBSCAN_doublezisegscan_75130_dim1";
        values[215] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75124;
    }
    {
        names[216] = "do_DBSCAN_doublezisegscan_75130zisegscan_tblock_sizze_75125";
        values[216] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75124;
    }
    {
        names[217] = "do_DBSCAN_doublezisegscan_75130zichunk_sizze_83654";
        values[217] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[218] = "do_DBSCAN_doublezisegmap_75116_dim1";
        values[218] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75118;
    }
    {
        names[219] = "do_DBSCAN_doublezisegmap_75116zisegmap_tblock_sizze_75119";
        values[219] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75118;
    }
    {
        names[220] = "do_DBSCAN_doublezisegscan_75114_dim1";
        values[220] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75108;
    }
    {
        names[221] = "do_DBSCAN_doublezisegscan_75114zisegscan_tblock_sizze_75109";
        values[221] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75108;
    }
    {
        names[222] = "do_DBSCAN_doublezisegscan_75114zichunk_sizze_83487";
        values[222] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[223] = "do_DBSCAN_doublezisegmap_75100_dim1";
        values[223] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75102;
    }
    {
        names[224] = "do_DBSCAN_doublezisegmap_75100zisegmap_tblock_sizze_75103";
        values[224] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75102;
    }
    {
        names[225] = "do_DBSCAN_doublezisegscan_75098_dim1";
        values[225] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75092;
    }
    {
        names[226] = "do_DBSCAN_doublezisegscan_75098zisegscan_tblock_sizze_75093";
        values[226] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75092;
    }
    {
        names[227] = "do_DBSCAN_doublezisegscan_75098zichunk_sizze_83371";
        values[227] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[228] = "do_DBSCAN_doublezigpuseq_83361_dim1";
        values[228] = (int64_t) 1;
    }
    {
        names[229] = "do_DBSCAN_doublezigpuseq_83355_dim1";
        values[229] = (int64_t) 1;
    }
    {
        names[230] = "do_DBSCAN_doublezisegmap_75084_dim1";
        values[230] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75086;
    }
    {
        names[231] = "do_DBSCAN_doublezisegmap_75084zisegmap_tblock_sizze_75087";
        values[231] = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75086;
    }
    {
        names[232] = "do_DBSCAN_doublezisegscan_75082_dim1";
        values[232] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75076;
    }
    {
        names[233] = "do_DBSCAN_doublezisegscan_75082zisegscan_tblock_sizze_75077";
        values[233] = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75076;
    }
    {
        names[234] = "do_DBSCAN_doublezisegscan_75082zichunk_sizze_83161";
        values[234] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[235] = "add_next_partition_doublezisegmap_70875_dim1";
        values[235] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70841;
    }
    {
        names[236] = "add_next_partition_doublezisegmap_70875zisegmap_tblock_sizze_70869";
        values[236] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70841;
    }
    {
        names[237] = "add_next_partition_doublezisegmap_70807_dim1";
        values[237] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70764;
    }
    {
        names[238] = "add_next_partition_doublezisegmap_70807zisegmap_tblock_sizze_70800";
        values[238] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70764;
    }
    {
        names[239] = "add_next_partition_doublezisegmap_70754_dim1";
        values[239] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70756;
    }
    {
        names[240] = "add_next_partition_doublezisegmap_70754zisegmap_tblock_sizze_70757";
        values[240] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70756;
    }
    {
        names[241] = "add_next_partition_doublezisegmap_70504_dim1";
        values[241] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70270;
    }
    {
        names[242] = "add_next_partition_doublezisegmap_70504zisegmap_tblock_sizze_70500";
        values[242] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70270;
    }
    {
        names[243] = "add_next_partition_doublezisegred_large_70044_dim1";
        values[243] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805;
    }
    {
        names[244] = "add_next_partition_doublezisegred_large_70044zisegred_tblock_sizze_70038";
        values[244] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805;
    }
    {
        names[245] = "add_next_partition_doublezisegred_large_70044zichunk_sizze_84120";
        values[245] = (int64_t) 1;
    }
    {
        names[246] = "add_next_partition_doublezisegred_small_70044_dim1";
        values[246] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805;
    }
    {
        names[247] = "add_next_partition_doublezisegred_small_70044zisegred_tblock_sizze_70038";
        values[247] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805;
    }
    {
        names[248] = "add_next_partition_doublezisegmap_intrablock_78474_dim1";
        values[248] = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475;
    }
    {
        names[249] = "add_next_partition_doublezisegmap_intrablock_78474zitile_sizze_78476";
        values[249] = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475;
    }
    {
        names[250] = "add_next_partition_doublezisegmap_intrablock_78474zinum_whole_tiles_78497";
        values[250] = squot_safe64((int64_t) 8, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475);
    }
    {
        names[251] = "add_next_partition_doublezisegmap_intrablock_78474ziresidual_input_79224";
        values[251] = srem_safe64((int64_t) 8, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475);
    }
    {
        names[252] = "add_next_partition_doublezisegmap_intrablock_78474zicond_79225";
        values[252] = srem_safe64((int64_t) 8, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475) == (int64_t) 0;
    }
    {
        names[253] = "add_next_partition_doublezisegmap_intrablock_78474zibinop_x_79235";
        values[253] = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475 * squot_safe64((int64_t) 8, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475);
    }
    {
        names[254] = "add_next_partition_doublezisegmap_intrablock_78474zibytes_82097";
        values[254] = (int64_t) 8 * *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475;
    }
    {
        names[255] = "add_next_partition_doublezisegmap_69335_dim1";
        values[255] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69337;
    }
    {
        names[256] = "add_next_partition_doublezisegmap_69335zisegmap_tblock_sizze_69338";
        values[256] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69337;
    }
    {
        names[257] = "add_next_partition_doublezisegscan_70752_dim1";
        values[257] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70746;
    }
    {
        names[258] = "add_next_partition_doublezisegscan_70752zisegscan_tblock_sizze_70747";
        values[258] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70746;
    }
    {
        names[259] = "add_next_partition_doublezisegscan_70752zichunk_sizze_83895";
        values[259] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[260] = "add_next_partition_doublezisegscan_69333_dim1";
        values[260] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_69327;
    }
    {
        names[261] = "add_next_partition_doublezisegscan_69333zisegscan_tblock_sizze_69328";
        values[261] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_69327;
    }
    {
        names[262] = "add_next_partition_doublezisegscan_69333zichunk_sizze_83793";
        values[262] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[263] = "add_next_partition_doublezisegmap_69319_dim1";
        values[263] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69321;
    }
    {
        names[264] = "add_next_partition_doublezisegmap_69319zisegmap_tblock_sizze_69322";
        values[264] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69321;
    }
    {
        names[265] = "add_next_partition_doublezisegscan_69309_dim1";
        values[265] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_68500;
    }
    {
        names[266] = "add_next_partition_doublezisegscan_69309zisegscan_tblock_sizze_69304";
        values[266] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_68500;
    }
    {
        names[267] = "add_next_partition_doublezisegscan_69309zichunk_sizze_83677";
        values[267] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[268] = "add_next_partition_doublezisegmap_69064_dim1";
        values[268] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_67951;
    }
    {
        names[269] = "add_next_partition_doublezisegmap_69064zisegmap_tblock_sizze_69059";
        values[269] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_67951;
    }
    {
        names[270] = "add_next_partition_doublezisegred_large_69051_dim1";
        values[270] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193;
    }
    {
        names[271] = "add_next_partition_doublezisegred_large_69051zisegred_tblock_sizze_69045";
        values[271] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193;
    }
    {
        names[272] = "add_next_partition_doublezisegred_large_69051zichunk_sizze_83589";
        values[272] = (int64_t) 1;
    }
    {
        names[273] = "add_next_partition_doublezisegred_small_69051_dim1";
        values[273] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193;
    }
    {
        names[274] = "add_next_partition_doublezisegred_small_69051zisegred_tblock_sizze_69045";
        values[274] = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193;
    }
    {
        names[275] = "add_next_partition_doublezisegmap_69035_dim1";
        values[275] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_68212;
    }
    {
        names[276] = "add_next_partition_doublezisegmap_69035zisegmap_tblock_sizze_69031";
        values[276] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_68212;
    }
    {
        names[277] = "add_next_partition_doublezisegmap_intrablock_78070_dim1";
        values[277] = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071;
    }
    {
        names[278] = "add_next_partition_doublezisegmap_intrablock_78070zitile_sizze_78072";
        values[278] = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071;
    }
    {
        names[279] = "add_next_partition_doublezisegmap_intrablock_78070zildim_78073";
        values[279] = sdiv_up_safe64((int64_t) 8, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071);
    }
    {
        names[280] = "add_next_partition_doublezisegmap_intrablock_78070zibytes_82028";
        values[280] = (int64_t) 8 * *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071;
    }
    {
        names[281] = "add_next_partition_doublezigpuseq_83426_dim1";
        values[281] = (int64_t) 1;
    }
    {
        names[282] = "add_next_partition_doublezigpuseq_83419_dim1";
        values[282] = (int64_t) 1;
    }
    {
        names[283] = "add_next_partition_doublezigpuseq_83413_dim1";
        values[283] = (int64_t) 1;
    }
    {
        names[284] = "add_next_partition_doublezigpuseq_83407_dim1";
        values[284] = (int64_t) 1;
    }
    {
        names[285] = "add_next_partition_doublezigpuseq_83401_dim1";
        values[285] = (int64_t) 1;
    }
    {
        names[286] = "add_next_partition_doublezigpuseq_83395_dim1";
        values[286] = (int64_t) 1;
    }
    {
        names[287] = "add_next_partition_doublezigpuseq_83369_dim1";
        values[287] = (int64_t) 1;
    }
    {
        names[288] = "add_next_partition_doublezisegmap_70738_dim1";
        values[288] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70740;
    }
    {
        names[289] = "add_next_partition_doublezisegmap_70738zisegmap_tblock_sizze_70741";
        values[289] = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70740;
    }
    {
        names[290] = "add_next_partition_doublezisegscan_70736_dim1";
        values[290] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70730;
    }
    {
        names[291] = "add_next_partition_doublezisegscan_70736zisegscan_tblock_sizze_70731";
        values[291] = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70730;
    }
    {
        names[292] = "add_next_partition_doublezisegscan_70736zichunk_sizze_83167";
        values[292] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    *names_out = names;
    *values_out = values;
    return num_macros;
}
static char *get_failure_msg(int failure_idx, int64_t args[])
{
    (void) args;
    switch (failure_idx) {
        
      case 0:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:284:43-67\n   #1  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #2  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 1:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:419:87-111\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 2:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:312:76-99\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:312:56-101\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 3:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:337:56-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 4:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:312:76-99\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:312:56-101\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 5:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:337:56-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 6:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:312:76-99\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:312:56-101\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 7:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:337:56-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 8:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:352:53-75\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #5  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 9:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:418:79-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 10:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:358:56-80\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:356:43-366:34\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #6  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 11:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:358:56-80\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:356:43-366:34\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #6  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 12:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:358:56-80\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:356:43-366:34\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #6  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 13:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:358:56-80\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:356:43-366:34\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #6  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 14:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftDBSCAN_plus.fut:373:64-88\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:371:52-381:42\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #6  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n");
            break;
        }
        
      case 15:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:435:60-72\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:435:44-102\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 16:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:435:74-86\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:435:44-102\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 17:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:435:88-100\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:435:44-102\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 18:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:439:60-72\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:439:44-88\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 19:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:439:74-86\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:439:44-88\n   #3  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n", args[0], args[1]);
            break;
        }
        
      case 20:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:792:80-101\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:792:44-130\n   #3  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #4  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n", args[0], args[1]);
            break;
        }
        
      case 21:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:792:103-125\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:792:44-130\n   #3  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #4  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n", args[0], args[1]);
            break;
        }
        
      case 22:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:607:71-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:607:60-97\n   #3  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #4  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n", args[0], args[1]);
            break;
        }
        
      case 23:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftbasics.fut:27:66-71\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftbasics.fut:27:23-77\n", args[0], args[1]);
            break;
        }
        
      case 24:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:728:48-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:728:36-70\n   #3  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #4  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n", args[0], args[1]);
            break;
        }
        
      case 25:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 26:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 27:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 28:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 29:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 30:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 31:
        {
            return msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:52:49-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 32:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:46:45-51\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 33:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 34:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 35:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 36:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 37:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 38:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 39:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 40:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 41:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 42:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 43:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 44:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 45:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 46:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 47:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 48:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 49:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 50:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 51:
        {
            return msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:52:49-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 52:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:46:45-51\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 53:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 54:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 55:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 56:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 57:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 58:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 59:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 60:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 61:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 62:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 63:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 64:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 65:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 66:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 67:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 68:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 69:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 70:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 71:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 72:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 73:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 74:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #13 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 75:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 76:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 77:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 78:
        {
            return msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1], args[2]);
            break;
        }
        
      case 79:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 80:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #12 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 81:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 82:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 83:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 84:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 85:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:961:89-103\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:961:36-107\n   #3  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #4  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n", args[0], args[1]);
            break;
        }
        
      case 86:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:983:66-72\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:982:38-986:36\n   #3  ft_libs/ftDBSCAN_plus.fut:1064:18-1067:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1062:9-1067:84\n", args[0], args[1]);
            break;
        }
        
      case 87:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:983:78-86\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:982:38-986:36\n   #3  ft_libs/ftDBSCAN_plus.fut:1064:18-1067:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1062:9-1067:84\n", args[0], args[1]);
            break;
        }
        
      case 88:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:984:64-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:982:38-986:36\n   #3  ft_libs/ftDBSCAN_plus.fut:1064:18-1067:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1062:9-1067:84\n", args[0], args[1]);
            break;
        }
        
      case 89:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftDBSCAN_plus.fut:984:76-82\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:982:38-986:36\n   #3  ft_libs/ftDBSCAN_plus.fut:1064:18-1067:84\n   #4  ft_libs/ftDBSCAN_plus.fut:1062:9-1067:84\n", args[0], args[1]);
            break;
        }
        
      case 90:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftbasics.fut:27:66-71\n   #1  /prelude/soacs.fut:67:23-24\n   #2  /prelude/soacs.fut:67:27-37\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftbasics.fut:27:23-77\n", args[0], args[1]);
            break;
        }
    }
    return strdup("Unknown error.  This is a compiler bug.");
}
struct program {
    int dummy;
    gpu_kernel add_next_partition_doublezigpuseq_83369;
    gpu_kernel add_next_partition_doublezigpuseq_83395;
    gpu_kernel add_next_partition_doublezigpuseq_83401;
    gpu_kernel add_next_partition_doublezigpuseq_83407;
    gpu_kernel add_next_partition_doublezigpuseq_83413;
    gpu_kernel add_next_partition_doublezigpuseq_83419;
    gpu_kernel add_next_partition_doublezigpuseq_83426;
    gpu_kernel add_next_partition_doublezisegmap_69035;
    gpu_kernel add_next_partition_doublezisegmap_69064;
    gpu_kernel add_next_partition_doublezisegmap_69319;
    gpu_kernel add_next_partition_doublezisegmap_69335;
    gpu_kernel add_next_partition_doublezisegmap_70504;
    gpu_kernel add_next_partition_doublezisegmap_70738;
    gpu_kernel add_next_partition_doublezisegmap_70754;
    gpu_kernel add_next_partition_doublezisegmap_70807;
    gpu_kernel add_next_partition_doublezisegmap_70875;
    gpu_kernel add_next_partition_doublezisegmap_intrablock_68780;
    gpu_kernel add_next_partition_doublezisegmap_intrablock_78070;
    gpu_kernel add_next_partition_doublezisegmap_intrablock_78474;
    gpu_kernel add_next_partition_doublezisegred_large_69051;
    gpu_kernel add_next_partition_doublezisegred_large_70044;
    gpu_kernel add_next_partition_doublezisegred_small_69051;
    gpu_kernel add_next_partition_doublezisegred_small_70044;
    gpu_kernel add_next_partition_doublezisegscan_69309;
    gpu_kernel add_next_partition_doublezisegscan_69333;
    gpu_kernel add_next_partition_doublezisegscan_70736;
    gpu_kernel add_next_partition_doublezisegscan_70752;
    gpu_kernel builtinzhiota_i64ziiota_i64_83304;
    gpu_kernel builtinzhreplicate_boolzireplicate_84474;
    gpu_kernel builtinzhreplicate_f64zireplicate_83380;
    gpu_kernel builtinzhreplicate_i32zireplicate_83197;
    gpu_kernel builtinzhreplicate_i64zireplicate_83337;
    gpu_kernel builtinzhreplicate_i8zireplicate_83171;
    gpu_kernel do_DBSCAN_doublezigpuseq_83355;
    gpu_kernel do_DBSCAN_doublezigpuseq_83361;
    gpu_kernel do_DBSCAN_doublezigpuseq_86817;
    gpu_kernel do_DBSCAN_doublezireplicate_84152;
    gpu_kernel do_DBSCAN_doublezireplicate_84172;
    gpu_kernel do_DBSCAN_doubleziseghist_global_75451;
    gpu_kernel do_DBSCAN_doubleziseghist_local_75451;
    gpu_kernel do_DBSCAN_doublezisegmap_75084;
    gpu_kernel do_DBSCAN_doublezisegmap_75100;
    gpu_kernel do_DBSCAN_doublezisegmap_75116;
    gpu_kernel do_DBSCAN_doublezisegmap_75132;
    gpu_kernel do_DBSCAN_doublezisegmap_75148;
    gpu_kernel do_DBSCAN_doublezisegmap_75156;
    gpu_kernel do_DBSCAN_doublezisegmap_75181;
    gpu_kernel do_DBSCAN_doublezisegmap_75196;
    gpu_kernel do_DBSCAN_doublezisegmap_75356;
    gpu_kernel do_DBSCAN_doublezisegmap_75377;
    gpu_kernel do_DBSCAN_doublezisegmap_75435;
    gpu_kernel do_DBSCAN_doublezisegmap_75467;
    gpu_kernel do_DBSCAN_doublezisegmap_75501;
    gpu_kernel do_DBSCAN_doublezisegmap_75536;
    gpu_kernel do_DBSCAN_doublezisegmap_75750;
    gpu_kernel do_DBSCAN_doublezisegmap_75854;
    gpu_kernel do_DBSCAN_doublezisegmap_75887;
    gpu_kernel do_DBSCAN_doublezisegmap_75910;
    gpu_kernel do_DBSCAN_doublezisegmap_76323;
    gpu_kernel do_DBSCAN_doublezisegmap_76637;
    gpu_kernel do_DBSCAN_doublezisegmap_77089;
    gpu_kernel do_DBSCAN_doublezisegmap_77105;
    gpu_kernel do_DBSCAN_doublezisegmap_77340;
    gpu_kernel do_DBSCAN_doublezisegmap_77642;
    gpu_kernel do_DBSCAN_doublezisegmap_77717;
    gpu_kernel do_DBSCAN_doublezisegmap_77725;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_78070;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_78490;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_78845;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_79200;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_79483;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_79766;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_80148;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_80530;
    gpu_kernel do_DBSCAN_doublezisegmap_intrablock_80971;
    gpu_kernel do_DBSCAN_doublezisegred_large_75768;
    gpu_kernel do_DBSCAN_doublezisegred_large_77359;
    gpu_kernel do_DBSCAN_doublezisegred_large_77661;
    gpu_kernel do_DBSCAN_doublezisegred_large_84292;
    gpu_kernel do_DBSCAN_doublezisegred_nonseg_75483;
    gpu_kernel do_DBSCAN_doublezisegred_nonseg_75518;
    gpu_kernel do_DBSCAN_doublezisegred_nonseg_75826;
    gpu_kernel do_DBSCAN_doublezisegred_nonseg_77741;
    gpu_kernel do_DBSCAN_doublezisegred_nonseg_77751;
    gpu_kernel do_DBSCAN_doublezisegred_small_75768;
    gpu_kernel do_DBSCAN_doublezisegred_small_77359;
    gpu_kernel do_DBSCAN_doublezisegred_small_77661;
    gpu_kernel do_DBSCAN_doublezisegred_small_84292;
    gpu_kernel do_DBSCAN_doublezisegscan_75082;
    gpu_kernel do_DBSCAN_doublezisegscan_75098;
    gpu_kernel do_DBSCAN_doublezisegscan_75114;
    gpu_kernel do_DBSCAN_doublezisegscan_75130;
    gpu_kernel do_DBSCAN_doublezisegscan_75146;
    gpu_kernel do_DBSCAN_doublezisegscan_75194;
    gpu_kernel do_DBSCAN_doublezisegscan_75433;
    gpu_kernel do_DBSCAN_doublezisegscan_75465;
    gpu_kernel do_DBSCAN_doublezisegscan_75491;
    gpu_kernel do_DBSCAN_doublezisegscan_75499;
    gpu_kernel do_DBSCAN_doublezisegscan_75526;
    gpu_kernel do_DBSCAN_doublezisegscan_75534;
    gpu_kernel do_DBSCAN_doublezisegscan_75834;
    gpu_kernel do_DBSCAN_doublezisegscan_75908;
    gpu_kernel do_DBSCAN_doublezisegscan_76315;
    gpu_kernel do_DBSCAN_doublezisegscan_76628;
    gpu_kernel do_DBSCAN_doublezisegscan_77081;
    gpu_kernel do_DBSCAN_doublezisegscan_77103;
    gpu_kernel get_num_neighbours_against_11932zisegmap_74600;
    gpu_kernel get_num_neighbours_against_11932zisegmap_intrablock_78070;
    gpu_kernel get_num_neighbours_against_11932zisegred_large_74618;
    gpu_kernel get_num_neighbours_against_11932zisegred_small_74618;
    gpu_kernel get_num_neighbours_against_11935zisegmap_74866;
    gpu_kernel get_num_neighbours_against_11935zisegmap_intrablock_78070;
    gpu_kernel get_num_neighbours_against_11935zisegred_large_74884;
    gpu_kernel get_num_neighbours_against_11935zisegred_small_74884;
    gpu_kernel make_collisions_compact_doublezigpuseq_83217;
    gpu_kernel make_collisions_compact_doublezireplicate_83380;
    gpu_kernel make_collisions_compact_doublezireplicate_83400;
    gpu_kernel make_collisions_compact_doublezireplicate_83523;
    gpu_kernel make_collisions_compact_doublezireplicate_83546;
    gpu_kernel make_collisions_compact_doublezisegmap_71189;
    gpu_kernel make_collisions_compact_doublezisegmap_71214;
    gpu_kernel make_collisions_compact_doublezisegmap_73717;
    gpu_kernel make_collisions_compact_doublezisegmap_73746;
    gpu_kernel make_collisions_compact_doublezisegmap_73770;
    gpu_kernel make_collisions_compact_doublezisegmap_74095;
    gpu_kernel make_collisions_compact_doublezisegmap_74218;
    gpu_kernel make_collisions_compact_doublezisegmap_74293;
    gpu_kernel make_collisions_compact_doublezisegmap_74392;
    gpu_kernel make_collisions_compact_doublezisegmap_intrablock_71523;
    gpu_kernel make_collisions_compact_doublezisegmap_intrablock_73841;
    gpu_kernel make_collisions_compact_doublezisegred_nonseg_70910;
    gpu_kernel make_collisions_compact_doublezisegscan_74390;
    gpu_kernel mk_dbcHandler_doublezigpuseq_83216;
    gpu_kernel next_partition_to_read_doublezigpuseq_83120;
    gpu_kernel next_partition_to_read_doublezigpuseq_83333;
    gpu_kernel next_partition_to_read_doublezisegmap_66881;
    gpu_kernel next_partition_to_read_doublezisegred_nonseg_66871;
    gpu_kernel next_partition_to_read_doublezisegscan_66879;
    gpu_kernel rectify_cluster_ids_doublezisegmap_74989;
    gpu_kernel rectify_cluster_ids_doublezisegmap_75061;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83369, "add_next_partition_doublezigpuseq_83369");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83395, "add_next_partition_doublezigpuseq_83395");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83401, "add_next_partition_doublezigpuseq_83401");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83407, "add_next_partition_doublezigpuseq_83407");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83413, "add_next_partition_doublezigpuseq_83413");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83419, "add_next_partition_doublezigpuseq_83419");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezigpuseq_83426, "add_next_partition_doublezigpuseq_83426");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_69035, "add_next_partition_doublezisegmap_69035");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_69064, "add_next_partition_doublezisegmap_69064");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_69319, "add_next_partition_doublezisegmap_69319");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_69335, "add_next_partition_doublezisegmap_69335");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_70504, "add_next_partition_doublezisegmap_70504");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_70738, "add_next_partition_doublezisegmap_70738");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_70754, "add_next_partition_doublezisegmap_70754");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_70807, "add_next_partition_doublezisegmap_70807");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_70875, "add_next_partition_doublezisegmap_70875");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_intrablock_68780, "add_next_partition_doublezisegmap_intrablock_68780");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_intrablock_78070, "add_next_partition_doublezisegmap_intrablock_78070");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegmap_intrablock_78474, "add_next_partition_doublezisegmap_intrablock_78474");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegred_large_69051, "add_next_partition_doublezisegred_large_69051");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegred_large_70044, "add_next_partition_doublezisegred_large_70044");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegred_small_69051, "add_next_partition_doublezisegred_small_69051");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegred_small_70044, "add_next_partition_doublezisegred_small_70044");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegscan_69309, "add_next_partition_doublezisegscan_69309");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegscan_69333, "add_next_partition_doublezisegscan_69333");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegscan_70736, "add_next_partition_doublezisegscan_70736");
    gpu_create_kernel(ctx, &ctx->program->add_next_partition_doublezisegscan_70752, "add_next_partition_doublezisegscan_70752");
    gpu_create_kernel(ctx, &ctx->program->builtinzhiota_i64ziiota_i64_83304, "builtinzhiota_i64ziiota_i64_83304");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_boolzireplicate_84474, "builtinzhreplicate_boolzireplicate_84474");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f64zireplicate_83380, "builtinzhreplicate_f64zireplicate_83380");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i32zireplicate_83197, "builtinzhreplicate_i32zireplicate_83197");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i64zireplicate_83337, "builtinzhreplicate_i64zireplicate_83337");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i8zireplicate_83171, "builtinzhreplicate_i8zireplicate_83171");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezigpuseq_83355, "do_DBSCAN_doublezigpuseq_83355");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezigpuseq_83361, "do_DBSCAN_doublezigpuseq_83361");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezigpuseq_86817, "do_DBSCAN_doublezigpuseq_86817");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezireplicate_84152, "do_DBSCAN_doublezireplicate_84152");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezireplicate_84172, "do_DBSCAN_doublezireplicate_84172");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doubleziseghist_global_75451, "do_DBSCAN_doubleziseghist_global_75451");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doubleziseghist_local_75451, "do_DBSCAN_doubleziseghist_local_75451");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75084, "do_DBSCAN_doublezisegmap_75084");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75100, "do_DBSCAN_doublezisegmap_75100");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75116, "do_DBSCAN_doublezisegmap_75116");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75132, "do_DBSCAN_doublezisegmap_75132");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75148, "do_DBSCAN_doublezisegmap_75148");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75156, "do_DBSCAN_doublezisegmap_75156");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75181, "do_DBSCAN_doublezisegmap_75181");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75196, "do_DBSCAN_doublezisegmap_75196");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75356, "do_DBSCAN_doublezisegmap_75356");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75377, "do_DBSCAN_doublezisegmap_75377");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75435, "do_DBSCAN_doublezisegmap_75435");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75467, "do_DBSCAN_doublezisegmap_75467");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75501, "do_DBSCAN_doublezisegmap_75501");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75536, "do_DBSCAN_doublezisegmap_75536");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75750, "do_DBSCAN_doublezisegmap_75750");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75854, "do_DBSCAN_doublezisegmap_75854");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75887, "do_DBSCAN_doublezisegmap_75887");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_75910, "do_DBSCAN_doublezisegmap_75910");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_76323, "do_DBSCAN_doublezisegmap_76323");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_76637, "do_DBSCAN_doublezisegmap_76637");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77089, "do_DBSCAN_doublezisegmap_77089");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77105, "do_DBSCAN_doublezisegmap_77105");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77340, "do_DBSCAN_doublezisegmap_77340");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77642, "do_DBSCAN_doublezisegmap_77642");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77717, "do_DBSCAN_doublezisegmap_77717");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_77725, "do_DBSCAN_doublezisegmap_77725");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_78070, "do_DBSCAN_doublezisegmap_intrablock_78070");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_78490, "do_DBSCAN_doublezisegmap_intrablock_78490");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_78845, "do_DBSCAN_doublezisegmap_intrablock_78845");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_79200, "do_DBSCAN_doublezisegmap_intrablock_79200");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_79483, "do_DBSCAN_doublezisegmap_intrablock_79483");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_79766, "do_DBSCAN_doublezisegmap_intrablock_79766");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_80148, "do_DBSCAN_doublezisegmap_intrablock_80148");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_80530, "do_DBSCAN_doublezisegmap_intrablock_80530");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegmap_intrablock_80971, "do_DBSCAN_doublezisegmap_intrablock_80971");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_large_75768, "do_DBSCAN_doublezisegred_large_75768");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_large_77359, "do_DBSCAN_doublezisegred_large_77359");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_large_77661, "do_DBSCAN_doublezisegred_large_77661");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_large_84292, "do_DBSCAN_doublezisegred_large_84292");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_nonseg_75483, "do_DBSCAN_doublezisegred_nonseg_75483");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_nonseg_75518, "do_DBSCAN_doublezisegred_nonseg_75518");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_nonseg_75826, "do_DBSCAN_doublezisegred_nonseg_75826");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_nonseg_77741, "do_DBSCAN_doublezisegred_nonseg_77741");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_nonseg_77751, "do_DBSCAN_doublezisegred_nonseg_77751");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_small_75768, "do_DBSCAN_doublezisegred_small_75768");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_small_77359, "do_DBSCAN_doublezisegred_small_77359");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_small_77661, "do_DBSCAN_doublezisegred_small_77661");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegred_small_84292, "do_DBSCAN_doublezisegred_small_84292");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75082, "do_DBSCAN_doublezisegscan_75082");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75098, "do_DBSCAN_doublezisegscan_75098");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75114, "do_DBSCAN_doublezisegscan_75114");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75130, "do_DBSCAN_doublezisegscan_75130");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75146, "do_DBSCAN_doublezisegscan_75146");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75194, "do_DBSCAN_doublezisegscan_75194");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75433, "do_DBSCAN_doublezisegscan_75433");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75465, "do_DBSCAN_doublezisegscan_75465");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75491, "do_DBSCAN_doublezisegscan_75491");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75499, "do_DBSCAN_doublezisegscan_75499");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75526, "do_DBSCAN_doublezisegscan_75526");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75534, "do_DBSCAN_doublezisegscan_75534");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75834, "do_DBSCAN_doublezisegscan_75834");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_75908, "do_DBSCAN_doublezisegscan_75908");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_76315, "do_DBSCAN_doublezisegscan_76315");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_76628, "do_DBSCAN_doublezisegscan_76628");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_77081, "do_DBSCAN_doublezisegscan_77081");
    gpu_create_kernel(ctx, &ctx->program->do_DBSCAN_doublezisegscan_77103, "do_DBSCAN_doublezisegscan_77103");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11932zisegmap_74600, "get_num_neighbours_against_11932zisegmap_74600");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11932zisegmap_intrablock_78070, "get_num_neighbours_against_11932zisegmap_intrablock_78070");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11932zisegred_large_74618, "get_num_neighbours_against_11932zisegred_large_74618");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11932zisegred_small_74618, "get_num_neighbours_against_11932zisegred_small_74618");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11935zisegmap_74866, "get_num_neighbours_against_11935zisegmap_74866");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11935zisegmap_intrablock_78070, "get_num_neighbours_against_11935zisegmap_intrablock_78070");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11935zisegred_large_74884, "get_num_neighbours_against_11935zisegred_large_74884");
    gpu_create_kernel(ctx, &ctx->program->get_num_neighbours_against_11935zisegred_small_74884, "get_num_neighbours_against_11935zisegred_small_74884");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezigpuseq_83217, "make_collisions_compact_doublezigpuseq_83217");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezireplicate_83380, "make_collisions_compact_doublezireplicate_83380");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezireplicate_83400, "make_collisions_compact_doublezireplicate_83400");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezireplicate_83523, "make_collisions_compact_doublezireplicate_83523");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezireplicate_83546, "make_collisions_compact_doublezireplicate_83546");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_71189, "make_collisions_compact_doublezisegmap_71189");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_71214, "make_collisions_compact_doublezisegmap_71214");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_73717, "make_collisions_compact_doublezisegmap_73717");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_73746, "make_collisions_compact_doublezisegmap_73746");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_73770, "make_collisions_compact_doublezisegmap_73770");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_74095, "make_collisions_compact_doublezisegmap_74095");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_74218, "make_collisions_compact_doublezisegmap_74218");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_74293, "make_collisions_compact_doublezisegmap_74293");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_74392, "make_collisions_compact_doublezisegmap_74392");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_intrablock_71523, "make_collisions_compact_doublezisegmap_intrablock_71523");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegmap_intrablock_73841, "make_collisions_compact_doublezisegmap_intrablock_73841");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegred_nonseg_70910, "make_collisions_compact_doublezisegred_nonseg_70910");
    gpu_create_kernel(ctx, &ctx->program->make_collisions_compact_doublezisegscan_74390, "make_collisions_compact_doublezisegscan_74390");
    gpu_create_kernel(ctx, &ctx->program->mk_dbcHandler_doublezigpuseq_83216, "mk_dbcHandler_doublezigpuseq_83216");
    gpu_create_kernel(ctx, &ctx->program->next_partition_to_read_doublezigpuseq_83120, "next_partition_to_read_doublezigpuseq_83120");
    gpu_create_kernel(ctx, &ctx->program->next_partition_to_read_doublezigpuseq_83333, "next_partition_to_read_doublezigpuseq_83333");
    gpu_create_kernel(ctx, &ctx->program->next_partition_to_read_doublezisegmap_66881, "next_partition_to_read_doublezisegmap_66881");
    gpu_create_kernel(ctx, &ctx->program->next_partition_to_read_doublezisegred_nonseg_66871, "next_partition_to_read_doublezisegred_nonseg_66871");
    gpu_create_kernel(ctx, &ctx->program->next_partition_to_read_doublezisegscan_66879, "next_partition_to_read_doublezisegscan_66879");
    gpu_create_kernel(ctx, &ctx->program->rectify_cluster_ids_doublezisegmap_74989, "rectify_cluster_ids_doublezisegmap_74989");
    gpu_create_kernel(ctx, &ctx->program->rectify_cluster_ids_doublezisegmap_75061, "rectify_cluster_ids_doublezisegmap_75061");
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83369);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83395);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83401);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83407);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83413);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83419);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83426);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69035);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69064);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69319);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69335);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70504);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70738);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70754);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70807);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70875);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_68780);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_78070);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_78474);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegred_large_69051);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegred_large_70044);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegred_small_69051);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegred_small_70044);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_69309);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_69333);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_70736);
    gpu_free_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_70752);
    gpu_free_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_83304);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_boolzireplicate_84474);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_83380);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_83197);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_83337);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_83171);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_83355);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_83361);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_86817);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezireplicate_84152);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezireplicate_84172);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doubleziseghist_global_75451);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doubleziseghist_local_75451);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75084);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75100);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75116);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75132);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75148);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75156);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75181);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75196);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75356);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75377);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75435);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75467);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75501);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75536);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75750);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75854);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75887);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75910);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_76323);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_76637);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77089);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77105);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77340);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77642);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77717);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77725);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78070);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78490);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78845);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79200);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79483);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79766);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80148);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80530);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80971);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_75768);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_77359);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_77661);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_84292);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75483);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75518);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75826);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_77741);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_77751);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_75768);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_77359);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_77661);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_84292);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75082);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75098);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75114);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75130);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75146);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75194);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75433);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75465);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75491);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75499);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75526);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75534);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75834);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75908);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_76315);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_76628);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_77081);
    gpu_free_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_77103);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegmap_74600);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegmap_intrablock_78070);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegred_large_74618);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegred_small_74618);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegmap_74866);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegmap_intrablock_78070);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegred_large_74884);
    gpu_free_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegred_small_74884);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezigpuseq_83217);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83380);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83400);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83523);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83546);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_71189);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_71214);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73717);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73746);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73770);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74095);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74218);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74293);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74392);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_intrablock_71523);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_intrablock_73841);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegred_nonseg_70910);
    gpu_free_kernel(ctx, ctx->program->make_collisions_compact_doublezisegscan_74390);
    gpu_free_kernel(ctx, ctx->program->mk_dbcHandler_doublezigpuseq_83216);
    gpu_free_kernel(ctx, ctx->program->next_partition_to_read_doublezigpuseq_83120);
    gpu_free_kernel(ctx, ctx->program->next_partition_to_read_doublezigpuseq_83333);
    gpu_free_kernel(ctx, ctx->program->next_partition_to_read_doublezisegmap_66881);
    gpu_free_kernel(ctx, ctx->program->next_partition_to_read_doublezisegred_nonseg_66871);
    gpu_free_kernel(ctx, ctx->program->next_partition_to_read_doublezisegscan_66879);
    gpu_free_kernel(ctx, ctx->program->rectify_cluster_ids_doublezisegmap_74989);
    gpu_free_kernel(ctx, ctx->program->rectify_cluster_ids_doublezisegmap_75061);
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
    ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_69323 = &ctx->cfg->tuning_params[0];
    ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_69339 = &ctx->cfg->tuning_params[1];
    ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_70742 = &ctx->cfg->tuning_params[2];
    ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_70758 = &ctx->cfg->tuning_params[3];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_67951 = &ctx->cfg->tuning_params[4];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_68212 = &ctx->cfg->tuning_params[5];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69321 = &ctx->cfg->tuning_params[6];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69337 = &ctx->cfg->tuning_params[7];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70270 = &ctx->cfg->tuning_params[8];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70740 = &ctx->cfg->tuning_params[9];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70756 = &ctx->cfg->tuning_params[10];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70764 = &ctx->cfg->tuning_params[11];
    ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70841 = &ctx->cfg->tuning_params[12];
    ctx->tuning_params.add_next_partition_doublezisegred_num_tblocks_68195 = &ctx->cfg->tuning_params[13];
    ctx->tuning_params.add_next_partition_doublezisegred_num_tblocks_69807 = &ctx->cfg->tuning_params[14];
    ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193 = &ctx->cfg->tuning_params[15];
    ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805 = &ctx->cfg->tuning_params[16];
    ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_66893 = &ctx->cfg->tuning_params[17];
    ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_68502 = &ctx->cfg->tuning_params[18];
    ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_69329 = &ctx->cfg->tuning_params[19];
    ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_70732 = &ctx->cfg->tuning_params[20];
    ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_70748 = &ctx->cfg->tuning_params[21];
    ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_66891 = &ctx->cfg->tuning_params[22];
    ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_68500 = &ctx->cfg->tuning_params[23];
    ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_69327 = &ctx->cfg->tuning_params[24];
    ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70730 = &ctx->cfg->tuning_params[25];
    ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70746 = &ctx->cfg->tuning_params[26];
    ctx->tuning_params.add_next_partition_doublezisuff_intra_par_2 = &ctx->cfg->tuning_params[27];
    ctx->tuning_params.add_next_partition_doublezisuff_outer_par_1 = &ctx->cfg->tuning_params[28];
    ctx->tuning_params.add_next_partition_doublezisuff_outer_par_3 = &ctx->cfg->tuning_params[29];
    ctx->tuning_params.add_next_partition_doublezisuff_outer_screma_0 = &ctx->cfg->tuning_params[30];
    ctx->tuning_params.add_next_partition_doublezitile_sizze_78071 = &ctx->cfg->tuning_params[31];
    ctx->tuning_params.add_next_partition_doublezitile_sizze_78475 = &ctx->cfg->tuning_params[32];
    ctx->tuning_params.builtinzhiota_i64zitblock_sizze_83308 = &ctx->cfg->tuning_params[33];
    ctx->tuning_params.builtinzhreplicate_boolzitblock_sizze_84478 = &ctx->cfg->tuning_params[34];
    ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_83384 = &ctx->cfg->tuning_params[35];
    ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_83201 = &ctx->cfg->tuning_params[36];
    ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_83341 = &ctx->cfg->tuning_params[37];
    ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_83175 = &ctx->cfg->tuning_params[38];
    ctx->tuning_params.do_DBSCAN_doublezihist_L2_84268 = &ctx->cfg->tuning_params[39];
    ctx->tuning_params.do_DBSCAN_doublezihist_L_84215 = &ctx->cfg->tuning_params[40];
    ctx->tuning_params.do_DBSCAN_doubleziseghist_num_tblocks_75445 = &ctx->cfg->tuning_params[41];
    ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443 = &ctx->cfg->tuning_params[42];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75088 = &ctx->cfg->tuning_params[43];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75104 = &ctx->cfg->tuning_params[44];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75120 = &ctx->cfg->tuning_params[45];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75136 = &ctx->cfg->tuning_params[46];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75152 = &ctx->cfg->tuning_params[47];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75160 = &ctx->cfg->tuning_params[48];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75200 = &ctx->cfg->tuning_params[49];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75439 = &ctx->cfg->tuning_params[50];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75471 = &ctx->cfg->tuning_params[51];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75505 = &ctx->cfg->tuning_params[52];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75540 = &ctx->cfg->tuning_params[53];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75914 = &ctx->cfg->tuning_params[54];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_76327 = &ctx->cfg->tuning_params[55];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_76641 = &ctx->cfg->tuning_params[56];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77093 = &ctx->cfg->tuning_params[57];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77109 = &ctx->cfg->tuning_params[58];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77721 = &ctx->cfg->tuning_params[59];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77729 = &ctx->cfg->tuning_params[60];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75086 = &ctx->cfg->tuning_params[61];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75102 = &ctx->cfg->tuning_params[62];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75118 = &ctx->cfg->tuning_params[63];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75134 = &ctx->cfg->tuning_params[64];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75150 = &ctx->cfg->tuning_params[65];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75158 = &ctx->cfg->tuning_params[66];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75166 = &ctx->cfg->tuning_params[67];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75198 = &ctx->cfg->tuning_params[68];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75219 = &ctx->cfg->tuning_params[69];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75330 = &ctx->cfg->tuning_params[70];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75437 = &ctx->cfg->tuning_params[71];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75469 = &ctx->cfg->tuning_params[72];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75503 = &ctx->cfg->tuning_params[73];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75538 = &ctx->cfg->tuning_params[74];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75729 = &ctx->cfg->tuning_params[75];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75838 = &ctx->cfg->tuning_params[76];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75864 = &ctx->cfg->tuning_params[77];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75912 = &ctx->cfg->tuning_params[78];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76325 = &ctx->cfg->tuning_params[79];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76639 = &ctx->cfg->tuning_params[80];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77091 = &ctx->cfg->tuning_params[81];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77107 = &ctx->cfg->tuning_params[82];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77319 = &ctx->cfg->tuning_params[83];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77621 = &ctx->cfg->tuning_params[84];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77719 = &ctx->cfg->tuning_params[85];
    ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77727 = &ctx->cfg->tuning_params[86];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75477 = &ctx->cfg->tuning_params[87];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75511 = &ctx->cfg->tuning_params[88];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75671 = &ctx->cfg->tuning_params[89];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75820 = &ctx->cfg->tuning_params[90];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77255 = &ctx->cfg->tuning_params[91];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77557 = &ctx->cfg->tuning_params[92];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77735 = &ctx->cfg->tuning_params[93];
    ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77745 = &ctx->cfg->tuning_params[94];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75475 = &ctx->cfg->tuning_params[95];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75509 = &ctx->cfg->tuning_params[96];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669 = &ctx->cfg->tuning_params[97];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75818 = &ctx->cfg->tuning_params[98];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253 = &ctx->cfg->tuning_params[99];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555 = &ctx->cfg->tuning_params[100];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77733 = &ctx->cfg->tuning_params[101];
    ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77743 = &ctx->cfg->tuning_params[102];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75078 = &ctx->cfg->tuning_params[103];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75094 = &ctx->cfg->tuning_params[104];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75110 = &ctx->cfg->tuning_params[105];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75126 = &ctx->cfg->tuning_params[106];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75142 = &ctx->cfg->tuning_params[107];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75190 = &ctx->cfg->tuning_params[108];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75429 = &ctx->cfg->tuning_params[109];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75461 = &ctx->cfg->tuning_params[110];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75487 = &ctx->cfg->tuning_params[111];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75495 = &ctx->cfg->tuning_params[112];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75522 = &ctx->cfg->tuning_params[113];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75530 = &ctx->cfg->tuning_params[114];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75830 = &ctx->cfg->tuning_params[115];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75904 = &ctx->cfg->tuning_params[116];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75951 = &ctx->cfg->tuning_params[117];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76211 = &ctx->cfg->tuning_params[118];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76335 = &ctx->cfg->tuning_params[119];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76542 = &ctx->cfg->tuning_params[120];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76649 = &ctx->cfg->tuning_params[121];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76959 = &ctx->cfg->tuning_params[122];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_77099 = &ctx->cfg->tuning_params[123];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75076 = &ctx->cfg->tuning_params[124];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75092 = &ctx->cfg->tuning_params[125];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75108 = &ctx->cfg->tuning_params[126];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75124 = &ctx->cfg->tuning_params[127];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75140 = &ctx->cfg->tuning_params[128];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75188 = &ctx->cfg->tuning_params[129];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75427 = &ctx->cfg->tuning_params[130];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75459 = &ctx->cfg->tuning_params[131];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75485 = &ctx->cfg->tuning_params[132];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75493 = &ctx->cfg->tuning_params[133];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75520 = &ctx->cfg->tuning_params[134];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75528 = &ctx->cfg->tuning_params[135];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75828 = &ctx->cfg->tuning_params[136];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75902 = &ctx->cfg->tuning_params[137];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75949 = &ctx->cfg->tuning_params[138];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76209 = &ctx->cfg->tuning_params[139];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76333 = &ctx->cfg->tuning_params[140];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76540 = &ctx->cfg->tuning_params[141];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76647 = &ctx->cfg->tuning_params[142];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76957 = &ctx->cfg->tuning_params[143];
    ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_77097 = &ctx->cfg->tuning_params[144];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_0 = &ctx->cfg->tuning_params[145];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_2 = &ctx->cfg->tuning_params[146];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_4 = &ctx->cfg->tuning_params[147];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_6 = &ctx->cfg->tuning_params[148];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_7 = &ctx->cfg->tuning_params[149];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_8 = &ctx->cfg->tuning_params[150];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_1 = &ctx->cfg->tuning_params[151];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_3 = &ctx->cfg->tuning_params[152];
    ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_5 = &ctx->cfg->tuning_params[153];
    ctx->tuning_params.do_DBSCAN_doublezitblock_sizze_84156 = &ctx->cfg->tuning_params[154];
    ctx->tuning_params.do_DBSCAN_doublezitblock_sizze_84176 = &ctx->cfg->tuning_params[155];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071 = &ctx->cfg->tuning_params[156];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491 = &ctx->cfg->tuning_params[157];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846 = &ctx->cfg->tuning_params[158];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201 = &ctx->cfg->tuning_params[159];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484 = &ctx->cfg->tuning_params[160];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767 = &ctx->cfg->tuning_params[161];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149 = &ctx->cfg->tuning_params[162];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531 = &ctx->cfg->tuning_params[163];
    ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972 = &ctx->cfg->tuning_params[164];
    ctx->tuning_params.get_num_neighbours_against_11932zisegmap_tblock_sizze_74579 = &ctx->cfg->tuning_params[165];
    ctx->tuning_params.get_num_neighbours_against_11932zisegred_num_tblocks_74523 = &ctx->cfg->tuning_params[166];
    ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521 = &ctx->cfg->tuning_params[167];
    ctx->tuning_params.get_num_neighbours_against_11932zisuff_outer_par_0 = &ctx->cfg->tuning_params[168];
    ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071 = &ctx->cfg->tuning_params[169];
    ctx->tuning_params.get_num_neighbours_against_11935zisegmap_tblock_sizze_74845 = &ctx->cfg->tuning_params[170];
    ctx->tuning_params.get_num_neighbours_against_11935zisegred_num_tblocks_74789 = &ctx->cfg->tuning_params[171];
    ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787 = &ctx->cfg->tuning_params[172];
    ctx->tuning_params.get_num_neighbours_against_11935zisuff_outer_par_0 = &ctx->cfg->tuning_params[173];
    ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071 = &ctx->cfg->tuning_params[174];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_70981 = &ctx->cfg->tuning_params[175];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_72134 = &ctx->cfg->tuning_params[176];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_72858 = &ctx->cfg->tuning_params[177];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_74396 = &ctx->cfg->tuning_params[178];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_70979 = &ctx->cfg->tuning_params[179];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_71122 = &ctx->cfg->tuning_params[180];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72132 = &ctx->cfg->tuning_params[181];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72201 = &ctx->cfg->tuning_params[182];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72856 = &ctx->cfg->tuning_params[183];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72938 = &ctx->cfg->tuning_params[184];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73167 = &ctx->cfg->tuning_params[185];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73685 = &ctx->cfg->tuning_params[186];
    ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_74394 = &ctx->cfg->tuning_params[187];
    ctx->tuning_params.make_collisions_compact_doublezisegred_num_tblocks_70903 = &ctx->cfg->tuning_params[188];
    ctx->tuning_params.make_collisions_compact_doublezisegred_tblock_sizze_70901 = &ctx->cfg->tuning_params[189];
    ctx->tuning_params.make_collisions_compact_doublezisegscan_num_tblocks_74386 = &ctx->cfg->tuning_params[190];
    ctx->tuning_params.make_collisions_compact_doublezisegscan_tblock_sizze_74384 = &ctx->cfg->tuning_params[191];
    ctx->tuning_params.make_collisions_compact_doublezisuff_intra_par_0 = &ctx->cfg->tuning_params[192];
    ctx->tuning_params.make_collisions_compact_doublezisuff_intra_par_1 = &ctx->cfg->tuning_params[193];
    ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83384 = &ctx->cfg->tuning_params[194];
    ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83404 = &ctx->cfg->tuning_params[195];
    ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83527 = &ctx->cfg->tuning_params[196];
    ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83550 = &ctx->cfg->tuning_params[197];
    ctx->tuning_params.next_partition_to_read_doublezisegmap_num_tblocks_66885 = &ctx->cfg->tuning_params[198];
    ctx->tuning_params.next_partition_to_read_doublezisegmap_tblock_sizze_66883 = &ctx->cfg->tuning_params[199];
    ctx->tuning_params.next_partition_to_read_doublezisegred_num_tblocks_66865 = &ctx->cfg->tuning_params[200];
    ctx->tuning_params.next_partition_to_read_doublezisegred_tblock_sizze_66863 = &ctx->cfg->tuning_params[201];
    ctx->tuning_params.next_partition_to_read_doublezisegscan_num_tblocks_66875 = &ctx->cfg->tuning_params[202];
    ctx->tuning_params.next_partition_to_read_doublezisegscan_tblock_sizze_66873 = &ctx->cfg->tuning_params[203];
    ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_74934 = &ctx->cfg->tuning_params[204];
    ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_75038 = &ctx->cfg->tuning_params[205];
}
int memblock_unref_device(struct futhark_context *ctx, struct memblock_device *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            (void) gpu_free(ctx, block->mem, block->size, desc);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc_device(struct futhark_context *ctx, struct memblock_device *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "space 'device'", ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "space 'device'", (long long) ctx->cur_mem_usage_device);
    (void) gpu_alloc(ctx, ctx->log, (size_t) size, desc, &block->mem, (size_t *) &size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_device + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_device = new_usage;
        if (new_usage > ctx->peak_mem_usage_device) {
            ctx->peak_mem_usage_device = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "space 'device'", (long long) size, (long long) ctx->cur_mem_usage_device, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set_device(struct futhark_context *ctx, struct memblock_device *lhs, struct memblock_device *rhs, const char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"space 'device'\": %lld", (long long) ctx->peak_mem_usage_device);
    str_builder_char(&builder, ',');
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        gpu_free_all(ctx);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_83299, int64_t n_83300, int64_t x_83301, int64_t s_83302);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_bool(struct futhark_context *ctx, struct memblock_device mem_84469, int64_t num_elems_84470, bool val_84471);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_83375, int64_t num_elems_83376, double val_83377);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_83192, int64_t num_elems_83193, int32_t val_83194);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_83332, int64_t num_elems_83333, int64_t val_83334);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_83166, int64_t num_elems_83167, int8_t val_83168);
FUTHARK_FUN_ATTR int futrts_entry_add_next_partition_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86823, struct memblock_device *mem_out_p_86824, struct memblock_device *mem_out_p_86825, struct memblock_device *mem_out_p_86826, struct memblock_device *mem_out_p_86827, struct memblock_device *mem_out_p_86828, struct memblock_device *mem_out_p_86829, struct memblock_device *mem_out_p_86830, struct memblock_device *mem_out_p_86831, struct memblock_device *mem_out_p_86832, struct memblock_device *mem_out_p_86833, struct memblock_device *mem_out_p_86834, struct memblock_device *mem_out_p_86835, struct memblock_device *mem_out_p_86836, struct memblock_device *mem_out_p_86837, struct memblock_device *mem_out_p_86838, struct memblock_device *mem_out_p_86839, struct memblock_device *mem_out_p_86840, struct memblock_device *mem_out_p_86841, struct memblock_device *mem_out_p_86842, struct memblock_device *mem_out_p_86843, struct memblock_device *mem_out_p_86844, struct memblock_device *mem_out_p_86845, struct memblock_device *mem_out_p_86846, struct memblock_device *mem_out_p_86847, int64_t *out_prim_out_86848, int64_t *out_prim_out_86849, int64_t *out_prim_out_86850, int8_t *out_prim_out_86851, int8_t *out_prim_out_86852, double *out_prim_out_86853, int64_t *out_prim_out_86854, int64_t *out_prim_out_86855, double *out_prim_out_86856, int64_t *out_prim_out_86857, int64_t *out_prim_out_86858, int64_t *out_prim_out_86859, int64_t *out_prim_out_86860, int64_t *out_prim_out_86861, int64_t *out_prim_out_86862, int64_t *out_prim_out_86863, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, struct memblock_device new_xs_mem_81952, struct memblock_device new_ys_mem_81953, int64_t n_old_36753, int64_t part_no_36754, int64_t dz2084U_36755, int64_t dz2080U_36756, int64_t dz2081U_36757, int64_t dz2082U_36758, int64_t dz2083U_36759, int64_t dz2085U_36760, int64_t dz2086U_36761, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36767, int64_t clBase_36768, int64_t clBase_36770, double clBase_36773, int64_t clBase_36775, int64_t clProc_36780, int64_t clProc_36781, int64_t clProc_36782, int64_t clProc_36784, int64_t clProc_36785, int64_t current_partition_36797, int64_t new_id_36801);
FUTHARK_FUN_ATTR int futrts_entry_do_DBSCAN_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86869, struct memblock_device *mem_out_p_86870, struct memblock_device *mem_out_p_86871, struct memblock_device *mem_out_p_86872, struct memblock_device *mem_out_p_86873, struct memblock_device *mem_out_p_86874, struct memblock_device *mem_out_p_86875, struct memblock_device *mem_out_p_86876, struct memblock_device *mem_out_p_86877, struct memblock_device *mem_out_p_86878, struct memblock_device *mem_out_p_86879, struct memblock_device *mem_out_p_86880, struct memblock_device *mem_out_p_86881, struct memblock_device *mem_out_p_86882, struct memblock_device *mem_out_p_86883, struct memblock_device *mem_out_p_86884, struct memblock_device *mem_out_p_86885, struct memblock_device *mem_out_p_86886, struct memblock_device *mem_out_p_86887, struct memblock_device *mem_out_p_86888, struct memblock_device *mem_out_p_86889, struct memblock_device *mem_out_p_86890, struct memblock_device *mem_out_p_86891, struct memblock_device *mem_out_p_86892, struct memblock_device *mem_out_p_86893, int64_t *out_prim_out_86894, int8_t *out_prim_out_86895, int8_t *out_prim_out_86896, double *out_prim_out_86897, int64_t *out_prim_out_86898, int64_t *out_prim_out_86899, double *out_prim_out_86900, int64_t *out_prim_out_86901, int64_t *out_prim_out_86902, int64_t *out_prim_out_86903, int64_t *out_prim_out_86904, int64_t *out_prim_out_86905, int64_t *out_prim_out_86906, int64_t *out_prim_out_86907, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_48679, int64_t part_no_48680, int64_t dz2084U_48681, int64_t dz2080U_48682, int64_t dz2081U_48683, int64_t dz2082U_48684, int64_t dz2083U_48685, int64_t dz2085U_48686, int64_t dz2086U_48687, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, int64_t clBase_48693, int64_t clBase_48695, double clBase_48698, int64_t clBase_48700, int64_t clProc_48705, int64_t clProc_48706, int64_t clProc_48707, int64_t clProc_48709, int64_t clProc_48710, int64_t current_partition_48722, int64_t gather_psizze_48726, bool compact_list_48727);
FUTHARK_FUN_ATTR int futrts_entry_flush_dat_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86944, struct memblock_device *mem_out_p_86945, struct memblock_device *mem_out_p_86946, int64_t *out_prim_out_86947, int64_t *out_prim_out_86948, int64_t *out_prim_out_86949, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_37051, int64_t part_no_37052, int64_t dz2084U_37053, int64_t dz2080U_37054, int64_t dz2081U_37055, int64_t dz2082U_37056, int64_t dz2083U_37057, int64_t dz2085U_37058, int64_t dz2086U_37059, int8_t clBase_37062, int8_t clBase_37063, double clBase_37064, int64_t clBase_37065, int64_t clBase_37067, double clBase_37070, int64_t clBase_37072, int64_t clProc_37077, int64_t clProc_37078, int64_t clProc_37079, int64_t clProc_37081, int64_t clProc_37082, int64_t current_partition_37094, bool total_37098);
FUTHARK_FUN_ATTR int futrts_entry_make_collisions_compact_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86950, struct memblock_device *mem_out_p_86951, int64_t *out_prim_out_86952, int64_t *out_prim_out_86953, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_51540, int64_t part_no_51541, int64_t dz2084U_51542, int64_t dz2080U_51543, int64_t dz2081U_51544, int64_t dz2082U_51545, int64_t dz2083U_51546, int64_t dz2085U_51547, int64_t dz2086U_51548, int8_t clBase_51551, int8_t clBase_51552, double clBase_51553, int64_t clBase_51554, int64_t clBase_51556, double clBase_51559, int64_t clBase_51561, int64_t clProc_51566, int64_t clProc_51567, int64_t clProc_51568, int64_t clProc_51570, int64_t clProc_51571, int64_t current_partition_51583);
FUTHARK_FUN_ATTR int futrts_entry_mk_dbcHandler_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86957, struct memblock_device *mem_out_p_86958, struct memblock_device *mem_out_p_86959, struct memblock_device *mem_out_p_86960, struct memblock_device *mem_out_p_86961, struct memblock_device *mem_out_p_86962, struct memblock_device *mem_out_p_86963, struct memblock_device *mem_out_p_86964, struct memblock_device *mem_out_p_86965, struct memblock_device *mem_out_p_86966, struct memblock_device *mem_out_p_86967, struct memblock_device *mem_out_p_86968, struct memblock_device *mem_out_p_86969, struct memblock_device *mem_out_p_86970, struct memblock_device *mem_out_p_86971, struct memblock_device *mem_out_p_86972, struct memblock_device *mem_out_p_86973, struct memblock_device *mem_out_p_86974, struct memblock_device *mem_out_p_86975, struct memblock_device *mem_out_p_86976, struct memblock_device *mem_out_p_86977, struct memblock_device *mem_out_p_86978, struct memblock_device *mem_out_p_86979, struct memblock_device *mem_out_p_86980, struct memblock_device *mem_out_p_86981, int64_t *out_prim_out_86982, int8_t *out_prim_out_86983, int8_t *out_prim_out_86984, double *out_prim_out_86985, int64_t *out_prim_out_86986, int64_t *out_prim_out_86987, double *out_prim_out_86988, int64_t *out_prim_out_86989, int64_t *out_prim_out_86990, int64_t *out_prim_out_86991, int64_t *out_prim_out_86992, int64_t *out_prim_out_86993, int64_t *out_prim_out_86994, int64_t *out_prim_out_86995, double min_x_31083, double min_y_31084, double max_x_31085, double max_y_31086, int64_t parts_x_31087, int64_t parts_y_31088, bool isEuclidean_31089, bool isRadians_31090, double radius_31091, double eps_31092, int64_t minPts_31093, int64_t m_sizze_31094);
FUTHARK_FUN_ATTR int futrts_entry_next_partition_to_read_double(struct futhark_context *ctx, int64_t *out_prim_out_86996, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_31684, int64_t part_no_31685, int64_t dz2084U_31686, int64_t dz2080U_31687, int64_t dz2081U_31688, int64_t dz2082U_31689, int64_t dz2083U_31690, int64_t dz2085U_31691, int64_t dz2086U_31692, int8_t clBase_31695, int8_t clBase_31696, double clBase_31697, int64_t clBase_31698, int64_t clBase_31700, double clBase_31703, int64_t clBase_31705, int64_t clProc_31710, int64_t clProc_31711, int64_t clProc_31712, int64_t clProc_31714, int64_t clProc_31715, int64_t current_partition_31727);
FUTHARK_FUN_ATTR int futrts_entry_rectify_cluster_ids_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_87000, struct memblock_device chain_ids_mem_81927, struct memblock_device chain_id_mem_81928, struct memblock_device replaceWith_mem_81929, int64_t n_51920, int64_t dz2081Uz2080U_51921, int64_t dz2081Uz2081U_51922, int64_t ncc_51925, int64_t gather_psizze_51927);
FUTHARK_FUN_ATTR int futrts_get_num_neighbours_against_11932(struct futhark_context *ctx, struct memblock_device *mem_out_p_87001, struct memblock_device dat1_mem_81927, struct memblock_device dat1_mem_81928, struct memblock_device dat2_mem_81929, struct memblock_device dat2_mem_81930, int64_t n1_37899, int64_t n2_37900, double eps_37905, int8_t dist_t_37906, int8_t angle_t_37907, double radius_37908, int64_t m_sizze_37909);
FUTHARK_FUN_ATTR int futrts_get_num_neighbours_against_11935(struct futhark_context *ctx, struct memblock_device *mem_out_p_87002, struct memblock_device dat1_mem_81927, struct memblock_device dat1_mem_81928, struct memblock_device dat2_mem_81929, struct memblock_device dat2_mem_81930, int64_t n1_38160, int64_t n2_38161, double eps_38166, int8_t dist_t_38167, int8_t angle_t_38168, double radius_38169, int64_t m_sizze_38170);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_11636(struct futhark_context *ctx, bool *out_prim_out_87003, int64_t c1_48767, int64_t p1_48768, int64_t c2_48769, int64_t p2_48770);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_11537(struct futhark_context *ctx, int64_t *out_prim_out_87004, int64_t *out_prim_out_87005, int64_t *out_prim_out_87006, int64_t *out_prim_out_87007, int64_t *out_prim_out_87008, int64_t slo_49016, int64_t shi_49017, int64_t tlo_49018, int64_t thi_49019, int64_t count_49020);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define counters_mem_83127 (ctx->constants->counters_mem_83127)
    #define counters_mem_83131 (ctx->constants->counters_mem_83131)
    #define counters_mem_83201 (ctx->constants->counters_mem_83201)
    #define counters_mem_83624 (ctx->constants->counters_mem_83624)
    #define counters_mem_84155 (ctx->constants->counters_mem_84155)
    #define counters_mem_84329 (ctx->constants->counters_mem_84329)
    #define counters_mem_84504 (ctx->constants->counters_mem_84504)
    #define counters_mem_84929 (ctx->constants->counters_mem_84929)
    #define counters_mem_85210 (ctx->constants->counters_mem_85210)
    #define counters_mem_85249 (ctx->constants->counters_mem_85249)
    #define counters_mem_86537 (ctx->constants->counters_mem_86537)
    #define counters_mem_86668 (ctx->constants->counters_mem_86668)
    #define counters_mem_86747 (ctx->constants->counters_mem_86747)
    #define counters_mem_86782 (ctx->constants->counters_mem_86782)
    #define global_dynid_mem_83190 (ctx->constants->global_dynid_mem_83190)
    #define global_dynid_mem_83200 (ctx->constants->global_dynid_mem_83200)
    #define global_dynid_mem_83213 (ctx->constants->global_dynid_mem_83213)
    #define global_dynid_mem_83380 (ctx->constants->global_dynid_mem_83380)
    #define global_dynid_mem_83445 (ctx->constants->global_dynid_mem_83445)
    #define global_dynid_mem_83500 (ctx->constants->global_dynid_mem_83500)
    #define global_dynid_mem_83622 (ctx->constants->global_dynid_mem_83622)
    #define global_dynid_mem_83663 (ctx->constants->global_dynid_mem_83663)
    #define global_dynid_mem_83686 (ctx->constants->global_dynid_mem_83686)
    #define global_dynid_mem_83781 (ctx->constants->global_dynid_mem_83781)
    #define global_dynid_mem_83802 (ctx->constants->global_dynid_mem_83802)
    #define global_dynid_mem_83908 (ctx->constants->global_dynid_mem_83908)
    #define global_dynid_mem_83918 (ctx->constants->global_dynid_mem_83918)
    #define global_dynid_mem_84062 (ctx->constants->global_dynid_mem_84062)
    #define global_dynid_mem_84380 (ctx->constants->global_dynid_mem_84380)
    #define global_dynid_mem_84551 (ctx->constants->global_dynid_mem_84551)
    #define global_dynid_mem_84654 (ctx->constants->global_dynid_mem_84654)
    #define global_dynid_mem_84766 (ctx->constants->global_dynid_mem_84766)
    #define global_dynid_mem_84980 (ctx->constants->global_dynid_mem_84980)
    #define global_dynid_mem_85296 (ctx->constants->global_dynid_mem_85296)
    #define global_dynid_mem_85417 (ctx->constants->global_dynid_mem_85417)
    #define global_dynid_mem_85535 (ctx->constants->global_dynid_mem_85535)
    #define global_dynid_mem_85691 (ctx->constants->global_dynid_mem_85691)
    #define global_dynid_mem_85809 (ctx->constants->global_dynid_mem_85809)
    #define global_dynid_mem_85958 (ctx->constants->global_dynid_mem_85958)
    #define global_dynid_mem_86076 (ctx->constants->global_dynid_mem_86076)
    #define global_dynid_mem_86232 (ctx->constants->global_dynid_mem_86232)
    #define global_dynid_mem_86335 (ctx->constants->global_dynid_mem_86335)
    counters_mem_83127.references = NULL;
    counters_mem_83131.references = NULL;
    counters_mem_83201.references = NULL;
    counters_mem_83624.references = NULL;
    counters_mem_84155.references = NULL;
    counters_mem_84329.references = NULL;
    counters_mem_84504.references = NULL;
    counters_mem_84929.references = NULL;
    counters_mem_85210.references = NULL;
    counters_mem_85249.references = NULL;
    counters_mem_86537.references = NULL;
    counters_mem_86668.references = NULL;
    counters_mem_86747.references = NULL;
    counters_mem_86782.references = NULL;
    global_dynid_mem_83190.references = NULL;
    global_dynid_mem_83200.references = NULL;
    global_dynid_mem_83213.references = NULL;
    global_dynid_mem_83380.references = NULL;
    global_dynid_mem_83445.references = NULL;
    global_dynid_mem_83500.references = NULL;
    global_dynid_mem_83622.references = NULL;
    global_dynid_mem_83663.references = NULL;
    global_dynid_mem_83686.references = NULL;
    global_dynid_mem_83781.references = NULL;
    global_dynid_mem_83802.references = NULL;
    global_dynid_mem_83908.references = NULL;
    global_dynid_mem_83918.references = NULL;
    global_dynid_mem_84062.references = NULL;
    global_dynid_mem_84380.references = NULL;
    global_dynid_mem_84551.references = NULL;
    global_dynid_mem_84654.references = NULL;
    global_dynid_mem_84766.references = NULL;
    global_dynid_mem_84980.references = NULL;
    global_dynid_mem_85296.references = NULL;
    global_dynid_mem_85417.references = NULL;
    global_dynid_mem_85535.references = NULL;
    global_dynid_mem_85691.references = NULL;
    global_dynid_mem_85809.references = NULL;
    global_dynid_mem_85958.references = NULL;
    global_dynid_mem_86076.references = NULL;
    global_dynid_mem_86232.references = NULL;
    global_dynid_mem_86335.references = NULL;
    if (memblock_alloc_device(ctx, &counters_mem_83127, (int64_t) 80, "counters_mem_83127")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_83127, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83213, (int64_t) 4, "global_dynid_mem_83213")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83213, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83200, (int64_t) 4, "global_dynid_mem_83200")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83200, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83445, (int64_t) 4, "global_dynid_mem_83445")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83445, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_83624, (int64_t) 81920, "counters_mem_83624")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_83624, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83686, (int64_t) 4, "global_dynid_mem_83686")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83686, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83802, (int64_t) 4, "global_dynid_mem_83802")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83802, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83908, (int64_t) 4, "global_dynid_mem_83908")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83908, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_84155, (int64_t) 81920, "counters_mem_84155")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_84155, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_83131, (int64_t) 80, "counters_mem_83131")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_83131, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83622, (int64_t) 4, "global_dynid_mem_83622")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83622, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_83201, (int64_t) 81920, "counters_mem_83201")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_83201, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_83201, (int64_t) 81920, "counters_mem_83201")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_83201, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83190, (int64_t) 4, "global_dynid_mem_83190")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83190, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83380, (int64_t) 4, "global_dynid_mem_83380")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83380, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83500, (int64_t) 4, "global_dynid_mem_83500")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83500, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83663, (int64_t) 4, "global_dynid_mem_83663")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83663, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83781, (int64_t) 4, "global_dynid_mem_83781")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83781, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_83918, (int64_t) 4, "global_dynid_mem_83918")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_83918, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84062, (int64_t) 4, "global_dynid_mem_84062")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84062, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_84329, (int64_t) 81920, "counters_mem_84329")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_84329, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84380, (int64_t) 4, "global_dynid_mem_84380")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84380, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_84504, (int64_t) 80, "counters_mem_84504")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_84504, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84551, (int64_t) 4, "global_dynid_mem_84551")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84551, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84654, (int64_t) 4, "global_dynid_mem_84654")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84654, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84766, (int64_t) 4, "global_dynid_mem_84766")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84766, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_84929, (int64_t) 80, "counters_mem_84929")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_84929, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_84980, (int64_t) 4, "global_dynid_mem_84980")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_84980, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_85210, (int64_t) 81920, "counters_mem_85210")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_85210, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_85249, (int64_t) 80, "counters_mem_85249")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_85249, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85296, (int64_t) 4, "global_dynid_mem_85296")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85296, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85417, (int64_t) 4, "global_dynid_mem_85417")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85417, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85535, (int64_t) 4, "global_dynid_mem_85535")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85535, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85691, (int64_t) 4, "global_dynid_mem_85691")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85691, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85809, (int64_t) 4, "global_dynid_mem_85809")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85809, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_85958, (int64_t) 4, "global_dynid_mem_85958")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_85958, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_86076, (int64_t) 4, "global_dynid_mem_86076")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_86076, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_86232, (int64_t) 4, "global_dynid_mem_86232")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_86232, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_86335, (int64_t) 4, "global_dynid_mem_86335")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_86335, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_86537, (int64_t) 81920, "counters_mem_86537")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_86537, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_86668, (int64_t) 81920, "counters_mem_86668")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_86668, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_86747, (int64_t) 80, "counters_mem_86747")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_86747, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_86782, (int64_t) 80, "counters_mem_86782")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_86782, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    #undef counters_mem_83127
    #undef counters_mem_83131
    #undef counters_mem_83201
    #undef counters_mem_83624
    #undef counters_mem_84155
    #undef counters_mem_84329
    #undef counters_mem_84504
    #undef counters_mem_84929
    #undef counters_mem_85210
    #undef counters_mem_85249
    #undef counters_mem_86537
    #undef counters_mem_86668
    #undef counters_mem_86747
    #undef counters_mem_86782
    #undef global_dynid_mem_83190
    #undef global_dynid_mem_83200
    #undef global_dynid_mem_83213
    #undef global_dynid_mem_83380
    #undef global_dynid_mem_83445
    #undef global_dynid_mem_83500
    #undef global_dynid_mem_83622
    #undef global_dynid_mem_83663
    #undef global_dynid_mem_83686
    #undef global_dynid_mem_83781
    #undef global_dynid_mem_83802
    #undef global_dynid_mem_83908
    #undef global_dynid_mem_83918
    #undef global_dynid_mem_84062
    #undef global_dynid_mem_84380
    #undef global_dynid_mem_84551
    #undef global_dynid_mem_84654
    #undef global_dynid_mem_84766
    #undef global_dynid_mem_84980
    #undef global_dynid_mem_85296
    #undef global_dynid_mem_85417
    #undef global_dynid_mem_85535
    #undef global_dynid_mem_85691
    #undef global_dynid_mem_85809
    #undef global_dynid_mem_85958
    #undef global_dynid_mem_86076
    #undef global_dynid_mem_86232
    #undef global_dynid_mem_86335
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_83127, "ctx->constants->counters_mem_83127") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_83131, "ctx->constants->counters_mem_83131") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_83201, "ctx->constants->counters_mem_83201") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_83624, "ctx->constants->counters_mem_83624") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_84155, "ctx->constants->counters_mem_84155") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_84329, "ctx->constants->counters_mem_84329") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_84504, "ctx->constants->counters_mem_84504") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_84929, "ctx->constants->counters_mem_84929") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_85210, "ctx->constants->counters_mem_85210") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_85249, "ctx->constants->counters_mem_85249") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_86537, "ctx->constants->counters_mem_86537") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_86668, "ctx->constants->counters_mem_86668") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_86747, "ctx->constants->counters_mem_86747") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_86782, "ctx->constants->counters_mem_86782") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83190, "ctx->constants->global_dynid_mem_83190") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83200, "ctx->constants->global_dynid_mem_83200") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83213, "ctx->constants->global_dynid_mem_83213") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83380, "ctx->constants->global_dynid_mem_83380") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83445, "ctx->constants->global_dynid_mem_83445") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83500, "ctx->constants->global_dynid_mem_83500") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83622, "ctx->constants->global_dynid_mem_83622") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83663, "ctx->constants->global_dynid_mem_83663") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83686, "ctx->constants->global_dynid_mem_83686") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83781, "ctx->constants->global_dynid_mem_83781") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83802, "ctx->constants->global_dynid_mem_83802") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83908, "ctx->constants->global_dynid_mem_83908") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_83918, "ctx->constants->global_dynid_mem_83918") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84062, "ctx->constants->global_dynid_mem_84062") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84380, "ctx->constants->global_dynid_mem_84380") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84551, "ctx->constants->global_dynid_mem_84551") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84654, "ctx->constants->global_dynid_mem_84654") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84766, "ctx->constants->global_dynid_mem_84766") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_84980, "ctx->constants->global_dynid_mem_84980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85296, "ctx->constants->global_dynid_mem_85296") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85417, "ctx->constants->global_dynid_mem_85417") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85535, "ctx->constants->global_dynid_mem_85535") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85691, "ctx->constants->global_dynid_mem_85691") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85809, "ctx->constants->global_dynid_mem_85809") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_85958, "ctx->constants->global_dynid_mem_85958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_86076, "ctx->constants->global_dynid_mem_86076") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_86232, "ctx->constants->global_dynid_mem_86232") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_86335, "ctx->constants->global_dynid_mem_86335") != 0)
        return 1;
    return 0;
}
static int gpu_kernel_builtinzhiota_i64ziiota_i64_83304(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_83304, "builtin#iota_i64.iota_i64_83304", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_boolzireplicate_84474(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_boolzireplicate_84474, "builtin#replicate_bool.replicate_84474", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f64zireplicate_83380(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f64zireplicate_83380, "builtin#replicate_f64.replicate_83380", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i32zireplicate_83197(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int32_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_83197, "builtin#replicate_i32.replicate_83197", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i64zireplicate_83337(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_83337, "builtin#replicate_i64.replicate_83337", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i8zireplicate_83171(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_83171, "builtin#replicate_i8.replicate_83171", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegscan_70736(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_70736, "add_next_partition_double.segscan_70736", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_70738(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70738, "add_next_partition_double.segmap_70738", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83369(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83369, "add_next_partition_double.gpuseq_83369", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83395(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83395, "add_next_partition_double.gpuseq_83395", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83401, "add_next_partition_double.gpuseq_83401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83407(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83407, "add_next_partition_double.gpuseq_83407", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83413(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83413, "add_next_partition_double.gpuseq_83413", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83419(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83419, "add_next_partition_double.gpuseq_83419", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezigpuseq_83426(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezigpuseq_83426, "add_next_partition_double.gpuseq_83426", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_intrablock_78070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int8_t arg3, int8_t arg4, double arg5, double arg6, int64_t arg7, int64_t arg8, bool arg9, int64_t arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[25] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21};
        size_t args_sizes[25] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_78070, "add_next_partition_double.segmap_intrablock_78070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 25, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_intrablock_68780(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int8_t arg3, int8_t arg4, double arg5, double arg6, int64_t arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_68780, "add_next_partition_double.segmap_intrablock_68780", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_69035(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69035, "add_next_partition_double.segmap_69035", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegred_small_69051(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegred_small_69051, "add_next_partition_double.segred_small_69051", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegred_large_69051(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegred_large_69051, "add_next_partition_double.segred_large_69051", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_69064(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int8_t arg2, double arg3, double arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[17] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[17] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69064, "add_next_partition_double.segmap_69064", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 17, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegscan_69309(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_69309, "add_next_partition_double.segscan_69309", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_69319(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69319, "add_next_partition_double.segmap_69319", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegscan_69333(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[18] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[18] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_69333, "add_next_partition_double.segscan_69333", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 18, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegscan_70752(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int8_t arg2, int8_t arg3, double arg4, double arg5, int64_t arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26, gpu_mem arg27, gpu_mem arg28, gpu_mem arg29, gpu_mem arg30, gpu_mem arg31)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[35] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26, &arg27, &arg28, &arg29, &arg30, &arg31};
        size_t args_sizes[35] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26), sizeof(arg27), sizeof(arg28), sizeof(arg29), sizeof(arg30), sizeof(arg31)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegscan_70752, "add_next_partition_double.segscan_70752", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 35, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_69335(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_69335, "add_next_partition_double.segmap_69335", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_intrablock_78474(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int8_t arg2, double arg3, double arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_intrablock_78474, "add_next_partition_double.segmap_intrablock_78474", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegred_small_70044(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int8_t arg2, double arg3, double arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[17] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[17] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegred_small_70044, "add_next_partition_double.segred_small_70044", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 17, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegred_large_70044(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int8_t arg2, double arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegred_large_70044, "add_next_partition_double.segred_large_70044", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_70504(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int8_t arg2, double arg3, double arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70504, "add_next_partition_double.segmap_70504", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_70754(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70754, "add_next_partition_double.segmap_70754", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_70807(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[23] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[23] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70807, "add_next_partition_double.segmap_70807", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 23, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_add_next_partition_doublezisegmap_70875(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[20] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[20] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->add_next_partition_doublezisegmap_70875, "add_next_partition_double.segmap_70875", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 20, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75082(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75082, "do_DBSCAN_double.segscan_75082", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75084(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75084, "do_DBSCAN_double.segmap_75084", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezigpuseq_83355(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_83355, "do_DBSCAN_double.gpuseq_83355", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezigpuseq_83361(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_83361, "do_DBSCAN_double.gpuseq_83361", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75098(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int8_t arg3, int8_t arg4, double arg5, double arg6, int64_t arg7, double arg8, double arg9, double arg10, double arg11, double arg12, double arg13, int64_t arg14, int64_t arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26, gpu_mem arg27, gpu_mem arg28, gpu_mem arg29, gpu_mem arg30, gpu_mem arg31)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[35] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26, &arg27, &arg28, &arg29, &arg30, &arg31};
        size_t args_sizes[35] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26), sizeof(arg27), sizeof(arg28), sizeof(arg29), sizeof(arg30), sizeof(arg31)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75098, "do_DBSCAN_double.segscan_75098", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 35, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75100(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75100, "do_DBSCAN_double.segmap_75100", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75114(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, double arg6, double arg7, double arg8, double arg9, double arg10, double arg11, int64_t arg12, int64_t arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26, gpu_mem arg27, gpu_mem arg28)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[30] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26, &arg27, &arg28};
        size_t args_sizes[30] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26), sizeof(arg27), sizeof(arg28)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75114, "do_DBSCAN_double.segscan_75114", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 30, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75116(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[18] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[18] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75116, "do_DBSCAN_double.segmap_75116", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 18, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75130(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75130, "do_DBSCAN_double.segscan_75130", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75132(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75132, "do_DBSCAN_double.segmap_75132", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75146(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75146, "do_DBSCAN_double.segscan_75146", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75148(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75148, "do_DBSCAN_double.segmap_75148", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75156(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75156, "do_DBSCAN_double.segmap_75156", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75181(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75181, "do_DBSCAN_double.segmap_75181", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75194(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75194, "do_DBSCAN_double.segscan_75194", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75196(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75196, "do_DBSCAN_double.segmap_75196", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75356(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75356, "do_DBSCAN_double.segmap_75356", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75377(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, bool arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75377, "do_DBSCAN_double.segmap_75377", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75433(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75433, "do_DBSCAN_double.segscan_75433", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezireplicate_84152(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[7] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezireplicate_84152, "do_DBSCAN_double.replicate_84152", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezireplicate_84172(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[7] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezireplicate_84172, "do_DBSCAN_double.replicate_84172", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75435(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75435, "do_DBSCAN_double.segmap_75435", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doubleziseghist_local_75451(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int32_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, int32_t arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doubleziseghist_local_75451, "do_DBSCAN_double.seghist_local_75451", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doubleziseghist_global_75451(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doubleziseghist_global_75451, "do_DBSCAN_double.seghist_global_75451", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_small_84292(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_84292, "do_DBSCAN_double.segred_small_84292", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_large_84292(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_84292, "do_DBSCAN_double.segred_large_84292", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75465(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75465, "do_DBSCAN_double.segscan_75465", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75467(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75467, "do_DBSCAN_double.segmap_75467", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75483(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75483, "do_DBSCAN_double.segred_nonseg_75483", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75499(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75499, "do_DBSCAN_double.segscan_75499", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75534(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75534, "do_DBSCAN_double.segscan_75534", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75491(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75491, "do_DBSCAN_double.segscan_75491", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75501(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75501, "do_DBSCAN_double.segmap_75501", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75518(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75518, "do_DBSCAN_double.segred_nonseg_75518", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75526(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75526, "do_DBSCAN_double.segscan_75526", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75536(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75536, "do_DBSCAN_double.segmap_75536", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, bool arg13, int64_t arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[24] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22};
        size_t args_sizes[24] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78070, "do_DBSCAN_double.segmap_intrablock_78070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 24, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75750(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75750, "do_DBSCAN_double.segmap_75750", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_small_75768(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[24] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22};
        size_t args_sizes[24] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_75768, "do_DBSCAN_double.segred_small_75768", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 24, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_large_75768(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, int64_t arg12, int64_t arg13, int64_t arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26, gpu_mem arg27)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[29] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26, &arg27};
        size_t args_sizes[29] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26), sizeof(arg27)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_75768, "do_DBSCAN_double.segred_large_75768", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 29, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75826(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_75826, "do_DBSCAN_double.segred_nonseg_75826", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75834(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75834, "do_DBSCAN_double.segscan_75834", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75854, "do_DBSCAN_double.segmap_75854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75887(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75887, "do_DBSCAN_double.segmap_75887", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_75908(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_75908, "do_DBSCAN_double.segscan_75908", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_75910(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_75910, "do_DBSCAN_double.segmap_75910", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78490(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78490, "do_DBSCAN_double.segmap_intrablock_78490", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78845(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_78845, "do_DBSCAN_double.segmap_intrablock_78845", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_76315(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_76315, "do_DBSCAN_double.segscan_76315", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_76323(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_76323, "do_DBSCAN_double.segmap_76323", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79200(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79200, "do_DBSCAN_double.segmap_intrablock_79200", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79483(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79483, "do_DBSCAN_double.segmap_intrablock_79483", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_76628(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_76628, "do_DBSCAN_double.segscan_76628", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_76637(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_76637, "do_DBSCAN_double.segmap_76637", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79766(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_79766, "do_DBSCAN_double.segmap_intrablock_79766", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80148(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80148, "do_DBSCAN_double.segmap_intrablock_80148", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_77081(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_77081, "do_DBSCAN_double.segscan_77081", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegscan_77103(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, double arg9, double arg10, double arg11, double arg12, double arg13, double arg14, int64_t arg15, int64_t arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26, gpu_mem arg27, gpu_mem arg28, gpu_mem arg29, gpu_mem arg30, gpu_mem arg31, gpu_mem arg32, gpu_mem arg33, gpu_mem arg34, gpu_mem arg35, gpu_mem arg36)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[40] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26, &arg27, &arg28, &arg29, &arg30, &arg31, &arg32, &arg33, &arg34, &arg35, &arg36};
        size_t args_sizes[40] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26), sizeof(arg27), sizeof(arg28), sizeof(arg29), sizeof(arg30), sizeof(arg31), sizeof(arg32), sizeof(arg33), sizeof(arg34), sizeof(arg35), sizeof(arg36)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegscan_77103, "do_DBSCAN_double.segscan_77103", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 40, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77089(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77089, "do_DBSCAN_double.segmap_77089", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77105(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77105, "do_DBSCAN_double.segmap_77105", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80530(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80530, "do_DBSCAN_double.segmap_intrablock_80530", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77340(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77340, "do_DBSCAN_double.segmap_77340", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_small_77359(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_77359, "do_DBSCAN_double.segred_small_77359", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_large_77359(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[27] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25};
        size_t args_sizes[27] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_77359, "do_DBSCAN_double.segred_large_77359", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 27, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80971(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_intrablock_80971, "do_DBSCAN_double.segmap_intrablock_80971", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77642(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77642, "do_DBSCAN_double.segmap_77642", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_small_77661(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_small_77661, "do_DBSCAN_double.segred_small_77661", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_large_77661(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int8_t arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[27] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25};
        size_t args_sizes[27] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_large_77661, "do_DBSCAN_double.segred_large_77661", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 27, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77717(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77717, "do_DBSCAN_double.segmap_77717", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegmap_77725(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegmap_77725, "do_DBSCAN_double.segmap_77725", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_nonseg_77741(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_77741, "do_DBSCAN_double.segred_nonseg_77741", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezisegred_nonseg_77751(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezisegred_nonseg_77751, "do_DBSCAN_double.segred_nonseg_77751", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_do_DBSCAN_doublezigpuseq_86817(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->do_DBSCAN_doublezigpuseq_86817, "do_DBSCAN_double.gpuseq_86817", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegred_nonseg_70910(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegred_nonseg_70910, "make_collisions_compact_double.segred_nonseg_70910", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezigpuseq_83217(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezigpuseq_83217, "make_collisions_compact_double.gpuseq_83217", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_71189(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_71189, "make_collisions_compact_double.segmap_71189", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_71214(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_71214, "make_collisions_compact_double.segmap_71214", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_intrablock_71523(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, int64_t arg6, bool arg7, bool arg8, bool arg9, int64_t arg10, int64_t arg11, int64_t arg12, bool arg13, int64_t arg14, int64_t arg15, int64_t arg16, int64_t arg17, int64_t arg18, int64_t arg19, int64_t arg20, int32_t arg21, int32_t arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25, gpu_mem arg26)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[30] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25, &arg26};
        size_t args_sizes[30] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25), sizeof(arg26)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_intrablock_71523, "make_collisions_compact_double.segmap_intrablock_71523", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 30, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_73717(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, bool arg2, int64_t arg3, int64_t arg4, bool arg5, bool arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73717, "make_collisions_compact_double.segmap_73717", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_73746(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73746, "make_collisions_compact_double.segmap_73746", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezireplicate_83380(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[7] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83380, "make_collisions_compact_double.replicate_83380", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezireplicate_83400(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[7] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83400, "make_collisions_compact_double.replicate_83400", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_73770(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[17] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[17] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_73770, "make_collisions_compact_double.segmap_73770", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 17, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_intrablock_73841(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, int32_t arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[23] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[23] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_intrablock_73841, "make_collisions_compact_double.segmap_intrablock_73841", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 23, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_74095(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74095, "make_collisions_compact_double.segmap_74095", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_74218(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74218, "make_collisions_compact_double.segmap_74218", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezireplicate_83523(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[8] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83523, "make_collisions_compact_double.replicate_83523", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezireplicate_83546(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[8] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezireplicate_83546, "make_collisions_compact_double.replicate_83546", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_74293(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int32_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[24] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20};
        size_t args_sizes[24] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74293, "make_collisions_compact_double.segmap_74293", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 24, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegscan_74390(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegscan_74390, "make_collisions_compact_double.segscan_74390", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_collisions_compact_doublezisegmap_74392(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_collisions_compact_doublezisegmap_74392, "make_collisions_compact_double.segmap_74392", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_mk_dbcHandler_doublezigpuseq_83216(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, double arg0, double arg1, double arg2, double arg3, int64_t arg4, int64_t arg5, double arg6, double arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[17] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[17] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->mk_dbcHandler_doublezigpuseq_83216, "mk_dbcHandler_double.gpuseq_83216", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 17, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_next_partition_to_read_doublezigpuseq_83120(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->next_partition_to_read_doublezigpuseq_83120, "next_partition_to_read_double.gpuseq_83120", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_next_partition_to_read_doublezisegred_nonseg_66871(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->next_partition_to_read_doublezisegred_nonseg_66871, "next_partition_to_read_double.segred_nonseg_66871", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_next_partition_to_read_doublezisegscan_66879(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->next_partition_to_read_doublezisegscan_66879, "next_partition_to_read_double.segscan_66879", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_next_partition_to_read_doublezisegmap_66881(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->next_partition_to_read_doublezisegmap_66881, "next_partition_to_read_double.segmap_66881", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_next_partition_to_read_doublezigpuseq_83333(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->next_partition_to_read_doublezigpuseq_83333, "next_partition_to_read_double.gpuseq_83333", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_rectify_cluster_ids_doublezisegmap_74989(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->rectify_cluster_ids_doublezisegmap_74989, "rectify_cluster_ids_double.segmap_74989", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_rectify_cluster_ids_doublezisegmap_75061(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->rectify_cluster_ids_doublezisegmap_75061, "rectify_cluster_ids_double.segmap_75061", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11932zisegmap_intrablock_78070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[18] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[18] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegmap_intrablock_78070, "get_num_neighbours_against_11932.segmap_intrablock_78070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 18, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11932zisegmap_74600(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegmap_74600, "get_num_neighbours_against_11932.segmap_74600", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11932zisegred_small_74618(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegred_small_74618, "get_num_neighbours_against_11932.segred_small_74618", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11932zisegred_large_74618(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[24] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22};
        size_t args_sizes[24] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11932zisegred_large_74618, "get_num_neighbours_against_11932.segred_large_74618", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 24, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11935zisegmap_intrablock_78070(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, bool arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[18] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[18] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegmap_intrablock_78070, "get_num_neighbours_against_11935.segmap_intrablock_78070", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 18, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11935zisegmap_74866(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int8_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegmap_74866, "get_num_neighbours_against_11935.segmap_74866", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11935zisegred_small_74884(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegred_small_74884, "get_num_neighbours_against_11935.segred_small_74884", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_get_num_neighbours_against_11935zisegred_large_74884(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, double arg1, int8_t arg2, int8_t arg3, double arg4, int64_t arg5, int64_t arg6, int64_t arg7, bool arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[24] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22};
        size_t args_sizes[24] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22)};
        
        return gpu_launch_kernel(ctx, ctx->program->get_num_neighbours_against_11935zisegred_large_74884, "get_num_neighbours_against_11935.segred_large_74884", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 24, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_bool_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 1);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 1);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 1 * (i0 * 1), 1);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_tup2_i64_i64 {
    int64_t v0;
    int64_t v1;
};
int futhark_project_opaque_tup2_i64_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_i64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, const int64_t f_0, const int64_t f_1)
{
    struct futhark_opaque_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v->v0 = f_0;
    v->v1 = f_1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_i64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_i64_i64 *futhark_restore_opaque_tup2_i64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_i64_i64 *obj = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_i64_i64 {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_i64_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_i64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, struct futhark_opaque_arr1d_tup2_i64_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
        
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v0, 0, arr->v0->mem.mem, 8 * (i0 * 1), 8);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v1, 0, arr->v1->mem.mem, 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_i64_i64 *futhark_restore_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_i64_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_00764e1f7379f14f22282d21712a8514 {
    int8_t v0;
};
int futhark_new_opaque_00764e1f7379f14f22282d21712a8514_degrees(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out)
{
    (void) ctx;
    
    struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *v = malloc(sizeof(struct futhark_opaque_00764e1f7379f14f22282d21712a8514));
    
    v->v0 = 0;
    {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    }
    {
        { }
    }
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_destruct_opaque_00764e1f7379f14f22282d21712a8514_degrees(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj)
{
    (void) ctx;
    assert(obj->v0 == 0);
    return FUTHARK_SUCCESS;
}
int futhark_new_opaque_00764e1f7379f14f22282d21712a8514_radians(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out)
{
    (void) ctx;
    
    struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *v = malloc(sizeof(struct futhark_opaque_00764e1f7379f14f22282d21712a8514));
    
    v->v0 = 1;
    {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    }
    {
        { }
    }
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_destruct_opaque_00764e1f7379f14f22282d21712a8514_radians(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj)
{
    (void) ctx;
    assert(obj->v0 == 1);
    return FUTHARK_SUCCESS;
}
int futhark_variant_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *v)
{
    (void) ctx;
    return v->v0;
}
int futhark_free_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    
    *n = size_0;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
    }
    return ret;
}
struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *futhark_restore_opaque_00764e1f7379f14f22282d21712a8514(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *obj = malloc(sizeof(struct futhark_opaque_00764e1f7379f14f22282d21712a8514));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_5797e930517e531e6d939a24b1db07bd {
    int8_t v0;
};
int futhark_new_opaque_5797e930517e531e6d939a24b1db07bd_euclidean(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out)
{
    (void) ctx;
    
    struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *v = malloc(sizeof(struct futhark_opaque_5797e930517e531e6d939a24b1db07bd));
    
    v->v0 = 0;
    {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    }
    {
        { }
    }
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_destruct_opaque_5797e930517e531e6d939a24b1db07bd_euclidean(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj)
{
    (void) ctx;
    assert(obj->v0 == 0);
    return FUTHARK_SUCCESS;
}
int futhark_new_opaque_5797e930517e531e6d939a24b1db07bd_haversine(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out)
{
    (void) ctx;
    
    struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *v = malloc(sizeof(struct futhark_opaque_5797e930517e531e6d939a24b1db07bd));
    
    v->v0 = 1;
    {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    }
    {
        { }
    }
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_destruct_opaque_5797e930517e531e6d939a24b1db07bd_haversine(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj)
{
    (void) ctx;
    assert(obj->v0 == 1);
    return FUTHARK_SUCCESS;
}
int futhark_variant_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *v)
{
    (void) ctx;
    return v->v0;
}
int futhark_free_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    
    *n = size_0;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
    }
    return ret;
}
struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *futhark_restore_opaque_5797e930517e531e6d939a24b1db07bd(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *obj = malloc(sizeof(struct futhark_opaque_5797e930517e531e6d939a24b1db07bd));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb {
    int8_t v0;
    int8_t v1;
    double v2;
    int64_t v3;
    struct futhark_f64_1d *v4;
    int64_t v5;
    struct futhark_f64_1d *v6;
    struct futhark_i64_1d *v7;
    double v8;
    struct futhark_f64_1d *v9;
    int64_t v10;
};
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_angle_t(struct futhark_context *ctx, struct futhark_opaque_00764e1f7379f14f22282d21712a8514 **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_00764e1f7379f14f22282d21712a8514));
    v->v0 = obj->v0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_dist_t(struct futhark_context *ctx, struct futhark_opaque_5797e930517e531e6d939a24b1db07bd **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_5797e930517e531e6d939a24b1db07bd));
    v->v0 = obj->v1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_eps(struct futhark_context *ctx, double *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    double v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_m_size(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v3;
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_maxs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v4, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_minPts(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v5;
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_mins(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v6, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_part_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v7, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_radius(struct futhark_context *ctx, double *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    double v;
    
    v = obj->v8;
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_step_per_dim(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v9, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_8b7e80c3fb80a9a7700efe8e89371deb_total_partitions(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v10;
    *out = v;
    return 0;
}
int futhark_new_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb **out, const struct futhark_opaque_00764e1f7379f14f22282d21712a8514 *f_angle_t, const struct futhark_opaque_5797e930517e531e6d939a24b1db07bd *f_dist_t, const double f_eps, const int64_t f_m_sizze, const struct futhark_f64_1d *f_maxs, const int64_t f_minPts, const struct futhark_f64_1d *f_mins, const struct futhark_i64_1d *f_part_per_dim, const double f_radius, const struct futhark_f64_1d *f_step_per_dim, const int64_t f_total_partitions)
{
    struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *v = malloc(sizeof(struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = f_angle_t->v0;
    }
    {
        v->v1 = f_dist_t->v0;
    }
    v->v2 = f_eps;
    v->v3 = f_m_sizze;
    {
        v->v4 = malloc(sizeof(struct futhark_f64_1d));
        *v->v4 = *f_maxs;
        (void) (*v->v4->mem.references)++;
    }
    v->v5 = f_minPts;
    {
        v->v6 = malloc(sizeof(struct futhark_f64_1d));
        *v->v6 = *f_mins;
        (void) (*v->v6->mem.references)++;
    }
    {
        v->v7 = malloc(sizeof(struct futhark_i64_1d));
        *v->v7 = *f_part_per_dim;
        (void) (*v->v7->mem.references)++;
    }
    v->v8 = f_radius;
    {
        v->v9 = malloc(sizeof(struct futhark_f64_1d));
        *v->v9 = *f_step_per_dim;
        (void) (*v->v9->mem.references)++;
    }
    v->v10 = f_total_partitions;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v4 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v4)) != 0)
        ret = tmp;
    if (obj->v6 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v6)) != 0)
        ret = tmp;
    if (obj->v7 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v7)) != 0)
        ret = tmp;
    if (obj->v9 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v9)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    int64_t size_3 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_4 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v4)[0] * sizeof(double);
    int64_t size_5 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_6 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v6)[0] * sizeof(double);
    int64_t size_7 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v7)[0] * sizeof(int64_t);
    int64_t size_8 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    int64_t size_9 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v9)[0] * sizeof(double);
    int64_t size_10 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8 + size_9 + size_10;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v3, sizeof(obj->v3));
        out += sizeof(obj->v3);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v4), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v4, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v4)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v5, sizeof(obj->v5));
        out += sizeof(obj->v5);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v6), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v6, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v6)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v7), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v7, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v7)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v8, sizeof(obj->v8));
        out += sizeof(obj->v8);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v9), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v9, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v9)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v10, sizeof(obj->v10));
        out += sizeof(obj->v10);
    }
    return ret;
}
struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *futhark_restore_opaque_8b7e80c3fb80a9a7700efe8e89371deb(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *obj = malloc(sizeof(struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    src += sizeof(obj->v3);
    
    int64_t shape_4[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_4, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    obj->v4 = NULL;
    src += shape_4[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    src += sizeof(obj->v5);
    
    int64_t shape_6[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_6, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    obj->v6 = NULL;
    src += shape_6[0] * sizeof(double);
    
    int64_t shape_7[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_7, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    obj->v7 = NULL;
    src += shape_7[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    src += sizeof(obj->v8);
    
    int64_t shape_9[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_9, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_9 = src;
    
    obj->v9 = NULL;
    src += shape_9[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_10 = src;
    
    src += sizeof(obj->v10);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
        memcpy(&obj->v3, data_3, sizeof(obj->v3));
        obj->v4 = futhark_new_f64_1d(ctx, data_4, shape_4[0]);
        if (obj->v4 == NULL)
            err = 1;
        memcpy(&obj->v5, data_5, sizeof(obj->v5));
        obj->v6 = futhark_new_f64_1d(ctx, data_6, shape_6[0]);
        if (obj->v6 == NULL)
            err = 1;
        obj->v7 = futhark_new_i64_1d(ctx, data_7, shape_7[0]);
        if (obj->v7 == NULL)
            err = 1;
        memcpy(&obj->v8, data_8, sizeof(obj->v8));
        obj->v9 = futhark_new_f64_1d(ctx, data_9, shape_9[0]);
        if (obj->v9 == NULL)
            err = 1;
        memcpy(&obj->v10, data_10, sizeof(obj->v10));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v4 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v4)) != 0)
            ret = tmp;
        if (obj->v6 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v6)) != 0)
            ret = tmp;
        if (obj->v7 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v7)) != 0)
            ret = tmp;
        if (obj->v9 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v9)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup2_f64_f64 {
    double v0;
    double v1;
};
int futhark_project_opaque_tup2_f64_f64_0(struct futhark_context *ctx, double *out, const struct futhark_opaque_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    double v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_f64_f64_1(struct futhark_context *ctx, double *out, const struct futhark_opaque_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    double v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 **out, const double f_0, const double f_1)
{
    struct futhark_opaque_tup2_f64_f64 *v = malloc(sizeof(struct futhark_opaque_tup2_f64_f64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v->v0 = f_0;
    v->v1 = f_1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_f64_f64(struct futhark_context *ctx, const struct futhark_opaque_tup2_f64_f64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_f64_f64 *futhark_restore_opaque_tup2_f64_f64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_f64_f64 *obj = malloc(sizeof(struct futhark_opaque_tup2_f64_f64));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_f64_f64 {
    struct futhark_f64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_f64_f64_0(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_f64_f64_1(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_f64_1d *f_0, const struct futhark_f64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_f64_f64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_f64_f64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_tup2_f64_f64 **out, struct futhark_opaque_arr1d_tup2_f64_f64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_f64_f64 *v = malloc(sizeof(struct futhark_opaque_tup2_f64_f64));
        
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v0, 0, arr->v0->mem.mem, 8 * (i0 * 1), 8);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v1, 0, arr->v1->mem.mem, 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_f64_f64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_f64_f64 *futhark_restore_opaque_arr1d_tup2_f64_f64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_f64_f64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_f64_f64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 {
    struct futhark_bool_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
    struct futhark_f64_1d *v3;
    int64_t v4;
    int64_t v5;
    int64_t v6;
    struct futhark_bool_1d *v7;
    int64_t v8;
    int64_t v9;
    struct futhark_i64_1d *v10;
};
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buff_isCore(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buffered_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_buffered_pts(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_f64_f64 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_f64_f64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v2;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v3;
    (void) (*v->v1->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_chainOffs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v4;
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_cur_part_id(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v5;
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_cur_part_order(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v6;
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_isPartVisited(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v7, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_next_offs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v8;
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_offs(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v9;
    *out = v;
    return 0;
}
int futhark_project_opaque_a8fdbed66266f52db9d5a0da8b1f6763_relevantParts(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v10, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 **out, const struct futhark_bool_1d *f_buff_isCore, const struct futhark_i64_1d *f_buffered_ids, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_buffered_pts, const int64_t f_chainOffs, const int64_t f_cur_part_id, const int64_t f_cur_part_order, const struct futhark_bool_1d *f_isPartVisited, const int64_t f_next_offs, const int64_t f_offs, const struct futhark_i64_1d *f_relevantParts)
{
    struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *v = malloc(sizeof(struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_bool_1d));
        *v->v0 = *f_buff_isCore;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_buffered_ids;
        (void) (*v->v1->mem.references)++;
    }
    {
        {
            v->v2 = malloc(sizeof(*f_buffered_pts->v0));
            *v->v2 = *f_buffered_pts->v0;
            (void) (*v->v2->mem.references)++;
        }
        {
            v->v3 = malloc(sizeof(*f_buffered_pts->v1));
            *v->v3 = *f_buffered_pts->v1;
            (void) (*v->v3->mem.references)++;
        }
    }
    v->v4 = f_chainOffs;
    v->v5 = f_cur_part_id;
    v->v6 = f_cur_part_order;
    {
        v->v7 = malloc(sizeof(struct futhark_bool_1d));
        *v->v7 = *f_isPartVisited;
        (void) (*v->v7->mem.references)++;
    }
    v->v8 = f_next_offs;
    v->v9 = f_offs;
    {
        v->v10 = malloc(sizeof(struct futhark_i64_1d));
        *v->v10 = *f_relevantParts;
        (void) (*v->v10->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    if (obj->v7 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v7)) != 0)
        ret = tmp;
    if (obj->v10 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v10)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
    int64_t size_4 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_5 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_6 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_7 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v7)[0] * sizeof(bool);
    int64_t size_8 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_9 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_10 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v10)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8 + size_9 + size_10;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v4, sizeof(obj->v4));
        out += sizeof(obj->v4);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v5, sizeof(obj->v5));
        out += sizeof(obj->v5);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v6, sizeof(obj->v6));
        out += sizeof(obj->v6);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v7), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v7, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v7)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v8, sizeof(obj->v8));
        out += sizeof(obj->v8);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v9, sizeof(obj->v9));
        out += sizeof(obj->v9);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v10), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v10, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v10)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *futhark_restore_opaque_a8fdbed66266f52db9d5a0da8b1f6763(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *obj = malloc(sizeof(struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(bool);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    src += sizeof(obj->v4);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    src += sizeof(obj->v5);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    src += sizeof(obj->v6);
    
    int64_t shape_7[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_7, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    obj->v7 = NULL;
    src += shape_7[0] * sizeof(bool);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    src += sizeof(obj->v8);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_9 = src;
    
    src += sizeof(obj->v9);
    
    int64_t shape_10[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_10, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_10 = src;
    
    obj->v10 = NULL;
    src += shape_10[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_bool_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_f64_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
        memcpy(&obj->v4, data_4, sizeof(obj->v4));
        memcpy(&obj->v5, data_5, sizeof(obj->v5));
        memcpy(&obj->v6, data_6, sizeof(obj->v6));
        obj->v7 = futhark_new_bool_1d(ctx, data_7, shape_7[0]);
        if (obj->v7 == NULL)
            err = 1;
        memcpy(&obj->v8, data_8, sizeof(obj->v8));
        memcpy(&obj->v9, data_9, sizeof(obj->v9));
        obj->v10 = futhark_new_i64_1d(ctx, data_10, shape_10[0]);
        if (obj->v10 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        if (obj->v7 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v7)) != 0)
            ret = tmp;
        if (obj->v10 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v10)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_2f462154888958ab775ddc32a175f568 {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
    struct futhark_f64_1d *v2;
    struct futhark_bool_1d *v3;
    struct futhark_bool_1d *v4;
    struct futhark_bool_1d *v5;
    struct futhark_bool_1d *v6;
    struct futhark_f64_1d *v7;
    struct futhark_f64_1d *v8;
    struct futhark_i64_1d *v9;
    int64_t v10;
};
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_chain_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_dat(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_f64_f64 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_f64_f64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v1;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v2;
    (void) (*v->v1->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isCore(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v3, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isMargin(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v4, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isNeighbourVisited(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v5, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_isTightMargin(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v6, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_max_coord(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v7, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_min_coord(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v8, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_neighbours(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v9, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_2f462154888958ab775ddc32a175f568_part_id(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v10;
    *out = v;
    return 0;
}
int futhark_new_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 **out, const struct futhark_i64_1d *f_chain_ids, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_dat, const struct futhark_bool_1d *f_isCore, const struct futhark_bool_1d *f_isMargin, const struct futhark_bool_1d *f_isNeighbourVisited, const struct futhark_bool_1d *f_isTightMargin, const struct futhark_f64_1d *f_max_coord, const struct futhark_f64_1d *f_min_coord, const struct futhark_i64_1d *f_neighbours, const int64_t f_part_id)
{
    struct futhark_opaque_2f462154888958ab775ddc32a175f568 *v = malloc(sizeof(struct futhark_opaque_2f462154888958ab775ddc32a175f568));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_chain_ids;
        (void) (*v->v0->mem.references)++;
    }
    {
        {
            v->v1 = malloc(sizeof(*f_dat->v0));
            *v->v1 = *f_dat->v0;
            (void) (*v->v1->mem.references)++;
        }
        {
            v->v2 = malloc(sizeof(*f_dat->v1));
            *v->v2 = *f_dat->v1;
            (void) (*v->v2->mem.references)++;
        }
    }
    {
        v->v3 = malloc(sizeof(struct futhark_bool_1d));
        *v->v3 = *f_isCore;
        (void) (*v->v3->mem.references)++;
    }
    {
        v->v4 = malloc(sizeof(struct futhark_bool_1d));
        *v->v4 = *f_isMargin;
        (void) (*v->v4->mem.references)++;
    }
    {
        v->v5 = malloc(sizeof(struct futhark_bool_1d));
        *v->v5 = *f_isNeighbourVisited;
        (void) (*v->v5->mem.references)++;
    }
    {
        v->v6 = malloc(sizeof(struct futhark_bool_1d));
        *v->v6 = *f_isTightMargin;
        (void) (*v->v6->mem.references)++;
    }
    {
        v->v7 = malloc(sizeof(struct futhark_f64_1d));
        *v->v7 = *f_max_coord;
        (void) (*v->v7->mem.references)++;
    }
    {
        v->v8 = malloc(sizeof(struct futhark_f64_1d));
        *v->v8 = *f_min_coord;
        (void) (*v->v8->mem.references)++;
    }
    {
        v->v9 = malloc(sizeof(struct futhark_i64_1d));
        *v->v9 = *f_neighbours;
        (void) (*v->v9->mem.references)++;
    }
    v->v10 = f_part_id;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    if (obj->v4 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v4)) != 0)
        ret = tmp;
    if (obj->v5 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v5)) != 0)
        ret = tmp;
    if (obj->v6 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v6)) != 0)
        ret = tmp;
    if (obj->v7 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v7)) != 0)
        ret = tmp;
    if (obj->v8 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v8)) != 0)
        ret = tmp;
    if (obj->v9 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v9)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v3)[0] * sizeof(bool);
    int64_t size_4 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v4)[0] * sizeof(bool);
    int64_t size_5 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v5)[0] * sizeof(bool);
    int64_t size_6 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v6)[0] * sizeof(bool);
    int64_t size_7 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v7)[0] * sizeof(double);
    int64_t size_8 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v8)[0] * sizeof(double);
    int64_t size_9 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v9)[0] * sizeof(int64_t);
    int64_t size_10 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8 + size_9 + size_10;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v3)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v4), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v4, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v4)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v5), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v5, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v5)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v6), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v6, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v6)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v7), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v7, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v7)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v8), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v8, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v8)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v9), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v9, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v9)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v10, sizeof(obj->v10));
        out += sizeof(obj->v10);
    }
    return ret;
}
struct futhark_opaque_2f462154888958ab775ddc32a175f568 *futhark_restore_opaque_2f462154888958ab775ddc32a175f568(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_2f462154888958ab775ddc32a175f568 *obj = malloc(sizeof(struct futhark_opaque_2f462154888958ab775ddc32a175f568));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(bool);
    
    int64_t shape_4[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_4, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    obj->v4 = NULL;
    src += shape_4[0] * sizeof(bool);
    
    int64_t shape_5[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_5, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    obj->v5 = NULL;
    src += shape_5[0] * sizeof(bool);
    
    int64_t shape_6[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_6, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    obj->v6 = NULL;
    src += shape_6[0] * sizeof(bool);
    
    int64_t shape_7[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_7, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    obj->v7 = NULL;
    src += shape_7[0] * sizeof(double);
    
    int64_t shape_8[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_8, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    obj->v8 = NULL;
    src += shape_8[0] * sizeof(double);
    
    int64_t shape_9[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_9, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_9 = src;
    
    obj->v9 = NULL;
    src += shape_9[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_10 = src;
    
    src += sizeof(obj->v10);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_bool_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
        obj->v4 = futhark_new_bool_1d(ctx, data_4, shape_4[0]);
        if (obj->v4 == NULL)
            err = 1;
        obj->v5 = futhark_new_bool_1d(ctx, data_5, shape_5[0]);
        if (obj->v5 == NULL)
            err = 1;
        obj->v6 = futhark_new_bool_1d(ctx, data_6, shape_6[0]);
        if (obj->v6 == NULL)
            err = 1;
        obj->v7 = futhark_new_f64_1d(ctx, data_7, shape_7[0]);
        if (obj->v7 == NULL)
            err = 1;
        obj->v8 = futhark_new_f64_1d(ctx, data_8, shape_8[0]);
        if (obj->v8 == NULL)
            err = 1;
        obj->v9 = futhark_new_i64_1d(ctx, data_9, shape_9[0]);
        if (obj->v9 == NULL)
            err = 1;
        memcpy(&obj->v10, data_10, sizeof(obj->v10));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        if (obj->v4 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v4)) != 0)
            ret = tmp;
        if (obj->v5 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v5)) != 0)
            ret = tmp;
        if (obj->v6 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v6)) != 0)
            ret = tmp;
        if (obj->v7 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v7)) != 0)
            ret = tmp;
        if (obj->v8 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v8)) != 0)
            ret = tmp;
        if (obj->v9 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v9)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_dbcHandler_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    int8_t v2;
    int8_t v3;
    double v4;
    int64_t v5;
    struct futhark_f64_1d *v6;
    int64_t v7;
    struct futhark_f64_1d *v8;
    struct futhark_i64_1d *v9;
    double v10;
    struct futhark_f64_1d *v11;
    int64_t v12;
    struct futhark_bool_1d *v13;
    struct futhark_i64_1d *v14;
    struct futhark_f64_1d *v15;
    struct futhark_f64_1d *v16;
    int64_t v17;
    int64_t v18;
    int64_t v19;
    struct futhark_bool_1d *v20;
    int64_t v21;
    int64_t v22;
    struct futhark_i64_1d *v23;
    struct futhark_i64_1d *v24;
    struct futhark_f64_1d *v25;
    struct futhark_f64_1d *v26;
    struct futhark_bool_1d *v27;
    struct futhark_bool_1d *v28;
    struct futhark_bool_1d *v29;
    struct futhark_bool_1d *v30;
    struct futhark_f64_1d *v31;
    struct futhark_f64_1d *v32;
    struct futhark_i64_1d *v33;
    int64_t v34;
    struct futhark_f64_1d *v35;
    struct futhark_f64_1d *v36;
    struct futhark_i64_1d *v37;
};
int futhark_project_opaque_dbcHandler_double_chain_collisions(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_i64_i64 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v0;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v1;
    (void) (*v->v1->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_dbcHandler_double_clBase(struct futhark_context *ctx, struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb));
    v->v0 = obj->v2;
    v->v1 = obj->v3;
    v->v2 = obj->v4;
    v->v3 = obj->v5;
    v->v4 = malloc(sizeof(*v->v4));
    *v->v4 = *obj->v6;
    (void) (*v->v4->mem.references)++;
    v->v5 = obj->v7;
    v->v6 = malloc(sizeof(*v->v6));
    *v->v6 = *obj->v8;
    (void) (*v->v6->mem.references)++;
    v->v7 = malloc(sizeof(*v->v7));
    *v->v7 = *obj->v9;
    (void) (*v->v7->mem.references)++;
    v->v8 = obj->v10;
    v->v9 = malloc(sizeof(*v->v9));
    *v->v9 = *obj->v11;
    (void) (*v->v9->mem.references)++;
    v->v10 = obj->v12;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_dbcHandler_double_clProc(struct futhark_context *ctx, struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v13;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v14;
    (void) (*v->v1->mem.references)++;
    v->v2 = malloc(sizeof(*v->v2));
    *v->v2 = *obj->v15;
    (void) (*v->v2->mem.references)++;
    v->v3 = malloc(sizeof(*v->v3));
    *v->v3 = *obj->v16;
    (void) (*v->v3->mem.references)++;
    v->v4 = obj->v17;
    v->v5 = obj->v18;
    v->v6 = obj->v19;
    v->v7 = malloc(sizeof(*v->v7));
    *v->v7 = *obj->v20;
    (void) (*v->v7->mem.references)++;
    v->v8 = obj->v21;
    v->v9 = obj->v22;
    v->v10 = malloc(sizeof(*v->v10));
    *v->v10 = *obj->v23;
    (void) (*v->v10->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_dbcHandler_double_current_partition(struct futhark_context *ctx, struct futhark_opaque_2f462154888958ab775ddc32a175f568 **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_2f462154888958ab775ddc32a175f568 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_2f462154888958ab775ddc32a175f568));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v24;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v25;
    (void) (*v->v1->mem.references)++;
    v->v2 = malloc(sizeof(*v->v2));
    *v->v2 = *obj->v26;
    (void) (*v->v2->mem.references)++;
    v->v3 = malloc(sizeof(*v->v3));
    *v->v3 = *obj->v27;
    (void) (*v->v3->mem.references)++;
    v->v4 = malloc(sizeof(*v->v4));
    *v->v4 = *obj->v28;
    (void) (*v->v4->mem.references)++;
    v->v5 = malloc(sizeof(*v->v5));
    *v->v5 = *obj->v29;
    (void) (*v->v5->mem.references)++;
    v->v6 = malloc(sizeof(*v->v6));
    *v->v6 = *obj->v30;
    (void) (*v->v6->mem.references)++;
    v->v7 = malloc(sizeof(*v->v7));
    *v->v7 = *obj->v31;
    (void) (*v->v7->mem.references)++;
    v->v8 = malloc(sizeof(*v->v8));
    *v->v8 = *obj->v32;
    (void) (*v->v8->mem.references)++;
    v->v9 = malloc(sizeof(*v->v9));
    *v->v9 = *obj->v33;
    (void) (*v->v9->mem.references)++;
    v->v10 = obj->v34;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_dbcHandler_double_toFlush_dat(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_f64_f64 **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_f64_f64 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_f64_f64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v35;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v36;
    (void) (*v->v1->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_dbcHandler_double_toFlush_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v37, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *f_chain_collisions, const struct futhark_opaque_8b7e80c3fb80a9a7700efe8e89371deb *f_clBase, const struct futhark_opaque_a8fdbed66266f52db9d5a0da8b1f6763 *f_clProc, const struct futhark_opaque_2f462154888958ab775ddc32a175f568 *f_current_partition, const struct futhark_opaque_arr1d_tup2_f64_f64 *f_toFlush_dat, const struct futhark_i64_1d *f_toFlush_ids)
{
    struct futhark_opaque_dbcHandler_double *v = malloc(sizeof(struct futhark_opaque_dbcHandler_double));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        {
            v->v0 = malloc(sizeof(*f_chain_collisions->v0));
            *v->v0 = *f_chain_collisions->v0;
            (void) (*v->v0->mem.references)++;
        }
        {
            v->v1 = malloc(sizeof(*f_chain_collisions->v1));
            *v->v1 = *f_chain_collisions->v1;
            (void) (*v->v1->mem.references)++;
        }
    }
    {
        v->v2 = f_clBase->v0;
        v->v3 = f_clBase->v1;
        v->v4 = f_clBase->v2;
        v->v5 = f_clBase->v3;
        {
            v->v6 = malloc(sizeof(*f_clBase->v4));
            *v->v6 = *f_clBase->v4;
            (void) (*v->v6->mem.references)++;
        }
        v->v7 = f_clBase->v5;
        {
            v->v8 = malloc(sizeof(*f_clBase->v6));
            *v->v8 = *f_clBase->v6;
            (void) (*v->v8->mem.references)++;
        }
        {
            v->v9 = malloc(sizeof(*f_clBase->v7));
            *v->v9 = *f_clBase->v7;
            (void) (*v->v9->mem.references)++;
        }
        v->v10 = f_clBase->v8;
        {
            v->v11 = malloc(sizeof(*f_clBase->v9));
            *v->v11 = *f_clBase->v9;
            (void) (*v->v11->mem.references)++;
        }
        v->v12 = f_clBase->v10;
    }
    {
        {
            v->v13 = malloc(sizeof(*f_clProc->v0));
            *v->v13 = *f_clProc->v0;
            (void) (*v->v13->mem.references)++;
        }
        {
            v->v14 = malloc(sizeof(*f_clProc->v1));
            *v->v14 = *f_clProc->v1;
            (void) (*v->v14->mem.references)++;
        }
        {
            v->v15 = malloc(sizeof(*f_clProc->v2));
            *v->v15 = *f_clProc->v2;
            (void) (*v->v15->mem.references)++;
        }
        {
            v->v16 = malloc(sizeof(*f_clProc->v3));
            *v->v16 = *f_clProc->v3;
            (void) (*v->v16->mem.references)++;
        }
        v->v17 = f_clProc->v4;
        v->v18 = f_clProc->v5;
        v->v19 = f_clProc->v6;
        {
            v->v20 = malloc(sizeof(*f_clProc->v7));
            *v->v20 = *f_clProc->v7;
            (void) (*v->v20->mem.references)++;
        }
        v->v21 = f_clProc->v8;
        v->v22 = f_clProc->v9;
        {
            v->v23 = malloc(sizeof(*f_clProc->v10));
            *v->v23 = *f_clProc->v10;
            (void) (*v->v23->mem.references)++;
        }
    }
    {
        {
            v->v24 = malloc(sizeof(*f_current_partition->v0));
            *v->v24 = *f_current_partition->v0;
            (void) (*v->v24->mem.references)++;
        }
        {
            v->v25 = malloc(sizeof(*f_current_partition->v1));
            *v->v25 = *f_current_partition->v1;
            (void) (*v->v25->mem.references)++;
        }
        {
            v->v26 = malloc(sizeof(*f_current_partition->v2));
            *v->v26 = *f_current_partition->v2;
            (void) (*v->v26->mem.references)++;
        }
        {
            v->v27 = malloc(sizeof(*f_current_partition->v3));
            *v->v27 = *f_current_partition->v3;
            (void) (*v->v27->mem.references)++;
        }
        {
            v->v28 = malloc(sizeof(*f_current_partition->v4));
            *v->v28 = *f_current_partition->v4;
            (void) (*v->v28->mem.references)++;
        }
        {
            v->v29 = malloc(sizeof(*f_current_partition->v5));
            *v->v29 = *f_current_partition->v5;
            (void) (*v->v29->mem.references)++;
        }
        {
            v->v30 = malloc(sizeof(*f_current_partition->v6));
            *v->v30 = *f_current_partition->v6;
            (void) (*v->v30->mem.references)++;
        }
        {
            v->v31 = malloc(sizeof(*f_current_partition->v7));
            *v->v31 = *f_current_partition->v7;
            (void) (*v->v31->mem.references)++;
        }
        {
            v->v32 = malloc(sizeof(*f_current_partition->v8));
            *v->v32 = *f_current_partition->v8;
            (void) (*v->v32->mem.references)++;
        }
        {
            v->v33 = malloc(sizeof(*f_current_partition->v9));
            *v->v33 = *f_current_partition->v9;
            (void) (*v->v33->mem.references)++;
        }
        v->v34 = f_current_partition->v10;
    }
    {
        {
            v->v35 = malloc(sizeof(*f_toFlush_dat->v0));
            *v->v35 = *f_toFlush_dat->v0;
            (void) (*v->v35->mem.references)++;
        }
        {
            v->v36 = malloc(sizeof(*f_toFlush_dat->v1));
            *v->v36 = *f_toFlush_dat->v1;
            (void) (*v->v36->mem.references)++;
        }
    }
    {
        v->v37 = malloc(sizeof(struct futhark_i64_1d));
        *v->v37 = *f_toFlush_ids;
        (void) (*v->v37->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v6 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v6)) != 0)
        ret = tmp;
    if (obj->v8 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v8)) != 0)
        ret = tmp;
    if (obj->v9 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v9)) != 0)
        ret = tmp;
    if (obj->v11 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v11)) != 0)
        ret = tmp;
    if (obj->v13 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v13)) != 0)
        ret = tmp;
    if (obj->v14 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v14)) != 0)
        ret = tmp;
    if (obj->v15 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v15)) != 0)
        ret = tmp;
    if (obj->v16 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v16)) != 0)
        ret = tmp;
    if (obj->v20 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v20)) != 0)
        ret = tmp;
    if (obj->v23 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v23)) != 0)
        ret = tmp;
    if (obj->v24 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v24)) != 0)
        ret = tmp;
    if (obj->v25 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v25)) != 0)
        ret = tmp;
    if (obj->v26 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v26)) != 0)
        ret = tmp;
    if (obj->v27 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v27)) != 0)
        ret = tmp;
    if (obj->v28 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v28)) != 0)
        ret = tmp;
    if (obj->v29 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v29)) != 0)
        ret = tmp;
    if (obj->v30 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v30)) != 0)
        ret = tmp;
    if (obj->v31 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v31)) != 0)
        ret = tmp;
    if (obj->v32 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v32)) != 0)
        ret = tmp;
    if (obj->v33 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v33)) != 0)
        ret = tmp;
    if (obj->v35 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v35)) != 0)
        ret = tmp;
    if (obj->v36 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v36)) != 0)
        ret = tmp;
    if (obj->v37 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v37)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_dbcHandler_double(struct futhark_context *ctx, const struct futhark_opaque_dbcHandler_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    int64_t size_3 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int8_t);
    int64_t size_4 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    int64_t size_5 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_6 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v6)[0] * sizeof(double);
    int64_t size_7 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_8 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v8)[0] * sizeof(double);
    int64_t size_9 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v9)[0] * sizeof(int64_t);
    int64_t size_10 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(double);
    int64_t size_11 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v11)[0] * sizeof(double);
    int64_t size_12 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_13 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v13)[0] * sizeof(bool);
    int64_t size_14 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v14)[0] * sizeof(int64_t);
    int64_t size_15 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v15)[0] * sizeof(double);
    int64_t size_16 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v16)[0] * sizeof(double);
    int64_t size_17 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_18 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_19 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_20 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v20)[0] * sizeof(bool);
    int64_t size_21 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_22 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_23 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v23)[0] * sizeof(int64_t);
    int64_t size_24 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v24)[0] * sizeof(int64_t);
    int64_t size_25 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v25)[0] * sizeof(double);
    int64_t size_26 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v26)[0] * sizeof(double);
    int64_t size_27 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v27)[0] * sizeof(bool);
    int64_t size_28 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v28)[0] * sizeof(bool);
    int64_t size_29 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v29)[0] * sizeof(bool);
    int64_t size_30 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v30)[0] * sizeof(bool);
    int64_t size_31 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v31)[0] * sizeof(double);
    int64_t size_32 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v32)[0] * sizeof(double);
    int64_t size_33 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v33)[0] * sizeof(int64_t);
    int64_t size_34 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_35 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v35)[0] * sizeof(double);
    int64_t size_36 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v36)[0] * sizeof(double);
    int64_t size_37 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v37)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8 + size_9 + size_10 + size_11 + size_12 + size_13 + size_14 + size_15 + size_16 + size_17 + size_18 + size_19 + size_20 + size_21 + size_22 + size_23 + size_24 + size_25 + size_26 + size_27 + size_28 + size_29 + size_30 + size_31 + size_32 + size_33 + size_34 + size_35 + size_36 + size_37;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, "  i8", 4);
        out += 4;
        memcpy(out, &obj->v3, sizeof(obj->v3));
        out += sizeof(obj->v3);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v4, sizeof(obj->v4));
        out += sizeof(obj->v4);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v5, sizeof(obj->v5));
        out += sizeof(obj->v5);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v6), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v6, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v6)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v7, sizeof(obj->v7));
        out += sizeof(obj->v7);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v8), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v8, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v8)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v9), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v9, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v9)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, &obj->v10, sizeof(obj->v10));
        out += sizeof(obj->v10);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v11), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v11, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v11)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v12, sizeof(obj->v12));
        out += sizeof(obj->v12);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v13), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v13, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v13)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v14), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v14, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v14)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v15), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v15, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v15)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v16), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v16, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v16)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v17, sizeof(obj->v17));
        out += sizeof(obj->v17);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v18, sizeof(obj->v18));
        out += sizeof(obj->v18);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v19, sizeof(obj->v19));
        out += sizeof(obj->v19);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v20), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v20, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v20)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v21, sizeof(obj->v21));
        out += sizeof(obj->v21);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v22, sizeof(obj->v22));
        out += sizeof(obj->v22);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v23), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v23, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v23)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v24), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v24, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v24)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v25), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v25, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v25)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v26), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v26, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v26)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v27), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v27, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v27)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v28), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v28, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v28)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v29), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v29, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v29)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v30), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v30, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v30)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v31), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v31, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v31)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v32), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v32, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v32)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v33), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v33, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v33)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v34, sizeof(obj->v34));
        out += sizeof(obj->v34);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v35), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v35, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v35)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v36), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v36, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v36)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v37), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v37, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v37)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_dbcHandler_double *futhark_restore_opaque_dbcHandler_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_dbcHandler_double *obj = malloc(sizeof(struct futhark_opaque_dbcHandler_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, "  i8", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    src += sizeof(obj->v3);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    src += sizeof(obj->v4);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    src += sizeof(obj->v5);
    
    int64_t shape_6[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_6, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    obj->v6 = NULL;
    src += shape_6[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    src += sizeof(obj->v7);
    
    int64_t shape_8[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_8, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    obj->v8 = NULL;
    src += shape_8[0] * sizeof(double);
    
    int64_t shape_9[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_9, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_9 = src;
    
    obj->v9 = NULL;
    src += shape_9[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_10 = src;
    
    src += sizeof(obj->v10);
    
    int64_t shape_11[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_11, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_11 = src;
    
    obj->v11 = NULL;
    src += shape_11[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_12 = src;
    
    src += sizeof(obj->v12);
    
    int64_t shape_13[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_13, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_13 = src;
    
    obj->v13 = NULL;
    src += shape_13[0] * sizeof(bool);
    
    int64_t shape_14[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_14, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_14 = src;
    
    obj->v14 = NULL;
    src += shape_14[0] * sizeof(int64_t);
    
    int64_t shape_15[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_15, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_15 = src;
    
    obj->v15 = NULL;
    src += shape_15[0] * sizeof(double);
    
    int64_t shape_16[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_16, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_16 = src;
    
    obj->v16 = NULL;
    src += shape_16[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_17 = src;
    
    src += sizeof(obj->v17);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_18 = src;
    
    src += sizeof(obj->v18);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_19 = src;
    
    src += sizeof(obj->v19);
    
    int64_t shape_20[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_20, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_20 = src;
    
    obj->v20 = NULL;
    src += shape_20[0] * sizeof(bool);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_21 = src;
    
    src += sizeof(obj->v21);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_22 = src;
    
    src += sizeof(obj->v22);
    
    int64_t shape_23[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_23, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_23 = src;
    
    obj->v23 = NULL;
    src += shape_23[0] * sizeof(int64_t);
    
    int64_t shape_24[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_24, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_24 = src;
    
    obj->v24 = NULL;
    src += shape_24[0] * sizeof(int64_t);
    
    int64_t shape_25[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_25, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_25 = src;
    
    obj->v25 = NULL;
    src += shape_25[0] * sizeof(double);
    
    int64_t shape_26[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_26, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_26 = src;
    
    obj->v26 = NULL;
    src += shape_26[0] * sizeof(double);
    
    int64_t shape_27[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_27, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_27 = src;
    
    obj->v27 = NULL;
    src += shape_27[0] * sizeof(bool);
    
    int64_t shape_28[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_28, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_28 = src;
    
    obj->v28 = NULL;
    src += shape_28[0] * sizeof(bool);
    
    int64_t shape_29[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_29, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_29 = src;
    
    obj->v29 = NULL;
    src += shape_29[0] * sizeof(bool);
    
    int64_t shape_30[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_30, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_30 = src;
    
    obj->v30 = NULL;
    src += shape_30[0] * sizeof(bool);
    
    int64_t shape_31[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_31, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_31 = src;
    
    obj->v31 = NULL;
    src += shape_31[0] * sizeof(double);
    
    int64_t shape_32[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_32, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_32 = src;
    
    obj->v32 = NULL;
    src += shape_32[0] * sizeof(double);
    
    int64_t shape_33[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_33, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_33 = src;
    
    obj->v33 = NULL;
    src += shape_33[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_34 = src;
    
    src += sizeof(obj->v34);
    
    int64_t shape_35[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_35, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_35 = src;
    
    obj->v35 = NULL;
    src += shape_35[0] * sizeof(double);
    
    int64_t shape_36[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_36, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_36 = src;
    
    obj->v36 = NULL;
    src += shape_36[0] * sizeof(double);
    
    int64_t shape_37[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_37, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_37 = src;
    
    obj->v37 = NULL;
    src += shape_37[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
        memcpy(&obj->v3, data_3, sizeof(obj->v3));
        memcpy(&obj->v4, data_4, sizeof(obj->v4));
        memcpy(&obj->v5, data_5, sizeof(obj->v5));
        obj->v6 = futhark_new_f64_1d(ctx, data_6, shape_6[0]);
        if (obj->v6 == NULL)
            err = 1;
        memcpy(&obj->v7, data_7, sizeof(obj->v7));
        obj->v8 = futhark_new_f64_1d(ctx, data_8, shape_8[0]);
        if (obj->v8 == NULL)
            err = 1;
        obj->v9 = futhark_new_i64_1d(ctx, data_9, shape_9[0]);
        if (obj->v9 == NULL)
            err = 1;
        memcpy(&obj->v10, data_10, sizeof(obj->v10));
        obj->v11 = futhark_new_f64_1d(ctx, data_11, shape_11[0]);
        if (obj->v11 == NULL)
            err = 1;
        memcpy(&obj->v12, data_12, sizeof(obj->v12));
        obj->v13 = futhark_new_bool_1d(ctx, data_13, shape_13[0]);
        if (obj->v13 == NULL)
            err = 1;
        obj->v14 = futhark_new_i64_1d(ctx, data_14, shape_14[0]);
        if (obj->v14 == NULL)
            err = 1;
        obj->v15 = futhark_new_f64_1d(ctx, data_15, shape_15[0]);
        if (obj->v15 == NULL)
            err = 1;
        obj->v16 = futhark_new_f64_1d(ctx, data_16, shape_16[0]);
        if (obj->v16 == NULL)
            err = 1;
        memcpy(&obj->v17, data_17, sizeof(obj->v17));
        memcpy(&obj->v18, data_18, sizeof(obj->v18));
        memcpy(&obj->v19, data_19, sizeof(obj->v19));
        obj->v20 = futhark_new_bool_1d(ctx, data_20, shape_20[0]);
        if (obj->v20 == NULL)
            err = 1;
        memcpy(&obj->v21, data_21, sizeof(obj->v21));
        memcpy(&obj->v22, data_22, sizeof(obj->v22));
        obj->v23 = futhark_new_i64_1d(ctx, data_23, shape_23[0]);
        if (obj->v23 == NULL)
            err = 1;
        obj->v24 = futhark_new_i64_1d(ctx, data_24, shape_24[0]);
        if (obj->v24 == NULL)
            err = 1;
        obj->v25 = futhark_new_f64_1d(ctx, data_25, shape_25[0]);
        if (obj->v25 == NULL)
            err = 1;
        obj->v26 = futhark_new_f64_1d(ctx, data_26, shape_26[0]);
        if (obj->v26 == NULL)
            err = 1;
        obj->v27 = futhark_new_bool_1d(ctx, data_27, shape_27[0]);
        if (obj->v27 == NULL)
            err = 1;
        obj->v28 = futhark_new_bool_1d(ctx, data_28, shape_28[0]);
        if (obj->v28 == NULL)
            err = 1;
        obj->v29 = futhark_new_bool_1d(ctx, data_29, shape_29[0]);
        if (obj->v29 == NULL)
            err = 1;
        obj->v30 = futhark_new_bool_1d(ctx, data_30, shape_30[0]);
        if (obj->v30 == NULL)
            err = 1;
        obj->v31 = futhark_new_f64_1d(ctx, data_31, shape_31[0]);
        if (obj->v31 == NULL)
            err = 1;
        obj->v32 = futhark_new_f64_1d(ctx, data_32, shape_32[0]);
        if (obj->v32 == NULL)
            err = 1;
        obj->v33 = futhark_new_i64_1d(ctx, data_33, shape_33[0]);
        if (obj->v33 == NULL)
            err = 1;
        memcpy(&obj->v34, data_34, sizeof(obj->v34));
        obj->v35 = futhark_new_f64_1d(ctx, data_35, shape_35[0]);
        if (obj->v35 == NULL)
            err = 1;
        obj->v36 = futhark_new_f64_1d(ctx, data_36, shape_36[0]);
        if (obj->v36 == NULL)
            err = 1;
        obj->v37 = futhark_new_i64_1d(ctx, data_37, shape_37[0]);
        if (obj->v37 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v6 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v6)) != 0)
            ret = tmp;
        if (obj->v8 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v8)) != 0)
            ret = tmp;
        if (obj->v9 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v9)) != 0)
            ret = tmp;
        if (obj->v11 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v11)) != 0)
            ret = tmp;
        if (obj->v13 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v13)) != 0)
            ret = tmp;
        if (obj->v14 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v14)) != 0)
            ret = tmp;
        if (obj->v15 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v15)) != 0)
            ret = tmp;
        if (obj->v16 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v16)) != 0)
            ret = tmp;
        if (obj->v20 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v20)) != 0)
            ret = tmp;
        if (obj->v23 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v23)) != 0)
            ret = tmp;
        if (obj->v24 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v24)) != 0)
            ret = tmp;
        if (obj->v25 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v25)) != 0)
            ret = tmp;
        if (obj->v26 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v26)) != 0)
            ret = tmp;
        if (obj->v27 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v27)) != 0)
            ret = tmp;
        if (obj->v28 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v28)) != 0)
            ret = tmp;
        if (obj->v29 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v29)) != 0)
            ret = tmp;
        if (obj->v30 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v30)) != 0)
            ret = tmp;
        if (obj->v31 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v31)) != 0)
            ret = tmp;
        if (obj->v32 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v32)) != 0)
            ret = tmp;
        if (obj->v33 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v33)) != 0)
            ret = tmp;
        if (obj->v35 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v35)) != 0)
            ret = tmp;
        if (obj->v36 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v36)) != 0)
            ret = tmp;
        if (obj->v37 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v37)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_flushedData_double {
    struct futhark_i64_1d *v0;
    int64_t v1;
    struct futhark_f64_1d *v2;
    struct futhark_f64_1d *v3;
};
int futhark_project_opaque_flushedData_double_chain_ids(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_flushedData_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_flushedData_double_n(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_flushedData_double *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_project_opaque_flushedData_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_flushedData_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_flushedData_double_ys(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_flushedData_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v3, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_flushedData_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double **out, const struct futhark_i64_1d *f_chain_ids, const int64_t f_n, const struct futhark_f64_1d *f_xs, const struct futhark_f64_1d *f_ys)
{
    struct futhark_opaque_flushedData_double *v = malloc(sizeof(struct futhark_opaque_flushedData_double));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_chain_ids;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_n;
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_xs;
        (void) (*v->v2->mem.references)++;
    }
    {
        v->v3 = malloc(sizeof(struct futhark_f64_1d));
        *v->v3 = *f_ys;
        (void) (*v->v3->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_flushedData_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_flushedData_double(struct futhark_context *ctx, const struct futhark_opaque_flushedData_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2 + size_3;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_flushedData_double *futhark_restore_opaque_flushedData_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_flushedData_double *obj = malloc(sizeof(struct futhark_opaque_flushedData_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_f64_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_collisionTable {
    struct futhark_i64_1d *v0;
    int64_t v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_collisionTable_chain_id(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_collisionTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_collisionTable_ncc(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_collisionTable *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_project_opaque_collisionTable_replaceWith(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_collisionTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_collisionTable(struct futhark_context *ctx, struct futhark_opaque_collisionTable **out, const struct futhark_i64_1d *f_chain_id, const int64_t f_ncc, const struct futhark_i64_1d *f_replaceWith)
{
    struct futhark_opaque_collisionTable *v = malloc(sizeof(struct futhark_opaque_collisionTable));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_chain_id;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_ncc;
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_replaceWith;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_collisionTable(struct futhark_context *ctx, struct futhark_opaque_collisionTable *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_collisionTable(struct futhark_context *ctx, const struct futhark_opaque_collisionTable *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_collisionTable *futhark_restore_opaque_collisionTable(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_collisionTable *obj = malloc(sizeof(struct futhark_opaque_collisionTable));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_83299, int64_t n_83300, int64_t x_83301, int64_t s_83302)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t tblock_sizze_83308;
    
    tblock_sizze_83308 = *ctx->tuning_params.builtinzhiota_i64zitblock_sizze_83308;
    
    int64_t virt_num_tblocks_83309 = sdiv_up64(n_83300, tblock_sizze_83308);
    int64_t num_tblocks_83310 = smin64(virt_num_tblocks_83309, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhiota_i64ziiota_i64_83304(ctx, num_tblocks_83310, 1, 1, tblock_sizze_83308, 1, 1, (int64_t) 0, n_83300, x_83301, s_83302, virt_num_tblocks_83309, num_tblocks_83310, mem_83299.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_bool(struct futhark_context *ctx, struct memblock_device mem_84469, int64_t num_elems_84470, bool val_84471)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t replicate_n_84473 = num_elems_84470;
    int64_t tblock_sizze_84478;
    
    tblock_sizze_84478 = *ctx->tuning_params.builtinzhreplicate_boolzitblock_sizze_84478;
    
    int64_t virt_num_tblocks_84479 = sdiv_up64(replicate_n_84473, tblock_sizze_84478);
    int64_t num_tblocks_84480 = smin64(virt_num_tblocks_84479, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_boolzireplicate_84474(ctx, num_tblocks_84480, 1, 1, tblock_sizze_84478, 1, 1, (int64_t) 0, num_elems_84470, val_84471, replicate_n_84473, virt_num_tblocks_84479, num_tblocks_84480, mem_84469.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f64(struct futhark_context *ctx, struct memblock_device mem_83375, int64_t num_elems_83376, double val_83377)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t replicate_n_83379 = num_elems_83376;
    int64_t tblock_sizze_83384;
    
    tblock_sizze_83384 = *ctx->tuning_params.builtinzhreplicate_f64zitblock_sizze_83384;
    
    int64_t virt_num_tblocks_83385 = sdiv_up64(replicate_n_83379, tblock_sizze_83384);
    int64_t num_tblocks_83386 = smin64(virt_num_tblocks_83385, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f64zireplicate_83380(ctx, num_tblocks_83386, 1, 1, tblock_sizze_83384, 1, 1, (int64_t) 0, num_elems_83376, val_83377, replicate_n_83379, virt_num_tblocks_83385, num_tblocks_83386, mem_83375.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_83192, int64_t num_elems_83193, int32_t val_83194)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t replicate_n_83196 = num_elems_83193;
    int64_t tblock_sizze_83201;
    
    tblock_sizze_83201 = *ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_83201;
    
    int64_t virt_num_tblocks_83202 = sdiv_up64(replicate_n_83196, tblock_sizze_83201);
    int64_t num_tblocks_83203 = smin64(virt_num_tblocks_83202, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i32zireplicate_83197(ctx, num_tblocks_83203, 1, 1, tblock_sizze_83201, 1, 1, (int64_t) 0, num_elems_83193, val_83194, replicate_n_83196, virt_num_tblocks_83202, num_tblocks_83203, mem_83192.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_83332, int64_t num_elems_83333, int64_t val_83334)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t replicate_n_83336 = num_elems_83333;
    int64_t tblock_sizze_83341;
    
    tblock_sizze_83341 = *ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_83341;
    
    int64_t virt_num_tblocks_83342 = sdiv_up64(replicate_n_83336, tblock_sizze_83341);
    int64_t num_tblocks_83343 = smin64(virt_num_tblocks_83342, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i64zireplicate_83337(ctx, num_tblocks_83343, 1, 1, tblock_sizze_83341, 1, 1, (int64_t) 0, num_elems_83333, val_83334, replicate_n_83336, virt_num_tblocks_83342, num_tblocks_83343, mem_83332.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_83166, int64_t num_elems_83167, int8_t val_83168)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t replicate_n_83170 = num_elems_83167;
    int64_t tblock_sizze_83175;
    
    tblock_sizze_83175 = *ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_83175;
    
    int64_t virt_num_tblocks_83176 = sdiv_up64(replicate_n_83170, tblock_sizze_83175);
    int64_t num_tblocks_83177 = smin64(virt_num_tblocks_83176, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i8zireplicate_83171(ctx, num_tblocks_83177, 1, 1, tblock_sizze_83175, 1, 1, (int64_t) 0, num_elems_83167, val_83168, replicate_n_83170, virt_num_tblocks_83176, num_tblocks_83177, mem_83166.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_add_next_partition_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86823, struct memblock_device *mem_out_p_86824, struct memblock_device *mem_out_p_86825, struct memblock_device *mem_out_p_86826, struct memblock_device *mem_out_p_86827, struct memblock_device *mem_out_p_86828, struct memblock_device *mem_out_p_86829, struct memblock_device *mem_out_p_86830, struct memblock_device *mem_out_p_86831, struct memblock_device *mem_out_p_86832, struct memblock_device *mem_out_p_86833, struct memblock_device *mem_out_p_86834, struct memblock_device *mem_out_p_86835, struct memblock_device *mem_out_p_86836, struct memblock_device *mem_out_p_86837, struct memblock_device *mem_out_p_86838, struct memblock_device *mem_out_p_86839, struct memblock_device *mem_out_p_86840, struct memblock_device *mem_out_p_86841, struct memblock_device *mem_out_p_86842, struct memblock_device *mem_out_p_86843, struct memblock_device *mem_out_p_86844, struct memblock_device *mem_out_p_86845, struct memblock_device *mem_out_p_86846, struct memblock_device *mem_out_p_86847, int64_t *out_prim_out_86848, int64_t *out_prim_out_86849, int64_t *out_prim_out_86850, int8_t *out_prim_out_86851, int8_t *out_prim_out_86852, double *out_prim_out_86853, int64_t *out_prim_out_86854, int64_t *out_prim_out_86855, double *out_prim_out_86856, int64_t *out_prim_out_86857, int64_t *out_prim_out_86858, int64_t *out_prim_out_86859, int64_t *out_prim_out_86860, int64_t *out_prim_out_86861, int64_t *out_prim_out_86862, int64_t *out_prim_out_86863, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, struct memblock_device new_xs_mem_81952, struct memblock_device new_ys_mem_81953, int64_t n_old_36753, int64_t part_no_36754, int64_t dz2084U_36755, int64_t dz2080U_36756, int64_t dz2081U_36757, int64_t dz2082U_36758, int64_t dz2083U_36759, int64_t dz2085U_36760, int64_t dz2086U_36761, int64_t n_new_36762, int8_t clBase_36765, int8_t clBase_36766, double clBase_36767, int64_t clBase_36768, int64_t clBase_36770, double clBase_36773, int64_t clBase_36775, int64_t clProc_36780, int64_t clProc_36781, int64_t clProc_36782, int64_t clProc_36784, int64_t clProc_36785, int64_t current_partition_36797, int64_t new_id_36801)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_82141;
    
    mem_82141.references = NULL;
    
    struct memblock_device mem_82139;
    
    mem_82139.references = NULL;
    
    struct memblock_device mem_82137;
    
    mem_82137.references = NULL;
    
    struct memblock_device mem_82128;
    
    mem_82128.references = NULL;
    
    struct memblock_device mem_82126;
    
    mem_82126.references = NULL;
    
    struct memblock_device mem_82125;
    
    mem_82125.references = NULL;
    
    struct memblock_device mem_82123;
    
    mem_82123.references = NULL;
    
    struct memblock_device mem_82112;
    
    mem_82112.references = NULL;
    
    struct memblock_device segred_tmp_mem_84153;
    
    segred_tmp_mem_84153.references = NULL;
    
    struct memblock_device mem_82083;
    
    mem_82083.references = NULL;
    
    struct memblock_device mem_82109;
    
    mem_82109.references = NULL;
    
    struct memblock_device ext_mem_82110;
    
    ext_mem_82110.references = NULL;
    
    struct memblock_device mem_82080;
    
    mem_82080.references = NULL;
    
    struct memblock_device mem_82073;
    
    mem_82073.references = NULL;
    
    struct memblock_device mem_81996;
    
    mem_81996.references = NULL;
    
    struct memblock_device mem_81994;
    
    mem_81994.references = NULL;
    
    struct memblock_device mem_81993;
    
    mem_81993.references = NULL;
    
    struct memblock_device mem_81957;
    
    mem_81957.references = NULL;
    
    struct memblock_device mem_81955;
    
    mem_81955.references = NULL;
    
    struct memblock_device incprefixes_mem_83906;
    
    incprefixes_mem_83906.references = NULL;
    
    struct memblock_device aggregates_mem_83904;
    
    aggregates_mem_83904.references = NULL;
    
    struct memblock_device incprefixes_mem_83902;
    
    incprefixes_mem_83902.references = NULL;
    
    struct memblock_device aggregates_mem_83900;
    
    aggregates_mem_83900.references = NULL;
    
    struct memblock_device status_flags_mem_83898;
    
    status_flags_mem_83898.references = NULL;
    
    struct memblock_device mem_82119;
    
    mem_82119.references = NULL;
    
    struct memblock_device mem_82117;
    
    mem_82117.references = NULL;
    
    struct memblock_device mem_82115;
    
    mem_82115.references = NULL;
    
    struct memblock_device incprefixes_mem_83800;
    
    incprefixes_mem_83800.references = NULL;
    
    struct memblock_device aggregates_mem_83798;
    
    aggregates_mem_83798.references = NULL;
    
    struct memblock_device status_flags_mem_83796;
    
    status_flags_mem_83796.references = NULL;
    
    struct memblock_device mem_82078;
    
    mem_82078.references = NULL;
    
    struct memblock_device mem_82076;
    
    mem_82076.references = NULL;
    
    struct memblock_device mem_82070;
    
    mem_82070.references = NULL;
    
    struct memblock_device incprefixes_mem_83684;
    
    incprefixes_mem_83684.references = NULL;
    
    struct memblock_device aggregates_mem_83682;
    
    aggregates_mem_83682.references = NULL;
    
    struct memblock_device status_flags_mem_83680;
    
    status_flags_mem_83680.references = NULL;
    
    struct memblock_device mem_82059;
    
    mem_82059.references = NULL;
    
    struct memblock_device mem_82057;
    
    mem_82057.references = NULL;
    
    struct memblock_device mem_82011;
    
    mem_82011.references = NULL;
    
    struct memblock_device mem_82010;
    
    mem_82010.references = NULL;
    
    struct memblock_device segred_tmp_mem_83622;
    
    segred_tmp_mem_83622.references = NULL;
    
    struct memblock_device mem_82008;
    
    mem_82008.references = NULL;
    
    struct memblock_device mem_82006;
    
    mem_82006.references = NULL;
    
    struct memblock_device mem_82015;
    
    mem_82015.references = NULL;
    
    struct memblock_device mem_82014;
    
    mem_82014.references = NULL;
    
    struct memblock_device mem_82013;
    
    mem_82013.references = NULL;
    
    struct memblock_device ext_mem_82016;
    
    ext_mem_82016.references = NULL;
    
    struct memblock_device ext_mem_82017;
    
    ext_mem_82017.references = NULL;
    
    struct memblock_device ext_mem_82018;
    
    ext_mem_82018.references = NULL;
    
    struct memblock_device mem_82053;
    
    mem_82053.references = NULL;
    
    struct memblock_device mem_82052;
    
    mem_82052.references = NULL;
    
    struct memblock_device mem_82051;
    
    mem_82051.references = NULL;
    
    struct memblock_device ext_mem_82054;
    
    ext_mem_82054.references = NULL;
    
    struct memblock_device ext_mem_82055;
    
    ext_mem_82055.references = NULL;
    
    struct memblock_device ext_mem_82056;
    
    ext_mem_82056.references = NULL;
    
    struct memblock_device ext_mem_82065;
    
    ext_mem_82065.references = NULL;
    
    struct memblock_device ext_mem_82066;
    
    ext_mem_82066.references = NULL;
    
    struct memblock_device ext_mem_82067;
    
    ext_mem_82067.references = NULL;
    
    struct memblock_device ext_mem_82068;
    
    ext_mem_82068.references = NULL;
    
    struct memblock_device mem_82004;
    
    mem_82004.references = NULL;
    
    struct memblock_device mem_82003;
    
    mem_82003.references = NULL;
    
    struct memblock_device mem_82002;
    
    mem_82002.references = NULL;
    
    struct memblock_device mem_82001;
    
    mem_82001.references = NULL;
    
    struct memblock_device mem_82000;
    
    mem_82000.references = NULL;
    
    struct memblock_device mem_81999;
    
    mem_81999.references = NULL;
    
    struct memblock_device mem_81998;
    
    mem_81998.references = NULL;
    
    struct memblock_device mem_81997;
    
    mem_81997.references = NULL;
    
    struct memblock_device mem_81989;
    
    mem_81989.references = NULL;
    
    struct memblock_device mem_81990;
    
    mem_81990.references = NULL;
    
    struct memblock_device ext_mem_81991;
    
    ext_mem_81991.references = NULL;
    
    struct memblock_device mem_81986;
    
    mem_81986.references = NULL;
    
    struct memblock_device mem_81987;
    
    mem_81987.references = NULL;
    
    struct memblock_device ext_mem_81988;
    
    ext_mem_81988.references = NULL;
    
    struct memblock_device mem_81983;
    
    mem_81983.references = NULL;
    
    struct memblock_device mem_81984;
    
    mem_81984.references = NULL;
    
    struct memblock_device ext_mem_81985;
    
    ext_mem_81985.references = NULL;
    
    struct memblock_device mem_81980;
    
    mem_81980.references = NULL;
    
    struct memblock_device mem_81981;
    
    mem_81981.references = NULL;
    
    struct memblock_device ext_mem_81982;
    
    ext_mem_81982.references = NULL;
    
    struct memblock_device mem_81977;
    
    mem_81977.references = NULL;
    
    struct memblock_device mem_81978;
    
    mem_81978.references = NULL;
    
    struct memblock_device ext_mem_81979;
    
    ext_mem_81979.references = NULL;
    
    struct memblock_device mem_81974;
    
    mem_81974.references = NULL;
    
    struct memblock_device mem_81975;
    
    mem_81975.references = NULL;
    
    struct memblock_device ext_mem_81976;
    
    ext_mem_81976.references = NULL;
    
    struct memblock_device mem_81972;
    
    mem_81972.references = NULL;
    
    struct memblock_device mem_81970;
    
    mem_81970.references = NULL;
    
    struct memblock_device mem_81969;
    
    mem_81969.references = NULL;
    
    struct memblock_device mem_81967;
    
    mem_81967.references = NULL;
    
    struct memblock_device incprefixes_mem_83198;
    
    incprefixes_mem_83198.references = NULL;
    
    struct memblock_device aggregates_mem_83196;
    
    aggregates_mem_83196.references = NULL;
    
    struct memblock_device incprefixes_mem_83194;
    
    incprefixes_mem_83194.references = NULL;
    
    struct memblock_device aggregates_mem_83192;
    
    aggregates_mem_83192.references = NULL;
    
    struct memblock_device status_flags_mem_83170;
    
    status_flags_mem_83170.references = NULL;
    
    struct memblock_device mem_81965;
    
    mem_81965.references = NULL;
    
    struct memblock_device mem_81963;
    
    mem_81963.references = NULL;
    
    struct memblock_device mem_81961;
    
    mem_81961.references = NULL;
    
    struct memblock_device mem_81958;
    
    mem_81958.references = NULL;
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83142;
    int64_t prim_out_83143;
    int64_t prim_out_83144;
    int8_t prim_out_83145;
    int8_t prim_out_83146;
    double prim_out_83147;
    int64_t prim_out_83148;
    int64_t prim_out_83149;
    double prim_out_83150;
    int64_t prim_out_83151;
    int64_t prim_out_83152;
    int64_t prim_out_83153;
    int64_t prim_out_83154;
    int64_t prim_out_83155;
    int64_t prim_out_83156;
    int64_t prim_out_83157;
    double zt_res_59476 = 2.0 * clBase_36767;
    int64_t bytes_81954 = (int64_t) 8 * n_new_36762;
    bool suff_outer_screma_66889;
    
    suff_outer_screma_66889 = *ctx->tuning_params.add_next_partition_doublezisuff_outer_screma_0 <= (int64_t) 8;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "add_next_partition_double.suff_outer_screma_0", (long) (int64_t) 8, suff_outer_screma_66889 ? "true" : "false");
    
    bool suff_outer_par_68508;
    
    suff_outer_par_68508 = *ctx->tuning_params.add_next_partition_doublezisuff_outer_par_1 <= (int64_t) 8;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "add_next_partition_double.suff_outer_par_1", (long) (int64_t) 8, suff_outer_par_68508 ? "true" : "false");
    
    int64_t intra_avail_par_68509 = smin64(dz2083U_36759, n_new_36762);
    int64_t computed_tblock_sizze_68510 = smax64(dz2083U_36759, n_new_36762);
    int64_t max_tblock_sizze_68512;
    
    max_tblock_sizze_68512 = ctx->max_thread_block_size;
    
    bool fits_68513 = sle64(computed_tblock_sizze_68510, max_tblock_sizze_68512);
    bool suff_intra_par_68515;
    
    suff_intra_par_68515 = *ctx->tuning_params.add_next_partition_doublezisuff_intra_par_2 <= intra_avail_par_68509;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "add_next_partition_double.suff_intra_par_2", (long) intra_avail_par_68509, suff_intra_par_68515 ? "true" : "false");
    
    bool intra_suff_and_fits_68516 = fits_68513 && suff_intra_par_68515;
    int64_t segmap_tblock_sizze_69031;
    
    segmap_tblock_sizze_69031 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_68212;
    
    int64_t nest_sizze_69044 = (int64_t) 8 * dz2083U_36759;
    int64_t segred_tblock_sizze_69045;
    
    segred_tblock_sizze_69045 = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193;
    
    int64_t num_tblocks_69046;
    int64_t max_num_tblocks_83158;
    
    max_num_tblocks_83158 = *ctx->tuning_params.add_next_partition_doublezisegred_num_tblocks_68195;
    num_tblocks_69046 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_69044, segred_tblock_sizze_69045), max_num_tblocks_83158)));
    
    int64_t segmap_tblock_sizze_69059;
    
    segmap_tblock_sizze_69059 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_67951;
    
    int64_t segmap_usable_groups_69060 = sdiv_up_safe64((int64_t) 8, segmap_tblock_sizze_69059);
    int64_t segscan_tblock_sizze_69304;
    
    segscan_tblock_sizze_69304 = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_68500;
    
    int64_t num_tblocks_69305;
    int64_t max_num_tblocks_83159;
    
    max_num_tblocks_83159 = *ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_68502;
    num_tblocks_69305 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64((int64_t) 8, segscan_tblock_sizze_69304), max_num_tblocks_83159)));
    
    int64_t segscan_tblock_sizze_66899;
    
    segscan_tblock_sizze_66899 = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_66891;
    
    int64_t num_tblocks_66900;
    int64_t max_num_tblocks_83160;
    
    max_num_tblocks_83160 = *ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_66893;
    num_tblocks_66900 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64((int64_t) 8, segscan_tblock_sizze_66899), max_num_tblocks_83160)));
    
    int64_t tile_sizze_78072;
    
    tile_sizze_78072 = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071;
    
    int64_t ldim_78073 = sdiv_up_safe64((int64_t) 8, tile_sizze_78072);
    int64_t num_whole_tiles_78087 = squot_safe64(dz2083U_36759, tile_sizze_78072);
    int64_t residual_input_78168 = srem_safe64(dz2083U_36759, tile_sizze_78072);
    bool cond_78169 = residual_input_78168 == (int64_t) 0;
    int64_t binop_x_78179 = tile_sizze_78072 * num_whole_tiles_78087;
    
    if (memblock_alloc_device(ctx, &mem_81958, part_no_36754, "mem_81958")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_1b(ctx, 1, mem_81958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, clProc_mem_81937.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {part_no_36754})) != 0)
        goto cleanup;
    
    bool x_59551 = sle64((int64_t) 0, new_id_36801);
    bool y_59552 = slt64(new_id_36801, part_no_36754);
    bool bounds_check_59553 = x_59551 && y_59552;
    bool index_certs_59554;
    
    if (!bounds_check_59553) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) new_id_36801, "] out of bounds for array of shape [", (long long) part_no_36754, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:313:49-97\n   #1  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #2  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool write_tmp_86864 = 1;
    
    if ((err = gpu_scalar_to_device(ctx, mem_81958.mem, new_id_36801 * sizeof(bool), sizeof(bool), &write_tmp_86864)) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_69322;
    
    segmap_tblock_sizze_69322 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69321;
    
    int64_t num_tblocks_69324;
    int64_t max_num_tblocks_83161;
    
    max_num_tblocks_83161 = *ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_69323;
    num_tblocks_69324 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64((int64_t) 8, segmap_tblock_sizze_69322), max_num_tblocks_83161)));
    
    int64_t segscan_tblock_sizze_69328;
    
    segscan_tblock_sizze_69328 = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_69327;
    
    int64_t segscan_tblock_sizze_70731;
    
    segscan_tblock_sizze_70731 = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70730;
    
    int64_t num_tblocks_70733;
    int64_t max_num_tblocks_83162;
    
    max_num_tblocks_83162 = *ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_70732;
    num_tblocks_70733 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_old_36753, segscan_tblock_sizze_70731), max_num_tblocks_83162)));
    
    int64_t bytes_81960 = (int64_t) 8 * n_old_36753;
    
    if (memblock_alloc_device(ctx, &mem_81961, bytes_81960, "mem_81961")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81963, bytes_81960, "mem_81963")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81965, bytes_81960, "mem_81965")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, n_old_36753)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83163;
        
        shared_memory_83163 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83164;
        
        thread_block_sizze_83164 = ctx->max_thread_block_size;
        
        int64_t registers_83165;
        
        registers_83165 = ctx->max_registers;
        
        int64_t thread_block_sizze_83166;
        
        thread_block_sizze_83166 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83167 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83163, thread_block_sizze_83164), (int64_t) 8), squot64(squot64(registers_83165, thread_block_sizze_83166) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83168 = sdiv_up64(n_old_36753, segscan_tblock_sizze_70731 * chunk_sizze_83167);
        int64_t num_virt_threads_83169 = num_virt_blocks_83168 * segscan_tblock_sizze_70731;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83167, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83170, num_virt_blocks_83168, "status_flags_mem_83170")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83170, num_virt_blocks_83168, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83192, (int64_t) 8 * num_virt_blocks_83168, "aggregates_mem_83192")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83194, (int64_t) 8 * num_virt_blocks_83168, "incprefixes_mem_83194")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83196, (int64_t) 8 * num_virt_blocks_83168, "aggregates_mem_83196")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83198, (int64_t) 8 * num_virt_blocks_83168, "incprefixes_mem_83198")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezisegscan_70736(ctx, num_tblocks_70733, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70730, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70731, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70731), smax64(chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8, chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70731, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70731), smax64(chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8, chunk_sizze_83167 * segscan_tblock_sizze_70731 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), n_old_36753, num_tblocks_70733, num_virt_blocks_83168, num_virt_threads_83169, current_partition_mem_81943.mem, mem_81961.mem, mem_81963.mem, mem_81965.mem, status_flags_mem_83170.mem, aggregates_mem_83192.mem, incprefixes_mem_83194.mem, aggregates_mem_83196.mem, incprefixes_mem_83198.mem, global_dynid_mem_83200.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t last_index_60410 = n_old_36753 - (int64_t) 1;
    bool is_empty_60411 = n_old_36753 == (int64_t) 0;
    bool x_60412 = !is_empty_60411;
    int64_t last_offset_60413;
    
    if (x_60412) {
        int64_t read_res_86865;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86865, mem_81961.mem, last_index_60410 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66664 = read_res_86865;
        
        last_offset_60413 = x_66664;
    } else {
        last_offset_60413 = (int64_t) 0;
    }
    
    int64_t partition_sizze_60415;
    
    if (is_empty_60411) {
        partition_sizze_60415 = (int64_t) 0;
    } else {
        partition_sizze_60415 = last_offset_60413;
    }
    if (memblock_alloc_device(ctx, &mem_81967, bytes_81960, "mem_81967")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81969, bytes_81960, "mem_81969")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81970, n_old_36753, "mem_81970")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81972, bytes_81960, "mem_81972")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t y_60421 = (int64_t) -1 + partition_sizze_60415;
    int64_t segmap_tblock_sizze_70741;
    
    segmap_tblock_sizze_70741 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70740;
    
    int64_t num_tblocks_70743;
    int64_t max_num_tblocks_83355;
    
    max_num_tblocks_83355 = *ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_70742;
    num_tblocks_70743 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_old_36753, segmap_tblock_sizze_70741), max_num_tblocks_83355)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83356 = sext_i64_i32(sdiv_up64(n_old_36753, segmap_tblock_sizze_70741));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_70738(ctx, num_tblocks_70743, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70740, 1, 1, (int64_t) 0, n_old_36753, y_60421, num_tblocks_70743, virt_num_tblocks_83356, current_partition_mem_81939.mem, current_partition_mem_81940.mem, current_partition_mem_81941.mem, current_partition_mem_81942.mem, mem_81961.mem, mem_81963.mem, mem_81965.mem, mem_81967.mem, mem_81969.mem, mem_81970.mem, mem_81972.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81961, "mem_81961") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81965, "mem_81965") != 0)
        return 1;
    
    bool eq_x_zz_60441 = (int64_t) 0 == last_offset_60413;
    bool p_and_eq_x_y_60442 = x_60412 && eq_x_zz_60441;
    bool empty_slice_60443 = is_empty_60411 || p_and_eq_x_y_60442;
    int64_t m_60444 = sub64(partition_sizze_60415, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_60445 = sle64((int64_t) 0, m_60444);
    bool i_p_m_t_s_leq_w_60446 = slt64(m_60444, n_old_36753);
    bool i_lte_j_60447 = sle64((int64_t) 0, partition_sizze_60415);
    bool y_60448 = zzero_leq_i_p_m_t_s_60445 && i_p_m_t_s_leq_w_60446;
    bool forwards_ok_60449 = i_lte_j_60447 && y_60448;
    bool ok_or_empty_60450 = empty_slice_60443 || forwards_ok_60449;
    bool index_certs_60451;
    
    if (!ok_or_empty_60450) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) partition_sizze_60415, "] out of bounds for array of shape [", (long long) n_old_36753, "].", "-> #0  /prelude/soacs.fut:174:7-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t j_m_i_60456 = sub64(n_old_36753, partition_sizze_60415);
    bool empty_slice_60457 = j_m_i_60456 == (int64_t) 0;
    int64_t m_60458 = sub64(j_m_i_60456, (int64_t) 1);
    int64_t i_p_m_t_s_60459 = add64(partition_sizze_60415, m_60458);
    bool zzero_leq_i_p_m_t_s_60460 = sle64((int64_t) 0, i_p_m_t_s_60459);
    bool i_p_m_t_s_leq_w_60461 = slt64(i_p_m_t_s_60459, n_old_36753);
    bool i_lte_j_60462 = sle64(partition_sizze_60415, n_old_36753);
    bool y_60463 = zzero_leq_i_p_m_t_s_60460 && i_p_m_t_s_leq_w_60461;
    bool forwards_ok_60464 = i_lte_j_60462 && y_60463;
    bool ok_or_empty_60465 = empty_slice_60457 || forwards_ok_60464;
    bool index_certs_60466;
    
    if (!ok_or_empty_60465) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) partition_sizze_60415, ":", (long long) n_old_36753, "] out of bounds for array of shape [", (long long) n_old_36753, "].", "-> #0  /prelude/soacs.fut:174:21-33\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470 = add64(dz2082U_36758, partition_sizze_60415);
    bool cond_60493 = slt64((int64_t) 0, dz2083U_36759);
    bool loop_not_taken_60498 = !cond_60493;
    
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81975, (int64_t) 8, "mem_81975")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83369(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81932.mem, mem_81975.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81976, &mem_81975, "mem_81975") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81974, (int64_t) 8, "mem_81974")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81974, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81976, &mem_81974, "mem_81974") != 0)
            return 1;
    }
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81978, (int64_t) 8, "mem_81978")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83395(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81930.mem, mem_81978.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81979, &mem_81978, "mem_81978") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81977, (int64_t) 8, "mem_81977")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81977, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81979, &mem_81977, "mem_81977") != 0)
            return 1;
    }
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81981, (int64_t) 8, "mem_81981")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83401(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81932.mem, mem_81981.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81982, &mem_81981, "mem_81981") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81980, (int64_t) 8, "mem_81980")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81980, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81982, &mem_81980, "mem_81980") != 0)
            return 1;
    }
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81984, (int64_t) 8, "mem_81984")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83407(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81930.mem, mem_81984.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81985, &mem_81984, "mem_81984") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81983, (int64_t) 8, "mem_81983")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81983, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81985, &mem_81983, "mem_81983") != 0)
            return 1;
    }
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81987, (int64_t) 8, "mem_81987")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83413(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81932.mem, mem_81987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81988, &mem_81987, "mem_81987") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81986, (int64_t) 8, "mem_81986")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81986, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81988, &mem_81986, "mem_81986") != 0)
            return 1;
    }
    if (cond_60493) {
        if (memblock_alloc_device(ctx, &mem_81990, (int64_t) 8, "mem_81990")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezigpuseq_83419(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clBase_mem_81932.mem, mem_81990.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81991, &mem_81990, "mem_81990") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81989, (int64_t) 8, "mem_81989")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_f64(ctx, mem_81989, (int64_t) 1, 0.0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81991, &mem_81989, "mem_81989") != 0)
            return 1;
    }
    
    int64_t segscan_tblock_sizze_70747;
    
    segscan_tblock_sizze_70747 = *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70746;
    
    int64_t num_tblocks_70749;
    int64_t max_num_tblocks_83425;
    
    max_num_tblocks_83425 = *ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_70748;
    num_tblocks_70749 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, segscan_tblock_sizze_70747), max_num_tblocks_83425)));
    
    int64_t last_index_60742 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470 - (int64_t) 1;
    bool is_empty_60743 = dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470 == (int64_t) 0;
    bool x_60744 = !is_empty_60743;
    int64_t bytes_81992 = (int64_t) 8 * dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470;
    
    if (memblock_alloc_device(ctx, &mem_81997, (int64_t) 64, "mem_81997")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81998, (int64_t) 16, "mem_81998")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81999, (int64_t) 16, "mem_81999")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82000, (int64_t) 8, "mem_82000")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82001, (int64_t) 64, "mem_82001")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82002, (int64_t) 0, "mem_82002")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82003, (int64_t) 16, "mem_82003")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82004, (int64_t) 16, "mem_82004")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_add_next_partition_doublezigpuseq_83426(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, new_id_36801, loop_not_taken_60498, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, mem_81997.mem, mem_81998.mem, mem_81999.mem, mem_82000.mem, mem_82001.mem, mem_82002.mem, mem_82003.mem, mem_82004.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (memblock_unref_device(ctx, &mem_81997, "mem_81997") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81998, "mem_81998") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81999, "mem_81999") != 0)
        return 1;
    
    int64_t bytes_82028 = (int64_t) 8 * tile_sizze_78072;
    int64_t shared_memory_capacity_83672;
    
    shared_memory_capacity_83672 = ctx->max_shared_memory;
    if (suff_outer_par_68508 && sle64(sdiv_up64(bytes_82028, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83672)) {
        if (memblock_alloc_device(ctx, &mem_82051, (int64_t) 64, "mem_82051")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82052, (int64_t) 64, "mem_82052")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82053, (int64_t) 8, "mem_82053")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_83536 = sext_i64_i32(sdiv_up64(tile_sizze_78072, tile_sizze_78072));
        int32_t virt_num_tblocks_83537 = sext_i64_i32(ldim_78073);
        
        {
            err = gpu_kernel_add_next_partition_doublezisegmap_intrablock_78070(ctx, ldim_78073, 1, 1, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78071, 1, 1, bytes_82028 + srem64((int64_t) 8 - srem64(bytes_82028, (int64_t) 8), (int64_t) 8), part_no_36754, dz2083U_36759, n_new_36762, clBase_36765, clBase_36766, clBase_36767, clBase_36773, num_whole_tiles_78087, residual_input_78168, cond_78169, binop_x_78179, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, clProc_mem_81937.mem, clProc_mem_81938.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82051.mem, mem_82052.mem, mem_82053.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82056, &mem_82051, "mem_82051") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82055, &mem_82052, "mem_82052") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82054, &mem_82053, "mem_82053") != 0)
            return 1;
    } else {
        int64_t shared_memory_capacity_83671;
        
        shared_memory_capacity_83671 = ctx->max_shared_memory;
        if (intra_suff_and_fits_68516 && sle64(sdiv_up64(dz2083U_36759, (int64_t) 8) * (int64_t) 8 + sdiv_up64(n_new_36762, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83671)) {
            if (memblock_alloc_device(ctx, &mem_82013, (int64_t) 64, "mem_82013")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82014, (int64_t) 64, "mem_82014")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82015, (int64_t) 8, "mem_82015")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_83556 = sext_i64_i32(sdiv_up64(dz2083U_36759, computed_tblock_sizze_68510));
            int32_t num_chunks_83557 = sext_i64_i32(sdiv_up64(n_new_36762, computed_tblock_sizze_68510));
            int32_t virt_num_tblocks_83558 = 8;
            
            {
                err = gpu_kernel_add_next_partition_doublezisegmap_intrablock_68780(ctx, (int64_t) 8, 1, 1, computed_tblock_sizze_68510, 1, 1, n_new_36762 + srem64((int64_t) 8 - srem64(n_new_36762, (int64_t) 8), (int64_t) 8) + (dz2083U_36759 + srem64((int64_t) 8 - srem64(dz2083U_36759, (int64_t) 8), (int64_t) 8)), part_no_36754, dz2083U_36759, n_new_36762, clBase_36765, clBase_36766, clBase_36767, clBase_36773, computed_tblock_sizze_68510, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, clProc_mem_81937.mem, clProc_mem_81938.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82013.mem, mem_82014.mem, mem_82015.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_82018, &mem_82013, "mem_82013") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82017, &mem_82014, "mem_82014") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82016, &mem_82015, "mem_82015") != 0)
                return 1;
        } else {
            int64_t segmap_usable_groups_69032 = sdiv_up64((int64_t) 8, segmap_tblock_sizze_69031);
            
            if (memblock_alloc_device(ctx, &mem_82006, (int64_t) 8, "mem_82006")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83580 = sext_i64_i32(sdiv_up64((int64_t) 8, segmap_tblock_sizze_69031));
            
            {
                err = gpu_kernel_add_next_partition_doublezisegmap_69035(ctx, segmap_usable_groups_69032, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_68212, 1, 1, (int64_t) 0, part_no_36754, clProc_mem_81937.mem, mem_82001.mem, mem_82006.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_82008, (int64_t) 8, "mem_82008")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_83589 = (int64_t) 1;
            
            if (slt64(dz2083U_36759 * (int64_t) 2, segred_tblock_sizze_69045 * chunk_sizze_83589)) {
                int64_t segment_sizze_nonzzero_83590 = smax64((int64_t) 1, dz2083U_36759);
                int64_t num_threads_83591 = segred_tblock_sizze_69045 * segred_tblock_sizze_69045;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) (int64_t) 8, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2083U_36759, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64((int64_t) 8, squot64(segred_tblock_sizze_69045, segment_sizze_nonzzero_83590))), '\n');
                {
                    err = gpu_kernel_add_next_partition_doublezisegred_small_69051(ctx, num_tblocks_69046, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193, 1, 1, segred_tblock_sizze_69045 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_69045, (int64_t) 8), (int64_t) 8), dz2083U_36759, num_tblocks_69046, segment_sizze_nonzzero_83590, clProc_mem_81938.mem, mem_82001.mem, mem_82008.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_83618 = sdiv_up64(num_tblocks_69046, smax64((int64_t) 1, (int64_t) 8));
                int64_t q_83619 = sdiv_up64(dz2083U_36759, segred_tblock_sizze_69045 * blocks_per_segment_83618 * chunk_sizze_83589);
                int64_t num_virtblocks_83620 = blocks_per_segment_83618 * (int64_t) 8;
                int64_t threads_per_segment_83621 = blocks_per_segment_83618 * segred_tblock_sizze_69045;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) (int64_t) 8, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2083U_36759, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_83620, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_69046, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_69045, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_83619, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_83618, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_83622, num_virtblocks_83620, "segred_tmp_mem_83622")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_add_next_partition_doublezisegred_large_69051(ctx, num_tblocks_69046, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_68193, 1, 1, 8 + (segred_tblock_sizze_69045 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_69045, (int64_t) 8), (int64_t) 8)), dz2083U_36759, num_tblocks_69046, blocks_per_segment_83618, q_83619, num_virtblocks_83620, threads_per_segment_83621, clProc_mem_81938.mem, mem_82001.mem, mem_82008.mem, segred_tmp_mem_83622.mem, counters_mem_83624.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_82010, (int64_t) 64, "mem_82010")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82011, (int64_t) 64, "mem_82011")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83661 = sext_i64_i32(sdiv_up64((int64_t) 8, segmap_tblock_sizze_69059));
            
            {
                err = gpu_kernel_add_next_partition_doublezisegmap_69064(ctx, segmap_usable_groups_69060, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_67951, 1, 1, (int64_t) 0, n_new_36762, clBase_36765, clBase_36766, clBase_36767, clBase_36773, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82008.mem, mem_82010.mem, mem_82011.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82008, "mem_82008") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82018, &mem_82010, "mem_82010") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82017, &mem_82011, "mem_82011") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82016, &mem_82006, "mem_82006") != 0)
                return 1;
        }
        if (memblock_set_device(ctx, &ext_mem_82056, &ext_mem_82018, "ext_mem_82018") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82055, &ext_mem_82017, "ext_mem_82017") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82054, &ext_mem_82016, "ext_mem_82016") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_82057, (int64_t) 64, "mem_82057")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 8})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82059, (int64_t) 64, "mem_82059")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, (int64_t) 8)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83673;
        
        shared_memory_83673 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83674;
        
        thread_block_sizze_83674 = ctx->max_thread_block_size;
        
        int64_t registers_83675;
        
        registers_83675 = ctx->max_registers;
        
        int64_t thread_block_sizze_83676;
        
        thread_block_sizze_83676 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83677 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83673, thread_block_sizze_83674), (int64_t) 8), squot64(squot64(registers_83675, thread_block_sizze_83676) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83678 = sdiv_up64((int64_t) 8, segscan_tblock_sizze_69304 * chunk_sizze_83677);
        int64_t num_virt_threads_83679 = num_virt_blocks_83678 * segscan_tblock_sizze_69304;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83677, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83680, num_virt_blocks_83678, "status_flags_mem_83680")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83680, num_virt_blocks_83678, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83682, (int64_t) 8 * num_virt_blocks_83678, "aggregates_mem_83682")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83684, (int64_t) 8 * num_virt_blocks_83678, "incprefixes_mem_83684")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezisegscan_69309(ctx, num_tblocks_69305, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_68500, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69304), chunk_sizze_83677 * segscan_tblock_sizze_69304 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69304), chunk_sizze_83677 * segscan_tblock_sizze_69304 * (int64_t) 8), (int64_t) 8), (int64_t) 8), num_tblocks_69305, num_virt_blocks_83678, num_virt_threads_83679, ext_mem_82056.mem, mem_82059.mem, status_flags_mem_83680.mem, aggregates_mem_83682.mem, incprefixes_mem_83684.mem, global_dynid_mem_83686.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_82056, "ext_mem_82056") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82068, &mem_82059, "mem_82059") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82067, &mem_82057, "mem_82057") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82066, &ext_mem_82055, "ext_mem_82055") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82065, &ext_mem_82054, "ext_mem_82054") != 0)
        return 1;
    
    int64_t read_res_86866;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_86866, ext_mem_82068.mem, (int64_t) 7 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t m_f_res_59848 = read_res_86866;
    int64_t m_59856 = sub64(m_f_res_59848, (int64_t) 1);
    bool i_p_m_t_s_leq_w_59858 = slt64(m_59856, (int64_t) 8);
    bool zzero_leq_i_p_m_t_s_59857 = sle64((int64_t) 0, m_59856);
    bool y_59860 = zzero_leq_i_p_m_t_s_59857 && i_p_m_t_s_leq_w_59858;
    bool i_lte_j_59859 = sle64((int64_t) 0, m_f_res_59848);
    bool forwards_ok_59861 = i_lte_j_59859 && y_59860;
    bool empty_slice_59855 = m_f_res_59848 == (int64_t) 0;
    bool ok_or_empty_59862 = empty_slice_59855 || forwards_ok_59861;
    bool index_certs_59863;
    
    if (!ok_or_empty_59862) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_f_res_59848, "] out of bounds for array of shape [", (long long) (int64_t) 8, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82069 = (int64_t) 8 * m_f_res_59848;
    
    if (memblock_alloc_device(ctx, &mem_82070, bytes_82069, "mem_82070")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82070.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82066.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_f_res_59848})) != 0)
        goto cleanup;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83775 = sext_i64_i32(sdiv_up64((int64_t) 8, segmap_tblock_sizze_69322));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_69319(ctx, num_tblocks_69324, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69321, 1, 1, (int64_t) 0, m_f_res_59848, num_tblocks_69324, virt_num_tblocks_83775, ext_mem_82066.mem, ext_mem_82067.mem, ext_mem_82068.mem, mem_82070.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_82066, "ext_mem_82066") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82067, "ext_mem_82067") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82068, "ext_mem_82068") != 0)
        return 1;
    
    int64_t conc_tmp_59874 = dz2083U_36759 + m_f_res_59848;
    int64_t bytes_82072 = (int64_t) 8 * conc_tmp_59874;
    int64_t num_tblocks_69330;
    int64_t max_num_tblocks_83788;
    
    max_num_tblocks_83788 = *ctx->tuning_params.add_next_partition_doublezisegscan_num_tblocks_69329;
    num_tblocks_69330 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_59874, segscan_tblock_sizze_69328), max_num_tblocks_83788)));
    if (memblock_alloc_device(ctx, &mem_82076, bytes_82072, "mem_82076")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82078, bytes_82072, "mem_82078")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_59874)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83789;
        
        shared_memory_83789 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83790;
        
        thread_block_sizze_83790 = ctx->max_thread_block_size;
        
        int64_t registers_83791;
        
        registers_83791 = ctx->max_registers;
        
        int64_t thread_block_sizze_83792;
        
        thread_block_sizze_83792 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83793 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83789, thread_block_sizze_83790), (int64_t) 8), squot64(squot64(registers_83791, thread_block_sizze_83792) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83794 = sdiv_up64(conc_tmp_59874, segscan_tblock_sizze_69328 * chunk_sizze_83793);
        int64_t num_virt_threads_83795 = num_virt_blocks_83794 * segscan_tblock_sizze_69328;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83793, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83796, num_virt_blocks_83794, "status_flags_mem_83796")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83796, num_virt_blocks_83794, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83798, (int64_t) 8 * num_virt_blocks_83794, "aggregates_mem_83798")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83800, (int64_t) 8 * num_virt_blocks_83794, "incprefixes_mem_83800")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezisegscan_69333(ctx, num_tblocks_69330, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_69327, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69328), chunk_sizze_83793 * segscan_tblock_sizze_69328 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_69328), chunk_sizze_83793 * segscan_tblock_sizze_69328 * (int64_t) 8), (int64_t) 8), (int64_t) 8), part_no_36754, dz2083U_36759, conc_tmp_59874, num_tblocks_69330, num_virt_blocks_83794, num_virt_threads_83795, clProc_mem_81938.mem, mem_81958.mem, mem_82070.mem, mem_82076.mem, mem_82078.mem, status_flags_mem_83796.mem, aggregates_mem_83798.mem, incprefixes_mem_83800.mem, global_dynid_mem_83802.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool cond_59890 = conc_tmp_59874 == (int64_t) 0;
    bool x_59891 = !cond_59890;
    int64_t tmp_59892 = sub64(conc_tmp_59874, (int64_t) 1);
    bool x_59893 = sle64((int64_t) 0, tmp_59892);
    bool y_59894 = slt64(tmp_59892, conc_tmp_59874);
    bool bounds_check_59895 = x_59893 && y_59894;
    bool protect_assert_disj_59896 = cond_59890 || bounds_check_59895;
    bool index_certs_59897;
    
    if (!protect_assert_disj_59896) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_59892, "] out of bounds for array of shape [", (long long) conc_tmp_59874, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_59898;
    
    if (x_59891) {
        int64_t read_res_86867;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86867, mem_82076.mem, tmp_59892 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66349 = read_res_86867;
        
        m_f_res_59898 = x_66349;
    } else {
        m_f_res_59898 = (int64_t) 0;
    }
    
    int64_t m_59900;
    
    if (cond_59890) {
        m_59900 = (int64_t) 0;
    } else {
        m_59900 = m_f_res_59898;
    }
    
    int64_t m_59910 = sub64(m_59900, (int64_t) 1);
    bool i_p_m_t_s_leq_w_59912 = slt64(m_59910, conc_tmp_59874);
    bool zzero_leq_i_p_m_t_s_59911 = sle64((int64_t) 0, m_59910);
    bool y_59914 = zzero_leq_i_p_m_t_s_59911 && i_p_m_t_s_leq_w_59912;
    bool i_lte_j_59913 = sle64((int64_t) 0, m_59900);
    bool forwards_ok_59915 = i_lte_j_59913 && y_59914;
    bool eq_x_zz_59907 = (int64_t) 0 == m_f_res_59898;
    bool p_and_eq_x_y_59908 = x_59891 && eq_x_zz_59907;
    bool empty_slice_59909 = cond_59890 || p_and_eq_x_y_59908;
    bool ok_or_empty_59916 = empty_slice_59909 || forwards_ok_59915;
    bool index_certs_59917;
    
    if (!ok_or_empty_59916) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_59900, "] out of bounds for array of shape [", (long long) conc_tmp_59874, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82079 = (int64_t) 8 * m_59900;
    bool nonzzero_cert_60500 = 0;
    
    if (memblock_unref_device(ctx, &mem_82002, "mem_82002") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82115, bytes_81992, "mem_82115")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82117, bytes_81992, "mem_82117")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82119, bytes_81992, "mem_82119")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83891;
        
        shared_memory_83891 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83892;
        
        thread_block_sizze_83892 = ctx->max_thread_block_size;
        
        int64_t registers_83893;
        
        registers_83893 = ctx->max_registers;
        
        int64_t thread_block_sizze_83894;
        
        thread_block_sizze_83894 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83895 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83891, thread_block_sizze_83892), (int64_t) 8), squot64(squot64(registers_83893, thread_block_sizze_83894) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83896 = sdiv_up64(dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, segscan_tblock_sizze_70747 * chunk_sizze_83895);
        int64_t num_virt_threads_83897 = num_virt_blocks_83896 * segscan_tblock_sizze_70747;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83895, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83898, num_virt_blocks_83896, "status_flags_mem_83898")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83898, num_virt_blocks_83896, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83900, (int64_t) 8 * num_virt_blocks_83896, "aggregates_mem_83900")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83902, (int64_t) 8 * num_virt_blocks_83896, "incprefixes_mem_83902")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83904, (int64_t) 8 * num_virt_blocks_83896, "aggregates_mem_83904")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83906, (int64_t) 8 * num_virt_blocks_83896, "incprefixes_mem_83906")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_add_next_partition_doublezisegscan_70752(ctx, num_tblocks_70749, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegscan_tblock_sizze_70746, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70747, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70747), smax64(chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8, chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_70747, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_70747), smax64(chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8, chunk_sizze_83895 * segscan_tblock_sizze_70747 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), dz2082U_36758, dz2083U_36759, clBase_36765, clBase_36766, clBase_36773, zt_res_59476, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, cond_60493, num_tblocks_70749, num_virt_blocks_83896, num_virt_threads_83897, clProc_mem_81935.mem, clProc_mem_81936.mem, clProc_mem_81938.mem, mem_81967.mem, mem_81969.mem, ext_mem_81976.mem, ext_mem_81979.mem, ext_mem_81982.mem, ext_mem_81985.mem, ext_mem_81988.mem, ext_mem_81991.mem, mem_82000.mem, mem_82115.mem, mem_82117.mem, mem_82119.mem, status_flags_mem_83898.mem, aggregates_mem_83900.mem, incprefixes_mem_83902.mem, aggregates_mem_83904.mem, incprefixes_mem_83906.mem, global_dynid_mem_83908.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_81976, "ext_mem_81976") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81979, "ext_mem_81979") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81982, "ext_mem_81982") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81985, "ext_mem_81985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81988, "ext_mem_81988") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81991, "ext_mem_81991") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82000, "mem_82000") != 0)
        return 1;
    
    int64_t last_offset_60745;
    
    if (x_60744) {
        int64_t read_res_86868;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86868, mem_82115.mem, last_index_60742 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66720 = read_res_86868;
        
        last_offset_60745 = x_66720;
    } else {
        last_offset_60745 = (int64_t) 0;
    }
    
    int64_t partition_sizze_60747;
    
    if (is_empty_60743) {
        partition_sizze_60747 = (int64_t) 0;
    } else {
        partition_sizze_60747 = last_offset_60745;
    }
    
    bool eq_x_zz_60764 = (int64_t) 0 == last_offset_60745;
    bool p_and_eq_x_y_60765 = x_60744 && eq_x_zz_60764;
    bool empty_slice_60766 = is_empty_60743 || p_and_eq_x_y_60765;
    int64_t m_60767 = sub64(partition_sizze_60747, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_60768 = sle64((int64_t) 0, m_60767);
    bool i_p_m_t_s_leq_w_60769 = slt64(m_60767, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);
    bool i_lte_j_60770 = sle64((int64_t) 0, partition_sizze_60747);
    bool y_60771 = zzero_leq_i_p_m_t_s_60768 && i_p_m_t_s_leq_w_60769;
    bool forwards_ok_60772 = i_lte_j_60770 && y_60771;
    bool ok_or_empty_60773 = empty_slice_60766 || forwards_ok_60772;
    bool index_certs_60774;
    
    if (!ok_or_empty_60773) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) partition_sizze_60747, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, "].", "-> #0  /prelude/soacs.fut:174:7-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82122 = (int64_t) 8 * partition_sizze_60747;
    int64_t j_m_i_60776 = sub64(dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, partition_sizze_60747);
    bool empty_slice_60777 = j_m_i_60776 == (int64_t) 0;
    int64_t m_60778 = sub64(j_m_i_60776, (int64_t) 1);
    int64_t i_p_m_t_s_60779 = add64(partition_sizze_60747, m_60778);
    bool zzero_leq_i_p_m_t_s_60780 = sle64((int64_t) 0, i_p_m_t_s_60779);
    bool i_p_m_t_s_leq_w_60781 = slt64(i_p_m_t_s_60779, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);
    bool i_lte_j_60782 = sle64(partition_sizze_60747, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470);
    bool y_60783 = zzero_leq_i_p_m_t_s_60780 && i_p_m_t_s_leq_w_60781;
    bool forwards_ok_60784 = i_lte_j_60782 && y_60783;
    bool ok_or_empty_60785 = empty_slice_60777 || forwards_ok_60784;
    bool index_certs_60786;
    
    if (!ok_or_empty_60785) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) partition_sizze_60747, ":", (long long) dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, "].", "-> #0  /prelude/soacs.fut:174:21-33\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1037:18-1042:84\n   #3  ft_libs/ftDBSCAN_plus.fut:1036:9-1042:84\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t conc_tmp_60863 = j_m_i_60456 + j_m_i_60776;
    int64_t bytes_82136 = (int64_t) 8 * conc_tmp_60863;
    
    if (memblock_alloc_device(ctx, &mem_81955, bytes_81954, "mem_81955")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81955.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, new_ys_mem_81953.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_new_36762})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_81957, bytes_81954, "mem_81957")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81957.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, new_xs_mem_81952.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_new_36762})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_69338;
    
    segmap_tblock_sizze_69338 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69337;
    
    bool suff_outer_par_69343;
    
    suff_outer_par_69343 = *ctx->tuning_params.add_next_partition_doublezisuff_outer_par_3 <= n_new_36762;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "add_next_partition_double.suff_outer_par_3", (long) n_new_36762, suff_outer_par_69343 ? "true" : "false");
    
    int64_t segred_tblock_sizze_70038;
    
    segred_tblock_sizze_70038 = *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805;
    
    int64_t num_tblocks_70039;
    int64_t max_num_tblocks_84046;
    
    max_num_tblocks_84046 = *ctx->tuning_params.add_next_partition_doublezisegred_num_tblocks_69807;
    num_tblocks_70039 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(bytes_81954, segred_tblock_sizze_70038), max_num_tblocks_84046)));
    
    int64_t tile_sizze_78476;
    
    tile_sizze_78476 = *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475;
    
    int64_t segmap_tblock_sizze_70500;
    
    segmap_tblock_sizze_70500 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70270;
    
    int64_t segmap_usable_groups_70501 = sdiv_up64(n_new_36762, segmap_tblock_sizze_70500);
    int64_t conc_tmp_60489 = dz2080U_36756 + partition_sizze_60415;
    int64_t conc_tmp_60490 = dz2081U_36757 + partition_sizze_60415;
    
    if (memblock_alloc_device(ctx, &mem_81993, bytes_81992, "mem_81993")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_70757;
    
    segmap_tblock_sizze_70757 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70756;
    
    int64_t num_tblocks_70759;
    int64_t max_num_tblocks_84047;
    
    max_num_tblocks_84047 = *ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_70758;
    num_tblocks_70759 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, segmap_tblock_sizze_70757), max_num_tblocks_84047)));
    
    int64_t segmap_tblock_sizze_70800;
    
    segmap_tblock_sizze_70800 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70764;
    
    int64_t segmap_tblock_sizze_70869;
    
    segmap_tblock_sizze_70869 = *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70841;
    
    int64_t new_proc_60866 = add64((int64_t) 1, clProc_36782);
    int64_t new_proc_60867 = add64(n_new_36762, clProc_36784);
    
    if (memblock_alloc_device(ctx, &mem_81994, n_new_36762, "mem_81994")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_bool(ctx, mem_81994, n_new_36762, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81996, bytes_81954, "mem_81996")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81996, n_new_36762, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82073, bytes_82072, "mem_82073")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_84088 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82073.mem, tmp_offs_84088, (int64_t []) {(int64_t) 1}, clProc_mem_81938.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2083U_36759})) != 0)
        goto cleanup;
    tmp_offs_84088 += dz2083U_36759;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82073.mem, tmp_offs_84088, (int64_t []) {(int64_t) 1}, mem_82070.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_f_res_59848})) != 0)
        goto cleanup;
    tmp_offs_84088 += m_f_res_59848;
    if (memblock_alloc_device(ctx, &mem_82080, bytes_82079, "mem_82080")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82080.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82073.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_59900})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_82073, "mem_82073") != 0)
        return 1;
    
    int64_t num_tblocks_69340;
    int64_t max_num_tblocks_84089;
    
    max_num_tblocks_84089 = *ctx->tuning_params.add_next_partition_doublezisegmap_num_tblocks_69339;
    num_tblocks_69340 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_59874, segmap_tblock_sizze_69338), max_num_tblocks_84089)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84090 = sext_i64_i32(sdiv_up64(conc_tmp_59874, segmap_tblock_sizze_69338));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_69335(ctx, num_tblocks_69340, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_69337, 1, 1, (int64_t) 0, dz2083U_36759, conc_tmp_59874, m_59900, num_tblocks_69340, virt_num_tblocks_84090, clProc_mem_81938.mem, mem_82070.mem, mem_82076.mem, mem_82078.mem, mem_82080.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82070, "mem_82070") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82076, "mem_82076") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82078, "mem_82078") != 0)
        return 1;
    
    int64_t num_whole_tiles_78497 = squot_safe64((int64_t) 8, tile_sizze_78476);
    int64_t residual_input_79224 = srem_safe64((int64_t) 8, tile_sizze_78476);
    bool cond_79225 = residual_input_79224 == (int64_t) 0;
    int64_t binop_x_79235 = tile_sizze_78476 * num_whole_tiles_78497;
    int64_t bytes_82097 = (int64_t) 8 * tile_sizze_78476;
    int64_t shared_memory_capacity_84192;
    
    shared_memory_capacity_84192 = ctx->max_shared_memory;
    if (suff_outer_par_69343 && sle64(sdiv_up64(bytes_82097, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_84192)) {
        int64_t ldim_78477 = sdiv_up64(n_new_36762, tile_sizze_78476);
        
        if (memblock_alloc_device(ctx, &mem_82109, n_new_36762, "mem_82109")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_84103 = sext_i64_i32(sdiv_up64(tile_sizze_78476, tile_sizze_78476));
        int32_t virt_num_tblocks_84104 = sext_i64_i32(ldim_78477);
        
        {
            err = gpu_kernel_add_next_partition_doublezisegmap_intrablock_78474(ctx, ldim_78477, 1, 1, *ctx->tuning_params.add_next_partition_doublezitile_sizze_78475, 1, 1, bytes_82097 + srem64((int64_t) 8 - srem64(bytes_82097, (int64_t) 8), (int64_t) 8), n_new_36762, clBase_36765, clBase_36766, clBase_36773, zt_res_59476, ldim_78477, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82109.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82110, &mem_82109, "mem_82109") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82083, n_new_36762, "mem_82083")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegRed");
        
        int64_t chunk_sizze_84120 = (int64_t) 1;
        
        if (slt64((int64_t) 16, segred_tblock_sizze_70038 * chunk_sizze_84120)) {
            int64_t segment_sizze_nonzzero_84121 = smax64((int64_t) 1, (int64_t) 8);
            int64_t num_threads_84122 = segred_tblock_sizze_70038 * segred_tblock_sizze_70038;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "# SegRed-small");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) n_new_36762, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) (int64_t) 8, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121), '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(n_new_36762, squot64(segred_tblock_sizze_70038, segment_sizze_nonzzero_84121))), '\n');
            {
                err = gpu_kernel_add_next_partition_doublezisegred_small_70044(ctx, num_tblocks_70039, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805, 1, 1, segred_tblock_sizze_70038 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_70038, (int64_t) 8), (int64_t) 8), n_new_36762, clBase_36765, clBase_36766, clBase_36773, zt_res_59476, num_tblocks_70039, segment_sizze_nonzzero_84121, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82083.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
        } else {
            int64_t blocks_per_segment_84149 = sdiv_up64(num_tblocks_70039, smax64((int64_t) 1, n_new_36762));
            int64_t q_84150 = sdiv_up64((int64_t) 8, segred_tblock_sizze_70038 * blocks_per_segment_84149 * chunk_sizze_84120);
            int64_t num_virtblocks_84151 = blocks_per_segment_84149 * n_new_36762;
            int64_t threads_per_segment_84152 = blocks_per_segment_84149 * segred_tblock_sizze_70038;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "# SegRed-large");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) n_new_36762, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) (int64_t) 8, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_84151, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_70039, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_70038, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_84150, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_84149, '\n');
            if (memblock_alloc_device(ctx, &segred_tmp_mem_84153, num_virtblocks_84151, "segred_tmp_mem_84153")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_add_next_partition_doublezisegred_large_70044(ctx, num_tblocks_70039, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegred_tblock_sizze_69805, 1, 1, 8 + (segred_tblock_sizze_70038 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_70038, (int64_t) 8), (int64_t) 8)), n_new_36762, clBase_36765, clBase_36766, clBase_36773, zt_res_59476, num_tblocks_70039, blocks_per_segment_84149, q_84150, num_virtblocks_84151, threads_per_segment_84152, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, mem_82083.mem, segred_tmp_mem_84153.mem, counters_mem_84155.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82110, &mem_82083, "mem_82083") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_82112, n_new_36762, "mem_82112")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84193 = sext_i64_i32(sdiv_up64(n_new_36762, segmap_tblock_sizze_70500));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_70504(ctx, segmap_usable_groups_70501, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70270, 1, 1, (int64_t) 0, n_new_36762, clBase_36765, clBase_36766, clBase_36767, clBase_36773, clBase_mem_81930.mem, clBase_mem_81931.mem, clBase_mem_81932.mem, new_xs_mem_81952.mem, new_ys_mem_81953.mem, mem_82001.mem, ext_mem_82110.mem, mem_82112.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t y_60750 = (int64_t) -1 + partition_sizze_60747;
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84203 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, segmap_tblock_sizze_70757));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_70754(ctx, num_tblocks_70759, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70756, 1, 1, (int64_t) 0, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, y_60750, num_tblocks_70759, virt_num_tblocks_84203, mem_81993.mem, mem_82115.mem, mem_82117.mem, mem_82119.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82115, "mem_82115") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82117, "mem_82117") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82119, "mem_82119") != 0)
        return 1;
    
    int64_t segmap_usable_groups_70801 = sdiv_up64(partition_sizze_60747, segmap_tblock_sizze_70800);
    
    if (memblock_alloc_device(ctx, &mem_82123, bytes_82122, "mem_82123")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82125, bytes_82122, "mem_82125")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82126, partition_sizze_60747, "mem_82126")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82128, bytes_82122, "mem_82128")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84216 = sext_i64_i32(sdiv_up64(partition_sizze_60747, segmap_tblock_sizze_70800));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_70807(ctx, segmap_usable_groups_70801, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70764, 1, 1, (int64_t) 0, dz2080U_36756, dz2081U_36757, dz2082U_36758, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, conc_tmp_60489, conc_tmp_60490, partition_sizze_60747, clProc_mem_81933.mem, clProc_mem_81934.mem, clProc_mem_81935.mem, clProc_mem_81936.mem, mem_81967.mem, mem_81969.mem, mem_81970.mem, mem_81972.mem, mem_81993.mem, mem_82123.mem, mem_82125.mem, mem_82126.mem, mem_82128.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81970, "mem_81970") != 0)
        return 1;
    
    int64_t segmap_usable_groups_70870 = sdiv_up64(j_m_i_60776, segmap_tblock_sizze_70869);
    
    if (memblock_alloc_device(ctx, &mem_82137, bytes_82136, "mem_82137")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82139, bytes_82136, "mem_82139")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82141, bytes_82136, "mem_82141")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84225 = sext_i64_i32(sdiv_up64(j_m_i_60776, segmap_tblock_sizze_70869));
    
    {
        err = gpu_kernel_add_next_partition_doublezisegmap_70875(ctx, segmap_usable_groups_70870, 1, 1, *ctx->tuning_params.add_next_partition_doublezisegmap_tblock_sizze_70841, 1, 1, (int64_t) 0, dz2081U_36757, dz2082U_36758, j_m_i_60456, dzlz7bUZLzpZRz20Udz2082Uz20Udz2084Uz2083Uz2082Uz7dUzg_60470, conc_tmp_60490, partition_sizze_60747, j_m_i_60776, clProc_mem_81934.mem, clProc_mem_81935.mem, clProc_mem_81936.mem, mem_81967.mem, mem_81969.mem, mem_81972.mem, mem_81993.mem, mem_82137.mem, mem_82139.mem, mem_82141.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81993, "mem_81993") != 0)
        return 1;
    
    int64_t tmp_offs_84234 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82137.mem, tmp_offs_84234, (int64_t []) {(int64_t) 1}, mem_81967.mem, partition_sizze_60415, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60456})) != 0)
        goto cleanup;
    tmp_offs_84234 += j_m_i_60456;
    if (!(tmp_offs_84234 == j_m_i_60456)) {
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82137.mem, tmp_offs_84234, (int64_t []) {(int64_t) 1}, mem_82137.mem, j_m_i_60456, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60776})) != 0)
            goto cleanup;
    }
    tmp_offs_84234 += j_m_i_60776;
    if (memblock_unref_device(ctx, &mem_81967, "mem_81967") != 0)
        return 1;
    
    int64_t tmp_offs_84235 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82139.mem, tmp_offs_84235, (int64_t []) {(int64_t) 1}, mem_81969.mem, partition_sizze_60415, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60456})) != 0)
        goto cleanup;
    tmp_offs_84235 += j_m_i_60456;
    if (!(tmp_offs_84235 == j_m_i_60456)) {
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82139.mem, tmp_offs_84235, (int64_t []) {(int64_t) 1}, mem_82139.mem, j_m_i_60456, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60776})) != 0)
            goto cleanup;
    }
    tmp_offs_84235 += j_m_i_60776;
    if (memblock_unref_device(ctx, &mem_81969, "mem_81969") != 0)
        return 1;
    
    int64_t tmp_offs_84236 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82141.mem, tmp_offs_84236, (int64_t []) {(int64_t) 1}, mem_81972.mem, partition_sizze_60415, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60456})) != 0)
        goto cleanup;
    tmp_offs_84236 += j_m_i_60456;
    if (!(tmp_offs_84236 == j_m_i_60456)) {
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82141.mem, tmp_offs_84236, (int64_t []) {(int64_t) 1}, mem_82141.mem, j_m_i_60456, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_60776})) != 0)
            goto cleanup;
    }
    tmp_offs_84236 += j_m_i_60776;
    if (memblock_unref_device(ctx, &mem_81972, "mem_81972") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83117, &chain_collisions_mem_81927, "chain_collisions_mem_81927") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83118, &chain_collisions_mem_81928, "chain_collisions_mem_81928") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83119, &clBase_mem_81929, "clBase_mem_81929") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83120, &clBase_mem_81930, "clBase_mem_81930") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83121, &clBase_mem_81931, "clBase_mem_81931") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83122, &clBase_mem_81932, "clBase_mem_81932") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83123, &mem_82126, "mem_82126") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83124, &mem_82128, "mem_82128") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83125, &mem_82123, "mem_82123") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83126, &mem_82125, "mem_82125") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83127, &mem_81958, "mem_81958") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83128, &mem_82080, "mem_82080") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83129, &mem_81996, "mem_81996") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83130, &mem_81957, "mem_81957") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83131, &mem_81955, "mem_81955") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83132, &mem_81994, "mem_81994") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83133, &ext_mem_82110, "ext_mem_82110") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83134, &ext_mem_82065, "ext_mem_82065") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83135, &mem_82112, "mem_82112") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83136, &mem_82004, "mem_82004") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83137, &mem_82003, "mem_82003") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83138, &mem_82001, "mem_82001") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83139, &mem_82137, "mem_82137") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83140, &mem_82139, "mem_82139") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83141, &mem_82141, "mem_82141") != 0)
        return 1;
    prim_out_83142 = partition_sizze_60747;
    prim_out_83143 = m_59900;
    prim_out_83144 = conc_tmp_60863;
    prim_out_83145 = clBase_36765;
    prim_out_83146 = clBase_36766;
    prim_out_83147 = clBase_36767;
    prim_out_83148 = clBase_36768;
    prim_out_83149 = clBase_36770;
    prim_out_83150 = clBase_36773;
    prim_out_83151 = clBase_36775;
    prim_out_83152 = clProc_36780;
    prim_out_83153 = new_id_36801;
    prim_out_83154 = new_proc_60866;
    prim_out_83155 = new_proc_60867;
    prim_out_83156 = clProc_36784;
    prim_out_83157 = new_id_36801;
    if (memblock_set_device(ctx, &*mem_out_p_86823, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86824, &mem_out_83118, "mem_out_83118") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86825, &mem_out_83119, "mem_out_83119") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86826, &mem_out_83120, "mem_out_83120") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86827, &mem_out_83121, "mem_out_83121") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86828, &mem_out_83122, "mem_out_83122") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86829, &mem_out_83123, "mem_out_83123") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86830, &mem_out_83124, "mem_out_83124") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86831, &mem_out_83125, "mem_out_83125") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86832, &mem_out_83126, "mem_out_83126") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86833, &mem_out_83127, "mem_out_83127") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86834, &mem_out_83128, "mem_out_83128") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86835, &mem_out_83129, "mem_out_83129") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86836, &mem_out_83130, "mem_out_83130") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86837, &mem_out_83131, "mem_out_83131") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86838, &mem_out_83132, "mem_out_83132") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86839, &mem_out_83133, "mem_out_83133") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86840, &mem_out_83134, "mem_out_83134") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86841, &mem_out_83135, "mem_out_83135") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86842, &mem_out_83136, "mem_out_83136") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86843, &mem_out_83137, "mem_out_83137") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86844, &mem_out_83138, "mem_out_83138") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86845, &mem_out_83139, "mem_out_83139") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86846, &mem_out_83140, "mem_out_83140") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86847, &mem_out_83141, "mem_out_83141") != 0)
        return 1;
    *out_prim_out_86848 = prim_out_83142;
    *out_prim_out_86849 = prim_out_83143;
    *out_prim_out_86850 = prim_out_83144;
    *out_prim_out_86851 = prim_out_83145;
    *out_prim_out_86852 = prim_out_83146;
    *out_prim_out_86853 = prim_out_83147;
    *out_prim_out_86854 = prim_out_83148;
    *out_prim_out_86855 = prim_out_83149;
    *out_prim_out_86856 = prim_out_83150;
    *out_prim_out_86857 = prim_out_83151;
    *out_prim_out_86858 = prim_out_83152;
    *out_prim_out_86859 = prim_out_83153;
    *out_prim_out_86860 = prim_out_83154;
    *out_prim_out_86861 = prim_out_83155;
    *out_prim_out_86862 = prim_out_83156;
    *out_prim_out_86863 = prim_out_83157;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_82141, "mem_82141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82139, "mem_82139") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82137, "mem_82137") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82128, "mem_82128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82126, "mem_82126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82125, "mem_82125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82123, "mem_82123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82112, "mem_82112") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_84153, "segred_tmp_mem_84153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82083, "mem_82083") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82109, "mem_82109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82110, "ext_mem_82110") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82080, "mem_82080") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82073, "mem_82073") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81996, "mem_81996") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81994, "mem_81994") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81993, "mem_81993") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81957, "mem_81957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81955, "mem_81955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83906, "incprefixes_mem_83906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83904, "aggregates_mem_83904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83902, "incprefixes_mem_83902") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83900, "aggregates_mem_83900") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83898, "status_flags_mem_83898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82119, "mem_82119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82117, "mem_82117") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82115, "mem_82115") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83800, "incprefixes_mem_83800") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83798, "aggregates_mem_83798") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83796, "status_flags_mem_83796") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82078, "mem_82078") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82076, "mem_82076") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82070, "mem_82070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83684, "incprefixes_mem_83684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83682, "aggregates_mem_83682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83680, "status_flags_mem_83680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82059, "mem_82059") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82057, "mem_82057") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82011, "mem_82011") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82010, "mem_82010") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_83622, "segred_tmp_mem_83622") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82008, "mem_82008") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82006, "mem_82006") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82015, "mem_82015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82014, "mem_82014") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82013, "mem_82013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82016, "ext_mem_82016") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82017, "ext_mem_82017") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82018, "ext_mem_82018") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82053, "mem_82053") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82052, "mem_82052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82051, "mem_82051") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82054, "ext_mem_82054") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82055, "ext_mem_82055") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82056, "ext_mem_82056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82065, "ext_mem_82065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82066, "ext_mem_82066") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82067, "ext_mem_82067") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82068, "ext_mem_82068") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82004, "mem_82004") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82003, "mem_82003") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82002, "mem_82002") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82001, "mem_82001") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82000, "mem_82000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81999, "mem_81999") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81998, "mem_81998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81997, "mem_81997") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81989, "mem_81989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81990, "mem_81990") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81991, "ext_mem_81991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81986, "mem_81986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81987, "mem_81987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81988, "ext_mem_81988") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81983, "mem_81983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81984, "mem_81984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81985, "ext_mem_81985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81980, "mem_81980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81981, "mem_81981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81982, "ext_mem_81982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81977, "mem_81977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81978, "mem_81978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81979, "ext_mem_81979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81974, "mem_81974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81975, "mem_81975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81976, "ext_mem_81976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81972, "mem_81972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81970, "mem_81970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81969, "mem_81969") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81967, "mem_81967") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83198, "incprefixes_mem_83198") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83196, "aggregates_mem_83196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83194, "incprefixes_mem_83194") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83192, "aggregates_mem_83192") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83170, "status_flags_mem_83170") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81965, "mem_81965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81961, "mem_81961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81958, "mem_81958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83141, "mem_out_83141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83140, "mem_out_83140") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83139, "mem_out_83139") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83138, "mem_out_83138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83137, "mem_out_83137") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83136, "mem_out_83136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83135, "mem_out_83135") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83134, "mem_out_83134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83133, "mem_out_83133") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83132, "mem_out_83132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83131, "mem_out_83131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83130, "mem_out_83130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83129, "mem_out_83129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83128, "mem_out_83128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83127, "mem_out_83127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83126, "mem_out_83126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83125, "mem_out_83125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83124, "mem_out_83124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83123, "mem_out_83123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83122, "mem_out_83122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83121, "mem_out_83121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83120, "mem_out_83120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83119, "mem_out_83119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83118, "mem_out_83118") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_do_DBSCAN_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86869, struct memblock_device *mem_out_p_86870, struct memblock_device *mem_out_p_86871, struct memblock_device *mem_out_p_86872, struct memblock_device *mem_out_p_86873, struct memblock_device *mem_out_p_86874, struct memblock_device *mem_out_p_86875, struct memblock_device *mem_out_p_86876, struct memblock_device *mem_out_p_86877, struct memblock_device *mem_out_p_86878, struct memblock_device *mem_out_p_86879, struct memblock_device *mem_out_p_86880, struct memblock_device *mem_out_p_86881, struct memblock_device *mem_out_p_86882, struct memblock_device *mem_out_p_86883, struct memblock_device *mem_out_p_86884, struct memblock_device *mem_out_p_86885, struct memblock_device *mem_out_p_86886, struct memblock_device *mem_out_p_86887, struct memblock_device *mem_out_p_86888, struct memblock_device *mem_out_p_86889, struct memblock_device *mem_out_p_86890, struct memblock_device *mem_out_p_86891, struct memblock_device *mem_out_p_86892, struct memblock_device *mem_out_p_86893, int64_t *out_prim_out_86894, int8_t *out_prim_out_86895, int8_t *out_prim_out_86896, double *out_prim_out_86897, int64_t *out_prim_out_86898, int64_t *out_prim_out_86899, double *out_prim_out_86900, int64_t *out_prim_out_86901, int64_t *out_prim_out_86902, int64_t *out_prim_out_86903, int64_t *out_prim_out_86904, int64_t *out_prim_out_86905, int64_t *out_prim_out_86906, int64_t *out_prim_out_86907, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_48679, int64_t part_no_48680, int64_t dz2084U_48681, int64_t dz2080U_48682, int64_t dz2081U_48683, int64_t dz2082U_48684, int64_t dz2083U_48685, int64_t dz2085U_48686, int64_t dz2086U_48687, int8_t clBase_48690, int8_t clBase_48691, double clBase_48692, int64_t clBase_48693, int64_t clBase_48695, double clBase_48698, int64_t clBase_48700, int64_t clProc_48705, int64_t clProc_48706, int64_t clProc_48707, int64_t clProc_48709, int64_t clProc_48710, int64_t current_partition_48722, int64_t gather_psizze_48726, bool compact_list_48727)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_82906;
    
    mem_82906.references = NULL;
    
    struct memblock_device mem_82905;
    
    mem_82905.references = NULL;
    
    struct memblock_device mem_82903;
    
    mem_82903.references = NULL;
    
    struct memblock_device segred_tmp_mem_86784;
    
    segred_tmp_mem_86784.references = NULL;
    
    struct memblock_device mem_82901;
    
    mem_82901.references = NULL;
    
    struct memblock_device segred_tmp_mem_86749;
    
    segred_tmp_mem_86749.references = NULL;
    
    struct memblock_device mem_82899;
    
    mem_82899.references = NULL;
    
    struct memblock_device segred_tmp_mem_86666;
    
    segred_tmp_mem_86666.references = NULL;
    
    struct memblock_device segred_tmp_mem_86664;
    
    segred_tmp_mem_86664.references = NULL;
    
    struct memblock_device mem_82831;
    
    mem_82831.references = NULL;
    
    struct memblock_device mem_82826;
    
    mem_82826.references = NULL;
    
    struct memblock_device mem_82824;
    
    mem_82824.references = NULL;
    
    struct memblock_device mem_82822;
    
    mem_82822.references = NULL;
    
    struct memblock_device segred_tmp_mem_86535;
    
    segred_tmp_mem_86535.references = NULL;
    
    struct memblock_device segred_tmp_mem_86533;
    
    segred_tmp_mem_86533.references = NULL;
    
    struct memblock_device mem_82752;
    
    mem_82752.references = NULL;
    
    struct memblock_device mem_82747;
    
    mem_82747.references = NULL;
    
    struct memblock_device mem_82745;
    
    mem_82745.references = NULL;
    
    struct memblock_device mem_82743;
    
    mem_82743.references = NULL;
    
    struct memblock_device mem_82737;
    
    mem_82737.references = NULL;
    
    struct memblock_device mem_82734;
    
    mem_82734.references = NULL;
    
    struct memblock_device mem_82732;
    
    mem_82732.references = NULL;
    
    struct memblock_device mem_82730;
    
    mem_82730.references = NULL;
    
    struct memblock_device mem_82714;
    
    mem_82714.references = NULL;
    
    struct memblock_device mem_82712;
    
    mem_82712.references = NULL;
    
    struct memblock_device mem_82710;
    
    mem_82710.references = NULL;
    
    struct memblock_device ext_mem_82715;
    
    ext_mem_82715.references = NULL;
    
    struct memblock_device ext_mem_82716;
    
    ext_mem_82716.references = NULL;
    
    struct memblock_device ext_mem_82717;
    
    ext_mem_82717.references = NULL;
    
    struct memblock_device mem_82707;
    
    mem_82707.references = NULL;
    
    struct memblock_device mem_82705;
    
    mem_82705.references = NULL;
    
    struct memblock_device mem_81978;
    
    mem_81978.references = NULL;
    
    struct memblock_device mem_81977;
    
    mem_81977.references = NULL;
    
    struct memblock_device mem_81976;
    
    mem_81976.references = NULL;
    
    struct memblock_device mem_81975;
    
    mem_81975.references = NULL;
    
    struct memblock_device mem_81974;
    
    mem_81974.references = NULL;
    
    struct memblock_device mem_81972;
    
    mem_81972.references = NULL;
    
    struct memblock_device incprefixes_mem_86333;
    
    incprefixes_mem_86333.references = NULL;
    
    struct memblock_device aggregates_mem_86331;
    
    aggregates_mem_86331.references = NULL;
    
    struct memblock_device status_flags_mem_86329;
    
    status_flags_mem_86329.references = NULL;
    
    struct memblock_device mem_82728;
    
    mem_82728.references = NULL;
    
    struct memblock_device mem_82726;
    
    mem_82726.references = NULL;
    
    struct memblock_device mem_82724;
    
    mem_82724.references = NULL;
    
    struct memblock_device mem_82722;
    
    mem_82722.references = NULL;
    
    struct memblock_device mem_82720;
    
    mem_82720.references = NULL;
    
    struct memblock_device incprefixes_mem_86230;
    
    incprefixes_mem_86230.references = NULL;
    
    struct memblock_device aggregates_mem_86228;
    
    aggregates_mem_86228.references = NULL;
    
    struct memblock_device status_flags_mem_86226;
    
    status_flags_mem_86226.references = NULL;
    
    struct memblock_device mem_82696;
    
    mem_82696.references = NULL;
    
    struct memblock_device mem_82693;
    
    mem_82693.references = NULL;
    
    struct memblock_device mem_82618;
    
    mem_82618.references = NULL;
    
    struct memblock_device mem_82690;
    
    mem_82690.references = NULL;
    
    struct memblock_device ext_mem_82691;
    
    ext_mem_82691.references = NULL;
    
    struct memblock_device ext_mem_82702;
    
    ext_mem_82702.references = NULL;
    
    struct memblock_device ext_mem_82703;
    
    ext_mem_82703.references = NULL;
    
    struct memblock_device mem_82545;
    
    mem_82545.references = NULL;
    
    struct memblock_device mem_82543;
    
    mem_82543.references = NULL;
    
    struct memblock_device incprefixes_mem_85956;
    
    incprefixes_mem_85956.references = NULL;
    
    struct memblock_device aggregates_mem_85954;
    
    aggregates_mem_85954.references = NULL;
    
    struct memblock_device status_flags_mem_85952;
    
    status_flags_mem_85952.references = NULL;
    
    struct memblock_device mem_82531;
    
    mem_82531.references = NULL;
    
    struct memblock_device mem_82528;
    
    mem_82528.references = NULL;
    
    struct memblock_device mem_82474;
    
    mem_82474.references = NULL;
    
    struct memblock_device mem_82472;
    
    mem_82472.references = NULL;
    
    struct memblock_device mem_82524;
    
    mem_82524.references = NULL;
    
    struct memblock_device mem_82522;
    
    mem_82522.references = NULL;
    
    struct memblock_device ext_mem_82525;
    
    ext_mem_82525.references = NULL;
    
    struct memblock_device ext_mem_82526;
    
    ext_mem_82526.references = NULL;
    
    struct memblock_device ext_mem_82539;
    
    ext_mem_82539.references = NULL;
    
    struct memblock_device ext_mem_82540;
    
    ext_mem_82540.references = NULL;
    
    struct memblock_device ext_mem_82541;
    
    ext_mem_82541.references = NULL;
    
    struct memblock_device mem_82423;
    
    mem_82423.references = NULL;
    
    struct memblock_device mem_82421;
    
    mem_82421.references = NULL;
    
    struct memblock_device incprefixes_mem_85689;
    
    incprefixes_mem_85689.references = NULL;
    
    struct memblock_device aggregates_mem_85687;
    
    aggregates_mem_85687.references = NULL;
    
    struct memblock_device status_flags_mem_85685;
    
    status_flags_mem_85685.references = NULL;
    
    struct memblock_device mem_82412;
    
    mem_82412.references = NULL;
    
    struct memblock_device mem_82409;
    
    mem_82409.references = NULL;
    
    struct memblock_device mem_82344;
    
    mem_82344.references = NULL;
    
    struct memblock_device mem_82406;
    
    mem_82406.references = NULL;
    
    struct memblock_device ext_mem_82407;
    
    ext_mem_82407.references = NULL;
    
    struct memblock_device ext_mem_82418;
    
    ext_mem_82418.references = NULL;
    
    struct memblock_device ext_mem_82419;
    
    ext_mem_82419.references = NULL;
    
    struct memblock_device mem_82281;
    
    mem_82281.references = NULL;
    
    struct memblock_device mem_82279;
    
    mem_82279.references = NULL;
    
    struct memblock_device incprefixes_mem_85415;
    
    incprefixes_mem_85415.references = NULL;
    
    struct memblock_device aggregates_mem_85413;
    
    aggregates_mem_85413.references = NULL;
    
    struct memblock_device status_flags_mem_85411;
    
    status_flags_mem_85411.references = NULL;
    
    struct memblock_device mem_82277;
    
    mem_82277.references = NULL;
    
    struct memblock_device mem_82275;
    
    mem_82275.references = NULL;
    
    struct memblock_device mem_82272;
    
    mem_82272.references = NULL;
    
    struct memblock_device mem_82269;
    
    mem_82269.references = NULL;
    
    struct memblock_device incprefixes_mem_85294;
    
    incprefixes_mem_85294.references = NULL;
    
    struct memblock_device aggregates_mem_85292;
    
    aggregates_mem_85292.references = NULL;
    
    struct memblock_device status_flags_mem_85290;
    
    status_flags_mem_85290.references = NULL;
    
    struct memblock_device mem_82266;
    
    mem_82266.references = NULL;
    
    struct memblock_device mem_param_tmp_85143;
    
    mem_param_tmp_85143.references = NULL;
    
    struct memblock_device segred_tmp_mem_85251;
    
    segred_tmp_mem_85251.references = NULL;
    
    struct memblock_device mem_param_tmp_85146;
    
    mem_param_tmp_85146.references = NULL;
    
    struct memblock_device mem_82159;
    
    mem_82159.references = NULL;
    
    struct memblock_device segred_tmp_mem_85208;
    
    segred_tmp_mem_85208.references = NULL;
    
    struct memblock_device mem_82102;
    
    mem_82102.references = NULL;
    
    struct memblock_device mem_82099;
    
    mem_82099.references = NULL;
    
    struct memblock_device mem_82097;
    
    mem_82097.references = NULL;
    
    struct memblock_device mem_82095;
    
    mem_82095.references = NULL;
    
    struct memblock_device mem_82156;
    
    mem_82156.references = NULL;
    
    struct memblock_device ext_mem_82157;
    
    ext_mem_82157.references = NULL;
    
    struct memblock_device mem_param_82092;
    
    mem_param_82092.references = NULL;
    
    struct memblock_device ext_mem_82162;
    
    ext_mem_82162.references = NULL;
    
    struct memblock_device mem_param_82089;
    
    mem_param_82089.references = NULL;
    
    struct memblock_device ext_mem_82167;
    
    ext_mem_82167.references = NULL;
    
    struct memblock_device mem_82164;
    
    mem_82164.references = NULL;
    
    struct memblock_device mem_82086;
    
    mem_82086.references = NULL;
    
    struct memblock_device mem_82259;
    
    mem_82259.references = NULL;
    
    struct memblock_device incprefixes_mem_84978;
    
    incprefixes_mem_84978.references = NULL;
    
    struct memblock_device aggregates_mem_84976;
    
    aggregates_mem_84976.references = NULL;
    
    struct memblock_device incprefixes_mem_84974;
    
    incprefixes_mem_84974.references = NULL;
    
    struct memblock_device aggregates_mem_84972;
    
    aggregates_mem_84972.references = NULL;
    
    struct memblock_device status_flags_mem_84970;
    
    status_flags_mem_84970.references = NULL;
    
    struct memblock_device mem_82253;
    
    mem_82253.references = NULL;
    
    struct memblock_device mem_82251;
    
    mem_82251.references = NULL;
    
    struct memblock_device mem_param_tmp_84746;
    
    mem_param_tmp_84746.references = NULL;
    
    struct memblock_device segred_tmp_mem_84931;
    
    segred_tmp_mem_84931.references = NULL;
    
    struct memblock_device mem_82246;
    
    mem_82246.references = NULL;
    
    struct memblock_device incprefixes_mem_84764;
    
    incprefixes_mem_84764.references = NULL;
    
    struct memblock_device aggregates_mem_84762;
    
    aggregates_mem_84762.references = NULL;
    
    struct memblock_device incprefixes_mem_84760;
    
    incprefixes_mem_84760.references = NULL;
    
    struct memblock_device aggregates_mem_84758;
    
    aggregates_mem_84758.references = NULL;
    
    struct memblock_device status_flags_mem_84756;
    
    status_flags_mem_84756.references = NULL;
    
    struct memblock_device mem_param_82235;
    
    mem_param_82235.references = NULL;
    
    struct memblock_device ext_mem_82249;
    
    ext_mem_82249.references = NULL;
    
    struct memblock_device mem_82244;
    
    mem_82244.references = NULL;
    
    struct memblock_device mem_82241;
    
    mem_82241.references = NULL;
    
    struct memblock_device mem_82239;
    
    mem_82239.references = NULL;
    
    struct memblock_device mem_82237;
    
    mem_82237.references = NULL;
    
    struct memblock_device incprefixes_mem_84652;
    
    incprefixes_mem_84652.references = NULL;
    
    struct memblock_device aggregates_mem_84650;
    
    aggregates_mem_84650.references = NULL;
    
    struct memblock_device status_flags_mem_84648;
    
    status_flags_mem_84648.references = NULL;
    
    struct memblock_device mem_82257;
    
    mem_82257.references = NULL;
    
    struct memblock_device mem_82256;
    
    mem_82256.references = NULL;
    
    struct memblock_device incprefixes_mem_84549;
    
    incprefixes_mem_84549.references = NULL;
    
    struct memblock_device aggregates_mem_84547;
    
    aggregates_mem_84547.references = NULL;
    
    struct memblock_device status_flags_mem_84545;
    
    status_flags_mem_84545.references = NULL;
    
    struct memblock_device mem_82232;
    
    mem_82232.references = NULL;
    
    struct memblock_device mem_82231;
    
    mem_82231.references = NULL;
    
    struct memblock_device segred_tmp_mem_84506;
    
    segred_tmp_mem_84506.references = NULL;
    
    struct memblock_device mem_82228;
    
    mem_82228.references = NULL;
    
    struct memblock_device mem_82225;
    
    mem_82225.references = NULL;
    
    struct memblock_device incprefixes_mem_84378;
    
    incprefixes_mem_84378.references = NULL;
    
    struct memblock_device aggregates_mem_84376;
    
    aggregates_mem_84376.references = NULL;
    
    struct memblock_device status_flags_mem_84374;
    
    status_flags_mem_84374.references = NULL;
    
    struct memblock_device mem_82224;
    
    mem_82224.references = NULL;
    
    struct memblock_device mem_param_tmp_84024;
    
    mem_param_tmp_84024.references = NULL;
    
    struct memblock_device mem_82215;
    
    mem_82215.references = NULL;
    
    struct memblock_device segred_tmp_mem_84327;
    
    segred_tmp_mem_84327.references = NULL;
    
    struct memblock_device defunc_0_map_res_subhistos_mem_84207;
    
    defunc_0_map_res_subhistos_mem_84207.references = NULL;
    
    struct memblock_device mem_82212;
    
    mem_82212.references = NULL;
    
    struct memblock_device mem_82209;
    
    mem_82209.references = NULL;
    
    struct memblock_device mem_82207;
    
    mem_82207.references = NULL;
    
    struct memblock_device mem_82199;
    
    mem_82199.references = NULL;
    
    struct memblock_device mem_82196;
    
    mem_82196.references = NULL;
    
    struct memblock_device mem_82183;
    
    mem_82183.references = NULL;
    
    struct memblock_device mem_82180;
    
    mem_82180.references = NULL;
    
    struct memblock_device incprefixes_mem_84060;
    
    incprefixes_mem_84060.references = NULL;
    
    struct memblock_device aggregates_mem_84058;
    
    aggregates_mem_84058.references = NULL;
    
    struct memblock_device status_flags_mem_84056;
    
    status_flags_mem_84056.references = NULL;
    
    struct memblock_device mem_82205;
    
    mem_82205.references = NULL;
    
    struct memblock_device mem_82203;
    
    mem_82203.references = NULL;
    
    struct memblock_device mem_82193;
    
    mem_82193.references = NULL;
    
    struct memblock_device mem_82190;
    
    mem_82190.references = NULL;
    
    struct memblock_device mem_82188;
    
    mem_82188.references = NULL;
    
    struct memblock_device mem_82186;
    
    mem_82186.references = NULL;
    
    struct memblock_device mem_param_82178;
    
    mem_param_82178.references = NULL;
    
    struct memblock_device ext_mem_82220;
    
    ext_mem_82220.references = NULL;
    
    struct memblock_device mem_82172;
    
    mem_82172.references = NULL;
    
    struct memblock_device mem_82170;
    
    mem_82170.references = NULL;
    
    struct memblock_device mem_82169;
    
    mem_82169.references = NULL;
    
    struct memblock_device ext_mem_82263;
    
    ext_mem_82263.references = NULL;
    
    struct memblock_device mem_82084;
    
    mem_82084.references = NULL;
    
    struct memblock_device mem_82081;
    
    mem_82081.references = NULL;
    
    struct memblock_device mem_82079;
    
    mem_82079.references = NULL;
    
    struct memblock_device mem_82077;
    
    mem_82077.references = NULL;
    
    struct memblock_device incprefixes_mem_83916;
    
    incprefixes_mem_83916.references = NULL;
    
    struct memblock_device aggregates_mem_83914;
    
    aggregates_mem_83914.references = NULL;
    
    struct memblock_device status_flags_mem_83912;
    
    status_flags_mem_83912.references = NULL;
    
    struct memblock_device mem_82075;
    
    mem_82075.references = NULL;
    
    struct memblock_device mem_82073;
    
    mem_82073.references = NULL;
    
    struct memblock_device mem_82070;
    
    mem_82070.references = NULL;
    
    struct memblock_device ext_mem_82067;
    
    ext_mem_82067.references = NULL;
    
    struct memblock_device mem_82060;
    
    mem_82060.references = NULL;
    
    struct memblock_device mem_82058;
    
    mem_82058.references = NULL;
    
    struct memblock_device mem_82056;
    
    mem_82056.references = NULL;
    
    struct memblock_device incprefixes_mem_83779;
    
    incprefixes_mem_83779.references = NULL;
    
    struct memblock_device aggregates_mem_83777;
    
    aggregates_mem_83777.references = NULL;
    
    struct memblock_device status_flags_mem_83775;
    
    status_flags_mem_83775.references = NULL;
    
    struct memblock_device mem_82054;
    
    mem_82054.references = NULL;
    
    struct memblock_device mem_82052;
    
    mem_82052.references = NULL;
    
    struct memblock_device mem_82063;
    
    mem_82063.references = NULL;
    
    struct memblock_device mem_82062;
    
    mem_82062.references = NULL;
    
    struct memblock_device ext_mem_82064;
    
    ext_mem_82064.references = NULL;
    
    struct memblock_device ext_mem_82065;
    
    ext_mem_82065.references = NULL;
    
    struct memblock_device ext_mem_82066;
    
    ext_mem_82066.references = NULL;
    
    struct memblock_device mem_82048;
    
    mem_82048.references = NULL;
    
    struct memblock_device mem_82046;
    
    mem_82046.references = NULL;
    
    struct memblock_device mem_82044;
    
    mem_82044.references = NULL;
    
    struct memblock_device incprefixes_mem_83661;
    
    incprefixes_mem_83661.references = NULL;
    
    struct memblock_device aggregates_mem_83659;
    
    aggregates_mem_83659.references = NULL;
    
    struct memblock_device status_flags_mem_83657;
    
    status_flags_mem_83657.references = NULL;
    
    struct memblock_device mem_82042;
    
    mem_82042.references = NULL;
    
    struct memblock_device mem_82041;
    
    mem_82041.references = NULL;
    
    struct memblock_device mem_82039;
    
    mem_82039.references = NULL;
    
    struct memblock_device ext_mem_82036;
    
    ext_mem_82036.references = NULL;
    
    struct memblock_device ext_mem_82035;
    
    ext_mem_82035.references = NULL;
    
    struct memblock_device mem_82033;
    
    mem_82033.references = NULL;
    
    struct memblock_device mem_82030;
    
    mem_82030.references = NULL;
    
    struct memblock_device ext_mem_82028;
    
    ext_mem_82028.references = NULL;
    
    struct memblock_device mem_82026;
    
    mem_82026.references = NULL;
    
    struct memblock_device mem_82024;
    
    mem_82024.references = NULL;
    
    struct memblock_device mem_82022;
    
    mem_82022.references = NULL;
    
    struct memblock_device mem_82021;
    
    mem_82021.references = NULL;
    
    struct memblock_device mem_82019;
    
    mem_82019.references = NULL;
    
    struct memblock_device incprefixes_mem_83498;
    
    incprefixes_mem_83498.references = NULL;
    
    struct memblock_device aggregates_mem_83496;
    
    aggregates_mem_83496.references = NULL;
    
    struct memblock_device incprefixes_mem_83494;
    
    incprefixes_mem_83494.references = NULL;
    
    struct memblock_device aggregates_mem_83492;
    
    aggregates_mem_83492.references = NULL;
    
    struct memblock_device status_flags_mem_83490;
    
    status_flags_mem_83490.references = NULL;
    
    struct memblock_device mem_82017;
    
    mem_82017.references = NULL;
    
    struct memblock_device mem_82015;
    
    mem_82015.references = NULL;
    
    struct memblock_device mem_82013;
    
    mem_82013.references = NULL;
    
    struct memblock_device mem_82009;
    
    mem_82009.references = NULL;
    
    struct memblock_device mem_82007;
    
    mem_82007.references = NULL;
    
    struct memblock_device mem_82005;
    
    mem_82005.references = NULL;
    
    struct memblock_device mem_82004;
    
    mem_82004.references = NULL;
    
    struct memblock_device mem_82002;
    
    mem_82002.references = NULL;
    
    struct memblock_device incprefixes_mem_83378;
    
    incprefixes_mem_83378.references = NULL;
    
    struct memblock_device aggregates_mem_83376;
    
    aggregates_mem_83376.references = NULL;
    
    struct memblock_device status_flags_mem_83374;
    
    status_flags_mem_83374.references = NULL;
    
    struct memblock_device mem_82000;
    
    mem_82000.references = NULL;
    
    struct memblock_device mem_81998;
    
    mem_81998.references = NULL;
    
    struct memblock_device mem_81997;
    
    mem_81997.references = NULL;
    
    struct memblock_device mem_81995;
    
    mem_81995.references = NULL;
    
    struct memblock_device mem_81992;
    
    mem_81992.references = NULL;
    
    struct memblock_device mem_81991;
    
    mem_81991.references = NULL;
    
    struct memblock_device ext_mem_81990;
    
    ext_mem_81990.references = NULL;
    
    struct memblock_device ext_mem_81989;
    
    ext_mem_81989.references = NULL;
    
    struct memblock_device ext_mem_81988;
    
    ext_mem_81988.references = NULL;
    
    struct memblock_device ext_mem_81987;
    
    ext_mem_81987.references = NULL;
    
    struct memblock_device mem_81986;
    
    mem_81986.references = NULL;
    
    struct memblock_device mem_81985;
    
    mem_81985.references = NULL;
    
    struct memblock_device mem_81984;
    
    mem_81984.references = NULL;
    
    struct memblock_device mem_81983;
    
    mem_81983.references = NULL;
    
    struct memblock_device mem_81982;
    
    mem_81982.references = NULL;
    
    struct memblock_device mem_81981;
    
    mem_81981.references = NULL;
    
    struct memblock_device mem_81980;
    
    mem_81980.references = NULL;
    
    struct memblock_device mem_81979;
    
    mem_81979.references = NULL;
    
    struct memblock_device mem_81970;
    
    mem_81970.references = NULL;
    
    struct memblock_device ext_mem_81968;
    
    ext_mem_81968.references = NULL;
    
    struct memblock_device mem_81966;
    
    mem_81966.references = NULL;
    
    struct memblock_device mem_81964;
    
    mem_81964.references = NULL;
    
    struct memblock_device mem_81962;
    
    mem_81962.references = NULL;
    
    struct memblock_device mem_81960;
    
    mem_81960.references = NULL;
    
    struct memblock_device mem_81958;
    
    mem_81958.references = NULL;
    
    struct memblock_device incprefixes_mem_83188;
    
    incprefixes_mem_83188.references = NULL;
    
    struct memblock_device aggregates_mem_83186;
    
    aggregates_mem_83186.references = NULL;
    
    struct memblock_device status_flags_mem_83164;
    
    status_flags_mem_83164.references = NULL;
    
    struct memblock_device mem_81956;
    
    mem_81956.references = NULL;
    
    struct memblock_device mem_81954;
    
    mem_81954.references = NULL;
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83142;
    int8_t prim_out_83143;
    int8_t prim_out_83144;
    double prim_out_83145;
    int64_t prim_out_83146;
    int64_t prim_out_83147;
    double prim_out_83148;
    int64_t prim_out_83149;
    int64_t prim_out_83150;
    int64_t prim_out_83151;
    int64_t prim_out_83152;
    int64_t prim_out_83153;
    int64_t prim_out_83154;
    int64_t prim_out_83155;
    double zt_res_61589 = 2.0 * clBase_48692;
    int64_t segscan_tblock_sizze_75077;
    
    segscan_tblock_sizze_75077 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75076;
    
    int64_t num_tblocks_75079;
    int64_t max_num_tblocks_83156;
    
    max_num_tblocks_83156 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75078;
    num_tblocks_75079 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_48679, segscan_tblock_sizze_75077), max_num_tblocks_83156)));
    
    int64_t bytes_81953 = (int64_t) 8 * n_48679;
    
    if (memblock_alloc_device(ctx, &mem_81954, bytes_81953, "mem_81954")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81956, bytes_81953, "mem_81956")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, n_48679)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83157;
        
        shared_memory_83157 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83158;
        
        thread_block_sizze_83158 = ctx->max_thread_block_size;
        
        int64_t registers_83159;
        
        registers_83159 = ctx->max_registers;
        
        int64_t thread_block_sizze_83160;
        
        thread_block_sizze_83160 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83161 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83157, thread_block_sizze_83158), (int64_t) 8), squot64(squot64(registers_83159, thread_block_sizze_83160) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83162 = sdiv_up64(n_48679, segscan_tblock_sizze_75077 * chunk_sizze_83161);
        int64_t num_virt_threads_83163 = num_virt_blocks_83162 * segscan_tblock_sizze_75077;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83161, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83164, num_virt_blocks_83162, "status_flags_mem_83164")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83164, num_virt_blocks_83162, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83186, (int64_t) 8 * num_virt_blocks_83162, "aggregates_mem_83186")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83188, (int64_t) 8 * num_virt_blocks_83162, "incprefixes_mem_83188")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75082(ctx, num_tblocks_75079, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75076, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75077), chunk_sizze_83161 * segscan_tblock_sizze_75077 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75077), chunk_sizze_83161 * segscan_tblock_sizze_75077 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_48679, num_tblocks_75079, num_virt_blocks_83162, num_virt_threads_83163, current_partition_mem_81945.mem, mem_81954.mem, mem_81956.mem, status_flags_mem_83164.mem, aggregates_mem_83186.mem, incprefixes_mem_83188.mem, global_dynid_mem_83190.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_alloc_device(ctx, &mem_81958, bytes_81953, "mem_81958")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, current_partition_mem_81940.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_48679})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_81960, bytes_81953, "mem_81960")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, current_partition_mem_81941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_48679})) != 0)
        goto cleanup;
    
    bool cond_61602 = n_48679 == (int64_t) 0;
    bool x_61603 = !cond_61602;
    int64_t tmp_61604 = sub64(n_48679, (int64_t) 1);
    bool x_61605 = sle64((int64_t) 0, tmp_61604);
    bool y_61606 = slt64(tmp_61604, n_48679);
    bool bounds_check_61607 = x_61605 && y_61606;
    bool protect_assert_disj_61608 = cond_61602 || bounds_check_61607;
    bool index_certs_61609;
    
    if (!protect_assert_disj_61608) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_61604, "] out of bounds for array of shape [", (long long) n_48679, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_61610;
    
    if (x_61603) {
        int64_t read_res_86908;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86908, mem_81954.mem, tmp_61604 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66162 = read_res_86908;
        
        m_f_res_61610 = x_66162;
    } else {
        m_f_res_61610 = (int64_t) 0;
    }
    
    int64_t m_61612;
    
    if (cond_61602) {
        m_61612 = (int64_t) 0;
    } else {
        m_61612 = m_f_res_61610;
    }
    
    int64_t m_61622 = sub64(m_61612, (int64_t) 1);
    bool i_p_m_t_s_leq_w_61624 = slt64(m_61622, n_48679);
    bool zzero_leq_i_p_m_t_s_61623 = sle64((int64_t) 0, m_61622);
    bool y_61626 = zzero_leq_i_p_m_t_s_61623 && i_p_m_t_s_leq_w_61624;
    bool i_lte_j_61625 = sle64((int64_t) 0, m_61612);
    bool forwards_ok_61627 = i_lte_j_61625 && y_61626;
    bool eq_x_zz_61619 = (int64_t) 0 == m_f_res_61610;
    bool p_and_eq_x_y_61620 = x_61603 && eq_x_zz_61619;
    bool empty_slice_61621 = cond_61602 || p_and_eq_x_y_61620;
    bool ok_or_empty_61628 = empty_slice_61621 || forwards_ok_61627;
    bool index_certs_61629;
    
    if (!ok_or_empty_61628) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_61612, "] out of bounds for array of shape [", (long long) n_48679, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_81961 = (int64_t) 8 * m_61612;
    
    if (memblock_alloc_device(ctx, &mem_81962, bytes_81961, "mem_81962")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81962.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_81960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61612})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_81964, bytes_81961, "mem_81964")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81964.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_81958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61612})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_81966, bytes_81961, "mem_81966")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_81966, m_61612, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_75087;
    
    segmap_tblock_sizze_75087 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75086;
    
    int64_t num_tblocks_75089;
    int64_t max_num_tblocks_83316;
    
    max_num_tblocks_83316 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75088;
    num_tblocks_75089 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_48679, segmap_tblock_sizze_75087), max_num_tblocks_83316)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83317 = sext_i64_i32(sdiv_up64(n_48679, segmap_tblock_sizze_75087));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75084(ctx, num_tblocks_75089, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75086, 1, 1, (int64_t) 0, n_48679, m_61612, num_tblocks_75089, virt_num_tblocks_83317, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_81954.mem, mem_81956.mem, mem_81962.mem, mem_81964.mem, mem_81966.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81956, "mem_81956") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_75093;
    
    segscan_tblock_sizze_75093 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75092;
    
    int64_t num_tblocks_75095;
    int64_t max_num_tblocks_83330;
    
    max_num_tblocks_83330 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75094;
    num_tblocks_75095 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_48684, segscan_tblock_sizze_75093), max_num_tblocks_83330)));
    
    bool cond_61878 = dz2082U_48684 == (int64_t) 0;
    bool x_61879 = !cond_61878;
    int64_t tmp_61880 = sub64(dz2082U_48684, (int64_t) 1);
    bool x_61881 = sle64((int64_t) 0, tmp_61880);
    bool y_61882 = slt64(tmp_61880, dz2082U_48684);
    bool bounds_check_61883 = x_61881 && y_61882;
    bool protect_assert_disj_61884 = cond_61878 || bounds_check_61883;
    bool index_certs_61885;
    
    if (!protect_assert_disj_61884) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_61880, "] out of bounds for array of shape [", (long long) dz2082U_48684, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_75103;
    
    segmap_tblock_sizze_75103 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75102;
    
    int64_t num_tblocks_75105;
    int64_t max_num_tblocks_83331;
    
    max_num_tblocks_83331 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75104;
    num_tblocks_75105 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_48684, segmap_tblock_sizze_75103), max_num_tblocks_83331)));
    
    int64_t segscan_tblock_sizze_75109;
    
    segscan_tblock_sizze_75109 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75108;
    
    int64_t segmap_tblock_sizze_75119;
    
    segmap_tblock_sizze_75119 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75118;
    
    int64_t segscan_tblock_sizze_75125;
    
    segscan_tblock_sizze_75125 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75124;
    
    int64_t segmap_tblock_sizze_75135;
    
    segmap_tblock_sizze_75135 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75134;
    
    bool cond_62318 = slt64(clBase_48695, (int64_t) 3);
    int64_t segscan_tblock_sizze_75141;
    
    segscan_tblock_sizze_75141 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75140;
    
    int64_t segmap_tblock_sizze_75151;
    
    segmap_tblock_sizze_75151 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75150;
    if (futrts_get_num_neighbours_against_11932(ctx, &ext_mem_81968, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81940, current_partition_mem_81941, n_48679, n_48679, clBase_48692, clBase_48691, clBase_48690, clBase_48698, clBase_48693) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81970, bytes_81953, "mem_81970")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81970, n_48679, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_75159;
    
    segmap_tblock_sizze_75159 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75158;
    
    int64_t num_tblocks_75161;
    int64_t max_num_tblocks_83352;
    
    max_num_tblocks_83352 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75160;
    num_tblocks_75161 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_61612, segmap_tblock_sizze_75159), max_num_tblocks_83352)));
    
    int64_t segmap_tblock_sizze_75177;
    
    segmap_tblock_sizze_75177 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75166;
    
    int64_t segmap_usable_groups_75178 = sdiv_up64(n_48679, segmap_tblock_sizze_75177);
    int64_t segscan_tblock_sizze_75189;
    
    segscan_tblock_sizze_75189 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75188;
    
    int64_t num_tblocks_75191;
    int64_t max_num_tblocks_83353;
    
    max_num_tblocks_83353 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75190;
    num_tblocks_75191 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_48679, segscan_tblock_sizze_75189), max_num_tblocks_83353)));
    
    int64_t segmap_tblock_sizze_75199;
    
    segmap_tblock_sizze_75199 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75198;
    
    int64_t num_tblocks_75201;
    int64_t max_num_tblocks_83354;
    
    max_num_tblocks_83354 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75200;
    num_tblocks_75201 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_48679, segmap_tblock_sizze_75199), max_num_tblocks_83354)));
    
    bool loop_not_taken_63657 = !compact_list_48727;
    int64_t segmap_tblock_sizze_75744;
    
    segmap_tblock_sizze_75744 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75729;
    
    int64_t segred_tblock_sizze_75762;
    
    segred_tblock_sizze_75762 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669;
    
    int64_t segred_tblock_sizze_75819;
    
    segred_tblock_sizze_75819 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75818;
    
    int64_t segmap_tblock_sizze_75350;
    
    segmap_tblock_sizze_75350 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75330;
    
    int64_t segmap_tblock_sizze_75372;
    
    segmap_tblock_sizze_75372 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75219;
    
    int64_t segscan_tblock_sizze_75428;
    
    segscan_tblock_sizze_75428 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75427;
    
    int64_t segmap_tblock_sizze_75438;
    
    segmap_tblock_sizze_75438 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75437;
    
    int64_t seghist_tblock_sizze_75444;
    
    seghist_tblock_sizze_75444 = *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443;
    
    int64_t segscan_tblock_sizze_75460;
    
    segscan_tblock_sizze_75460 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75459;
    
    int64_t segmap_tblock_sizze_75470;
    
    segmap_tblock_sizze_75470 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75469;
    
    int64_t segred_tblock_sizze_75476;
    
    segred_tblock_sizze_75476 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75475;
    
    int64_t segscan_tblock_sizze_75486;
    
    segscan_tblock_sizze_75486 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75485;
    
    int64_t segscan_tblock_sizze_75494;
    
    segscan_tblock_sizze_75494 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75493;
    
    int64_t segmap_tblock_sizze_75504;
    
    segmap_tblock_sizze_75504 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75503;
    
    int64_t segred_tblock_sizze_75510;
    
    segred_tblock_sizze_75510 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75509;
    
    int64_t segscan_tblock_sizze_75521;
    
    segscan_tblock_sizze_75521 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75520;
    
    int64_t segscan_tblock_sizze_75529;
    
    segscan_tblock_sizze_75529 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75528;
    
    int64_t segmap_tblock_sizze_75539;
    
    segmap_tblock_sizze_75539 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75538;
    
    int64_t tile_sizze_78072;
    
    tile_sizze_78072 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071;
    
    bool match_val_81840 = clBase_48691 == (int8_t) 0;
    bool x_81841 = !match_val_81840;
    int64_t segscan_tblock_sizze_75829;
    
    segscan_tblock_sizze_75829 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75828;
    
    int64_t segmap_tblock_sizze_75850;
    
    segmap_tblock_sizze_75850 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75838;
    
    int64_t segmap_tblock_sizze_75883;
    
    segmap_tblock_sizze_75883 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75864;
    
    int64_t segscan_tblock_sizze_75903;
    
    segscan_tblock_sizze_75903 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75902;
    
    int64_t segmap_tblock_sizze_75913;
    
    segmap_tblock_sizze_75913 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75912;
    
    int64_t segscan_tblock_sizze_76310;
    
    segscan_tblock_sizze_76310 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76209;
    
    int64_t segscan_tblock_sizze_75957;
    
    segscan_tblock_sizze_75957 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75949;
    
    int64_t tile_sizze_78847;
    
    tile_sizze_78847 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846;
    
    int64_t tile_sizze_78492;
    
    tile_sizze_78492 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491;
    
    int64_t segmap_tblock_sizze_76326;
    
    segmap_tblock_sizze_76326 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76325;
    
    int64_t segscan_tblock_sizze_76623;
    
    segscan_tblock_sizze_76623 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76540;
    
    int64_t segscan_tblock_sizze_76341;
    
    segscan_tblock_sizze_76341 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76333;
    
    int64_t tile_sizze_79485;
    
    tile_sizze_79485 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484;
    
    int64_t tile_sizze_79202;
    
    tile_sizze_79202 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201;
    
    int64_t segmap_tblock_sizze_76640;
    
    segmap_tblock_sizze_76640 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76639;
    
    int64_t segscan_tblock_sizze_77076;
    
    segscan_tblock_sizze_77076 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76957;
    
    int64_t segscan_tblock_sizze_76655;
    
    segscan_tblock_sizze_76655 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76647;
    
    int64_t tile_sizze_80150;
    
    tile_sizze_80150 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149;
    
    int64_t tile_sizze_79768;
    
    tile_sizze_79768 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767;
    
    bool cond_63119 = slt64(clBase_48695, (int64_t) 2);
    bool not_p_63138 = !cond_63119;
    int64_t segscan_tblock_sizze_77098;
    
    segscan_tblock_sizze_77098 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_77097;
    
    int64_t bytes_81973 = (int64_t) 8 * dz2081U_48683;
    
    if (memblock_alloc_device(ctx, &mem_81979, (int64_t) 8, "mem_81979")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81980, (int64_t) 8, "mem_81980")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81981, (int64_t) 8, "mem_81981")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81982, (int64_t) 8, "mem_81982")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81983, (int64_t) 8, "mem_81983")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81984, (int64_t) 8, "mem_81984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81985, (int64_t) 8, "mem_81985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81986, (int64_t) 8, "mem_81986")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_do_DBSCAN_doublezigpuseq_83355(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, current_partition_mem_81946.mem, current_partition_mem_81947.mem, mem_81979.mem, mem_81980.mem, mem_81981.mem, mem_81982.mem, mem_81983.mem, mem_81984.mem, mem_81985.mem, mem_81986.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (clBase_48690 == (int8_t) 1) {
        if (memblock_set_device(ctx, &ext_mem_81987, &mem_81979, "mem_81979") != 0)
            return 1;
    } else if (memblock_set_device(ctx, &ext_mem_81987, &mem_81980, "mem_81980") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81980, "mem_81980") != 0)
        return 1;
    if (clBase_48690 == (int8_t) 1) {
        if (memblock_set_device(ctx, &ext_mem_81988, &mem_81981, "mem_81981") != 0)
            return 1;
    } else if (memblock_set_device(ctx, &ext_mem_81988, &mem_81982, "mem_81982") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81982, "mem_81982") != 0)
        return 1;
    if (clBase_48690 == (int8_t) 1) {
        if (memblock_set_device(ctx, &ext_mem_81989, &mem_81983, "mem_81983") != 0)
            return 1;
    } else if (memblock_set_device(ctx, &ext_mem_81989, &mem_81984, "mem_81984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81984, "mem_81984") != 0)
        return 1;
    if (clBase_48690 == (int8_t) 1) {
        if (memblock_set_device(ctx, &ext_mem_81990, &mem_81985, "mem_81985") != 0)
            return 1;
    } else if (memblock_set_device(ctx, &ext_mem_81990, &mem_81986, "mem_81986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81986, "mem_81986") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_81991, (int64_t) 8, "mem_81991")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81992, (int64_t) 8, "mem_81992")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_do_DBSCAN_doublezigpuseq_83361(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_81987.mem, ext_mem_81988.mem, mem_81991.mem, mem_81992.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    double d_haversine_res_81607;
    
    if (x_81841) {
        double read_res_86909;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86909, ext_mem_81988.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81923 = read_res_86909;
        
        d_haversine_res_81607 = x_81923;
    } else {
        d_haversine_res_81607 = 0.0;
    }
    
    double cos_res_81611;
    
    if (x_81841) {
        double read_res_86910;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86910, mem_81992.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81925 = read_res_86910;
        
        cos_res_81611 = x_81925;
    } else {
        cos_res_81611 = 0.0;
    }
    
    double d_haversine_res_81608;
    
    if (x_81841) {
        double read_res_86911;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86911, ext_mem_81987.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81916 = read_res_86911;
        
        d_haversine_res_81608 = x_81916;
    } else {
        d_haversine_res_81608 = 0.0;
    }
    
    double cos_res_81612;
    
    if (x_81841) {
        double read_res_86912;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86912, mem_81991.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81918 = read_res_86912;
        
        cos_res_81612 = x_81918;
    } else {
        cos_res_81612 = 0.0;
    }
    
    double d_haversine_res_81609;
    
    if (x_81841) {
        double read_res_86913;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86913, ext_mem_81990.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81911 = read_res_86913;
        
        d_haversine_res_81609 = x_81911;
    } else {
        d_haversine_res_81609 = 0.0;
    }
    
    double d_haversine_res_81610;
    
    if (x_81841) {
        double read_res_86914;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86914, ext_mem_81989.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81906 = read_res_86914;
        
        d_haversine_res_81610 = x_81906;
    } else {
        d_haversine_res_81610 = 0.0;
    }
    
    int64_t bytes_81994 = (int64_t) 8 * dz2082U_48684;
    
    if (memblock_alloc_device(ctx, &mem_81995, bytes_81994, "mem_81995")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81997, bytes_81994, "mem_81997")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81998, dz2082U_48684, "mem_81998")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82000, bytes_81994, "mem_82000")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dz2082U_48684)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83367;
        
        shared_memory_83367 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83368;
        
        thread_block_sizze_83368 = ctx->max_thread_block_size;
        
        int64_t registers_83369;
        
        registers_83369 = ctx->max_registers;
        
        int64_t thread_block_sizze_83370;
        
        thread_block_sizze_83370 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83371 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83367, thread_block_sizze_83368), (int64_t) 8), squot64(squot64(registers_83369, thread_block_sizze_83370) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83372 = sdiv_up64(dz2082U_48684, segscan_tblock_sizze_75093 * chunk_sizze_83371);
        int64_t num_virt_threads_83373 = num_virt_blocks_83372 * segscan_tblock_sizze_75093;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83371, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83374, num_virt_blocks_83372, "status_flags_mem_83374")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83374, num_virt_blocks_83372, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83376, (int64_t) 8 * num_virt_blocks_83372, "aggregates_mem_83376")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83378, (int64_t) 8 * num_virt_blocks_83372, "incprefixes_mem_83378")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75098(ctx, num_tblocks_75095, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75092, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75093), chunk_sizze_83371 * segscan_tblock_sizze_75093 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75093), chunk_sizze_83371 * segscan_tblock_sizze_75093 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dz2080U_48682, dz2081U_48683, dz2082U_48684, clBase_48690, clBase_48691, clBase_48698, zt_res_61589, num_tblocks_75095, d_haversine_res_81607, d_haversine_res_81608, d_haversine_res_81609, d_haversine_res_81610, cos_res_81611, cos_res_81612, num_virt_blocks_83372, num_virt_threads_83373, clProc_mem_81933.mem, clProc_mem_81934.mem, clProc_mem_81935.mem, clProc_mem_81936.mem, mem_81979.mem, mem_81981.mem, mem_81983.mem, mem_81985.mem, mem_81995.mem, mem_81997.mem, mem_81998.mem, mem_82000.mem, status_flags_mem_83374.mem, aggregates_mem_83376.mem, incprefixes_mem_83378.mem, global_dynid_mem_83380.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t m_f_res_61886;
    
    if (x_61879) {
        int64_t read_res_86915;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86915, mem_81995.mem, tmp_61880 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66209 = read_res_86915;
        
        m_f_res_61886 = x_66209;
    } else {
        m_f_res_61886 = (int64_t) 0;
    }
    
    int64_t m_61888;
    
    if (cond_61878) {
        m_61888 = (int64_t) 0;
    } else {
        m_61888 = m_f_res_61886;
    }
    
    int64_t m_61898 = sub64(m_61888, (int64_t) 1);
    bool i_p_m_t_s_leq_w_61900 = slt64(m_61898, dz2082U_48684);
    bool zzero_leq_i_p_m_t_s_61899 = sle64((int64_t) 0, m_61898);
    bool y_61902 = zzero_leq_i_p_m_t_s_61899 && i_p_m_t_s_leq_w_61900;
    bool i_lte_j_61901 = sle64((int64_t) 0, m_61888);
    bool forwards_ok_61903 = i_lte_j_61901 && y_61902;
    bool eq_x_zz_61895 = (int64_t) 0 == m_f_res_61886;
    bool p_and_eq_x_y_61896 = x_61879 && eq_x_zz_61895;
    bool empty_slice_61897 = cond_61878 || p_and_eq_x_y_61896;
    bool ok_or_empty_61904 = empty_slice_61897 || forwards_ok_61903;
    bool index_certs_61905;
    
    if (!ok_or_empty_61904) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_61888, "] out of bounds for array of shape [", (long long) dz2082U_48684, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82001 = (int64_t) 8 * m_61888;
    
    if (memblock_alloc_device(ctx, &mem_82002, bytes_82001, "mem_82002")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_82002, m_61888, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82004, bytes_82001, "mem_82004")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82004.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82000.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61888})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82005, m_61888, "mem_82005")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_1b(ctx, 1, mem_82005.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_81998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61888})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82007, bytes_82001, "mem_82007")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82007.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, clProc_mem_81936.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61888})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82009, bytes_82001, "mem_82009")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82009.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, clProc_mem_81935.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_61888})) != 0)
        goto cleanup;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83469 = sext_i64_i32(sdiv_up64(dz2082U_48684, segmap_tblock_sizze_75103));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75100(ctx, num_tblocks_75105, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75102, 1, 1, (int64_t) 0, dz2082U_48684, m_61888, num_tblocks_75105, virt_num_tblocks_83469, clProc_mem_81935.mem, clProc_mem_81936.mem, mem_81995.mem, mem_81997.mem, mem_81998.mem, mem_82000.mem, mem_82002.mem, mem_82004.mem, mem_82005.mem, mem_82007.mem, mem_82009.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81995, "mem_81995") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81997, "mem_81997") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81998, "mem_81998") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82000, "mem_82000") != 0)
        return 1;
    
    int64_t num_tblocks_75111;
    int64_t max_num_tblocks_83482;
    
    max_num_tblocks_83482 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75110;
    num_tblocks_75111 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_61888, segscan_tblock_sizze_75109), max_num_tblocks_83482)));
    
    double d_haversine_res_81617;
    
    if (x_81841) {
        double read_res_86916;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86916, ext_mem_81988.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81899 = read_res_86916;
        
        d_haversine_res_81617 = x_81899;
    } else {
        d_haversine_res_81617 = 0.0;
    }
    
    double cos_res_81621;
    
    if (x_81841) {
        double read_res_86917;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86917, mem_81992.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81901 = read_res_86917;
        
        cos_res_81621 = x_81901;
    } else {
        cos_res_81621 = 0.0;
    }
    
    double d_haversine_res_81618;
    
    if (x_81841) {
        double read_res_86918;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86918, ext_mem_81987.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81892 = read_res_86918;
        
        d_haversine_res_81618 = x_81892;
    } else {
        d_haversine_res_81618 = 0.0;
    }
    
    double cos_res_81622;
    
    if (x_81841) {
        double read_res_86919;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86919, mem_81991.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81894 = read_res_86919;
        
        cos_res_81622 = x_81894;
    } else {
        cos_res_81622 = 0.0;
    }
    
    double d_haversine_res_81619;
    
    if (x_81841) {
        double read_res_86920;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86920, ext_mem_81990.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81887 = read_res_86920;
        
        d_haversine_res_81619 = x_81887;
    } else {
        d_haversine_res_81619 = 0.0;
    }
    
    double d_haversine_res_81620;
    
    if (x_81841) {
        double read_res_86921;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86921, ext_mem_81989.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81882 = read_res_86921;
        
        d_haversine_res_81620 = x_81882;
    } else {
        d_haversine_res_81620 = 0.0;
    }
    if (memblock_alloc_device(ctx, &mem_82013, bytes_82001, "mem_82013")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82015, bytes_82001, "mem_82015")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82017, bytes_82001, "mem_82017")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_61888)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83483;
        
        shared_memory_83483 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83484;
        
        thread_block_sizze_83484 = ctx->max_thread_block_size;
        
        int64_t registers_83485;
        
        registers_83485 = ctx->max_registers;
        
        int64_t thread_block_sizze_83486;
        
        thread_block_sizze_83486 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83487 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83483, thread_block_sizze_83484), (int64_t) 8), squot64(squot64(registers_83485, thread_block_sizze_83486) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83488 = sdiv_up64(m_61888, segscan_tblock_sizze_75109 * chunk_sizze_83487);
        int64_t num_virt_threads_83489 = num_virt_blocks_83488 * segscan_tblock_sizze_75109;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83487, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83490, num_virt_blocks_83488, "status_flags_mem_83490")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83490, num_virt_blocks_83488, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83492, (int64_t) 8 * num_virt_blocks_83488, "aggregates_mem_83492")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83494, (int64_t) 8 * num_virt_blocks_83488, "incprefixes_mem_83494")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83496, (int64_t) 8 * num_virt_blocks_83488, "aggregates_mem_83496")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83498, (int64_t) 8 * num_virt_blocks_83488, "incprefixes_mem_83498")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75114(ctx, num_tblocks_75111, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75108, 1, 1, smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75109, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75109), smax64(chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8, chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 544, sdiv_up64((int64_t) 8 * segscan_tblock_sizze_75109, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75109), smax64(chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8, chunk_sizze_83487 * segscan_tblock_sizze_75109 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_61888, num_tblocks_75111, d_haversine_res_81617, d_haversine_res_81618, d_haversine_res_81619, d_haversine_res_81620, cos_res_81621, cos_res_81622, num_virt_blocks_83488, num_virt_threads_83489, mem_81979.mem, mem_81981.mem, mem_81983.mem, mem_81985.mem, mem_82007.mem, mem_82009.mem, mem_82013.mem, mem_82015.mem, mem_82017.mem, status_flags_mem_83490.mem, aggregates_mem_83492.mem, incprefixes_mem_83494.mem, aggregates_mem_83496.mem, incprefixes_mem_83498.mem, global_dynid_mem_83500.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool x_62139 = !empty_slice_61897;
    int64_t last_offset_62140;
    
    if (x_62139) {
        int64_t read_res_86922;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86922, mem_82013.mem, m_61898 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66256 = read_res_86922;
        
        last_offset_62140 = x_66256;
    } else {
        last_offset_62140 = (int64_t) 0;
    }
    
    int64_t partition_sizze_62142;
    
    if (empty_slice_61897) {
        partition_sizze_62142 = (int64_t) 0;
    } else {
        partition_sizze_62142 = last_offset_62140;
    }
    if (memblock_alloc_device(ctx, &mem_82019, bytes_82001, "mem_82019")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82021, bytes_82001, "mem_82021")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82022, m_61888, "mem_82022")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82024, bytes_82001, "mem_82024")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82026, bytes_82001, "mem_82026")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t y_62148 = (int64_t) -1 + partition_sizze_62142;
    int64_t num_tblocks_75121;
    int64_t max_num_tblocks_83635;
    
    max_num_tblocks_83635 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75120;
    num_tblocks_75121 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_61888, segmap_tblock_sizze_75119), max_num_tblocks_83635)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83636 = sext_i64_i32(sdiv_up64(m_61888, segmap_tblock_sizze_75119));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75116(ctx, num_tblocks_75121, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75118, 1, 1, (int64_t) 0, m_61888, y_62148, num_tblocks_75121, virt_num_tblocks_83636, mem_82002.mem, mem_82004.mem, mem_82005.mem, mem_82007.mem, mem_82009.mem, mem_82013.mem, mem_82015.mem, mem_82017.mem, mem_82019.mem, mem_82021.mem, mem_82022.mem, mem_82024.mem, mem_82026.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82002, "mem_82002") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82004, "mem_82004") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82005, "mem_82005") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82007, "mem_82007") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82009, "mem_82009") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82013, "mem_82013") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82015, "mem_82015") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82017, "mem_82017") != 0)
        return 1;
    
    bool eq_x_zz_62168 = (int64_t) 0 == last_offset_62140;
    bool p_and_eq_x_y_62169 = x_62139 && eq_x_zz_62168;
    bool empty_slice_62170 = empty_slice_61897 || p_and_eq_x_y_62169;
    int64_t m_62171 = sub64(partition_sizze_62142, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_62172 = sle64((int64_t) 0, m_62171);
    bool i_p_m_t_s_leq_w_62173 = slt64(m_62171, m_61888);
    bool i_lte_j_62174 = sle64((int64_t) 0, partition_sizze_62142);
    bool y_62175 = zzero_leq_i_p_m_t_s_62172 && i_p_m_t_s_leq_w_62173;
    bool forwards_ok_62176 = i_lte_j_62174 && y_62175;
    bool ok_or_empty_62177 = empty_slice_62170 || forwards_ok_62176;
    bool index_certs_62178;
    
    if (!ok_or_empty_62177) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) partition_sizze_62142, "] out of bounds for array of shape [", (long long) m_61888, "].", "-> #0  /prelude/soacs.fut:174:7-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_62241 = slt64(m_62171, partition_sizze_62142);
    bool bounds_check_62242 = zzero_leq_i_p_m_t_s_62172 && y_62241;
    bool protect_assert_disj_62243 = empty_slice_62170 || bounds_check_62242;
    bool index_certs_62244;
    
    if (!protect_assert_disj_62243) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_62171, "] out of bounds for array of shape [", (long long) partition_sizze_62142, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_62240 = !empty_slice_62170;
    
    if (futrts_get_num_neighbours_against_11935(ctx, &ext_mem_82028, mem_82019, mem_82021, mem_81964, mem_81962, partition_sizze_62142, m_61612, clBase_48692, clBase_48691, clBase_48690, clBase_48698, clBase_48693) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t j_m_i_62183 = sub64(m_61888, partition_sizze_62142);
    int64_t m_62185 = sub64(j_m_i_62183, (int64_t) 1);
    int64_t i_p_m_t_s_62186 = add64(partition_sizze_62142, m_62185);
    bool i_p_m_t_s_leq_w_62188 = slt64(i_p_m_t_s_62186, m_61888);
    bool zzero_leq_i_p_m_t_s_62187 = sle64((int64_t) 0, i_p_m_t_s_62186);
    bool y_62190 = zzero_leq_i_p_m_t_s_62187 && i_p_m_t_s_leq_w_62188;
    bool i_lte_j_62189 = sle64(partition_sizze_62142, m_61888);
    bool forwards_ok_62191 = i_lte_j_62189 && y_62190;
    bool empty_slice_62184 = j_m_i_62183 == (int64_t) 0;
    bool ok_or_empty_62192 = empty_slice_62184 || forwards_ok_62191;
    bool index_certs_62193;
    
    if (!ok_or_empty_62192) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) partition_sizze_62142, ":", (long long) m_61888, "] out of bounds for array of shape [", (long long) m_61888, "].", "-> #0  /prelude/soacs.fut:174:21-33\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82029 = (int64_t) 8 * j_m_i_62183;
    
    if (memblock_alloc_device(ctx, &mem_82030, bytes_82029, "mem_82030")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82030.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82019.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62183})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82033, bytes_82029, "mem_82033")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82033.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82021.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62183})) != 0)
        goto cleanup;
    if (futrts_get_num_neighbours_against_11935(ctx, &ext_mem_82035, mem_82019, mem_82021, mem_82030, mem_82033, partition_sizze_62142, j_m_i_62183, clBase_48692, clBase_48691, clBase_48690, clBase_48698, clBase_48693) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_82030, "mem_82030") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82033, "mem_82033") != 0)
        return 1;
    if (futrts_get_num_neighbours_against_11932(ctx, &ext_mem_82036, mem_82019, mem_82021, mem_82019, mem_82021, partition_sizze_62142, partition_sizze_62142, clBase_48692, clBase_48691, clBase_48690, clBase_48698, clBase_48693) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_tblocks_75127;
    int64_t max_num_tblocks_83649;
    
    max_num_tblocks_83649 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75126;
    num_tblocks_75127 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(partition_sizze_62142, segscan_tblock_sizze_75125), max_num_tblocks_83649)));
    
    int64_t bytes_82038 = (int64_t) 8 * partition_sizze_62142;
    
    if (memblock_alloc_device(ctx, &mem_82039, bytes_82038, "mem_82039")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82041, bytes_82038, "mem_82041")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82042, partition_sizze_62142, "mem_82042")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, partition_sizze_62142)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83650;
        
        shared_memory_83650 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83651;
        
        thread_block_sizze_83651 = ctx->max_thread_block_size;
        
        int64_t registers_83652;
        
        registers_83652 = ctx->max_registers;
        
        int64_t thread_block_sizze_83653;
        
        thread_block_sizze_83653 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83654 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83650, thread_block_sizze_83651), (int64_t) 8), squot64(squot64(registers_83652, thread_block_sizze_83653) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83655 = sdiv_up64(partition_sizze_62142, segscan_tblock_sizze_75125 * chunk_sizze_83654);
        int64_t num_virt_threads_83656 = num_virt_blocks_83655 * segscan_tblock_sizze_75125;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83654, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83657, num_virt_blocks_83655, "status_flags_mem_83657")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83657, num_virt_blocks_83655, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83659, (int64_t) 8 * num_virt_blocks_83655, "aggregates_mem_83659")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83661, (int64_t) 8 * num_virt_blocks_83655, "incprefixes_mem_83661")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75130(ctx, num_tblocks_75127, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75124, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75125), chunk_sizze_83654 * segscan_tblock_sizze_75125 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75125), chunk_sizze_83654 * segscan_tblock_sizze_75125 * (int64_t) 8), (int64_t) 8), (int64_t) 8), clBase_48695, partition_sizze_62142, num_tblocks_75127, num_virt_blocks_83655, num_virt_threads_83656, ext_mem_82028.mem, ext_mem_82035.mem, ext_mem_82036.mem, mem_82039.mem, mem_82041.mem, mem_82042.mem, status_flags_mem_83657.mem, aggregates_mem_83659.mem, incprefixes_mem_83661.mem, global_dynid_mem_83663.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_82028, "ext_mem_82028") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82035, "ext_mem_82035") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82036, "ext_mem_82036") != 0)
        return 1;
    
    int64_t m_f_res_62245;
    
    if (x_62240) {
        int64_t read_res_86923;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86923, mem_82039.mem, m_62171 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66271 = read_res_86923;
        
        m_f_res_62245 = x_66271;
    } else {
        m_f_res_62245 = (int64_t) 0;
    }
    
    int64_t m_62247;
    
    if (empty_slice_62170) {
        m_62247 = (int64_t) 0;
    } else {
        m_62247 = m_f_res_62245;
    }
    
    int64_t m_62257 = sub64(m_62247, (int64_t) 1);
    bool i_p_m_t_s_leq_w_62259 = slt64(m_62257, partition_sizze_62142);
    bool zzero_leq_i_p_m_t_s_62258 = sle64((int64_t) 0, m_62257);
    bool y_62261 = zzero_leq_i_p_m_t_s_62258 && i_p_m_t_s_leq_w_62259;
    bool i_lte_j_62260 = sle64((int64_t) 0, m_62247);
    bool forwards_ok_62262 = i_lte_j_62260 && y_62261;
    bool eq_x_zz_62254 = (int64_t) 0 == m_f_res_62245;
    bool p_and_eq_x_y_62255 = x_62240 && eq_x_zz_62254;
    bool empty_slice_62256 = empty_slice_62170 || p_and_eq_x_y_62255;
    bool ok_or_empty_62263 = empty_slice_62256 || forwards_ok_62262;
    bool index_certs_62264;
    
    if (!ok_or_empty_62263) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_62247, "] out of bounds for array of shape [", (long long) partition_sizze_62142, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82043 = (int64_t) 8 * m_62247;
    
    if (memblock_alloc_device(ctx, &mem_82044, bytes_82043, "mem_82044")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82044.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82024.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62247})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82046, bytes_82043, "mem_82046")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82046.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82021.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62247})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82048, bytes_82043, "mem_82048")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82048.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62247})) != 0)
        goto cleanup;
    
    int64_t num_tblocks_75137;
    int64_t max_num_tblocks_83752;
    
    max_num_tblocks_83752 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75136;
    num_tblocks_75137 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(partition_sizze_62142, segmap_tblock_sizze_75135), max_num_tblocks_83752)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83753 = sext_i64_i32(sdiv_up64(partition_sizze_62142, segmap_tblock_sizze_75135));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75132(ctx, num_tblocks_75137, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75134, 1, 1, (int64_t) 0, partition_sizze_62142, m_62247, num_tblocks_75137, virt_num_tblocks_83753, mem_82019.mem, mem_82021.mem, mem_82024.mem, mem_82039.mem, mem_82041.mem, mem_82044.mem, mem_82046.mem, mem_82048.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82039, "mem_82039") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82041, "mem_82041") != 0)
        return 1;
    
    bool y_62321 = slt64(m_62185, j_m_i_62183);
    bool x_62320 = sle64((int64_t) 0, m_62185);
    bool bounds_check_62322 = x_62320 && y_62321;
    bool protect_assert_disj_62323 = empty_slice_62184 || bounds_check_62322;
    bool protect_assert_disj_62324 = cond_62318 || protect_assert_disj_62323;
    bool index_certs_62325;
    
    if (!protect_assert_disj_62324) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_62185, "] out of bounds for array of shape [", (long long) j_m_i_62183, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_62319 = !empty_slice_62184;
    int64_t num_tblocks_75143;
    int64_t max_num_tblocks_83766;
    
    max_num_tblocks_83766 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75142;
    num_tblocks_75143 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(j_m_i_62183, segscan_tblock_sizze_75141), max_num_tblocks_83766)));
    
    int64_t num_tblocks_75153;
    int64_t max_num_tblocks_83767;
    
    max_num_tblocks_83767 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75152;
    num_tblocks_75153 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(j_m_i_62183, segmap_tblock_sizze_75151), max_num_tblocks_83767)));
    
    int64_t do_DBSCAN_res_62326;
    int64_t do_DBSCAN_res_62327;
    int64_t do_DBSCAN_res_62328;
    
    if (cond_62318) {
        if (memblock_alloc_device(ctx, &mem_82062, (int64_t) 0, "mem_82062")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82063, (int64_t) 0, "mem_82063")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_82066, &mem_82062, "mem_82062") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82065, &mem_82062, "mem_82062") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82064, &mem_82063, "mem_82063") != 0)
            return 1;
        do_DBSCAN_res_62326 = (int64_t) 0;
        do_DBSCAN_res_62327 = (int64_t) 0;
        do_DBSCAN_res_62328 = (int64_t) 0;
    } else {
        if (memblock_alloc_device(ctx, &mem_82052, bytes_82029, "mem_82052")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82054, bytes_82029, "mem_82054")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, j_m_i_62183)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_83768;
            
            shared_memory_83768 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_83769;
            
            thread_block_sizze_83769 = ctx->max_thread_block_size;
            
            int64_t registers_83770;
            
            registers_83770 = ctx->max_registers;
            
            int64_t thread_block_sizze_83771;
            
            thread_block_sizze_83771 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_83772 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83768, thread_block_sizze_83769), (int64_t) 8), squot64(squot64(registers_83770, thread_block_sizze_83771) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_83773 = sdiv_up64(j_m_i_62183, segscan_tblock_sizze_75141 * chunk_sizze_83772);
            int64_t num_virt_threads_83774 = num_virt_blocks_83773 * segscan_tblock_sizze_75141;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83772, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_83775, num_virt_blocks_83773, "status_flags_mem_83775")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83775, num_virt_blocks_83773, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_83777, (int64_t) 8 * num_virt_blocks_83773, "aggregates_mem_83777")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_83779, (int64_t) 8 * num_virt_blocks_83773, "incprefixes_mem_83779")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_do_DBSCAN_doublezisegscan_75146(ctx, num_tblocks_75143, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75140, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75141), chunk_sizze_83772 * segscan_tblock_sizze_75141 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75141), chunk_sizze_83772 * segscan_tblock_sizze_75141 * (int64_t) 8), (int64_t) 8), (int64_t) 8), partition_sizze_62142, j_m_i_62183, num_tblocks_75143, num_virt_blocks_83773, num_virt_threads_83774, mem_82022.mem, mem_82052.mem, mem_82054.mem, status_flags_mem_83775.mem, aggregates_mem_83777.mem, incprefixes_mem_83779.mem, global_dynid_mem_83781.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        
        int64_t m_f_res_62342;
        
        if (x_62319) {
            int64_t read_res_86924;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86924, mem_82052.mem, m_62185 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t x_66262 = read_res_86924;
            
            m_f_res_62342 = x_66262;
        } else {
            m_f_res_62342 = (int64_t) 0;
        }
        
        int64_t m_62344;
        
        if (empty_slice_62184) {
            m_62344 = (int64_t) 0;
        } else {
            m_62344 = m_f_res_62342;
        }
        
        int64_t m_62354 = sub64(m_62344, (int64_t) 1);
        bool i_p_m_t_s_leq_w_62356 = slt64(m_62354, j_m_i_62183);
        bool zzero_leq_i_p_m_t_s_62355 = sle64((int64_t) 0, m_62354);
        bool y_62358 = zzero_leq_i_p_m_t_s_62355 && i_p_m_t_s_leq_w_62356;
        bool i_lte_j_62357 = sle64((int64_t) 0, m_62344);
        bool forwards_ok_62359 = i_lte_j_62357 && y_62358;
        bool eq_x_zz_62351 = (int64_t) 0 == m_f_res_62342;
        bool p_and_eq_x_y_62352 = x_62319 && eq_x_zz_62351;
        bool empty_slice_62353 = empty_slice_62184 || p_and_eq_x_y_62352;
        bool ok_or_empty_62360 = empty_slice_62353 || forwards_ok_62359;
        bool index_certs_62361;
        
        if (!ok_or_empty_62360) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_62344, "] out of bounds for array of shape [", (long long) j_m_i_62183, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_82055 = (int64_t) 8 * m_62344;
        
        if (memblock_alloc_device(ctx, &mem_82056, bytes_82055, "mem_82056")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82024.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62344})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_82058, bytes_82055, "mem_82058")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82021.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62344})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_82060, bytes_82055, "mem_82060")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82019.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62344})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_83870 = sext_i64_i32(sdiv_up64(j_m_i_62183, segmap_tblock_sizze_75151));
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_75148(ctx, num_tblocks_75153, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75150, 1, 1, (int64_t) 0, partition_sizze_62142, j_m_i_62183, m_62344, num_tblocks_75153, virt_num_tblocks_83870, mem_82019.mem, mem_82021.mem, mem_82024.mem, mem_82052.mem, mem_82054.mem, mem_82056.mem, mem_82058.mem, mem_82060.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_82052, "mem_82052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82054, "mem_82054") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82066, &mem_82060, "mem_82060") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82065, &mem_82058, "mem_82058") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82064, &mem_82056, "mem_82056") != 0)
            return 1;
        do_DBSCAN_res_62326 = m_62344;
        do_DBSCAN_res_62327 = m_62344;
        do_DBSCAN_res_62328 = m_62344;
    }
    if (memblock_unref_device(ctx, &mem_82022, "mem_82022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82024, "mem_82024") != 0)
        return 1;
    if (futrts_get_num_neighbours_against_11935(ctx, &ext_mem_82067, mem_81964, mem_81962, mem_82019, mem_82021, m_61612, partition_sizze_62142, clBase_48692, clBase_48691, clBase_48690, clBase_48698, clBase_48693) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_81962, "mem_81962") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81964, "mem_81964") != 0)
        return 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83883 = sext_i64_i32(sdiv_up64(m_61612, segmap_tblock_sizze_75159));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75156(ctx, num_tblocks_75161, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75158, 1, 1, (int64_t) 0, n_48679, m_61612, num_tblocks_75161, virt_num_tblocks_83883, mem_81966.mem, mem_81970.mem, ext_mem_82067.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_81966, "mem_81966") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82067, "ext_mem_82067") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82070, n_48679, "mem_82070")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83896 = sext_i64_i32(sdiv_up64(n_48679, segmap_tblock_sizze_75177));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75181(ctx, segmap_usable_groups_75178, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75166, 1, 1, (int64_t) 0, n_48679, clBase_48695, ext_mem_81968.mem, mem_81970.mem, mem_82070.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_81968, "ext_mem_81968") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81970, "mem_81970") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82073, bytes_81953, "mem_82073")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82075, bytes_81953, "mem_82075")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, n_48679)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83905;
        
        shared_memory_83905 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83906;
        
        thread_block_sizze_83906 = ctx->max_thread_block_size;
        
        int64_t registers_83907;
        
        registers_83907 = ctx->max_registers;
        
        int64_t thread_block_sizze_83908;
        
        thread_block_sizze_83908 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83909 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83905, thread_block_sizze_83906), (int64_t) 8), squot64(squot64(registers_83907, thread_block_sizze_83908) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83910 = sdiv_up64(n_48679, segscan_tblock_sizze_75189 * chunk_sizze_83909);
        int64_t num_virt_threads_83911 = num_virt_blocks_83910 * segscan_tblock_sizze_75189;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83909, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83912, num_virt_blocks_83910, "status_flags_mem_83912")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83912, num_virt_blocks_83910, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83914, (int64_t) 8 * num_virt_blocks_83910, "aggregates_mem_83914")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83916, (int64_t) 8 * num_virt_blocks_83910, "incprefixes_mem_83916")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75194(ctx, num_tblocks_75191, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75188, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75189), chunk_sizze_83909 * segscan_tblock_sizze_75189 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75189), chunk_sizze_83909 * segscan_tblock_sizze_75189 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_48679, num_tblocks_75191, num_virt_blocks_83910, num_virt_threads_83911, mem_82070.mem, mem_82073.mem, mem_82075.mem, status_flags_mem_83912.mem, aggregates_mem_83914.mem, incprefixes_mem_83916.mem, global_dynid_mem_83918.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t m_f_res_62287;
    
    if (x_61603) {
        int64_t read_res_86925;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86925, mem_82073.mem, tmp_61604 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66272 = read_res_86925;
        
        m_f_res_62287 = x_66272;
    } else {
        m_f_res_62287 = (int64_t) 0;
    }
    
    int64_t m_62289;
    
    if (cond_61602) {
        m_62289 = (int64_t) 0;
    } else {
        m_62289 = m_f_res_62287;
    }
    
    int64_t m_62299 = sub64(m_62289, (int64_t) 1);
    bool i_p_m_t_s_leq_w_62301 = slt64(m_62299, n_48679);
    bool zzero_leq_i_p_m_t_s_62300 = sle64((int64_t) 0, m_62299);
    bool y_62303 = zzero_leq_i_p_m_t_s_62300 && i_p_m_t_s_leq_w_62301;
    bool i_lte_j_62302 = sle64((int64_t) 0, m_62289);
    bool forwards_ok_62304 = i_lte_j_62302 && y_62303;
    bool eq_x_zz_62296 = (int64_t) 0 == m_f_res_62287;
    bool p_and_eq_x_y_62297 = x_61603 && eq_x_zz_62296;
    bool empty_slice_62298 = cond_61602 || p_and_eq_x_y_62297;
    bool ok_or_empty_62305 = empty_slice_62298 || forwards_ok_62304;
    bool index_certs_62306;
    
    if (!ok_or_empty_62305) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_62289, "] out of bounds for array of shape [", (long long) n_48679, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82076 = (int64_t) 8 * m_62289;
    
    if (memblock_alloc_device(ctx, &mem_82077, bytes_82076, "mem_82077")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_82077, m_62289, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82079, bytes_82076, "mem_82079")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82079.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_81960.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62289})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_81960, "mem_81960") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82081, bytes_82076, "mem_82081")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82081.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_81958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62289})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_81958, "mem_81958") != 0)
        return 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_84007 = sext_i64_i32(sdiv_up64(n_48679, segmap_tblock_sizze_75199));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75196(ctx, num_tblocks_75201, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75198, 1, 1, (int64_t) 0, n_48679, m_62289, num_tblocks_75201, virt_num_tblocks_84007, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_82073.mem, mem_82075.mem, mem_82077.mem, mem_82079.mem, mem_82081.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82073, "mem_82073") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82075, "mem_82075") != 0)
        return 1;
    
    int64_t conc_tmp_62375 = m_62247 + m_62289;
    bool dim_match_62376 = do_DBSCAN_res_62326 == do_DBSCAN_res_62327;
    bool empty_or_match_cert_62377;
    
    if (!dim_match_62376) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftDBSCAN_plus.fut:857:51-80\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t conc_tmp_62379 = do_DBSCAN_res_62326 + conc_tmp_62375;
    int64_t conc_tmp_62382 = do_DBSCAN_res_62328 + conc_tmp_62375;
    int64_t bytes_82083 = (int64_t) 8 * conc_tmp_62382;
    
    if (memblock_alloc_device(ctx, &mem_82084, bytes_82083, "mem_82084")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_84020 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82084.mem, tmp_offs_84020, (int64_t []) {(int64_t) 1}, mem_82077.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62289})) != 0)
        goto cleanup;
    tmp_offs_84020 += m_62289;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82084.mem, tmp_offs_84020, (int64_t []) {(int64_t) 1}, mem_82044.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62247})) != 0)
        goto cleanup;
    tmp_offs_84020 += m_62247;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82084.mem, tmp_offs_84020, (int64_t []) {(int64_t) 1}, ext_mem_82064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {do_DBSCAN_res_62328})) != 0)
        goto cleanup;
    tmp_offs_84020 += do_DBSCAN_res_62328;
    
    bool dim_match_62384 = conc_tmp_62382 == conc_tmp_62379;
    bool empty_or_match_cert_62385;
    
    if (!dim_match_62384) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) conc_tmp_62379, "] cannot match shape of type `[", (long long) conc_tmp_62382, "](f64, f64)`.", "-> #0  ft_libs/ftDBSCAN_plus.fut:634:48-70\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_res_62388 = smax64((int64_t) 1, conc_tmp_62382);
    bool zzero_62389 = max_res_62388 == (int64_t) 0;
    bool nonzzero_62390 = !zzero_62389;
    bool nonzzero_cert_62391;
    
    if (!nonzzero_62390) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:636:63-77\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_62392 = sdiv64(clBase_48693, max_res_62388);
    int64_t max_res_62393 = smax64((int64_t) 1, max_arg1_62392);
    int64_t zm_lhs_62394 = add64(conc_tmp_62382, max_res_62393);
    int64_t zs_lhs_62395 = sub64(zm_lhs_62394, (int64_t) 1);
    bool zzero_62396 = max_res_62393 == (int64_t) 0;
    bool nonzzero_62397 = !zzero_62396;
    bool nonzzero_cert_62398;
    
    if (!nonzzero_62397) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:637:66-74\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_iter_62399 = sdiv64(zs_lhs_62395, max_res_62393);
    bool bounds_invalid_upwards_62696 = slt64(num_iter_62399, (int64_t) 0);
    bool valid_62697 = !bounds_invalid_upwards_62696;
    bool protect_assert_disj_63664 = compact_list_48727 || valid_62697;
    bool range_valid_c_62698;
    
    if (!protect_assert_disj_63664) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_iter_62399, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:531:65-78\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_63658 = nonzzero_62397 || loop_not_taken_63657;
    bool nonzzero_cert_62405;
    
    if (!protect_assert_disj_63658) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:558:58-65\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t inner_iter_62406 = sdiv_safe64(zs_lhs_62395, max_res_62393);
    bool bounds_invalid_upwards_62409 = slt64(inner_iter_62406, (int64_t) 0);
    bool valid_62410 = !bounds_invalid_upwards_62409;
    bool protect_assert_disj_63660 = valid_62410 || loop_not_taken_63657;
    bool range_valid_c_62411;
    
    if (!protect_assert_disj_63660) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) inner_iter_62406, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:561:42-57\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool eq_x_zz_62688 = conc_tmp_62382 == (int64_t) 0;
    int64_t num_tblocks_75821;
    int64_t max_num_tblocks_84021;
    
    max_num_tblocks_84021 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75820;
    num_tblocks_75821 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segred_tblock_sizze_75819), max_num_tblocks_84021)));
    
    int64_t num_tblocks_75462;
    int64_t max_num_tblocks_84022;
    
    max_num_tblocks_84022 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75461;
    num_tblocks_75462 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75460), max_num_tblocks_84022)));
    
    int64_t num_tblocks_75472;
    int64_t max_num_tblocks_84023;
    
    max_num_tblocks_84023 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75471;
    num_tblocks_75472 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75470), max_num_tblocks_84023)));
    
    int64_t num_whole_tiles_78140 = squot_safe64(conc_tmp_62382, tile_sizze_78072);
    int64_t residual_input_78371 = srem_safe64(conc_tmp_62382, tile_sizze_78072);
    bool cond_78372 = residual_input_78371 == (int64_t) 0;
    int64_t binop_x_78388 = tile_sizze_78072 * num_whole_tiles_78140;
    int64_t bytes_82133 = (int64_t) 8 * tile_sizze_78072;
    
    if (compact_list_48727) {
        if (memblock_alloc_device(ctx, &mem_82169, bytes_82083, "mem_82169")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_82169, conc_tmp_62382, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82170, (int64_t) 0, "mem_82170")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82172, bytes_82083, "mem_82172")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhiota_i64(ctx, mem_82172, conc_tmp_62382, (int64_t) 0, (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t mk_adjacency_list_res_66334;
        int64_t loop_dz2089U_66338;
        
        if (memblock_set_device(ctx, &mem_param_82178, &mem_82170, "mem_82170") != 0)
            return 1;
        loop_dz2089U_66338 = (int64_t) 0;
        for (int64_t i_66337 = 0; i_66337 < inner_iter_62406; i_66337++) {
            int64_t inf_66341 = mul64(max_res_62393, i_66337);
            int64_t min_arg1_66342 = add64(max_res_62393, inf_66341);
            int64_t min_res_66343 = smin64(conc_tmp_62382, min_arg1_66342);
            int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 = sub64(min_res_66343, inf_66341);
            int64_t dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345 = mul64(conc_tmp_62382, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344);
            bool empty_slice_66346 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 == (int64_t) 0;
            int64_t m_66347 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, (int64_t) 1);
            int64_t i_p_m_t_s_66348 = add64(inf_66341, m_66347);
            bool zzero_leq_i_p_m_t_s_66349 = sle64((int64_t) 0, i_p_m_t_s_66348);
            bool i_p_m_t_s_leq_w_66350 = slt64(i_p_m_t_s_66348, conc_tmp_62382);
            bool zzero_lte_i_66351 = sle64((int64_t) 0, inf_66341);
            bool i_lte_j_66352 = sle64(inf_66341, min_res_66343);
            bool y_66353 = i_p_m_t_s_leq_w_66350 && zzero_lte_i_66351;
            bool y_66354 = zzero_leq_i_p_m_t_s_66349 && y_66353;
            bool forwards_ok_66355 = i_lte_j_66352 && y_66354;
            bool ok_or_empty_66356 = empty_slice_66346 || forwards_ok_66355;
            bool index_certs_66357;
            
            if (!ok_or_empty_66356) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_66341, ":", (long long) min_res_66343, "] out of bounds for array of shape [", (long long) conc_tmp_62382, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:564:56-73\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool bounds_invalid_upwards_66358 = slt64(min_res_66343, inf_66341);
            bool valid_66359 = !bounds_invalid_upwards_66358;
            bool range_valid_c_66360;
            
            if (!valid_66359) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) inf_66341, "..<", (long long) min_res_66343, " is invalid.", "-> #0  ft_libs/ftDBSCAN_plus.fut:566:57-66\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_82179 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
            int64_t bytes_82182 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * bytes_82083;
            int64_t segmap_usable_groups_75351 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, segmap_tblock_sizze_75350);
            
            if (memblock_alloc_device(ctx, &mem_82186, bytes_82179, "mem_82186")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82188, bytes_82179, "mem_82188")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82190, bytes_82179, "mem_82190")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_84028 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, segmap_tblock_sizze_75350));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_75356(ctx, segmap_usable_groups_75351, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75330, 1, 1, (int64_t) 0, clBase_48690, m_62289, conc_tmp_62375, inf_66341, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_82186.mem, mem_82188.mem, mem_82190.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t segmap_usable_groups_75373 = sdiv_up64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, segmap_tblock_sizze_75372);
            
            if (memblock_alloc_device(ctx, &mem_82193, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, "mem_82193")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_84037 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * conc_tmp_62382, segmap_tblock_sizze_75372));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_75377(ctx, segmap_usable_groups_75373, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75219, 1, 1, (int64_t) 0, clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_62289, conc_tmp_62375, conc_tmp_62382, inf_66341, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, x_81841, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_82186.mem, mem_82188.mem, mem_82190.mem, mem_82193.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82186, "mem_82186") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82188, "mem_82188") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82190, "mem_82190") != 0)
                return 1;
            
            int64_t bytes_82195 = conc_tmp_62382 * bytes_82179;
            int64_t num_tblocks_75430;
            int64_t max_num_tblocks_84048;
            
            max_num_tblocks_84048 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75429;
            num_tblocks_75430 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, segscan_tblock_sizze_75428), max_num_tblocks_84048)));
            
            int64_t bytes_82202 = (int64_t) 8 * dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345;
            
            if (memblock_alloc_device(ctx, &mem_82203, bytes_82202, "mem_82203")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82205, bytes_82202, "mem_82205")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_84049;
                
                shared_memory_84049 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_84050;
                
                thread_block_sizze_84050 = ctx->max_thread_block_size;
                
                int64_t registers_84051;
                
                registers_84051 = ctx->max_registers;
                
                int64_t thread_block_sizze_84052;
                
                thread_block_sizze_84052 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_84053 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84049, thread_block_sizze_84050), (int64_t) 8), squot64(squot64(registers_84051, thread_block_sizze_84052) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
                int64_t num_virt_blocks_84054 = sdiv_up64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, segscan_tblock_sizze_75428 * chunk_sizze_84053);
                int64_t num_virt_threads_84055 = num_virt_blocks_84054 * segscan_tblock_sizze_75428;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84053, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_84056, num_virt_blocks_84054, "status_flags_mem_84056")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84056, num_virt_blocks_84054, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_84058, (int64_t) 8 * num_virt_blocks_84054, "aggregates_mem_84058")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_84060, (int64_t) 8 * num_virt_blocks_84054, "incprefixes_mem_84060")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegscan_75433(ctx, num_tblocks_75430, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75427, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75428), chunk_sizze_84053 * segscan_tblock_sizze_75428 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75428), chunk_sizze_84053 * segscan_tblock_sizze_75428 * (int64_t) 8), (int64_t) 8), (int64_t) 8), conc_tmp_62382, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, num_tblocks_75430, num_virt_blocks_84054, num_virt_threads_84055, mem_82193.mem, mem_82203.mem, mem_82205.mem, status_flags_mem_84056.mem, aggregates_mem_84058.mem, incprefixes_mem_84060.mem, global_dynid_mem_84062.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_unref_device(ctx, &mem_82193, "mem_82193") != 0)
                return 1;
            
            bool cond_66443 = dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345 == (int64_t) 0;
            bool x_66444 = !cond_66443;
            int64_t tmp_66445 = sub64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, (int64_t) 1);
            bool x_66446 = sle64((int64_t) 0, tmp_66445);
            bool y_66447 = slt64(tmp_66445, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345);
            bool bounds_check_66448 = x_66446 && y_66447;
            bool protect_assert_disj_66449 = cond_66443 || bounds_check_66448;
            bool index_certs_66450;
            
            if (!protect_assert_disj_66449) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_66445, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_66451;
            
            if (x_66444) {
                int64_t read_res_86926;
                
                if ((err = gpu_scalar_from_device(ctx, &read_res_86926, mem_82203.mem, tmp_66445 * sizeof(int64_t), sizeof(int64_t))) != 0)
                    goto cleanup;
                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t x_66452 = read_res_86926;
                
                m_f_res_66451 = x_66452;
            } else {
                m_f_res_66451 = (int64_t) 0;
            }
            
            int64_t m_66453;
            
            if (cond_66443) {
                m_66453 = (int64_t) 0;
            } else {
                m_66453 = m_f_res_66451;
            }
            
            int64_t m_66454 = sub64(m_66453, (int64_t) 1);
            bool i_p_m_t_s_leq_w_66455 = slt64(m_66454, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345);
            bool zzero_leq_i_p_m_t_s_66456 = sle64((int64_t) 0, m_66454);
            bool y_66457 = i_p_m_t_s_leq_w_66455 && zzero_leq_i_p_m_t_s_66456;
            bool i_lte_j_66458 = sle64((int64_t) 0, m_66453);
            bool forwards_ok_66459 = y_66457 && i_lte_j_66458;
            bool eq_x_zz_66460 = (int64_t) 0 == m_f_res_66451;
            bool p_and_eq_x_y_66461 = x_66444 && eq_x_zz_66460;
            bool empty_slice_66462 = cond_66443 || p_and_eq_x_y_66461;
            bool ok_or_empty_66463 = forwards_ok_66459 || empty_slice_66462;
            bool index_certs_66464;
            
            if (!ok_or_empty_66463) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_66453, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_82206 = (int64_t) 8 * m_66453;
            int64_t conc_tmp_66497 = loop_dz2089U_66338 + m_66453;
            int64_t bytes_82214 = (int64_t) 8 * conc_tmp_66497;
            
            if (memblock_alloc_device(ctx, &mem_82180, bytes_82179, "mem_82180")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_82180, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, inf_66341, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82183, bytes_82182, "mem_82183")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t replicate_n_84151 = conc_tmp_62382 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
            int64_t tblock_sizze_84156;
            
            tblock_sizze_84156 = *ctx->tuning_params.do_DBSCAN_doublezitblock_sizze_84156;
            
            int64_t virt_num_tblocks_84157 = sdiv_up64(replicate_n_84151, tblock_sizze_84156);
            int64_t num_tblocks_84158 = smin64(virt_num_tblocks_84157, (int64_t) 1048576);
            
            {
                err = gpu_kernel_do_DBSCAN_doublezireplicate_84152(ctx, num_tblocks_84158, 1, 1, tblock_sizze_84156, 1, 1, (int64_t) 0, conc_tmp_62382, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, replicate_n_84151, virt_num_tblocks_84157, num_tblocks_84158, mem_82180.mem, mem_82183.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_82180, "mem_82180") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82196, bytes_82195, "mem_82196")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t replicate_n_84171 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * conc_tmp_62382;
            int64_t tblock_sizze_84176;
            
            tblock_sizze_84176 = *ctx->tuning_params.do_DBSCAN_doublezitblock_sizze_84176;
            
            int64_t virt_num_tblocks_84177 = sdiv_up64(replicate_n_84171, tblock_sizze_84176);
            int64_t num_tblocks_84178 = smin64(virt_num_tblocks_84177, (int64_t) 1048576);
            
            {
                err = gpu_kernel_do_DBSCAN_doublezireplicate_84172(ctx, num_tblocks_84178, 1, 1, tblock_sizze_84176, 1, 1, (int64_t) 0, conc_tmp_62382, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, replicate_n_84171, virt_num_tblocks_84177, num_tblocks_84178, mem_82172.mem, mem_82196.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82199, bytes_82195, "mem_82199")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82199.mem, (int64_t) 0, (int64_t []) {conc_tmp_62382, (int64_t) 1}, mem_82183.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344}, (int64_t []) {dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, conc_tmp_62382})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &mem_82183, "mem_82183") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82207, bytes_82206, "mem_82207")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82196.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_66453})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &mem_82196, "mem_82196") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82209, bytes_82206, "mem_82209")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82209.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82199.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_66453})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &mem_82199, "mem_82199") != 0)
                return 1;
            
            int64_t num_tblocks_75440;
            int64_t max_num_tblocks_84191;
            
            max_num_tblocks_84191 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75439;
            num_tblocks_75440 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, segmap_tblock_sizze_75438), max_num_tblocks_84191)));
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_84192 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, segmap_tblock_sizze_75438));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_75435(ctx, num_tblocks_75440, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75437, 1, 1, (int64_t) 0, conc_tmp_62382, inf_66341, dzlz7bUZLztZRz20UZLZLzmZRz20Usupz20UinfZRz20Unz7dUzg_66345, m_66453, num_tblocks_75440, virt_num_tblocks_84192, mem_82203.mem, mem_82205.mem, mem_82207.mem, mem_82209.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82203, "mem_82203") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82205, "mem_82205") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82212, bytes_82179, "mem_82212")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_82212, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_tblocks_75446;
            int64_t max_num_tblocks_84205;
            
            max_num_tblocks_84205 = *ctx->tuning_params.do_DBSCAN_doubleziseghist_num_tblocks_75445;
            num_tblocks_75446 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_66453, seghist_tblock_sizze_75444), max_num_tblocks_84205)));
            
            int64_t num_subhistos_84206;
            int64_t h_84209 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
            int64_t seg_h_84210 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
            
            if (!(seg_h_84210 == (int64_t) 0)) {
                int64_t hist_H_84211 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
                int64_t hist_el_sizze_84212 = sdiv_up64(h_84209, hist_H_84211);
                int64_t hist_N_84213 = m_66453;
                int32_t hist_RF_84214 = 1;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegHist");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)", (long long) sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Desired block size (B)", (long long) seghist_tblock_sizze_75444, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_84211, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Input elements per histogram (N)", (long long) hist_N_84213, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of segments", (long long) (int64_t) 1, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Histogram element size (el_size)", (long long) hist_el_sizze_84212, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)", (long long) hist_RF_84214, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms per segment", (long long) h_84209, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms times segments", (long long) seg_h_84210, '\n');
                
                int64_t hist_L_84215;
                
                hist_L_84215 = *ctx->tuning_params.do_DBSCAN_doublezihist_L_84215;
                
                int64_t max_tblock_sizze_84216;
                
                max_tblock_sizze_84216 = ctx->max_thread_block_size;
                
                int64_t num_tblocks_84217 = sdiv_up64(sext_i32_i64(sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444)), max_tblock_sizze_84216);
                double hist_m_prime_84218 = sitofp_i64_f64(smin64(squot64(hist_L_84215, hist_el_sizze_84212), sdiv_up64(hist_N_84213, num_tblocks_84217))) / sitofp_i64_f64(hist_H_84211);
                int64_t hist_M0_84219 = smax64((int64_t) 1, smin64(fptosi_f64_i64(hist_m_prime_84218), max_tblock_sizze_84216));
                int64_t hist_Nout_84220 = (int64_t) 1;
                int64_t hist_Nin_84221 = m_66453;
                int64_t work_asymp_M_max_84222 = squot64(hist_Nout_84220 * hist_N_84213, (int64_t) 2 * num_tblocks_84217 * hist_H_84211);
                int32_t hist_M_84223 = sext_i64_i32(smin64(hist_M0_84219, work_asymp_M_max_84222));
                int64_t hist_C_84224 = sdiv_up64(max_tblock_sizze_84216, sext_i32_i64(smax32(1, hist_M_84223)));
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local hist_M0", (long long) hist_M0_84219, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local work asymp M max", (long long) work_asymp_M_max_84222, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local C", (long long) hist_C_84224, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local B", (long long) max_tblock_sizze_84216, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "local M", (long long) hist_M_84223, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "shared memory needed", (long long) (hist_H_84211 * hist_el_sizze_84212 * sext_i32_i64(hist_M_84223)), '\n');
                
                int64_t local_mem_needed_84225 = hist_el_sizze_84212 * sext_i32_i64(hist_M_84223);
                int32_t hist_S_84226 = sext_i64_i32(sdiv_up64(hist_H_84211 * local_mem_needed_84225 + (int64_t) 1, hist_L_84215));
                
                if (sle64(hist_H_84211, hist_Nin_84221) && (sle64(local_mem_needed_84225, hist_L_84215) && (sle32(hist_S_84226, 3) && (sle64(hist_C_84224, max_tblock_sizze_84216) && slt32(0, hist_M_84223))))) {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "## Using shared memory");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_84211, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_84223, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)", (long long) hist_C_84224, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_84226, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of local subhistograms per block", (long long) hist_M_84223, '\n');
                    num_subhistos_84206 = num_tblocks_84217;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of subhistograms in global memory per segment", (long long) num_subhistos_84206, '\n');
                    if (num_subhistos_84206 == (int64_t) 1) {
                        if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_84207, &mem_82212, "mem_82212") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_84207, num_subhistos_84206 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * (int64_t) 8, "defunc_0_map_res_subhistos_mem_84207")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, defunc_0_map_res_subhistos_mem_84207, num_subhistos_84206 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, defunc_0_map_res_subhistos_mem_84207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82212.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344})) != 0)
                            goto cleanup;
                    }
                    for (int32_t chk_i_84227 = 0; chk_i_84227 < hist_S_84226; chk_i_84227++) {
                        int64_t num_segments_84228 = (int64_t) 1;
                        int64_t hist_H_chk_84229 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, sext_i32_i64(hist_S_84226));
                        int64_t histo_sizze_84230 = hist_H_chk_84229;
                        int32_t init_per_thread_84231 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_84223) * histo_sizze_84230, max_tblock_sizze_84216));
                        
                        {
                            err = gpu_kernel_do_DBSCAN_doubleziseghist_local_75451(ctx, num_tblocks_84217, 1, 1, ctx->max_thread_block_size, 1, 1, (int64_t) 8 * (hist_M_84223 * hist_H_chk_84229) + srem64((int64_t) 8 - srem64((int64_t) 8 * (hist_M_84223 * hist_H_chk_84229), (int64_t) 8), (int64_t) 8), inf_66341, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, m_66453, num_subhistos_84206, num_tblocks_84217, hist_M_84223, chk_i_84227, num_segments_84228, hist_H_chk_84229, histo_sizze_84230, init_per_thread_84231, mem_82209.mem, defunc_0_map_res_subhistos_mem_84207.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    }
                } else {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "## Using global memory");
                    
                    int64_t hist_H_84263 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
                    double hist_RF_84264 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
                    int32_t hist_el_sizze_84265 = 8;
                    double hist_C_max_84266 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444)), sitofp_i32_f64(hist_H_84263) / 2.0);
                    int32_t hist_M_min_84267 = smax32(1, sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444)) / hist_C_max_84266)));
                    int64_t hist_L2_84268;
                    
                    hist_L2_84268 = *ctx->tuning_params.do_DBSCAN_doublezihist_L2_84268;
                    
                    double hist_RACE_exp_84269 = fmax64(1.0, 0.75 * hist_RF_84264 / (64.0 / sitofp_i32_f64(hist_el_sizze_84265)));
                    int32_t hist_S_84270;
                    
                    if (slt64(m_66453, hist_H_84263)) {
                        hist_S_84270 = 1;
                    } else {
                        hist_S_84270 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_84267) * hist_H_84263 * sext_i32_i64(hist_el_sizze_84265), fptosi_f64_i64(0.4 * sitofp_i32_f64(hist_L2_84268) * hist_RACE_exp_84269)));
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c", "Race expansion factor (RACE^exp)", (double) hist_RACE_exp_84269, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_84270, '\n');
                    
                    int64_t hist_H_chk_84271 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, sext_i32_i64(hist_S_84270));
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)", (long long) hist_H_chk_84271, '\n');
                    
                    double hist_k_max_84272 = fmin64(0.4 * (sitofp_i32_f64(hist_L2_84268) / sitofp_i32_f64(8)) * hist_RACE_exp_84269, sitofp_i32_f64(m_66453)) / sitofp_i32_f64(sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444));
                    int64_t hist_u_84273 = (int64_t) 2;
                    double hist_C_84274 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_75446 * seghist_tblock_sizze_75444)), sitofp_i32_f64(hist_u_84273 * hist_H_chk_84271) / hist_k_max_84272);
                    int32_t hist_M_84275 = 1;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c", "Elements/thread in L2 cache (k_max)", (double) hist_k_max_84272, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_84275, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)", (double) hist_C_84274, '\n');
                    num_subhistos_84206 = sext_i32_i64(hist_M_84275);
                    if (hist_M_84275 == 1) {
                        if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_84207, &mem_82212, "mem_82212") != 0)
                            return 1;
                    } else if (num_subhistos_84206 == (int64_t) 1) {
                        if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_84207, &mem_82212, "mem_82212") != 0)
                            return 1;
                    } else {
                        if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_84207, num_subhistos_84206 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344 * (int64_t) 8, "defunc_0_map_res_subhistos_mem_84207")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i64(ctx, defunc_0_map_res_subhistos_mem_84207, num_subhistos_84206 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, (int64_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, defunc_0_map_res_subhistos_mem_84207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82212.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344})) != 0)
                            goto cleanup;
                    }
                    for (int32_t chk_i_84276 = 0; chk_i_84276 < hist_S_84270; chk_i_84276++) {
                        int64_t hist_H_chk_84277 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, sext_i32_i64(hist_S_84270));
                        
                        {
                            err = gpu_kernel_do_DBSCAN_doubleziseghist_global_75451(ctx, num_tblocks_75446, 1, 1, *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443, 1, 1, (int64_t) 0, inf_66341, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, m_66453, num_tblocks_75446, num_subhistos_84206, chk_i_84276, hist_H_chk_84277, mem_82209.mem, defunc_0_map_res_subhistos_mem_84207.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    }
                }
                if (num_subhistos_84206 == (int64_t) 1) {
                    if (memblock_set_device(ctx, &mem_82212, &defunc_0_map_res_subhistos_mem_84207, "defunc_0_map_res_subhistos_mem_84207") != 0)
                        return 1;
                } else {
                    int64_t chunk_sizze_84293 = (int64_t) 1;
                    
                    if (slt64(num_subhistos_84206 * (int64_t) 2, seghist_tblock_sizze_75444 * chunk_sizze_84293)) {
                        int64_t segment_sizze_nonzzero_84294 = smax64((int64_t) 1, num_subhistos_84206);
                        int64_t num_threads_84295 = seghist_tblock_sizze_75444 * seghist_tblock_sizze_75444;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "# SegRed-small");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_84206, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294), '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, squot64(seghist_tblock_sizze_75444, segment_sizze_nonzzero_84294))), '\n');
                        {
                            err = gpu_kernel_do_DBSCAN_doublezisegred_small_84292(ctx, num_tblocks_75446, 1, 1, *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443, 1, 1, (int64_t) 8 * seghist_tblock_sizze_75444 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_75444, (int64_t) 8), (int64_t) 8), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, num_tblocks_75446, num_subhistos_84206, segment_sizze_nonzzero_84294, mem_82212.mem, defunc_0_map_res_subhistos_mem_84207.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    } else {
                        int64_t blocks_per_segment_84323 = sdiv_up64(num_tblocks_75446, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344));
                        int64_t q_84324 = sdiv_up64(num_subhistos_84206, seghist_tblock_sizze_75444 * blocks_per_segment_84323 * chunk_sizze_84293);
                        int64_t num_virtblocks_84325 = blocks_per_segment_84323 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344;
                        int64_t threads_per_segment_84326 = blocks_per_segment_84323 * seghist_tblock_sizze_75444;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "# SegRed-large");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_84206, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_84325, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_75446, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) seghist_tblock_sizze_75444, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_84324, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_84323, '\n');
                        if (memblock_alloc_device(ctx, &segred_tmp_mem_84327, (int64_t) 8 * num_virtblocks_84325, "segred_tmp_mem_84327")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_do_DBSCAN_doublezisegred_large_84292(ctx, num_tblocks_75446, 1, 1, *ctx->tuning_params.do_DBSCAN_doubleziseghist_tblock_sizze_75443, 1, 1, 8 + ((int64_t) 8 * seghist_tblock_sizze_75444 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_75444, (int64_t) 8), (int64_t) 8)), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344, num_tblocks_75446, num_subhistos_84206, blocks_per_segment_84323, q_84324, num_virtblocks_84325, threads_per_segment_84326, mem_82212.mem, defunc_0_map_res_subhistos_mem_84207.mem, segred_tmp_mem_84327.mem, counters_mem_84329.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    }
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82209, "mem_82209") != 0)
                return 1;
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82169.mem, inf_66341, (int64_t []) {(int64_t) 1}, mem_82212.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_66344})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &mem_82212, "mem_82212") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82215, bytes_82214, "mem_82215")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_84366 = (int64_t) 0;
            
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82215.mem, tmp_offs_84366, (int64_t []) {(int64_t) 1}, mem_param_82178.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2089U_66338})) != 0)
                goto cleanup;
            tmp_offs_84366 += loop_dz2089U_66338;
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82215.mem, tmp_offs_84366, (int64_t []) {(int64_t) 1}, mem_82207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_66453})) != 0)
                goto cleanup;
            tmp_offs_84366 += m_66453;
            if (memblock_unref_device(ctx, &mem_82207, "mem_82207") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_tmp_84024, &mem_82215, "mem_82215") != 0)
                return 1;
            
            int64_t loop_dz2089U_tmp_84025 = conc_tmp_66497;
            
            if (memblock_set_device(ctx, &mem_param_82178, &mem_param_tmp_84024, "mem_param_tmp_84024") != 0)
                return 1;
            loop_dz2089U_66338 = loop_dz2089U_tmp_84025;
        }
        if (memblock_set_device(ctx, &ext_mem_82220, &mem_param_82178, "mem_param_82178") != 0)
            return 1;
        mk_adjacency_list_res_66334 = loop_dz2089U_66338;
        if (memblock_unref_device(ctx, &mem_82170, "mem_82170") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82172, "mem_82172") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_82224, bytes_82083, "mem_82224")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, conc_tmp_62382)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_84367;
            
            shared_memory_84367 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_84368;
            
            thread_block_sizze_84368 = ctx->max_thread_block_size;
            
            int64_t registers_84369;
            
            registers_84369 = ctx->max_registers;
            
            int64_t thread_block_sizze_84370;
            
            thread_block_sizze_84370 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_84371 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84367, thread_block_sizze_84368), (int64_t) 8), squot64(squot64(registers_84369, thread_block_sizze_84370) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_84372 = sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75460 * chunk_sizze_84371);
            int64_t num_virt_threads_84373 = num_virt_blocks_84372 * segscan_tblock_sizze_75460;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84371, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_84374, num_virt_blocks_84372, "status_flags_mem_84374")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84374, num_virt_blocks_84372, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_84376, (int64_t) 8 * num_virt_blocks_84372, "aggregates_mem_84376")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_84378, (int64_t) 8 * num_virt_blocks_84372, "incprefixes_mem_84378")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_do_DBSCAN_doublezisegscan_75465(ctx, num_tblocks_75462, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75459, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75460), chunk_sizze_84371 * segscan_tblock_sizze_75460 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75460), chunk_sizze_84371 * segscan_tblock_sizze_75460 * (int64_t) 8), (int64_t) 8), (int64_t) 8), conc_tmp_62382, num_tblocks_75462, num_virt_blocks_84372, num_virt_threads_84373, mem_82169.mem, mem_82224.mem, status_flags_mem_84374.mem, aggregates_mem_84376.mem, incprefixes_mem_84378.mem, global_dynid_mem_84380.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &mem_82169, "mem_82169") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_82225, mk_adjacency_list_res_66334, "mem_82225")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_bool(ctx, mem_82225, mk_adjacency_list_res_66334, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_84489 = sext_i64_i32(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75470));
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_75467(ctx, num_tblocks_75472, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75469, 1, 1, (int64_t) 0, conc_tmp_62382, mk_adjacency_list_res_66334, num_tblocks_75472, virt_num_tblocks_84489, mem_82224.mem, mem_82225.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_82224, "mem_82224") != 0)
            return 1;
        
        int64_t num_tblocks_75478;
        int64_t max_num_tblocks_84502;
        
        max_num_tblocks_84502 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75477;
        num_tblocks_75478 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segred_tblock_sizze_75476), max_num_tblocks_84502)));
        if (memblock_alloc_device(ctx, &mem_82228, (int64_t) 1, "mem_82228")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegRed");
        
        int64_t chunk_sizze_84503 = (int64_t) 1;
        
        if (memblock_alloc_device(ctx, &segred_tmp_mem_84506, num_tblocks_75478, "segred_tmp_mem_84506")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_84508 = num_tblocks_75478 * segred_tblock_sizze_75476;
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75483(ctx, num_tblocks_75478, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75475, 1, 1, 8 + (segred_tblock_sizze_75476 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75476, (int64_t) 8), (int64_t) 8)), mk_adjacency_list_res_66334, num_tblocks_75478, num_threads_84508, ext_mem_82220.mem, mem_82228.mem, counters_mem_84504.mem, segred_tmp_mem_84506.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        bool read_res_86927;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86927, mem_82228.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        bool defunc_0_reduce_res_66516 = read_res_86927;
        
        if (memblock_unref_device(ctx, &mem_82228, "mem_82228") != 0)
            return 1;
        
        bool cond_66526 = slt64((int64_t) 0, mk_adjacency_list_res_66334);
        int64_t num_tblocks_75496;
        int64_t max_num_tblocks_84537;
        
        max_num_tblocks_84537 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75495;
        num_tblocks_75496 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75494), max_num_tblocks_84537)));
        
        int64_t bytes_82230 = (int64_t) 8 * mk_adjacency_list_res_66334;
        
        if (memblock_alloc_device(ctx, &mem_82231, bytes_82230, "mem_82231")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82232, mk_adjacency_list_res_66334, "mem_82232")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, mk_adjacency_list_res_66334)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_84538;
            
            shared_memory_84538 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_84539;
            
            thread_block_sizze_84539 = ctx->max_thread_block_size;
            
            int64_t registers_84540;
            
            registers_84540 = ctx->max_registers;
            
            int64_t thread_block_sizze_84541;
            
            thread_block_sizze_84541 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_84542 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84538, thread_block_sizze_84539), (int64_t) 8), squot64(squot64(registers_84540, thread_block_sizze_84541) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_84543 = sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75494 * chunk_sizze_84542);
            int64_t num_virt_threads_84544 = num_virt_blocks_84543 * segscan_tblock_sizze_75494;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84542, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_84545, num_virt_blocks_84543, "status_flags_mem_84545")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84545, num_virt_blocks_84543, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_84547, (int64_t) 8 * num_virt_blocks_84543, "aggregates_mem_84547")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_84549, (int64_t) 8 * num_virt_blocks_84543, "incprefixes_mem_84549")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_do_DBSCAN_doublezisegscan_75499(ctx, num_tblocks_75496, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75493, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75494), chunk_sizze_84542 * segscan_tblock_sizze_75494 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75494), chunk_sizze_84542 * segscan_tblock_sizze_75494 * (int64_t) 8), (int64_t) 8), (int64_t) 8), mk_adjacency_list_res_66334, num_tblocks_75496, num_virt_blocks_84543, num_virt_threads_84544, mem_82225.mem, mem_82231.mem, mem_82232.mem, status_flags_mem_84545.mem, aggregates_mem_84547.mem, incprefixes_mem_84549.mem, global_dynid_mem_84551.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        
        bool protect_cond_conj_77866 = defunc_0_reduce_res_66516 && cond_66526;
        int64_t num_segments_t_res_66565;
        
        if (protect_cond_conj_77866) {
            int64_t tmp_66566 = sub64(mk_adjacency_list_res_66334, (int64_t) 1);
            bool x_66567 = sle64((int64_t) 0, tmp_66566);
            bool y_66568 = slt64(tmp_66566, mk_adjacency_list_res_66334);
            bool bounds_check_66569 = x_66567 && y_66568;
            bool index_certs_66570;
            
            if (!bounds_check_66569) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_66566, "] out of bounds for array of shape [", (long long) mk_adjacency_list_res_66334, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  ft_libs/lib/github.com/diku-dk/segmented/segmented.fut:29:36-60\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t read_res_86928;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86928, mem_82231.mem, tmp_66566 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t last_res_66571 = read_res_86928;
            
            num_segments_t_res_66565 = last_res_66571;
        } else {
            num_segments_t_res_66565 = (int64_t) 0;
        }
        
        int64_t num_segments_66572;
        
        if (cond_66526) {
            num_segments_66572 = num_segments_t_res_66565;
        } else {
            num_segments_66572 = (int64_t) 0;
        }
        
        int64_t bytes_82240 = (int64_t) 8 * num_segments_66572;
        int64_t num_tblocks_75531;
        int64_t max_num_tblocks_84640;
        
        max_num_tblocks_84640 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75530;
        num_tblocks_75531 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75529), max_num_tblocks_84640)));
        if (memblock_alloc_device(ctx, &mem_82256, bytes_82230, "mem_82256")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82257, mk_adjacency_list_res_66334, "mem_82257")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, mk_adjacency_list_res_66334)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_84641;
            
            shared_memory_84641 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_84642;
            
            thread_block_sizze_84642 = ctx->max_thread_block_size;
            
            int64_t registers_84643;
            
            registers_84643 = ctx->max_registers;
            
            int64_t thread_block_sizze_84644;
            
            thread_block_sizze_84644 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_84645 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84641, thread_block_sizze_84642), (int64_t) 8), squot64(squot64(registers_84643, thread_block_sizze_84644) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_84646 = sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75529 * chunk_sizze_84645);
            int64_t num_virt_threads_84647 = num_virt_blocks_84646 * segscan_tblock_sizze_75529;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84645, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_84648, num_virt_blocks_84646, "status_flags_mem_84648")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84648, num_virt_blocks_84646, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_84650, (int64_t) 8 * num_virt_blocks_84646, "aggregates_mem_84650")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_84652, (int64_t) 8 * num_virt_blocks_84646, "incprefixes_mem_84652")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_do_DBSCAN_doublezisegscan_75534(ctx, num_tblocks_75531, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75528, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75529), chunk_sizze_84645 * segscan_tblock_sizze_75529 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75529), chunk_sizze_84645 * segscan_tblock_sizze_75529 * (int64_t) 8), (int64_t) 8), (int64_t) 8), mk_adjacency_list_res_66334, num_tblocks_75531, num_virt_blocks_84646, num_virt_threads_84647, mem_82225.mem, mem_82256.mem, mem_82257.mem, status_flags_mem_84648.mem, aggregates_mem_84650.mem, incprefixes_mem_84652.mem, global_dynid_mem_84654.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        
        int64_t num_segments_t_res_66632;
        
        if (cond_66526) {
            int64_t tmp_66633 = sub64(mk_adjacency_list_res_66334, (int64_t) 1);
            bool x_66634 = sle64((int64_t) 0, tmp_66633);
            bool y_66635 = slt64(tmp_66633, mk_adjacency_list_res_66334);
            bool bounds_check_66636 = x_66634 && y_66635;
            bool index_certs_66637;
            
            if (!bounds_check_66636) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_66633, "] out of bounds for array of shape [", (long long) mk_adjacency_list_res_66334, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  ft_libs/lib/github.com/diku-dk/segmented/segmented.fut:29:36-60\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t read_res_86929;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86929, mem_82256.mem, tmp_66633 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t last_res_66638 = read_res_86929;
            
            num_segments_t_res_66632 = last_res_66638;
        } else {
            num_segments_t_res_66632 = (int64_t) 0;
        }
        
        int64_t num_segments_66639;
        
        if (cond_66526) {
            num_segments_66639 = num_segments_t_res_66632;
        } else {
            num_segments_66639 = (int64_t) 0;
        }
        
        int64_t bytes_82258 = (int64_t) 8 * num_segments_66639;
        bool eq_x_y_66649 = conc_tmp_62382 == num_segments_t_res_66632;
        bool p_and_eq_x_y_66650 = cond_66526 && eq_x_y_66649;
        bool not_p_66651 = !cond_66526;
        bool p_and_eq_x_y_66652 = eq_x_zz_62688 && not_p_66651;
        bool dim_match_66653 = p_and_eq_x_y_66650 || p_and_eq_x_y_66652;
        bool empty_or_match_cert_66654;
        
        if (!dim_match_66653) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) num_segments_66639, "] cannot match shape of type `[", (long long) conc_tmp_62382, "]i64`.", "-> #0  ft_libs/ftDBSCAN_plus.fut:616:28-51\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_tblocks_75488;
        int64_t max_num_tblocks_84743;
        
        max_num_tblocks_84743 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75487;
        num_tblocks_75488 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75486), max_num_tblocks_84743)));
        
        int64_t num_tblocks_75506;
        int64_t max_num_tblocks_84744;
        
        max_num_tblocks_84744 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75505;
        num_tblocks_75506 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segmap_tblock_sizze_75504), max_num_tblocks_84744)));
        
        int64_t num_tblocks_75512;
        int64_t max_num_tblocks_84745;
        
        max_num_tblocks_84745 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75511;
        num_tblocks_75512 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segred_tblock_sizze_75510), max_num_tblocks_84745)));
        if (memblock_alloc_device(ctx, &mem_82237, mk_adjacency_list_res_66334, "mem_82237")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82239, bytes_82230, "mem_82239")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82241, bytes_82240, "mem_82241")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82244, (int64_t) 1, "mem_82244")) {
            err = 1;
            goto cleanup;
        }
        
        bool itered_neighlist_66527;
        bool loop_while_66529;
        
        if (memblock_set_device(ctx, &mem_param_82235, &ext_mem_82220, "ext_mem_82220") != 0)
            return 1;
        loop_while_66529 = defunc_0_reduce_res_66516;
        while (loop_while_66529) {
            if (slt64((int64_t) 0, mk_adjacency_list_res_66334)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_84749;
                
                shared_memory_84749 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_84750;
                
                thread_block_sizze_84750 = ctx->max_thread_block_size;
                
                int64_t registers_84751;
                
                registers_84751 = ctx->max_registers;
                
                int64_t thread_block_sizze_84752;
                
                thread_block_sizze_84752 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_84753 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84749, thread_block_sizze_84750), (int64_t) 8), squot64(squot64(registers_84751, thread_block_sizze_84752) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
                int64_t num_virt_blocks_84754 = sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75486 * chunk_sizze_84753);
                int64_t num_virt_threads_84755 = num_virt_blocks_84754 * segscan_tblock_sizze_75486;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84753, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_84756, num_virt_blocks_84754, "status_flags_mem_84756")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84756, num_virt_blocks_84754, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_84758, num_virt_blocks_84754, "aggregates_mem_84758")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_84760, num_virt_blocks_84754, "incprefixes_mem_84760")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_84762, (int64_t) 8 * num_virt_blocks_84754, "aggregates_mem_84762")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_84764, (int64_t) 8 * num_virt_blocks_84754, "incprefixes_mem_84764")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegscan_75491(ctx, num_tblocks_75488, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75485, 1, 1, smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75486, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75486), smax64(chunk_sizze_84753 * segscan_tblock_sizze_75486, chunk_sizze_84753 * segscan_tblock_sizze_75486 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75486, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75486), smax64(chunk_sizze_84753 * segscan_tblock_sizze_75486, chunk_sizze_84753 * segscan_tblock_sizze_75486 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), mk_adjacency_list_res_66334, num_tblocks_75488, num_virt_blocks_84754, num_virt_threads_84755, mem_82225.mem, mem_param_82235.mem, mem_82237.mem, mem_82239.mem, status_flags_mem_84756.mem, aggregates_mem_84758.mem, incprefixes_mem_84760.mem, aggregates_mem_84762.mem, incprefixes_mem_84764.mem, global_dynid_mem_84766.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_82241, num_segments_66572, (int64_t) 9223372036854775807) != 0) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_84915 = sext_i64_i32(sdiv_up64(mk_adjacency_list_res_66334, segmap_tblock_sizze_75504));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_75501(ctx, num_tblocks_75506, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75503, 1, 1, (int64_t) 0, mk_adjacency_list_res_66334, num_segments_66572, num_tblocks_75506, virt_num_tblocks_84915, mem_82231.mem, mem_82232.mem, mem_82239.mem, mem_82241.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_82246, bytes_82230, "mem_82246")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_84928 = (int64_t) 1;
            
            if (memblock_alloc_device(ctx, &segred_tmp_mem_84931, num_tblocks_75512, "segred_tmp_mem_84931")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_84933 = num_tblocks_75512 * segred_tblock_sizze_75510;
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75518(ctx, num_tblocks_75512, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75509, 1, 1, 8 + (segred_tblock_sizze_75510 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75510, (int64_t) 8), (int64_t) 8)), mk_adjacency_list_res_66334, num_segments_66572, num_tblocks_75512, num_threads_84933, mem_param_82235.mem, mem_82241.mem, mem_82244.mem, mem_82246.mem, counters_mem_84929.mem, segred_tmp_mem_84931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            bool read_res_86930;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86930, mem_82244.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_reduce_res_66583 = read_res_86930;
            
            if (memblock_set_device(ctx, &mem_param_tmp_84746, &mem_82246, "mem_82246") != 0)
                return 1;
            
            bool loop_while_tmp_84747 = defunc_0_reduce_res_66583;
            
            if (memblock_set_device(ctx, &mem_param_82235, &mem_param_tmp_84746, "mem_param_tmp_84746") != 0)
                return 1;
            loop_while_66529 = loop_while_tmp_84747;
        }
        if (memblock_set_device(ctx, &ext_mem_82249, &mem_param_82235, "mem_param_82235") != 0)
            return 1;
        itered_neighlist_66527 = loop_while_66529;
        if (memblock_unref_device(ctx, &ext_mem_82220, "ext_mem_82220") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82231, "mem_82231") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82232, "mem_82232") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82237, "mem_82237") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82239, "mem_82239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82241, "mem_82241") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82244, "mem_82244") != 0)
            return 1;
        
        int64_t num_tblocks_75523;
        int64_t max_num_tblocks_84962;
        
        max_num_tblocks_84962 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75522;
        num_tblocks_75523 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75521), max_num_tblocks_84962)));
        if (memblock_alloc_device(ctx, &mem_82251, mk_adjacency_list_res_66334, "mem_82251")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82253, bytes_82230, "mem_82253")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, mk_adjacency_list_res_66334)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_84963;
            
            shared_memory_84963 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_84964;
            
            thread_block_sizze_84964 = ctx->max_thread_block_size;
            
            int64_t registers_84965;
            
            registers_84965 = ctx->max_registers;
            
            int64_t thread_block_sizze_84966;
            
            thread_block_sizze_84966 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_84967 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_84963, thread_block_sizze_84964), (int64_t) 8), squot64(squot64(registers_84965, thread_block_sizze_84966) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 1) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_84968 = sdiv_up64(mk_adjacency_list_res_66334, segscan_tblock_sizze_75521 * chunk_sizze_84967);
            int64_t num_virt_threads_84969 = num_virt_blocks_84968 * segscan_tblock_sizze_75521;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_84967, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_84970, num_virt_blocks_84968, "status_flags_mem_84970")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_84970, num_virt_blocks_84968, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_84972, num_virt_blocks_84968, "aggregates_mem_84972")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_84974, num_virt_blocks_84968, "incprefixes_mem_84974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_84976, (int64_t) 8 * num_virt_blocks_84968, "aggregates_mem_84976")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_84978, (int64_t) 8 * num_virt_blocks_84968, "incprefixes_mem_84978")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_do_DBSCAN_doublezisegscan_75526(ctx, num_tblocks_75523, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75520, 1, 1, smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75521, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75521), smax64(chunk_sizze_84967 * segscan_tblock_sizze_75521, chunk_sizze_84967 * segscan_tblock_sizze_75521 * (int64_t) 8)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 320, sdiv_up64(segscan_tblock_sizze_75521, (int64_t) 8) * (int64_t) 8 + (int64_t) 8 * segscan_tblock_sizze_75521), smax64(chunk_sizze_84967 * segscan_tblock_sizze_75521, chunk_sizze_84967 * segscan_tblock_sizze_75521 * (int64_t) 8)), (int64_t) 8), (int64_t) 8), mk_adjacency_list_res_66334, num_tblocks_75523, num_virt_blocks_84968, num_virt_threads_84969, mem_82225.mem, ext_mem_82249.mem, mem_82251.mem, mem_82253.mem, status_flags_mem_84970.mem, aggregates_mem_84972.mem, incprefixes_mem_84974.mem, aggregates_mem_84976.mem, incprefixes_mem_84978.mem, global_dynid_mem_84980.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &mem_82225, "mem_82225") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82249, "ext_mem_82249") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82251, "mem_82251") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_82259, bytes_82258, "mem_82259")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_82259, num_segments_66639, (int64_t) 9223372036854775807) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_tblocks_75541;
        int64_t max_num_tblocks_85129;
        
        max_num_tblocks_85129 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75540;
        num_tblocks_75541 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(mk_adjacency_list_res_66334, segmap_tblock_sizze_75539), max_num_tblocks_85129)));
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_85130 = sext_i64_i32(sdiv_up64(mk_adjacency_list_res_66334, segmap_tblock_sizze_75539));
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_75536(ctx, num_tblocks_75541, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75538, 1, 1, (int64_t) 0, mk_adjacency_list_res_66334, num_segments_66639, num_tblocks_75541, virt_num_tblocks_85130, mem_82253.mem, mem_82256.mem, mem_82257.mem, mem_82259.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_82253, "mem_82253") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82256, "mem_82256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82257, "mem_82257") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82263, &mem_82259, "mem_82259") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82086, bytes_82083, "mem_82086")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhiota_i64(ctx, mem_82086, conc_tmp_62382, (int64_t) 0, (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82164, (int64_t) 1, "mem_82164")) {
            err = 1;
            goto cleanup;
        }
        
        bool cluster_heads_62699;
        bool loop_while_62701;
        
        if (memblock_set_device(ctx, &mem_param_82089, &mem_82086, "mem_82086") != 0)
            return 1;
        loop_while_62701 = 1;
        while (loop_while_62701) {
            if (memblock_set_device(ctx, &mem_param_82092, &mem_param_82089, "mem_param_82089") != 0)
                return 1;
            for (int64_t i_62704 = 0; i_62704 < num_iter_62399; i_62704++) {
                int64_t inf_62706 = mul64(max_res_62393, i_62704);
                int64_t min_arg1_62707 = add64(max_res_62393, inf_62706);
                int64_t min_res_62708 = smin64(conc_tmp_62382, min_arg1_62707);
                int64_t j_m_i_62709 = sub64(min_res_62708, inf_62706);
                bool empty_slice_62710 = j_m_i_62709 == (int64_t) 0;
                int64_t m_62711 = sub64(j_m_i_62709, (int64_t) 1);
                int64_t i_p_m_t_s_62712 = add64(inf_62706, m_62711);
                bool zzero_leq_i_p_m_t_s_62713 = sle64((int64_t) 0, i_p_m_t_s_62712);
                bool i_p_m_t_s_leq_w_62714 = slt64(i_p_m_t_s_62712, conc_tmp_62382);
                bool zzero_lte_i_62715 = sle64((int64_t) 0, inf_62706);
                bool i_lte_j_62716 = sle64(inf_62706, min_res_62708);
                bool y_62717 = i_p_m_t_s_leq_w_62714 && zzero_lte_i_62715;
                bool y_62718 = zzero_leq_i_p_m_t_s_62713 && y_62717;
                bool forwards_ok_62719 = i_lte_j_62716 && y_62718;
                bool ok_or_empty_62720 = empty_slice_62710 || forwards_ok_62719;
                bool index_certs_62721;
                
                if (!ok_or_empty_62720) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_62706, ":", (long long) min_res_62708, "] out of bounds for array of shape [", (long long) conc_tmp_62382, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:534:56-73\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool suff_outer_par_75544;
                
                suff_outer_par_75544 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_0 <= j_m_i_62709;
                if (ctx->logging)
                    fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_0", (long) j_m_i_62709, suff_outer_par_75544 ? "true" : "false");
                
                int64_t nest_sizze_75761 = conc_tmp_62382 * j_m_i_62709;
                int64_t num_tblocks_75763;
                int64_t max_num_tblocks_85148;
                
                max_num_tblocks_85148 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_75671;
                num_tblocks_75763 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_75761, segred_tblock_sizze_75762), max_num_tblocks_85148)));
                
                int64_t bytes_82094 = (int64_t) 8 * j_m_i_62709;
                int64_t shared_memory_capacity_85247;
                
                shared_memory_capacity_85247 = ctx->max_shared_memory;
                if (suff_outer_par_75544 && sle64(sdiv_up64(bytes_82133, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82133, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82133, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_85247)) {
                    int64_t ldim_78073 = sdiv_up64(j_m_i_62709, tile_sizze_78072);
                    
                    if (memblock_alloc_device(ctx, &mem_82156, bytes_82094, "mem_82156")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t num_chunks_85149 = sext_i64_i32(sdiv_up64(tile_sizze_78072, tile_sizze_78072));
                    int32_t virt_num_tblocks_85150 = sext_i64_i32(ldim_78073);
                    
                    {
                        err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78070(ctx, ldim_78073, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78071, 1, 1, bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8) + (bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8)) + (bytes_82133 + srem64((int64_t) 8 - srem64(bytes_82133, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_62247, m_62289, conc_tmp_62375, conc_tmp_62382, inf_62706, j_m_i_62709, ldim_78073, num_whole_tiles_78140, residual_input_78371, cond_78372, binop_x_78388, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_param_82092.mem, mem_82156.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_set_device(ctx, &ext_mem_82157, &mem_82156, "mem_82156") != 0)
                        return 1;
                } else {
                    int64_t segmap_usable_groups_75745 = sdiv_up64(j_m_i_62709, segmap_tblock_sizze_75744);
                    
                    if (memblock_alloc_device(ctx, &mem_82095, bytes_82094, "mem_82095")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_82097, bytes_82094, "mem_82097")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_82099, bytes_82094, "mem_82099")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_85166 = sext_i64_i32(sdiv_up64(j_m_i_62709, segmap_tblock_sizze_75744));
                    
                    {
                        err = gpu_kernel_do_DBSCAN_doublezisegmap_75750(ctx, segmap_usable_groups_75745, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75729, 1, 1, (int64_t) 0, clBase_48690, m_62289, conc_tmp_62375, inf_62706, j_m_i_62709, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_82095.mem, mem_82097.mem, mem_82099.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_alloc_device(ctx, &mem_82102, bytes_82094, "mem_82102")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegRed");
                    
                    int64_t chunk_sizze_85175 = (int64_t) 1;
                    
                    if (slt64(conc_tmp_62382 * (int64_t) 2, segred_tblock_sizze_75762 * chunk_sizze_85175)) {
                        int64_t segment_sizze_nonzzero_85176 = smax64((int64_t) 1, conc_tmp_62382);
                        int64_t num_threads_85177 = segred_tblock_sizze_75762 * segred_tblock_sizze_75762;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "# SegRed-small");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) j_m_i_62709, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) conc_tmp_62382, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176), '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(j_m_i_62709, squot64(segred_tblock_sizze_75762, segment_sizze_nonzzero_85176))), '\n');
                        {
                            err = gpu_kernel_do_DBSCAN_doublezisegred_small_75768(ctx, num_tblocks_75763, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669, 1, 1, (int64_t) 8 * segred_tblock_sizze_75762 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_75762, (int64_t) 8), (int64_t) 8), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_62289, conc_tmp_62375, conc_tmp_62382, inf_62706, j_m_i_62709, num_tblocks_75763, x_81841, segment_sizze_nonzzero_85176, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_param_82092.mem, mem_82095.mem, mem_82097.mem, mem_82099.mem, mem_82102.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    } else {
                        int64_t blocks_per_segment_85204 = sdiv_up64(num_tblocks_75763, smax64((int64_t) 1, j_m_i_62709));
                        int64_t q_85205 = sdiv_up64(conc_tmp_62382, segred_tblock_sizze_75762 * blocks_per_segment_85204 * chunk_sizze_85175);
                        int64_t num_virtblocks_85206 = blocks_per_segment_85204 * j_m_i_62709;
                        int64_t threads_per_segment_85207 = blocks_per_segment_85204 * segred_tblock_sizze_75762;
                        
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "# SegRed-large");
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) j_m_i_62709, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) conc_tmp_62382, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_85206, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_75763, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_75762, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_85205, '\n');
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_85204, '\n');
                        if (memblock_alloc_device(ctx, &segred_tmp_mem_85208, (int64_t) 8 * num_virtblocks_85206, "segred_tmp_mem_85208")) {
                            err = 1;
                            goto cleanup;
                        }
                        {
                            err = gpu_kernel_do_DBSCAN_doublezisegred_large_75768(ctx, num_tblocks_75763, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75669, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_75762 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_75762, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_62289, conc_tmp_62375, conc_tmp_62382, inf_62706, j_m_i_62709, num_tblocks_75763, x_81841, blocks_per_segment_85204, q_85205, num_virtblocks_85206, threads_per_segment_85207, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, mem_param_82092.mem, mem_82095.mem, mem_82097.mem, mem_82099.mem, mem_82102.mem, segred_tmp_mem_85208.mem, counters_mem_85210.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_unref_device(ctx, &mem_82095, "mem_82095") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_82097, "mem_82097") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_82099, "mem_82099") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &ext_mem_82157, &mem_82102, "mem_82102") != 0)
                        return 1;
                }
                if (memblock_alloc_device(ctx, &mem_82159, bytes_82083, "mem_82159")) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82159.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_82092.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {conc_tmp_62382})) != 0)
                    goto cleanup;
                if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82159.mem, inf_62706, (int64_t []) {(int64_t) 1}, ext_mem_82157.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62709})) != 0)
                    goto cleanup;
                if (memblock_unref_device(ctx, &ext_mem_82157, "ext_mem_82157") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_tmp_85146, &mem_82159, "mem_82159") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_82092, &mem_param_tmp_85146, "mem_param_tmp_85146") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &ext_mem_82162, &mem_param_82092, "mem_param_82092") != 0)
                return 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_85248 = (int64_t) 1;
            
            if (memblock_alloc_device(ctx, &segred_tmp_mem_85251, num_tblocks_75821, "segred_tmp_mem_85251")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_85253 = num_tblocks_75821 * segred_tblock_sizze_75819;
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegred_nonseg_75826(ctx, num_tblocks_75821, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_75818, 1, 1, 8 + (segred_tblock_sizze_75819 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_75819, (int64_t) 8), (int64_t) 8)), conc_tmp_62382, num_tblocks_75821, num_threads_85253, mem_param_82089.mem, ext_mem_82162.mem, mem_82164.mem, counters_mem_85249.mem, segred_tmp_mem_85251.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            bool read_res_86931;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86931, mem_82164.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool defunc_0_reduce_res_66676 = read_res_86931;
            bool loop_cond_62795 = !defunc_0_reduce_res_66676;
            
            if (memblock_set_device(ctx, &mem_param_tmp_85143, &ext_mem_82162, "ext_mem_82162") != 0)
                return 1;
            
            bool loop_while_tmp_85144 = loop_cond_62795;
            
            if (memblock_set_device(ctx, &mem_param_82089, &mem_param_tmp_85143, "mem_param_tmp_85143") != 0)
                return 1;
            loop_while_62701 = loop_while_tmp_85144;
        }
        if (memblock_set_device(ctx, &ext_mem_82167, &mem_param_82089, "mem_param_82089") != 0)
            return 1;
        cluster_heads_62699 = loop_while_62701;
        if (memblock_unref_device(ctx, &mem_82086, "mem_82086") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82164, "mem_82164") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82263, &ext_mem_82167, "ext_mem_82167") != 0)
            return 1;
    }
    
    int64_t num_tblocks_75831;
    int64_t max_num_tblocks_85282;
    
    max_num_tblocks_85282 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75830;
    num_tblocks_75831 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75829), max_num_tblocks_85282)));
    if (memblock_alloc_device(ctx, &mem_82266, bytes_82083, "mem_82266")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_62382)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_85283;
        
        shared_memory_85283 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_85284;
        
        thread_block_sizze_85284 = ctx->max_thread_block_size;
        
        int64_t registers_85285;
        
        registers_85285 = ctx->max_registers;
        
        int64_t thread_block_sizze_85286;
        
        thread_block_sizze_85286 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_85287 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_85283, thread_block_sizze_85284), (int64_t) 8), squot64(squot64(registers_85285, thread_block_sizze_85286) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_85288 = sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75829 * chunk_sizze_85287);
        int64_t num_virt_threads_85289 = num_virt_blocks_85288 * segscan_tblock_sizze_75829;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_85287, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_85290, num_virt_blocks_85288, "status_flags_mem_85290")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_85290, num_virt_blocks_85288, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_85292, (int64_t) 8 * num_virt_blocks_85288, "aggregates_mem_85292")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_85294, (int64_t) 8 * num_virt_blocks_85288, "incprefixes_mem_85294")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75834(ctx, num_tblocks_75831, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75828, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75829), chunk_sizze_85287 * segscan_tblock_sizze_75829 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75829), chunk_sizze_85287 * segscan_tblock_sizze_75829 * (int64_t) 8), (int64_t) 8), (int64_t) 8), conc_tmp_62382, num_tblocks_75831, num_virt_blocks_85288, num_virt_threads_85289, ext_mem_82263.mem, mem_82266.mem, status_flags_mem_85290.mem, aggregates_mem_85292.mem, incprefixes_mem_85294.mem, global_dynid_mem_85296.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segmap_usable_groups_75851 = sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75850);
    
    if (memblock_alloc_device(ctx, &mem_82269, bytes_82083, "mem_82269")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_85385 = sext_i64_i32(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75850));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75854(ctx, segmap_usable_groups_75851, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75838, 1, 1, (int64_t) 0, conc_tmp_62382, mem_82266.mem, mem_82269.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82266, "mem_82266") != 0)
        return 1;
    
    int64_t segmap_usable_groups_75884 = sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75883);
    
    if (memblock_alloc_device(ctx, &mem_82272, bytes_82083, "mem_82272")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_85394 = sext_i64_i32(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75883));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75887(ctx, segmap_usable_groups_75884, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75864, 1, 1, (int64_t) 0, clProc_48705, conc_tmp_62382, ext_mem_82263.mem, mem_82269.mem, mem_82272.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_82263, "ext_mem_82263") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82269, "mem_82269") != 0)
        return 1;
    
    int64_t num_tblocks_75905;
    int64_t max_num_tblocks_85403;
    
    max_num_tblocks_85403 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75904;
    num_tblocks_75905 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75903), max_num_tblocks_85403)));
    if (memblock_alloc_device(ctx, &mem_82275, bytes_82083, "mem_82275")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82277, bytes_82083, "mem_82277")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_62382)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_85404;
        
        shared_memory_85404 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_85405;
        
        thread_block_sizze_85405 = ctx->max_thread_block_size;
        
        int64_t registers_85406;
        
        registers_85406 = ctx->max_registers;
        
        int64_t thread_block_sizze_85407;
        
        thread_block_sizze_85407 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_85408 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_85404, thread_block_sizze_85405), (int64_t) 8), squot64(squot64(registers_85406, thread_block_sizze_85407) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_85409 = sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_75903 * chunk_sizze_85408);
        int64_t num_virt_threads_85410 = num_virt_blocks_85409 * segscan_tblock_sizze_75903;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_85408, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_85411, num_virt_blocks_85409, "status_flags_mem_85411")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_85411, num_virt_blocks_85409, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_85413, (int64_t) 8 * num_virt_blocks_85409, "aggregates_mem_85413")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_85415, (int64_t) 8 * num_virt_blocks_85409, "incprefixes_mem_85415")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_75908(ctx, num_tblocks_75905, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_75902, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75903), chunk_sizze_85408 * segscan_tblock_sizze_75903 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_75903), chunk_sizze_85408 * segscan_tblock_sizze_75903 * (int64_t) 8), (int64_t) 8), (int64_t) 8), m_62289, conc_tmp_62375, conc_tmp_62382, num_tblocks_75905, num_virt_blocks_85409, num_virt_threads_85410, mem_82044.mem, ext_mem_82064.mem, mem_82077.mem, mem_82275.mem, mem_82277.mem, status_flags_mem_85411.mem, aggregates_mem_85413.mem, incprefixes_mem_85415.mem, global_dynid_mem_85417.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool x_62834 = !eq_x_zz_62688;
    int64_t tmp_62835 = sub64(conc_tmp_62382, (int64_t) 1);
    bool x_62836 = sle64((int64_t) 0, tmp_62835);
    bool y_62837 = slt64(tmp_62835, conc_tmp_62382);
    bool bounds_check_62838 = x_62836 && y_62837;
    bool protect_assert_disj_62839 = eq_x_zz_62688 || bounds_check_62838;
    bool index_certs_62840;
    
    if (!protect_assert_disj_62839) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_62835, "] out of bounds for array of shape [", (long long) conc_tmp_62382, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_62841;
    
    if (x_62834) {
        int64_t read_res_86932;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86932, mem_82275.mem, tmp_62835 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66677 = read_res_86932;
        
        m_f_res_62841 = x_66677;
    } else {
        m_f_res_62841 = (int64_t) 0;
    }
    
    int64_t m_62843;
    
    if (eq_x_zz_62688) {
        m_62843 = (int64_t) 0;
    } else {
        m_62843 = m_f_res_62841;
    }
    
    int64_t m_62853 = sub64(m_62843, (int64_t) 1);
    bool i_p_m_t_s_leq_w_62855 = slt64(m_62853, conc_tmp_62382);
    bool zzero_leq_i_p_m_t_s_62854 = sle64((int64_t) 0, m_62853);
    bool y_62857 = zzero_leq_i_p_m_t_s_62854 && i_p_m_t_s_leq_w_62855;
    bool i_lte_j_62856 = sle64((int64_t) 0, m_62843);
    bool forwards_ok_62858 = i_lte_j_62856 && y_62857;
    bool eq_x_zz_62850 = (int64_t) 0 == m_f_res_62841;
    bool p_and_eq_x_y_62851 = x_62834 && eq_x_zz_62850;
    bool empty_slice_62852 = eq_x_zz_62688 || p_and_eq_x_y_62851;
    bool ok_or_empty_62859 = empty_slice_62852 || forwards_ok_62858;
    bool index_certs_62860;
    
    if (!ok_or_empty_62859) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_62843, "] out of bounds for array of shape [", (long long) conc_tmp_62382, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82278 = (int64_t) 8 * m_62843;
    
    if (memblock_alloc_device(ctx, &mem_82279, bytes_82278, "mem_82279")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82279.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82084.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62843})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82281, bytes_82278, "mem_82281")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82281.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82272.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62843})) != 0)
        goto cleanup;
    
    int64_t num_tblocks_75915;
    int64_t max_num_tblocks_85506;
    
    max_num_tblocks_85506 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_75914;
    num_tblocks_75915 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75913), max_num_tblocks_85506)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_85507 = sext_i64_i32(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_75913));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_75910(ctx, num_tblocks_75915, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_75912, 1, 1, (int64_t) 0, m_62289, conc_tmp_62375, conc_tmp_62382, m_62843, num_tblocks_75915, virt_num_tblocks_85507, mem_82044.mem, ext_mem_82064.mem, mem_82077.mem, mem_82272.mem, mem_82275.mem, mem_82277.mem, mem_82279.mem, mem_82281.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82275, "mem_82275") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82277, "mem_82277") != 0)
        return 1;
    
    bool suff_outer_screma_75947;
    
    suff_outer_screma_75947 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_1 <= m_62843;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_screma_1", (long) m_62843, suff_outer_screma_75947 ? "true" : "false");
    
    bool suff_outer_par_76217;
    
    suff_outer_par_76217 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_2 <= m_62843;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_2", (long) m_62843, suff_outer_par_76217 ? "true" : "false");
    
    int64_t num_tblocks_76311;
    int64_t max_num_tblocks_85520;
    
    max_num_tblocks_85520 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76211;
    num_tblocks_76311 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_62843, segscan_tblock_sizze_76310), max_num_tblocks_85520)));
    
    int64_t num_tblocks_75958;
    int64_t max_num_tblocks_85521;
    
    max_num_tblocks_85521 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_75951;
    num_tblocks_75958 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_62843, segscan_tblock_sizze_75957), max_num_tblocks_85521)));
    
    int64_t ldim_78848 = sdiv_up_safe64(m_62843, tile_sizze_78847);
    int64_t num_whole_tiles_78868 = squot_safe64(m_62843, tile_sizze_78847);
    int64_t residual_input_79082 = srem_safe64(m_62843, tile_sizze_78847);
    bool cond_79083 = residual_input_79082 == (int64_t) 0;
    int64_t ldim_78493 = sdiv_up_safe64(m_62843, tile_sizze_78492);
    int64_t num_whole_tiles_78513 = squot_safe64(m_62843, tile_sizze_78492);
    int64_t residual_input_78727 = srem_safe64(m_62843, tile_sizze_78492);
    bool cond_78728 = residual_input_78727 == (int64_t) 0;
    int64_t binop_x_79099 = tile_sizze_78847 * num_whole_tiles_78868;
    int64_t binop_x_78744 = tile_sizze_78492 * num_whole_tiles_78513;
    int64_t bytes_82307 = (int64_t) 8 * tile_sizze_78847;
    int64_t bytes_82369 = (int64_t) 8 * tile_sizze_78492;
    int64_t shared_memory_capacity_85677;
    
    shared_memory_capacity_85677 = ctx->max_shared_memory;
    if (suff_outer_par_76217 && sle64(sdiv_up64(bytes_82369, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82369, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82369, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_85677)) {
        if (memblock_alloc_device(ctx, &mem_82406, bytes_82278, "mem_82406")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_85627 = sext_i64_i32(sdiv_up64(tile_sizze_78492, tile_sizze_78492));
        int32_t virt_num_tblocks_85628 = sext_i64_i32(ldim_78493);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78490(ctx, ldim_78493, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78491, 1, 1, bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8) + (bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8)) + (bytes_82369 + srem64((int64_t) 8 - srem64(bytes_82369, (int64_t) 8), (int64_t) 8)), m_62843, ldim_78493, num_whole_tiles_78513, residual_input_78727, cond_78728, binop_x_78744, mem_82279.mem, mem_82281.mem, mem_82406.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82407, &mem_82406, "mem_82406") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82344, bytes_82278, "mem_82344")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_85652 = sext_i64_i32(sdiv_up64(tile_sizze_78847, tile_sizze_78847));
        int32_t virt_num_tblocks_85653 = sext_i64_i32(ldim_78848);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_78845(ctx, ldim_78848, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_78846, 1, 1, bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8) + (bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8)) + (bytes_82307 + srem64((int64_t) 8 - srem64(bytes_82307, (int64_t) 8), (int64_t) 8)), m_62843, ldim_78848, num_whole_tiles_78868, residual_input_79082, cond_79083, binop_x_79099, mem_82279.mem, mem_82281.mem, mem_82344.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82407, &mem_82344, "mem_82344") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_82409, bytes_82278, "mem_82409")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82409.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82407.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62843})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82412, bytes_82278, "mem_82412")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_62843)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_85678;
        
        shared_memory_85678 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_85679;
        
        thread_block_sizze_85679 = ctx->max_thread_block_size;
        
        int64_t registers_85680;
        
        registers_85680 = ctx->max_registers;
        
        int64_t thread_block_sizze_85681;
        
        thread_block_sizze_85681 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_85682 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_85678, thread_block_sizze_85679), (int64_t) 8), squot64(squot64(registers_85680, thread_block_sizze_85681) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_85683 = sdiv_up64(m_62843, segscan_tblock_sizze_76310 * chunk_sizze_85682);
        int64_t num_virt_threads_85684 = num_virt_blocks_85683 * segscan_tblock_sizze_76310;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_85682, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_85685, num_virt_blocks_85683, "status_flags_mem_85685")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_85685, num_virt_blocks_85683, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_85687, (int64_t) 8 * num_virt_blocks_85683, "aggregates_mem_85687")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_85689, (int64_t) 8 * num_virt_blocks_85683, "incprefixes_mem_85689")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_76315(ctx, num_tblocks_76311, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76209, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76310), chunk_sizze_85682 * segscan_tblock_sizze_76310 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76310), chunk_sizze_85682 * segscan_tblock_sizze_76310 * (int64_t) 8), (int64_t) 8), (int64_t) 8), m_62843, num_tblocks_76311, num_virt_blocks_85683, num_virt_threads_85684, ext_mem_82407.mem, mem_82412.mem, status_flags_mem_85685.mem, aggregates_mem_85687.mem, incprefixes_mem_85689.mem, global_dynid_mem_85691.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_82407, "ext_mem_82407") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82419, &mem_82412, "mem_82412") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82418, &mem_82409, "mem_82409") != 0)
        return 1;
    
    bool x_62928 = !empty_slice_62852;
    bool y_62929 = slt64(m_62853, m_62843);
    bool bounds_check_62930 = zzero_leq_i_p_m_t_s_62854 && y_62929;
    bool protect_assert_disj_62931 = empty_slice_62852 || bounds_check_62930;
    bool index_certs_62932;
    
    if (!protect_assert_disj_62931) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_62853, "] out of bounds for array of shape [", (long long) m_62843, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_62933;
    
    if (x_62928) {
        int64_t read_res_86933;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86933, ext_mem_82419.mem, m_62853 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66682 = read_res_86933;
        
        m_f_res_62933 = x_66682;
    } else {
        m_f_res_62933 = (int64_t) 0;
    }
    
    int64_t m_62935;
    
    if (empty_slice_62852) {
        m_62935 = (int64_t) 0;
    } else {
        m_62935 = m_f_res_62933;
    }
    
    int64_t m_62945 = sub64(m_62935, (int64_t) 1);
    bool i_p_m_t_s_leq_w_62947 = slt64(m_62945, m_62843);
    bool zzero_leq_i_p_m_t_s_62946 = sle64((int64_t) 0, m_62945);
    bool y_62949 = zzero_leq_i_p_m_t_s_62946 && i_p_m_t_s_leq_w_62947;
    bool i_lte_j_62948 = sle64((int64_t) 0, m_62935);
    bool forwards_ok_62950 = i_lte_j_62948 && y_62949;
    bool eq_x_zz_62942 = (int64_t) 0 == m_f_res_62933;
    bool p_and_eq_x_y_62943 = x_62928 && eq_x_zz_62942;
    bool empty_slice_62944 = empty_slice_62852 || p_and_eq_x_y_62943;
    bool ok_or_empty_62951 = empty_slice_62944 || forwards_ok_62950;
    bool index_certs_62952;
    
    if (!ok_or_empty_62951) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_62935, "] out of bounds for array of shape [", (long long) m_62843, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82420 = (int64_t) 8 * m_62935;
    
    if (memblock_alloc_device(ctx, &mem_82421, bytes_82420, "mem_82421")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82421.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82279.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62935})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82423, bytes_82420, "mem_82423")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82423.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82281.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_62935})) != 0)
        goto cleanup;
    
    int64_t num_tblocks_76328;
    int64_t max_num_tblocks_85780;
    
    max_num_tblocks_85780 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_76327;
    num_tblocks_76328 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_62843, segmap_tblock_sizze_76326), max_num_tblocks_85780)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_85781 = sext_i64_i32(sdiv_up64(m_62843, segmap_tblock_sizze_76326));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_76323(ctx, num_tblocks_76328, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76325, 1, 1, (int64_t) 0, m_62843, m_62935, num_tblocks_76328, virt_num_tblocks_85781, mem_82279.mem, mem_82281.mem, ext_mem_82418.mem, ext_mem_82419.mem, mem_82421.mem, mem_82423.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82279, "mem_82279") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82281, "mem_82281") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82418, "ext_mem_82418") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82419, "ext_mem_82419") != 0)
        return 1;
    
    bool suff_outer_screma_76331;
    
    suff_outer_screma_76331 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_3 <= conc_tmp_62382;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_screma_3", (long) conc_tmp_62382, suff_outer_screma_76331 ? "true" : "false");
    
    bool suff_outer_par_76548;
    
    suff_outer_par_76548 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_4 <= conc_tmp_62382;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_4", (long) conc_tmp_62382, suff_outer_par_76548 ? "true" : "false");
    
    int64_t num_tblocks_76624;
    int64_t max_num_tblocks_85794;
    
    max_num_tblocks_85794 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76542;
    num_tblocks_76624 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_76623), max_num_tblocks_85794)));
    
    int64_t num_tblocks_76342;
    int64_t max_num_tblocks_85795;
    
    max_num_tblocks_85795 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76335;
    num_tblocks_76342 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_76341), max_num_tblocks_85795)));
    
    int64_t ldim_79486 = sdiv_up_safe64(conc_tmp_62382, tile_sizze_79485);
    int64_t num_whole_tiles_79500 = squot_safe64(m_62935, tile_sizze_79485);
    int64_t residual_input_79659 = srem_safe64(m_62935, tile_sizze_79485);
    bool cond_79660 = residual_input_79659 == (int64_t) 0;
    int64_t ldim_79203 = sdiv_up_safe64(conc_tmp_62382, tile_sizze_79202);
    int64_t num_whole_tiles_79217 = squot_safe64(m_62935, tile_sizze_79202);
    int64_t residual_input_79376 = srem_safe64(m_62935, tile_sizze_79202);
    bool cond_79377 = residual_input_79376 == (int64_t) 0;
    int64_t binop_x_79673 = tile_sizze_79485 * num_whole_tiles_79500;
    int64_t binop_x_79390 = tile_sizze_79202 * num_whole_tiles_79217;
    int64_t bytes_82440 = (int64_t) 8 * tile_sizze_79485;
    int64_t bytes_82490 = (int64_t) 8 * tile_sizze_79202;
    int64_t shared_memory_capacity_85944;
    
    shared_memory_capacity_85944 = ctx->max_shared_memory;
    if (suff_outer_par_76548 && sle64(sdiv_up64(bytes_82490, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82490, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_85944)) {
        if (memblock_alloc_device(ctx, &mem_82522, bytes_82083, "mem_82522")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82524, bytes_82083, "mem_82524")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_85900 = sext_i64_i32(sdiv_up64(tile_sizze_79202, tile_sizze_79202));
        int32_t virt_num_tblocks_85901 = sext_i64_i32(ldim_79203);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79200(ctx, ldim_79203, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79201, 1, 1, bytes_82490 + srem64((int64_t) 8 - srem64(bytes_82490, (int64_t) 8), (int64_t) 8) + (bytes_82490 + srem64((int64_t) 8 - srem64(bytes_82490, (int64_t) 8), (int64_t) 8)), clProc_48705, m_62289, conc_tmp_62375, conc_tmp_62382, m_62935, ldim_79203, num_whole_tiles_79217, residual_input_79376, cond_79377, binop_x_79390, mem_82044.mem, ext_mem_82064.mem, mem_82077.mem, mem_82272.mem, mem_82421.mem, mem_82423.mem, mem_82522.mem, mem_82524.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82526, &mem_82522, "mem_82522") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82525, &mem_82524, "mem_82524") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82472, bytes_82083, "mem_82472")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_82474, bytes_82083, "mem_82474")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_85922 = sext_i64_i32(sdiv_up64(tile_sizze_79485, tile_sizze_79485));
        int32_t virt_num_tblocks_85923 = sext_i64_i32(ldim_79486);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79483(ctx, ldim_79486, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79484, 1, 1, bytes_82440 + srem64((int64_t) 8 - srem64(bytes_82440, (int64_t) 8), (int64_t) 8) + (bytes_82440 + srem64((int64_t) 8 - srem64(bytes_82440, (int64_t) 8), (int64_t) 8)), clProc_48705, m_62289, conc_tmp_62375, conc_tmp_62382, m_62935, ldim_79486, num_whole_tiles_79500, residual_input_79659, cond_79660, binop_x_79673, mem_82044.mem, ext_mem_82064.mem, mem_82077.mem, mem_82272.mem, mem_82421.mem, mem_82423.mem, mem_82472.mem, mem_82474.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82526, &mem_82472, "mem_82472") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82525, &mem_82474, "mem_82474") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_82528, bytes_82083, "mem_82528")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82528.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82526.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {conc_tmp_62382})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82531, bytes_82083, "mem_82531")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_62382)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_85945;
        
        shared_memory_85945 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_85946;
        
        thread_block_sizze_85946 = ctx->max_thread_block_size;
        
        int64_t registers_85947;
        
        registers_85947 = ctx->max_registers;
        
        int64_t thread_block_sizze_85948;
        
        thread_block_sizze_85948 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_85949 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_85945, thread_block_sizze_85946), (int64_t) 8), squot64(squot64(registers_85947, thread_block_sizze_85948) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_85950 = sdiv_up64(conc_tmp_62382, segscan_tblock_sizze_76623 * chunk_sizze_85949);
        int64_t num_virt_threads_85951 = num_virt_blocks_85950 * segscan_tblock_sizze_76623;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_85949, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_85952, num_virt_blocks_85950, "status_flags_mem_85952")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_85952, num_virt_blocks_85950, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_85954, (int64_t) 8 * num_virt_blocks_85950, "aggregates_mem_85954")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_85956, (int64_t) 8 * num_virt_blocks_85950, "incprefixes_mem_85956")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_76628(ctx, num_tblocks_76624, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76540, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76623), chunk_sizze_85949 * segscan_tblock_sizze_76623 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_76623), chunk_sizze_85949 * segscan_tblock_sizze_76623 * (int64_t) 8), (int64_t) 8), (int64_t) 8), conc_tmp_62382, num_tblocks_76624, num_virt_blocks_85950, num_virt_threads_85951, ext_mem_82526.mem, mem_82531.mem, status_flags_mem_85952.mem, aggregates_mem_85954.mem, incprefixes_mem_85956.mem, global_dynid_mem_85958.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_82526, "ext_mem_82526") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82541, &mem_82531, "mem_82531") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82540, &mem_82528, "mem_82528") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82539, &ext_mem_82525, "ext_mem_82525") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82272, "mem_82272") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82421, "mem_82421") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82423, "mem_82423") != 0)
        return 1;
    
    int64_t m_f_res_62998;
    
    if (x_62834) {
        int64_t read_res_86934;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86934, ext_mem_82541.mem, tmp_62835 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66686 = read_res_86934;
        
        m_f_res_62998 = x_66686;
    } else {
        m_f_res_62998 = (int64_t) 0;
    }
    
    int64_t m_63000;
    
    if (eq_x_zz_62688) {
        m_63000 = (int64_t) 0;
    } else {
        m_63000 = m_f_res_62998;
    }
    
    int64_t m_63010 = sub64(m_63000, (int64_t) 1);
    bool i_p_m_t_s_leq_w_63012 = slt64(m_63010, conc_tmp_62382);
    bool zzero_leq_i_p_m_t_s_63011 = sle64((int64_t) 0, m_63010);
    bool y_63014 = zzero_leq_i_p_m_t_s_63011 && i_p_m_t_s_leq_w_63012;
    bool i_lte_j_63013 = sle64((int64_t) 0, m_63000);
    bool forwards_ok_63015 = i_lte_j_63013 && y_63014;
    bool eq_x_zz_63007 = (int64_t) 0 == m_f_res_62998;
    bool p_and_eq_x_y_63008 = x_62834 && eq_x_zz_63007;
    bool empty_slice_63009 = eq_x_zz_62688 || p_and_eq_x_y_63008;
    bool ok_or_empty_63016 = empty_slice_63009 || forwards_ok_63015;
    bool index_certs_63017;
    
    if (!ok_or_empty_63016) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_63000, "] out of bounds for array of shape [", (long long) conc_tmp_62382, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82542 = (int64_t) 8 * m_63000;
    
    if (memblock_alloc_device(ctx, &mem_82543, bytes_82542, "mem_82543")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82543.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82539.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63000})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82545, bytes_82542, "mem_82545")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82545.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82084.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63000})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_82084, "mem_82084") != 0)
        return 1;
    
    int64_t num_tblocks_76642;
    int64_t max_num_tblocks_86047;
    
    max_num_tblocks_86047 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_76641;
    num_tblocks_76642 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_76640), max_num_tblocks_86047)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_86048 = sext_i64_i32(sdiv_up64(conc_tmp_62382, segmap_tblock_sizze_76640));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_76637(ctx, num_tblocks_76642, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_76639, 1, 1, (int64_t) 0, m_62289, conc_tmp_62375, conc_tmp_62382, m_63000, num_tblocks_76642, virt_num_tblocks_86048, mem_82044.mem, ext_mem_82064.mem, mem_82077.mem, ext_mem_82539.mem, ext_mem_82540.mem, ext_mem_82541.mem, mem_82543.mem, mem_82545.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82044, "mem_82044") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82064, "ext_mem_82064") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82077, "mem_82077") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82540, "ext_mem_82540") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82541, "ext_mem_82541") != 0)
        return 1;
    
    bool suff_outer_screma_76645;
    
    suff_outer_screma_76645 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_screma_5 <= m_63000;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_screma_5", (long) m_63000, suff_outer_screma_76645 ? "true" : "false");
    
    bool suff_outer_par_76965;
    
    suff_outer_par_76965 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_6 <= m_63000;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_6", (long) m_63000, suff_outer_par_76965 ? "true" : "false");
    
    int64_t num_tblocks_77077;
    int64_t max_num_tblocks_86061;
    
    max_num_tblocks_86061 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76959;
    num_tblocks_77077 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_63000, segscan_tblock_sizze_77076), max_num_tblocks_86061)));
    
    int64_t num_tblocks_76656;
    int64_t max_num_tblocks_86062;
    
    max_num_tblocks_86062 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_76649;
    num_tblocks_76656 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_63000, segscan_tblock_sizze_76655), max_num_tblocks_86062)));
    
    int64_t ldim_80151 = sdiv_up_safe64(m_63000, tile_sizze_80150);
    int64_t num_whole_tiles_80171 = squot_safe64(m_63000, tile_sizze_80150);
    int64_t residual_input_80403 = srem_safe64(m_63000, tile_sizze_80150);
    bool cond_80404 = residual_input_80403 == (int64_t) 0;
    int64_t ldim_79769 = sdiv_up_safe64(m_63000, tile_sizze_79768);
    int64_t num_whole_tiles_79789 = squot_safe64(m_63000, tile_sizze_79768);
    int64_t residual_input_80021 = srem_safe64(m_63000, tile_sizze_79768);
    bool cond_80022 = residual_input_80021 == (int64_t) 0;
    int64_t binop_x_80420 = tile_sizze_80150 * num_whole_tiles_80171;
    int64_t binop_x_80038 = tile_sizze_79768 * num_whole_tiles_79789;
    int64_t bytes_82571 = (int64_t) 8 * tile_sizze_80150;
    int64_t bytes_82643 = (int64_t) 8 * tile_sizze_79768;
    int64_t shared_memory_capacity_86218;
    
    shared_memory_capacity_86218 = ctx->max_shared_memory;
    if (suff_outer_par_76965 && sle64(sdiv_up64(bytes_82643, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82643, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82643, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_86218)) {
        if (memblock_alloc_device(ctx, &mem_82690, bytes_82542, "mem_82690")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_86168 = sext_i64_i32(sdiv_up64(tile_sizze_79768, tile_sizze_79768));
        int32_t virt_num_tblocks_86169 = sext_i64_i32(ldim_79769);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_79766(ctx, ldim_79769, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_79767, 1, 1, bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8) + (bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8)) + (bytes_82643 + srem64((int64_t) 8 - srem64(bytes_82643, (int64_t) 8), (int64_t) 8)), m_63000, ldim_79769, num_whole_tiles_79789, residual_input_80021, cond_80022, binop_x_80038, mem_82543.mem, mem_82545.mem, mem_82690.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82691, &mem_82690, "mem_82690") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82618, bytes_82542, "mem_82618")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_86193 = sext_i64_i32(sdiv_up64(tile_sizze_80150, tile_sizze_80150));
        int32_t virt_num_tblocks_86194 = sext_i64_i32(ldim_80151);
        
        {
            err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80148(ctx, ldim_80151, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80149, 1, 1, bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8) + (bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8)) + (bytes_82571 + srem64((int64_t) 8 - srem64(bytes_82571, (int64_t) 8), (int64_t) 8)), m_63000, ldim_80151, num_whole_tiles_80171, residual_input_80403, cond_80404, binop_x_80420, mem_82543.mem, mem_82545.mem, mem_82618.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_82691, &mem_82618, "mem_82618") != 0)
            return 1;
    }
    if (memblock_alloc_device(ctx, &mem_82693, bytes_82542, "mem_82693")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82693.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82691.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63000})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82696, bytes_82542, "mem_82696")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_63000)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_86219;
        
        shared_memory_86219 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_86220;
        
        thread_block_sizze_86220 = ctx->max_thread_block_size;
        
        int64_t registers_86221;
        
        registers_86221 = ctx->max_registers;
        
        int64_t thread_block_sizze_86222;
        
        thread_block_sizze_86222 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_86223 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_86219, thread_block_sizze_86220), (int64_t) 8), squot64(squot64(registers_86221, thread_block_sizze_86222) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_86224 = sdiv_up64(m_63000, segscan_tblock_sizze_77076 * chunk_sizze_86223);
        int64_t num_virt_threads_86225 = num_virt_blocks_86224 * segscan_tblock_sizze_77076;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_86223, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_86226, num_virt_blocks_86224, "status_flags_mem_86226")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_86226, num_virt_blocks_86224, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_86228, (int64_t) 8 * num_virt_blocks_86224, "aggregates_mem_86228")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_86230, (int64_t) 8 * num_virt_blocks_86224, "incprefixes_mem_86230")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_77081(ctx, num_tblocks_77077, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_76957, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77076), chunk_sizze_86223 * segscan_tblock_sizze_77076 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77076), chunk_sizze_86223 * segscan_tblock_sizze_77076 * (int64_t) 8), (int64_t) 8), (int64_t) 8), m_63000, num_tblocks_77077, num_virt_blocks_86224, num_virt_threads_86225, ext_mem_82691.mem, mem_82696.mem, status_flags_mem_86226.mem, aggregates_mem_86228.mem, incprefixes_mem_86230.mem, global_dynid_mem_86232.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &ext_mem_82691, "ext_mem_82691") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82703, &mem_82696, "mem_82696") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_82702, &mem_82693, "mem_82693") != 0)
        return 1;
    
    bool x_63085 = !empty_slice_63009;
    bool y_63086 = slt64(m_63010, m_63000);
    bool bounds_check_63087 = zzero_leq_i_p_m_t_s_63011 && y_63086;
    bool protect_assert_disj_63088 = empty_slice_63009 || bounds_check_63087;
    bool index_certs_63089;
    
    if (!protect_assert_disj_63088) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_63010, "] out of bounds for array of shape [", (long long) m_63000, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_63090;
    
    if (x_63085) {
        int64_t read_res_86935;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86935, ext_mem_82703.mem, m_63010 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66691 = read_res_86935;
        
        m_f_res_63090 = x_66691;
    } else {
        m_f_res_63090 = (int64_t) 0;
    }
    
    int64_t m_63092;
    
    if (empty_slice_63009) {
        m_63092 = (int64_t) 0;
    } else {
        m_63092 = m_f_res_63090;
    }
    
    int64_t m_63102 = sub64(m_63092, (int64_t) 1);
    bool i_p_m_t_s_leq_w_63104 = slt64(m_63102, m_63000);
    bool zzero_leq_i_p_m_t_s_63103 = sle64((int64_t) 0, m_63102);
    bool y_63106 = zzero_leq_i_p_m_t_s_63103 && i_p_m_t_s_leq_w_63104;
    bool i_lte_j_63105 = sle64((int64_t) 0, m_63092);
    bool forwards_ok_63107 = i_lte_j_63105 && y_63106;
    bool eq_x_zz_63099 = (int64_t) 0 == m_f_res_63090;
    bool p_and_eq_x_y_63100 = x_63085 && eq_x_zz_63099;
    bool empty_slice_63101 = empty_slice_63009 || p_and_eq_x_y_63100;
    bool ok_or_empty_63108 = empty_slice_63101 || forwards_ok_63107;
    bool index_certs_63109;
    
    if (!ok_or_empty_63108) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_63092, "] out of bounds for array of shape [", (long long) m_63000, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82704 = (int64_t) 8 * m_63092;
    int64_t do_DBSCAN_res_63120;
    
    if (cond_63119) {
        do_DBSCAN_res_63120 = partition_sizze_62142;
    } else {
        do_DBSCAN_res_63120 = m_61888;
    }
    
    int64_t bytes_82709 = (int64_t) 8 * do_DBSCAN_res_63120;
    bool eq_x_y_63130 = last_offset_62140 == (int64_t) 0;
    bool eq_x_zz_63131 = last_offset_62140 == m_f_res_61886;
    bool p_and_eq_x_y_63132 = cond_61878 && eq_x_y_63130;
    bool p_and_eq_x_y_63133 = x_61879 && eq_x_zz_63131;
    bool eq_x_zz_63134 = p_and_eq_x_y_63132 || p_and_eq_x_y_63133;
    bool p_and_eq_x_y_63135 = empty_slice_61897 && empty_slice_61897;
    bool p_and_eq_x_y_63136 = x_62139 && eq_x_zz_63134;
    bool eq_x_zz_63137 = p_and_eq_x_y_63135 || p_and_eq_x_y_63136;
    bool p_and_eq_x_y_63139 = eq_x_zz_63137 && not_p_63138;
    bool eq_x_y_63140 = cond_63119 || p_and_eq_x_y_63139;
    bool eq_x_y_63141 = m_f_res_61886 == (int64_t) 0;
    bool eq_x_zz_63142 = m_f_res_61886 == last_offset_62140;
    bool p_and_eq_x_y_63143 = empty_slice_61897 && eq_x_y_63141;
    bool p_and_eq_x_y_63144 = x_62139 && eq_x_zz_63142;
    bool eq_x_zz_63145 = p_and_eq_x_y_63143 || p_and_eq_x_y_63144;
    bool p_and_eq_x_y_63146 = cond_61878 && empty_slice_62170;
    bool p_and_eq_x_y_63147 = x_61879 && eq_x_zz_63145;
    bool eq_x_y_63148 = p_and_eq_x_y_63146 || p_and_eq_x_y_63147;
    bool p_and_eq_x_y_63149 = cond_63119 && eq_x_y_63148;
    bool eq_x_zz_63150 = not_p_63138 || p_and_eq_x_y_63149;
    bool p_and_eq_x_y_63151 = cond_63119 && eq_x_y_63140;
    bool p_and_eq_x_y_63152 = not_p_63138 && eq_x_zz_63150;
    bool dim_match_63153 = p_and_eq_x_y_63151 || p_and_eq_x_y_63152;
    bool empty_or_match_cert_63154;
    
    if (!dim_match_63153) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftDBSCAN_plus.fut:879:33-38\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_res_63155 = smax64((int64_t) 1, conc_tmp_62379);
    bool zzero_63156 = max_res_63155 == (int64_t) 0;
    bool nonzzero_63157 = !zzero_63156;
    bool nonzzero_cert_63158;
    
    if (!nonzzero_63157) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:726:55-84\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_63159 = sdiv64(clBase_48693, max_res_63155);
    int64_t max_res_63160 = smax64((int64_t) 1, max_arg1_63159);
    int64_t num_tblocks_77100;
    int64_t max_num_tblocks_86321;
    
    max_num_tblocks_86321 = *ctx->tuning_params.do_DBSCAN_doublezisegscan_num_tblocks_77099;
    num_tblocks_77100 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62379, segscan_tblock_sizze_77098), max_num_tblocks_86321)));
    
    double d_haversine_res_81627;
    
    if (x_81841) {
        double read_res_86936;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86936, ext_mem_81988.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81875 = read_res_86936;
        
        d_haversine_res_81627 = x_81875;
    } else {
        d_haversine_res_81627 = 0.0;
    }
    if (memblock_unref_device(ctx, &ext_mem_81988, "ext_mem_81988") != 0)
        return 1;
    
    double cos_res_81631;
    
    if (x_81841) {
        double read_res_86937;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86937, mem_81992.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81877 = read_res_86937;
        
        cos_res_81631 = x_81877;
    } else {
        cos_res_81631 = 0.0;
    }
    if (memblock_unref_device(ctx, &mem_81992, "mem_81992") != 0)
        return 1;
    
    double d_haversine_res_81628;
    
    if (x_81841) {
        double read_res_86938;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86938, ext_mem_81987.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81868 = read_res_86938;
        
        d_haversine_res_81628 = x_81868;
    } else {
        d_haversine_res_81628 = 0.0;
    }
    if (memblock_unref_device(ctx, &ext_mem_81987, "ext_mem_81987") != 0)
        return 1;
    
    double cos_res_81632;
    
    if (x_81841) {
        double read_res_86939;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86939, mem_81991.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81870 = read_res_86939;
        
        cos_res_81632 = x_81870;
    } else {
        cos_res_81632 = 0.0;
    }
    if (memblock_unref_device(ctx, &mem_81991, "mem_81991") != 0)
        return 1;
    
    double d_haversine_res_81629;
    
    if (x_81841) {
        double read_res_86940;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86940, ext_mem_81990.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81863 = read_res_86940;
        
        d_haversine_res_81629 = x_81863;
    } else {
        d_haversine_res_81629 = 0.0;
    }
    if (memblock_unref_device(ctx, &ext_mem_81990, "ext_mem_81990") != 0)
        return 1;
    
    double d_haversine_res_81630;
    
    if (x_81841) {
        double read_res_86941;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86941, ext_mem_81989.mem, (int64_t) 0 * sizeof(double), sizeof(double))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        double x_81858 = read_res_86941;
        
        d_haversine_res_81630 = x_81858;
    } else {
        d_haversine_res_81630 = 0.0;
    }
    if (memblock_unref_device(ctx, &ext_mem_81989, "ext_mem_81989") != 0)
        return 1;
    
    int64_t bytes_82719 = (int64_t) 8 * conc_tmp_62379;
    
    if (memblock_alloc_device(ctx, &mem_82720, bytes_82719, "mem_82720")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82722, bytes_82719, "mem_82722")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82724, bytes_82719, "mem_82724")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82726, bytes_82719, "mem_82726")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82728, bytes_82719, "mem_82728")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, conc_tmp_62379)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_86322;
        
        shared_memory_86322 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_86323;
        
        thread_block_sizze_86323 = ctx->max_thread_block_size;
        
        int64_t registers_86324;
        
        registers_86324 = ctx->max_registers;
        
        int64_t thread_block_sizze_86325;
        
        thread_block_sizze_86325 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_86326 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_86322, thread_block_sizze_86323), (int64_t) 8), squot64(squot64(registers_86324, thread_block_sizze_86325) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_86327 = sdiv_up64(conc_tmp_62379, segscan_tblock_sizze_77098 * chunk_sizze_86326);
        int64_t num_virt_threads_86328 = num_virt_blocks_86327 * segscan_tblock_sizze_77098;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_86326, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_86329, num_virt_blocks_86327, "status_flags_mem_86329")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_86329, num_virt_blocks_86327, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_86331, (int64_t) 8 * num_virt_blocks_86327, "aggregates_mem_86331")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_86333, (int64_t) 8 * num_virt_blocks_86327, "incprefixes_mem_86333")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_do_DBSCAN_doublezisegscan_77103(ctx, num_tblocks_77100, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegscan_tblock_sizze_77097, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77098), chunk_sizze_86326 * segscan_tblock_sizze_77098 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_77098), chunk_sizze_86326 * segscan_tblock_sizze_77098 * (int64_t) 8), (int64_t) 8), (int64_t) 8), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_62289, conc_tmp_62375, conc_tmp_62379, conc_tmp_62382, num_tblocks_77100, d_haversine_res_81627, d_haversine_res_81628, d_haversine_res_81629, d_haversine_res_81630, cos_res_81631, cos_res_81632, num_virt_blocks_86327, num_virt_threads_86328, mem_81979.mem, mem_81981.mem, mem_81983.mem, mem_81985.mem, mem_82046.mem, mem_82048.mem, ext_mem_82065.mem, ext_mem_82066.mem, mem_82079.mem, mem_82081.mem, ext_mem_82539.mem, mem_82720.mem, mem_82722.mem, mem_82724.mem, mem_82726.mem, mem_82728.mem, status_flags_mem_86329.mem, aggregates_mem_86331.mem, incprefixes_mem_86333.mem, global_dynid_mem_86335.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &mem_81979, "mem_81979") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81981, "mem_81981") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81983, "mem_81983") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81985, "mem_81985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82046, "mem_82046") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82048, "mem_82048") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82065, "ext_mem_82065") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82066, "ext_mem_82066") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82079, "mem_82079") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82081, "mem_82081") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82539, "ext_mem_82539") != 0)
        return 1;
    
    bool cond_63390 = conc_tmp_62379 == (int64_t) 0;
    bool x_63391 = !cond_63390;
    int64_t tmp_63392 = sub64(conc_tmp_62379, (int64_t) 1);
    bool x_63393 = sle64((int64_t) 0, tmp_63392);
    bool y_63394 = slt64(tmp_63392, conc_tmp_62379);
    bool bounds_check_63395 = x_63393 && y_63394;
    bool protect_assert_disj_63396 = cond_63390 || bounds_check_63395;
    bool index_certs_63397;
    
    if (!protect_assert_disj_63396) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_63392, "] out of bounds for array of shape [", (long long) conc_tmp_62379, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_63398;
    
    if (x_63391) {
        int64_t read_res_86942;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86942, mem_82720.mem, tmp_63392 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_66746 = read_res_86942;
        
        m_f_res_63398 = x_66746;
    } else {
        m_f_res_63398 = (int64_t) 0;
    }
    
    int64_t m_63400;
    
    if (cond_63390) {
        m_63400 = (int64_t) 0;
    } else {
        m_63400 = m_f_res_63398;
    }
    
    int64_t m_63410 = sub64(m_63400, (int64_t) 1);
    bool i_p_m_t_s_leq_w_63412 = slt64(m_63410, conc_tmp_62379);
    bool zzero_leq_i_p_m_t_s_63411 = sle64((int64_t) 0, m_63410);
    bool y_63414 = zzero_leq_i_p_m_t_s_63411 && i_p_m_t_s_leq_w_63412;
    bool i_lte_j_63413 = sle64((int64_t) 0, m_63400);
    bool forwards_ok_63415 = i_lte_j_63413 && y_63414;
    bool eq_x_zz_63407 = (int64_t) 0 == m_f_res_63398;
    bool p_and_eq_x_y_63408 = x_63391 && eq_x_zz_63407;
    bool empty_slice_63409 = cond_63390 || p_and_eq_x_y_63408;
    bool ok_or_empty_63416 = empty_slice_63409 || forwards_ok_63415;
    bool index_certs_63417;
    
    if (!ok_or_empty_63416) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_63400, "] out of bounds for array of shape [", (long long) conc_tmp_62379, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82729 = (int64_t) 8 * m_63400;
    int64_t max_res_63431 = smax64((int64_t) 1, m_63400);
    bool zzero_63432 = max_res_63431 == (int64_t) 0;
    bool nonzzero_63433 = !zzero_63432;
    bool nonzzero_cert_63434;
    
    if (!nonzzero_63433) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:733:58-94\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_63435 = sdiv64(clBase_48693, max_res_63431);
    int64_t max_res_63436 = smax64((int64_t) 1, max_arg1_63435);
    int64_t zm_lhs_63437 = add64(do_DBSCAN_res_63120, max_res_63436);
    int64_t zs_lhs_63438 = sub64(zm_lhs_63437, (int64_t) 1);
    bool zzero_63439 = max_res_63436 == (int64_t) 0;
    bool nonzzero_63440 = !zzero_63439;
    bool nonzzero_cert_63441;
    
    if (!nonzzero_63440) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:734:60-70\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter1_63442 = sdiv64(zs_lhs_63438, max_res_63436);
    bool bounds_invalid_upwards_63444 = slt64(numIter1_63442, (int64_t) 0);
    bool valid_63445 = !bounds_invalid_upwards_63444;
    bool range_valid_c_63446;
    
    if (!valid_63445) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) numIter1_63442, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:736:75-88\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_63531 = add64(n_48679, max_res_63160);
    int64_t zs_lhs_63532 = sub64(zm_lhs_63531, (int64_t) 1);
    bool zzero_63533 = max_res_63160 == (int64_t) 0;
    bool nonzzero_63534 = !zzero_63533;
    bool nonzzero_cert_63535;
    
    if (!nonzzero_63534) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:751:57-64\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter2_63536 = sdiv64(zs_lhs_63532, max_res_63160);
    bool bounds_invalid_upwards_63538 = slt64(numIter2_63536, (int64_t) 0);
    bool valid_63539 = !bounds_invalid_upwards_63538;
    bool range_valid_c_63540;
    
    if (!valid_63539) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) numIter2_63536, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:753:75-88\n   #2  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #3  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_63627;
    
    if (!dim_match_63153) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) do_DBSCAN_res_63120, "] cannot match shape of type `[", (long long) do_DBSCAN_res_63120, "]i64`.", "-> #0  ft_libs/ftDBSCAN_plus.fut:883:87-104\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t conc_tmp_63649 = dz2084U_48681 + m_63092;
    int64_t bytes_82902 = (int64_t) 8 * conc_tmp_63649;
    int64_t segmap_tblock_sizze_77092;
    
    segmap_tblock_sizze_77092 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77091;
    
    int64_t segmap_tblock_sizze_77108;
    
    segmap_tblock_sizze_77108 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77107;
    
    int64_t segmap_tblock_sizze_77334;
    
    segmap_tblock_sizze_77334 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77319;
    
    int64_t segred_tblock_sizze_77352;
    
    segred_tblock_sizze_77352 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253;
    
    int64_t tile_sizze_80532;
    
    tile_sizze_80532 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531;
    if (memblock_alloc_device(ctx, &mem_81972, bytes_81953, "mem_81972")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81972, n_48679, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_77636;
    
    segmap_tblock_sizze_77636 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77621;
    
    int64_t segred_tblock_sizze_77654;
    
    segred_tblock_sizze_77654 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555;
    
    int64_t tile_sizze_80973;
    
    tile_sizze_80973 = *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972;
    if (memblock_alloc_device(ctx, &mem_81974, bytes_81973, "mem_81974")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81974.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, clProc_mem_81934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2081U_48683})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_81975, dz2080U_48682, "mem_81975")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_1b(ctx, 1, mem_81975.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, clProc_mem_81933.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2080U_48682})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_77728;
    
    segmap_tblock_sizze_77728 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77727;
    
    int64_t segred_tblock_sizze_77734;
    
    segred_tblock_sizze_77734 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77733;
    
    int64_t num_tblocks_77736;
    int64_t max_num_tblocks_86424;
    
    max_num_tblocks_86424 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77735;
    num_tblocks_77736 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_48679, segred_tblock_sizze_77734), max_num_tblocks_86424)));
    
    int64_t segred_tblock_sizze_77744;
    
    segred_tblock_sizze_77744 = *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77743;
    if (memblock_alloc_device(ctx, &mem_81976, (int64_t) 0, "mem_81976")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81977, (int64_t) 0, "mem_81977")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81978, (int64_t) 0, "mem_81978")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82705, bytes_82704, "mem_82705")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82705.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82543.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63092})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82707, bytes_82704, "mem_82707")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82707.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82545.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63092})) != 0)
        goto cleanup;
    
    int64_t num_tblocks_77094;
    int64_t max_num_tblocks_86425;
    
    max_num_tblocks_86425 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77093;
    num_tblocks_77094 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_63000, segmap_tblock_sizze_77092), max_num_tblocks_86425)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_86426 = sext_i64_i32(sdiv_up64(m_63000, segmap_tblock_sizze_77092));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_77089(ctx, num_tblocks_77094, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77091, 1, 1, (int64_t) 0, m_63000, m_63092, num_tblocks_77094, virt_num_tblocks_86426, mem_82543.mem, mem_82545.mem, ext_mem_82702.mem, ext_mem_82703.mem, mem_82705.mem, mem_82707.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82543, "mem_82543") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82545, "mem_82545") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82702, "ext_mem_82702") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82703, "ext_mem_82703") != 0)
        return 1;
    if (cond_63119) {
        if (memblock_set_device(ctx, &ext_mem_82717, &mem_82019, "mem_82019") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82716, &mem_82021, "mem_82021") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82715, &mem_82026, "mem_82026") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_82710, bytes_82709, "mem_82710")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_86439 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82710.mem, tmp_offs_86439, (int64_t []) {(int64_t) 1}, mem_82019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {partition_sizze_62142})) != 0)
            goto cleanup;
        tmp_offs_86439 += partition_sizze_62142;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82710.mem, tmp_offs_86439, (int64_t []) {(int64_t) 1}, mem_82019.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62183})) != 0)
            goto cleanup;
        tmp_offs_86439 += j_m_i_62183;
        if (memblock_alloc_device(ctx, &mem_82712, bytes_82709, "mem_82712")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_86440 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82712.mem, tmp_offs_86440, (int64_t []) {(int64_t) 1}, mem_82021.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {partition_sizze_62142})) != 0)
            goto cleanup;
        tmp_offs_86440 += partition_sizze_62142;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82712.mem, tmp_offs_86440, (int64_t []) {(int64_t) 1}, mem_82021.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62183})) != 0)
            goto cleanup;
        tmp_offs_86440 += j_m_i_62183;
        if (memblock_alloc_device(ctx, &mem_82714, bytes_82709, "mem_82714")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_86441 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82714.mem, tmp_offs_86441, (int64_t []) {(int64_t) 1}, mem_82026.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {partition_sizze_62142})) != 0)
            goto cleanup;
        tmp_offs_86441 += partition_sizze_62142;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82714.mem, tmp_offs_86441, (int64_t []) {(int64_t) 1}, mem_82026.mem, partition_sizze_62142, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_62183})) != 0)
            goto cleanup;
        tmp_offs_86441 += j_m_i_62183;
        if (memblock_set_device(ctx, &ext_mem_82717, &mem_82710, "mem_82710") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82716, &mem_82712, "mem_82712") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82715, &mem_82714, "mem_82714") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_82019, "mem_82019") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82021, "mem_82021") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82730, bytes_82729, "mem_82730")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82730.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82728.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63400})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82732, bytes_82729, "mem_82732")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82732.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82726.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63400})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82734, bytes_82729, "mem_82734")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82734.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_82724.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63400})) != 0)
        goto cleanup;
    
    int64_t num_tblocks_77110;
    int64_t max_num_tblocks_86442;
    
    max_num_tblocks_86442 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77109;
    num_tblocks_77110 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(conc_tmp_62379, segmap_tblock_sizze_77108), max_num_tblocks_86442)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_86443 = sext_i64_i32(sdiv_up64(conc_tmp_62379, segmap_tblock_sizze_77108));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_77105(ctx, num_tblocks_77110, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77107, 1, 1, (int64_t) 0, conc_tmp_62379, m_63400, num_tblocks_77110, virt_num_tblocks_86443, mem_82720.mem, mem_82722.mem, mem_82724.mem, mem_82726.mem, mem_82728.mem, mem_82730.mem, mem_82732.mem, mem_82734.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82720, "mem_82720") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82722, "mem_82722") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82737, bytes_82709, "mem_82737")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_82737, do_DBSCAN_res_63120, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_whole_tiles_80577 = squot_safe64(m_63400, tile_sizze_80532);
    int64_t residual_input_80839 = srem_safe64(m_63400, tile_sizze_80532);
    bool cond_80840 = residual_input_80839 == (int64_t) 0;
    int64_t binop_x_80856 = tile_sizze_80532 * num_whole_tiles_80577;
    int64_t bytes_82784 = (int64_t) 8 * tile_sizze_80532;
    
    for (int64_t i_63448 = 0; i_63448 < numIter1_63442; i_63448++) {
        int64_t inf_63450 = mul64(max_res_63436, i_63448);
        int64_t min_arg1_63451 = add64(max_res_63436, inf_63450);
        int64_t min_res_63452 = smin64(do_DBSCAN_res_63120, min_arg1_63451);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453 = sub64(min_res_63452, inf_63450);
        bool empty_slice_63454 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453 == (int64_t) 0;
        int64_t m_63455 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, (int64_t) 1);
        int64_t i_p_m_t_s_63456 = add64(inf_63450, m_63455);
        bool zzero_leq_i_p_m_t_s_63457 = sle64((int64_t) 0, i_p_m_t_s_63456);
        bool i_p_m_t_s_leq_w_63458 = slt64(i_p_m_t_s_63456, do_DBSCAN_res_63120);
        bool zzero_lte_i_63459 = sle64((int64_t) 0, inf_63450);
        bool i_lte_j_63460 = sle64(inf_63450, min_res_63452);
        bool y_63461 = i_p_m_t_s_leq_w_63458 && zzero_lte_i_63459;
        bool y_63462 = zzero_leq_i_p_m_t_s_63457 && y_63461;
        bool forwards_ok_63463 = i_lte_j_63460 && y_63462;
        bool ok_or_empty_63464 = empty_slice_63454 || forwards_ok_63463;
        bool index_certs_63465;
        
        if (!ok_or_empty_63464) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_63450, ":", (long long) min_res_63452, "] out of bounds for array of shape [", (long long) do_DBSCAN_res_63120, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:739:48-69\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_77113;
        
        suff_outer_par_77113 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_7 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_7", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, suff_outer_par_77113 ? "true" : "false");
        
        int64_t nest_sizze_77351 = m_63400 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;
        int64_t num_tblocks_77353;
        int64_t max_num_tblocks_86457;
        
        max_num_tblocks_86457 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77255;
        num_tblocks_77353 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_77351, segred_tblock_sizze_77352), max_num_tblocks_86457)));
        
        int64_t bytes_82742 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;
        int64_t shared_memory_capacity_86586;
        
        shared_memory_capacity_86586 = ctx->max_shared_memory;
        if (suff_outer_par_77113 && sle64(sdiv_up64(bytes_82784, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82784, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82784, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_86586)) {
            int64_t ldim_80533 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, tile_sizze_80532);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_86458 = sext_i64_i32(sdiv_up64(tile_sizze_80532, tile_sizze_80532));
            int32_t virt_num_tblocks_86459 = sext_i64_i32(ldim_80533);
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80530(ctx, ldim_80533, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80531, 1, 1, bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8) + (bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8)) + (bytes_82784 + srem64((int64_t) 8 - srem64(bytes_82784, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_63400, inf_63450, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, ldim_80533, num_whole_tiles_80577, residual_input_80839, cond_80840, binop_x_80856, ext_mem_82716.mem, ext_mem_82717.mem, mem_82730.mem, mem_82732.mem, mem_82734.mem, mem_82737.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        } else {
            int64_t segmap_usable_groups_77335 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, segmap_tblock_sizze_77334);
            
            if (memblock_alloc_device(ctx, &mem_82743, bytes_82742, "mem_82743")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82745, bytes_82742, "mem_82745")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82747, bytes_82742, "mem_82747")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_86479 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, segmap_tblock_sizze_77334));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_77340(ctx, segmap_usable_groups_77335, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77319, 1, 1, (int64_t) 0, clBase_48690, inf_63450, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, ext_mem_82716.mem, ext_mem_82717.mem, mem_82743.mem, mem_82745.mem, mem_82747.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_82752, bytes_82742, "mem_82752")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_86488 = (int64_t) 1;
            
            if (slt64(m_63400 * (int64_t) 2, segred_tblock_sizze_77352 * chunk_sizze_86488)) {
                int64_t segment_sizze_nonzzero_86489 = smax64((int64_t) 1, m_63400);
                int64_t num_threads_86490 = segred_tblock_sizze_77352 * segred_tblock_sizze_77352;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) m_63400, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, squot64(segred_tblock_sizze_77352, segment_sizze_nonzzero_86489))), '\n');
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegred_small_77359(ctx, num_tblocks_77353, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253, 1, 1, (int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8) + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_63400, inf_63450, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, num_tblocks_77353, x_81841, segment_sizze_nonzzero_86489, ext_mem_82716.mem, ext_mem_82717.mem, mem_82730.mem, mem_82732.mem, mem_82734.mem, mem_82737.mem, mem_82743.mem, mem_82745.mem, mem_82747.mem, mem_82752.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_86529 = sdiv_up64(num_tblocks_77353, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453));
                int64_t q_86530 = sdiv_up64(m_63400, segred_tblock_sizze_77352 * blocks_per_segment_86529 * chunk_sizze_86488);
                int64_t num_virtblocks_86531 = blocks_per_segment_86529 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453;
                int64_t threads_per_segment_86532 = blocks_per_segment_86529 * segred_tblock_sizze_77352;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) m_63400, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_86531, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_77353, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_77352, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_86530, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_86529, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_86533, (int64_t) 8 * num_virtblocks_86531, "segred_tmp_mem_86533")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &segred_tmp_mem_86535, (int64_t) 8 * num_virtblocks_86531, "segred_tmp_mem_86535")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegred_large_77359(ctx, num_tblocks_77353, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77253, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_77352 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77352, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, m_63400, inf_63450, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63453, num_tblocks_77353, x_81841, blocks_per_segment_86529, q_86530, num_virtblocks_86531, threads_per_segment_86532, ext_mem_82716.mem, ext_mem_82717.mem, mem_82730.mem, mem_82732.mem, mem_82734.mem, mem_82737.mem, mem_82743.mem, mem_82745.mem, mem_82747.mem, mem_82752.mem, segred_tmp_mem_86533.mem, segred_tmp_mem_86535.mem, counters_mem_86537.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82743, "mem_82743") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82745, "mem_82745") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82747, "mem_82747") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82752, "mem_82752") != 0)
                return 1;
        }
    }
    if (memblock_unref_device(ctx, &ext_mem_82716, "ext_mem_82716") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82717, "ext_mem_82717") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82730, "mem_82730") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82732, "mem_82732") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82734, "mem_82734") != 0)
        return 1;
    
    int64_t num_whole_tiles_81018 = squot_safe64(conc_tmp_62379, tile_sizze_80973);
    int64_t residual_input_81280 = srem_safe64(conc_tmp_62379, tile_sizze_80973);
    bool cond_81281 = residual_input_81280 == (int64_t) 0;
    int64_t binop_x_81297 = tile_sizze_80973 * num_whole_tiles_81018;
    int64_t bytes_82863 = (int64_t) 8 * tile_sizze_80973;
    
    for (int64_t i_63542 = 0; i_63542 < numIter2_63536; i_63542++) {
        int64_t inf_63544 = mul64(max_res_63160, i_63542);
        int64_t min_arg1_63545 = add64(max_res_63160, inf_63544);
        int64_t min_res_63546 = smin64(n_48679, min_arg1_63545);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547 = sub64(min_res_63546, inf_63544);
        bool empty_slice_63548 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547 == (int64_t) 0;
        int64_t m_63549 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, (int64_t) 1);
        int64_t i_p_m_t_s_63550 = add64(inf_63544, m_63549);
        bool zzero_leq_i_p_m_t_s_63551 = sle64((int64_t) 0, i_p_m_t_s_63550);
        bool i_p_m_t_s_leq_w_63552 = slt64(i_p_m_t_s_63550, n_48679);
        bool zzero_lte_i_63553 = sle64((int64_t) 0, inf_63544);
        bool i_lte_j_63554 = sle64(inf_63544, min_res_63546);
        bool y_63555 = i_p_m_t_s_leq_w_63552 && zzero_lte_i_63553;
        bool y_63556 = zzero_leq_i_p_m_t_s_63551 && y_63555;
        bool forwards_ok_63557 = i_lte_j_63554 && y_63556;
        bool ok_or_empty_63558 = empty_slice_63548 || forwards_ok_63557;
        bool index_certs_63559;
        
        if (!ok_or_empty_63558) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_63544, ":", (long long) min_res_63546, "] out of bounds for array of shape [", (long long) n_48679, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:756:48-70\n   #1  ft_libs/ftDBSCAN_plus.fut:1051:18-1055:80\n   #2  ft_libs/ftDBSCAN_plus.fut:1050:9-1055:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_77415;
        
        suff_outer_par_77415 = *ctx->tuning_params.do_DBSCAN_doublezisuff_outer_par_8 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "do_DBSCAN_double.suff_outer_par_8", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, suff_outer_par_77415 ? "true" : "false");
        
        int64_t nest_sizze_77653 = conc_tmp_62379 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;
        int64_t num_tblocks_77655;
        int64_t max_num_tblocks_86588;
        
        max_num_tblocks_86588 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77557;
        num_tblocks_77655 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_77653, segred_tblock_sizze_77654), max_num_tblocks_86588)));
        
        int64_t bytes_82821 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;
        int64_t shared_memory_capacity_86717;
        
        shared_memory_capacity_86717 = ctx->max_shared_memory;
        if (suff_outer_par_77415 && sle64(sdiv_up64(bytes_82863, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82863, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82863, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_86717)) {
            int64_t ldim_80974 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, tile_sizze_80973);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_86589 = sext_i64_i32(sdiv_up64(tile_sizze_80973, tile_sizze_80973));
            int32_t virt_num_tblocks_86590 = sext_i64_i32(ldim_80974);
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_intrablock_80971(ctx, ldim_80974, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezitile_sizze_80972, 1, 1, bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8), (int64_t) 8) + (bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8), (int64_t) 8)) + (bytes_82863 + srem64((int64_t) 8 - srem64(bytes_82863, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, conc_tmp_62379, inf_63544, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, ldim_80974, num_whole_tiles_81018, residual_input_81280, cond_81281, binop_x_81297, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_81972.mem, mem_82724.mem, mem_82726.mem, mem_82728.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        } else {
            int64_t segmap_usable_groups_77637 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, segmap_tblock_sizze_77636);
            
            if (memblock_alloc_device(ctx, &mem_82822, bytes_82821, "mem_82822")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82824, bytes_82821, "mem_82824")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82826, bytes_82821, "mem_82826")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_86610 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, segmap_tblock_sizze_77636));
            
            {
                err = gpu_kernel_do_DBSCAN_doublezisegmap_77642(ctx, segmap_usable_groups_77637, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77621, 1, 1, (int64_t) 0, clBase_48690, inf_63544, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_82822.mem, mem_82824.mem, mem_82826.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_82831, bytes_82821, "mem_82831")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_86619 = (int64_t) 1;
            
            if (slt64(conc_tmp_62379 * (int64_t) 2, segred_tblock_sizze_77654 * chunk_sizze_86619)) {
                int64_t segment_sizze_nonzzero_86620 = smax64((int64_t) 1, conc_tmp_62379);
                int64_t num_threads_86621 = segred_tblock_sizze_77654 * segred_tblock_sizze_77654;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) conc_tmp_62379, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, squot64(segred_tblock_sizze_77654, segment_sizze_nonzzero_86620))), '\n');
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegred_small_77661(ctx, num_tblocks_77655, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555, 1, 1, (int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8) + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, conc_tmp_62379, inf_63544, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, num_tblocks_77655, x_81841, segment_sizze_nonzzero_86620, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_81972.mem, mem_82724.mem, mem_82726.mem, mem_82728.mem, mem_82822.mem, mem_82824.mem, mem_82826.mem, mem_82831.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_86660 = sdiv_up64(num_tblocks_77655, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547));
                int64_t q_86661 = sdiv_up64(conc_tmp_62379, segred_tblock_sizze_77654 * blocks_per_segment_86660 * chunk_sizze_86619);
                int64_t num_virtblocks_86662 = blocks_per_segment_86660 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547;
                int64_t threads_per_segment_86663 = blocks_per_segment_86660 * segred_tblock_sizze_77654;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) conc_tmp_62379, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_86662, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_77655, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_77654, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_86661, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_86660, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_86664, (int64_t) 8 * num_virtblocks_86662, "segred_tmp_mem_86664")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &segred_tmp_mem_86666, (int64_t) 8 * num_virtblocks_86662, "segred_tmp_mem_86666")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_do_DBSCAN_doublezisegred_large_77661(ctx, num_tblocks_77655, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77555, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_77654 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77654, (int64_t) 8), (int64_t) 8)), clBase_48690, clBase_48691, clBase_48692, clBase_48698, conc_tmp_62379, inf_63544, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_63547, num_tblocks_77655, x_81841, blocks_per_segment_86660, q_86661, num_virtblocks_86662, threads_per_segment_86663, current_partition_mem_81940.mem, current_partition_mem_81941.mem, mem_81972.mem, mem_82724.mem, mem_82726.mem, mem_82728.mem, mem_82822.mem, mem_82824.mem, mem_82826.mem, mem_82831.mem, segred_tmp_mem_86664.mem, segred_tmp_mem_86666.mem, counters_mem_86668.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_82822, "mem_82822") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82824, "mem_82824") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82826, "mem_82826") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_82831, "mem_82831") != 0)
                return 1;
        }
    }
    if (memblock_unref_device(ctx, &mem_82724, "mem_82724") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82726, "mem_82726") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82728, "mem_82728") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_77720;
    
    segmap_tblock_sizze_77720 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77719;
    
    int64_t num_tblocks_77722;
    int64_t max_num_tblocks_86718;
    
    max_num_tblocks_86718 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77721;
    num_tblocks_77722 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(do_DBSCAN_res_63120, segmap_tblock_sizze_77720), max_num_tblocks_86718)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_86719 = sext_i64_i32(sdiv_up64(do_DBSCAN_res_63120, segmap_tblock_sizze_77720));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_77717(ctx, num_tblocks_77722, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77719, 1, 1, (int64_t) 0, dz2081U_48683, do_DBSCAN_res_63120, num_tblocks_77722, virt_num_tblocks_86719, mem_81974.mem, ext_mem_82715.mem, mem_82737.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_82715, "ext_mem_82715") != 0)
        return 1;
    
    int64_t num_tblocks_77730;
    int64_t max_num_tblocks_86732;
    
    max_num_tblocks_86732 = *ctx->tuning_params.do_DBSCAN_doublezisegmap_num_tblocks_77729;
    num_tblocks_77730 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(partition_sizze_62142, segmap_tblock_sizze_77728), max_num_tblocks_86732)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_86733 = sext_i64_i32(sdiv_up64(partition_sizze_62142, segmap_tblock_sizze_77728));
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegmap_77725(ctx, num_tblocks_77730, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegmap_tblock_sizze_77727, 1, 1, (int64_t) 0, dz2080U_48682, partition_sizze_62142, num_tblocks_77730, virt_num_tblocks_86733, mem_81975.mem, mem_82026.mem, mem_82042.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82026, "mem_82026") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82042, "mem_82042") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82899, (int64_t) 8, "mem_82899")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_86746 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_86749, (int64_t) 8 * num_tblocks_77736, "segred_tmp_mem_86749")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_86751 = num_tblocks_77736 * segred_tblock_sizze_77734;
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegred_nonseg_77741(ctx, num_tblocks_77736, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77733, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_77734 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77734, (int64_t) 8), (int64_t) 8)), n_48679, num_tblocks_77736, num_threads_86751, mem_81972.mem, mem_82899.mem, counters_mem_86747.mem, segred_tmp_mem_86749.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t num_tblocks_77746;
    int64_t max_num_tblocks_86780;
    
    max_num_tblocks_86780 = *ctx->tuning_params.do_DBSCAN_doublezisegred_num_tblocks_77745;
    num_tblocks_77746 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(do_DBSCAN_res_63120, segred_tblock_sizze_77744), max_num_tblocks_86780)));
    if (memblock_alloc_device(ctx, &mem_82901, (int64_t) 8, "mem_82901")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_86781 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_86784, (int64_t) 8 * num_tblocks_77746, "segred_tmp_mem_86784")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_86786 = num_tblocks_77746 * segred_tblock_sizze_77744;
    
    {
        err = gpu_kernel_do_DBSCAN_doublezisegred_nonseg_77751(ctx, num_tblocks_77746, 1, 1, *ctx->tuning_params.do_DBSCAN_doublezisegred_tblock_sizze_77743, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_77744 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_77744, (int64_t) 8), (int64_t) 8)), do_DBSCAN_res_63120, num_tblocks_77746, num_threads_86786, mem_82737.mem, mem_82901.mem, counters_mem_86782.mem, segred_tmp_mem_86784.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_82737, "mem_82737") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82903, bytes_82902, "mem_82903")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_86815 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82903.mem, tmp_offs_86815, (int64_t []) {(int64_t) 1}, chain_collisions_mem_81927.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2084U_48681})) != 0)
        goto cleanup;
    tmp_offs_86815 += dz2084U_48681;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82903.mem, tmp_offs_86815, (int64_t []) {(int64_t) 1}, mem_82707.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63092})) != 0)
        goto cleanup;
    tmp_offs_86815 += m_63092;
    if (memblock_unref_device(ctx, &mem_82707, "mem_82707") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82905, bytes_82902, "mem_82905")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_86816 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82905.mem, tmp_offs_86816, (int64_t []) {(int64_t) 1}, chain_collisions_mem_81928.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2084U_48681})) != 0)
        goto cleanup;
    tmp_offs_86816 += dz2084U_48681;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82905.mem, tmp_offs_86816, (int64_t []) {(int64_t) 1}, mem_82705.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_63092})) != 0)
        goto cleanup;
    tmp_offs_86816 += m_63092;
    if (memblock_unref_device(ctx, &mem_82705, "mem_82705") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_82906, (int64_t) 8, "mem_82906")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_do_DBSCAN_doublezigpuseq_86817(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_82899.mem, mem_82901.mem, mem_82906.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_82899, "mem_82899") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82901, "mem_82901") != 0)
        return 1;
    
    int64_t read_res_86943;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_86943, mem_82906.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t max_res_63646 = read_res_86943;
    
    if (memblock_unref_device(ctx, &mem_82906, "mem_82906") != 0)
        return 1;
    
    int64_t max_arg1_63647 = add64((int64_t) 1, max_res_63646);
    int64_t max_res_63648 = smax64(clProc_48705, max_arg1_63647);
    
    if (memblock_set_device(ctx, &mem_out_83117, &mem_82903, "mem_82903") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83118, &mem_82905, "mem_82905") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83119, &clBase_mem_81929, "clBase_mem_81929") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83120, &clBase_mem_81930, "clBase_mem_81930") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83121, &clBase_mem_81931, "clBase_mem_81931") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83122, &clBase_mem_81932, "clBase_mem_81932") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83123, &mem_81975, "mem_81975") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83124, &mem_81974, "mem_81974") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83125, &clProc_mem_81935, "clProc_mem_81935") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83126, &clProc_mem_81936, "clProc_mem_81936") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83127, &clProc_mem_81937, "clProc_mem_81937") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83128, &clProc_mem_81938, "clProc_mem_81938") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83129, &mem_81972, "mem_81972") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83130, &current_partition_mem_81940, "current_partition_mem_81940") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83131, &current_partition_mem_81941, "current_partition_mem_81941") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83132, &mem_82070, "mem_82070") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83133, &current_partition_mem_81943, "current_partition_mem_81943") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83134, &current_partition_mem_81944, "current_partition_mem_81944") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83135, &current_partition_mem_81945, "current_partition_mem_81945") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83136, &current_partition_mem_81946, "current_partition_mem_81946") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83137, &current_partition_mem_81947, "current_partition_mem_81947") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83138, &current_partition_mem_81948, "current_partition_mem_81948") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83139, &mem_81976, "mem_81976") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83140, &mem_81977, "mem_81977") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83141, &mem_81978, "mem_81978") != 0)
        return 1;
    prim_out_83142 = conc_tmp_63649;
    prim_out_83143 = clBase_48690;
    prim_out_83144 = clBase_48691;
    prim_out_83145 = clBase_48692;
    prim_out_83146 = clBase_48693;
    prim_out_83147 = clBase_48695;
    prim_out_83148 = clBase_48698;
    prim_out_83149 = clBase_48700;
    prim_out_83150 = max_res_63648;
    prim_out_83151 = clProc_48706;
    prim_out_83152 = clProc_48707;
    prim_out_83153 = clProc_48709;
    prim_out_83154 = clProc_48710;
    prim_out_83155 = current_partition_48722;
    if (memblock_set_device(ctx, &*mem_out_p_86869, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86870, &mem_out_83118, "mem_out_83118") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86871, &mem_out_83119, "mem_out_83119") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86872, &mem_out_83120, "mem_out_83120") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86873, &mem_out_83121, "mem_out_83121") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86874, &mem_out_83122, "mem_out_83122") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86875, &mem_out_83123, "mem_out_83123") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86876, &mem_out_83124, "mem_out_83124") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86877, &mem_out_83125, "mem_out_83125") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86878, &mem_out_83126, "mem_out_83126") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86879, &mem_out_83127, "mem_out_83127") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86880, &mem_out_83128, "mem_out_83128") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86881, &mem_out_83129, "mem_out_83129") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86882, &mem_out_83130, "mem_out_83130") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86883, &mem_out_83131, "mem_out_83131") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86884, &mem_out_83132, "mem_out_83132") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86885, &mem_out_83133, "mem_out_83133") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86886, &mem_out_83134, "mem_out_83134") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86887, &mem_out_83135, "mem_out_83135") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86888, &mem_out_83136, "mem_out_83136") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86889, &mem_out_83137, "mem_out_83137") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86890, &mem_out_83138, "mem_out_83138") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86891, &mem_out_83139, "mem_out_83139") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86892, &mem_out_83140, "mem_out_83140") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86893, &mem_out_83141, "mem_out_83141") != 0)
        return 1;
    *out_prim_out_86894 = prim_out_83142;
    *out_prim_out_86895 = prim_out_83143;
    *out_prim_out_86896 = prim_out_83144;
    *out_prim_out_86897 = prim_out_83145;
    *out_prim_out_86898 = prim_out_83146;
    *out_prim_out_86899 = prim_out_83147;
    *out_prim_out_86900 = prim_out_83148;
    *out_prim_out_86901 = prim_out_83149;
    *out_prim_out_86902 = prim_out_83150;
    *out_prim_out_86903 = prim_out_83151;
    *out_prim_out_86904 = prim_out_83152;
    *out_prim_out_86905 = prim_out_83153;
    *out_prim_out_86906 = prim_out_83154;
    *out_prim_out_86907 = prim_out_83155;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_82906, "mem_82906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82905, "mem_82905") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82903, "mem_82903") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86784, "segred_tmp_mem_86784") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82901, "mem_82901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86749, "segred_tmp_mem_86749") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82899, "mem_82899") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86666, "segred_tmp_mem_86666") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86664, "segred_tmp_mem_86664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82831, "mem_82831") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82826, "mem_82826") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82824, "mem_82824") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82822, "mem_82822") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86535, "segred_tmp_mem_86535") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_86533, "segred_tmp_mem_86533") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82752, "mem_82752") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82747, "mem_82747") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82745, "mem_82745") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82743, "mem_82743") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82737, "mem_82737") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82734, "mem_82734") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82732, "mem_82732") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82730, "mem_82730") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82714, "mem_82714") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82712, "mem_82712") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82710, "mem_82710") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82715, "ext_mem_82715") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82716, "ext_mem_82716") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82717, "ext_mem_82717") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82707, "mem_82707") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82705, "mem_82705") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81978, "mem_81978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81977, "mem_81977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81976, "mem_81976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81975, "mem_81975") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81974, "mem_81974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81972, "mem_81972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_86333, "incprefixes_mem_86333") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_86331, "aggregates_mem_86331") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_86329, "status_flags_mem_86329") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82728, "mem_82728") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82726, "mem_82726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82724, "mem_82724") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82722, "mem_82722") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82720, "mem_82720") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_86230, "incprefixes_mem_86230") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_86228, "aggregates_mem_86228") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_86226, "status_flags_mem_86226") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82696, "mem_82696") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82693, "mem_82693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82618, "mem_82618") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82690, "mem_82690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82691, "ext_mem_82691") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82702, "ext_mem_82702") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82703, "ext_mem_82703") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82545, "mem_82545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82543, "mem_82543") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_85956, "incprefixes_mem_85956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_85954, "aggregates_mem_85954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_85952, "status_flags_mem_85952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82531, "mem_82531") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82528, "mem_82528") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82474, "mem_82474") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82472, "mem_82472") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82524, "mem_82524") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82522, "mem_82522") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82525, "ext_mem_82525") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82526, "ext_mem_82526") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82539, "ext_mem_82539") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82540, "ext_mem_82540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82541, "ext_mem_82541") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82423, "mem_82423") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82421, "mem_82421") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_85689, "incprefixes_mem_85689") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_85687, "aggregates_mem_85687") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_85685, "status_flags_mem_85685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82412, "mem_82412") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82409, "mem_82409") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82344, "mem_82344") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82406, "mem_82406") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82407, "ext_mem_82407") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82418, "ext_mem_82418") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82419, "ext_mem_82419") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82281, "mem_82281") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82279, "mem_82279") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_85415, "incprefixes_mem_85415") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_85413, "aggregates_mem_85413") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_85411, "status_flags_mem_85411") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82277, "mem_82277") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82275, "mem_82275") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82272, "mem_82272") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82269, "mem_82269") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_85294, "incprefixes_mem_85294") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_85292, "aggregates_mem_85292") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_85290, "status_flags_mem_85290") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82266, "mem_82266") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_85143, "mem_param_tmp_85143") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_85251, "segred_tmp_mem_85251") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_85146, "mem_param_tmp_85146") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82159, "mem_82159") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_85208, "segred_tmp_mem_85208") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82102, "mem_82102") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82099, "mem_82099") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82097, "mem_82097") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82095, "mem_82095") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82156, "mem_82156") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82157, "ext_mem_82157") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82092, "mem_param_82092") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82162, "ext_mem_82162") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82089, "mem_param_82089") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82167, "ext_mem_82167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82164, "mem_82164") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82086, "mem_82086") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82259, "mem_82259") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84978, "incprefixes_mem_84978") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84976, "aggregates_mem_84976") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84974, "incprefixes_mem_84974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84972, "aggregates_mem_84972") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84970, "status_flags_mem_84970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82253, "mem_82253") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82251, "mem_82251") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_84746, "mem_param_tmp_84746") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_84931, "segred_tmp_mem_84931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82246, "mem_82246") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84764, "incprefixes_mem_84764") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84762, "aggregates_mem_84762") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84760, "incprefixes_mem_84760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84758, "aggregates_mem_84758") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84756, "status_flags_mem_84756") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82235, "mem_param_82235") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82249, "ext_mem_82249") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82244, "mem_82244") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82241, "mem_82241") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82239, "mem_82239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82237, "mem_82237") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84652, "incprefixes_mem_84652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84650, "aggregates_mem_84650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84648, "status_flags_mem_84648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82257, "mem_82257") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82256, "mem_82256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84549, "incprefixes_mem_84549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84547, "aggregates_mem_84547") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84545, "status_flags_mem_84545") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82232, "mem_82232") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82231, "mem_82231") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_84506, "segred_tmp_mem_84506") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82228, "mem_82228") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82225, "mem_82225") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84378, "incprefixes_mem_84378") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84376, "aggregates_mem_84376") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84374, "status_flags_mem_84374") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82224, "mem_82224") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_84024, "mem_param_tmp_84024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82215, "mem_82215") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_84327, "segred_tmp_mem_84327") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_map_res_subhistos_mem_84207, "defunc_0_map_res_subhistos_mem_84207") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82212, "mem_82212") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82209, "mem_82209") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82207, "mem_82207") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82199, "mem_82199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82196, "mem_82196") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82183, "mem_82183") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82180, "mem_82180") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_84060, "incprefixes_mem_84060") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_84058, "aggregates_mem_84058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_84056, "status_flags_mem_84056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82205, "mem_82205") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82203, "mem_82203") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82193, "mem_82193") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82190, "mem_82190") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82188, "mem_82188") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82186, "mem_82186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82178, "mem_param_82178") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82220, "ext_mem_82220") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82172, "mem_82172") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82170, "mem_82170") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82169, "mem_82169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82263, "ext_mem_82263") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82084, "mem_82084") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82081, "mem_82081") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82079, "mem_82079") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82077, "mem_82077") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83916, "incprefixes_mem_83916") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83914, "aggregates_mem_83914") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83912, "status_flags_mem_83912") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82075, "mem_82075") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82073, "mem_82073") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82070, "mem_82070") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82067, "ext_mem_82067") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82060, "mem_82060") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82058, "mem_82058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82056, "mem_82056") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83779, "incprefixes_mem_83779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83777, "aggregates_mem_83777") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83775, "status_flags_mem_83775") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82054, "mem_82054") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82052, "mem_82052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82063, "mem_82063") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82062, "mem_82062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82064, "ext_mem_82064") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82065, "ext_mem_82065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82066, "ext_mem_82066") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82048, "mem_82048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82046, "mem_82046") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82044, "mem_82044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83661, "incprefixes_mem_83661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83659, "aggregates_mem_83659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83657, "status_flags_mem_83657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82042, "mem_82042") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82041, "mem_82041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82039, "mem_82039") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82036, "ext_mem_82036") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82035, "ext_mem_82035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82033, "mem_82033") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82030, "mem_82030") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82028, "ext_mem_82028") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82026, "mem_82026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82024, "mem_82024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82022, "mem_82022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82021, "mem_82021") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82019, "mem_82019") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83498, "incprefixes_mem_83498") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83496, "aggregates_mem_83496") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83494, "incprefixes_mem_83494") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83492, "aggregates_mem_83492") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83490, "status_flags_mem_83490") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82017, "mem_82017") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82015, "mem_82015") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82013, "mem_82013") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82009, "mem_82009") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82007, "mem_82007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82005, "mem_82005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82004, "mem_82004") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82002, "mem_82002") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83378, "incprefixes_mem_83378") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83376, "aggregates_mem_83376") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83374, "status_flags_mem_83374") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82000, "mem_82000") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81998, "mem_81998") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81997, "mem_81997") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81995, "mem_81995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81992, "mem_81992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81991, "mem_81991") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81990, "ext_mem_81990") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81989, "ext_mem_81989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81988, "ext_mem_81988") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81987, "ext_mem_81987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81986, "mem_81986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81985, "mem_81985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81984, "mem_81984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81983, "mem_81983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81982, "mem_81982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81981, "mem_81981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81980, "mem_81980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81979, "mem_81979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81970, "mem_81970") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81968, "ext_mem_81968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81966, "mem_81966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81964, "mem_81964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81962, "mem_81962") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81960, "mem_81960") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81958, "mem_81958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83188, "incprefixes_mem_83188") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83186, "aggregates_mem_83186") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83164, "status_flags_mem_83164") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81956, "mem_81956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83141, "mem_out_83141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83140, "mem_out_83140") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83139, "mem_out_83139") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83138, "mem_out_83138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83137, "mem_out_83137") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83136, "mem_out_83136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83135, "mem_out_83135") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83134, "mem_out_83134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83133, "mem_out_83133") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83132, "mem_out_83132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83131, "mem_out_83131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83130, "mem_out_83130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83129, "mem_out_83129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83128, "mem_out_83128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83127, "mem_out_83127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83126, "mem_out_83126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83125, "mem_out_83125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83124, "mem_out_83124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83123, "mem_out_83123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83122, "mem_out_83122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83121, "mem_out_83121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83120, "mem_out_83120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83119, "mem_out_83119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83118, "mem_out_83118") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_flush_dat_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86944, struct memblock_device *mem_out_p_86945, struct memblock_device *mem_out_p_86946, int64_t *out_prim_out_86947, int64_t *out_prim_out_86948, int64_t *out_prim_out_86949, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_37051, int64_t part_no_37052, int64_t dz2084U_37053, int64_t dz2080U_37054, int64_t dz2081U_37055, int64_t dz2082U_37056, int64_t dz2083U_37057, int64_t dz2085U_37058, int64_t dz2086U_37059, int8_t clBase_37062, int8_t clBase_37063, double clBase_37064, int64_t clBase_37065, int64_t clBase_37067, double clBase_37070, int64_t clBase_37072, int64_t clProc_37077, int64_t clProc_37078, int64_t clProc_37079, int64_t clProc_37081, int64_t clProc_37082, int64_t current_partition_37094, bool total_37098)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_81963;
    
    mem_81963.references = NULL;
    
    struct memblock_device ext_mem_81964;
    
    ext_mem_81964.references = NULL;
    
    struct memblock_device mem_81955;
    
    mem_81955.references = NULL;
    
    struct memblock_device mem_81953;
    
    mem_81953.references = NULL;
    
    struct memblock_device mem_81959;
    
    mem_81959.references = NULL;
    
    struct memblock_device mem_81957;
    
    mem_81957.references = NULL;
    
    struct memblock_device ext_mem_81960;
    
    ext_mem_81960.references = NULL;
    
    struct memblock_device ext_mem_81961;
    
    ext_mem_81961.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83120;
    int64_t prim_out_83121;
    int64_t prim_out_83122;
    int64_t dzlz7bUZLzpZRz20Udz2085Uz20Udz2082Uz7dUzg_53094 = add64(dz2082U_37056, dz2085U_37058);
    int64_t dzlz7bUZLzpZRz20UZLZLzpZRz20Udz2085Uz20Udz2082UZRz20Unz7dUzg_53095 = add64(n_37051, dzlz7bUZLzpZRz20Udz2085Uz20Udz2082Uz7dUzg_53094);
    bool cond_53096 = !total_37098;
    bool eq_x_zz_53114 = dz2085U_37058 == dzlz7bUZLzpZRz20UZLZLzpZRz20Udz2085Uz20Udz2082UZRz20Unz7dUzg_53095;
    bool p_and_eq_x_y_53115 = total_37098 && eq_x_zz_53114;
    bool eq_x_y_53116 = cond_53096 || p_and_eq_x_y_53115;
    bool eq_x_y_53117 = dzlz7bUZLzpZRz20UZLZLzpZRz20Udz2085Uz20Udz2082UZRz20Unz7dUzg_53095 == dz2085U_37058;
    bool p_and_eq_x_y_53118 = cond_53096 && eq_x_y_53117;
    bool eq_x_zz_53119 = total_37098 || p_and_eq_x_y_53118;
    bool p_and_eq_x_y_53120 = cond_53096 && eq_x_y_53116;
    bool p_and_eq_x_y_53121 = total_37098 && eq_x_zz_53119;
    bool dim_match_53122 = p_and_eq_x_y_53120 || p_and_eq_x_y_53121;
    bool empty_or_match_cert_53123;
    
    if (!dim_match_53122) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ft_libs/ftDBSCAN_plus.fut:477:17-490:85\n   #1  ft_libs/ftDBSCAN_plus.fut:1045:18-1048:60\n   #2  ft_libs/ftDBSCAN_plus.fut:1044:9-1048:60\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flush_dat_res_53097;
    
    if (cond_53096) {
        flush_dat_res_53097 = dz2085U_37058;
    } else {
        flush_dat_res_53097 = dzlz7bUZLzpZRz20UZLZLzpZRz20Udz2085Uz20Udz2082UZRz20Unz7dUzg_53095;
    }
    
    int64_t bytes_81952 = (int64_t) 8 * flush_dat_res_53097;
    int64_t bytes_81956 = (int64_t) 8 * dz2085U_37058;
    
    if (cond_53096) {
        if (memblock_alloc_device(ctx, &mem_81957, bytes_81956, "mem_81957")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81957.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, toFlush_dat_mem_81949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2085U_37058})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_81959, bytes_81956, "mem_81959")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81959.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, toFlush_dat_mem_81950.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2085U_37058})) != 0)
            goto cleanup;
        if (memblock_set_device(ctx, &ext_mem_81961, &mem_81957, "mem_81957") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81960, &mem_81959, "mem_81959") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81953, bytes_81952, "mem_81953")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_83123 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81953.mem, tmp_offs_83123, (int64_t []) {(int64_t) 1}, toFlush_dat_mem_81949.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2085U_37058})) != 0)
            goto cleanup;
        tmp_offs_83123 += dz2085U_37058;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81953.mem, tmp_offs_83123, (int64_t []) {(int64_t) 1}, clProc_mem_81935.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_37056})) != 0)
            goto cleanup;
        tmp_offs_83123 += dz2082U_37056;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81953.mem, tmp_offs_83123, (int64_t []) {(int64_t) 1}, current_partition_mem_81940.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_37051})) != 0)
            goto cleanup;
        tmp_offs_83123 += n_37051;
        if (memblock_alloc_device(ctx, &mem_81955, bytes_81952, "mem_81955")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_83124 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81955.mem, tmp_offs_83124, (int64_t []) {(int64_t) 1}, toFlush_dat_mem_81950.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2085U_37058})) != 0)
            goto cleanup;
        tmp_offs_83124 += dz2085U_37058;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81955.mem, tmp_offs_83124, (int64_t []) {(int64_t) 1}, clProc_mem_81936.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_37056})) != 0)
            goto cleanup;
        tmp_offs_83124 += dz2082U_37056;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81955.mem, tmp_offs_83124, (int64_t []) {(int64_t) 1}, current_partition_mem_81941.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_37051})) != 0)
            goto cleanup;
        tmp_offs_83124 += n_37051;
        if (memblock_set_device(ctx, &ext_mem_81961, &mem_81953, "mem_81953") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81960, &mem_81955, "mem_81955") != 0)
            return 1;
    }
    
    int64_t conc_tmp_53108 = dz2081U_37055 + dz2086U_37059;
    int64_t conc_tmp_53109 = n_37051 + conc_tmp_53108;
    int64_t cids_53110;
    
    if (cond_53096) {
        cids_53110 = dz2086U_37059;
    } else {
        cids_53110 = conc_tmp_53109;
    }
    
    int64_t bytes_81962 = (int64_t) 8 * cids_53110;
    
    if (cond_53096) {
        if (memblock_set_device(ctx, &ext_mem_81964, &toFlush_ids_mem_81951, "toFlush_ids_mem_81951") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81963, bytes_81962, "mem_81963")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t tmp_offs_83125 = (int64_t) 0;
        
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81963.mem, tmp_offs_83125, (int64_t []) {(int64_t) 1}, toFlush_ids_mem_81951.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2086U_37059})) != 0)
            goto cleanup;
        tmp_offs_83125 += dz2086U_37059;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81963.mem, tmp_offs_83125, (int64_t []) {(int64_t) 1}, clProc_mem_81934.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2081U_37055})) != 0)
            goto cleanup;
        tmp_offs_83125 += dz2081U_37055;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_81963.mem, tmp_offs_83125, (int64_t []) {(int64_t) 1}, current_partition_mem_81939.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_37051})) != 0)
            goto cleanup;
        tmp_offs_83125 += n_37051;
        if (memblock_set_device(ctx, &ext_mem_81964, &mem_81963, "mem_81963") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &mem_out_83117, &ext_mem_81964, "ext_mem_81964") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83118, &ext_mem_81961, "ext_mem_81961") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83119, &ext_mem_81960, "ext_mem_81960") != 0)
        return 1;
    prim_out_83120 = cids_53110;
    prim_out_83121 = flush_dat_res_53097;
    prim_out_83122 = flush_dat_res_53097;
    if (memblock_set_device(ctx, &*mem_out_p_86944, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86945, &mem_out_83118, "mem_out_83118") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86946, &mem_out_83119, "mem_out_83119") != 0)
        return 1;
    *out_prim_out_86947 = prim_out_83120;
    *out_prim_out_86948 = prim_out_83121;
    *out_prim_out_86949 = prim_out_83122;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81964, "ext_mem_81964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81955, "mem_81955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81953, "mem_81953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81959, "mem_81959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81957, "mem_81957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81960, "ext_mem_81960") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81961, "ext_mem_81961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83119, "mem_out_83119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83118, "mem_out_83118") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_make_collisions_compact_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86950, struct memblock_device *mem_out_p_86951, int64_t *out_prim_out_86952, int64_t *out_prim_out_86953, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_51540, int64_t part_no_51541, int64_t dz2084U_51542, int64_t dz2080U_51543, int64_t dz2081U_51544, int64_t dz2082U_51545, int64_t dz2083U_51546, int64_t dz2085U_51547, int64_t dz2086U_51548, int8_t clBase_51551, int8_t clBase_51552, double clBase_51553, int64_t clBase_51554, int64_t clBase_51556, double clBase_51559, int64_t clBase_51561, int64_t clProc_51566, int64_t clProc_51567, int64_t clProc_51568, int64_t clProc_51570, int64_t clProc_51571, int64_t current_partition_51583)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_82428;
    
    mem_82428.references = NULL;
    
    struct memblock_device mem_82426;
    
    mem_82426.references = NULL;
    
    struct memblock_device incprefixes_mem_83620;
    
    incprefixes_mem_83620.references = NULL;
    
    struct memblock_device aggregates_mem_83618;
    
    aggregates_mem_83618.references = NULL;
    
    struct memblock_device status_flags_mem_83596;
    
    status_flags_mem_83596.references = NULL;
    
    struct memblock_device mem_82424;
    
    mem_82424.references = NULL;
    
    struct memblock_device mem_82422;
    
    mem_82422.references = NULL;
    
    struct memblock_device mem_param_tmp_83275;
    
    mem_param_tmp_83275.references = NULL;
    
    struct memblock_device mem_param_tmp_83274;
    
    mem_param_tmp_83274.references = NULL;
    
    struct memblock_device mem_82406;
    
    mem_82406.references = NULL;
    
    struct memblock_device mem_82402;
    
    mem_82402.references = NULL;
    
    struct memblock_device mem_82197;
    
    mem_82197.references = NULL;
    
    struct memblock_device mem_82194;
    
    mem_82194.references = NULL;
    
    struct memblock_device mem_82190;
    
    mem_82190.references = NULL;
    
    struct memblock_device mem_82185;
    
    mem_82185.references = NULL;
    
    struct memblock_device mem_82181;
    
    mem_82181.references = NULL;
    
    struct memblock_device mem_82164;
    
    mem_82164.references = NULL;
    
    struct memblock_device mem_82128;
    
    mem_82128.references = NULL;
    
    struct memblock_device mem_82111;
    
    mem_82111.references = NULL;
    
    struct memblock_device mem_82094;
    
    mem_82094.references = NULL;
    
    struct memblock_device mem_82090;
    
    mem_82090.references = NULL;
    
    struct memblock_device mem_82086;
    
    mem_82086.references = NULL;
    
    struct memblock_device mem_82085;
    
    mem_82085.references = NULL;
    
    struct memblock_device mem_82082;
    
    mem_82082.references = NULL;
    
    struct memblock_device mem_82081;
    
    mem_82081.references = NULL;
    
    struct memblock_device mem_82078;
    
    mem_82078.references = NULL;
    
    struct memblock_device mem_82075;
    
    mem_82075.references = NULL;
    
    struct memblock_device mem_82072;
    
    mem_82072.references = NULL;
    
    struct memblock_device mem_82069;
    
    mem_82069.references = NULL;
    
    struct memblock_device mem_82065;
    
    mem_82065.references = NULL;
    
    struct memblock_device mem_82062;
    
    mem_82062.references = NULL;
    
    struct memblock_device mem_82246;
    
    mem_82246.references = NULL;
    
    struct memblock_device mem_82243;
    
    mem_82243.references = NULL;
    
    struct memblock_device ext_mem_82247;
    
    ext_mem_82247.references = NULL;
    
    struct memblock_device ext_mem_82248;
    
    ext_mem_82248.references = NULL;
    
    struct memblock_device mem_82316;
    
    mem_82316.references = NULL;
    
    struct memblock_device mem_82305;
    
    mem_82305.references = NULL;
    
    struct memblock_device mem_82281;
    
    mem_82281.references = NULL;
    
    struct memblock_device mem_82270;
    
    mem_82270.references = NULL;
    
    struct memblock_device mem_82259;
    
    mem_82259.references = NULL;
    
    struct memblock_device mem_82256;
    
    mem_82256.references = NULL;
    
    struct memblock_device mem_82253;
    
    mem_82253.references = NULL;
    
    struct memblock_device mem_82251;
    
    mem_82251.references = NULL;
    
    struct memblock_device ext_mem_82319;
    
    ext_mem_82319.references = NULL;
    
    struct memblock_device ext_mem_82322;
    
    ext_mem_82322.references = NULL;
    
    struct memblock_device mem_82058;
    
    mem_82058.references = NULL;
    
    struct memblock_device mem_82057;
    
    mem_82057.references = NULL;
    
    struct memblock_device mem_82393;
    
    mem_82393.references = NULL;
    
    struct memblock_device mem_82390;
    
    mem_82390.references = NULL;
    
    struct memblock_device ext_mem_82396;
    
    ext_mem_82396.references = NULL;
    
    struct memblock_device ext_mem_82399;
    
    ext_mem_82399.references = NULL;
    
    struct memblock_device mem_param_82055;
    
    mem_param_82055.references = NULL;
    
    struct memblock_device mem_param_82052;
    
    mem_param_82052.references = NULL;
    
    struct memblock_device ext_mem_82412;
    
    ext_mem_82412.references = NULL;
    
    struct memblock_device ext_mem_82413;
    
    ext_mem_82413.references = NULL;
    
    struct memblock_device mem_82048;
    
    mem_82048.references = NULL;
    
    struct memblock_device mem_82044;
    
    mem_82044.references = NULL;
    
    struct memblock_device mem_82035;
    
    mem_82035.references = NULL;
    
    struct memblock_device mem_82024;
    
    mem_82024.references = NULL;
    
    struct memblock_device mem_81988;
    
    mem_81988.references = NULL;
    
    struct memblock_device mem_81977;
    
    mem_81977.references = NULL;
    
    struct memblock_device ext_mem_82038;
    
    ext_mem_82038.references = NULL;
    
    struct memblock_device ext_mem_82041;
    
    ext_mem_82041.references = NULL;
    
    struct memblock_device mem_81966;
    
    mem_81966.references = NULL;
    
    struct memblock_device mem_81963;
    
    mem_81963.references = NULL;
    
    struct memblock_device ext_mem_82416;
    
    ext_mem_82416.references = NULL;
    
    struct memblock_device ext_mem_82419;
    
    ext_mem_82419.references = NULL;
    
    struct memblock_device mem_81952;
    
    mem_81952.references = NULL;
    
    struct memblock_device mem_81957;
    
    mem_81957.references = NULL;
    
    struct memblock_device mem_81956;
    
    mem_81956.references = NULL;
    
    struct memblock_device segred_tmp_mem_83155;
    
    segred_tmp_mem_83155.references = NULL;
    
    struct memblock_device segred_tmp_mem_83153;
    
    segred_tmp_mem_83153.references = NULL;
    
    struct memblock_device mem_81955;
    
    mem_81955.references = NULL;
    
    struct memblock_device mem_81954;
    
    mem_81954.references = NULL;
    
    struct memblock_device ext_mem_81958;
    
    ext_mem_81958.references = NULL;
    
    struct memblock_device ext_mem_81959;
    
    ext_mem_81959.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83119;
    int64_t prim_out_83120;
    bool cond_59472 = sle64(dz2084U_51542, (int64_t) 1);
    int64_t zs_lhs_59473 = sub64(dz2084U_51542, (int64_t) 1);
    int64_t zp_rhs_59474 = sdiv_safe64(zs_lhs_59473, (int64_t) 20);
    int64_t min_num_blocks_59475 = add64((int64_t) 1, zp_rhs_59474);
    bool loop_cond_59476 = slt64((int64_t) 1, min_num_blocks_59475);
    bool smallest_pow_2_geq_than_res_59477;
    int64_t smallest_pow_2_geq_than_res_59478;
    bool loop_while_59479;
    int64_t x_59480;
    
    loop_while_59479 = loop_cond_59476;
    x_59480 = (int64_t) 1;
    while (loop_while_59479) {
        int64_t loopres_59481 = mul64((int64_t) 2, x_59480);
        bool loop_cond_59482 = slt64(loopres_59481, min_num_blocks_59475);
        bool loop_while_tmp_83121 = loop_cond_59482;
        int64_t x_tmp_83122 = loopres_59481;
        
        loop_while_59479 = loop_while_tmp_83121;
        x_59480 = x_tmp_83122;
    }
    smallest_pow_2_geq_than_res_59477 = loop_while_59479;
    smallest_pow_2_geq_than_res_59478 = x_59480;
    
    bool zzero_59483 = smallest_pow_2_geq_than_res_59478 == (int64_t) 0;
    bool nonzzero_59484 = !zzero_59483;
    bool protect_assert_disj_59485 = cond_59472 || nonzzero_59484;
    bool nonzzero_cert_59486;
    
    if (!protect_assert_disj_59485) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #4  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_59487 = sdiv_safe64(zs_lhs_59473, smallest_pow_2_geq_than_res_59478);
    int64_t block_sizze_59488 = add64((int64_t) 1, zp_rhs_59487);
    int64_t flat_dim_59489 = smallest_pow_2_geq_than_res_59478 * block_sizze_59488;
    bool x_63665 = !cond_59472;
    int64_t greatest_divisor_leq_than_arg1_59492 = mul64((int64_t) 2, block_sizze_59488);
    bool cond_59493 = slt64((int64_t) 8, greatest_divisor_leq_than_arg1_59492);
    int64_t d_59495;
    
    if (x_63665) {
        bool x_63976;
        int64_t x_63977;
        bool loop_while_63978;
        int64_t d_63979;
        
        loop_while_63978 = cond_59493;
        d_63979 = (int64_t) 1;
        while (loop_while_63978) {
            int64_t loopres_63980 = add64((int64_t) 1, d_63979);
            bool zzero_63981 = loopres_63980 == (int64_t) 0;
            bool nonzzero_63982 = !zzero_63981;
            bool nonzzero_cert_63983;
            
            if (!nonzzero_63982) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:238:5-65\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #5  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zg_lhs_63984 = sdiv64(greatest_divisor_leq_than_arg1_59492, loopres_63980);
            bool cond_63985 = slt64((int64_t) 8, zg_lhs_63984);
            bool loop_cond_63986;
            
            if (cond_63985) {
                loop_cond_63986 = 1;
            } else {
                int64_t znze_lhs_63987 = smod64(greatest_divisor_leq_than_arg1_59492, loopres_63980);
                bool loop_cond_f_res_63988 = znze_lhs_63987 == (int64_t) 0;
                bool loop_cond_f_res_63989 = !loop_cond_f_res_63988;
                
                loop_cond_63986 = loop_cond_f_res_63989;
            }
            
            bool loop_while_tmp_83123 = loop_cond_63986;
            int64_t d_tmp_83124 = loopres_63980;
            
            loop_while_63978 = loop_while_tmp_83123;
            d_63979 = d_tmp_83124;
        }
        x_63976 = loop_while_63978;
        x_63977 = d_63979;
        d_59495 = x_63977;
    } else {
        d_59495 = (int64_t) 0;
    }
    
    bool zzero_59508 = d_59495 == (int64_t) 0;
    bool nonzzero_59509 = !zzero_59508;
    bool protect_assert_disj_63672 = cond_59472 || nonzzero_59509;
    bool nonzzero_cert_59510;
    
    if (!protect_assert_disj_63672) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:238:5-65\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #5  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_59511 = sdiv_safe64(greatest_divisor_leq_than_arg1_59492, d_59495);
    bool y_59512 = slt64((int64_t) 0, dz2084U_51542);
    bool protect_assert_disj_63674 = cond_59472 || y_59512;
    bool index_certs_59513;
    
    if (!protect_assert_disj_63674) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2084U_51542, "].", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #4  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t reduce_arg1_59514;
    
    if (x_63665) {
        int64_t read_res_86954;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86954, chain_collisions_mem_81927.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_63990 = read_res_86954;
        
        reduce_arg1_59514 = x_63990;
    } else {
        reduce_arg1_59514 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_59515;
    
    if (x_63665) {
        int64_t read_res_86955;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86955, chain_collisions_mem_81928.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_63991 = read_res_86955;
        
        reduce_arg1_59515 = x_63991;
    } else {
        reduce_arg1_59515 = (int64_t) 0;
    }
    if (x_63665) {
        int64_t segred_tblock_sizze_70902;
        
        segred_tblock_sizze_70902 = *ctx->tuning_params.make_collisions_compact_doublezisegred_tblock_sizze_70901;
        
        int64_t num_tblocks_70904;
        int64_t max_num_tblocks_83125;
        
        max_num_tblocks_83125 = *ctx->tuning_params.make_collisions_compact_doublezisegred_num_tblocks_70903;
        num_tblocks_70904 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2084U_51542, segred_tblock_sizze_70902), max_num_tblocks_83125)));
        if (memblock_alloc_device(ctx, &mem_81954, (int64_t) 8, "mem_81954")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_81955, (int64_t) 8, "mem_81955")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegRed");
        
        int64_t shared_memory_83126;
        
        shared_memory_83126 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83127;
        
        thread_block_sizze_83127 = ctx->max_thread_block_size;
        
        int64_t registers_83128;
        
        registers_83128 = ctx->max_registers;
        
        int64_t thread_block_sizze_83129;
        
        thread_block_sizze_83129 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83130 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83126, thread_block_sizze_83127), (int64_t) 8), squot64(squot64(registers_83128, thread_block_sizze_83129) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8) + smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        
        if (memblock_alloc_device(ctx, &segred_tmp_mem_83153, (int64_t) 8 * num_tblocks_70904, "segred_tmp_mem_83153")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &segred_tmp_mem_83155, (int64_t) 8 * num_tblocks_70904, "segred_tmp_mem_83155")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_threads_83157 = num_tblocks_70904 * segred_tblock_sizze_70902;
        
        {
            err = gpu_kernel_make_collisions_compact_doublezisegred_nonseg_70910(ctx, num_tblocks_70904, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegred_tblock_sizze_70901, 1, 1, 8 + (smax64(segred_tblock_sizze_70902 * chunk_sizze_83130 * (int64_t) 8, sdiv_up64(segred_tblock_sizze_70902 * (int64_t) 8, (int64_t) 8) * (int64_t) 8 + segred_tblock_sizze_70902 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(segred_tblock_sizze_70902 * chunk_sizze_83130 * (int64_t) 8, sdiv_up64(segred_tblock_sizze_70902 * (int64_t) 8, (int64_t) 8) * (int64_t) 8 + segred_tblock_sizze_70902 * (int64_t) 8), (int64_t) 8), (int64_t) 8)), dz2084U_51542, reduce_arg1_59514, reduce_arg1_59515, num_tblocks_70904, chain_collisions_mem_81927.mem, chain_collisions_mem_81928.mem, mem_81954.mem, mem_81955.mem, counters_mem_83131.mem, segred_tmp_mem_83153.mem, segred_tmp_mem_83155.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_alloc_device(ctx, &mem_81956, (int64_t) 8, "mem_81956")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_81957, (int64_t) 8, "mem_81957")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_make_collisions_compact_doublezigpuseq_83217(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_81954.mem, mem_81955.mem, mem_81956.mem, mem_81957.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81955, "mem_81955") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81959, &mem_81956, "mem_81956") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81958, &mem_81957, "mem_81957") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81952, (int64_t) 8, "mem_81952")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_81952, (int64_t) 1, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_81959, &mem_81952, "mem_81952") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81958, &mem_81952, "mem_81952") != 0)
            return 1;
    }
    
    bool bounds_invalid_upwards_59527 = slt64(smallest_pow_2_geq_than_res_59478, (int64_t) 0);
    bool valid_59528 = !bounds_invalid_upwards_59527;
    bool protect_assert_disj_63684 = cond_59472 || valid_59528;
    bool range_valid_c_59529;
    
    if (!protect_assert_disj_63684) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_59478, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #6  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_59531 = slt64(block_sizze_59488, (int64_t) 0);
    bool valid_59532 = !bounds_invalid_upwards_59531;
    bool protect_assert_disj_63686 = cond_59472 || valid_59532;
    bool range_valid_c_59533;
    
    if (!protect_assert_disj_63686) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_59488, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_59535 = sle64(block_sizze_59488, (int64_t) 1);
    int64_t tmp_59536 = sub64(block_sizze_59488, (int64_t) 2);
    bool bounds_invalid_upwards_59537 = slt64(tmp_59536, (int64_t) 0);
    int64_t distance_59538 = add64((int64_t) 1, tmp_59536);
    bool valid_59539 = !bounds_invalid_upwards_59537;
    bool protect_assert_disj_59540 = cond_59535 || valid_59539;
    bool protect_assert_disj_63688 = cond_59472 || protect_assert_disj_59540;
    bool range_valid_c_59541;
    
    if (!protect_assert_disj_63688) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_59536, " is invalid.", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_59619 = slt64(block_sizze_59488, flat_dim_59489);
    bool zzero_59620 = greatest_divisor_leq_than_res_59511 == (int64_t) 0;
    bool nonzzero_59621 = !zzero_59620;
    bool empty_slice_60003 = dz2084U_51542 == (int64_t) 0;
    bool zzero_leq_i_p_m_t_s_60004 = sle64((int64_t) 0, zs_lhs_59473);
    int64_t segmap_tblock_sizze_71183;
    
    segmap_tblock_sizze_71183 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_71122;
    
    int64_t segmap_usable_groups_71184 = sdiv_up_safe64(flat_dim_59489, segmap_tblock_sizze_71183);
    int64_t segmap_tblock_sizze_71208;
    
    segmap_tblock_sizze_71208 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_70979;
    
    int64_t num_tblocks_71209;
    int64_t max_num_tblocks_83243;
    
    max_num_tblocks_83243 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_70981;
    num_tblocks_71209 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(smallest_pow_2_geq_than_res_59478, segmap_tblock_sizze_71208), max_num_tblocks_83243)));
    
    int64_t max_tblock_sizze_71517;
    
    max_tblock_sizze_71517 = ctx->max_thread_block_size;
    
    int64_t segmap_tblock_sizze_73711;
    
    segmap_tblock_sizze_73711 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73685;
    
    int64_t binop_x_81961 = (int64_t) 8 * smallest_pow_2_geq_than_res_59478;
    int64_t bytes_81962 = block_sizze_59488 * binop_x_81961;
    int64_t ext_82040;
    
    if (cond_59535) {
        ext_82040 = block_sizze_59488;
    } else {
        ext_82040 = (int64_t) 1;
    }
    
    int64_t ext_82039;
    
    if (cond_59535) {
        ext_82039 = (int64_t) 1;
    } else {
        ext_82039 = smallest_pow_2_geq_than_res_59478;
    }
    
    int64_t binop_y_81967 = smallest_pow_2_geq_than_res_59478 - (int64_t) 1;
    int64_t binop_x_81969 = smax64((int64_t) 0, binop_y_81967);
    int64_t binop_x_81971 = smax64((int64_t) 0, zp_rhs_59487);
    int64_t binop_y_81972 = smallest_pow_2_geq_than_res_59478 * binop_x_81971;
    int64_t binop_y_81973 = smax64((int64_t) 0, binop_y_81972);
    int64_t binop_y_81974 = binop_x_81969 + binop_y_81973;
    int64_t binop_y_81975 = (int64_t) 1 + binop_y_81974;
    int64_t bytes_81976 = (int64_t) 8 * binop_y_81975;
    int64_t segmap_tblock_sizze_74089;
    
    segmap_tblock_sizze_74089 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73167;
    
    int64_t segmap_tblock_sizze_74206;
    
    segmap_tblock_sizze_74206 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72938;
    
    int64_t segmap_tblock_sizze_74286;
    
    segmap_tblock_sizze_74286 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72856;
    
    int64_t binop_x_82087 = (int64_t) 8 * greatest_divisor_leq_than_res_59511;
    int64_t binop_y_82103 = greatest_divisor_leq_than_res_59511 - (int64_t) 1;
    int64_t binop_x_82104 = smax64((int64_t) 0, binop_y_82103);
    
    if (cond_59472) {
        if (memblock_set_device(ctx, &ext_mem_82419, &chain_collisions_mem_81927, "chain_collisions_mem_81927") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82416, &chain_collisions_mem_81928, "chain_collisions_mem_81928") != 0)
            return 1;
    } else {
        if (memblock_alloc_device(ctx, &mem_81963, bytes_81962, "mem_81963")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_81966, bytes_81962, "mem_81966")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_83244 = sext_i64_i32(sdiv_up64(smallest_pow_2_geq_than_res_59478 * block_sizze_59488, segmap_tblock_sizze_71183));
        
        {
            err = gpu_kernel_make_collisions_compact_doublezisegmap_71189(ctx, segmap_usable_groups_71184, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_71122, 1, 1, (int64_t) 0, dz2084U_51542, smallest_pow_2_geq_than_res_59478, block_sizze_59488, chain_collisions_mem_81927.mem, chain_collisions_mem_81928.mem, ext_mem_81958.mem, ext_mem_81959.mem, mem_81963.mem, mem_81966.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (cond_59535) {
            if (memblock_set_device(ctx, &ext_mem_82041, &mem_81963, "mem_81963") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82038, &mem_81966, "mem_81966") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_81977, bytes_81976, "mem_81977")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_81977.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, smallest_pow_2_geq_than_res_59478}, mem_81963.mem, (int64_t) 0, (int64_t []) {block_sizze_59488, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_59478, block_sizze_59488})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &mem_81988, bytes_81976, "mem_81988")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_81988.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, smallest_pow_2_geq_than_res_59478}, mem_81966.mem, (int64_t) 0, (int64_t []) {block_sizze_59488, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_59478, block_sizze_59488})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &mem_82024, bytes_81976, "mem_82024")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_82035, bytes_81976, "mem_82035")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83255 = sext_i64_i32(sdiv_up64(smallest_pow_2_geq_than_res_59478, segmap_tblock_sizze_71208));
            
            {
                err = gpu_kernel_make_collisions_compact_doublezisegmap_71214(ctx, num_tblocks_71209, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_70979, 1, 1, (int64_t) 0, smallest_pow_2_geq_than_res_59478, block_sizze_59488, distance_59538, num_tblocks_71209, virt_num_tblocks_83255, mem_81977.mem, mem_81988.mem, mem_82024.mem, mem_82035.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_81977, "mem_81977") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_81988, "mem_81988") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82041, &mem_82024, "mem_82024") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_82038, &mem_82035, "mem_82035") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81966, "mem_81966") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_82044, bytes_81962, "mem_82044")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82044.mem, (int64_t) 0, (int64_t []) {block_sizze_59488, (int64_t) 1}, ext_mem_82041.mem, (int64_t) 0, (int64_t []) {ext_82040, ext_82039}, (int64_t []) {smallest_pow_2_geq_than_res_59478, block_sizze_59488})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &ext_mem_82041, "ext_mem_82041") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_82048, bytes_81962, "mem_82048")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82048.mem, (int64_t) 0, (int64_t []) {block_sizze_59488, (int64_t) 1}, ext_mem_82038.mem, (int64_t) 0, (int64_t []) {ext_82040, ext_82039}, (int64_t []) {smallest_pow_2_geq_than_res_59478, block_sizze_59488})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &ext_mem_82038, "ext_mem_82038") != 0)
            return 1;
        
        int64_t data_59622;
        bool data_59623;
        int64_t data_59626;
        int64_t loop_dz2084Uz2082U_59627;
        bool loop_while_59628;
        int64_t stride_59631;
        
        if (memblock_set_device(ctx, &mem_param_82052, &mem_82044, "mem_82044") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_82055, &mem_82048, "mem_82048") != 0)
            return 1;
        loop_dz2084Uz2082U_59627 = flat_dim_59489;
        loop_while_59628 = loop_cond_59619;
        stride_59631 = block_sizze_59488;
        while (loop_while_59628) {
            int64_t next_stride_59632 = mul64((int64_t) 2, stride_59631);
            bool zzero_59633 = next_stride_59632 == (int64_t) 0;
            bool nonzzero_59634 = !zzero_59633;
            bool nonzzero_cert_59635;
            
            if (!nonzzero_59634) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #4  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_59636 = sdiv64(flat_dim_59489, next_stride_59632);
            bool bounds_invalid_upwards_59637 = slt64(num_merges_59636, (int64_t) 0);
            bool valid_59638 = !bounds_invalid_upwards_59637;
            bool range_valid_c_59639;
            
            if (!valid_59638) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_59636, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #6  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_59641 = sub64(next_stride_59632, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_59642 = sle64((int64_t) 0, m_59641);
            bool cond_59644 = slt64(next_stride_59632, (int64_t) 10);
            bool protect_assert_disj_59645 = nonzzero_59621 || cond_59644;
            bool nonzzero_cert_59646;
            
            if (!protect_assert_disj_59645) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_59647 = smod_safe64(next_stride_59632, greatest_divisor_leq_than_res_59511);
            bool num_blocks_59648 = zeze_lhs_59647 == (int64_t) 0;
            bool protect_assert_disj_59649 = cond_59644 || num_blocks_59648;
            bool assert_c_59650;
            
            if (!protect_assert_disj_59649) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_59653 = sdiv_safe64(next_stride_59632, greatest_divisor_leq_than_res_59511);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 = add64((int64_t) 1, num_blocks_59653);
            int64_t j_m_i_59655 = sub64(next_stride_59632, stride_59631);
            int64_t flat_dim_59656 = greatest_divisor_leq_than_res_59511 * num_blocks_59653;
            bool bounds_invalid_upwards_59657 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, (int64_t) 0);
            bool zzero_lte_i_59658 = sle64((int64_t) 0, stride_59631);
            bool i_lte_j_59659 = sle64(stride_59631, next_stride_59632);
            bool empty_slice_59660 = stride_59631 == (int64_t) 0;
            int64_t m_59661 = sub64(stride_59631, (int64_t) 1);
            bool bounds_invalid_upwards_59662 = slt64(num_blocks_59653, (int64_t) 0);
            bool empty_slice_59663 = j_m_i_59655 == (int64_t) 0;
            int64_t m_59664 = sub64(j_m_i_59655, (int64_t) 1);
            bool cond_59665 = slt64((int64_t) 0, stride_59631);
            bool valid_59666 = !bounds_invalid_upwards_59657;
            bool zzero_leq_i_p_m_t_s_59667 = sle64((int64_t) 0, m_59661);
            bool i_p_m_t_s_leq_w_59668 = slt64(m_59661, next_stride_59632);
            bool valid_59669 = !bounds_invalid_upwards_59662;
            bool i_p_m_t_s_leq_w_59670 = slt64(m_59641, flat_dim_59656);
            int64_t i_p_m_t_s_59671 = add64(stride_59631, m_59664);
            bool y_59672 = slt64((int64_t) 0, j_m_i_59655);
            bool protect_assert_disj_59673 = cond_59644 || valid_59666;
            bool range_valid_c_59674;
            
            if (!protect_assert_disj_59673) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_59675 = zzero_leq_i_p_m_t_s_59667 && i_p_m_t_s_leq_w_59668;
            bool protect_assert_disj_59676 = cond_59644 || valid_59669;
            bool range_valid_c_59677;
            
            if (!protect_assert_disj_59676) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_59653, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_59678 = zzero_leq_i_p_m_t_s_59642 && i_p_m_t_s_leq_w_59670;
            bool zzero_leq_i_p_m_t_s_59679 = sle64((int64_t) 0, i_p_m_t_s_59671);
            bool i_p_m_t_s_leq_w_59680 = slt64(i_p_m_t_s_59671, next_stride_59632);
            bool forwards_ok_59681 = zzero_lte_i_59658 && y_59675;
            bool ok_or_empty_59682 = zzero_59633 || y_59678;
            bool y_59683 = zzero_lte_i_59658 && i_p_m_t_s_leq_w_59680;
            bool protect_assert_disj_59684 = cond_59665 || y_59672;
            bool ok_or_empty_59685 = empty_slice_59660 || forwards_ok_59681;
            bool protect_assert_disj_59686 = cond_59644 || ok_or_empty_59682;
            bool index_certs_59687;
            
            if (!protect_assert_disj_59686) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_59632, "] out of bounds for array of shape [", (long long) flat_dim_59656, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #9  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_59688 = zzero_leq_i_p_m_t_s_59679 && y_59683;
            bool loop_not_taken_59689 = !cond_59644;
            bool protect_assert_disj_59690 = protect_assert_disj_59684 || loop_not_taken_59689;
            bool index_certs_59691;
            
            if (!protect_assert_disj_59690) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_59655, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #10 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_59692 = cond_59644 || ok_or_empty_59685;
            bool index_certs_59693;
            
            if (!protect_assert_disj_59692) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_59631, "] out of bounds for array of shape [", (long long) next_stride_59632, "].", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_59694 = i_lte_j_59659 && y_59688;
            bool protect_assert_disj_59695 = ok_or_empty_59685 || loop_not_taken_59689;
            bool index_certs_59696;
            
            if (!protect_assert_disj_59695) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_59631, "] out of bounds for array of shape [", (long long) next_stride_59632, "].", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_59697 = empty_slice_59663 || forwards_ok_59694;
            bool protect_assert_disj_59698 = loop_not_taken_59689 || ok_or_empty_59697;
            bool index_certs_59699;
            
            if (!protect_assert_disj_59698) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_59631, ":] out of bounds for array of shape [", (long long) next_stride_59632, "].", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #8  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_59700 = cond_59644 || ok_or_empty_59697;
            bool index_certs_59701;
            
            if (!protect_assert_disj_59700) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_59631, ":] out of bounds for array of shape [", (long long) next_stride_59632, "].", "-> #0  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #11 ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_82060 = (int64_t) 8 * num_merges_59636;
            int64_t bytes_82193 = next_stride_59632 * binop_x_82060;
            bool i_lte_j_59643 = sle64((int64_t) 0, next_stride_59632);
            int64_t intra_avail_par_71513 = smin64(num_blocks_59653, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);
            int64_t computed_tblock_sizze_71276 = smax64(num_blocks_59653, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654);
            bool fits_71518 = sle64(computed_tblock_sizze_71276, max_tblock_sizze_71517);
            bool suff_intra_par_71516;
            
            suff_intra_par_71516 = *ctx->tuning_params.make_collisions_compact_doublezisuff_intra_par_0 <= intra_avail_par_71513;
            if (ctx->logging)
                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "make_collisions_compact_double.suff_intra_par_0", (long) intra_avail_par_71513, suff_intra_par_71516 ? "true" : "false");
            
            bool intra_suff_and_fits_71519 = suff_intra_par_71516 && fits_71518;
            int64_t segmap_usable_groups_73712 = sdiv_up_safe64(num_merges_59636, segmap_tblock_sizze_73711);
            int64_t ext_82321;
            
            if (cond_59644) {
                ext_82321 = (int64_t) 1;
            } else {
                ext_82321 = next_stride_59632;
            }
            
            int64_t ext_82320;
            
            if (cond_59644) {
                ext_82320 = num_merges_59636;
            } else {
                ext_82320 = (int64_t) 1;
            }
            
            bool suff_intra_par_73834;
            
            suff_intra_par_73834 = *ctx->tuning_params.make_collisions_compact_doublezisuff_intra_par_1 <= intra_avail_par_71513;
            if (ctx->logging)
                fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "make_collisions_compact_double.suff_intra_par_1", (long) intra_avail_par_71513, suff_intra_par_73834 ? "true" : "false");
            
            bool intra_suff_and_fits_73835 = fits_71518 && suff_intra_par_73834;
            int64_t nest_sizze_74088 = num_merges_59636 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;
            int64_t nest_sizze_74205 = num_merges_59636 * num_blocks_59653;
            int64_t num_tblocks_74287;
            int64_t max_num_tblocks_83281;
            
            max_num_tblocks_83281 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_72858;
            num_tblocks_74287 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_74205, segmap_tblock_sizze_74286), max_num_tblocks_83281)));
            
            int64_t bytes_82061 = dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654 * binop_x_82060;
            int64_t bytes_82068 = num_blocks_59653 * binop_x_82060;
            int64_t binop_x_82088 = num_merges_59636 * binop_x_82087;
            int64_t bytes_82089 = num_blocks_59653 * binop_x_82088;
            int64_t binop_y_82095 = num_merges_59636 - (int64_t) 1;
            int64_t binop_x_82096 = smax64((int64_t) 0, binop_y_82095);
            int64_t binop_y_82097 = num_blocks_59653 * binop_x_82096;
            int64_t binop_x_82098 = smax64((int64_t) 0, binop_y_82097);
            int64_t binop_y_82099 = num_blocks_59653 - (int64_t) 1;
            int64_t binop_y_82101 = smax64((int64_t) 0, binop_y_82099);
            int64_t binop_x_82102 = binop_x_82098 + binop_y_82101;
            int64_t binop_y_82106 = nest_sizze_74205 * binop_x_82104;
            int64_t binop_y_82107 = smax64((int64_t) 0, binop_y_82106);
            int64_t binop_y_82108 = binop_x_82102 + binop_y_82107;
            int64_t binop_y_82109 = (int64_t) 1 + binop_y_82108;
            int64_t bytes_82110 = (int64_t) 8 * binop_y_82109;
            int64_t bytes_82184 = greatest_divisor_leq_than_res_59511 * bytes_82068;
            int64_t bytes_82199 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654;
            int64_t bytes_82203 = (int64_t) 8 * num_blocks_59653;
            int64_t bytes_82218 = num_blocks_59653 * binop_x_82087;
            int64_t bytes_82236 = greatest_divisor_leq_than_res_59511 * bytes_82203;
            int64_t binop_x_82254 = (int64_t) 16 * stride_59631;
            int64_t bytes_82255 = num_merges_59636 * binop_x_82254;
            int64_t binop_x_82264 = smax64((int64_t) 0, m_59641);
            int64_t binop_y_82265 = num_merges_59636 * binop_x_82264;
            int64_t binop_y_82266 = smax64((int64_t) 0, binop_y_82265);
            int64_t binop_y_82267 = binop_x_82096 + binop_y_82266;
            int64_t binop_y_82268 = (int64_t) 1 + binop_y_82267;
            int64_t bytes_82269 = (int64_t) 8 * binop_y_82268;
            int64_t ext_82398;
            int64_t shared_memory_capacity_83282;
            
            shared_memory_capacity_83282 = ctx->max_shared_memory;
            if (intra_suff_and_fits_71519) {
                ext_82398 = next_stride_59632;
            } else {
                ext_82398 = ext_82321;
            }
            
            int64_t ext_82397;
            int64_t shared_memory_capacity_83283;
            
            shared_memory_capacity_83283 = ctx->max_shared_memory;
            if (intra_suff_and_fits_71519) {
                ext_82397 = (int64_t) 1;
            } else {
                ext_82397 = ext_82320;
            }
            
            int64_t maxSubHelper_83103 = umax64(bytes_82203, bytes_82236);
            int64_t maxSubHelper_83104 = umax64(bytes_82203, bytes_82236);
            int64_t maxSubHelper_83105 = umax64(bytes_82199, bytes_82218);
            int64_t maxSubHelper_83106 = umax64(bytes_82199, bytes_82218);
            int64_t maxSubHelper_83087 = umax64(bytes_82203, bytes_82218);
            int64_t maxSubHelper_83088 = umax64(bytes_82199, bytes_82218);
            int64_t shared_memory_capacity_83587;
            
            shared_memory_capacity_83587 = ctx->max_shared_memory;
            if (intra_suff_and_fits_71519 && sle64(sdiv_up64(binop_x_82254, (int64_t) 8) * (int64_t) 8 + sdiv_up64(binop_x_82254, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82236, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82236, (int64_t) 8) * (int64_t) 8 + sdiv_up64(maxSubHelper_83087, (int64_t) 8) * (int64_t) 8 + sdiv_up64(maxSubHelper_83088, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82199, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83587)) {
                if (memblock_alloc_device(ctx, &mem_82390, bytes_82193, "mem_82390")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_82393, bytes_82193, "mem_82393")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t num_chunks_83284 = sext_i64_i32(sdiv_up64(greatest_divisor_leq_than_res_59511 * num_blocks_59653, computed_tblock_sizze_71276));
                int32_t num_chunks_83285 = sext_i64_i32(sdiv_up64(next_stride_59632, computed_tblock_sizze_71276));
                int32_t num_chunks_83286 = sext_i64_i32(sdiv_up64(num_blocks_59653, computed_tblock_sizze_71276));
                int32_t num_chunks_83287 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, computed_tblock_sizze_71276));
                int32_t virt_num_tblocks_83288 = sext_i64_i32(num_merges_59636);
                
                {
                    err = gpu_kernel_make_collisions_compact_doublezisegmap_intrablock_71523(ctx, num_merges_59636, 1, 1, computed_tblock_sizze_71276, 1, 1, bytes_82199 + srem64((int64_t) 8 - srem64(bytes_82199, (int64_t) 8), (int64_t) 8) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83088 + srem64((int64_t) 8 - srem64(maxSubHelper_83088, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83087 + srem64((int64_t) 8 - srem64(maxSubHelper_83087, (int64_t) 8), (int64_t) 8)) + (bytes_82236 + srem64((int64_t) 8 - srem64(bytes_82236, (int64_t) 8), (int64_t) 8)) + (bytes_82236 + srem64((int64_t) 8 - srem64(bytes_82236, (int64_t) 8), (int64_t) 8)) + (binop_x_82254 + srem64((int64_t) 8 - srem64(binop_x_82254, (int64_t) 8), (int64_t) 8)) + (binop_x_82254 + srem64((int64_t) 8 - srem64(binop_x_82254, (int64_t) 8), (int64_t) 8)), greatest_divisor_leq_than_res_59511, loop_dz2084Uz2082U_59627, stride_59631, next_stride_59632, zzero_59633, num_merges_59636, m_59641, zzero_leq_i_p_m_t_s_59642, i_lte_j_59643, cond_59644, num_blocks_59653, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, j_m_i_59655, cond_59665, computed_tblock_sizze_71276, bytes_82199, bytes_82203, bytes_82236, binop_x_82254, maxSubHelper_83087, maxSubHelper_83088, num_chunks_83284, num_chunks_83285, mem_param_82052.mem, mem_param_82055.mem, mem_82390.mem, mem_82393.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_set_device(ctx, &ext_mem_82399, &mem_82390, "mem_82390") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_82396, &mem_82393, "mem_82393") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &mem_82057, (int64_t) 0, "mem_82057")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_82058, (int64_t) 0, "mem_82058")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_83361 = sext_i64_i32(sdiv_up64(num_merges_59636, segmap_tblock_sizze_73711));
                
                {
                    err = gpu_kernel_make_collisions_compact_doublezisegmap_73717(ctx, segmap_usable_groups_73712, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73685, 1, 1, (int64_t) 0, loop_dz2084Uz2082U_59627, next_stride_59632, zzero_59633, num_merges_59636, m_59641, zzero_leq_i_p_m_t_s_59642, i_lte_j_59643, mem_82057.mem, mem_82058.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (cond_59644) {
                    int64_t segmap_tblock_sizze_73741;
                    
                    segmap_tblock_sizze_73741 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72201;
                    
                    int64_t segmap_usable_groups_73742 = sdiv_up64(num_merges_59636, segmap_tblock_sizze_73741);
                    
                    if (memblock_alloc_device(ctx, &mem_82251, binop_x_82060, "mem_82251")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_82253, binop_x_82060, "mem_82253")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_83370 = sext_i64_i32(sdiv_up64(num_merges_59636, segmap_tblock_sizze_73741));
                    
                    {
                        err = gpu_kernel_make_collisions_compact_doublezisegmap_73746(ctx, segmap_usable_groups_73742, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72201, 1, 1, (int64_t) 0, stride_59631, next_stride_59632, num_merges_59636, cond_59665, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82251.mem, mem_82253.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_alloc_device(ctx, &mem_82256, bytes_82255, "mem_82256")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t replicate_n_83379 = next_stride_59632 * num_merges_59636;
                    int64_t tblock_sizze_83384;
                    
                    tblock_sizze_83384 = *ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83384;
                    
                    int64_t virt_num_tblocks_83385 = sdiv_up64(replicate_n_83379, tblock_sizze_83384);
                    int64_t num_tblocks_83386 = smin64(virt_num_tblocks_83385, (int64_t) 1048576);
                    
                    {
                        err = gpu_kernel_make_collisions_compact_doublezireplicate_83380(ctx, num_tblocks_83386, 1, 1, tblock_sizze_83384, 1, 1, (int64_t) 0, next_stride_59632, num_merges_59636, replicate_n_83379, virt_num_tblocks_83385, num_tblocks_83386, mem_82251.mem, mem_82256.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &mem_82251, "mem_82251") != 0)
                        return 1;
                    if (memblock_alloc_device(ctx, &mem_82259, bytes_82255, "mem_82259")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t replicate_n_83399 = next_stride_59632 * num_merges_59636;
                    int64_t tblock_sizze_83404;
                    
                    tblock_sizze_83404 = *ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83404;
                    
                    int64_t virt_num_tblocks_83405 = sdiv_up64(replicate_n_83399, tblock_sizze_83404);
                    int64_t num_tblocks_83406 = smin64(virt_num_tblocks_83405, (int64_t) 1048576);
                    
                    {
                        err = gpu_kernel_make_collisions_compact_doublezireplicate_83400(ctx, num_tblocks_83406, 1, 1, tblock_sizze_83404, 1, 1, (int64_t) 0, next_stride_59632, num_merges_59636, replicate_n_83399, virt_num_tblocks_83405, num_tblocks_83406, mem_82253.mem, mem_82259.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (memblock_unref_device(ctx, &mem_82253, "mem_82253") != 0)
                        return 1;
                    
                    int64_t segmap_tblock_sizze_73764;
                    
                    segmap_tblock_sizze_73764 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72132;
                    
                    int64_t num_tblocks_73765;
                    int64_t max_num_tblocks_83419;
                    
                    max_num_tblocks_83419 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_72134;
                    num_tblocks_73765 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(num_merges_59636, segmap_tblock_sizze_73764), max_num_tblocks_83419)));
                    if (memblock_alloc_device(ctx, &mem_82270, bytes_82269, "mem_82270")) {
                        err = 1;
                        goto cleanup;
                    }
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82270.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, num_merges_59636}, mem_82256.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, num_merges_59636}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &mem_82256, "mem_82256") != 0)
                        return 1;
                    if (memblock_alloc_device(ctx, &mem_82281, bytes_82269, "mem_82281")) {
                        err = 1;
                        goto cleanup;
                    }
                    if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82281.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, num_merges_59636}, mem_82259.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, num_merges_59636}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                        goto cleanup;
                    if (memblock_unref_device(ctx, &mem_82259, "mem_82259") != 0)
                        return 1;
                    if (memblock_alloc_device(ctx, &mem_82305, bytes_82269, "mem_82305")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &mem_82316, bytes_82269, "mem_82316")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegMap");
                    
                    int32_t virt_num_tblocks_83420 = sext_i64_i32(sdiv_up64(num_merges_59636, segmap_tblock_sizze_73764));
                    
                    {
                        err = gpu_kernel_make_collisions_compact_doublezisegmap_73770(ctx, num_tblocks_73765, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72132, 1, 1, (int64_t) 0, stride_59631, next_stride_59632, num_merges_59636, j_m_i_59655, num_tblocks_73765, virt_num_tblocks_83420, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82270.mem, mem_82281.mem, mem_82305.mem, mem_82316.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                    if (memblock_unref_device(ctx, &mem_82270, "mem_82270") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_82281, "mem_82281") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &ext_mem_82322, &mem_82305, "mem_82305") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &ext_mem_82319, &mem_82316, "mem_82316") != 0)
                        return 1;
                } else {
                    int64_t shared_memory_capacity_83586;
                    
                    shared_memory_capacity_83586 = ctx->max_shared_memory;
                    if (intra_suff_and_fits_73835 && sle64(sdiv_up64(maxSubHelper_83103, (int64_t) 8) * (int64_t) 8 + sdiv_up64(maxSubHelper_83104, (int64_t) 8) * (int64_t) 8 + sdiv_up64(maxSubHelper_83105, (int64_t) 8) * (int64_t) 8 + sdiv_up64(maxSubHelper_83106, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_82203, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83586)) {
                        if (memblock_alloc_device(ctx, &mem_82243, bytes_82193, "mem_82243")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82246, bytes_82193, "mem_82246")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegMap");
                        
                        int32_t num_chunks_83436 = sext_i64_i32(sdiv_up64(greatest_divisor_leq_than_res_59511 * num_blocks_59653, computed_tblock_sizze_71276));
                        int32_t num_chunks_83437 = sext_i64_i32(sdiv_up64(num_blocks_59653, computed_tblock_sizze_71276));
                        int32_t num_chunks_83438 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, computed_tblock_sizze_71276));
                        int32_t virt_num_tblocks_83439 = sext_i64_i32(num_merges_59636);
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezisegmap_intrablock_73841(ctx, num_merges_59636, 1, 1, computed_tblock_sizze_71276, 1, 1, bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (bytes_82203 + srem64((int64_t) 8 - srem64(bytes_82203, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83106 + srem64((int64_t) 8 - srem64(maxSubHelper_83106, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83105 + srem64((int64_t) 8 - srem64(maxSubHelper_83105, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83104 + srem64((int64_t) 8 - srem64(maxSubHelper_83104, (int64_t) 8), (int64_t) 8)) + (maxSubHelper_83103 + srem64((int64_t) 8 - srem64(maxSubHelper_83103, (int64_t) 8), (int64_t) 8)), greatest_divisor_leq_than_res_59511, stride_59631, next_stride_59632, num_merges_59636, num_blocks_59653, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, j_m_i_59655, computed_tblock_sizze_71276, bytes_82203, maxSubHelper_83103, maxSubHelper_83104, maxSubHelper_83105, maxSubHelper_83106, num_chunks_83436, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82243.mem, mem_82246.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        ctx->failure_is_an_option = 1;
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                        if (memblock_set_device(ctx, &ext_mem_82248, &mem_82243, "mem_82243") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_82247, &mem_82246, "mem_82246") != 0)
                            return 1;
                    } else {
                        int64_t segmap_usable_groups_74090 = sdiv_up64(nest_sizze_74088, segmap_tblock_sizze_74089);
                        
                        if (memblock_alloc_device(ctx, &mem_82062, bytes_82061, "mem_82062")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82065, bytes_82061, "mem_82065")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegMap");
                        
                        int32_t virt_num_tblocks_83494 = sext_i64_i32(sdiv_up64(num_merges_59636 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, segmap_tblock_sizze_74089));
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezisegmap_74095(ctx, segmap_usable_groups_74090, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_73167, 1, 1, (int64_t) 0, greatest_divisor_leq_than_res_59511, stride_59631, next_stride_59632, num_merges_59636, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, j_m_i_59655, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82062.mem, mem_82065.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        ctx->failure_is_an_option = 1;
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                        
                        int64_t segmap_usable_groups_74207 = sdiv_up64(nest_sizze_74205, segmap_tblock_sizze_74206);
                        
                        if (memblock_alloc_device(ctx, &mem_82069, bytes_82068, "mem_82069")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82072, bytes_82068, "mem_82072")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82075, bytes_82068, "mem_82075")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82078, bytes_82068, "mem_82078")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82081, bytes_82068, "mem_82081")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82082, (int64_t) 0, "mem_82082")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82085, bytes_82068, "mem_82085")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82086, (int64_t) 0, "mem_82086")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegMap");
                        
                        int32_t virt_num_tblocks_83511 = sext_i64_i32(sdiv_up64(num_merges_59636 * num_blocks_59653, segmap_tblock_sizze_74206));
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezisegmap_74218(ctx, segmap_usable_groups_74207, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72938, 1, 1, (int64_t) 0, stride_59631, next_stride_59632, num_merges_59636, num_blocks_59653, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_59654, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82062.mem, mem_82065.mem, mem_82069.mem, mem_82072.mem, mem_82075.mem, mem_82078.mem, mem_82081.mem, mem_82082.mem, mem_82085.mem, mem_82086.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        ctx->failure_is_an_option = 1;
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                        if (memblock_unref_device(ctx, &mem_82062, "mem_82062") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82065, "mem_82065") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82090, bytes_82089, "mem_82090")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t replicate_n_83522 = greatest_divisor_leq_than_res_59511 * num_merges_59636 * num_blocks_59653;
                        int64_t tblock_sizze_83527;
                        
                        tblock_sizze_83527 = *ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83527;
                        
                        int64_t virt_num_tblocks_83528 = sdiv_up64(replicate_n_83522, tblock_sizze_83527);
                        int64_t num_tblocks_83529 = smin64(virt_num_tblocks_83528, (int64_t) 1048576);
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezireplicate_83523(ctx, num_tblocks_83529, 1, 1, tblock_sizze_83527, 1, 1, (int64_t) 0, greatest_divisor_leq_than_res_59511, num_merges_59636, num_blocks_59653, replicate_n_83522, virt_num_tblocks_83528, num_tblocks_83529, mem_82069.mem, mem_82090.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (memblock_unref_device(ctx, &mem_82069, "mem_82069") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82094, bytes_82089, "mem_82094")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int64_t replicate_n_83545 = greatest_divisor_leq_than_res_59511 * num_merges_59636 * num_blocks_59653;
                        int64_t tblock_sizze_83550;
                        
                        tblock_sizze_83550 = *ctx->tuning_params.make_collisions_compact_doublezitblock_sizze_83550;
                        
                        int64_t virt_num_tblocks_83551 = sdiv_up64(replicate_n_83545, tblock_sizze_83550);
                        int64_t num_tblocks_83552 = smin64(virt_num_tblocks_83551, (int64_t) 1048576);
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezireplicate_83546(ctx, num_tblocks_83552, 1, 1, tblock_sizze_83550, 1, 1, (int64_t) 0, greatest_divisor_leq_than_res_59511, num_merges_59636, num_blocks_59653, replicate_n_83545, virt_num_tblocks_83551, num_tblocks_83552, mem_82072.mem, mem_82094.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (memblock_unref_device(ctx, &mem_82072, "mem_82072") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82111, bytes_82110, "mem_82111")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 3, mem_82111.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, mem_82090.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, (int64_t []) {num_merges_59636, num_blocks_59653, greatest_divisor_leq_than_res_59511})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82090, "mem_82090") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82128, bytes_82110, "mem_82128")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 3, mem_82128.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, mem_82094.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, (int64_t []) {num_merges_59636, num_blocks_59653, greatest_divisor_leq_than_res_59511})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82094, "mem_82094") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82164, bytes_82110, "mem_82164")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (memblock_alloc_device(ctx, &mem_82181, bytes_82110, "mem_82181")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "\n# SegMap");
                        
                        int32_t virt_num_tblocks_83568 = sext_i64_i32(sdiv_up64(num_merges_59636 * num_blocks_59653, segmap_tblock_sizze_74286));
                        
                        {
                            err = gpu_kernel_make_collisions_compact_doublezisegmap_74293(ctx, num_tblocks_74287, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_72856, 1, 1, (int64_t) 0, greatest_divisor_leq_than_res_59511, next_stride_59632, num_merges_59636, num_blocks_59653, nest_sizze_74205, num_tblocks_74287, virt_num_tblocks_83568, mem_param_82052.mem, mem_param_82055.mem, mem_82057.mem, mem_82058.mem, mem_82075.mem, mem_82078.mem, mem_82081.mem, mem_82082.mem, mem_82085.mem, mem_82086.mem, mem_82111.mem, mem_82128.mem, mem_82164.mem, mem_82181.mem);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        ctx->failure_is_an_option = 1;
                        if (ctx->debugging)
                            fprintf(ctx->log, "%s\n", "");
                        if (memblock_unref_device(ctx, &mem_82075, "mem_82075") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82078, "mem_82078") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82081, "mem_82081") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82082, "mem_82082") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82085, "mem_82085") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82086, "mem_82086") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82111, "mem_82111") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &mem_82128, "mem_82128") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82185, bytes_82184, "mem_82185")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 3, mem_82185.mem, (int64_t) 0, (int64_t []) {greatest_divisor_leq_than_res_59511 * num_blocks_59653, greatest_divisor_leq_than_res_59511, (int64_t) 1}, mem_82164.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, (int64_t []) {num_merges_59636, num_blocks_59653, greatest_divisor_leq_than_res_59511})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82164, "mem_82164") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82190, bytes_82184, "mem_82190")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 3, mem_82190.mem, (int64_t) 0, (int64_t []) {greatest_divisor_leq_than_res_59511 * num_blocks_59653, greatest_divisor_leq_than_res_59511, (int64_t) 1}, mem_82181.mem, (int64_t) 0, (int64_t []) {num_blocks_59653, (int64_t) 1, num_blocks_59653 * num_merges_59636}, (int64_t []) {num_merges_59636, num_blocks_59653, greatest_divisor_leq_than_res_59511})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82181, "mem_82181") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82194, bytes_82193, "mem_82194")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82194.mem, (int64_t) 0, (int64_t []) {next_stride_59632, (int64_t) 1}, mem_82185.mem, (int64_t) 0, (int64_t []) {flat_dim_59656, (int64_t) 1}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82185, "mem_82185") != 0)
                            return 1;
                        if (memblock_alloc_device(ctx, &mem_82197, bytes_82193, "mem_82197")) {
                            err = 1;
                            goto cleanup;
                        }
                        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82197.mem, (int64_t) 0, (int64_t []) {next_stride_59632, (int64_t) 1}, mem_82190.mem, (int64_t) 0, (int64_t []) {flat_dim_59656, (int64_t) 1}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                            goto cleanup;
                        if (memblock_unref_device(ctx, &mem_82190, "mem_82190") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_82248, &mem_82194, "mem_82194") != 0)
                            return 1;
                        if (memblock_set_device(ctx, &ext_mem_82247, &mem_82197, "mem_82197") != 0)
                            return 1;
                    }
                    if (memblock_set_device(ctx, &ext_mem_82322, &ext_mem_82248, "ext_mem_82248") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &ext_mem_82319, &ext_mem_82247, "ext_mem_82247") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_82057, "mem_82057") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_82058, "mem_82058") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_82399, &ext_mem_82322, "ext_mem_82322") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_82396, &ext_mem_82319, "ext_mem_82319") != 0)
                    return 1;
            }
            
            int64_t flat_dim_59997 = next_stride_59632 * num_merges_59636;
            
            if (memblock_alloc_device(ctx, &mem_82402, bytes_82193, "mem_82402")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82402.mem, (int64_t) 0, (int64_t []) {next_stride_59632, (int64_t) 1}, ext_mem_82399.mem, (int64_t) 0, (int64_t []) {ext_82398, ext_82397}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &ext_mem_82399, "ext_mem_82399") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_82406, bytes_82193, "mem_82406")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_82406.mem, (int64_t) 0, (int64_t []) {next_stride_59632, (int64_t) 1}, ext_mem_82396.mem, (int64_t) 0, (int64_t []) {ext_82398, ext_82397}, (int64_t []) {num_merges_59636, next_stride_59632})) != 0)
                goto cleanup;
            if (memblock_unref_device(ctx, &ext_mem_82396, "ext_mem_82396") != 0)
                return 1;
            
            bool loop_cond_60002 = slt64(next_stride_59632, flat_dim_59489);
            
            if (memblock_set_device(ctx, &mem_param_tmp_83274, &mem_82402, "mem_82402") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_tmp_83275, &mem_82406, "mem_82406") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_83276 = flat_dim_59997;
            bool loop_while_tmp_83277 = loop_cond_60002;
            int64_t stride_tmp_83280 = next_stride_59632;
            
            if (memblock_set_device(ctx, &mem_param_82052, &mem_param_tmp_83274, "mem_param_tmp_83274") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_82055, &mem_param_tmp_83275, "mem_param_tmp_83275") != 0)
                return 1;
            loop_dz2084Uz2082U_59627 = loop_dz2084Uz2082U_tmp_83276;
            loop_while_59628 = loop_while_tmp_83277;
            stride_59631 = stride_tmp_83280;
        }
        if (memblock_set_device(ctx, &ext_mem_82413, &mem_param_82052, "mem_param_82052") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82412, &mem_param_82055, "mem_param_82055") != 0)
            return 1;
        data_59622 = loop_dz2084Uz2082U_59627;
        data_59623 = loop_while_59628;
        data_59626 = stride_59631;
        if (memblock_unref_device(ctx, &mem_82044, "mem_82044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82048, "mem_82048") != 0)
            return 1;
        
        bool i_p_m_t_s_leq_w_60005 = slt64(zs_lhs_59473, data_59622);
        bool y_60006 = zzero_leq_i_p_m_t_s_60004 && i_p_m_t_s_leq_w_60005;
        bool ok_or_empty_60007 = empty_slice_60003 || y_60006;
        bool index_certs_60008;
        
        if (!ok_or_empty_60007) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) dz2084U_51542, "] out of bounds for array of shape [", (long long) data_59622, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  ft_libs/lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #5  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_82419, &ext_mem_82413, "ext_mem_82413") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_82416, &ext_mem_82412, "ext_mem_82412") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &ext_mem_81958, "ext_mem_81958") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_81959, "ext_mem_81959") != 0)
        return 1;
    
    int64_t segscan_tblock_sizze_74385;
    
    segscan_tblock_sizze_74385 = *ctx->tuning_params.make_collisions_compact_doublezisegscan_tblock_sizze_74384;
    
    int64_t num_tblocks_74387;
    int64_t max_num_tblocks_83588;
    
    max_num_tblocks_83588 = *ctx->tuning_params.make_collisions_compact_doublezisegscan_num_tblocks_74386;
    num_tblocks_74387 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2084U_51542, segscan_tblock_sizze_74385), max_num_tblocks_83588)));
    
    int64_t bytes_82421 = (int64_t) 8 * dz2084U_51542;
    
    if (memblock_alloc_device(ctx, &mem_82422, bytes_82421, "mem_82422")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_82424, bytes_82421, "mem_82424")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dz2084U_51542)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_83589;
        
        shared_memory_83589 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_83590;
        
        thread_block_sizze_83590 = ctx->max_thread_block_size;
        
        int64_t registers_83591;
        
        registers_83591 = ctx->max_registers;
        
        int64_t thread_block_sizze_83592;
        
        thread_block_sizze_83592 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_83593 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83589, thread_block_sizze_83590), (int64_t) 8), squot64(squot64(registers_83591, thread_block_sizze_83592) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_83594 = sdiv_up64(dz2084U_51542, segscan_tblock_sizze_74385 * chunk_sizze_83593);
        int64_t num_virt_threads_83595 = num_virt_blocks_83594 * segscan_tblock_sizze_74385;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83593, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_83596, num_virt_blocks_83594, "status_flags_mem_83596")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83596, num_virt_blocks_83594, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_83618, (int64_t) 8 * num_virt_blocks_83594, "aggregates_mem_83618")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_83620, (int64_t) 8 * num_virt_blocks_83594, "incprefixes_mem_83620")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_make_collisions_compact_doublezisegscan_74390(ctx, num_tblocks_74387, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegscan_tblock_sizze_74384, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74385), chunk_sizze_83593 * segscan_tblock_sizze_74385 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_74385), chunk_sizze_83593 * segscan_tblock_sizze_74385 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dz2084U_51542, num_tblocks_74387, num_virt_blocks_83594, num_virt_threads_83595, ext_mem_82419.mem, mem_82422.mem, mem_82424.mem, status_flags_mem_83596.mem, aggregates_mem_83618.mem, incprefixes_mem_83620.mem, global_dynid_mem_83622.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool x_60042 = !empty_slice_60003;
    bool y_60045 = slt64(zs_lhs_59473, dz2084U_51542);
    bool bounds_check_60046 = zzero_leq_i_p_m_t_s_60004 && y_60045;
    bool protect_assert_disj_60047 = empty_slice_60003 || bounds_check_60046;
    bool index_certs_60048;
    
    if (!protect_assert_disj_60047) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zs_lhs_59473, "] out of bounds for array of shape [", (long long) dz2084U_51542, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #3  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_60049;
    
    if (x_60042) {
        int64_t read_res_86956;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86956, mem_82422.mem, zs_lhs_59473 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_64169 = read_res_86956;
        
        m_f_res_60049 = x_64169;
    } else {
        m_f_res_60049 = (int64_t) 0;
    }
    
    int64_t m_60051;
    
    if (empty_slice_60003) {
        m_60051 = (int64_t) 0;
    } else {
        m_60051 = m_f_res_60049;
    }
    
    int64_t m_60061 = sub64(m_60051, (int64_t) 1);
    bool i_p_m_t_s_leq_w_60063 = slt64(m_60061, dz2084U_51542);
    bool zzero_leq_i_p_m_t_s_60062 = sle64((int64_t) 0, m_60061);
    bool y_60065 = zzero_leq_i_p_m_t_s_60062 && i_p_m_t_s_leq_w_60063;
    bool i_lte_j_60064 = sle64((int64_t) 0, m_60051);
    bool forwards_ok_60066 = i_lte_j_60064 && y_60065;
    bool eq_x_zz_60058 = (int64_t) 0 == m_f_res_60049;
    bool p_and_eq_x_y_60059 = x_60042 && eq_x_zz_60058;
    bool empty_slice_60060 = empty_slice_60003 || p_and_eq_x_y_60059;
    bool ok_or_empty_60067 = empty_slice_60060 || forwards_ok_60066;
    bool index_certs_60068;
    
    if (!ok_or_empty_60067) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_60051, "] out of bounds for array of shape [", (long long) dz2084U_51542, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1058:18-1060:58\n   #3  ft_libs/ftDBSCAN_plus.fut:1057:9-1060:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_82425 = (int64_t) 8 * m_60051;
    
    if (memblock_alloc_device(ctx, &mem_82426, bytes_82425, "mem_82426")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82426.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82416.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_60051})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_82428, bytes_82425, "mem_82428")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_82428.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_82419.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_60051})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_74395;
    
    segmap_tblock_sizze_74395 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_74394;
    
    int64_t num_tblocks_74397;
    int64_t max_num_tblocks_83711;
    
    max_num_tblocks_83711 = *ctx->tuning_params.make_collisions_compact_doublezisegmap_num_tblocks_74396;
    num_tblocks_74397 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2084U_51542, segmap_tblock_sizze_74395), max_num_tblocks_83711)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_83712 = sext_i64_i32(sdiv_up64(dz2084U_51542, segmap_tblock_sizze_74395));
    
    {
        err = gpu_kernel_make_collisions_compact_doublezisegmap_74392(ctx, num_tblocks_74397, 1, 1, *ctx->tuning_params.make_collisions_compact_doublezisegmap_tblock_sizze_74394, 1, 1, (int64_t) 0, dz2084U_51542, m_60051, num_tblocks_74397, virt_num_tblocks_83712, ext_mem_82416.mem, ext_mem_82419.mem, mem_82422.mem, mem_82424.mem, mem_82426.mem, mem_82428.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_82416, "ext_mem_82416") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_82419, "ext_mem_82419") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82422, "mem_82422") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_82424, "mem_82424") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83117, &mem_82428, "mem_82428") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83118, &mem_82426, "mem_82426") != 0)
        return 1;
    prim_out_83119 = m_60051;
    prim_out_83120 = m_60051;
    if (memblock_set_device(ctx, &*mem_out_p_86950, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86951, &mem_out_83118, "mem_out_83118") != 0)
        return 1;
    *out_prim_out_86952 = prim_out_83119;
    *out_prim_out_86953 = prim_out_83120;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_82428, "mem_82428") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82426, "mem_82426") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83620, "incprefixes_mem_83620") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83618, "aggregates_mem_83618") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83596, "status_flags_mem_83596") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82424, "mem_82424") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82422, "mem_82422") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_83275, "mem_param_tmp_83275") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_83274, "mem_param_tmp_83274") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82406, "mem_82406") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82402, "mem_82402") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82197, "mem_82197") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82194, "mem_82194") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82190, "mem_82190") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82185, "mem_82185") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82181, "mem_82181") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82164, "mem_82164") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82128, "mem_82128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82111, "mem_82111") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82094, "mem_82094") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82090, "mem_82090") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82086, "mem_82086") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82085, "mem_82085") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82082, "mem_82082") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82081, "mem_82081") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82078, "mem_82078") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82075, "mem_82075") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82072, "mem_82072") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82069, "mem_82069") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82065, "mem_82065") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82062, "mem_82062") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82246, "mem_82246") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82243, "mem_82243") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82247, "ext_mem_82247") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82248, "ext_mem_82248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82316, "mem_82316") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82305, "mem_82305") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82281, "mem_82281") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82270, "mem_82270") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82259, "mem_82259") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82256, "mem_82256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82253, "mem_82253") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82251, "mem_82251") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82319, "ext_mem_82319") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82322, "ext_mem_82322") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82058, "mem_82058") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82057, "mem_82057") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82393, "mem_82393") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82390, "mem_82390") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82396, "ext_mem_82396") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82399, "ext_mem_82399") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82055, "mem_param_82055") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_82052, "mem_param_82052") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82412, "ext_mem_82412") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82413, "ext_mem_82413") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82048, "mem_82048") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82044, "mem_82044") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82035, "mem_82035") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_82024, "mem_82024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81988, "mem_81988") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81977, "mem_81977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82038, "ext_mem_82038") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82041, "ext_mem_82041") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81966, "mem_81966") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82416, "ext_mem_82416") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_82419, "ext_mem_82419") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81952, "mem_81952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81957, "mem_81957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81956, "mem_81956") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_83155, "segred_tmp_mem_83155") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_83153, "segred_tmp_mem_83153") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81955, "mem_81955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81958, "ext_mem_81958") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81959, "ext_mem_81959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83118, "mem_out_83118") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mk_dbcHandler_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_86957, struct memblock_device *mem_out_p_86958, struct memblock_device *mem_out_p_86959, struct memblock_device *mem_out_p_86960, struct memblock_device *mem_out_p_86961, struct memblock_device *mem_out_p_86962, struct memblock_device *mem_out_p_86963, struct memblock_device *mem_out_p_86964, struct memblock_device *mem_out_p_86965, struct memblock_device *mem_out_p_86966, struct memblock_device *mem_out_p_86967, struct memblock_device *mem_out_p_86968, struct memblock_device *mem_out_p_86969, struct memblock_device *mem_out_p_86970, struct memblock_device *mem_out_p_86971, struct memblock_device *mem_out_p_86972, struct memblock_device *mem_out_p_86973, struct memblock_device *mem_out_p_86974, struct memblock_device *mem_out_p_86975, struct memblock_device *mem_out_p_86976, struct memblock_device *mem_out_p_86977, struct memblock_device *mem_out_p_86978, struct memblock_device *mem_out_p_86979, struct memblock_device *mem_out_p_86980, struct memblock_device *mem_out_p_86981, int64_t *out_prim_out_86982, int8_t *out_prim_out_86983, int8_t *out_prim_out_86984, double *out_prim_out_86985, int64_t *out_prim_out_86986, int64_t *out_prim_out_86987, double *out_prim_out_86988, int64_t *out_prim_out_86989, int64_t *out_prim_out_86990, int64_t *out_prim_out_86991, int64_t *out_prim_out_86992, int64_t *out_prim_out_86993, int64_t *out_prim_out_86994, int64_t *out_prim_out_86995, double min_x_31083, double min_y_31084, double max_x_31085, double max_y_31086, int64_t parts_x_31087, int64_t parts_y_31088, bool isEuclidean_31089, bool isRadians_31090, double radius_31091, double eps_31092, int64_t minPts_31093, int64_t m_sizze_31094)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_81955;
    
    mem_81955.references = NULL;
    
    struct memblock_device mem_81954;
    
    mem_81954.references = NULL;
    
    struct memblock_device mem_81953;
    
    mem_81953.references = NULL;
    
    struct memblock_device mem_81952;
    
    mem_81952.references = NULL;
    
    struct memblock_device mem_81951;
    
    mem_81951.references = NULL;
    
    struct memblock_device mem_81950;
    
    mem_81950.references = NULL;
    
    struct memblock_device mem_81949;
    
    mem_81949.references = NULL;
    
    struct memblock_device mem_81948;
    
    mem_81948.references = NULL;
    
    struct memblock_device mem_81947;
    
    mem_81947.references = NULL;
    
    struct memblock_device mem_81946;
    
    mem_81946.references = NULL;
    
    struct memblock_device mem_81945;
    
    mem_81945.references = NULL;
    
    struct memblock_device mem_81944;
    
    mem_81944.references = NULL;
    
    struct memblock_device mem_81943;
    
    mem_81943.references = NULL;
    
    struct memblock_device mem_81942;
    
    mem_81942.references = NULL;
    
    struct memblock_device mem_81941;
    
    mem_81941.references = NULL;
    
    struct memblock_device mem_81940;
    
    mem_81940.references = NULL;
    
    struct memblock_device mem_81939;
    
    mem_81939.references = NULL;
    
    struct memblock_device mem_81938;
    
    mem_81938.references = NULL;
    
    struct memblock_device mem_81937;
    
    mem_81937.references = NULL;
    
    struct memblock_device mem_81936;
    
    mem_81936.references = NULL;
    
    struct memblock_device mem_81935;
    
    mem_81935.references = NULL;
    
    struct memblock_device mem_81934;
    
    mem_81934.references = NULL;
    
    struct memblock_device mem_81933;
    
    mem_81933.references = NULL;
    
    struct memblock_device mem_81932;
    
    mem_81932.references = NULL;
    
    struct memblock_device mem_81931;
    
    mem_81931.references = NULL;
    
    struct memblock_device mem_81930;
    
    mem_81930.references = NULL;
    
    struct memblock_device mem_81929;
    
    mem_81929.references = NULL;
    
    struct memblock_device mem_81928;
    
    mem_81928.references = NULL;
    
    struct memblock_device mem_81927;
    
    mem_81927.references = NULL;
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83142;
    int8_t prim_out_83143;
    int8_t prim_out_83144;
    double prim_out_83145;
    int64_t prim_out_83146;
    int64_t prim_out_83147;
    double prim_out_83148;
    int64_t prim_out_83149;
    int64_t prim_out_83150;
    int64_t prim_out_83151;
    int64_t prim_out_83152;
    int64_t prim_out_83153;
    int64_t prim_out_83154;
    int64_t prim_out_83155;
    int64_t dzlz7bUZLztZRz20Uparts_xz20Uparts_yz7dUzg_53365 = mul64(parts_x_31087, parts_y_31088);
    bool cond_neg_53362 = !isEuclidean_31089;
    int8_t dist_type_53363 = btoi_bool_i8(cond_neg_53362);
    int8_t angle_type_53364 = btoi_bool_i8(isRadians_31090);
    double i64_res_53368 = sitofp_i64_f64(parts_x_31087);
    double zm_res_53369 = max_x_31085 - min_x_31083;
    double zs_res_53370 = zm_res_53369 / i64_res_53368;
    double i64_res_53371 = sitofp_i64_f64(parts_y_31088);
    double zm_res_53372 = max_y_31086 - min_y_31084;
    double zs_res_53373 = zm_res_53372 / i64_res_53371;
    
    if (memblock_alloc_device(ctx, &mem_81927, dzlz7bUZLztZRz20Uparts_xz20Uparts_yz7dUzg_53365, "mem_81927")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_bool(ctx, mem_81927, dzlz7bUZLztZRz20Uparts_xz20Uparts_yz7dUzg_53365, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81928, (int64_t) 0, "mem_81928")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81929, (int64_t) 0, "mem_81929")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81930, (int64_t) 0, "mem_81930")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81931, (int64_t) 0, "mem_81931")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81932, (int64_t) 0, "mem_81932")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81933, (int64_t) 16, "mem_81933")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_81933, (int64_t) 2, INFINITY) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81934, (int64_t) 16, "mem_81934")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_81934, (int64_t) 2, -INFINITY) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81935, (int64_t) 64, "mem_81935")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81935, (int64_t) 8, (int64_t) -1) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81936, (int64_t) 8, "mem_81936")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_bool(ctx, mem_81936, (int64_t) 8, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81937, (int64_t) 0, "mem_81937")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81938, (int64_t) 0, "mem_81938")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81939, (int64_t) 0, "mem_81939")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81940, (int64_t) 0, "mem_81940")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81941, (int64_t) 0, "mem_81941")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81942, (int64_t) 0, "mem_81942")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81943, (int64_t) 0, "mem_81943")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81944, (int64_t) 0, "mem_81944")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81945, (int64_t) 0, "mem_81945")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81946, (int64_t) 0, "mem_81946")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81947, (int64_t) 0, "mem_81947")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81948, (int64_t) 16, "mem_81948")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81949, (int64_t) 16, "mem_81949")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81950, (int64_t) 16, "mem_81950")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81951, (int64_t) 16, "mem_81951")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81952, (int64_t) 16, "mem_81952")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81953, (int64_t) 16, "mem_81953")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81954, (int64_t) 16, "mem_81954")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81955, (int64_t) 16, "mem_81955")) {
        err = 1;
        goto cleanup;
    }
    {
        err = gpu_kernel_mk_dbcHandler_doublezigpuseq_83216(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, min_x_31083, min_y_31084, max_x_31085, max_y_31086, parts_x_31087, parts_y_31088, zs_res_53370, zs_res_53373, mem_81948.mem, mem_81949.mem, mem_81950.mem, mem_81951.mem, mem_81952.mem, mem_81953.mem, mem_81954.mem, mem_81955.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_unref_device(ctx, &mem_81948, "mem_81948") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81949, "mem_81949") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81950, "mem_81950") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_81951, "mem_81951") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83117, &mem_81946, "mem_81946") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83118, &mem_81947, "mem_81947") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83119, &mem_81953, "mem_81953") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83120, &mem_81952, "mem_81952") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83121, &mem_81955, "mem_81955") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83122, &mem_81954, "mem_81954") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83123, &mem_81928, "mem_81928") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83124, &mem_81929, "mem_81929") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83125, &mem_81930, "mem_81930") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83126, &mem_81931, "mem_81931") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83127, &mem_81927, "mem_81927") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83128, &mem_81932, "mem_81932") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83129, &mem_81937, "mem_81937") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83130, &mem_81938, "mem_81938") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83131, &mem_81939, "mem_81939") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83132, &mem_81940, "mem_81940") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83133, &mem_81941, "mem_81941") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83134, &mem_81936, "mem_81936") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83135, &mem_81942, "mem_81942") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83136, &mem_81934, "mem_81934") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83137, &mem_81933, "mem_81933") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83138, &mem_81935, "mem_81935") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83139, &mem_81943, "mem_81943") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83140, &mem_81944, "mem_81944") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_83141, &mem_81945, "mem_81945") != 0)
        return 1;
    prim_out_83142 = dzlz7bUZLztZRz20Uparts_xz20Uparts_yz7dUzg_53365;
    prim_out_83143 = angle_type_53364;
    prim_out_83144 = dist_type_53363;
    prim_out_83145 = eps_31092;
    prim_out_83146 = m_sizze_31094;
    prim_out_83147 = minPts_31093;
    prim_out_83148 = radius_31091;
    prim_out_83149 = dzlz7bUZLztZRz20Uparts_xz20Uparts_yz7dUzg_53365;
    prim_out_83150 = (int64_t) 0;
    prim_out_83151 = (int64_t) -1;
    prim_out_83152 = (int64_t) -1;
    prim_out_83153 = (int64_t) 0;
    prim_out_83154 = (int64_t) -1;
    prim_out_83155 = (int64_t) -1;
    if (memblock_set_device(ctx, &*mem_out_p_86957, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86958, &mem_out_83118, "mem_out_83118") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86959, &mem_out_83119, "mem_out_83119") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86960, &mem_out_83120, "mem_out_83120") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86961, &mem_out_83121, "mem_out_83121") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86962, &mem_out_83122, "mem_out_83122") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86963, &mem_out_83123, "mem_out_83123") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86964, &mem_out_83124, "mem_out_83124") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86965, &mem_out_83125, "mem_out_83125") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86966, &mem_out_83126, "mem_out_83126") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86967, &mem_out_83127, "mem_out_83127") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86968, &mem_out_83128, "mem_out_83128") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86969, &mem_out_83129, "mem_out_83129") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86970, &mem_out_83130, "mem_out_83130") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86971, &mem_out_83131, "mem_out_83131") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86972, &mem_out_83132, "mem_out_83132") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86973, &mem_out_83133, "mem_out_83133") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86974, &mem_out_83134, "mem_out_83134") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86975, &mem_out_83135, "mem_out_83135") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86976, &mem_out_83136, "mem_out_83136") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86977, &mem_out_83137, "mem_out_83137") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86978, &mem_out_83138, "mem_out_83138") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86979, &mem_out_83139, "mem_out_83139") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86980, &mem_out_83140, "mem_out_83140") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_86981, &mem_out_83141, "mem_out_83141") != 0)
        return 1;
    *out_prim_out_86982 = prim_out_83142;
    *out_prim_out_86983 = prim_out_83143;
    *out_prim_out_86984 = prim_out_83144;
    *out_prim_out_86985 = prim_out_83145;
    *out_prim_out_86986 = prim_out_83146;
    *out_prim_out_86987 = prim_out_83147;
    *out_prim_out_86988 = prim_out_83148;
    *out_prim_out_86989 = prim_out_83149;
    *out_prim_out_86990 = prim_out_83150;
    *out_prim_out_86991 = prim_out_83151;
    *out_prim_out_86992 = prim_out_83152;
    *out_prim_out_86993 = prim_out_83153;
    *out_prim_out_86994 = prim_out_83154;
    *out_prim_out_86995 = prim_out_83155;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_81955, "mem_81955") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81953, "mem_81953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81952, "mem_81952") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81951, "mem_81951") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81950, "mem_81950") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81949, "mem_81949") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81948, "mem_81948") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81947, "mem_81947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81946, "mem_81946") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81945, "mem_81945") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81944, "mem_81944") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81943, "mem_81943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81942, "mem_81942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81941, "mem_81941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81940, "mem_81940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81939, "mem_81939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81938, "mem_81938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81937, "mem_81937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81936, "mem_81936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81935, "mem_81935") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81934, "mem_81934") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81933, "mem_81933") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81932, "mem_81932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81931, "mem_81931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81930, "mem_81930") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81929, "mem_81929") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81928, "mem_81928") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81927, "mem_81927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83141, "mem_out_83141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83140, "mem_out_83140") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83139, "mem_out_83139") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83138, "mem_out_83138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83137, "mem_out_83137") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83136, "mem_out_83136") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83135, "mem_out_83135") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83134, "mem_out_83134") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83133, "mem_out_83133") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83132, "mem_out_83132") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83131, "mem_out_83131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83130, "mem_out_83130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83129, "mem_out_83129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83128, "mem_out_83128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83127, "mem_out_83127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83126, "mem_out_83126") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83125, "mem_out_83125") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83124, "mem_out_83124") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83123, "mem_out_83123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83122, "mem_out_83122") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83121, "mem_out_83121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83120, "mem_out_83120") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83119, "mem_out_83119") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83118, "mem_out_83118") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_next_partition_to_read_double(struct futhark_context *ctx, int64_t *out_prim_out_86996, struct memblock_device chain_collisions_mem_81927, struct memblock_device chain_collisions_mem_81928, struct memblock_device clBase_mem_81929, struct memblock_device clBase_mem_81930, struct memblock_device clBase_mem_81931, struct memblock_device clBase_mem_81932, struct memblock_device clProc_mem_81933, struct memblock_device clProc_mem_81934, struct memblock_device clProc_mem_81935, struct memblock_device clProc_mem_81936, struct memblock_device clProc_mem_81937, struct memblock_device clProc_mem_81938, struct memblock_device current_partition_mem_81939, struct memblock_device current_partition_mem_81940, struct memblock_device current_partition_mem_81941, struct memblock_device current_partition_mem_81942, struct memblock_device current_partition_mem_81943, struct memblock_device current_partition_mem_81944, struct memblock_device current_partition_mem_81945, struct memblock_device current_partition_mem_81946, struct memblock_device current_partition_mem_81947, struct memblock_device current_partition_mem_81948, struct memblock_device toFlush_dat_mem_81949, struct memblock_device toFlush_dat_mem_81950, struct memblock_device toFlush_ids_mem_81951, int64_t n_31684, int64_t part_no_31685, int64_t dz2084U_31686, int64_t dz2080U_31687, int64_t dz2081U_31688, int64_t dz2082U_31689, int64_t dz2083U_31690, int64_t dz2085U_31691, int64_t dz2086U_31692, int8_t clBase_31695, int8_t clBase_31696, double clBase_31697, int64_t clBase_31698, int64_t clBase_31700, double clBase_31703, int64_t clBase_31705, int64_t clProc_31710, int64_t clProc_31711, int64_t clProc_31712, int64_t clProc_31714, int64_t clProc_31715, int64_t current_partition_31727)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_81954;
    
    mem_81954.references = NULL;
    
    struct memblock_device mem_81963;
    
    mem_81963.references = NULL;
    
    struct memblock_device mem_81961;
    
    mem_81961.references = NULL;
    
    struct memblock_device incprefixes_mem_83211;
    
    incprefixes_mem_83211.references = NULL;
    
    struct memblock_device aggregates_mem_83209;
    
    aggregates_mem_83209.references = NULL;
    
    struct memblock_device status_flags_mem_83187;
    
    status_flags_mem_83187.references = NULL;
    
    struct memblock_device mem_81959;
    
    mem_81959.references = NULL;
    
    struct memblock_device mem_81957;
    
    mem_81957.references = NULL;
    
    struct memblock_device ext_mem_81964;
    
    ext_mem_81964.references = NULL;
    
    struct memblock_device segred_tmp_mem_83149;
    
    segred_tmp_mem_83149.references = NULL;
    
    struct memblock_device mem_81953;
    
    mem_81953.references = NULL;
    
    struct memblock_device mem_81965;
    
    mem_81965.references = NULL;
    
    struct memblock_device ext_mem_81966;
    
    ext_mem_81966.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83117;
    int64_t zeze_rhs_54143 = sub64(part_no_31685, (int64_t) 1);
    bool cond_54144 = clProc_31712 == zeze_rhs_54143;
    int64_t next_partition_to_read_res_54145;
    
    if (cond_54144) {
        next_partition_to_read_res_54145 = (int64_t) -1;
    } else {
        bool cond_54146 = slt64((int64_t) 0, dz2083U_31690);
        int64_t segred_tblock_sizze_66864;
        
        segred_tblock_sizze_66864 = *ctx->tuning_params.next_partition_to_read_doublezisegred_tblock_sizze_66863;
        
        int64_t num_tblocks_66866;
        int64_t max_num_tblocks_83118;
        
        max_num_tblocks_83118 = *ctx->tuning_params.next_partition_to_read_doublezisegred_num_tblocks_66865;
        num_tblocks_66866 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(part_no_31685, segred_tblock_sizze_66864), max_num_tblocks_83118)));
        
        bool cond_54160 = part_no_31685 == (int64_t) 0;
        bool x_54161 = !cond_54160;
        bool x_54162 = sle64((int64_t) 0, zeze_rhs_54143);
        bool y_54163 = slt64(zeze_rhs_54143, part_no_31685);
        bool bounds_check_54164 = x_54162 && y_54163;
        bool protect_assert_disj_54165 = cond_54160 || bounds_check_54164;
        int64_t segscan_tblock_sizze_66874;
        
        segscan_tblock_sizze_66874 = *ctx->tuning_params.next_partition_to_read_doublezisegscan_tblock_sizze_66873;
        
        int64_t num_tblocks_66876;
        int64_t max_num_tblocks_83119;
        
        max_num_tblocks_83119 = *ctx->tuning_params.next_partition_to_read_doublezisegscan_num_tblocks_66875;
        num_tblocks_66876 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(part_no_31685, segscan_tblock_sizze_66874), max_num_tblocks_83119)));
        
        int64_t bytes_81956 = (int64_t) 8 * part_no_31685;
        
        if (cond_54146) {
            bool index_certs_63911;
            
            if (!cond_54146) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2083U_31690, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:259:51-84\n   #1  ft_libs/ftDBSCAN_plus.fut:1032:18-1034:57\n   #2  ft_libs/ftDBSCAN_plus.fut:1031:9-1034:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_81965, (int64_t) 8, "mem_81965")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_next_partition_to_read_doublezigpuseq_83120(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, clProc_mem_81938.mem, mem_81965.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_81966, &mem_81965, "mem_81965") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_81953, (int64_t) 8, "mem_81953")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_83126 = (int64_t) 1;
            
            if (memblock_alloc_device(ctx, &segred_tmp_mem_83149, (int64_t) 8 * num_tblocks_66866, "segred_tmp_mem_83149")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_83151 = num_tblocks_66866 * segred_tblock_sizze_66864;
            
            {
                err = gpu_kernel_next_partition_to_read_doublezisegred_nonseg_66871(ctx, num_tblocks_66866, 1, 1, *ctx->tuning_params.next_partition_to_read_doublezisegred_tblock_sizze_66863, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_66864 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_66864, (int64_t) 8), (int64_t) 8)), part_no_31685, num_tblocks_66866, num_threads_83151, clProc_mem_81937.mem, mem_81953.mem, counters_mem_83127.mem, segred_tmp_mem_83149.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t read_res_86997;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_86997, mem_81953.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_res_63964 = read_res_86997;
            
            if (memblock_unref_device(ctx, &mem_81953, "mem_81953") != 0)
                return 1;
            
            bool cond_54159 = slt64((int64_t) 0, defunc_res_63964);
            bool loop_not_taken_54166 = !cond_54159;
            bool protect_assert_disj_54167 = protect_assert_disj_54165 || loop_not_taken_54166;
            bool index_certs_54168;
            
            if (!protect_assert_disj_54167) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_54143, "] out of bounds for array of shape [", (long long) part_no_31685, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1032:18-1034:57\n   #3  ft_libs/ftDBSCAN_plus.fut:1031:9-1034:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (cond_54159) {
                if (memblock_alloc_device(ctx, &mem_81957, bytes_81956, "mem_81957")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_81959, bytes_81956, "mem_81959")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64((int64_t) 0, part_no_31685)) {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegScan");
                    
                    int64_t shared_memory_83180;
                    
                    shared_memory_83180 = ctx->max_shared_memory;
                    
                    int64_t thread_block_sizze_83181;
                    
                    thread_block_sizze_83181 = ctx->max_thread_block_size;
                    
                    int64_t registers_83182;
                    
                    registers_83182 = ctx->max_registers;
                    
                    int64_t thread_block_sizze_83183;
                    
                    thread_block_sizze_83183 = ctx->max_thread_block_size;
                    
                    int64_t chunk_sizze_83184 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_83180, thread_block_sizze_83181), (int64_t) 8), squot64(squot64(registers_83182, thread_block_sizze_83183) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
                    int64_t num_virt_blocks_83185 = sdiv_up64(part_no_31685, segscan_tblock_sizze_66874 * chunk_sizze_83184);
                    int64_t num_virt_threads_83186 = num_virt_blocks_83185 * segscan_tblock_sizze_66874;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_83184, '\n');
                    if (memblock_alloc_device(ctx, &status_flags_mem_83187, num_virt_blocks_83185, "status_flags_mem_83187")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_83187, num_virt_blocks_83185, (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &aggregates_mem_83209, (int64_t) 8 * num_virt_blocks_83185, "aggregates_mem_83209")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &incprefixes_mem_83211, (int64_t) 8 * num_virt_blocks_83185, "incprefixes_mem_83211")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_next_partition_to_read_doublezisegscan_66879(ctx, num_tblocks_66876, 1, 1, *ctx->tuning_params.next_partition_to_read_doublezisegscan_tblock_sizze_66873, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_66874), chunk_sizze_83184 * segscan_tblock_sizze_66874 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_66874), chunk_sizze_83184 * segscan_tblock_sizze_66874 * (int64_t) 8), (int64_t) 8), (int64_t) 8), part_no_31685, num_tblocks_66876, num_virt_blocks_83185, num_virt_threads_83186, clProc_mem_81937.mem, mem_81957.mem, mem_81959.mem, status_flags_mem_83187.mem, aggregates_mem_83209.mem, incprefixes_mem_83211.mem, global_dynid_mem_83213.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                }
                
                int64_t m_f_res_63935;
                
                if (x_54161) {
                    int64_t read_res_86998;
                    
                    if ((err = gpu_scalar_from_device(ctx, &read_res_86998, mem_81957.mem, zeze_rhs_54143 * sizeof(int64_t), sizeof(int64_t))) != 0)
                        goto cleanup;
                    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t x_63936 = read_res_86998;
                    
                    m_f_res_63935 = x_63936;
                } else {
                    m_f_res_63935 = (int64_t) 0;
                }
                
                int64_t m_63937;
                
                if (cond_54160) {
                    m_63937 = (int64_t) 0;
                } else {
                    m_63937 = m_f_res_63935;
                }
                
                int64_t m_63938 = sub64(m_63937, (int64_t) 1);
                bool i_p_m_t_s_leq_w_63939 = slt64(m_63938, part_no_31685);
                bool zzero_leq_i_p_m_t_s_63940 = sle64((int64_t) 0, m_63938);
                bool y_63941 = i_p_m_t_s_leq_w_63939 && zzero_leq_i_p_m_t_s_63940;
                bool i_lte_j_63942 = sle64((int64_t) 0, m_63937);
                bool forwards_ok_63943 = y_63941 && i_lte_j_63942;
                bool eq_x_zz_63944 = (int64_t) 0 == m_f_res_63935;
                bool p_and_eq_x_y_63945 = x_54161 && eq_x_zz_63944;
                bool empty_slice_63946 = cond_54160 || p_and_eq_x_y_63945;
                bool ok_or_empty_63947 = forwards_ok_63943 || empty_slice_63946;
                bool index_certs_63948;
                
                if (!ok_or_empty_63947) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_63937, "] out of bounds for array of shape [", (long long) part_no_31685, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftDBSCAN_plus.fut:1032:18-1034:57\n   #3  ft_libs/ftDBSCAN_plus.fut:1031:9-1034:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_81960 = (int64_t) 8 * m_63937;
                bool y_63961 = slt64((int64_t) 0, m_63937);
                bool index_certs_63962;
                
                if (!y_63961) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_63937, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:267:44-56\n   #1  ft_libs/ftDBSCAN_plus.fut:1032:18-1034:57\n   #2  ft_libs/ftDBSCAN_plus.fut:1031:9-1034:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &mem_81961, bytes_81960, "mem_81961")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhiota_i64(ctx, mem_81961, m_63937, (int64_t) 0, (int64_t) 1) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t segmap_tblock_sizze_66884;
                
                segmap_tblock_sizze_66884 = *ctx->tuning_params.next_partition_to_read_doublezisegmap_tblock_sizze_66883;
                
                int64_t num_tblocks_66886;
                int64_t max_num_tblocks_83319;
                
                max_num_tblocks_83319 = *ctx->tuning_params.next_partition_to_read_doublezisegmap_num_tblocks_66885;
                num_tblocks_66886 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(part_no_31685, segmap_tblock_sizze_66884), max_num_tblocks_83319)));
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_83320 = sext_i64_i32(sdiv_up64(part_no_31685, segmap_tblock_sizze_66884));
                
                {
                    err = gpu_kernel_next_partition_to_read_doublezisegmap_66881(ctx, num_tblocks_66886, 1, 1, *ctx->tuning_params.next_partition_to_read_doublezisegmap_tblock_sizze_66883, 1, 1, (int64_t) 0, part_no_31685, m_63937, num_tblocks_66886, virt_num_tblocks_83320, mem_81957.mem, mem_81959.mem, mem_81961.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &mem_81957, "mem_81957") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_81959, "mem_81959") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_81963, (int64_t) 8, "mem_81963")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_next_partition_to_read_doublezigpuseq_83333(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, mem_81961.mem, mem_81963.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (memblock_unref_device(ctx, &mem_81961, "mem_81961") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_81964, &mem_81963, "mem_81963") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &mem_81954, (int64_t) 8, "mem_81954")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, mem_81954, (int64_t) 1, (int64_t) -1) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_set_device(ctx, &ext_mem_81964, &mem_81954, "mem_81954") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &ext_mem_81966, &ext_mem_81964, "ext_mem_81964") != 0)
                return 1;
        }
        
        int64_t read_res_86999;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_86999, ext_mem_81966.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t next_partition_to_read_res_f_res_54147 = read_res_86999;
        
        if (memblock_unref_device(ctx, &ext_mem_81966, "ext_mem_81966") != 0)
            return 1;
        next_partition_to_read_res_54145 = next_partition_to_read_res_f_res_54147;
    }
    prim_out_83117 = next_partition_to_read_res_54145;
    *out_prim_out_86996 = prim_out_83117;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_81954, "mem_81954") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81963, "mem_81963") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81961, "mem_81961") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_83211, "incprefixes_mem_83211") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_83209, "aggregates_mem_83209") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_83187, "status_flags_mem_83187") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81959, "mem_81959") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81957, "mem_81957") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81964, "ext_mem_81964") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_83149, "segred_tmp_mem_83149") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81953, "mem_81953") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81965, "mem_81965") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81966, "ext_mem_81966") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_rectify_cluster_ids_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_87000, struct memblock_device chain_ids_mem_81927, struct memblock_device chain_id_mem_81928, struct memblock_device replaceWith_mem_81929, int64_t n_51920, int64_t dz2081Uz2080U_51921, int64_t dz2081Uz2081U_51922, int64_t ncc_51925, int64_t gather_psizze_51927)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_81943;
    
    mem_81943.references = NULL;
    
    struct memblock_device mem_param_tmp_83138;
    
    mem_param_tmp_83138.references = NULL;
    
    struct memblock_device mem_81937;
    
    mem_81937.references = NULL;
    
    struct memblock_device mem_param_81934;
    
    mem_param_81934.references = NULL;
    
    struct memblock_device ext_mem_81940;
    
    ext_mem_81940.references = NULL;
    
    struct memblock_device mem_81931;
    
    mem_81931.references = NULL;
    
    struct memblock_device ext_mem_81944;
    
    ext_mem_81944.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    bool cond_53622 = ncc_51925 == (int64_t) 0;
    int64_t bytes_81930 = (int64_t) 8 * n_51920;
    
    if (cond_53622) {
        if (memblock_set_device(ctx, &ext_mem_81944, &chain_ids_mem_81927, "chain_ids_mem_81927") != 0)
            return 1;
    } else {
        double i64_res_53624 = sitofp_i64_f64(ncc_51925);
        double log2_res_53625 = futrts_log2_64(i64_res_53624);
        double ceil_res_53626 = futrts_ceil64(log2_res_53625);
        int64_t f64_res_53627 = fptosi_f64_i64(ceil_res_53626);
        int64_t num_iter_53628 = add64((int64_t) 1, f64_res_53627);
        
        if (memblock_alloc_device(ctx, &mem_81931, bytes_81930, "mem_81931")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_81931, n_51920, (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t segmap_tblock_sizze_74985;
        
        segmap_tblock_sizze_74985 = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_74934;
        
        int64_t segmap_usable_groups_74986 = sdiv_up_safe64(n_51920, segmap_tblock_sizze_74985);
        int64_t bsearch_53631;
        int64_t last_step_53634;
        
        if (memblock_set_device(ctx, &mem_param_81934, &mem_81931, "mem_81931") != 0)
            return 1;
        last_step_53634 = ncc_51925;
        for (int64_t i_53632 = 0; i_53632 < num_iter_53628; i_53632++) {
            int64_t zs_lhs_53635 = add64((int64_t) 1, last_step_53634);
            int64_t this_step_53636 = sdiv64(zs_lhs_53635, (int64_t) 2);
            
            if (memblock_alloc_device(ctx, &mem_81937, bytes_81930, "mem_81937")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83141 = sext_i64_i32(sdiv_up64(n_51920, segmap_tblock_sizze_74985));
            
            {
                err = gpu_kernel_rectify_cluster_ids_doublezisegmap_74989(ctx, segmap_usable_groups_74986, 1, 1, *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_74934, 1, 1, (int64_t) 0, n_51920, dz2081Uz2080U_51921, ncc_51925, this_step_53636, chain_ids_mem_81927.mem, chain_id_mem_81928.mem, mem_param_81934.mem, mem_81937.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &mem_param_tmp_83138, &mem_81937, "mem_81937") != 0)
                return 1;
            
            int64_t last_step_tmp_83140 = this_step_53636;
            
            if (memblock_set_device(ctx, &mem_param_81934, &mem_param_tmp_83138, "mem_param_tmp_83138") != 0)
                return 1;
            last_step_53634 = last_step_tmp_83140;
        }
        if (memblock_set_device(ctx, &ext_mem_81940, &mem_param_81934, "mem_param_81934") != 0)
            return 1;
        bsearch_53631 = last_step_53634;
        if (memblock_unref_device(ctx, &mem_81931, "mem_81931") != 0)
            return 1;
        
        int64_t segmap_tblock_sizze_75057;
        
        segmap_tblock_sizze_75057 = *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_75038;
        
        int64_t segmap_usable_groups_75058 = sdiv_up64(n_51920, segmap_tblock_sizze_75057);
        
        if (memblock_alloc_device(ctx, &mem_81943, bytes_81930, "mem_81943")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_83150 = sext_i64_i32(sdiv_up64(n_51920, segmap_tblock_sizze_75057));
        
        {
            err = gpu_kernel_rectify_cluster_ids_doublezisegmap_75061(ctx, segmap_usable_groups_75058, 1, 1, *ctx->tuning_params.rectify_cluster_ids_doublezisegmap_tblock_sizze_75038, 1, 1, (int64_t) 0, n_51920, dz2081Uz2081U_51922, chain_ids_mem_81927.mem, replaceWith_mem_81929.mem, ext_mem_81940.mem, mem_81943.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_81940, "ext_mem_81940") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_81944, &mem_81943, "mem_81943") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &mem_out_83117, &ext_mem_81944, "ext_mem_81944") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_87000, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_81943, "mem_81943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_83138, "mem_param_tmp_83138") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81937, "mem_81937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_81934, "mem_param_81934") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81940, "ext_mem_81940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81931, "mem_81931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_81944, "ext_mem_81944") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_num_neighbours_against_11932(struct futhark_context *ctx, struct memblock_device *mem_out_p_87001, struct memblock_device dat1_mem_81927, struct memblock_device dat1_mem_81928, struct memblock_device dat2_mem_81929, struct memblock_device dat2_mem_81930, int64_t n1_37899, int64_t n2_37900, double eps_37905, int8_t dist_t_37906, int8_t angle_t_37907, double radius_37908, int64_t m_sizze_37909)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_83199;
    
    segred_tmp_mem_83199.references = NULL;
    
    struct memblock_device mem_81942;
    
    mem_81942.references = NULL;
    
    struct memblock_device mem_81940;
    
    mem_81940.references = NULL;
    
    struct memblock_device mem_81938;
    
    mem_81938.references = NULL;
    
    struct memblock_device mem_81932;
    
    mem_81932.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t max_res_52015 = smax64((int64_t) 1, n2_37900);
    bool zzero_37912 = max_res_52015 == (int64_t) 0;
    bool nonzzero_37913 = !zzero_37912;
    bool nonzzero_cert_37914;
    
    if (!nonzzero_37913) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:505:55-69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_37915 = sdiv64(m_sizze_37909, max_res_52015);
    int64_t max_res_52018 = smax64((int64_t) 1, max_arg1_37915);
    int64_t zm_lhs_37919 = add64(n1_37899, max_res_52018);
    int64_t zs_lhs_37921 = sub64(zm_lhs_37919, (int64_t) 1);
    bool zzero_37923 = max_res_52018 == (int64_t) 0;
    bool nonzzero_37924 = !zzero_37923;
    bool nonzzero_cert_37925;
    
    if (!nonzzero_37924) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:506:57-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_iter_37926 = sdiv64(zs_lhs_37921, max_res_52018);
    int64_t bytes_81931 = (int64_t) 8 * n1_37899;
    bool bounds_invalid_upwards_52020 = slt64(num_iter_37926, (int64_t) 0);
    bool valid_52021 = !bounds_invalid_upwards_52020;
    bool range_valid_c_52022;
    
    if (!valid_52021) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_iter_37926, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:507:69-82\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81932, bytes_81931, "mem_81932")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81932, n1_37899, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_74594;
    
    segmap_tblock_sizze_74594 = *ctx->tuning_params.get_num_neighbours_against_11932zisegmap_tblock_sizze_74579;
    
    int64_t segred_tblock_sizze_74612;
    
    segred_tblock_sizze_74612 = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521;
    
    int64_t tile_sizze_78072;
    
    tile_sizze_78072 = *ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071;
    
    bool match_val_81813 = dist_t_37906 == (int8_t) 0;
    bool x_81814 = !match_val_81813;
    int64_t num_whole_tiles_78117 = squot_safe64(n2_37900, tile_sizze_78072);
    int64_t residual_input_78330 = srem_safe64(n2_37900, tile_sizze_78072);
    bool cond_78331 = residual_input_78330 == (int64_t) 0;
    int64_t binop_x_78344 = tile_sizze_78072 * num_whole_tiles_78117;
    int64_t bytes_81972 = (int64_t) 8 * tile_sizze_78072;
    
    for (int64_t i_37932 = 0; i_37932 < num_iter_37926; i_37932++) {
        int64_t inf_37935 = mul64(i_37932, max_res_52018);
        int64_t min_arg1_37937 = add64(inf_37935, max_res_52018);
        int64_t min_res_52030 = smin64(n1_37899, min_arg1_37937);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941 = sub64(min_res_52030, inf_37935);
        bool empty_slice_37953 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941 == (int64_t) 0;
        int64_t m_37954 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, (int64_t) 1);
        int64_t i_p_m_t_s_37956 = add64(inf_37935, m_37954);
        bool zzero_leq_i_p_m_t_s_37957 = sle64((int64_t) 0, i_p_m_t_s_37956);
        bool i_p_m_t_s_leq_w_37959 = slt64(i_p_m_t_s_37956, n1_37899);
        bool zzero_lte_i_37960 = sle64((int64_t) 0, inf_37935);
        bool i_lte_j_37961 = sle64(inf_37935, min_res_52030);
        bool y_37962 = i_p_m_t_s_leq_w_37959 && zzero_lte_i_37960;
        bool y_37963 = zzero_leq_i_p_m_t_s_37957 && y_37962;
        bool forwards_ok_37964 = i_lte_j_37961 && y_37963;
        bool ok_or_empty_37971 = empty_slice_37953 || forwards_ok_37964;
        bool index_certs_37973;
        
        if (!ok_or_empty_37971) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_37935, ":", (long long) min_res_52030, "] out of bounds for array of shape [", (long long) n1_37899, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:510:47-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_74400;
        
        suff_outer_par_74400 = *ctx->tuning_params.get_num_neighbours_against_11932zisuff_outer_par_0 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "get_num_neighbours_against_11932.suff_outer_par_0", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, suff_outer_par_74400 ? "true" : "false");
        
        int64_t nest_sizze_74611 = n2_37900 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;
        int64_t num_tblocks_74613;
        int64_t max_num_tblocks_83139;
        
        max_num_tblocks_83139 = *ctx->tuning_params.get_num_neighbours_against_11932zisegred_num_tblocks_74523;
        num_tblocks_74613 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_74611, segred_tblock_sizze_74612), max_num_tblocks_83139)));
        
        int64_t bytes_81937 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;
        int64_t shared_memory_capacity_83258;
        
        shared_memory_capacity_83258 = ctx->max_shared_memory;
        if (suff_outer_par_74400 && sle64(sdiv_up64(bytes_81972, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_81972, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83258)) {
            int64_t ldim_78073 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, tile_sizze_78072);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_83140 = sext_i64_i32(sdiv_up64(tile_sizze_78072, tile_sizze_78072));
            int32_t virt_num_tblocks_83141 = sext_i64_i32(ldim_78073);
            
            {
                err = gpu_kernel_get_num_neighbours_against_11932zisegmap_intrablock_78070(ctx, ldim_78073, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11932zitile_sizze_78071, 1, 1, bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8) + (bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8)), n2_37900, eps_37905, dist_t_37906, angle_t_37907, radius_37908, inf_37935, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, ldim_78073, num_whole_tiles_78117, residual_input_78330, cond_78331, binop_x_78344, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        } else {
            int64_t segmap_usable_groups_74595 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, segmap_tblock_sizze_74594);
            
            if (memblock_alloc_device(ctx, &mem_81938, bytes_81937, "mem_81938")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_81940, bytes_81937, "mem_81940")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_81942, bytes_81937, "mem_81942")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83157 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, segmap_tblock_sizze_74594));
            
            {
                err = gpu_kernel_get_num_neighbours_against_11932zisegmap_74600(ctx, segmap_usable_groups_74595, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11932zisegmap_tblock_sizze_74579, 1, 1, (int64_t) 0, angle_t_37907, inf_37935, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, dat1_mem_81927.mem, dat1_mem_81928.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_83166 = (int64_t) 1;
            
            if (slt64(n2_37900 * (int64_t) 2, segred_tblock_sizze_74612 * chunk_sizze_83166)) {
                int64_t segment_sizze_nonzzero_83167 = smax64((int64_t) 1, n2_37900);
                int64_t num_threads_83168 = segred_tblock_sizze_74612 * segred_tblock_sizze_74612;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) n2_37900, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, squot64(segred_tblock_sizze_74612, segment_sizze_nonzzero_83167))), '\n');
                {
                    err = gpu_kernel_get_num_neighbours_against_11932zisegred_small_74618(ctx, num_tblocks_74613, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521, 1, 1, (int64_t) 8 * segred_tblock_sizze_74612 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74612, (int64_t) 8), (int64_t) 8), n2_37900, eps_37905, dist_t_37906, angle_t_37907, radius_37908, inf_37935, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, num_tblocks_74613, x_81814, segment_sizze_nonzzero_83167, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_83195 = sdiv_up64(num_tblocks_74613, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941));
                int64_t q_83196 = sdiv_up64(n2_37900, segred_tblock_sizze_74612 * blocks_per_segment_83195 * chunk_sizze_83166);
                int64_t num_virtblocks_83197 = blocks_per_segment_83195 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941;
                int64_t threads_per_segment_83198 = blocks_per_segment_83195 * segred_tblock_sizze_74612;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) n2_37900, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_83197, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_74613, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_74612, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_83196, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_83195, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_83199, (int64_t) 8 * num_virtblocks_83197, "segred_tmp_mem_83199")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_get_num_neighbours_against_11932zisegred_large_74618(ctx, num_tblocks_74613, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11932zisegred_tblock_sizze_74521, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_74612 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74612, (int64_t) 8), (int64_t) 8)), n2_37900, eps_37905, dist_t_37906, angle_t_37907, radius_37908, inf_37935, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_37941, num_tblocks_74613, x_81814, blocks_per_segment_83195, q_83196, num_virtblocks_83197, threads_per_segment_83198, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem, segred_tmp_mem_83199.mem, counters_mem_83201.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_81938, "mem_81938") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_81940, "mem_81940") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_81942, "mem_81942") != 0)
                return 1;
        }
    }
    if (memblock_set_device(ctx, &mem_out_83117, &mem_81932, "mem_81932") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_87001, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_83199, "segred_tmp_mem_83199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81942, "mem_81942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81940, "mem_81940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81938, "mem_81938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81932, "mem_81932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_num_neighbours_against_11935(struct futhark_context *ctx, struct memblock_device *mem_out_p_87002, struct memblock_device dat1_mem_81927, struct memblock_device dat1_mem_81928, struct memblock_device dat2_mem_81929, struct memblock_device dat2_mem_81930, int64_t n1_38160, int64_t n2_38161, double eps_38166, int8_t dist_t_38167, int8_t angle_t_38168, double radius_38169, int64_t m_sizze_38170)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_83199;
    
    segred_tmp_mem_83199.references = NULL;
    
    struct memblock_device mem_81942;
    
    mem_81942.references = NULL;
    
    struct memblock_device mem_81940;
    
    mem_81940.references = NULL;
    
    struct memblock_device mem_81938;
    
    mem_81938.references = NULL;
    
    struct memblock_device mem_81932;
    
    mem_81932.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t max_res_52015 = smax64((int64_t) 1, n2_38161);
    bool zzero_38173 = max_res_52015 == (int64_t) 0;
    bool nonzzero_38174 = !zzero_38173;
    bool nonzzero_cert_38175;
    
    if (!nonzzero_38174) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:505:55-69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_38176 = sdiv64(m_sizze_38170, max_res_52015);
    int64_t max_res_52018 = smax64((int64_t) 1, max_arg1_38176);
    int64_t zm_lhs_38180 = add64(n1_38160, max_res_52018);
    int64_t zs_lhs_38182 = sub64(zm_lhs_38180, (int64_t) 1);
    bool zzero_38184 = max_res_52018 == (int64_t) 0;
    bool nonzzero_38185 = !zzero_38184;
    bool nonzzero_cert_38186;
    
    if (!nonzzero_38185) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftDBSCAN_plus.fut:506:57-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_iter_38187 = sdiv64(zs_lhs_38182, max_res_52018);
    int64_t bytes_81931 = (int64_t) 8 * n1_38160;
    bool bounds_invalid_upwards_52020 = slt64(num_iter_38187, (int64_t) 0);
    bool valid_52021 = !bounds_invalid_upwards_52020;
    bool range_valid_c_52022;
    
    if (!valid_52021) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_iter_38187, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftDBSCAN_plus.fut:507:69-82\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_81932, bytes_81931, "mem_81932")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_81932, n1_38160, (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_74860;
    
    segmap_tblock_sizze_74860 = *ctx->tuning_params.get_num_neighbours_against_11935zisegmap_tblock_sizze_74845;
    
    int64_t segred_tblock_sizze_74878;
    
    segred_tblock_sizze_74878 = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787;
    
    int64_t tile_sizze_78072;
    
    tile_sizze_78072 = *ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071;
    
    bool match_val_81813 = dist_t_38167 == (int8_t) 0;
    bool x_81814 = !match_val_81813;
    int64_t num_whole_tiles_78117 = squot_safe64(n2_38161, tile_sizze_78072);
    int64_t residual_input_78330 = srem_safe64(n2_38161, tile_sizze_78072);
    bool cond_78331 = residual_input_78330 == (int64_t) 0;
    int64_t binop_x_78344 = tile_sizze_78072 * num_whole_tiles_78117;
    int64_t bytes_81972 = (int64_t) 8 * tile_sizze_78072;
    
    for (int64_t i_38193 = 0; i_38193 < num_iter_38187; i_38193++) {
        int64_t inf_38196 = mul64(i_38193, max_res_52018);
        int64_t min_arg1_38198 = add64(inf_38196, max_res_52018);
        int64_t min_res_52030 = smin64(n1_38160, min_arg1_38198);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202 = sub64(min_res_52030, inf_38196);
        bool empty_slice_38214 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202 == (int64_t) 0;
        int64_t m_38215 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, (int64_t) 1);
        int64_t i_p_m_t_s_38217 = add64(inf_38196, m_38215);
        bool zzero_leq_i_p_m_t_s_38218 = sle64((int64_t) 0, i_p_m_t_s_38217);
        bool i_p_m_t_s_leq_w_38220 = slt64(i_p_m_t_s_38217, n1_38160);
        bool zzero_lte_i_38221 = sle64((int64_t) 0, inf_38196);
        bool i_lte_j_38222 = sle64(inf_38196, min_res_52030);
        bool y_38223 = i_p_m_t_s_leq_w_38220 && zzero_lte_i_38221;
        bool y_38224 = zzero_leq_i_p_m_t_s_38218 && y_38223;
        bool forwards_ok_38225 = i_lte_j_38222 && y_38224;
        bool ok_or_empty_38232 = empty_slice_38214 || forwards_ok_38225;
        bool index_certs_38234;
        
        if (!ok_or_empty_38232) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_38196, ":", (long long) min_res_52030, "] out of bounds for array of shape [", (long long) n1_38160, "].", "-> #0  ft_libs/ftDBSCAN_plus.fut:510:47-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_74666;
        
        suff_outer_par_74666 = *ctx->tuning_params.get_num_neighbours_against_11935zisuff_outer_par_0 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "get_num_neighbours_against_11935.suff_outer_par_0", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, suff_outer_par_74666 ? "true" : "false");
        
        int64_t nest_sizze_74877 = n2_38161 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;
        int64_t num_tblocks_74879;
        int64_t max_num_tblocks_83139;
        
        max_num_tblocks_83139 = *ctx->tuning_params.get_num_neighbours_against_11935zisegred_num_tblocks_74789;
        num_tblocks_74879 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_74877, segred_tblock_sizze_74878), max_num_tblocks_83139)));
        
        int64_t bytes_81937 = (int64_t) 8 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;
        int64_t shared_memory_capacity_83258;
        
        shared_memory_capacity_83258 = ctx->max_shared_memory;
        if (suff_outer_par_74666 && sle64(sdiv_up64(bytes_81972, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_81972, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_83258)) {
            int64_t ldim_78073 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, tile_sizze_78072);
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_83140 = sext_i64_i32(sdiv_up64(tile_sizze_78072, tile_sizze_78072));
            int32_t virt_num_tblocks_83141 = sext_i64_i32(ldim_78073);
            
            {
                err = gpu_kernel_get_num_neighbours_against_11935zisegmap_intrablock_78070(ctx, ldim_78073, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11935zitile_sizze_78071, 1, 1, bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8) + (bytes_81972 + srem64((int64_t) 8 - srem64(bytes_81972, (int64_t) 8), (int64_t) 8)), n2_38161, eps_38166, dist_t_38167, angle_t_38168, radius_38169, inf_38196, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, ldim_78073, num_whole_tiles_78117, residual_input_78330, cond_78331, binop_x_78344, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        } else {
            int64_t segmap_usable_groups_74861 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, segmap_tblock_sizze_74860);
            
            if (memblock_alloc_device(ctx, &mem_81938, bytes_81937, "mem_81938")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_81940, bytes_81937, "mem_81940")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_81942, bytes_81937, "mem_81942")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_83157 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, segmap_tblock_sizze_74860));
            
            {
                err = gpu_kernel_get_num_neighbours_against_11935zisegmap_74866(ctx, segmap_usable_groups_74861, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11935zisegmap_tblock_sizze_74845, 1, 1, (int64_t) 0, angle_t_38168, inf_38196, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, dat1_mem_81927.mem, dat1_mem_81928.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_83166 = (int64_t) 1;
            
            if (slt64(n2_38161 * (int64_t) 2, segred_tblock_sizze_74878 * chunk_sizze_83166)) {
                int64_t segment_sizze_nonzzero_83167 = smax64((int64_t) 1, n2_38161);
                int64_t num_threads_83168 = segred_tblock_sizze_74878 * segred_tblock_sizze_74878;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) n2_38161, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, squot64(segred_tblock_sizze_74878, segment_sizze_nonzzero_83167))), '\n');
                {
                    err = gpu_kernel_get_num_neighbours_against_11935zisegred_small_74884(ctx, num_tblocks_74879, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787, 1, 1, (int64_t) 8 * segred_tblock_sizze_74878 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74878, (int64_t) 8), (int64_t) 8), n2_38161, eps_38166, dist_t_38167, angle_t_38168, radius_38169, inf_38196, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, num_tblocks_74879, x_81814, segment_sizze_nonzzero_83167, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_83195 = sdiv_up64(num_tblocks_74879, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202));
                int64_t q_83196 = sdiv_up64(n2_38161, segred_tblock_sizze_74878 * blocks_per_segment_83195 * chunk_sizze_83166);
                int64_t num_virtblocks_83197 = blocks_per_segment_83195 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202;
                int64_t threads_per_segment_83198 = blocks_per_segment_83195 * segred_tblock_sizze_74878;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) n2_38161, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_83197, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_74879, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_74878, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_83196, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_83195, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_83199, (int64_t) 8 * num_virtblocks_83197, "segred_tmp_mem_83199")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_get_num_neighbours_against_11935zisegred_large_74884(ctx, num_tblocks_74879, 1, 1, *ctx->tuning_params.get_num_neighbours_against_11935zisegred_tblock_sizze_74787, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_74878 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_74878, (int64_t) 8), (int64_t) 8)), n2_38161, eps_38166, dist_t_38167, angle_t_38168, radius_38169, inf_38196, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_38202, num_tblocks_74879, x_81814, blocks_per_segment_83195, q_83196, num_virtblocks_83197, threads_per_segment_83198, dat1_mem_81927.mem, dat1_mem_81928.mem, dat2_mem_81929.mem, dat2_mem_81930.mem, mem_81932.mem, mem_81938.mem, mem_81940.mem, mem_81942.mem, segred_tmp_mem_83199.mem, counters_mem_83201.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_81938, "mem_81938") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_81940, "mem_81940") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_81942, "mem_81942") != 0)
                return 1;
        }
    }
    if (memblock_set_device(ctx, &mem_out_83117, &mem_81932, "mem_81932") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_87002, &mem_out_83117, "mem_out_83117") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_83199, "segred_tmp_mem_83199") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81942, "mem_81942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81940, "mem_81940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81938, "mem_81938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_81932, "mem_81932") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_83117, "mem_out_83117") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_11636(struct futhark_context *ctx, bool *out_prim_out_87003, int64_t c1_48767, int64_t p1_48768, int64_t c2_48769, int64_t p2_48770)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    bool prim_out_83117;
    bool cond_48771 = slt64(c1_48767, c2_48769);
    bool cond_48773 = c1_48767 == c2_48769;
    bool lifted_lambda_res_f_res_t_res_48775 = sle64(p1_48768, p2_48770);
    bool x_51932 = cond_48773 && lifted_lambda_res_f_res_t_res_48775;
    bool x_51930 = !cond_48771;
    bool y_51931 = x_51930 && x_51932;
    bool lifted_lambda_res_48772 = cond_48771 || y_51931;
    
    prim_out_83117 = lifted_lambda_res_48772;
    *out_prim_out_87003 = prim_out_83117;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_11537(struct futhark_context *ctx, int64_t *out_prim_out_87004, int64_t *out_prim_out_87005, int64_t *out_prim_out_87006, int64_t *out_prim_out_87007, int64_t *out_prim_out_87008, int64_t slo_49016, int64_t shi_49017, int64_t tlo_49018, int64_t thi_49019, int64_t count_49020)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
    struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
    struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
    struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
    struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
    struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
    struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
    struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
    struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
    struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
    struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
    struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
    struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
    struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
    struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
    struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
    struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
    struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
    struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
    struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
    struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
    struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
    struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
    struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
    struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
    struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
    struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
    struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
    struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
    struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
    struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
    struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
    struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
    struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
    struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
    struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
    struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
    struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
    struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
    struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
    struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
    struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
    int64_t prim_out_83117;
    int64_t prim_out_83118;
    int64_t prim_out_83119;
    int64_t prim_out_83120;
    int64_t prim_out_83121;
    int64_t min_arg1_49023 = add64(slo_49016, count_49020);
    int64_t min_res_52015 = smin64(shi_49017, min_arg1_49023);
    int64_t min_arg1_49027 = add64(tlo_49018, count_49020);
    int64_t min_res_52018 = smin64(thi_49019, min_arg1_49027);
    int64_t zp_lhs_49031 = sub64(min_res_52015, slo_49016);
    int64_t zp_rhs_49033 = sub64(min_res_52018, tlo_49018);
    int64_t zm_lhs_49035 = add64(zp_lhs_49031, zp_rhs_49033);
    int64_t slack_49037 = sub64(zm_lhs_49035, count_49020);
    int64_t min_res_52021 = smin64(zp_lhs_49031, slack_49037);
    int64_t min_res_52024 = smin64(zp_rhs_49033, min_res_52021);
    int64_t max_arg1_49047 = sub64(min_res_52015, min_res_52024);
    int64_t max_res_52027 = smax64(slo_49016, max_arg1_49047);
    int64_t max_arg1_49051 = sub64(min_res_52018, min_res_52024);
    int64_t max_res_52030 = smax64(tlo_49018, max_arg1_49051);
    int64_t zm_rhs_49055 = sub64(max_res_52027, slo_49016);
    int64_t zm_lhs_49057 = sub64(count_49020, zm_rhs_49055);
    int64_t zm_rhs_49059 = sub64(max_res_52030, tlo_49018);
    int64_t count_49061 = sub64(zm_lhs_49057, zm_rhs_49059);
    
    prim_out_83117 = max_res_52027;
    prim_out_83118 = min_res_52015;
    prim_out_83119 = max_res_52030;
    prim_out_83120 = min_res_52018;
    prim_out_83121 = count_49061;
    *out_prim_out_87004 = prim_out_83117;
    *out_prim_out_87005 = prim_out_83118;
    *out_prim_out_87006 = prim_out_83119;
    *out_prim_out_87007 = prim_out_83120;
    *out_prim_out_87008 = prim_out_83121;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_add_next_partition_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t n_old_36753 = (int64_t) 0;
    int64_t part_no_36754 = (int64_t) 0;
    int64_t dz2084U_36755 = (int64_t) 0;
    int64_t dz2080U_36756 = (int64_t) 0;
    int64_t dz2081U_36757 = (int64_t) 0;
    int64_t dz2082U_36758 = (int64_t) 0;
    int64_t dz2083U_36759 = (int64_t) 0;
    int64_t dz2085U_36760 = (int64_t) 0;
    int64_t dz2086U_36761 = (int64_t) 0;
    int64_t n_new_36762 = (int64_t) 0;
    int8_t clBase_36765 = (int8_t) 0;
    int8_t clBase_36766 = (int8_t) 0;
    double clBase_36767 = 0.0;
    int64_t clBase_36768 = (int64_t) 0;
    int64_t clBase_36770 = (int64_t) 0;
    double clBase_36773 = 0.0;
    int64_t clBase_36775 = (int64_t) 0;
    int64_t clProc_36780 = (int64_t) 0;
    int64_t clProc_36781 = (int64_t) 0;
    int64_t clProc_36782 = (int64_t) 0;
    int64_t clProc_36784 = (int64_t) 0;
    int64_t clProc_36785 = (int64_t) 0;
    int64_t current_partition_36797 = (int64_t) 0;
    int64_t new_id_36801 = (int64_t) 0;
    int64_t prim_out_83142 = (int64_t) 0;
    int64_t prim_out_83143 = (int64_t) 0;
    int64_t prim_out_83144 = (int64_t) 0;
    int8_t prim_out_83145 = (int8_t) 0;
    int8_t prim_out_83146 = (int8_t) 0;
    double prim_out_83147 = 0.0;
    int64_t prim_out_83148 = (int64_t) 0;
    int64_t prim_out_83149 = (int64_t) 0;
    double prim_out_83150 = 0.0;
    int64_t prim_out_83151 = (int64_t) 0;
    int64_t prim_out_83152 = (int64_t) 0;
    int64_t prim_out_83153 = (int64_t) 0;
    int64_t prim_out_83154 = (int64_t) 0;
    int64_t prim_out_83155 = (int64_t) 0;
    int64_t prim_out_83156 = (int64_t) 0;
    int64_t prim_out_83157 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device new_ys_mem_81953;
    
    new_ys_mem_81953.references = NULL;
    
    struct memblock_device new_xs_mem_81952;
    
    new_xs_mem_81952.references = NULL;
    
    struct memblock_device toFlush_ids_mem_81951;
    
    toFlush_ids_mem_81951.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81950;
    
    toFlush_dat_mem_81950.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81949;
    
    toFlush_dat_mem_81949.references = NULL;
    
    struct memblock_device current_partition_mem_81948;
    
    current_partition_mem_81948.references = NULL;
    
    struct memblock_device current_partition_mem_81947;
    
    current_partition_mem_81947.references = NULL;
    
    struct memblock_device current_partition_mem_81946;
    
    current_partition_mem_81946.references = NULL;
    
    struct memblock_device current_partition_mem_81945;
    
    current_partition_mem_81945.references = NULL;
    
    struct memblock_device current_partition_mem_81944;
    
    current_partition_mem_81944.references = NULL;
    
    struct memblock_device current_partition_mem_81943;
    
    current_partition_mem_81943.references = NULL;
    
    struct memblock_device current_partition_mem_81942;
    
    current_partition_mem_81942.references = NULL;
    
    struct memblock_device current_partition_mem_81941;
    
    current_partition_mem_81941.references = NULL;
    
    struct memblock_device current_partition_mem_81940;
    
    current_partition_mem_81940.references = NULL;
    
    struct memblock_device current_partition_mem_81939;
    
    current_partition_mem_81939.references = NULL;
    
    struct memblock_device clProc_mem_81938;
    
    clProc_mem_81938.references = NULL;
    
    struct memblock_device clProc_mem_81937;
    
    clProc_mem_81937.references = NULL;
    
    struct memblock_device clProc_mem_81936;
    
    clProc_mem_81936.references = NULL;
    
    struct memblock_device clProc_mem_81935;
    
    clProc_mem_81935.references = NULL;
    
    struct memblock_device clProc_mem_81934;
    
    clProc_mem_81934.references = NULL;
    
    struct memblock_device clProc_mem_81933;
    
    clProc_mem_81933.references = NULL;
    
    struct memblock_device clBase_mem_81932;
    
    clBase_mem_81932.references = NULL;
    
    struct memblock_device clBase_mem_81931;
    
    clBase_mem_81931.references = NULL;
    
    struct memblock_device clBase_mem_81930;
    
    clBase_mem_81930.references = NULL;
    
    struct memblock_device clBase_mem_81929;
    
    clBase_mem_81929.references = NULL;
    
    struct memblock_device chain_collisions_mem_81928;
    
    chain_collisions_mem_81928.references = NULL;
    
    struct memblock_device chain_collisions_mem_81927;
    
    chain_collisions_mem_81927.references = NULL;
    chain_collisions_mem_81927 = in0->v0->mem;
    dz2084U_36755 = in0->v0->shape[0];
    chain_collisions_mem_81928 = in0->v1->mem;
    dz2084U_36755 = in0->v1->shape[0];
    clBase_36765 = in0->v2;
    clBase_36766 = in0->v3;
    clBase_36767 = in0->v4;
    clBase_36768 = in0->v5;
    clBase_mem_81929 = in0->v6->mem;
    clBase_36770 = in0->v7;
    clBase_mem_81930 = in0->v8->mem;
    clBase_mem_81931 = in0->v9->mem;
    clBase_36773 = in0->v10;
    clBase_mem_81932 = in0->v11->mem;
    clBase_36775 = in0->v12;
    clProc_mem_81933 = in0->v13->mem;
    dz2080U_36756 = in0->v13->shape[0];
    clProc_mem_81934 = in0->v14->mem;
    dz2081U_36757 = in0->v14->shape[0];
    clProc_mem_81935 = in0->v15->mem;
    dz2082U_36758 = in0->v15->shape[0];
    clProc_mem_81936 = in0->v16->mem;
    dz2082U_36758 = in0->v16->shape[0];
    clProc_36780 = in0->v17;
    clProc_36781 = in0->v18;
    clProc_36782 = in0->v19;
    clProc_mem_81937 = in0->v20->mem;
    part_no_36754 = in0->v20->shape[0];
    clProc_36784 = in0->v21;
    clProc_36785 = in0->v22;
    clProc_mem_81938 = in0->v23->mem;
    dz2083U_36759 = in0->v23->shape[0];
    current_partition_mem_81939 = in0->v24->mem;
    n_old_36753 = in0->v24->shape[0];
    current_partition_mem_81940 = in0->v25->mem;
    n_old_36753 = in0->v25->shape[0];
    current_partition_mem_81941 = in0->v26->mem;
    n_old_36753 = in0->v26->shape[0];
    current_partition_mem_81942 = in0->v27->mem;
    n_old_36753 = in0->v27->shape[0];
    current_partition_mem_81943 = in0->v28->mem;
    n_old_36753 = in0->v28->shape[0];
    current_partition_mem_81944 = in0->v29->mem;
    current_partition_mem_81945 = in0->v30->mem;
    n_old_36753 = in0->v30->shape[0];
    current_partition_mem_81946 = in0->v31->mem;
    current_partition_mem_81947 = in0->v32->mem;
    current_partition_mem_81948 = in0->v33->mem;
    current_partition_36797 = in0->v34;
    toFlush_dat_mem_81949 = in0->v35->mem;
    dz2085U_36760 = in0->v35->shape[0];
    toFlush_dat_mem_81950 = in0->v36->mem;
    dz2085U_36760 = in0->v36->shape[0];
    toFlush_ids_mem_81951 = in0->v37->mem;
    dz2086U_36761 = in0->v37->shape[0];
    new_id_36801 = in1;
    new_xs_mem_81952 = in2->mem;
    n_new_36762 = in2->shape[0];
    new_ys_mem_81953 = in3->mem;
    n_new_36762 = in3->shape[0];
    if (!((dz2084U_36755 == in0->v0->shape[0] && (dz2084U_36755 == in0->v1->shape[0] && ((int64_t) 2 == in0->v6->shape[0] && ((int64_t) 2 == in0->v8->shape[0] && ((int64_t) 2 == in0->v9->shape[0] && ((int64_t) 2 == in0->v11->shape[0] && (dz2080U_36756 == in0->v13->shape[0] && (dz2081U_36757 == in0->v14->shape[0] && (dz2082U_36758 == in0->v15->shape[0] && (dz2082U_36758 == in0->v16->shape[0] && (part_no_36754 == in0->v20->shape[0] && (dz2083U_36759 == in0->v23->shape[0] && (n_old_36753 == in0->v24->shape[0] && (n_old_36753 == in0->v25->shape[0] && (n_old_36753 == in0->v26->shape[0] && (n_old_36753 == in0->v27->shape[0] && (n_old_36753 == in0->v28->shape[0] && ((int64_t) 8 == in0->v29->shape[0] && (n_old_36753 == in0->v30->shape[0] && ((int64_t) 2 == in0->v31->shape[0] && ((int64_t) 2 == in0->v32->shape[0] && ((int64_t) 8 == in0->v33->shape[0] && (dz2085U_36760 == in0->v35->shape[0] && (dz2085U_36760 == in0->v36->shape[0] && dz2086U_36761 == in0->v37->shape[0])))))))))))))))))))))))) && (n_new_36762 == in2->shape[0] && n_new_36762 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_add_next_partition_double(ctx, &mem_out_83117, &mem_out_83118, &mem_out_83119, &mem_out_83120, &mem_out_83121, &mem_out_83122, &mem_out_83123, &mem_out_83124, &mem_out_83125, &mem_out_83126, &mem_out_83127, &mem_out_83128, &mem_out_83129, &mem_out_83130, &mem_out_83131, &mem_out_83132, &mem_out_83133, &mem_out_83134, &mem_out_83135, &mem_out_83136, &mem_out_83137, &mem_out_83138, &mem_out_83139, &mem_out_83140, &mem_out_83141, &prim_out_83142, &prim_out_83143, &prim_out_83144, &prim_out_83145, &prim_out_83146, &prim_out_83147, &prim_out_83148, &prim_out_83149, &prim_out_83150, &prim_out_83151, &prim_out_83152, &prim_out_83153, &prim_out_83154, &prim_out_83155, &prim_out_83156, &prim_out_83157, chain_collisions_mem_81927, chain_collisions_mem_81928, clBase_mem_81929, clBase_mem_81930, clBase_mem_81931, clBase_mem_81932, clProc_mem_81933, clProc_mem_81934, clProc_mem_81935, clProc_mem_81936, clProc_mem_81937, clProc_mem_81938, current_partition_mem_81939, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81942, current_partition_mem_81943, current_partition_mem_81944, current_partition_mem_81945, current_partition_mem_81946, current_partition_mem_81947, current_partition_mem_81948, toFlush_dat_mem_81949, toFlush_dat_mem_81950, toFlush_ids_mem_81951, new_xs_mem_81952, new_ys_mem_81953, n_old_36753, part_no_36754, dz2084U_36755, dz2080U_36756, dz2081U_36757, dz2082U_36758, dz2083U_36759, dz2085U_36760, dz2086U_36761, n_new_36762, clBase_36765, clBase_36766, clBase_36767, clBase_36768, clBase_36770, clBase_36773, clBase_36775, clProc_36780, clProc_36781, clProc_36782, clProc_36784, clProc_36785, current_partition_36797, new_id_36801);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_opaque_dbcHandler_double *) malloc(sizeof(struct futhark_opaque_dbcHandler_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_83117;
            (*out0)->v0->shape[0] = dz2084U_36755;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_83118;
            (*out0)->v1->shape[0] = dz2084U_36755;
            (*out0)->v2 = prim_out_83145;
            (*out0)->v3 = prim_out_83146;
            (*out0)->v4 = prim_out_83147;
            (*out0)->v5 = prim_out_83148;
            assert(((*out0)->v6 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v6->mem = mem_out_83119;
            (*out0)->v6->shape[0] = (int64_t) 2;
            (*out0)->v7 = prim_out_83149;
            assert(((*out0)->v8 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v8->mem = mem_out_83120;
            (*out0)->v8->shape[0] = (int64_t) 2;
            assert(((*out0)->v9 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v9->mem = mem_out_83121;
            (*out0)->v9->shape[0] = (int64_t) 2;
            (*out0)->v10 = prim_out_83150;
            assert(((*out0)->v11 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v11->mem = mem_out_83122;
            (*out0)->v11->shape[0] = (int64_t) 2;
            (*out0)->v12 = prim_out_83151;
            assert(((*out0)->v13 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v13->mem = mem_out_83123;
            (*out0)->v13->shape[0] = prim_out_83142;
            assert(((*out0)->v14 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v14->mem = mem_out_83124;
            (*out0)->v14->shape[0] = prim_out_83142;
            assert(((*out0)->v15 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v15->mem = mem_out_83125;
            (*out0)->v15->shape[0] = prim_out_83142;
            assert(((*out0)->v16 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v16->mem = mem_out_83126;
            (*out0)->v16->shape[0] = prim_out_83142;
            (*out0)->v17 = prim_out_83152;
            (*out0)->v18 = prim_out_83153;
            (*out0)->v19 = prim_out_83154;
            assert(((*out0)->v20 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v20->mem = mem_out_83127;
            (*out0)->v20->shape[0] = part_no_36754;
            (*out0)->v21 = prim_out_83155;
            (*out0)->v22 = prim_out_83156;
            assert(((*out0)->v23 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v23->mem = mem_out_83128;
            (*out0)->v23->shape[0] = prim_out_83143;
            assert(((*out0)->v24 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v24->mem = mem_out_83129;
            (*out0)->v24->shape[0] = n_new_36762;
            assert(((*out0)->v25 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v25->mem = mem_out_83130;
            (*out0)->v25->shape[0] = n_new_36762;
            assert(((*out0)->v26 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v26->mem = mem_out_83131;
            (*out0)->v26->shape[0] = n_new_36762;
            assert(((*out0)->v27 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v27->mem = mem_out_83132;
            (*out0)->v27->shape[0] = n_new_36762;
            assert(((*out0)->v28 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v28->mem = mem_out_83133;
            (*out0)->v28->shape[0] = n_new_36762;
            assert(((*out0)->v29 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v29->mem = mem_out_83134;
            (*out0)->v29->shape[0] = (int64_t) 8;
            assert(((*out0)->v30 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v30->mem = mem_out_83135;
            (*out0)->v30->shape[0] = n_new_36762;
            assert(((*out0)->v31 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v31->mem = mem_out_83136;
            (*out0)->v31->shape[0] = (int64_t) 2;
            assert(((*out0)->v32 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v32->mem = mem_out_83137;
            (*out0)->v32->shape[0] = (int64_t) 2;
            assert(((*out0)->v33 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v33->mem = mem_out_83138;
            (*out0)->v33->shape[0] = (int64_t) 8;
            (*out0)->v34 = prim_out_83157;
            assert(((*out0)->v35 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v35->mem = mem_out_83139;
            (*out0)->v35->shape[0] = prim_out_83144;
            assert(((*out0)->v36 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v36->mem = mem_out_83140;
            (*out0)->v36->shape[0] = prim_out_83144;
            assert(((*out0)->v37 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v37->mem = mem_out_83141;
            (*out0)->v37->shape[0] = prim_out_83144;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_do_DBSCAN_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const int64_t in1, const bool in2)
{
    int64_t n_48679 = (int64_t) 0;
    int64_t part_no_48680 = (int64_t) 0;
    int64_t dz2084U_48681 = (int64_t) 0;
    int64_t dz2080U_48682 = (int64_t) 0;
    int64_t dz2081U_48683 = (int64_t) 0;
    int64_t dz2082U_48684 = (int64_t) 0;
    int64_t dz2083U_48685 = (int64_t) 0;
    int64_t dz2085U_48686 = (int64_t) 0;
    int64_t dz2086U_48687 = (int64_t) 0;
    int8_t clBase_48690 = (int8_t) 0;
    int8_t clBase_48691 = (int8_t) 0;
    double clBase_48692 = 0.0;
    int64_t clBase_48693 = (int64_t) 0;
    int64_t clBase_48695 = (int64_t) 0;
    double clBase_48698 = 0.0;
    int64_t clBase_48700 = (int64_t) 0;
    int64_t clProc_48705 = (int64_t) 0;
    int64_t clProc_48706 = (int64_t) 0;
    int64_t clProc_48707 = (int64_t) 0;
    int64_t clProc_48709 = (int64_t) 0;
    int64_t clProc_48710 = (int64_t) 0;
    int64_t current_partition_48722 = (int64_t) 0;
    int64_t gather_psizze_48726 = (int64_t) 0;
    bool compact_list_48727 = 0;
    int64_t prim_out_83142 = (int64_t) 0;
    int8_t prim_out_83143 = (int8_t) 0;
    int8_t prim_out_83144 = (int8_t) 0;
    double prim_out_83145 = 0.0;
    int64_t prim_out_83146 = (int64_t) 0;
    int64_t prim_out_83147 = (int64_t) 0;
    double prim_out_83148 = 0.0;
    int64_t prim_out_83149 = (int64_t) 0;
    int64_t prim_out_83150 = (int64_t) 0;
    int64_t prim_out_83151 = (int64_t) 0;
    int64_t prim_out_83152 = (int64_t) 0;
    int64_t prim_out_83153 = (int64_t) 0;
    int64_t prim_out_83154 = (int64_t) 0;
    int64_t prim_out_83155 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device toFlush_ids_mem_81951;
    
    toFlush_ids_mem_81951.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81950;
    
    toFlush_dat_mem_81950.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81949;
    
    toFlush_dat_mem_81949.references = NULL;
    
    struct memblock_device current_partition_mem_81948;
    
    current_partition_mem_81948.references = NULL;
    
    struct memblock_device current_partition_mem_81947;
    
    current_partition_mem_81947.references = NULL;
    
    struct memblock_device current_partition_mem_81946;
    
    current_partition_mem_81946.references = NULL;
    
    struct memblock_device current_partition_mem_81945;
    
    current_partition_mem_81945.references = NULL;
    
    struct memblock_device current_partition_mem_81944;
    
    current_partition_mem_81944.references = NULL;
    
    struct memblock_device current_partition_mem_81943;
    
    current_partition_mem_81943.references = NULL;
    
    struct memblock_device current_partition_mem_81942;
    
    current_partition_mem_81942.references = NULL;
    
    struct memblock_device current_partition_mem_81941;
    
    current_partition_mem_81941.references = NULL;
    
    struct memblock_device current_partition_mem_81940;
    
    current_partition_mem_81940.references = NULL;
    
    struct memblock_device current_partition_mem_81939;
    
    current_partition_mem_81939.references = NULL;
    
    struct memblock_device clProc_mem_81938;
    
    clProc_mem_81938.references = NULL;
    
    struct memblock_device clProc_mem_81937;
    
    clProc_mem_81937.references = NULL;
    
    struct memblock_device clProc_mem_81936;
    
    clProc_mem_81936.references = NULL;
    
    struct memblock_device clProc_mem_81935;
    
    clProc_mem_81935.references = NULL;
    
    struct memblock_device clProc_mem_81934;
    
    clProc_mem_81934.references = NULL;
    
    struct memblock_device clProc_mem_81933;
    
    clProc_mem_81933.references = NULL;
    
    struct memblock_device clBase_mem_81932;
    
    clBase_mem_81932.references = NULL;
    
    struct memblock_device clBase_mem_81931;
    
    clBase_mem_81931.references = NULL;
    
    struct memblock_device clBase_mem_81930;
    
    clBase_mem_81930.references = NULL;
    
    struct memblock_device clBase_mem_81929;
    
    clBase_mem_81929.references = NULL;
    
    struct memblock_device chain_collisions_mem_81928;
    
    chain_collisions_mem_81928.references = NULL;
    
    struct memblock_device chain_collisions_mem_81927;
    
    chain_collisions_mem_81927.references = NULL;
    chain_collisions_mem_81927 = in0->v0->mem;
    dz2084U_48681 = in0->v0->shape[0];
    chain_collisions_mem_81928 = in0->v1->mem;
    dz2084U_48681 = in0->v1->shape[0];
    clBase_48690 = in0->v2;
    clBase_48691 = in0->v3;
    clBase_48692 = in0->v4;
    clBase_48693 = in0->v5;
    clBase_mem_81929 = in0->v6->mem;
    clBase_48695 = in0->v7;
    clBase_mem_81930 = in0->v8->mem;
    clBase_mem_81931 = in0->v9->mem;
    clBase_48698 = in0->v10;
    clBase_mem_81932 = in0->v11->mem;
    clBase_48700 = in0->v12;
    clProc_mem_81933 = in0->v13->mem;
    dz2080U_48682 = in0->v13->shape[0];
    clProc_mem_81934 = in0->v14->mem;
    dz2081U_48683 = in0->v14->shape[0];
    clProc_mem_81935 = in0->v15->mem;
    dz2082U_48684 = in0->v15->shape[0];
    clProc_mem_81936 = in0->v16->mem;
    dz2082U_48684 = in0->v16->shape[0];
    clProc_48705 = in0->v17;
    clProc_48706 = in0->v18;
    clProc_48707 = in0->v19;
    clProc_mem_81937 = in0->v20->mem;
    part_no_48680 = in0->v20->shape[0];
    clProc_48709 = in0->v21;
    clProc_48710 = in0->v22;
    clProc_mem_81938 = in0->v23->mem;
    dz2083U_48685 = in0->v23->shape[0];
    current_partition_mem_81939 = in0->v24->mem;
    n_48679 = in0->v24->shape[0];
    current_partition_mem_81940 = in0->v25->mem;
    n_48679 = in0->v25->shape[0];
    current_partition_mem_81941 = in0->v26->mem;
    n_48679 = in0->v26->shape[0];
    current_partition_mem_81942 = in0->v27->mem;
    n_48679 = in0->v27->shape[0];
    current_partition_mem_81943 = in0->v28->mem;
    n_48679 = in0->v28->shape[0];
    current_partition_mem_81944 = in0->v29->mem;
    current_partition_mem_81945 = in0->v30->mem;
    n_48679 = in0->v30->shape[0];
    current_partition_mem_81946 = in0->v31->mem;
    current_partition_mem_81947 = in0->v32->mem;
    current_partition_mem_81948 = in0->v33->mem;
    current_partition_48722 = in0->v34;
    toFlush_dat_mem_81949 = in0->v35->mem;
    dz2085U_48686 = in0->v35->shape[0];
    toFlush_dat_mem_81950 = in0->v36->mem;
    dz2085U_48686 = in0->v36->shape[0];
    toFlush_ids_mem_81951 = in0->v37->mem;
    dz2086U_48687 = in0->v37->shape[0];
    gather_psizze_48726 = in1;
    compact_list_48727 = in2;
    if (!(dz2084U_48681 == in0->v0->shape[0] && (dz2084U_48681 == in0->v1->shape[0] && ((int64_t) 2 == in0->v6->shape[0] && ((int64_t) 2 == in0->v8->shape[0] && ((int64_t) 2 == in0->v9->shape[0] && ((int64_t) 2 == in0->v11->shape[0] && (dz2080U_48682 == in0->v13->shape[0] && (dz2081U_48683 == in0->v14->shape[0] && (dz2082U_48684 == in0->v15->shape[0] && (dz2082U_48684 == in0->v16->shape[0] && (part_no_48680 == in0->v20->shape[0] && (dz2083U_48685 == in0->v23->shape[0] && (n_48679 == in0->v24->shape[0] && (n_48679 == in0->v25->shape[0] && (n_48679 == in0->v26->shape[0] && (n_48679 == in0->v27->shape[0] && (n_48679 == in0->v28->shape[0] && ((int64_t) 8 == in0->v29->shape[0] && (n_48679 == in0->v30->shape[0] && ((int64_t) 2 == in0->v31->shape[0] && ((int64_t) 2 == in0->v32->shape[0] && ((int64_t) 8 == in0->v33->shape[0] && (dz2085U_48686 == in0->v35->shape[0] && (dz2085U_48686 == in0->v36->shape[0] && dz2086U_48687 == in0->v37->shape[0]))))))))))))))))))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_do_DBSCAN_double(ctx, &mem_out_83117, &mem_out_83118, &mem_out_83119, &mem_out_83120, &mem_out_83121, &mem_out_83122, &mem_out_83123, &mem_out_83124, &mem_out_83125, &mem_out_83126, &mem_out_83127, &mem_out_83128, &mem_out_83129, &mem_out_83130, &mem_out_83131, &mem_out_83132, &mem_out_83133, &mem_out_83134, &mem_out_83135, &mem_out_83136, &mem_out_83137, &mem_out_83138, &mem_out_83139, &mem_out_83140, &mem_out_83141, &prim_out_83142, &prim_out_83143, &prim_out_83144, &prim_out_83145, &prim_out_83146, &prim_out_83147, &prim_out_83148, &prim_out_83149, &prim_out_83150, &prim_out_83151, &prim_out_83152, &prim_out_83153, &prim_out_83154, &prim_out_83155, chain_collisions_mem_81927, chain_collisions_mem_81928, clBase_mem_81929, clBase_mem_81930, clBase_mem_81931, clBase_mem_81932, clProc_mem_81933, clProc_mem_81934, clProc_mem_81935, clProc_mem_81936, clProc_mem_81937, clProc_mem_81938, current_partition_mem_81939, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81942, current_partition_mem_81943, current_partition_mem_81944, current_partition_mem_81945, current_partition_mem_81946, current_partition_mem_81947, current_partition_mem_81948, toFlush_dat_mem_81949, toFlush_dat_mem_81950, toFlush_ids_mem_81951, n_48679, part_no_48680, dz2084U_48681, dz2080U_48682, dz2081U_48683, dz2082U_48684, dz2083U_48685, dz2085U_48686, dz2086U_48687, clBase_48690, clBase_48691, clBase_48692, clBase_48693, clBase_48695, clBase_48698, clBase_48700, clProc_48705, clProc_48706, clProc_48707, clProc_48709, clProc_48710, current_partition_48722, gather_psizze_48726, compact_list_48727);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_opaque_dbcHandler_double *) malloc(sizeof(struct futhark_opaque_dbcHandler_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_83117;
            (*out0)->v0->shape[0] = prim_out_83142;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_83118;
            (*out0)->v1->shape[0] = prim_out_83142;
            (*out0)->v2 = prim_out_83143;
            (*out0)->v3 = prim_out_83144;
            (*out0)->v4 = prim_out_83145;
            (*out0)->v5 = prim_out_83146;
            assert(((*out0)->v6 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v6->mem = mem_out_83119;
            (*out0)->v6->shape[0] = (int64_t) 2;
            (*out0)->v7 = prim_out_83147;
            assert(((*out0)->v8 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v8->mem = mem_out_83120;
            (*out0)->v8->shape[0] = (int64_t) 2;
            assert(((*out0)->v9 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v9->mem = mem_out_83121;
            (*out0)->v9->shape[0] = (int64_t) 2;
            (*out0)->v10 = prim_out_83148;
            assert(((*out0)->v11 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v11->mem = mem_out_83122;
            (*out0)->v11->shape[0] = (int64_t) 2;
            (*out0)->v12 = prim_out_83149;
            assert(((*out0)->v13 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v13->mem = mem_out_83123;
            (*out0)->v13->shape[0] = dz2080U_48682;
            assert(((*out0)->v14 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v14->mem = mem_out_83124;
            (*out0)->v14->shape[0] = dz2081U_48683;
            assert(((*out0)->v15 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v15->mem = mem_out_83125;
            (*out0)->v15->shape[0] = dz2082U_48684;
            assert(((*out0)->v16 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v16->mem = mem_out_83126;
            (*out0)->v16->shape[0] = dz2082U_48684;
            (*out0)->v17 = prim_out_83150;
            (*out0)->v18 = prim_out_83151;
            (*out0)->v19 = prim_out_83152;
            assert(((*out0)->v20 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v20->mem = mem_out_83127;
            (*out0)->v20->shape[0] = part_no_48680;
            (*out0)->v21 = prim_out_83153;
            (*out0)->v22 = prim_out_83154;
            assert(((*out0)->v23 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v23->mem = mem_out_83128;
            (*out0)->v23->shape[0] = dz2083U_48685;
            assert(((*out0)->v24 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v24->mem = mem_out_83129;
            (*out0)->v24->shape[0] = n_48679;
            assert(((*out0)->v25 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v25->mem = mem_out_83130;
            (*out0)->v25->shape[0] = n_48679;
            assert(((*out0)->v26 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v26->mem = mem_out_83131;
            (*out0)->v26->shape[0] = n_48679;
            assert(((*out0)->v27 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v27->mem = mem_out_83132;
            (*out0)->v27->shape[0] = n_48679;
            assert(((*out0)->v28 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v28->mem = mem_out_83133;
            (*out0)->v28->shape[0] = n_48679;
            assert(((*out0)->v29 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v29->mem = mem_out_83134;
            (*out0)->v29->shape[0] = (int64_t) 8;
            assert(((*out0)->v30 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v30->mem = mem_out_83135;
            (*out0)->v30->shape[0] = n_48679;
            assert(((*out0)->v31 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v31->mem = mem_out_83136;
            (*out0)->v31->shape[0] = (int64_t) 2;
            assert(((*out0)->v32 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v32->mem = mem_out_83137;
            (*out0)->v32->shape[0] = (int64_t) 2;
            assert(((*out0)->v33 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v33->mem = mem_out_83138;
            (*out0)->v33->shape[0] = (int64_t) 8;
            (*out0)->v34 = prim_out_83155;
            assert(((*out0)->v35 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v35->mem = mem_out_83139;
            (*out0)->v35->shape[0] = (int64_t) 0;
            assert(((*out0)->v36 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v36->mem = mem_out_83140;
            (*out0)->v36->shape[0] = (int64_t) 0;
            assert(((*out0)->v37 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v37->mem = mem_out_83141;
            (*out0)->v37->shape[0] = (int64_t) 0;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_flush_dat_double(struct futhark_context *ctx, struct futhark_opaque_flushedData_double **out0, const struct futhark_opaque_dbcHandler_double *in0, const bool in1)
{
    int64_t n_37051 = (int64_t) 0;
    int64_t part_no_37052 = (int64_t) 0;
    int64_t dz2084U_37053 = (int64_t) 0;
    int64_t dz2080U_37054 = (int64_t) 0;
    int64_t dz2081U_37055 = (int64_t) 0;
    int64_t dz2082U_37056 = (int64_t) 0;
    int64_t dz2083U_37057 = (int64_t) 0;
    int64_t dz2085U_37058 = (int64_t) 0;
    int64_t dz2086U_37059 = (int64_t) 0;
    int8_t clBase_37062 = (int8_t) 0;
    int8_t clBase_37063 = (int8_t) 0;
    double clBase_37064 = 0.0;
    int64_t clBase_37065 = (int64_t) 0;
    int64_t clBase_37067 = (int64_t) 0;
    double clBase_37070 = 0.0;
    int64_t clBase_37072 = (int64_t) 0;
    int64_t clProc_37077 = (int64_t) 0;
    int64_t clProc_37078 = (int64_t) 0;
    int64_t clProc_37079 = (int64_t) 0;
    int64_t clProc_37081 = (int64_t) 0;
    int64_t clProc_37082 = (int64_t) 0;
    int64_t current_partition_37094 = (int64_t) 0;
    bool total_37098 = 0;
    int64_t prim_out_83120 = (int64_t) 0;
    int64_t prim_out_83121 = (int64_t) 0;
    int64_t prim_out_83122 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device toFlush_ids_mem_81951;
    
    toFlush_ids_mem_81951.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81950;
    
    toFlush_dat_mem_81950.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81949;
    
    toFlush_dat_mem_81949.references = NULL;
    
    struct memblock_device current_partition_mem_81948;
    
    current_partition_mem_81948.references = NULL;
    
    struct memblock_device current_partition_mem_81947;
    
    current_partition_mem_81947.references = NULL;
    
    struct memblock_device current_partition_mem_81946;
    
    current_partition_mem_81946.references = NULL;
    
    struct memblock_device current_partition_mem_81945;
    
    current_partition_mem_81945.references = NULL;
    
    struct memblock_device current_partition_mem_81944;
    
    current_partition_mem_81944.references = NULL;
    
    struct memblock_device current_partition_mem_81943;
    
    current_partition_mem_81943.references = NULL;
    
    struct memblock_device current_partition_mem_81942;
    
    current_partition_mem_81942.references = NULL;
    
    struct memblock_device current_partition_mem_81941;
    
    current_partition_mem_81941.references = NULL;
    
    struct memblock_device current_partition_mem_81940;
    
    current_partition_mem_81940.references = NULL;
    
    struct memblock_device current_partition_mem_81939;
    
    current_partition_mem_81939.references = NULL;
    
    struct memblock_device clProc_mem_81938;
    
    clProc_mem_81938.references = NULL;
    
    struct memblock_device clProc_mem_81937;
    
    clProc_mem_81937.references = NULL;
    
    struct memblock_device clProc_mem_81936;
    
    clProc_mem_81936.references = NULL;
    
    struct memblock_device clProc_mem_81935;
    
    clProc_mem_81935.references = NULL;
    
    struct memblock_device clProc_mem_81934;
    
    clProc_mem_81934.references = NULL;
    
    struct memblock_device clProc_mem_81933;
    
    clProc_mem_81933.references = NULL;
    
    struct memblock_device clBase_mem_81932;
    
    clBase_mem_81932.references = NULL;
    
    struct memblock_device clBase_mem_81931;
    
    clBase_mem_81931.references = NULL;
    
    struct memblock_device clBase_mem_81930;
    
    clBase_mem_81930.references = NULL;
    
    struct memblock_device clBase_mem_81929;
    
    clBase_mem_81929.references = NULL;
    
    struct memblock_device chain_collisions_mem_81928;
    
    chain_collisions_mem_81928.references = NULL;
    
    struct memblock_device chain_collisions_mem_81927;
    
    chain_collisions_mem_81927.references = NULL;
    chain_collisions_mem_81927 = in0->v0->mem;
    dz2084U_37053 = in0->v0->shape[0];
    chain_collisions_mem_81928 = in0->v1->mem;
    dz2084U_37053 = in0->v1->shape[0];
    clBase_37062 = in0->v2;
    clBase_37063 = in0->v3;
    clBase_37064 = in0->v4;
    clBase_37065 = in0->v5;
    clBase_mem_81929 = in0->v6->mem;
    clBase_37067 = in0->v7;
    clBase_mem_81930 = in0->v8->mem;
    clBase_mem_81931 = in0->v9->mem;
    clBase_37070 = in0->v10;
    clBase_mem_81932 = in0->v11->mem;
    clBase_37072 = in0->v12;
    clProc_mem_81933 = in0->v13->mem;
    dz2080U_37054 = in0->v13->shape[0];
    clProc_mem_81934 = in0->v14->mem;
    dz2081U_37055 = in0->v14->shape[0];
    clProc_mem_81935 = in0->v15->mem;
    dz2082U_37056 = in0->v15->shape[0];
    clProc_mem_81936 = in0->v16->mem;
    dz2082U_37056 = in0->v16->shape[0];
    clProc_37077 = in0->v17;
    clProc_37078 = in0->v18;
    clProc_37079 = in0->v19;
    clProc_mem_81937 = in0->v20->mem;
    part_no_37052 = in0->v20->shape[0];
    clProc_37081 = in0->v21;
    clProc_37082 = in0->v22;
    clProc_mem_81938 = in0->v23->mem;
    dz2083U_37057 = in0->v23->shape[0];
    current_partition_mem_81939 = in0->v24->mem;
    n_37051 = in0->v24->shape[0];
    current_partition_mem_81940 = in0->v25->mem;
    n_37051 = in0->v25->shape[0];
    current_partition_mem_81941 = in0->v26->mem;
    n_37051 = in0->v26->shape[0];
    current_partition_mem_81942 = in0->v27->mem;
    n_37051 = in0->v27->shape[0];
    current_partition_mem_81943 = in0->v28->mem;
    n_37051 = in0->v28->shape[0];
    current_partition_mem_81944 = in0->v29->mem;
    current_partition_mem_81945 = in0->v30->mem;
    n_37051 = in0->v30->shape[0];
    current_partition_mem_81946 = in0->v31->mem;
    current_partition_mem_81947 = in0->v32->mem;
    current_partition_mem_81948 = in0->v33->mem;
    current_partition_37094 = in0->v34;
    toFlush_dat_mem_81949 = in0->v35->mem;
    dz2085U_37058 = in0->v35->shape[0];
    toFlush_dat_mem_81950 = in0->v36->mem;
    dz2085U_37058 = in0->v36->shape[0];
    toFlush_ids_mem_81951 = in0->v37->mem;
    dz2086U_37059 = in0->v37->shape[0];
    total_37098 = in1;
    if (!(dz2084U_37053 == in0->v0->shape[0] && (dz2084U_37053 == in0->v1->shape[0] && ((int64_t) 2 == in0->v6->shape[0] && ((int64_t) 2 == in0->v8->shape[0] && ((int64_t) 2 == in0->v9->shape[0] && ((int64_t) 2 == in0->v11->shape[0] && (dz2080U_37054 == in0->v13->shape[0] && (dz2081U_37055 == in0->v14->shape[0] && (dz2082U_37056 == in0->v15->shape[0] && (dz2082U_37056 == in0->v16->shape[0] && (part_no_37052 == in0->v20->shape[0] && (dz2083U_37057 == in0->v23->shape[0] && (n_37051 == in0->v24->shape[0] && (n_37051 == in0->v25->shape[0] && (n_37051 == in0->v26->shape[0] && (n_37051 == in0->v27->shape[0] && (n_37051 == in0->v28->shape[0] && ((int64_t) 8 == in0->v29->shape[0] && (n_37051 == in0->v30->shape[0] && ((int64_t) 2 == in0->v31->shape[0] && ((int64_t) 2 == in0->v32->shape[0] && ((int64_t) 8 == in0->v33->shape[0] && (dz2085U_37058 == in0->v35->shape[0] && (dz2085U_37058 == in0->v36->shape[0] && dz2086U_37059 == in0->v37->shape[0]))))))))))))))))))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_flush_dat_double(ctx, &mem_out_83117, &mem_out_83118, &mem_out_83119, &prim_out_83120, &prim_out_83121, &prim_out_83122, chain_collisions_mem_81927, chain_collisions_mem_81928, clBase_mem_81929, clBase_mem_81930, clBase_mem_81931, clBase_mem_81932, clProc_mem_81933, clProc_mem_81934, clProc_mem_81935, clProc_mem_81936, clProc_mem_81937, clProc_mem_81938, current_partition_mem_81939, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81942, current_partition_mem_81943, current_partition_mem_81944, current_partition_mem_81945, current_partition_mem_81946, current_partition_mem_81947, current_partition_mem_81948, toFlush_dat_mem_81949, toFlush_dat_mem_81950, toFlush_ids_mem_81951, n_37051, part_no_37052, dz2084U_37053, dz2080U_37054, dz2081U_37055, dz2082U_37056, dz2083U_37057, dz2085U_37058, dz2086U_37059, clBase_37062, clBase_37063, clBase_37064, clBase_37065, clBase_37067, clBase_37070, clBase_37072, clProc_37077, clProc_37078, clProc_37079, clProc_37081, clProc_37082, current_partition_37094, total_37098);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_opaque_flushedData_double *) malloc(sizeof(struct futhark_opaque_flushedData_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_83117;
            (*out0)->v0->shape[0] = prim_out_83120;
            (*out0)->v1 = prim_out_83122;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_83118;
            (*out0)->v2->shape[0] = prim_out_83121;
            assert(((*out0)->v3 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_83119;
            (*out0)->v3->shape[0] = prim_out_83121;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_make_collisions_compact_double(struct futhark_context *ctx, struct futhark_opaque_collisionTable **out0, const struct futhark_opaque_dbcHandler_double *in0)
{
    int64_t n_51540 = (int64_t) 0;
    int64_t part_no_51541 = (int64_t) 0;
    int64_t dz2084U_51542 = (int64_t) 0;
    int64_t dz2080U_51543 = (int64_t) 0;
    int64_t dz2081U_51544 = (int64_t) 0;
    int64_t dz2082U_51545 = (int64_t) 0;
    int64_t dz2083U_51546 = (int64_t) 0;
    int64_t dz2085U_51547 = (int64_t) 0;
    int64_t dz2086U_51548 = (int64_t) 0;
    int8_t clBase_51551 = (int8_t) 0;
    int8_t clBase_51552 = (int8_t) 0;
    double clBase_51553 = 0.0;
    int64_t clBase_51554 = (int64_t) 0;
    int64_t clBase_51556 = (int64_t) 0;
    double clBase_51559 = 0.0;
    int64_t clBase_51561 = (int64_t) 0;
    int64_t clProc_51566 = (int64_t) 0;
    int64_t clProc_51567 = (int64_t) 0;
    int64_t clProc_51568 = (int64_t) 0;
    int64_t clProc_51570 = (int64_t) 0;
    int64_t clProc_51571 = (int64_t) 0;
    int64_t current_partition_51583 = (int64_t) 0;
    int64_t prim_out_83119 = (int64_t) 0;
    int64_t prim_out_83120 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device toFlush_ids_mem_81951;
    
    toFlush_ids_mem_81951.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81950;
    
    toFlush_dat_mem_81950.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81949;
    
    toFlush_dat_mem_81949.references = NULL;
    
    struct memblock_device current_partition_mem_81948;
    
    current_partition_mem_81948.references = NULL;
    
    struct memblock_device current_partition_mem_81947;
    
    current_partition_mem_81947.references = NULL;
    
    struct memblock_device current_partition_mem_81946;
    
    current_partition_mem_81946.references = NULL;
    
    struct memblock_device current_partition_mem_81945;
    
    current_partition_mem_81945.references = NULL;
    
    struct memblock_device current_partition_mem_81944;
    
    current_partition_mem_81944.references = NULL;
    
    struct memblock_device current_partition_mem_81943;
    
    current_partition_mem_81943.references = NULL;
    
    struct memblock_device current_partition_mem_81942;
    
    current_partition_mem_81942.references = NULL;
    
    struct memblock_device current_partition_mem_81941;
    
    current_partition_mem_81941.references = NULL;
    
    struct memblock_device current_partition_mem_81940;
    
    current_partition_mem_81940.references = NULL;
    
    struct memblock_device current_partition_mem_81939;
    
    current_partition_mem_81939.references = NULL;
    
    struct memblock_device clProc_mem_81938;
    
    clProc_mem_81938.references = NULL;
    
    struct memblock_device clProc_mem_81937;
    
    clProc_mem_81937.references = NULL;
    
    struct memblock_device clProc_mem_81936;
    
    clProc_mem_81936.references = NULL;
    
    struct memblock_device clProc_mem_81935;
    
    clProc_mem_81935.references = NULL;
    
    struct memblock_device clProc_mem_81934;
    
    clProc_mem_81934.references = NULL;
    
    struct memblock_device clProc_mem_81933;
    
    clProc_mem_81933.references = NULL;
    
    struct memblock_device clBase_mem_81932;
    
    clBase_mem_81932.references = NULL;
    
    struct memblock_device clBase_mem_81931;
    
    clBase_mem_81931.references = NULL;
    
    struct memblock_device clBase_mem_81930;
    
    clBase_mem_81930.references = NULL;
    
    struct memblock_device clBase_mem_81929;
    
    clBase_mem_81929.references = NULL;
    
    struct memblock_device chain_collisions_mem_81928;
    
    chain_collisions_mem_81928.references = NULL;
    
    struct memblock_device chain_collisions_mem_81927;
    
    chain_collisions_mem_81927.references = NULL;
    chain_collisions_mem_81927 = in0->v0->mem;
    dz2084U_51542 = in0->v0->shape[0];
    chain_collisions_mem_81928 = in0->v1->mem;
    dz2084U_51542 = in0->v1->shape[0];
    clBase_51551 = in0->v2;
    clBase_51552 = in0->v3;
    clBase_51553 = in0->v4;
    clBase_51554 = in0->v5;
    clBase_mem_81929 = in0->v6->mem;
    clBase_51556 = in0->v7;
    clBase_mem_81930 = in0->v8->mem;
    clBase_mem_81931 = in0->v9->mem;
    clBase_51559 = in0->v10;
    clBase_mem_81932 = in0->v11->mem;
    clBase_51561 = in0->v12;
    clProc_mem_81933 = in0->v13->mem;
    dz2080U_51543 = in0->v13->shape[0];
    clProc_mem_81934 = in0->v14->mem;
    dz2081U_51544 = in0->v14->shape[0];
    clProc_mem_81935 = in0->v15->mem;
    dz2082U_51545 = in0->v15->shape[0];
    clProc_mem_81936 = in0->v16->mem;
    dz2082U_51545 = in0->v16->shape[0];
    clProc_51566 = in0->v17;
    clProc_51567 = in0->v18;
    clProc_51568 = in0->v19;
    clProc_mem_81937 = in0->v20->mem;
    part_no_51541 = in0->v20->shape[0];
    clProc_51570 = in0->v21;
    clProc_51571 = in0->v22;
    clProc_mem_81938 = in0->v23->mem;
    dz2083U_51546 = in0->v23->shape[0];
    current_partition_mem_81939 = in0->v24->mem;
    n_51540 = in0->v24->shape[0];
    current_partition_mem_81940 = in0->v25->mem;
    n_51540 = in0->v25->shape[0];
    current_partition_mem_81941 = in0->v26->mem;
    n_51540 = in0->v26->shape[0];
    current_partition_mem_81942 = in0->v27->mem;
    n_51540 = in0->v27->shape[0];
    current_partition_mem_81943 = in0->v28->mem;
    n_51540 = in0->v28->shape[0];
    current_partition_mem_81944 = in0->v29->mem;
    current_partition_mem_81945 = in0->v30->mem;
    n_51540 = in0->v30->shape[0];
    current_partition_mem_81946 = in0->v31->mem;
    current_partition_mem_81947 = in0->v32->mem;
    current_partition_mem_81948 = in0->v33->mem;
    current_partition_51583 = in0->v34;
    toFlush_dat_mem_81949 = in0->v35->mem;
    dz2085U_51547 = in0->v35->shape[0];
    toFlush_dat_mem_81950 = in0->v36->mem;
    dz2085U_51547 = in0->v36->shape[0];
    toFlush_ids_mem_81951 = in0->v37->mem;
    dz2086U_51548 = in0->v37->shape[0];
    if (!(dz2084U_51542 == in0->v0->shape[0] && (dz2084U_51542 == in0->v1->shape[0] && ((int64_t) 2 == in0->v6->shape[0] && ((int64_t) 2 == in0->v8->shape[0] && ((int64_t) 2 == in0->v9->shape[0] && ((int64_t) 2 == in0->v11->shape[0] && (dz2080U_51543 == in0->v13->shape[0] && (dz2081U_51544 == in0->v14->shape[0] && (dz2082U_51545 == in0->v15->shape[0] && (dz2082U_51545 == in0->v16->shape[0] && (part_no_51541 == in0->v20->shape[0] && (dz2083U_51546 == in0->v23->shape[0] && (n_51540 == in0->v24->shape[0] && (n_51540 == in0->v25->shape[0] && (n_51540 == in0->v26->shape[0] && (n_51540 == in0->v27->shape[0] && (n_51540 == in0->v28->shape[0] && ((int64_t) 8 == in0->v29->shape[0] && (n_51540 == in0->v30->shape[0] && ((int64_t) 2 == in0->v31->shape[0] && ((int64_t) 2 == in0->v32->shape[0] && ((int64_t) 8 == in0->v33->shape[0] && (dz2085U_51547 == in0->v35->shape[0] && (dz2085U_51547 == in0->v36->shape[0] && dz2086U_51548 == in0->v37->shape[0]))))))))))))))))))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_make_collisions_compact_double(ctx, &mem_out_83117, &mem_out_83118, &prim_out_83119, &prim_out_83120, chain_collisions_mem_81927, chain_collisions_mem_81928, clBase_mem_81929, clBase_mem_81930, clBase_mem_81931, clBase_mem_81932, clProc_mem_81933, clProc_mem_81934, clProc_mem_81935, clProc_mem_81936, clProc_mem_81937, clProc_mem_81938, current_partition_mem_81939, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81942, current_partition_mem_81943, current_partition_mem_81944, current_partition_mem_81945, current_partition_mem_81946, current_partition_mem_81947, current_partition_mem_81948, toFlush_dat_mem_81949, toFlush_dat_mem_81950, toFlush_ids_mem_81951, n_51540, part_no_51541, dz2084U_51542, dz2080U_51543, dz2081U_51544, dz2082U_51545, dz2083U_51546, dz2085U_51547, dz2086U_51548, clBase_51551, clBase_51552, clBase_51553, clBase_51554, clBase_51556, clBase_51559, clBase_51561, clProc_51566, clProc_51567, clProc_51568, clProc_51570, clProc_51571, current_partition_51583);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_opaque_collisionTable *) malloc(sizeof(struct futhark_opaque_collisionTable))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_83117;
            (*out0)->v0->shape[0] = prim_out_83119;
            (*out0)->v1 = prim_out_83120;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_83118;
            (*out0)->v2->shape[0] = prim_out_83119;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mk_dbcHandler_double(struct futhark_context *ctx, struct futhark_opaque_dbcHandler_double **out0, const double in0, const double in1, const double in2, const double in3, const int64_t in4, const int64_t in5, const bool in6, const bool in7, const double in8, const double in9, const int64_t in10, const int64_t in11)
{
    double min_x_31083 = 0.0;
    double min_y_31084 = 0.0;
    double max_x_31085 = 0.0;
    double max_y_31086 = 0.0;
    int64_t parts_x_31087 = (int64_t) 0;
    int64_t parts_y_31088 = (int64_t) 0;
    bool isEuclidean_31089 = 0;
    bool isRadians_31090 = 0;
    double radius_31091 = 0.0;
    double eps_31092 = 0.0;
    int64_t minPts_31093 = (int64_t) 0;
    int64_t m_sizze_31094 = (int64_t) 0;
    int64_t prim_out_83142 = (int64_t) 0;
    int8_t prim_out_83143 = (int8_t) 0;
    int8_t prim_out_83144 = (int8_t) 0;
    double prim_out_83145 = 0.0;
    int64_t prim_out_83146 = (int64_t) 0;
    int64_t prim_out_83147 = (int64_t) 0;
    double prim_out_83148 = 0.0;
    int64_t prim_out_83149 = (int64_t) 0;
    int64_t prim_out_83150 = (int64_t) 0;
    int64_t prim_out_83151 = (int64_t) 0;
    int64_t prim_out_83152 = (int64_t) 0;
    int64_t prim_out_83153 = (int64_t) 0;
    int64_t prim_out_83154 = (int64_t) 0;
    int64_t prim_out_83155 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83141;
    
    mem_out_83141.references = NULL;
    
    struct memblock_device mem_out_83140;
    
    mem_out_83140.references = NULL;
    
    struct memblock_device mem_out_83139;
    
    mem_out_83139.references = NULL;
    
    struct memblock_device mem_out_83138;
    
    mem_out_83138.references = NULL;
    
    struct memblock_device mem_out_83137;
    
    mem_out_83137.references = NULL;
    
    struct memblock_device mem_out_83136;
    
    mem_out_83136.references = NULL;
    
    struct memblock_device mem_out_83135;
    
    mem_out_83135.references = NULL;
    
    struct memblock_device mem_out_83134;
    
    mem_out_83134.references = NULL;
    
    struct memblock_device mem_out_83133;
    
    mem_out_83133.references = NULL;
    
    struct memblock_device mem_out_83132;
    
    mem_out_83132.references = NULL;
    
    struct memblock_device mem_out_83131;
    
    mem_out_83131.references = NULL;
    
    struct memblock_device mem_out_83130;
    
    mem_out_83130.references = NULL;
    
    struct memblock_device mem_out_83129;
    
    mem_out_83129.references = NULL;
    
    struct memblock_device mem_out_83128;
    
    mem_out_83128.references = NULL;
    
    struct memblock_device mem_out_83127;
    
    mem_out_83127.references = NULL;
    
    struct memblock_device mem_out_83126;
    
    mem_out_83126.references = NULL;
    
    struct memblock_device mem_out_83125;
    
    mem_out_83125.references = NULL;
    
    struct memblock_device mem_out_83124;
    
    mem_out_83124.references = NULL;
    
    struct memblock_device mem_out_83123;
    
    mem_out_83123.references = NULL;
    
    struct memblock_device mem_out_83122;
    
    mem_out_83122.references = NULL;
    
    struct memblock_device mem_out_83121;
    
    mem_out_83121.references = NULL;
    
    struct memblock_device mem_out_83120;
    
    mem_out_83120.references = NULL;
    
    struct memblock_device mem_out_83119;
    
    mem_out_83119.references = NULL;
    
    struct memblock_device mem_out_83118;
    
    mem_out_83118.references = NULL;
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    min_x_31083 = in0;
    min_y_31084 = in1;
    max_x_31085 = in2;
    max_y_31086 = in3;
    parts_x_31087 = in4;
    parts_y_31088 = in5;
    isEuclidean_31089 = in6;
    isRadians_31090 = in7;
    radius_31091 = in8;
    eps_31092 = in9;
    minPts_31093 = in10;
    m_sizze_31094 = in11;
    if (ret == 0) {
        ret = futrts_entry_mk_dbcHandler_double(ctx, &mem_out_83117, &mem_out_83118, &mem_out_83119, &mem_out_83120, &mem_out_83121, &mem_out_83122, &mem_out_83123, &mem_out_83124, &mem_out_83125, &mem_out_83126, &mem_out_83127, &mem_out_83128, &mem_out_83129, &mem_out_83130, &mem_out_83131, &mem_out_83132, &mem_out_83133, &mem_out_83134, &mem_out_83135, &mem_out_83136, &mem_out_83137, &mem_out_83138, &mem_out_83139, &mem_out_83140, &mem_out_83141, &prim_out_83142, &prim_out_83143, &prim_out_83144, &prim_out_83145, &prim_out_83146, &prim_out_83147, &prim_out_83148, &prim_out_83149, &prim_out_83150, &prim_out_83151, &prim_out_83152, &prim_out_83153, &prim_out_83154, &prim_out_83155, min_x_31083, min_y_31084, max_x_31085, max_y_31086, parts_x_31087, parts_y_31088, isEuclidean_31089, isRadians_31090, radius_31091, eps_31092, minPts_31093, m_sizze_31094);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_opaque_dbcHandler_double *) malloc(sizeof(struct futhark_opaque_dbcHandler_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_83117;
            (*out0)->v0->shape[0] = (int64_t) 0;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_83118;
            (*out0)->v1->shape[0] = (int64_t) 0;
            (*out0)->v2 = prim_out_83143;
            (*out0)->v3 = prim_out_83144;
            (*out0)->v4 = prim_out_83145;
            (*out0)->v5 = prim_out_83146;
            assert(((*out0)->v6 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v6->mem = mem_out_83119;
            (*out0)->v6->shape[0] = (int64_t) 2;
            (*out0)->v7 = prim_out_83147;
            assert(((*out0)->v8 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v8->mem = mem_out_83120;
            (*out0)->v8->shape[0] = (int64_t) 2;
            assert(((*out0)->v9 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v9->mem = mem_out_83121;
            (*out0)->v9->shape[0] = (int64_t) 2;
            (*out0)->v10 = prim_out_83148;
            assert(((*out0)->v11 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v11->mem = mem_out_83122;
            (*out0)->v11->shape[0] = (int64_t) 2;
            (*out0)->v12 = prim_out_83149;
            assert(((*out0)->v13 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v13->mem = mem_out_83123;
            (*out0)->v13->shape[0] = (int64_t) 0;
            assert(((*out0)->v14 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v14->mem = mem_out_83124;
            (*out0)->v14->shape[0] = (int64_t) 0;
            assert(((*out0)->v15 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v15->mem = mem_out_83125;
            (*out0)->v15->shape[0] = (int64_t) 0;
            assert(((*out0)->v16 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v16->mem = mem_out_83126;
            (*out0)->v16->shape[0] = (int64_t) 0;
            (*out0)->v17 = prim_out_83150;
            (*out0)->v18 = prim_out_83151;
            (*out0)->v19 = prim_out_83152;
            assert(((*out0)->v20 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v20->mem = mem_out_83127;
            (*out0)->v20->shape[0] = prim_out_83142;
            (*out0)->v21 = prim_out_83153;
            (*out0)->v22 = prim_out_83154;
            assert(((*out0)->v23 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v23->mem = mem_out_83128;
            (*out0)->v23->shape[0] = (int64_t) 0;
            assert(((*out0)->v24 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v24->mem = mem_out_83129;
            (*out0)->v24->shape[0] = (int64_t) 0;
            assert(((*out0)->v25 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v25->mem = mem_out_83130;
            (*out0)->v25->shape[0] = (int64_t) 0;
            assert(((*out0)->v26 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v26->mem = mem_out_83131;
            (*out0)->v26->shape[0] = (int64_t) 0;
            assert(((*out0)->v27 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v27->mem = mem_out_83132;
            (*out0)->v27->shape[0] = (int64_t) 0;
            assert(((*out0)->v28 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v28->mem = mem_out_83133;
            (*out0)->v28->shape[0] = (int64_t) 0;
            assert(((*out0)->v29 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v29->mem = mem_out_83134;
            (*out0)->v29->shape[0] = (int64_t) 8;
            assert(((*out0)->v30 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v30->mem = mem_out_83135;
            (*out0)->v30->shape[0] = (int64_t) 0;
            assert(((*out0)->v31 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v31->mem = mem_out_83136;
            (*out0)->v31->shape[0] = (int64_t) 2;
            assert(((*out0)->v32 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v32->mem = mem_out_83137;
            (*out0)->v32->shape[0] = (int64_t) 2;
            assert(((*out0)->v33 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v33->mem = mem_out_83138;
            (*out0)->v33->shape[0] = (int64_t) 8;
            (*out0)->v34 = prim_out_83155;
            assert(((*out0)->v35 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v35->mem = mem_out_83139;
            (*out0)->v35->shape[0] = (int64_t) 0;
            assert(((*out0)->v36 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v36->mem = mem_out_83140;
            (*out0)->v36->shape[0] = (int64_t) 0;
            assert(((*out0)->v37 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v37->mem = mem_out_83141;
            (*out0)->v37->shape[0] = (int64_t) 0;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_next_partition_to_read_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_opaque_dbcHandler_double *in0)
{
    int64_t n_31684 = (int64_t) 0;
    int64_t part_no_31685 = (int64_t) 0;
    int64_t dz2084U_31686 = (int64_t) 0;
    int64_t dz2080U_31687 = (int64_t) 0;
    int64_t dz2081U_31688 = (int64_t) 0;
    int64_t dz2082U_31689 = (int64_t) 0;
    int64_t dz2083U_31690 = (int64_t) 0;
    int64_t dz2085U_31691 = (int64_t) 0;
    int64_t dz2086U_31692 = (int64_t) 0;
    int8_t clBase_31695 = (int8_t) 0;
    int8_t clBase_31696 = (int8_t) 0;
    double clBase_31697 = 0.0;
    int64_t clBase_31698 = (int64_t) 0;
    int64_t clBase_31700 = (int64_t) 0;
    double clBase_31703 = 0.0;
    int64_t clBase_31705 = (int64_t) 0;
    int64_t clProc_31710 = (int64_t) 0;
    int64_t clProc_31711 = (int64_t) 0;
    int64_t clProc_31712 = (int64_t) 0;
    int64_t clProc_31714 = (int64_t) 0;
    int64_t clProc_31715 = (int64_t) 0;
    int64_t current_partition_31727 = (int64_t) 0;
    int64_t prim_out_83117 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device toFlush_ids_mem_81951;
    
    toFlush_ids_mem_81951.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81950;
    
    toFlush_dat_mem_81950.references = NULL;
    
    struct memblock_device toFlush_dat_mem_81949;
    
    toFlush_dat_mem_81949.references = NULL;
    
    struct memblock_device current_partition_mem_81948;
    
    current_partition_mem_81948.references = NULL;
    
    struct memblock_device current_partition_mem_81947;
    
    current_partition_mem_81947.references = NULL;
    
    struct memblock_device current_partition_mem_81946;
    
    current_partition_mem_81946.references = NULL;
    
    struct memblock_device current_partition_mem_81945;
    
    current_partition_mem_81945.references = NULL;
    
    struct memblock_device current_partition_mem_81944;
    
    current_partition_mem_81944.references = NULL;
    
    struct memblock_device current_partition_mem_81943;
    
    current_partition_mem_81943.references = NULL;
    
    struct memblock_device current_partition_mem_81942;
    
    current_partition_mem_81942.references = NULL;
    
    struct memblock_device current_partition_mem_81941;
    
    current_partition_mem_81941.references = NULL;
    
    struct memblock_device current_partition_mem_81940;
    
    current_partition_mem_81940.references = NULL;
    
    struct memblock_device current_partition_mem_81939;
    
    current_partition_mem_81939.references = NULL;
    
    struct memblock_device clProc_mem_81938;
    
    clProc_mem_81938.references = NULL;
    
    struct memblock_device clProc_mem_81937;
    
    clProc_mem_81937.references = NULL;
    
    struct memblock_device clProc_mem_81936;
    
    clProc_mem_81936.references = NULL;
    
    struct memblock_device clProc_mem_81935;
    
    clProc_mem_81935.references = NULL;
    
    struct memblock_device clProc_mem_81934;
    
    clProc_mem_81934.references = NULL;
    
    struct memblock_device clProc_mem_81933;
    
    clProc_mem_81933.references = NULL;
    
    struct memblock_device clBase_mem_81932;
    
    clBase_mem_81932.references = NULL;
    
    struct memblock_device clBase_mem_81931;
    
    clBase_mem_81931.references = NULL;
    
    struct memblock_device clBase_mem_81930;
    
    clBase_mem_81930.references = NULL;
    
    struct memblock_device clBase_mem_81929;
    
    clBase_mem_81929.references = NULL;
    
    struct memblock_device chain_collisions_mem_81928;
    
    chain_collisions_mem_81928.references = NULL;
    
    struct memblock_device chain_collisions_mem_81927;
    
    chain_collisions_mem_81927.references = NULL;
    chain_collisions_mem_81927 = in0->v0->mem;
    dz2084U_31686 = in0->v0->shape[0];
    chain_collisions_mem_81928 = in0->v1->mem;
    dz2084U_31686 = in0->v1->shape[0];
    clBase_31695 = in0->v2;
    clBase_31696 = in0->v3;
    clBase_31697 = in0->v4;
    clBase_31698 = in0->v5;
    clBase_mem_81929 = in0->v6->mem;
    clBase_31700 = in0->v7;
    clBase_mem_81930 = in0->v8->mem;
    clBase_mem_81931 = in0->v9->mem;
    clBase_31703 = in0->v10;
    clBase_mem_81932 = in0->v11->mem;
    clBase_31705 = in0->v12;
    clProc_mem_81933 = in0->v13->mem;
    dz2080U_31687 = in0->v13->shape[0];
    clProc_mem_81934 = in0->v14->mem;
    dz2081U_31688 = in0->v14->shape[0];
    clProc_mem_81935 = in0->v15->mem;
    dz2082U_31689 = in0->v15->shape[0];
    clProc_mem_81936 = in0->v16->mem;
    dz2082U_31689 = in0->v16->shape[0];
    clProc_31710 = in0->v17;
    clProc_31711 = in0->v18;
    clProc_31712 = in0->v19;
    clProc_mem_81937 = in0->v20->mem;
    part_no_31685 = in0->v20->shape[0];
    clProc_31714 = in0->v21;
    clProc_31715 = in0->v22;
    clProc_mem_81938 = in0->v23->mem;
    dz2083U_31690 = in0->v23->shape[0];
    current_partition_mem_81939 = in0->v24->mem;
    n_31684 = in0->v24->shape[0];
    current_partition_mem_81940 = in0->v25->mem;
    n_31684 = in0->v25->shape[0];
    current_partition_mem_81941 = in0->v26->mem;
    n_31684 = in0->v26->shape[0];
    current_partition_mem_81942 = in0->v27->mem;
    n_31684 = in0->v27->shape[0];
    current_partition_mem_81943 = in0->v28->mem;
    n_31684 = in0->v28->shape[0];
    current_partition_mem_81944 = in0->v29->mem;
    current_partition_mem_81945 = in0->v30->mem;
    n_31684 = in0->v30->shape[0];
    current_partition_mem_81946 = in0->v31->mem;
    current_partition_mem_81947 = in0->v32->mem;
    current_partition_mem_81948 = in0->v33->mem;
    current_partition_31727 = in0->v34;
    toFlush_dat_mem_81949 = in0->v35->mem;
    dz2085U_31691 = in0->v35->shape[0];
    toFlush_dat_mem_81950 = in0->v36->mem;
    dz2085U_31691 = in0->v36->shape[0];
    toFlush_ids_mem_81951 = in0->v37->mem;
    dz2086U_31692 = in0->v37->shape[0];
    if (!(dz2084U_31686 == in0->v0->shape[0] && (dz2084U_31686 == in0->v1->shape[0] && ((int64_t) 2 == in0->v6->shape[0] && ((int64_t) 2 == in0->v8->shape[0] && ((int64_t) 2 == in0->v9->shape[0] && ((int64_t) 2 == in0->v11->shape[0] && (dz2080U_31687 == in0->v13->shape[0] && (dz2081U_31688 == in0->v14->shape[0] && (dz2082U_31689 == in0->v15->shape[0] && (dz2082U_31689 == in0->v16->shape[0] && (part_no_31685 == in0->v20->shape[0] && (dz2083U_31690 == in0->v23->shape[0] && (n_31684 == in0->v24->shape[0] && (n_31684 == in0->v25->shape[0] && (n_31684 == in0->v26->shape[0] && (n_31684 == in0->v27->shape[0] && (n_31684 == in0->v28->shape[0] && ((int64_t) 8 == in0->v29->shape[0] && (n_31684 == in0->v30->shape[0] && ((int64_t) 2 == in0->v31->shape[0] && ((int64_t) 2 == in0->v32->shape[0] && ((int64_t) 8 == in0->v33->shape[0] && (dz2085U_31691 == in0->v35->shape[0] && (dz2085U_31691 == in0->v36->shape[0] && dz2086U_31692 == in0->v37->shape[0]))))))))))))))))))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_next_partition_to_read_double(ctx, &prim_out_83117, chain_collisions_mem_81927, chain_collisions_mem_81928, clBase_mem_81929, clBase_mem_81930, clBase_mem_81931, clBase_mem_81932, clProc_mem_81933, clProc_mem_81934, clProc_mem_81935, clProc_mem_81936, clProc_mem_81937, clProc_mem_81938, current_partition_mem_81939, current_partition_mem_81940, current_partition_mem_81941, current_partition_mem_81942, current_partition_mem_81943, current_partition_mem_81944, current_partition_mem_81945, current_partition_mem_81946, current_partition_mem_81947, current_partition_mem_81948, toFlush_dat_mem_81949, toFlush_dat_mem_81950, toFlush_ids_mem_81951, n_31684, part_no_31685, dz2084U_31686, dz2080U_31687, dz2081U_31688, dz2082U_31689, dz2083U_31690, dz2085U_31691, dz2086U_31692, clBase_31695, clBase_31696, clBase_31697, clBase_31698, clBase_31700, clBase_31703, clBase_31705, clProc_31710, clProc_31711, clProc_31712, clProc_31714, clProc_31715, current_partition_31727);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            *out0 = prim_out_83117;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_rectify_cluster_ids_double(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_opaque_collisionTable *in1, const int64_t in2)
{
    int64_t n_51920 = (int64_t) 0;
    int64_t dz2081Uz2080U_51921 = (int64_t) 0;
    int64_t dz2081Uz2081U_51922 = (int64_t) 0;
    int64_t ncc_51925 = (int64_t) 0;
    int64_t gather_psizze_51927 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_83117;
    
    mem_out_83117.references = NULL;
    
    struct memblock_device replaceWith_mem_81929;
    
    replaceWith_mem_81929.references = NULL;
    
    struct memblock_device chain_id_mem_81928;
    
    chain_id_mem_81928.references = NULL;
    
    struct memblock_device chain_ids_mem_81927;
    
    chain_ids_mem_81927.references = NULL;
    chain_ids_mem_81927 = in0->mem;
    n_51920 = in0->shape[0];
    chain_id_mem_81928 = in1->v0->mem;
    dz2081Uz2080U_51921 = in1->v0->shape[0];
    ncc_51925 = in1->v1;
    replaceWith_mem_81929 = in1->v2->mem;
    dz2081Uz2081U_51922 = in1->v2->shape[0];
    gather_psizze_51927 = in2;
    if (!(n_51920 == in0->shape[0] && (dz2081Uz2080U_51921 == in1->v0->shape[0] && dz2081Uz2081U_51922 == in1->v2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_rectify_cluster_ids_double(ctx, &mem_out_83117, chain_ids_mem_81927, chain_id_mem_81928, replaceWith_mem_81929, n_51920, dz2081Uz2080U_51921, dz2081Uz2081U_51922, ncc_51925, gather_psizze_51927);
        if (ret == 0) {
            struct memblock_device counters_mem_83127 = ctx->constants->counters_mem_83127;
            struct memblock_device counters_mem_83131 = ctx->constants->counters_mem_83131;
            struct memblock_device counters_mem_83201 = ctx->constants->counters_mem_83201;
            struct memblock_device counters_mem_83624 = ctx->constants->counters_mem_83624;
            struct memblock_device counters_mem_84155 = ctx->constants->counters_mem_84155;
            struct memblock_device counters_mem_84329 = ctx->constants->counters_mem_84329;
            struct memblock_device counters_mem_84504 = ctx->constants->counters_mem_84504;
            struct memblock_device counters_mem_84929 = ctx->constants->counters_mem_84929;
            struct memblock_device counters_mem_85210 = ctx->constants->counters_mem_85210;
            struct memblock_device counters_mem_85249 = ctx->constants->counters_mem_85249;
            struct memblock_device counters_mem_86537 = ctx->constants->counters_mem_86537;
            struct memblock_device counters_mem_86668 = ctx->constants->counters_mem_86668;
            struct memblock_device counters_mem_86747 = ctx->constants->counters_mem_86747;
            struct memblock_device counters_mem_86782 = ctx->constants->counters_mem_86782;
            struct memblock_device global_dynid_mem_83190 = ctx->constants->global_dynid_mem_83190;
            struct memblock_device global_dynid_mem_83200 = ctx->constants->global_dynid_mem_83200;
            struct memblock_device global_dynid_mem_83213 = ctx->constants->global_dynid_mem_83213;
            struct memblock_device global_dynid_mem_83380 = ctx->constants->global_dynid_mem_83380;
            struct memblock_device global_dynid_mem_83445 = ctx->constants->global_dynid_mem_83445;
            struct memblock_device global_dynid_mem_83500 = ctx->constants->global_dynid_mem_83500;
            struct memblock_device global_dynid_mem_83622 = ctx->constants->global_dynid_mem_83622;
            struct memblock_device global_dynid_mem_83663 = ctx->constants->global_dynid_mem_83663;
            struct memblock_device global_dynid_mem_83686 = ctx->constants->global_dynid_mem_83686;
            struct memblock_device global_dynid_mem_83781 = ctx->constants->global_dynid_mem_83781;
            struct memblock_device global_dynid_mem_83802 = ctx->constants->global_dynid_mem_83802;
            struct memblock_device global_dynid_mem_83908 = ctx->constants->global_dynid_mem_83908;
            struct memblock_device global_dynid_mem_83918 = ctx->constants->global_dynid_mem_83918;
            struct memblock_device global_dynid_mem_84062 = ctx->constants->global_dynid_mem_84062;
            struct memblock_device global_dynid_mem_84380 = ctx->constants->global_dynid_mem_84380;
            struct memblock_device global_dynid_mem_84551 = ctx->constants->global_dynid_mem_84551;
            struct memblock_device global_dynid_mem_84654 = ctx->constants->global_dynid_mem_84654;
            struct memblock_device global_dynid_mem_84766 = ctx->constants->global_dynid_mem_84766;
            struct memblock_device global_dynid_mem_84980 = ctx->constants->global_dynid_mem_84980;
            struct memblock_device global_dynid_mem_85296 = ctx->constants->global_dynid_mem_85296;
            struct memblock_device global_dynid_mem_85417 = ctx->constants->global_dynid_mem_85417;
            struct memblock_device global_dynid_mem_85535 = ctx->constants->global_dynid_mem_85535;
            struct memblock_device global_dynid_mem_85691 = ctx->constants->global_dynid_mem_85691;
            struct memblock_device global_dynid_mem_85809 = ctx->constants->global_dynid_mem_85809;
            struct memblock_device global_dynid_mem_85958 = ctx->constants->global_dynid_mem_85958;
            struct memblock_device global_dynid_mem_86076 = ctx->constants->global_dynid_mem_86076;
            struct memblock_device global_dynid_mem_86232 = ctx->constants->global_dynid_mem_86232;
            struct memblock_device global_dynid_mem_86335 = ctx->constants->global_dynid_mem_86335;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_83117;
            (*out0)->shape[0] = n_51920;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
  
