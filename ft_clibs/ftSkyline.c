// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_unified_memory(struct futhark_context_config *cfg, int flag);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s);
const char *futhark_context_config_get_program(struct futhark_context_config *cfg);
void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_bool_1d;
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0);
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data);
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f32_2d;
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const float *data, int64_t dim0, int64_t dim1);
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0, int64_t dim1);
int futhark_free_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
int futhark_values_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr, float *data);
int futhark_index_f32_2d(struct futhark_context *ctx, float *out, struct futhark_f32_2d *arr, int64_t i0, int64_t i1);
CUdeviceptr futhark_values_raw_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_tup2_arr1d_f32_i64;
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64;
struct futhark_opaque_skylineBase_float;
struct futhark_opaque_skylineData_float;
struct futhark_opaque_skylineInfo_float;
int futhark_free_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_store_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_arr1d_f32_i64 *futhark_restore_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_project_opaque_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_new_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, const struct futhark_f32_1d *f_0, const int64_t f_1);
int futhark_free_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_store_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_zip_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_f32_2d *f_0, const struct futhark_i64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr);
int futhark_free_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float *obj);
int futhark_store_opaque_skylineBase_float(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineBase_float *futhark_restore_opaque_skylineBase_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineBase_float_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_m_size(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_new_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f32_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const int64_t f_m_sizze, const struct futhark_f32_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no);
int futhark_free_opaque_skylineData_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float *obj);
int futhark_store_opaque_skylineData_float(struct futhark_context *ctx, const struct futhark_opaque_skylineData_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineData_float *futhark_restore_opaque_skylineData_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineData_float_dat(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineData_float *obj);
int futhark_project_opaque_skylineData_float_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_float *obj);
int futhark_project_opaque_skylineData_float_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_float *obj);
int futhark_new_opaque_skylineData_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float **out, const struct futhark_f32_2d *f_dat, const int64_t f_len, const struct futhark_i64_1d *f_pL);
int futhark_free_opaque_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float *obj);
int futhark_store_opaque_skylineInfo_float(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineInfo_float *futhark_restore_opaque_skylineInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineInfo_float_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_float *obj);
int futhark_project_opaque_skylineInfo_float_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_opaque_skylineInfo_float *obj);
int futhark_new_opaque_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *f_xys);

// Entry points
int futhark_entry_calc_Global_Skyline_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1);
int futhark_entry_crack_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float **out0, const struct futhark_opaque_skylineInfo_float *in0);
int futhark_entry_make_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const int64_t in4);
int futhark_entry_skyline_intermediate_filter_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_skyline_local_filter_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const bool in2);
int futhark_entry_skyline_mergeFilter_2_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3);
int futhark_entry_skyline_mergeFilter_3_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4);
int futhark_entry_skyline_mergeFilter_4_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4, const struct futhark_opaque_skylineInfo_float *in5);
int futhark_entry_skyline_mergeFilter_5_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4, const struct futhark_opaque_skylineInfo_float *in5, const struct futhark_opaque_skylineInfo_float *in6);
int futhark_entry_skyline_merge_2_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1);
int futhark_entry_skyline_merge_3_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2);
int futhark_entry_skyline_merge_4_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3);
int futhark_entry_skyline_merge_5_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4);
int futhark_entry_skyline_slice_and_dice_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>


#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
};
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    struct memblock_device counters_mem_53224;
    struct memblock_device counters_mem_53243;
    struct memblock_device counters_mem_53319;
    struct memblock_device counters_mem_53373;
    struct memblock_device counters_mem_53511;
    struct memblock_device counters_mem_53531;
    struct memblock_device counters_mem_53553;
    struct memblock_device counters_mem_53595;
    struct memblock_device counters_mem_53711;
    struct memblock_device counters_mem_53848;
    struct memblock_device global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461;
};
static bool skyline_intermediate_filter_floatzistatic_array_realtype_54060[1] = { 0};
struct tuning_params {
    int dummy;
    int64_t *builtinzhiota_i64zitblock_sizze_53458;
    int64_t *builtinzhreplicate_boolzitblock_sizze_53518;
    int64_t *builtinzhreplicate_f32zitblock_sizze_53292;
    int64_t *builtinzhreplicate_i32zitblock_sizze_53235;
    int64_t *builtinzhreplicate_i64zitblock_sizze_53363;
    int64_t *builtinzhreplicate_i8zitblock_sizze_53330;
    int64_t *calc_global_Skyline_9665zisegmap_num_tblocks_49897;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49603;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49761;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49895;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49904;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49918;
    int64_t *calc_global_Skyline_9665zisegmap_tblock_sizze_49930;
    int64_t *calc_global_Skyline_9665zisegred_num_tblocks_49774;
    int64_t *calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    int64_t *calc_global_Skyline_9665zisegscan_num_tblocks_49887;
    int64_t *calc_global_Skyline_9665zisegscan_tblock_sizze_49885;
    int64_t *calc_global_Skyline_9665zisuff_intra_par_1;
    int64_t *calc_global_Skyline_9665zisuff_outer_par_0;
    int64_t *filter_against_9751zisegmap_num_tblocks_50277;
    int64_t *filter_against_9751zisegmap_tblock_sizze_49983;
    int64_t *filter_against_9751zisegmap_tblock_sizze_50141;
    int64_t *filter_against_9751zisegmap_tblock_sizze_50275;
    int64_t *filter_against_9751zisegmap_tblock_sizze_50284;
    int64_t *filter_against_9751zisegmap_tblock_sizze_50298;
    int64_t *filter_against_9751zisegmap_tblock_sizze_50310;
    int64_t *filter_against_9751zisegred_num_tblocks_50154;
    int64_t *filter_against_9751zisegred_tblock_sizze_50152;
    int64_t *filter_against_9751zisegscan_num_tblocks_50267;
    int64_t *filter_against_9751zisegscan_tblock_sizze_50265;
    int64_t *filter_against_9751zisuff_intra_par_1;
    int64_t *filter_against_9751zisuff_outer_par_0;
    int64_t *make_skylineBase_floatzisegmap_tblock_sizze_50394;
    int64_t *make_skylineBase_floatzisegmap_tblock_sizze_50420;
    int64_t *make_skylineBase_floatzisegmap_tblock_sizze_50456;
    int64_t *make_skylineBase_floatzisegred_num_tblocks_50364;
    int64_t *make_skylineBase_floatzisegred_num_tblocks_50384;
    int64_t *make_skylineBase_floatzisegred_tblock_sizze_50362;
    int64_t *make_skylineBase_floatzisegred_tblock_sizze_50382;
    int64_t *make_skylineBase_floatzisegscan_num_tblocks_50356;
    int64_t *make_skylineBase_floatzisegscan_num_tblocks_50376;
    int64_t *make_skylineBase_floatzisegscan_tblock_sizze_50354;
    int64_t *make_skylineBase_floatzisegscan_tblock_sizze_50374;
    int64_t *skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559;
    int64_t *skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607;
    int64_t *skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644;
    int64_t *skyline_intermediate_filter_floatzisegred_num_tblocks_50549;
    int64_t *skyline_intermediate_filter_floatzisegred_num_tblocks_50589;
    int64_t *skyline_intermediate_filter_floatzisegred_tblock_sizze_50547;
    int64_t *skyline_intermediate_filter_floatzisegred_tblock_sizze_50587;
    int64_t *skyline_intermediate_filter_floatzisegscan_num_tblocks_50581;
    int64_t *skyline_intermediate_filter_floatzisegscan_num_tblocks_50599;
    int64_t *skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579;
    int64_t *skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597;
    int64_t *skyline_intermediate_filter_floatzitblock_sizze_53461;
    int64_t *skyline_local_filter_9621zihist_L2_53453;
    int64_t *skyline_local_filter_9621zihist_L_53386;
    int64_t *skyline_local_filter_9621ziseghist_num_tblocks_51259;
    int64_t *skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    int64_t *skyline_local_filter_9621zisegmap_num_tblocks_50839;
    int64_t *skyline_local_filter_9621zisegmap_num_tblocks_51288;
    int64_t *skyline_local_filter_9621zisegmap_num_tblocks_51322;
    int64_t *skyline_local_filter_9621zisegmap_num_tblocks_51460;
    int64_t *skyline_local_filter_9621zisegmap_num_tblocks_51470;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50670;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50757;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50785;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50837;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50868;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50923;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50949;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50979;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_50992;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51020;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51286;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51320;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51427;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51458;
    int64_t *skyline_local_filter_9621zisegmap_tblock_sizze_51468;
    int64_t *skyline_local_filter_9621zisegscan_num_tblocks_51415;
    int64_t *skyline_local_filter_9621zisegscan_tblock_sizze_51413;
    int64_t *skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482;
    int64_t *skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458;
    int64_t *skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534;
    int64_t *skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562;
    int64_t *skyline_merge_2_floatzisegmap_tblock_sizze_49410;
    int64_t *skyline_merge_3_floatzisegmap_tblock_sizze_49386;
    int64_t *skyline_merge_4_floatzisegmap_tblock_sizze_49430;
    int64_t *skyline_merge_5_floatzisegmap_tblock_sizze_49502;
    int64_t *skyline_slice_and_dice_floatzihist_L2_53650;
    int64_t *skyline_slice_and_dice_floatzihist_L_53597;
    int64_t *skyline_slice_and_dice_floatziseghist_num_tblocks_51784;
    int64_t *skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    int64_t *skyline_slice_and_dice_floatzisegmap_num_tblocks_51490;
    int64_t *skyline_slice_and_dice_floatzisegmap_num_tblocks_51579;
    int64_t *skyline_slice_and_dice_floatzisegmap_num_tblocks_52145;
    int64_t *skyline_slice_and_dice_floatzisegmap_num_tblocks_52155;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143;
    int64_t *skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153;
    int64_t *skyline_slice_and_dice_floatzisegred_num_tblocks_51476;
    int64_t *skyline_slice_and_dice_floatzisegred_num_tblocks_51656;
    int64_t *skyline_slice_and_dice_floatzisegred_num_tblocks_51957;
    int64_t *skyline_slice_and_dice_floatzisegred_tblock_sizze_51474;
    int64_t *skyline_slice_and_dice_floatzisegred_tblock_sizze_51654;
    int64_t *skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    int64_t *skyline_slice_and_dice_floatzisegscan_num_tblocks_51569;
    int64_t *skyline_slice_and_dice_floatzisegscan_num_tblocks_52100;
    int64_t *skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567;
    int64_t *skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098;
    int64_t *skyline_slice_and_dice_floatzisuff_intra_par_1;
    int64_t *skyline_slice_and_dice_floatzisuff_outer_par_0;
    int64_t *skyline_slice_and_dice_floatzitile_sizze_52186;
};
static const int num_tuning_params = 122;
static const char *tuning_param_names[] = {"builtin#iota_i64.tblock_size_53458", "builtin#replicate_bool.tblock_size_53518", "builtin#replicate_f32.tblock_size_53292", "builtin#replicate_i32.tblock_size_53235", "builtin#replicate_i64.tblock_size_53363", "builtin#replicate_i8.tblock_size_53330", "calc_global_Skyline_9665.segmap_num_tblocks_49897", "calc_global_Skyline_9665.segmap_tblock_size_49603", "calc_global_Skyline_9665.segmap_tblock_size_49761", "calc_global_Skyline_9665.segmap_tblock_size_49895", "calc_global_Skyline_9665.segmap_tblock_size_49904", "calc_global_Skyline_9665.segmap_tblock_size_49918", "calc_global_Skyline_9665.segmap_tblock_size_49930", "calc_global_Skyline_9665.segred_num_tblocks_49774", "calc_global_Skyline_9665.segred_tblock_size_49772", "calc_global_Skyline_9665.segscan_num_tblocks_49887", "calc_global_Skyline_9665.segscan_tblock_size_49885", "calc_global_Skyline_9665.suff_intra_par_1", "calc_global_Skyline_9665.suff_outer_par_0", "filter_against_9751.segmap_num_tblocks_50277", "filter_against_9751.segmap_tblock_size_49983", "filter_against_9751.segmap_tblock_size_50141", "filter_against_9751.segmap_tblock_size_50275", "filter_against_9751.segmap_tblock_size_50284", "filter_against_9751.segmap_tblock_size_50298", "filter_against_9751.segmap_tblock_size_50310", "filter_against_9751.segred_num_tblocks_50154", "filter_against_9751.segred_tblock_size_50152", "filter_against_9751.segscan_num_tblocks_50267", "filter_against_9751.segscan_tblock_size_50265", "filter_against_9751.suff_intra_par_1", "filter_against_9751.suff_outer_par_0", "make_skylineBase_float.segmap_tblock_size_50394", "make_skylineBase_float.segmap_tblock_size_50420", "make_skylineBase_float.segmap_tblock_size_50456", "make_skylineBase_float.segred_num_tblocks_50364", "make_skylineBase_float.segred_num_tblocks_50384", "make_skylineBase_float.segred_tblock_size_50362", "make_skylineBase_float.segred_tblock_size_50382", "make_skylineBase_float.segscan_num_tblocks_50356", "make_skylineBase_float.segscan_num_tblocks_50376", "make_skylineBase_float.segscan_tblock_size_50354", "make_skylineBase_float.segscan_tblock_size_50374", "skyline_intermediate_filter_float.segmap_tblock_size_50559", "skyline_intermediate_filter_float.segmap_tblock_size_50607", "skyline_intermediate_filter_float.segmap_tblock_size_50644", "skyline_intermediate_filter_float.segred_num_tblocks_50549", "skyline_intermediate_filter_float.segred_num_tblocks_50589", "skyline_intermediate_filter_float.segred_tblock_size_50547", "skyline_intermediate_filter_float.segred_tblock_size_50587", "skyline_intermediate_filter_float.segscan_num_tblocks_50581", "skyline_intermediate_filter_float.segscan_num_tblocks_50599", "skyline_intermediate_filter_float.segscan_tblock_size_50579", "skyline_intermediate_filter_float.segscan_tblock_size_50597", "skyline_intermediate_filter_float.tblock_size_53461", "skyline_local_filter_9621.hist_L2_53453", "skyline_local_filter_9621.hist_L_53386", "skyline_local_filter_9621.seghist_num_tblocks_51259", "skyline_local_filter_9621.seghist_tblock_size_51257", "skyline_local_filter_9621.segmap_num_tblocks_50839", "skyline_local_filter_9621.segmap_num_tblocks_51288", "skyline_local_filter_9621.segmap_num_tblocks_51322", "skyline_local_filter_9621.segmap_num_tblocks_51460", "skyline_local_filter_9621.segmap_num_tblocks_51470", "skyline_local_filter_9621.segmap_tblock_size_50670", "skyline_local_filter_9621.segmap_tblock_size_50757", "skyline_local_filter_9621.segmap_tblock_size_50785", "skyline_local_filter_9621.segmap_tblock_size_50837", "skyline_local_filter_9621.segmap_tblock_size_50868", "skyline_local_filter_9621.segmap_tblock_size_50923", "skyline_local_filter_9621.segmap_tblock_size_50949", "skyline_local_filter_9621.segmap_tblock_size_50979", "skyline_local_filter_9621.segmap_tblock_size_50992", "skyline_local_filter_9621.segmap_tblock_size_51020", "skyline_local_filter_9621.segmap_tblock_size_51286", "skyline_local_filter_9621.segmap_tblock_size_51320", "skyline_local_filter_9621.segmap_tblock_size_51427", "skyline_local_filter_9621.segmap_tblock_size_51458", "skyline_local_filter_9621.segmap_tblock_size_51468", "skyline_local_filter_9621.segscan_num_tblocks_51415", "skyline_local_filter_9621.segscan_tblock_size_51413", "skyline_mergeFilter_2_float.segmap_tblock_size_49482", "skyline_mergeFilter_3_float.segmap_tblock_size_49458", "skyline_mergeFilter_4_float.segmap_tblock_size_49534", "skyline_mergeFilter_5_float.segmap_tblock_size_49562", "skyline_merge_2_float.segmap_tblock_size_49410", "skyline_merge_3_float.segmap_tblock_size_49386", "skyline_merge_4_float.segmap_tblock_size_49430", "skyline_merge_5_float.segmap_tblock_size_49502", "skyline_slice_and_dice_float.hist_L2_53650", "skyline_slice_and_dice_float.hist_L_53597", "skyline_slice_and_dice_float.seghist_num_tblocks_51784", "skyline_slice_and_dice_float.seghist_tblock_size_51782", "skyline_slice_and_dice_float.segmap_num_tblocks_51490", "skyline_slice_and_dice_float.segmap_num_tblocks_51579", "skyline_slice_and_dice_float.segmap_num_tblocks_52145", "skyline_slice_and_dice_float.segmap_num_tblocks_52155", "skyline_slice_and_dice_float.segmap_tblock_size_51488", "skyline_slice_and_dice_float.segmap_tblock_size_51577", "skyline_slice_and_dice_float.segmap_tblock_size_51586", "skyline_slice_and_dice_float.segmap_tblock_size_51600", "skyline_slice_and_dice_float.segmap_tblock_size_51612", "skyline_slice_and_dice_float.segmap_tblock_size_51667", "skyline_slice_and_dice_float.segmap_tblock_size_51691", "skyline_slice_and_dice_float.segmap_tblock_size_52007", "skyline_slice_and_dice_float.segmap_tblock_size_52019", "skyline_slice_and_dice_float.segmap_tblock_size_52112", "skyline_slice_and_dice_float.segmap_tblock_size_52143", "skyline_slice_and_dice_float.segmap_tblock_size_52153", "skyline_slice_and_dice_float.segred_num_tblocks_51476", "skyline_slice_and_dice_float.segred_num_tblocks_51656", "skyline_slice_and_dice_float.segred_num_tblocks_51957", "skyline_slice_and_dice_float.segred_tblock_size_51474", "skyline_slice_and_dice_float.segred_tblock_size_51654", "skyline_slice_and_dice_float.segred_tblock_size_51955", "skyline_slice_and_dice_float.segscan_num_tblocks_51569", "skyline_slice_and_dice_float.segscan_num_tblocks_52100", "skyline_slice_and_dice_float.segscan_tblock_size_51567", "skyline_slice_and_dice_float.segscan_tblock_size_52098", "skyline_slice_and_dice_float.suff_intra_par_1", "skyline_slice_and_dice_float.suff_outer_par_0", "skyline_slice_and_dice_float.tile_size_52186", NULL};
static const char *tuning_param_vars[] = {"builtinzhiota_i64zitblock_sizze_53458", "builtinzhreplicate_boolzitblock_sizze_53518", "builtinzhreplicate_f32zitblock_sizze_53292", "builtinzhreplicate_i32zitblock_sizze_53235", "builtinzhreplicate_i64zitblock_sizze_53363", "builtinzhreplicate_i8zitblock_sizze_53330", "calc_global_Skyline_9665zisegmap_num_tblocks_49897", "calc_global_Skyline_9665zisegmap_tblock_sizze_49603", "calc_global_Skyline_9665zisegmap_tblock_sizze_49761", "calc_global_Skyline_9665zisegmap_tblock_sizze_49895", "calc_global_Skyline_9665zisegmap_tblock_sizze_49904", "calc_global_Skyline_9665zisegmap_tblock_sizze_49918", "calc_global_Skyline_9665zisegmap_tblock_sizze_49930", "calc_global_Skyline_9665zisegred_num_tblocks_49774", "calc_global_Skyline_9665zisegred_tblock_sizze_49772", "calc_global_Skyline_9665zisegscan_num_tblocks_49887", "calc_global_Skyline_9665zisegscan_tblock_sizze_49885", "calc_global_Skyline_9665zisuff_intra_par_1", "calc_global_Skyline_9665zisuff_outer_par_0", "filter_against_9751zisegmap_num_tblocks_50277", "filter_against_9751zisegmap_tblock_sizze_49983", "filter_against_9751zisegmap_tblock_sizze_50141", "filter_against_9751zisegmap_tblock_sizze_50275", "filter_against_9751zisegmap_tblock_sizze_50284", "filter_against_9751zisegmap_tblock_sizze_50298", "filter_against_9751zisegmap_tblock_sizze_50310", "filter_against_9751zisegred_num_tblocks_50154", "filter_against_9751zisegred_tblock_sizze_50152", "filter_against_9751zisegscan_num_tblocks_50267", "filter_against_9751zisegscan_tblock_sizze_50265", "filter_against_9751zisuff_intra_par_1", "filter_against_9751zisuff_outer_par_0", "make_skylineBase_floatzisegmap_tblock_sizze_50394", "make_skylineBase_floatzisegmap_tblock_sizze_50420", "make_skylineBase_floatzisegmap_tblock_sizze_50456", "make_skylineBase_floatzisegred_num_tblocks_50364", "make_skylineBase_floatzisegred_num_tblocks_50384", "make_skylineBase_floatzisegred_tblock_sizze_50362", "make_skylineBase_floatzisegred_tblock_sizze_50382", "make_skylineBase_floatzisegscan_num_tblocks_50356", "make_skylineBase_floatzisegscan_num_tblocks_50376", "make_skylineBase_floatzisegscan_tblock_sizze_50354", "make_skylineBase_floatzisegscan_tblock_sizze_50374", "skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559", "skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607", "skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644", "skyline_intermediate_filter_floatzisegred_num_tblocks_50549", "skyline_intermediate_filter_floatzisegred_num_tblocks_50589", "skyline_intermediate_filter_floatzisegred_tblock_sizze_50547", "skyline_intermediate_filter_floatzisegred_tblock_sizze_50587", "skyline_intermediate_filter_floatzisegscan_num_tblocks_50581", "skyline_intermediate_filter_floatzisegscan_num_tblocks_50599", "skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579", "skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597", "skyline_intermediate_filter_floatzitblock_sizze_53461", "skyline_local_filter_9621zihist_L2_53453", "skyline_local_filter_9621zihist_L_53386", "skyline_local_filter_9621ziseghist_num_tblocks_51259", "skyline_local_filter_9621ziseghist_tblock_sizze_51257", "skyline_local_filter_9621zisegmap_num_tblocks_50839", "skyline_local_filter_9621zisegmap_num_tblocks_51288", "skyline_local_filter_9621zisegmap_num_tblocks_51322", "skyline_local_filter_9621zisegmap_num_tblocks_51460", "skyline_local_filter_9621zisegmap_num_tblocks_51470", "skyline_local_filter_9621zisegmap_tblock_sizze_50670", "skyline_local_filter_9621zisegmap_tblock_sizze_50757", "skyline_local_filter_9621zisegmap_tblock_sizze_50785", "skyline_local_filter_9621zisegmap_tblock_sizze_50837", "skyline_local_filter_9621zisegmap_tblock_sizze_50868", "skyline_local_filter_9621zisegmap_tblock_sizze_50923", "skyline_local_filter_9621zisegmap_tblock_sizze_50949", "skyline_local_filter_9621zisegmap_tblock_sizze_50979", "skyline_local_filter_9621zisegmap_tblock_sizze_50992", "skyline_local_filter_9621zisegmap_tblock_sizze_51020", "skyline_local_filter_9621zisegmap_tblock_sizze_51286", "skyline_local_filter_9621zisegmap_tblock_sizze_51320", "skyline_local_filter_9621zisegmap_tblock_sizze_51427", "skyline_local_filter_9621zisegmap_tblock_sizze_51458", "skyline_local_filter_9621zisegmap_tblock_sizze_51468", "skyline_local_filter_9621zisegscan_num_tblocks_51415", "skyline_local_filter_9621zisegscan_tblock_sizze_51413", "skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482", "skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458", "skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534", "skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562", "skyline_merge_2_floatzisegmap_tblock_sizze_49410", "skyline_merge_3_floatzisegmap_tblock_sizze_49386", "skyline_merge_4_floatzisegmap_tblock_sizze_49430", "skyline_merge_5_floatzisegmap_tblock_sizze_49502", "skyline_slice_and_dice_floatzihist_L2_53650", "skyline_slice_and_dice_floatzihist_L_53597", "skyline_slice_and_dice_floatziseghist_num_tblocks_51784", "skyline_slice_and_dice_floatziseghist_tblock_sizze_51782", "skyline_slice_and_dice_floatzisegmap_num_tblocks_51490", "skyline_slice_and_dice_floatzisegmap_num_tblocks_51579", "skyline_slice_and_dice_floatzisegmap_num_tblocks_52145", "skyline_slice_and_dice_floatzisegmap_num_tblocks_52155", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143", "skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153", "skyline_slice_and_dice_floatzisegred_num_tblocks_51476", "skyline_slice_and_dice_floatzisegred_num_tblocks_51656", "skyline_slice_and_dice_floatzisegred_num_tblocks_51957", "skyline_slice_and_dice_floatzisegred_tblock_sizze_51474", "skyline_slice_and_dice_floatzisegred_tblock_sizze_51654", "skyline_slice_and_dice_floatzisegred_tblock_sizze_51955", "skyline_slice_and_dice_floatzisegscan_num_tblocks_51569", "skyline_slice_and_dice_floatzisegscan_num_tblocks_52100", "skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567", "skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098", "skyline_slice_and_dice_floatzisuff_intra_par_1", "skyline_slice_and_dice_floatzisuff_outer_par_0", "skyline_slice_and_dice_floatzitile_sizze_52186", NULL};
static const char *tuning_param_classes[] = {"thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "threshold(32, !calc_global_Skyline_9665.suff_outer_par_0)", "threshold(def, )", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "threshold(32, !filter_against_9751.suff_outer_par_0)", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "cache", "shared_memory", "grid_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "cache", "shared_memory", "grid_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "threshold(32, !skyline_slice_and_dice_float.suff_outer_par_0)", "threshold(def, )", "thread_block_size", NULL};
static int64_t tuning_param_defaults[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0};
static const int max_failure_args = 2;
static const int f64_required = 0;
static const char *gpu_program[] = {"#define FUTHARK_CUDA\n// start of prelude.cu\n\n#define SCALAR_FUN_ATTR __device__ static inline\n#define FUTHARK_FUN_ATTR __device__ static\n#define FUTHARK_F64_ENABLED\n\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\n\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\n\nstatic inline __device__ int get_tblock_id(int d) {\n  switch (d) {\n  case 0: return blockIdx.x;\n  case 1: return blockIdx.y;\n  case 2: return blockIdx.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_num_tblocks(int d) {\n  switch(d) {\n  case 0: return gridDim.x;\n  case 1: return gridDim.y;\n  case 2: return gridDim.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x + blockIdx.x * blockDim.x;\n    case 1: return threadIdx.y + blockIdx.y * blockDim.y;\n    case 2: return threadIdx.z + blockIdx.z * blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x;\n    case 1: return threadIdx.y;\n    case 2: return threadIdx.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_size(int d) {\n  switch (d) {\n    case 0: return blockDim.x;\n    case 1: return blockDim.y;\n    case 2: return blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_size(int d) {\n  switch (d) {\n    case 0: return gridDim.x * blockDim.x;\n    case 1: return gridDim.y * blockDim.y;\n    case 2: return gridDim.z * blockDim.z;\n    default: return 0;\n  }\n}\n\n\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline __device__ void barrier(int x) {\n  __syncthreads();\n}\nstatic inline __device__ void mem_fence_local() {\n  __threadfence_block();\n}\nstatic inline __device__ void mem_fence_global", "() {\n  __threadfence();\n}\n\nstatic inline __device__ void barrier_local() {\n  __syncthreads();\n}\n\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ unsigned char shared_mem[];\n\n#define SHARED_MEM_PARAM\n#define FUTHARK_KERNEL extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define FUTHARK_KERNEL_SIZED(a,b,c) extern \"C\" __global__ __launch_bounds__(a*b*c)\n\n// End of prelude.cu\n// Start of half.h.\n\n// Conversion functions are from http://half.sourceforge.net/, but\n// translated to C.\n//\n// Copyright (c) 2012-2021 Christian Rau\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n#ifndef __OPENCL_VERSION__\n#define __constant\n#endif\n\n__constant static const uint16_t base_table[512] = {\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0", "000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,\n  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,\n  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8",
                                    "000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,\n  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,\n  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };\n\n__constant static const unsigned char shift_table[512] = {\n  24, 24, 24, 24, 24, 24,", " 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2", "4, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };\n\n__constant static const uint32_t mantissa_table[2048] = {\n  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,\n  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,\n  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,\n  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,\n  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,\n  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,\n  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,\n  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,\n  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,\n  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x37",
                                    "1B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,\n  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,\n  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,\n  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,\n  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,\n  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,\n  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,\n  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,\n  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,\n  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,\n  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,\n  0x", "37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,\n  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,\n  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,\n  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,\n  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,\n  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,\n  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,\n  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,\n  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,\n  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,\n  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x", "37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,\n  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,\n  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,\n  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,\n  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,\n  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,\n  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,\n  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,\n  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,\n  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,\n  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x",
                                    "38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,\n  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,\n  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,\n  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,\n  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,\n  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,\n  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,\n  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,\n  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,\n  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,\n  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x", "384BC000,\n  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,\n  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,\n  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,\n  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,\n  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,\n  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,\n  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,\n  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,\n  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,\n  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,\n  0x38740000, 0x38744000, 0x38748000, 0x3874C000, ", "0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,\n  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,\n  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,\n  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,\n  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,\n  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,\n  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,\n  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,\n  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,\n  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,\n  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, ",
                                    "0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,\n  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,\n  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,\n  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,\n  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,\n  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,\n  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,\n  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,\n  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,\n  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,\n  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, ", "0x3823C000, 0x3823E000,\n  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,\n  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,\n  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,\n  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,\n  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,\n  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,\n  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,\n  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,\n  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,\n  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,\n  0x38380000, 0x38382000, 0x38384000", ", 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,\n  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,\n  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,\n  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,\n  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,\n  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,\n  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,\n  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,\n  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,\n  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,\n  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000",
                                    ", 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,\n  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,\n  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,\n  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,\n  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,\n  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,\n  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,\n  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,\n  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,\n  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,\n  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000", ", 0x3861A000, 0x3861C000, 0x3861E000,\n  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,\n  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,\n  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,\n  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,\n  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,\n  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,\n  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,\n  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,\n  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,\n  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,\n  0x38760000, 0x387620", "00, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,\n  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,\n  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,\n  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,\n  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };\n__constant static const uint32_t exponent_table[64] = {\n  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,\n  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,\n  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,\n  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };\n__constant static const unsigned short offset_table[64] = {\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1",
                                    "024, 1024, 1024, 1024, 1024, 1024,\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };\n\nSCALAR_FUN_ATTR uint16_t float2halfbits(float value) {\n  union { float x; uint32_t y; } u;\n  u.x = value;\n  uint32_t bits = u.y;\n\n  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;\n\n  return hbits;\n}\n\nSCALAR_FUN_ATTR float halfbits2float(uint16_t value) {\n  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];\n\n  union { uint32_t x; float y; } u;\n  u.x = bits;\n  return u.y;\n}\n\nSCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {\n  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;\n  if(fabs > 0x7C00 || tabs > 0x7C00) {\n    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);\n  }\n  if(from == to || !(fabs|tabs)) {\n    return to;\n  }\n  if(!fabs) {\n    return (to&0x8000)+1;\n  }\n  unsigned int out =\n    from +\n    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)\n    - 1;\n  return out;\n}\n\n// End of half.h.\n// Start of scalar.h.\n\n// Implementation of the primitive scalar operations.  Very\n// repetitive.  This code is inserted directly into both CUDA and\n// OpenCL programs, as well as the CPU code, so it has some #ifdefs to\n// work everywhere.  Some operations are defined as macros because\n// this allows us to use them as constant expressions in things like\n// array sizes and static initialisers.\n\n// Some of the #ifdefs are because OpenCL uses type-generic functions\n// for some operations (e.g. sqrt), while C and CUDA sensibly use\n// distinct functions for different precisions (e.g. sqrtf() and\n// sqrt()).  This is quite annoying.  Due to C's unfortunate casting\n// rules, it is also really easy to accidentally implement\n// floating-point functions in the wrong precision, so be careful.\n\n/", "/ Double-precision definitions are only included if the preprocessor\n// macro FUTHARK_F64_ENABLED is set.\n\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);\n\nSCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {\n  return x * y;\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  // This strange pattern is used to prevent the ISPC compiler from\n  // causing SIGFPEs and bogus results on divisions where inactive lanes\n  // have 0-valued divisors. It ensures that any inactive lane instead\n  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  uint", "8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALA",
                                    "R_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t q = x / ys;\n  int8_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t q = x / ys;\n  int16_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n  int32_t q = x / ys;\n  int32_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t q = x / ys;\n  int64_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y)", " {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int32_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) ", "{\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  ",
                                    "foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\n#else\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  return", " y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t q = x / y;\n  int8_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t q = x / y;\n  int16_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t q = x / y;\n  int32_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t q = x / y;\n  int64_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t r = ", "x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t ",
                                    "y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {\n  return (uint8_t)(x << y);\n}\n\nS", "CALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {\n  return (uint16_t)(x << y);\n}\n\nSCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult64(uint64_t x, uint64", "_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {\n  uint8_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {\n  uint16_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {\n  uint32_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {\n  uint64_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x",
                                    ") {\n  return x;\n}\n\nSCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {\n  return x;\n}\n\n#define sext_i8_i8(x) ((int8_t) (int8_t) (x))\n#define sext_i8_i16(x) ((int16_t) (int8_t) (x))\n#define sext_i8_i32(x) ((int32_t) (int8_t) (x))\n#define sext_i8_i64(x) ((int64_t) (int8_t) (x))\n#define sext_i16_i8(x) ((int8_t) (int16_t) (x))\n#define sext_i16_i16(x) ((int16_t) (int16_t) (x))\n#define sext_i16_i32(x) ((int32_t) (int16_t) (x))\n#define sext_i16_i64(x) ((int64_t) (int16_t) (x))\n#define sext_i32_i8(x) ((int8_t) (int32_t) (x))\n#define sext_i32_i16(x) ((int16_t) (int32_t) (x))\n#define sext_i32_i32(x) ((int32_t) (int32_t) (x))\n#define sext_i32_i64(x) ((int64_t) (int32_t) (x))\n#define sext_i64_i8(x) ((int8_t) (int64_t) (x))\n#define sext_i64_i16(x) ((int16_t) (int64_t) (x))\n#define sext_i64_i32(x) ((int32_t) (int64_t) (x))\n#define sext_i64_i64(x) ((int64_t) (int64_t) (x))\n#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))\n#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))\n#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))\n#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))\n#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))\n#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))\n#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))\n#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))\n#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))\n#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))\n#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))\n#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))\n#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))\n#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))\n#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))\n#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))\n\nSCALAR_FUN_ATTR int8_t abs8(int8_t x) {\n  return (int8_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int16_t abs16(int16_t x) {\n  return (int16_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int32_t abs32(int32_t x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR int64_t abs64(int64_t x) {\n#if defined(__OPENCL_VER", "SION__) || defined(ISPC)\n  return abs(x);\n#else\n  return llabs(x);\n#endif\n}\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return __popc(zext_i8_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return __popc(zext_i16_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return __popc(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return __popcll(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return m", "ul_hi(a, b); }\n#elif defined(__CUDA_ARCH__)\nSCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }\nSCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }\n#elif ISPC\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 = al * bl;\n  uint64_t p2 = al * bh;\n  uint64_t p3 = ah * bl;\n  uint64_t p4 = ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\nSCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR int",
                                    "32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 =  al * bl;\n  int64_t  p2 = al * bh;\n  int64_t  p3 = ah * bl;\n  uint64_t p4 =  ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\n\n#else // Not OpenCL, ISPC, or CUDA, but plain C.\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }\nSCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t ", "a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }\n#else // Not OpenCL\n\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return clz(x);\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return __clz(zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return __clz(zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  retur", "n __clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return __clzll(x);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return count_leading_zeros((int32_t)(uint8_t)x)-24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return count_leading_zeros((int32_t)(uint16_t)x)-16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return count_leading_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return count_leading_zeros(x);\n}\n\n#else // Not OpenCL, ISPC or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_clz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int i = 0;\n  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int i = 0;\n  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int i = 0;\n  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int i = 0;\n  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 8 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 16 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 32 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int y = __ffsll(x);\n  return y == 0 ? 64 : y - 1",
                                    ";\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return count_trailing_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return count_trailing_zeros(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);\n}\n#endif\n\nSCALAR_FUN_ATTR float fdiv32(float x, float y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR float fadd32(float x, float y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR float fsub32(float x, float y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR float fmul32(float x, float y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt32(float x, float y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple32(float x, float y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {\n  return (float) x;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, f", "loat y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return pow(x, y);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float a, float b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\n#else // Not OpenCL, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return powf(x, y);\n}\n#endif\n\nSCALAR_FUN_ATTR bool futrts_isnan32(float x) {\n  return isnan(x);\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite32(float x) {\n  return !isnan(x) && !futrts_isinf32(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return isinf(x);\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  };\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {", "\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f32_bool(float x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR float btof_bool_f32(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinh(x);\n}\n\nSC",
                                    "ALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fma(a, b, c);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return futrts_log32(x) / log(2.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return futrts_log32(x) / log(10.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;\n  float y = 1.0f + x;\n  float z = y - 1.0f;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform float cbrtf(uniform float);\nSCALAR_FUN_ATTR float futrts_cbrt32(float", " x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return (exp(x)+exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return (exp(x)-exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return futrts_sinh32(x)/futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  float f = x+sqrt(x*x-1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  float f = x+sqrt(x*x+1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  float f = (1+x)/(1-x);\n  if(futrts_isfinite32(f)) return log(f)/2.0f;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {\n    x = abs(x);\n    y = abs(y);\n    float a;\n    float b;\n    if (x >= y){\n        a = x;\n        b = y;\n    } else {\n        a = y;\n        b = x;\n    }\n    if(b == 0){\n      return a;\n    }\n\n    int e;\n    float an;\n    float bn;\n    an = frexp (a, &e);\n    bn = ldexp (b, - e);\n    float cn;\n    cn = sqrt (an * an + bn * bn);\n    return ldexp (cn, e);\n  } else {\n    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;\n    else return x + y;\n  }\n\n}\n\nextern \"C\" unmasked uniform float tgammaf(", "uniform float x);\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = tgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = lgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erff(uniform float x);\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erff(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erfcf(uniform float x);\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erfcf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform float nextafterf(uniform float x, uniform float y);\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  float res;\n  foreach_active (i) {\n    uniform float r = nextafterf(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  int32_t xb = futrts_to_bits32(x);\n  int32_t yb = futrts_to_bits32(y);\n  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futr",
                                    "ts_fma32(float a, float b, float c) {\n  return a * b + c;\n}\n\n#else // Not OpenCL or ISPC, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return logf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1pf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return expf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  re", "turn rintf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floorf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceilf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafterf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexpf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysignf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fmaf(a, b, c);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  return intbits(x);\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  return floatbits(x);\n}\n#else\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  union {\n    float f;\n    int32_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  union {\n    int32_t f;\n    float t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\nSCALAR_FUN_ATTR float fsignum32(float x) {\n  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf64(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite64(float x) {\n  return !isnan(x) && !futrts_isinf64(x);\n}\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}", "\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double a, double b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return futrts_log64(x)/log(2.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return futrts_log64(x)/log(10.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;\n  double y = 1.0d + x;\n  double z = y - 1.0d;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform double cbrt(uniform double);\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(dou",
                                    "ble x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return (exp(x)+exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return (exp(x)-exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return futrts_sinh64(x)/futrts_cosh64(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  double f = x+sqrt(x*x-1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  double f = x+sqrt(x*x+1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  double f = (1.0d+x)/(1.0d-x);\n  if(futrts_isfinite64(f)) return log(f)/2.0d;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nextern \"C\" unmasked uniform double hypot(uniform double x, uniform double y);\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = hypot(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double tgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = tgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double lgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = lgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erf(uniform double x);\nSCALAR_FUN_ATTR do", "uble futrts_erf64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erfc(uniform double x);\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erfc(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform double nextafter(uniform float x, uniform double y);\nSCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = nextafter(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int", "16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0.0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1.0 : 0.0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  int64_t res;\n  foreach_active (i) {\n    uniform double tmp = extract(x, i);\n    uniform int64_t r = *((uniform int64_t* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  double res;\n  foreach_active (i) {\n    uniform int64_t tmp = extract(x, i);\n    uniform double r = *((uniform double* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {\n  int64_t xb = futrts_to_bits64(x);\n  int64_t yb = futrts_to_bits64(y);\n  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#e",
                                    "lse\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double x, double y) {\n  return pow(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(double x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  r", "eturn tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erf64(double x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return fma(a, b, c);\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf64(double x) {\n  return isinf(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x", ") {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1 : 0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  union {\n    double f;\n    int64_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  union {\n    int64_t f;\n    double t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n#ifdef __OPENCL_VERSION__\n  return mix(v0, v1, t);\n#else\n  return v0 + (v1 - v0) * t;\n#endif\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n#ifdef __OPENCL_VERSION__\n  return mad(a, b, c);\n#else\n  return a * b + c;\n#endif\n}\n\nSCALAR",
                                    "_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#endif\n\n#endif\n\n// End of scalar.h.\n// Start of scalar_f16.h.\n\n// Half-precision is emulated if needed (e.g. in straight C) with the\n// native type used if possible.  The emulation works by typedef'ing\n// 'float' to 'f16', and then implementing all operations on single\n// precision.  To cut down on duplication, we use the same code for\n// those Futhark functions that require just operators or casts.  The\n// in-memory representation for arrays will still be 16 bits even\n// under emulation, so the compiler will have to be careful when\n// generating reads or writes.\n\n#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))\n#define EMULATE_F16\n#endif\n\n#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)\n#pragma OPENCL EXTENSION cl_khr_fp16 : enable\n#endif\n\n#ifdef EMULATE_F16\n\n// Note that the half-precision storage format is still 16 bits - the\n// compiler will have to be real careful!\ntypedef float f16;\n\n#elif ISPC\ntypedef float16 f16;\n\n#else\n\n#ifdef __CUDA_ARCH__\n#include <cuda_fp16.h>\n#endif\n\ntypedef half f16;\n\n#endif\n\n// Some of these functions convert to single precision because half\n// precision versions are not available.\n\nSCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {\n  return (f16) x;\n}\n\nSCALAR", "_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {\n  return (int8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {\n  return (int16_t) x;\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {\n  return (int32_t) x;\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {\n  return (int64_t) x;\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {\n  return (uint8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {\n  return (uint16_t) x;\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {\n  return (uint32_t) x;\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {\n  return (uint64_t) x;\n}\n\nSCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {\n  return x != (f16)0;\n}\n\nSCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifndef EMULATE_F16\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return isnan((float)x);\n}\n\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#elif ISPC\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#else // Assuming CUDA.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 ", "x, f16 y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return powf(x, y);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf16(float x) {\n  return !futrts_isnan16(x) && futrts_isnan16(x - x);\n}\nSCALAR_FUN_ATTR bool futrts_isfinite16(float x) {\n  return !futrts_isnan16(x) && !futrts_isinf16(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return isinf((float)x);\n}\n#endif\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return e",
                                    "rf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fma(a, b, c);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log16(x) / log(2.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log16(x) / log(10.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;\n  f16 y = 1.0f16 + x;\n  f16 z = y - 1.0f16;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return (float16)sqrt((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return (float16)cos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return (float16)sin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return (float16)tan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return (float16)acos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return (float16)asin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return (float16)atan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  retu", "rn (exp(x)+exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return (exp(x)-exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_sinh16(x)/futrts_cosh16(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x-1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x+1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  float16 f = (1+x)/(1-x);\n  if(futrts_isfinite16(f)) return log(f)/2.0f16;\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return (float16)atan2((float)x, (float)y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return (float16)futrts_hypot32((float)x, (float)y);\n}\n\nextern \"C\" unmasked uniform float tgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)tgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)lgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  f16 res = (f16)futrts_cbrt32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  f16 res = (f16)futrts_erf32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  f16 res = (f16)futrts_erfc32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return x - y * (float16)trunc((float) (x/y));\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return (float16)round((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return (float16)floor((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return (float16)ceil((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrt", "s_nextafter16(f16 x, f16 y) {\n  return (float16)futrts_nextafter32((float)x, (float) y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\n#else // Assume CUDA.\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return hlog(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return hlog2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return hlog10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return (f16)log1pf((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return hsqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return hexp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return hcos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return hsin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f1",
                                    "6 x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rintf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return hfloor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return hceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fmaf(a, b, c);\n}\n\n#endif\n\n// The CUDA __half type cannot be put in unions for some reason, so we\n// use bespoke conversion functions instead.\n#ifdef __CUDA_ARCH__\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return __half_as_ushort(x);\n}\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return __ushort_as_half(x);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  varying int16_t y = *((varying int16_t * uniform)&x);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  varying f16 y = *((varying f16 * uniform)&x);\n  return y;\n}\n#else\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  union {\n    f16 f;\n    int16_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  union {\n    int16_t f;\n    f16 t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\n#else // No native f16 - emulate.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs32(x);\n}\n\nSC", "ALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return fpow32(x, y);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return futrts_isnan32(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return futrts_isinf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_log32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log2_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log10_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return futrts_log1p_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return futrts_sqrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return futrts_cbrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return futrts_exp32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return futrts_cos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return futrts_sin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return futrts_tan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return futrts_acos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return futrts_asin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return futrts_atan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return futrts_sinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_tanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return futrts_acosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return futrts_asinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return futrts_atanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return futrts_atan2_32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return futrts_hypot32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return futrts_gamma32(x);\n}\n\nSCA", "LAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return futrts_lgamma32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return futrts_erf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return futrts_erfc32(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return futrts_round32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return futrts_floor32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return futrts_ceil32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return futrts_lerp32(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return futrts_mad32(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return futrts_fma32(a, b, c);\n}\n\n// Even when we are using an OpenCL that does not support cl_khr_fp16,\n// it must still support vload_half for actually creating a\n// half-precision number, which can then be efficiently converted to a\n// float.  Similarly for vstore_half.\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  int16_t y;\n  // Violating strict aliasing here.\n  vstore_half((float)x, 0, (half*)&y);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return (f16)vload_half(0, (half*)&x);\n}\n\n#else\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return (int16_t)float2halfbits(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return halfbits2float((uint16_t)x);\n}\n\nSCALAR_FUN_ATTR f16 fsignum16(f16 x) {\n  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#endif\n\n#endif\n\nSCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {\n  retu",
                                    "rn x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {\n  return (f16) x;\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {\n  return (double) x;\n}\n\n#if ISPC\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) ((float)x);\n}\n#else\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) x;\n}\n#endif\n#endif\n\n\n// End of scalar_f16.h.\n// Start of atomics.h\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32", "_t *p, uint32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x);\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#el", "se\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  float ret;\n  asm volatile(\"atom.global.add.f32 %0,[%1],%2;\":\"=f\"(ret):\"l\"(p),\"f\"(x):\"memory\");\n  return ret;\n#elif defined(__opencl_c_ext_fp32_global_atomic_add)\n  // use hardware-supported atomic addition on some Intel GPUs\n  return atomic_fetch_add_explicit((volatile __global atomic_float*)p,\n                                   x,\n                                   memory_order_relaxed);\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f32)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f32(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  float old = x;\n  float ret;\n  while ((old=atomic_xchg(p, ret=atomic_xchg(p, 0.0f)+old))!=0.0f);\n  return ret;\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_shared((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile",
                                    " __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, ", "int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR uint", "64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x);\n\n#ifdef FUTHARK_F64_ENABLED\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x);\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x);\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val) {\n#if defined(F",
                                    "UTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  double ret;\n  asm volatile(\"atom.global.add.f64 %0,[%1],%2;\":\"=d\"(ret):\"l\"(p),\"d\"(x):\"memory\");\n  return ret;\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f64)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f64(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  union {int64_t i; double f;} old;\n  union {int64_t i; double f;} ret;\n  old.f = x;\n  while (1) {\n    ret.i = atom_xchg((volatile __global int64_t*)p, (int64_t)0);\n    ret.f += old.f;\n    old.i = atom_xchg((volatile __global int64_t*)p, ret.i);\n    if (old.i == 0) {\n      break;\n    }\n  }\n  return ret.f;\n#endif\n}\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  u", "nion { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do ", "{\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(v",
                                    "olatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n#endif // defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\n// End of atomics.h\n// Start of transpose.cl\n\n#define GEN_TRANSPOSE_KERNELS(NAME, ELEM_TYPE)                          \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_PER_THREAD, 1)\\\nvoid map_transpose_##NAME(SHARED_MEM_PARAM                              \\\n                          __global ELEM_TYPE *dst_mem,                  \\\n                          int64_t dst_offset,                           \\\n                          __global ELEM_TYPE *src_mem,                  \\\n                          int64_t src_offset,                           \\\n                          int32_t num_arrays,                           \\\n                          int32_t x_elems,                              \\\n                          int32_t y_elems,                              \\\n                          int32_t mulx,                                 \\\n                          int32_t muly,                                 \\\n                          int32_t repeat_1,                             \\\n                          int32_t repeat_2) {                           \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_g", "lobal_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = global_id_0;                                    \\\n      int32_t y_index = tblock_id_1 * TR_TILE_DIM + get_local_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_in", "dex + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_height(SHARED_MEM_PARAM                 \\\n                                                __global ELEM_TYPE *dst_mem, \\\n                                                int64_t dst_offset,     \\\n                                                __global ELEM_TYPE *src_mem, \\\n                                                int64_t src_offset,     \\\n                                                int32_t num_arrays,     \\\n                                                int32_t x_elems,        \\\n                                                int32_t y_elems,        \\\n                                                int32_t mulx,           \\\n                                                int32_t muly,           \\\n                                                int32_t repeat_1,       \\\n ",
                                    "                                               int32_t repeat_2) {     \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index =                                                 \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n        get_local_id(0) +                                               \\\n        get_local_id(1)%mulx * TR_BLOCK_DIM;                            \\\n      int32_t y_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(1)/mulx; \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(0)/mulx;      \\\n      y_index =                                                         \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n", "        get_local_id(1) +                                               \\\n        (get_local_id(0)%mulx) * TR_BLOCK_DIM;                          \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n      if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_width(SHARED_MEM_PARAM                  \\\n                                      __global ELEM_TYPE *dst_mem,      \\\n                                      int64_t dst_offset,               \\\n                                      __global ELEM_TYPE *src_mem,      \\\n                                      int64_t src_offset,               \\\n                                      int32_t num_arrays,               \\\n                                      int32_t x_elems,                  \\\n                                      int32_t y_elems,                  \\\n                                      int32_t mulx,                     \\\n                                      int32_t muly,                     \\\n                                      int32_t repeat_1,                 \\\n  ", "                                    int32_t repeat_2) {               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(0)/muly; \\\n      int32_t y_index =                                                 \\\n        tblock_id_1 * TR_BLOCK_DIM * muly +                             \\\n        get_local_id(1) + (get_local_id(0)%muly) * TR_BLOCK_DIM;        \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM * muly +                     \\\n        get_local_id(0) + (get_local_id(1)%muly) * TR_BLOCK_DIM;        \\\n      y_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(1)/muly;      \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n ",
                                    "     if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_num_tblocks(2) * get_local_size(2);            \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_num_tblocks(1) * get_local_size(1);              \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*TR_BLOCK_DIM, 1, 1)                   \\\nvoid map_transpose_##NAME##_small(SHARED_MEM_PARAM                       \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int32_t num_arrays,                   \\\n                                  int32_t x_elems,                      \\\n                                  int32_t y_elems,                      \\\n                                  int32_t mulx,                         \\\n                                  int32_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  ", "int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = global_id_0/(y_elems * x_elems) * y_elems * x_elems; \\\n      int32_t x_index = (global_id_0 % (y_elems * x_elems))/y_elems;    \\\n      int32_t y_index = global_id_0%y_elems;                            \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      int32_t index_out = x_index * y_elems + y_index;                  \\\n      if (global_id_0 < x_elems * y_elems * num_arrays) {               \\\n        dst_mem[odata_offset + index_out] = src_mem[idata_offset + index_in]; \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_", "PER_THREAD, 1)\\\nvoid map_transpose_##NAME##_large(SHARED_MEM_PARAM                      \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int64_t num_arrays,                   \\\n                                  int64_t x_elems,                      \\\n                                  int64_t y_elems,                      \\\n                                  int64_t mulx,                         \\\n                                  int64_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;             \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int64_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int64_t odata_offset = dst_offset + our_array_offset;             \\\n      int64_t idata_offset = src_offset + our_array_offset;             \\\n      int64_t x_index = global_id_0;                                    \\\n      int64_t y_index = tblock_id_1 * TR_TILE_DIM + get_loc",
                                    "al_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                      ", "                             \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n\nGEN_TRANSPOSE_KERNELS(1b, uint8_t)\nGEN_TRANSPOSE_KERNELS(2b, uint16_t)\nGEN_TRANSPOSE_KERNELS(4b, uint32_t)\nGEN_TRANSPOSE_KERNELS(8b, uint64_t)\n\n// End of transpose.cl\n// Start of copy.cl\n\n#define GEN_COPY_KERNEL(NAME, ELEM_TYPE) \\\nFUTHARK_KERNEL void lmad_copy_##NAME(SHARED_MEM_PARAM                   \\\n                               __global ELEM_TYPE *dst_mem,             \\\n                               int64_t dst_offset,                      \\\n                               __global ELEM_TYPE *src_mem,             \\\n                               int64_t src_offset,                      \\\n                               int64_t n,                               \\\n                               int r,                                   \\\n                               int64_t shape0, int64_t dst_stride0, int64_t src_stride0, \\\n                               int64_t shape1, int64_t dst_stride1, int64_t src_stride1, \\\n                               int64_t shape2, int64_t dst_stride2, int64_t src_stride2, \\\n                               int64_t shape3, int64_t dst_stride3, int64_t src_stride3, \\\n                               int64_t shape4, int64_t dst_stride4, int64_t src_stride4, \\\n                               int64_t shape5, int64_t dst_stride5, int64_t src_stride5, \\\n                               int64_t shape6, int64_t dst_stride6, int64_t src_stride6, \\\n                               int64_t shape7, int64_t dst_stride7, int64_t src_stride7) { \\\n  int64_t gtid = get_global_id(0);                                      \\\n  int64_t remainder = gtid;                                             \\\n                                             ", "                           \\\n  if (gtid >= n) {                                                      \\\n    return;                                                             \\\n  }                                                                     \\\n                                                                        \\\n  if (r > 0) {                                                          \\\n    int64_t i = remainder % shape0;                                     \\\n    dst_offset += i * dst_stride0;                                      \\\n    src_offset += i * src_stride0;                                      \\\n    remainder /= shape0;                                                \\\n  }                                                                     \\\n  if (r > 1) {                                                          \\\n    int64_t i = remainder % shape1;                                     \\\n    dst_offset += i * dst_stride1;                                      \\\n    src_offset += i * src_stride1;                                      \\\n    remainder /= shape1;                                                \\\n  }                                                                     \\\n  if (r > 2) {                                                          \\\n    int64_t i = remainder % shape2;                                     \\\n    dst_offset += i * dst_stride2;                                      \\\n    src_offset += i * src_stride2;                                      \\\n    remainder /= shape2;                                                \\\n  }                                                                     \\\n  if (r > 3) {                                                          \\\n    int64_t i = remainder % shape3;                                     \\\n    dst_offset += i * dst_stride3;                                      \\\n    src_offset += i * src_stride3;                                      \\\n    remainder /= shape3;                       ",
                                    "                         \\\n  }                                                                     \\\n  if (r > 4) {                                                          \\\n    int64_t i = remainder % shape4;                                     \\\n    dst_offset += i * dst_stride4;                                      \\\n    src_offset += i * src_stride4;                                      \\\n    remainder /= shape4;                                                \\\n  }                                                                     \\\n  if (r > 5) {                                                          \\\n    int64_t i = remainder % shape5;                                     \\\n    dst_offset += i * dst_stride5;                                      \\\n    src_offset += i * src_stride5;                                      \\\n    remainder /= shape5;                                                \\\n  }                                                                     \\\n  if (r > 6) {                                                          \\\n    int64_t i = remainder % shape6;                                     \\\n    dst_offset += i * dst_stride6;                                      \\\n    src_offset += i * src_stride6;                                      \\\n    remainder /= shape6;                                                \\\n  }                                                                     \\\n  if (r > 7) {                                                          \\\n    int64_t i = remainder % shape7;                                     \\\n    dst_offset += i * dst_stride7;                                      \\\n    src_offset += i * src_stride7;                                      \\\n    remainder /= shape7;                                                \\\n  }                                                                     \\\n                                                                        \\\n  dst_mem[dst_offset] = src_mem[src_offset];     ", "                       \\\n}\n\nGEN_COPY_KERNEL(1b, uint8_t)\nGEN_COPY_KERNEL(2b, uint16_t)\nGEN_COPY_KERNEL(4b, uint32_t)\nGEN_COPY_KERNEL(8b, uint64_t)\n\n// End of copy.cl\n\n\n\nFUTHARK_KERNEL\nvoid builtinzhiota_i64ziiota_i64_53454(int64_t n_53450, int64_t x_53451, int64_t s_53452, int64_t virt_num_tblocks_53459, int64_t num_tblocks_53460, __global unsigned char *mem_53449)\n{\n    int32_t iota_ltid_53455;\n    int32_t tblock_sizze_53457;\n    int32_t iota_gid_53456;\n    int32_t iota_gtid_53454;\n    int32_t phys_tblock_id_53461;\n    int32_t iterations_53462;\n    \n    iota_ltid_53455 = get_local_id(0);\n    tblock_sizze_53457 = get_local_size(0);\n    iota_gid_53456 = get_tblock_id(0);\n    iota_gtid_53454 = iota_gid_53456 * tblock_sizze_53457 + iota_ltid_53455;\n    phys_tblock_id_53461 = get_tblock_id(0);\n    iterations_53462 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53459) - phys_tblock_id_53461, sext_i64_i32(num_tblocks_53460));\n    for (int32_t i_53463 = 0; i_53463 < iterations_53462; i_53463++) {\n        int32_t virt_tblock_id_53464;\n        int64_t global_tid_53465;\n        \n        virt_tblock_id_53464 = phys_tblock_id_53461 + i_53463 * sext_i64_i32(num_tblocks_53460);\n        global_tid_53465 = sext_i32_i64(virt_tblock_id_53464) * sext_i32_i64(tblock_sizze_53457) + sext_i32_i64(iota_ltid_53455);\n        if (slt64(global_tid_53465, n_53450)) {\n            ((__global int64_t *) mem_53449)[global_tid_53465] = add64(mul64(global_tid_53465, s_53452), x_53451);\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_boolzireplicate_53514(int64_t num_elems_53510, unsigned char val_53511_bits, int64_t replicate_n_53513, int64_t virt_num_tblocks_53519, int64_t num_tblocks_53520, __global unsigned char *mem_53509)\n{\n    bool val_53511 = val_53511_bits;\n    int32_t replicate_ltid_53515;\n    int32_t tblock_sizze_53517;\n    int32_t replicate_gid_53516;\n    int32_t replicate_gtid_53514;\n    int32_t p", "hys_tblock_id_53521;\n    int32_t iterations_53522;\n    \n    replicate_ltid_53515 = get_local_id(0);\n    tblock_sizze_53517 = get_local_size(0);\n    replicate_gid_53516 = get_tblock_id(0);\n    replicate_gtid_53514 = replicate_gid_53516 * tblock_sizze_53517 + replicate_ltid_53515;\n    phys_tblock_id_53521 = get_tblock_id(0);\n    iterations_53522 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53519) - phys_tblock_id_53521, sext_i64_i32(num_tblocks_53520));\n    for (int32_t i_53523 = 0; i_53523 < iterations_53522; i_53523++) {\n        int32_t virt_tblock_id_53524;\n        int64_t global_tid_53525;\n        int64_t slice_53527;\n        int64_t rep_i_53526;\n        int64_t remnant_53528;\n        \n        virt_tblock_id_53524 = phys_tblock_id_53521 + i_53523 * sext_i64_i32(num_tblocks_53520);\n        global_tid_53525 = sext_i32_i64(virt_tblock_id_53524) * sext_i32_i64(tblock_sizze_53517) + sext_i32_i64(replicate_ltid_53515);\n        slice_53527 = num_elems_53510;\n        rep_i_53526 = global_tid_53525;\n        remnant_53528 = global_tid_53525 - rep_i_53526;\n        if (slt64(global_tid_53525, replicate_n_53513)) {\n            ((__global bool *) mem_53509)[rep_i_53526] = val_53511;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_f32zireplicate_53288(int64_t num_elems_53284, float val_53285, int64_t replicate_n_53287, int64_t virt_num_tblocks_53293, int64_t num_tblocks_53294, __global unsigned char *mem_53283)\n{\n    int32_t replicate_ltid_53289;\n    int32_t tblock_sizze_53291;\n    int32_t replicate_gid_53290;\n    int32_t replicate_gtid_53288;\n    int32_t phys_tblock_id_53295;\n    int32_t iterations_53296;\n    \n    replicate_ltid_53289 = get_local_id(0);\n    tblock_sizze_53291 = get_local_size(0);\n    replicate_gid_53290 = get_tblock_id(0);\n    replicate_gtid_53288 = replicate_gid_53290 * tblock_sizze_53291 + replicate_ltid_53289;\n    phys_tblock_id_53295 = get_tblock_id(0);\n    iterat",
                                    "ions_53296 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53293) - phys_tblock_id_53295, sext_i64_i32(num_tblocks_53294));\n    for (int32_t i_53297 = 0; i_53297 < iterations_53296; i_53297++) {\n        int32_t virt_tblock_id_53298;\n        int64_t global_tid_53299;\n        int64_t slice_53301;\n        int64_t rep_i_53300;\n        int64_t remnant_53302;\n        \n        virt_tblock_id_53298 = phys_tblock_id_53295 + i_53297 * sext_i64_i32(num_tblocks_53294);\n        global_tid_53299 = sext_i32_i64(virt_tblock_id_53298) * sext_i32_i64(tblock_sizze_53291) + sext_i32_i64(replicate_ltid_53289);\n        slice_53301 = num_elems_53284;\n        rep_i_53300 = global_tid_53299;\n        remnant_53302 = global_tid_53299 - rep_i_53300;\n        if (slt64(global_tid_53299, replicate_n_53287)) {\n            ((__global float *) mem_53283)[rep_i_53300] = val_53285;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i32zireplicate_53231(int64_t num_elems_53227, int32_t val_53228, int64_t replicate_n_53230, int64_t virt_num_tblocks_53236, int64_t num_tblocks_53237, __global unsigned char *mem_53226)\n{\n    int32_t replicate_ltid_53232;\n    int32_t tblock_sizze_53234;\n    int32_t replicate_gid_53233;\n    int32_t replicate_gtid_53231;\n    int32_t phys_tblock_id_53238;\n    int32_t iterations_53239;\n    \n    replicate_ltid_53232 = get_local_id(0);\n    tblock_sizze_53234 = get_local_size(0);\n    replicate_gid_53233 = get_tblock_id(0);\n    replicate_gtid_53231 = replicate_gid_53233 * tblock_sizze_53234 + replicate_ltid_53232;\n    phys_tblock_id_53238 = get_tblock_id(0);\n    iterations_53239 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53236) - phys_tblock_id_53238, sext_i64_i32(num_tblocks_53237));\n    for (int32_t i_53240 = 0; i_53240 < iterations_53239; i_53240++) {\n        int32_t virt_tblock_id_53241;\n        int64_t global_tid_53242;\n        int64_t slice_53244;\n        int64_t rep_i_53243;\n        int64", "_t remnant_53245;\n        \n        virt_tblock_id_53241 = phys_tblock_id_53238 + i_53240 * sext_i64_i32(num_tblocks_53237);\n        global_tid_53242 = sext_i32_i64(virt_tblock_id_53241) * sext_i32_i64(tblock_sizze_53234) + sext_i32_i64(replicate_ltid_53232);\n        slice_53244 = num_elems_53227;\n        rep_i_53243 = global_tid_53242;\n        remnant_53245 = global_tid_53242 - rep_i_53243;\n        if (slt64(global_tid_53242, replicate_n_53230)) {\n            ((__global int32_t *) mem_53226)[rep_i_53243] = val_53228;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i64zireplicate_53359(int64_t num_elems_53355, int64_t val_53356, int64_t replicate_n_53358, int64_t virt_num_tblocks_53364, int64_t num_tblocks_53365, __global unsigned char *mem_53354)\n{\n    int32_t replicate_ltid_53360;\n    int32_t tblock_sizze_53362;\n    int32_t replicate_gid_53361;\n    int32_t replicate_gtid_53359;\n    int32_t phys_tblock_id_53366;\n    int32_t iterations_53367;\n    \n    replicate_ltid_53360 = get_local_id(0);\n    tblock_sizze_53362 = get_local_size(0);\n    replicate_gid_53361 = get_tblock_id(0);\n    replicate_gtid_53359 = replicate_gid_53361 * tblock_sizze_53362 + replicate_ltid_53360;\n    phys_tblock_id_53366 = get_tblock_id(0);\n    iterations_53367 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53364) - phys_tblock_id_53366, sext_i64_i32(num_tblocks_53365));\n    for (int32_t i_53368 = 0; i_53368 < iterations_53367; i_53368++) {\n        int32_t virt_tblock_id_53369;\n        int64_t global_tid_53370;\n        int64_t slice_53372;\n        int64_t rep_i_53371;\n        int64_t remnant_53373;\n        \n        virt_tblock_id_53369 = phys_tblock_id_53366 + i_53368 * sext_i64_i32(num_tblocks_53365);\n        global_tid_53370 = sext_i32_i64(virt_tblock_id_53369) * sext_i32_i64(tblock_sizze_53362) + sext_i32_i64(replicate_ltid_53360);\n        slice_53372 = num_elems_53355;\n        rep_i_53371 = global_tid", "_53370;\n        remnant_53373 = global_tid_53370 - rep_i_53371;\n        if (slt64(global_tid_53370, replicate_n_53358)) {\n            ((__global int64_t *) mem_53354)[rep_i_53371] = val_53356;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i8zireplicate_53326(int64_t num_elems_53322, int8_t val_53323, int64_t replicate_n_53325, int64_t virt_num_tblocks_53331, int64_t num_tblocks_53332, __global unsigned char *mem_53321)\n{\n    int32_t replicate_ltid_53327;\n    int32_t tblock_sizze_53329;\n    int32_t replicate_gid_53328;\n    int32_t replicate_gtid_53326;\n    int32_t phys_tblock_id_53333;\n    int32_t iterations_53334;\n    \n    replicate_ltid_53327 = get_local_id(0);\n    tblock_sizze_53329 = get_local_size(0);\n    replicate_gid_53328 = get_tblock_id(0);\n    replicate_gtid_53326 = replicate_gid_53328 * tblock_sizze_53329 + replicate_ltid_53327;\n    phys_tblock_id_53333 = get_tblock_id(0);\n    iterations_53334 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53331) - phys_tblock_id_53333, sext_i64_i32(num_tblocks_53332));\n    for (int32_t i_53335 = 0; i_53335 < iterations_53334; i_53335++) {\n        int32_t virt_tblock_id_53336;\n        int64_t global_tid_53337;\n        int64_t slice_53339;\n        int64_t rep_i_53338;\n        int64_t remnant_53340;\n        \n        virt_tblock_id_53336 = phys_tblock_id_53333 + i_53335 * sext_i64_i32(num_tblocks_53332);\n        global_tid_53337 = sext_i32_i64(virt_tblock_id_53336) * sext_i32_i64(tblock_sizze_53329) + sext_i32_i64(replicate_ltid_53327);\n        slice_53339 = num_elems_53322;\n        rep_i_53338 = global_tid_53337;\n        remnant_53340 = global_tid_53337 - rep_i_53338;\n        if (slt64(global_tid_53337, replicate_n_53325)) {\n            ((__global int8_t *) mem_53321)[rep_i_53338] = val_53323;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(calc_global_",
                                    "Skyline_9665zisegmap_49657_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49657(__global int *global_failure, int64_t dim_33449, int64_t dz2082U_33453, int64_t inf_33494, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, unsigned char cond_46544_bits, unsigned char x_52545_bits, int64_t num_threads_52944, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52571, __global unsigned char *mem_52633, __global unsigned char *color_52936)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    \n    #define segmap_tblock_sizze_49653 (calc_global_Skyline_9665zisegmap_49657zisegmap_tblock_sizze_49653)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53242;\n    int32_t tblock_sizze_53245;\n    int32_t wave_sizze_53244;\n    int32_t block_id_53243;\n    int32_t global_tid_53241;\n    int64_t phys_tid_49657;\n    int64_t global_tid_53246;\n    int64_t slice_53247;\n    int64_t gtid_49656;\n    int64_t remnant_53248;\n    \n    local_tid_53242 = get_local_id(0);\n    tblock_sizze_53245 = get_local_size(0);\n    wave_sizze_53244 = LOCKSTEP_WIDTH;\n    block_id_53243 = get_tblock_id(0);\n    global_tid_53241 = block_id_53243 * tblock_sizze_53245 + local_tid_53242;\n    phys_tid_49657 = sext_i32_i64(global_tid_53241);\n    global_tid_53246 = sext_i32_i64(block_id_53243) * segmap_tblock_sizze_49653 + sext_i32_i64(local_tid_53242);\n    slice_53247 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n    gtid_49656 = global_tid_53246;\n    remnant_53248 = global_tid_53246 - gtid_49656;\n    if (slt64(gtid_49656, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500)) {\n        int64_t slice_52160;\n        bool defunc_0_reduce_res_49660;\n        bool redout_52478;\n        int64_t lifted_lambda_res_49701;\n        \n        slice_52160 = inf_33494 + gtid_49656;\n        redout_52478 = 0;\n        for (int64_t i_52479 = 0; i_52479 < dz2082U_33453; i_52479++) {\n            bool defunc_0_reduce_res_49672;\n            bool defunc_0_sm_red_res_49662;\n            bool lifted", "_lambda_res_49679;\n            bool defunc_0_op_res_49700;\n            bool redout_tmp_53249;\n            \n            if (x_52545) {\n                bool x_52835;\n                bool redout_52484 = 1;\n                \n                for (int64_t i_52485 = 0; i_52485 < dim_33449; i_52485++) {\n                    float eta_p_49673;\n                    float eta_p_49674;\n                    bool zgze_res_49675;\n                    bool x_49678;\n                    bool redout_tmp_53250;\n                    \n                    eta_p_49673 = ((__global float *) mem_52633)[slice_52160 + i_52485 * dz2082U_33453];\n                    eta_p_49674 = ((__global float *) xys_mem_52568)[i_52479 * dim_33449 + i_52485];\n                    zgze_res_49675 = eta_p_49674 <= eta_p_49673;\n                    x_49678 = zgze_res_49675 && redout_52484;\n                    redout_tmp_53250 = x_49678;\n                    redout_52484 = redout_tmp_53250;\n                }\n                x_52835 = redout_52484;\n                defunc_0_reduce_res_49672 = x_52835;\n            } else {\n                defunc_0_reduce_res_49672 = 0;\n            }\n            if (cond_46544) {\n                bool defunc_0_foldl_res_49667;\n                bool acc_49669;\n                \n                for (int64_t i_52482 = 0; i_52482 < dim_33449; i_52482++) {\n                    float eta_p_49664;\n                    float eta_p_49665;\n                    bool zgze_res_49666;\n                    \n                    eta_p_49664 = ((__global float *) mem_52633)[slice_52160 + i_52482 * dz2082U_33453];\n                    eta_p_49665 = ((__global float *) xys_mem_52568)[i_52479 * dim_33449 + i_52482];\n                    zgze_res_49666 = eta_p_49665 <= eta_p_49664;\n                    ((__global bool *) color_52936)[phys_tid_49657 + i_52482 * num_threads_52944] = zgze_res_49666;\n                }\n                acc_49669 = 1;\n                for (int64_t i_49668 = 0; i_49668 < dim_33449; i_49668++) {\n      ", "              bool b_49670;\n                    bool x_49671;\n                    bool acc_tmp_53252;\n                    \n                    b_49670 = ((__global bool *) color_52936)[phys_tid_49657 + i_49668 * num_threads_52944];\n                    x_49671 = acc_49669 && b_49670;\n                    acc_tmp_53252 = x_49671;\n                    acc_49669 = acc_tmp_53252;\n                }\n                defunc_0_foldl_res_49667 = acc_49669;\n                defunc_0_sm_red_res_49662 = defunc_0_foldl_res_49667;\n            } else {\n                defunc_0_sm_red_res_49662 = defunc_0_reduce_res_49672;\n            }\n            if (defunc_0_sm_red_res_49662) {\n                bool defunc_0_sm_red_res_49681;\n                \n                if (cond_46544) {\n                    bool defunc_0_foldl_res_49686;\n                    bool acc_49688;\n                    \n                    for (int64_t i_52488 = 0; i_52488 < dim_33449; i_52488++) {\n                        float eta_p_49683;\n                        float eta_p_49684;\n                        bool zg_res_49685;\n                        \n                        eta_p_49683 = ((__global float *) mem_52633)[slice_52160 + i_52488 * dz2082U_33453];\n                        eta_p_49684 = ((__global float *) xys_mem_52568)[i_52479 * dim_33449 + i_52488];\n                        zg_res_49685 = eta_p_49684 < eta_p_49683;\n                        ((__global bool *) color_52936)[phys_tid_49657 + i_52488 * num_threads_52944] = zg_res_49685;\n                    }\n                    acc_49688 = 0;\n                    for (int64_t i_49687 = 0; i_49687 < dim_33449; i_49687++) {\n                        bool b_49689;\n                        bool defunc_0_f_res_49690;\n                        bool acc_tmp_53254;\n                        \n                        b_49689 = ((__global bool *) color_52936)[phys_tid_49657 + i_49687 * num_threads_52944];\n                        defunc_0_f_res_49690 = acc_49688 || b_49689;\n               ",
                                    "         acc_tmp_53254 = defunc_0_f_res_49690;\n                        acc_49688 = acc_tmp_53254;\n                    }\n                    defunc_0_foldl_res_49686 = acc_49688;\n                    defunc_0_sm_red_res_49681 = defunc_0_foldl_res_49686;\n                } else {\n                    bool defunc_0_reduce_res_49691;\n                    bool redout_52490 = 0;\n                    \n                    for (int64_t i_52491 = 0; i_52491 < dim_33449; i_52491++) {\n                        float eta_p_49692;\n                        float eta_p_49693;\n                        bool zg_res_49694;\n                        bool defunc_0_op_res_49697;\n                        bool redout_tmp_53255;\n                        \n                        eta_p_49692 = ((__global float *) mem_52633)[slice_52160 + i_52491 * dz2082U_33453];\n                        eta_p_49693 = ((__global float *) xys_mem_52568)[i_52479 * dim_33449 + i_52491];\n                        zg_res_49694 = eta_p_49693 < eta_p_49692;\n                        defunc_0_op_res_49697 = zg_res_49694 || redout_52490;\n                        redout_tmp_53255 = defunc_0_op_res_49697;\n                        redout_52490 = redout_tmp_53255;\n                    }\n                    defunc_0_reduce_res_49691 = redout_52490;\n                    defunc_0_sm_red_res_49681 = defunc_0_reduce_res_49691;\n                }\n                lifted_lambda_res_49679 = defunc_0_sm_red_res_49681;\n            } else {\n                lifted_lambda_res_49679 = 0;\n            }\n            defunc_0_op_res_49700 = lifted_lambda_res_49679 || redout_52478;\n            redout_tmp_53249 = defunc_0_op_res_49700;\n            redout_52478 = redout_tmp_53249;\n        }\n        defunc_0_reduce_res_49660 = redout_52478;\n        if (defunc_0_reduce_res_49660) {\n            lifted_lambda_res_49701 = (int64_t) -1;\n        } else {\n            lifted_lambda_res_49701 = slice_52160;\n        }\n        ((__global int64_t *) mem_52571)[inf_33494 + gtid_49", "656] = lifted_lambda_res_49701;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49653\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegmap_49878_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49878(__global int *global_failure, int64_t inf_33494, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, __global unsigned char *mem_52571, __global unsigned char *mem_52601)\n{\n    #define segmap_tblock_sizze_49874 (calc_global_Skyline_9665zisegmap_49878zisegmap_tblock_sizze_49874)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53384;\n    int32_t tblock_sizze_53387;\n    int32_t wave_sizze_53386;\n    int32_t block_id_53385;\n    int32_t global_tid_53383;\n    int64_t phys_tid_49878;\n    int64_t global_tid_53388;\n    int64_t slice_53389;\n    int64_t gtid_49877;\n    int64_t remnant_53390;\n    \n    local_tid_53384 = get_local_id(0);\n    tblock_sizze_53387 = get_local_size(0);\n    wave_sizze_53386 = LOCKSTEP_WIDTH;\n    block_id_53385 = get_tblock_id(0);\n    global_tid_53383 = block_id_53385 * tblock_sizze_53387 + local_tid_53384;\n    phys_tid_49878 = sext_i32_i64(global_tid_53383);\n    global_tid_53388 = sext_i32_i64(block_id_53385) * segmap_tblock_sizze_49874 + sext_i32_i64(local_tid_53384);\n    slice_53389 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n    gtid_49877 = global_tid_53388;\n    remnant_53390 = global_tid_53388 - gtid_49877;\n    if (slt64(gtid_49877, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500)) {\n        int64_t index_primexp_52165;\n        bool defunc_0_reduce_res_49880;\n        int64_t lifted_lambda_res_49881;\n        \n        index_primexp_52165 = add64(inf_33494, gtid_49877);\n        defunc_0_reduce_res_49880 = ((__global bool *) mem_52601)[gtid_49877];\n        if (defunc_0_reduce_res_49880) {\n            lifted_lambda_res_49881 = (int64_t) -1;\n        } else {\n            lifted_lambda_res_49881 = index_primexp_52165;\n        }\n        ((__global int64_t *) mem_52571)[inf_33494 + gtid_49877] = lifted_lambda_res_49881;\n    }\n ", "   \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49874\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegmap_49893_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49893(__global int *global_failure, int64_t dz2082U_33453, int64_t m_45255, int64_t num_tblocks_49898, int32_t virt_num_tblocks_53517, __global unsigned char *mem_52571, __global unsigned char *mem_52657, __global unsigned char *mem_52659, __global unsigned char *mem_52661)\n{\n    #define segmap_tblock_sizze_49896 (calc_global_Skyline_9665zisegmap_49893zisegmap_tblock_sizze_49896)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53519;\n    int32_t tblock_sizze_53522;\n    int32_t wave_sizze_53521;\n    int32_t block_id_53520;\n    int32_t global_tid_53518;\n    int64_t phys_tid_49893;\n    int32_t phys_tblock_id_53523;\n    int32_t iterations_53524;\n    \n    local_tid_53519 = get_local_id(0);\n    tblock_sizze_53522 = get_local_size(0);\n    wave_sizze_53521 = LOCKSTEP_WIDTH;\n    block_id_53520 = get_tblock_id(0);\n    global_tid_53518 = block_id_53520 * tblock_sizze_53522 + local_tid_53519;\n    phys_tid_49893 = sext_i32_i64(global_tid_53518);\n    phys_tblock_id_53523 = get_tblock_id(0);\n    iterations_53524 = sdiv_up32(virt_num_tblocks_53517 - phys_tblock_id_53523, sext_i64_i32(num_tblocks_49898));\n    for (int32_t i_53525 = 0; i_53525 < iterations_53524; i_53525++) {\n        int32_t virt_tblock_id_53526;\n        int64_t global_tid_53527;\n        int64_t slice_53528;\n        int64_t write_i_49892;\n        int64_t remnant_53529;\n        \n        virt_tblock_id_53526 = phys_tblock_id_53523 + i_53525 * sext_i64_i32(num_tblocks_49898);\n        global_tid_53527 = sext_i32_i64(virt_tblock_id_53526) * segmap_tblock_sizze_49896 + sext_i32_i64(local_tid_53519);\n        slice_53528 = dz2082U_33453;\n        write_i_49892 = global_tid_53527;\n        remnant_53529 = global_tid_53527 - write_i_49892;\n        if (slt64(write_i_49892, dz2082U_33453)) {\n            int64_t eta_p_47799;\n         ",
                                    "   int64_t write_value_47801;\n            bool cond_47802;\n            int64_t lifted_lambda_res_47803;\n            \n            eta_p_47799 = ((__global int64_t *) mem_52659)[write_i_49892];\n            write_value_47801 = ((__global int64_t *) mem_52571)[write_i_49892];\n            cond_47802 = eta_p_47799 == (int64_t) 1;\n            if (cond_47802) {\n                int64_t eta_p_47800;\n                int64_t lifted_lambda_res_t_res_48220;\n                \n                eta_p_47800 = ((__global int64_t *) mem_52657)[write_i_49892];\n                lifted_lambda_res_t_res_48220 = sub64(eta_p_47800, (int64_t) 1);\n                lifted_lambda_res_47803 = lifted_lambda_res_t_res_48220;\n            } else {\n                lifted_lambda_res_47803 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_47803) && slt64(lifted_lambda_res_47803, m_45255)) {\n                ((__global int64_t *) mem_52661)[lifted_lambda_res_47803] = write_value_47801;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_49896\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegmap_49945_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49945(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2082U_33453, int64_t m_45255, __global unsigned char *mem_52661, __global unsigned char *mem_52664)\n{\n    #define segmap_tblock_sizze_49941 (calc_global_Skyline_9665zisegmap_49945zisegmap_tblock_sizze_49941)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53532;\n    int32_t tblock_sizze_53535;\n    int32_t wave_sizze_53534;\n    int32_t block_id_53533;\n    int32_t global_tid_53531;\n    int64_t phys_tid_49945;\n    int64_t global_tid_53536;\n    int64_t slice_53537;\n    int64_t gtid_49944;\n    int64_t remnant_53538;\n    \n    local_tid_53532 = get_local_id(0);\n    tblock_sizze_53535 = get_local_size(0);\n ", "   wave_sizze_53534 = LOCKSTEP_WIDTH;\n    block_id_53533 = get_tblock_id(0);\n    global_tid_53531 = block_id_53533 * tblock_sizze_53535 + local_tid_53532;\n    phys_tid_49945 = sext_i32_i64(global_tid_53531);\n    global_tid_53536 = sext_i32_i64(block_id_53533) * segmap_tblock_sizze_49941 + sext_i32_i64(local_tid_53532);\n    slice_53537 = m_45255;\n    gtid_49944 = global_tid_53536;\n    remnant_53538 = global_tid_53536 - gtid_49944;\n    if (slt64(gtid_49944, m_45255)) {\n        int64_t eta_p_49946;\n        bool x_49947;\n        bool y_49948;\n        bool bounds_check_49949;\n        bool index_certs_49950;\n        \n        eta_p_49946 = ((__global int64_t *) mem_52661)[gtid_49944];\n        x_49947 = sle64((int64_t) 0, eta_p_49946);\n        y_49948 = slt64(eta_p_49946, dz2082U_33453);\n        bounds_check_49949 = x_49947 && y_49948;\n        if (!bounds_check_49949) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_49946;\n                    global_failure_args[1] = (int64_t) dz2082U_33453;\n                    ;\n                }\n                return;\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49941\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegmap_49958_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49958(__global int *global_failure, int64_t dim_33449, int64_t m_45255, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52661, __global unsigned char *mem_52664, __global unsigned char *mem_52668)\n{\n    #define segmap_tblock_sizze_49953 (calc_global_Skyline_9665zisegmap_49958zisegmap_tblock_sizze_49953)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53541;\n    int32_t tblock_sizze_53544;\n    int32_t wave_sizze_53543;\n    int32_t block_id_53542;\n    int32_t global_tid_53540;\n    int64_t phys_tid_49958;\n    int64_t global_tid_53545;\n    int64_t slice_53546;\n    int64_t slice", "_53547;\n    int64_t gtid_49957;\n    int64_t remnant_53548;\n    int64_t gtid_slice_49956;\n    int64_t remnant_53549;\n    \n    local_tid_53541 = get_local_id(0);\n    tblock_sizze_53544 = get_local_size(0);\n    wave_sizze_53543 = LOCKSTEP_WIDTH;\n    block_id_53542 = get_tblock_id(0);\n    global_tid_53540 = block_id_53542 * tblock_sizze_53544 + local_tid_53541;\n    phys_tid_49958 = sext_i32_i64(global_tid_53540);\n    global_tid_53545 = sext_i32_i64(block_id_53542) * segmap_tblock_sizze_49953 + sext_i32_i64(local_tid_53541);\n    slice_53546 = dim_33449;\n    slice_53547 = m_45255 * slice_53546;\n    gtid_49957 = squot64(global_tid_53545, slice_53546);\n    remnant_53548 = global_tid_53545 - gtid_49957 * slice_53546;\n    gtid_slice_49956 = remnant_53548;\n    remnant_53549 = remnant_53548 - gtid_slice_49956;\n    if (slt64(gtid_49957, m_45255) && slt64(gtid_slice_49956, dim_33449)) {\n        int64_t eta_p_49959;\n        bool index_certs_49960;\n        float v_49961;\n        \n        eta_p_49959 = ((__global int64_t *) mem_52661)[gtid_49957];\n        index_certs_49960 = 0;\n        v_49961 = ((__global float *) xys_mem_52568)[eta_p_49959 * dim_33449 + gtid_slice_49956];\n        ((__global float *) mem_52668)[gtid_49957 * dim_33449 + gtid_slice_49956] = v_49961;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49953\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegmap_49967_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegmap_49967(__global int *global_failure, int64_t m_45255, __global unsigned char *xys_mem_52569, __global unsigned char *mem_52661, __global unsigned char *mem_52664, __global unsigned char *mem_52671)\n{\n    #define segmap_tblock_sizze_49963 (calc_global_Skyline_9665zisegmap_49967zisegmap_tblock_sizze_49963)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53552;\n    int32_t tblock_sizze_53555;\n    int32_t wave_sizze_53554;\n    int32_t block_id_53553;\n    int32_t global_tid_53551;\n    int64_t phys_tid_49967;\n    int64_t glo",
                                    "bal_tid_53556;\n    int64_t slice_53557;\n    int64_t gtid_49966;\n    int64_t remnant_53558;\n    \n    local_tid_53552 = get_local_id(0);\n    tblock_sizze_53555 = get_local_size(0);\n    wave_sizze_53554 = LOCKSTEP_WIDTH;\n    block_id_53553 = get_tblock_id(0);\n    global_tid_53551 = block_id_53553 * tblock_sizze_53555 + local_tid_53552;\n    phys_tid_49967 = sext_i32_i64(global_tid_53551);\n    global_tid_53556 = sext_i32_i64(block_id_53553) * segmap_tblock_sizze_49963 + sext_i32_i64(local_tid_53552);\n    slice_53557 = m_45255;\n    gtid_49966 = global_tid_53556;\n    remnant_53558 = global_tid_53556 - gtid_49966;\n    if (slt64(gtid_49966, m_45255)) {\n        int64_t eta_p_49968;\n        bool index_certs_49969;\n        int64_t lifted_lambda_res_49970;\n        \n        eta_p_49968 = ((__global int64_t *) mem_52661)[gtid_49966];\n        index_certs_49969 = 0;\n        lifted_lambda_res_49970 = ((__global int64_t *) xys_mem_52569)[eta_p_49968];\n        ((__global int64_t *) mem_52671)[gtid_49966] = lifted_lambda_res_49970;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49963\n}\nFUTHARK_KERNEL\nvoid calc_global_Skyline_9665zisegmap_intrablock_49709(__global int *global_failure, int64_t dim_33449, int64_t dz2082U_33453, int64_t inf_33494, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, unsigned char cond_46544_bits, unsigned char x_52545_bits, int64_t ctx_52966, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52571, __global unsigned char *color_52937)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    volatile __local unsigned char *red_arr_mem_53268_backing_0 = &shared_mem[0];\n    const int64_t red_arr_mem_53268_backing_0_offset = 0 + (dz2082U_33453 + srem64((int64_t) 8 - srem64(dz2082U_33453, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53259;\n    int32_t tblock_sizze_53262;\n    int32_t wave_sizze_53261;\n    int32_t block_id_53260;\n    int32_t global_tid", "_53258;\n    int64_t phys_tblock_id_49709;\n    int64_t slice_53264;\n    int64_t ltid_pre_53263;\n    int64_t remnant_53265;\n    int64_t slice_53266;\n    int64_t gtid_49708;\n    int64_t remnant_53267;\n    int64_t slice_52163;\n    int64_t binop_x_52964;\n    bool defunc_0_reduce_res_49713;\n    int64_t phys_tid_49715;\n    __local unsigned char *red_arr_mem_53268;\n    int64_t gtid_49714;\n    bool defunc_0_reduce_res_49730;\n    int64_t ctx_52965;\n    bool defunc_0_sm_red_res_49720;\n    bool lifted_lambda_res_49737;\n    int32_t offset_53276;\n    int32_t skip_waves_53277;\n    bool eta_p_49716;\n    bool eta_p_49717;\n    int64_t lifted_lambda_res_49756;\n    \n    local_tid_53259 = get_local_id(0);\n    tblock_sizze_53262 = get_local_size(0);\n    wave_sizze_53261 = LOCKSTEP_WIDTH;\n    block_id_53260 = get_tblock_id(0);\n    global_tid_53258 = block_id_53260 * tblock_sizze_53262 + local_tid_53259;\n    phys_tblock_id_49709 = sext_i32_i64(block_id_53260);\n    slice_53264 = dz2082U_33453;\n    ltid_pre_53263 = sext_i32_i64(local_tid_53259);\n    remnant_53265 = sext_i32_i64(local_tid_53259) - ltid_pre_53263;\n    slice_53266 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n    gtid_49708 = sext_i32_i64(block_id_53260);\n    remnant_53267 = sext_i32_i64(block_id_53260) - gtid_49708;\n    slice_52163 = inf_33494 + gtid_49708;\n    binop_x_52964 = dz2082U_33453 * phys_tblock_id_49709;\n    phys_tid_49715 = sext_i32_i64(local_tid_53259);\n    red_arr_mem_53268 = (__local unsigned char *) red_arr_mem_53268_backing_0;\n    gtid_49714 = sext_i32_i64(sext_i64_i32(ltid_pre_53263));\n    if (x_52545) {\n        bool x_52547;\n        bool redout_52496 = 1;\n        \n        for (int64_t i_52497 = 0; i_52497 < dim_33449; i_52497++) {\n            float eta_p_49731;\n            float eta_p_49732;\n            bool zgze_res_49733;\n            bool x_49736;\n            bool redout_tmp_53270;\n            \n            eta_p_49731 = ((__global float *) xys_mem_52568)[slice_52163 * dim_33449 + i_52497];\n            eta_p_49", "732 = ((__global float *) xys_mem_52568)[gtid_49714 * dim_33449 + i_52497];\n            zgze_res_49733 = eta_p_49732 <= eta_p_49731;\n            x_49736 = zgze_res_49733 && redout_52496;\n            redout_tmp_53270 = x_49736;\n            redout_52496 = redout_tmp_53270;\n        }\n        x_52547 = redout_52496;\n        defunc_0_reduce_res_49730 = x_52547;\n    } else {\n        defunc_0_reduce_res_49730 = 0;\n    }\n    ctx_52965 = phys_tid_49715 + binop_x_52964;\n    if (cond_46544) {\n        bool defunc_0_foldl_res_49725;\n        bool acc_49727;\n        \n        for (int64_t i_52494 = 0; i_52494 < dim_33449; i_52494++) {\n            float eta_p_49722;\n            float eta_p_49723;\n            bool zgze_res_49724;\n            \n            eta_p_49722 = ((__global float *) xys_mem_52568)[slice_52163 * dim_33449 + i_52494];\n            eta_p_49723 = ((__global float *) xys_mem_52568)[gtid_49714 * dim_33449 + i_52494];\n            zgze_res_49724 = eta_p_49723 <= eta_p_49722;\n            ((__global bool *) color_52937)[ctx_52965 + i_52494 * ctx_52966] = zgze_res_49724;\n        }\n        acc_49727 = 1;\n        for (int64_t i_49726 = 0; i_49726 < dim_33449; i_49726++) {\n            bool b_49728;\n            bool x_49729;\n            bool acc_tmp_53272;\n            \n            b_49728 = ((__global bool *) color_52937)[ctx_52965 + i_49726 * ctx_52966];\n            x_49729 = acc_49727 && b_49728;\n            acc_tmp_53272 = x_49729;\n            acc_49727 = acc_tmp_53272;\n        }\n        defunc_0_foldl_res_49725 = acc_49727;\n        defunc_0_sm_red_res_49720 = defunc_0_foldl_res_49725;\n    } else {\n        defunc_0_sm_red_res_49720 = defunc_0_reduce_res_49730;\n    }\n    if (defunc_0_sm_red_res_49720) {\n        bool x_52866;\n        bool defunc_0_reduce_res_49749;\n        int64_t binop_x_52973;\n        int64_t ctx_52974;\n        int64_t ctx_52975;\n        bool defunc_0_sm_red_res_49739;\n        \n        x_52866 = !cond_46544;\n        if (x_52866) {\n            bool x_52868;\n ",
                                    "           bool redout_52502 = 0;\n            \n            for (int64_t i_52503 = 0; i_52503 < dim_33449; i_52503++) {\n                float eta_p_49750;\n                float eta_p_49751;\n                bool zg_res_49752;\n                bool defunc_0_op_res_49755;\n                bool redout_tmp_53273;\n                \n                eta_p_49750 = ((__global float *) xys_mem_52568)[slice_52163 * dim_33449 + i_52503];\n                eta_p_49751 = ((__global float *) xys_mem_52568)[gtid_49714 * dim_33449 + i_52503];\n                zg_res_49752 = eta_p_49751 < eta_p_49750;\n                defunc_0_op_res_49755 = zg_res_49752 || redout_52502;\n                redout_tmp_53273 = defunc_0_op_res_49755;\n                redout_52502 = redout_tmp_53273;\n            }\n            x_52868 = redout_52502;\n            defunc_0_reduce_res_49749 = x_52868;\n        } else {\n            defunc_0_reduce_res_49749 = 0;\n        }\n        binop_x_52973 = dz2082U_33453 * phys_tblock_id_49709;\n        ctx_52974 = phys_tid_49715 + binop_x_52973;\n        ctx_52975 = dz2082U_33453 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n        if (cond_46544) {\n            bool defunc_0_foldl_res_49744;\n            bool acc_49746;\n            \n            for (int64_t i_52500 = 0; i_52500 < dim_33449; i_52500++) {\n                float eta_p_49741;\n                float eta_p_49742;\n                bool zg_res_49743;\n                \n                eta_p_49741 = ((__global float *) xys_mem_52568)[slice_52163 * dim_33449 + i_52500];\n                eta_p_49742 = ((__global float *) xys_mem_52568)[gtid_49714 * dim_33449 + i_52500];\n                zg_res_49743 = eta_p_49742 < eta_p_49741;\n                ((__global bool *) color_52937)[ctx_52974 + i_52500 * ctx_52975] = zg_res_49743;\n            }\n            acc_49746 = 0;\n            for (int64_t i_49745 = 0; i_49745 < dim_33449; i_49745++) {\n                bool b_49747;\n                bool defunc_0_f_res_49748;\n                bool acc_tmp_53275", ";\n                \n                b_49747 = ((__global bool *) color_52937)[ctx_52974 + i_49745 * ctx_52975];\n                defunc_0_f_res_49748 = acc_49746 || b_49747;\n                acc_tmp_53275 = defunc_0_f_res_49748;\n                acc_49746 = acc_tmp_53275;\n            }\n            defunc_0_foldl_res_49744 = acc_49746;\n            defunc_0_sm_red_res_49739 = defunc_0_foldl_res_49744;\n        } else {\n            defunc_0_sm_red_res_49739 = defunc_0_reduce_res_49749;\n        }\n        lifted_lambda_res_49737 = defunc_0_sm_red_res_49739;\n    } else {\n        lifted_lambda_res_49737 = 0;\n    }\n    ((__local bool *) red_arr_mem_53268)[gtid_49714] = lifted_lambda_res_49737;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53277 = 1;\n    offset_53276 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53259, sext_i64_i32(dz2082U_33453))) {\n            eta_p_49716 = ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n        }\n    }\n    offset_53276 = 1;\n    while (slt32(offset_53276, wave_sizze_53261)) {\n        if (slt32(local_tid_53259 + offset_53276, sext_i64_i32(dz2082U_33453)) && ((local_tid_53259 - squot32(local_tid_53259, wave_sizze_53261) * wave_sizze_53261) & (2 * offset_53276 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_49717 = ((volatile __local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_49718 = eta_p_49716 || eta_p_49717;\n                \n                eta_p_49716 = defunc_0_op_res_49718;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259)] = eta_p_49716;\n            }\n        }\n        offset_53276 *= 2;\n    }\n    while (slt32(skip_waves_53277, squot32(sext_i64_i32(dz2082U_33453) + wave_sizze_5", "3261 - 1, wave_sizze_53261))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53276 = skip_waves_53277 * wave_sizze_53261;\n        if (slt32(local_tid_53259 + offset_53276, sext_i64_i32(dz2082U_33453)) && ((local_tid_53259 - squot32(local_tid_53259, wave_sizze_53261) * wave_sizze_53261) == 0 && (squot32(local_tid_53259, wave_sizze_53261) & (2 * skip_waves_53277 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_49717 = ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_49718 = eta_p_49716 || eta_p_49717;\n                \n                eta_p_49716 = defunc_0_op_res_49718;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259)] = eta_p_49716;\n            }\n        }\n        skip_waves_53277 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // Save result of reduction.\n    {\n        defunc_0_reduce_res_49713 = ((__local bool *) red_arr_mem_53268)[(int64_t) 0];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (defunc_0_reduce_res_49713) {\n        lifted_lambda_res_49756 = (int64_t) -1;\n    } else {\n        lifted_lambda_res_49756 = slice_52163;\n    }\n    if (local_tid_53259 == 0) {\n        ((__global int64_t *) mem_52571)[inf_33494 + gtid_49708] = lifted_lambda_res_49756;\n    }\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegred_large_49831_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegred_large_49831(__global int *global_failure, int64_t dim_33449, int64_t dz2082U_33453, int64_t inf_33494, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, unsigned char cond_46544_bits, int64_t num_tblocks_49826, unsigned char x_52545_bits, int64_t num_threads_52979, int64_t blocks_per_segment_53313, int64_t q_53314, ",
                                    "int64_t num_virtblocks_53315, int64_t threads_per_segment_53316, __global unsigned char *mem_52585, __global unsigned char *mem_52601, __global unsigned char *color_52938, __global unsigned char *segred_tmp_mem_53317, __global unsigned char *counters_mem_53319)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    \n    #define segred_tblock_sizze_49825 (calc_global_Skyline_9665zisegred_large_49831zisegred_tblock_sizze_49825)\n    #define chunk_sizze_53278 (calc_global_Skyline_9665zisegred_large_49831zichunk_sizze_53278)\n    \n    volatile __local unsigned char *sync_arr_mem_53348_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53348_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_53346_backing_0 = &shared_mem[sync_arr_mem_53348_backing_1_offset];\n    const int64_t red_arr_bool_mem_53346_backing_0_offset = sync_arr_mem_53348_backing_1_offset + (segred_tblock_sizze_49825 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_49825, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53342;\n    int32_t tblock_sizze_53345;\n    int32_t wave_sizze_53344;\n    int32_t block_id_53343;\n    int32_t global_tid_53341;\n    int64_t phys_tid_49831;\n    __local unsigned char *red_arr_bool_mem_53346;\n    __local unsigned char *sync_arr_mem_53348;\n    int32_t phys_tblock_id_53350;\n    int32_t iterations_53351;\n    \n    local_tid_53342 = get_local_id(0);\n    tblock_sizze_53345 = get_local_size(0);\n    wave_sizze_53344 = LOCKSTEP_WIDTH;\n    block_id_53343 = get_tblock_id(0);\n    global_tid_53341 = block_id_53343 * tblock_sizze_53345 + local_tid_53342;\n    phys_tid_49831 = sext_i32_i64(global_tid_53341);\n    red_arr_bool_mem_53346 = (__local unsigned char *) red_arr_bool_mem_53346_backing_0;\n    sync_arr_mem_53348 = (__local unsigned char *) sync_arr_mem_53348_backing_1;\n    phys_tblock_id_53350 = get_tblock_id(0);\n    iterations_53351 = sdiv_up32(sext_i64_i32(num_virtblocks_", "53315) - phys_tblock_id_53350, sext_i64_i32(num_tblocks_49826));\n    for (int32_t i_53352 = 0; i_53352 < iterations_53351; i_53352++) {\n        int32_t virt_tblock_id_53353;\n        int64_t flat_segment_id_53354;\n        int64_t global_tid_53355;\n        int64_t slice_53356;\n        int64_t gtid_49829;\n        int64_t remnant_53357;\n        int64_t gtid_49830;\n        bool eta_p_block_res_acc_53358;\n        bool eta_p_49832;\n        bool eta_p_49833;\n        int64_t tblock_id_in_segment_53362;\n        int64_t block_base_offset_53363;\n        int32_t offset_53372;\n        int32_t skip_waves_53373;\n        bool eta_p_53359;\n        bool eta_p_53360;\n        \n        virt_tblock_id_53353 = phys_tblock_id_53350 + i_53352 * sext_i64_i32(num_tblocks_49826);\n        flat_segment_id_53354 = squot64(sext_i32_i64(virt_tblock_id_53353), blocks_per_segment_53313);\n        global_tid_53355 = srem64(sext_i32_i64(virt_tblock_id_53353) * segred_tblock_sizze_49825 + sext_i32_i64(local_tid_53342), threads_per_segment_53316);\n        slice_53356 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n        gtid_49829 = flat_segment_id_53354;\n        remnant_53357 = flat_segment_id_53354 - gtid_49829;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_53358 = 0;\n        }\n        tblock_id_in_segment_53362 = squot64(global_tid_53355, segred_tblock_sizze_49825);\n        block_base_offset_53363 = tblock_id_in_segment_53362 * q_53314 * segred_tblock_sizze_49825;\n        for (int64_t i_53364 = 0; i_53364 < q_53314; i_53364++) {\n            int64_t block_offset_53365 = block_base_offset_53363 + i_53364 * segred_tblock_sizze_49825;\n            \n            gtid_49830 = global_tid_53355 + threads_per_segment_53316 * i_53364;\n            if (slt64(gtid_49830, dz2082U_33453)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_52166 = inf_33494", " + gtid_49829;\n                        bool defunc_0_reduce_res_49847;\n                        \n                        if (x_52545) {\n                            bool x_52862;\n                            bool redout_52508 = 1;\n                            \n                            for (int64_t i_52509 = 0; i_52509 < dim_33449; i_52509++) {\n                                float eta_p_49848 = ((__global float *) mem_52585)[slice_52166 + i_52509 * dz2082U_33453];\n                                float eta_p_49849 = ((__global float *) mem_52585)[gtid_49830 + i_52509 * dz2082U_33453];\n                                bool zgze_res_49850 = eta_p_49849 <= eta_p_49848;\n                                bool x_49853 = zgze_res_49850 && redout_52508;\n                                bool redout_tmp_53366 = x_49853;\n                                \n                                redout_52508 = redout_tmp_53366;\n                            }\n                            x_52862 = redout_52508;\n                            defunc_0_reduce_res_49847 = x_52862;\n                        } else {\n                            defunc_0_reduce_res_49847 = 0;\n                        }\n                        \n                        bool defunc_0_sm_red_res_49837;\n                        \n                        if (cond_46544) {\n                            for (int64_t i_52506 = 0; i_52506 < dim_33449; i_52506++) {\n                                float eta_p_49839 = ((__global float *) mem_52585)[slice_52166 + i_52506 * dz2082U_33453];\n                                float eta_p_49840 = ((__global float *) mem_52585)[gtid_49830 + i_52506 * dz2082U_33453];\n                                bool zgze_res_49841 = eta_p_49840 <= eta_p_49839;\n                                \n                                ((__global bool *) color_52938)[phys_tid_49831 + i_52506 * num_threads_52979] = zgze_res_49841;\n                            }\n                            \n                            bool defun",
                                    "c_0_foldl_res_49842;\n                            bool acc_49844 = 1;\n                            \n                            for (int64_t i_49843 = 0; i_49843 < dim_33449; i_49843++) {\n                                bool b_49845 = ((__global bool *) color_52938)[phys_tid_49831 + i_49843 * num_threads_52979];\n                                bool x_49846 = acc_49844 && b_49845;\n                                bool acc_tmp_53368 = x_49846;\n                                \n                                acc_49844 = acc_tmp_53368;\n                            }\n                            defunc_0_foldl_res_49842 = acc_49844;\n                            defunc_0_sm_red_res_49837 = defunc_0_foldl_res_49842;\n                        } else {\n                            defunc_0_sm_red_res_49837 = defunc_0_reduce_res_49847;\n                        }\n                        \n                        bool lifted_lambda_res_49854;\n                        \n                        if (defunc_0_sm_red_res_49837) {\n                            bool defunc_0_sm_red_res_49856;\n                            \n                            if (cond_46544) {\n                                for (int64_t i_52512 = 0; i_52512 < dim_33449; i_52512++) {\n                                    float eta_p_49858 = ((__global float *) mem_52585)[slice_52166 + i_52512 * dz2082U_33453];\n                                    float eta_p_49859 = ((__global float *) mem_52585)[gtid_49830 + i_52512 * dz2082U_33453];\n                                    bool zg_res_49860 = eta_p_49859 < eta_p_49858;\n                                    \n                                    ((__global bool *) color_52938)[phys_tid_49831 + i_52512 * num_threads_52979] = zg_res_49860;\n                                }\n                                \n                                bool defunc_0_foldl_res_49861;\n                                bool acc_49863 = 0;\n                                \n                                for (in", "t64_t i_49862 = 0; i_49862 < dim_33449; i_49862++) {\n                                    bool b_49864 = ((__global bool *) color_52938)[phys_tid_49831 + i_49862 * num_threads_52979];\n                                    bool defunc_0_f_res_49865 = acc_49863 || b_49864;\n                                    bool acc_tmp_53370 = defunc_0_f_res_49865;\n                                    \n                                    acc_49863 = acc_tmp_53370;\n                                }\n                                defunc_0_foldl_res_49861 = acc_49863;\n                                defunc_0_sm_red_res_49856 = defunc_0_foldl_res_49861;\n                            } else {\n                                bool defunc_0_reduce_res_49866;\n                                bool redout_52514 = 0;\n                                \n                                for (int64_t i_52515 = 0; i_52515 < dim_33449; i_52515++) {\n                                    float eta_p_49867 = ((__global float *) mem_52585)[slice_52166 + i_52515 * dz2082U_33453];\n                                    float eta_p_49868 = ((__global float *) mem_52585)[gtid_49830 + i_52515 * dz2082U_33453];\n                                    bool zg_res_49869 = eta_p_49868 < eta_p_49867;\n                                    bool defunc_0_op_res_49872 = zg_res_49869 || redout_52514;\n                                    bool redout_tmp_53371 = defunc_0_op_res_49872;\n                                    \n                                    redout_52514 = redout_tmp_53371;\n                                }\n                                defunc_0_reduce_res_49866 = redout_52514;\n                                defunc_0_sm_red_res_49856 = defunc_0_reduce_res_49866;\n                            }\n                            lifted_lambda_res_49854 = defunc_0_sm_red_res_49856;\n                        } else {\n                            lifted_lambda_res_49854 = 0;\n                        }\n                        // load accumul", "ator(s)\n                        {\n                            eta_p_49832 = eta_p_block_res_acc_53358;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_49833 = lifted_lambda_res_49854;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            bool defunc_0_op_res_49834 = eta_p_49832 || eta_p_49833;\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_53358 = defunc_0_op_res_49834;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_block_res_acc_53358;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_53373 = 1;\n        offset_53372 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_53342, sext_i64_i32(segred_tblock_sizze_49825))) {\n                eta_p_53359 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n            }\n        }\n        offset_53372 = 1;\n        while (slt32(offset_53372, wave_sizze_53344)) {\n            if (slt32(local_tid_53342 + offset_53372, sext_i64_i32(segred_tblock_sizze_49825)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) & (2 * offset_53372 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_53360 = ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n                }\n                // apply reduction operation\n                {\n                    ",
                                    "bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                    \n                    eta_p_53359 = defunc_0_op_res_53361;\n                }\n                // write result of operation\n                {\n                    ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                }\n            }\n            offset_53372 *= 2;\n        }\n        while (slt32(skip_waves_53373, squot32(sext_i64_i32(segred_tblock_sizze_49825) + wave_sizze_53344 - 1, wave_sizze_53344))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_53372 = skip_waves_53373 * wave_sizze_53344;\n            if (slt32(local_tid_53342 + offset_53372, sext_i64_i32(segred_tblock_sizze_49825)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) == 0 && (squot32(local_tid_53342, wave_sizze_53344) & (2 * skip_waves_53373 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_53360 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                    \n                    eta_p_53359 = defunc_0_op_res_53361;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                }\n            }\n            skip_waves_53373 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_53342) == (int64_t) 0) {\n                eta_p_block_res_acc_53358 = eta_p_53359;\n            } else {\n                eta_p_block_res_acc_53358 = 0;\n            }\n        }\n        if (blocks_per_segment_53313 == ", "(int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_53342 == 0) {\n                    ((__global bool *) mem_52601)[gtid_49829] = eta_p_block_res_acc_53358;\n                }\n            }\n        } else {\n            int32_t old_counter_53374;\n            bool is_last_block_53375;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_53342 == 0) {\n                    ((__global bool *) segred_tmp_mem_53317)[sext_i32_i64(virt_tblock_id_53353)] = eta_p_block_res_acc_53358;\n                    mem_fence_global();\n                    old_counter_53374 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53319)[srem64(flat_segment_id_53354, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_53348)[(int64_t) 0] = old_counter_53374 == sext_i64_i32(blocks_per_segment_53313 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_53375 = ((__local bool *) sync_arr_mem_53348)[(int64_t) 0];\n            if (is_last_block_53375) {\n                if (local_tid_53342 == 0) {\n                    old_counter_53374 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53319)[srem64(flat_segment_id_53354, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_53313));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_53376 = sdiv_up64(blocks_per_segment_53313, segred_tblock_sizze_49825);\n                    \n                    eta_p_49832 = 0;\n                    for (int64_t i_53377 = 0; i_53377 < read_per_thread_53376; i_53377++) {\n                        int64_t block_res_id_53378 = sext_i32_i64(local_tid_53342) * read_per_thread_53376 + i_53377;\n                        int64_t index_of_block_res_53379 = fla", "t_segment_id_53354 * blocks_per_segment_53313 + block_res_id_53378;\n                        \n                        if (slt64(block_res_id_53378, blocks_per_segment_53313)) {\n                            eta_p_49833 = ((__global bool *) segred_tmp_mem_53317)[index_of_block_res_53379];\n                            \n                            bool defunc_0_op_res_49834 = eta_p_49832 || eta_p_49833;\n                            \n                            eta_p_49832 = defunc_0_op_res_49834;\n                        }\n                    }\n                }\n                ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_49832;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_53380;\n                    int32_t skip_waves_53381 = 1;\n                    bool eta_p_53359;\n                    bool eta_p_53360;\n                    \n                    offset_53380 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_53342, sext_i64_i32(segred_tblock_sizze_49825))) {\n                            eta_p_53359 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                        }\n                    }\n                    offset_53380 = 1;\n                    while (slt32(offset_53380, wave_sizze_53344)) {\n                        if (slt32(local_tid_53342 + offset_53380, sext_i64_i32(segred_tblock_sizze_49825)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) & (2 * offset_53380 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_53360 = ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                            }\n                            // apply reducti",
                                    "on operation\n                            {\n                                bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                                \n                                eta_p_53359 = defunc_0_op_res_53361;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                            }\n                        }\n                        offset_53380 *= 2;\n                    }\n                    while (slt32(skip_waves_53381, squot32(sext_i64_i32(segred_tblock_sizze_49825) + wave_sizze_53344 - 1, wave_sizze_53344))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_53380 = skip_waves_53381 * wave_sizze_53344;\n                        if (slt32(local_tid_53342 + offset_53380, sext_i64_i32(segred_tblock_sizze_49825)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) == 0 && (squot32(local_tid_53342, wave_sizze_53344) & (2 * skip_waves_53381 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_53360 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                                \n                                eta_p_53359 = defunc_0_op_res_53361;\n                            }\n                            // write result of operation\n                            {\n                                ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                            }\n                        }\n                        ", "skip_waves_53381 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_53342 == 0) {\n                            ((__global bool *) mem_52601)[gtid_49829] = eta_p_53359;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_49825\n    #undef chunk_sizze_53278\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegred_small_49831_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegred_small_49831(__global int *global_failure, int64_t dim_33449, int64_t dz2082U_33453, int64_t inf_33494, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, unsigned char cond_46544_bits, int64_t num_tblocks_49826, unsigned char x_52545_bits, int64_t num_threads_52979, int64_t segment_sizze_nonzzero_53279, __global unsigned char *mem_52585, __global unsigned char *mem_52601, __global unsigned char *color_52938)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    \n    #define segred_tblock_sizze_49825 (calc_global_Skyline_9665zisegred_small_49831zisegred_tblock_sizze_49825)\n    \n    volatile __local unsigned char *red_arr_bool_mem_53286_backing_0 = &shared_mem[0];\n    const int64_t red_arr_bool_mem_53286_backing_0_offset = 0 + (segred_tblock_sizze_49825 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_49825, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53282;\n    int32_t tblock_sizze_53285;\n    int32_t wave_sizze_53284;\n    int32_t block_id_53283;\n    int32_t global_tid_53281;\n    int64_t phys_tid_49831;\n    __local unsigned char *red_arr_bool_mem_53286;\n    int32_t phys_tblock_id_53288;\n    int32_t iterations_53289;\n    \n    local_tid_53282 = get_local_id(0);\n    tblock_sizze_53285 = get_local_size(0);\n    wav", "e_sizze_53284 = LOCKSTEP_WIDTH;\n    block_id_53283 = get_tblock_id(0);\n    global_tid_53281 = block_id_53283 * tblock_sizze_53285 + local_tid_53282;\n    phys_tid_49831 = sext_i32_i64(global_tid_53281);\n    red_arr_bool_mem_53286 = (__local unsigned char *) red_arr_bool_mem_53286_backing_0;\n    phys_tblock_id_53288 = get_tblock_id(0);\n    iterations_53289 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279))) - phys_tblock_id_53288, sext_i64_i32(num_tblocks_49826));\n    for (int32_t i_53290 = 0; i_53290 < iterations_53289; i_53290++) {\n        int32_t virt_tblock_id_53291;\n        int64_t slice_53292;\n        int64_t gtid_49829;\n        int64_t remnant_53293;\n        int64_t gtid_49830;\n        \n        virt_tblock_id_53291 = phys_tblock_id_53288 + i_53290 * sext_i64_i32(num_tblocks_49826);\n        slice_53292 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;\n        gtid_49829 = squot64(sext_i32_i64(local_tid_53282), segment_sizze_nonzzero_53279) + sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279);\n        remnant_53293 = squot64(sext_i32_i64(local_tid_53282), segment_sizze_nonzzero_53279) + sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279) - gtid_49829;\n        gtid_49830 = srem64(sext_i32_i64(local_tid_53282), dz2082U_33453);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, dz2082U_33453) && (slt64(gtid_49829, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500) && slt64(sext_i32_i64(local_tid_53282), dz2082U_33453 * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279)))) {\n                // apply map function\n                {\n                    int64_t slice_52166 = inf_33494 + gtid_49829;\n                    bool defunc_0_reduce_res_49847;\n                    \n                    if (x_52545) {\n                        bool x_52862;\n       ",
                                    "                 bool redout_52508 = 1;\n                        \n                        for (int64_t i_52509 = 0; i_52509 < dim_33449; i_52509++) {\n                            float eta_p_49848 = ((__global float *) mem_52585)[slice_52166 + i_52509 * dz2082U_33453];\n                            float eta_p_49849 = ((__global float *) mem_52585)[gtid_49830 + i_52509 * dz2082U_33453];\n                            bool zgze_res_49850 = eta_p_49849 <= eta_p_49848;\n                            bool x_49853 = zgze_res_49850 && redout_52508;\n                            bool redout_tmp_53294 = x_49853;\n                            \n                            redout_52508 = redout_tmp_53294;\n                        }\n                        x_52862 = redout_52508;\n                        defunc_0_reduce_res_49847 = x_52862;\n                    } else {\n                        defunc_0_reduce_res_49847 = 0;\n                    }\n                    \n                    bool defunc_0_sm_red_res_49837;\n                    \n                    if (cond_46544) {\n                        for (int64_t i_52506 = 0; i_52506 < dim_33449; i_52506++) {\n                            float eta_p_49839 = ((__global float *) mem_52585)[slice_52166 + i_52506 * dz2082U_33453];\n                            float eta_p_49840 = ((__global float *) mem_52585)[gtid_49830 + i_52506 * dz2082U_33453];\n                            bool zgze_res_49841 = eta_p_49840 <= eta_p_49839;\n                            \n                            ((__global bool *) color_52938)[phys_tid_49831 + i_52506 * num_threads_52979] = zgze_res_49841;\n                        }\n                        \n                        bool defunc_0_foldl_res_49842;\n                        bool acc_49844 = 1;\n                        \n                        for (int64_t i_49843 = 0; i_49843 < dim_33449; i_49843++) {\n                            bool b_49845 = ((__global bool *) color_52938)[phys_tid_49831 + i_49843 * num_threads_52979];\n    ", "                        bool x_49846 = acc_49844 && b_49845;\n                            bool acc_tmp_53296 = x_49846;\n                            \n                            acc_49844 = acc_tmp_53296;\n                        }\n                        defunc_0_foldl_res_49842 = acc_49844;\n                        defunc_0_sm_red_res_49837 = defunc_0_foldl_res_49842;\n                    } else {\n                        defunc_0_sm_red_res_49837 = defunc_0_reduce_res_49847;\n                    }\n                    \n                    bool lifted_lambda_res_49854;\n                    \n                    if (defunc_0_sm_red_res_49837) {\n                        bool defunc_0_sm_red_res_49856;\n                        \n                        if (cond_46544) {\n                            for (int64_t i_52512 = 0; i_52512 < dim_33449; i_52512++) {\n                                float eta_p_49858 = ((__global float *) mem_52585)[slice_52166 + i_52512 * dz2082U_33453];\n                                float eta_p_49859 = ((__global float *) mem_52585)[gtid_49830 + i_52512 * dz2082U_33453];\n                                bool zg_res_49860 = eta_p_49859 < eta_p_49858;\n                                \n                                ((__global bool *) color_52938)[phys_tid_49831 + i_52512 * num_threads_52979] = zg_res_49860;\n                            }\n                            \n                            bool defunc_0_foldl_res_49861;\n                            bool acc_49863 = 0;\n                            \n                            for (int64_t i_49862 = 0; i_49862 < dim_33449; i_49862++) {\n                                bool b_49864 = ((__global bool *) color_52938)[phys_tid_49831 + i_49862 * num_threads_52979];\n                                bool defunc_0_f_res_49865 = acc_49863 || b_49864;\n                                bool acc_tmp_53298 = defunc_0_f_res_49865;\n                                \n                                acc_49863 = acc_tmp_53298;\n    ", "                        }\n                            defunc_0_foldl_res_49861 = acc_49863;\n                            defunc_0_sm_red_res_49856 = defunc_0_foldl_res_49861;\n                        } else {\n                            bool defunc_0_reduce_res_49866;\n                            bool redout_52514 = 0;\n                            \n                            for (int64_t i_52515 = 0; i_52515 < dim_33449; i_52515++) {\n                                float eta_p_49867 = ((__global float *) mem_52585)[slice_52166 + i_52515 * dz2082U_33453];\n                                float eta_p_49868 = ((__global float *) mem_52585)[gtid_49830 + i_52515 * dz2082U_33453];\n                                bool zg_res_49869 = eta_p_49868 < eta_p_49867;\n                                bool defunc_0_op_res_49872 = zg_res_49869 || redout_52514;\n                                bool redout_tmp_53299 = defunc_0_op_res_49872;\n                                \n                                redout_52514 = redout_tmp_53299;\n                            }\n                            defunc_0_reduce_res_49866 = redout_52514;\n                            defunc_0_sm_red_res_49856 = defunc_0_reduce_res_49866;\n                        }\n                        lifted_lambda_res_49854 = defunc_0_sm_red_res_49856;\n                    } else {\n                        lifted_lambda_res_49854 = 0;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = lifted_lambda_res_49854;\n                    }\n                }\n            } else {\n                ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, dz2082U_33453)) {\n            // perform segmented scan to imitate reduction\n            {\n                bool eta_p_49832;\n              ",
                                    "  bool eta_p_49833;\n                bool eta_p_53300;\n                bool eta_p_53301;\n                bool ltid_in_bounds_53303 = slt64(sext_i32_i64(local_tid_53282), dz2082U_33453 * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279));\n                int32_t skip_threads_53304;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_53303) {\n                        eta_p_49833 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)];\n                        if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 0) {\n                            eta_p_49832 = eta_p_49833;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53304 = 1;\n                    while (slt32(skip_threads_53304, 32)) {\n                        bool thread_active_53305 = sle32(skip_threads_53304, local_tid_53282 - squot32(local_tid_53282, 32) * 32) && ltid_in_bounds_53303;\n                        \n                        if (thread_active_53305) {\n                            // read operands\n                            {\n                                eta_p_49832 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282) - sext_i32_i64(skip_threads_53304)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_53306 = slt64(srem64(sext_i32_i64(local_tid_53282), dz2082U_33453), sext_i32_i64(local_tid_53282) - sext_i32_i64(local_tid_53282 - skip_threads_53304));\n                            \n                            if (thread_active_53305 && inactive_53306) {\n                                eta_p_49832 = eta_p_49833;\n                            }\n                            if (thread_active_53305) {\n                 ", "               if (!inactive_53306) {\n                                    bool defunc_0_op_res_49834 = eta_p_49832 || eta_p_49833;\n                                    \n                                    eta_p_49832 = defunc_0_op_res_49834;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_53284, skip_threads_53304)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53305) {\n                            // write result\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_49832;\n                                eta_p_49833 = eta_p_49832;\n                            }\n                        }\n                        if (sle32(wave_sizze_53284, skip_threads_53304)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53304 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 31 && ltid_in_bounds_53303) {\n                        ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(squot32(local_tid_53282, 32))] = eta_p_49832;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_53307;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303) {\n                            eta_p_53301 = ((volatile __local bool *) red_a", "rr_bool_mem_53286)[sext_i32_i64(local_tid_53282)];\n                            if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 0) {\n                                eta_p_53300 = eta_p_53301;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_53307 = 1;\n                        while (slt32(skip_threads_53307, 32)) {\n                            bool thread_active_53308 = sle32(skip_threads_53307, local_tid_53282 - squot32(local_tid_53282, 32) * 32) && (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303);\n                            \n                            if (thread_active_53308) {\n                                // read operands\n                                {\n                                    eta_p_53300 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282) - sext_i32_i64(skip_threads_53307)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_53309 = slt64(srem64(sext_i32_i64(local_tid_53282 * 32 + 32 - 1), dz2082U_33453), sext_i32_i64(local_tid_53282 * 32 + 32 - 1) - sext_i32_i64((local_tid_53282 - skip_threads_53307) * 32 + 32 - 1));\n                                \n                                if (thread_active_53308 && inactive_53309) {\n                                    eta_p_53300 = eta_p_53301;\n                                }\n                                if (thread_active_53308) {\n                                    if (!inactive_53309) {\n                                        bool defunc_0_op_res_53302 = eta_p_53300 || eta_p_53301;\n                                        \n                                        eta_p_53300 = defunc_0_op_res_53302;\n                                    }\n                   ",
                                    "             }\n                            }\n                            if (sle32(wave_sizze_53284, skip_threads_53307)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_53308) {\n                                // write result\n                                {\n                                    ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_53300;\n                                    eta_p_53301 = eta_p_53300;\n                                }\n                            }\n                            if (sle32(wave_sizze_53284, skip_threads_53307)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_53307 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_53310 = squot32(local_tid_53282, 32) == 0 || !ltid_in_bounds_53303;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_53310) {\n                            eta_p_49833 = eta_p_49832;\n                            eta_p_49832 = ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(squot32(local_tid_53282, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_53311 = slt64(srem64(sext_i32_i64(local_tid_53282), dz2082U_33453), sext_i32_i64(local_tid_53282) - sext_i32_i64(squot32(local_tid_53282, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_53310) {\n                            if (inactive_53311) {\n                                eta_p_49832 = eta_p_49833;\n                            }\n             ", "           }\n                        if (!no_carry_in_53310) {\n                            if (!inactive_53311) {\n                                bool defunc_0_op_res_49834 = eta_p_49832 || eta_p_49833;\n                                \n                                eta_p_49832 = defunc_0_op_res_49834;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_53310) {\n                            ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_49832;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303) {\n                        ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_49833;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279) + sext_i32_i64(local_tid_53282), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500) && slt64(sext_i32_i64(local_tid_53282), squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279))) {\n                bool tmp_53312 = ((__local bool *) red_arr_bool_mem_53286)[(sext_i32_i64(local_tid_53282) + (int64_t) 1) * segment_sizze_nonzzero_53279 - (int64_t) 1];\n                \n                ((__global bool *) mem_52601)[sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279) + sext_i32_i64(local_tid_53282)] = tmp_53312;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FE", "NCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_49825\n}\nFUTHARK_KERNEL_SIZED(calc_global_Skyline_9665zisegscan_49891_dim1, 1, 1)\nvoid calc_global_Skyline_9665zisegscan_49891(__global int *global_failure, int64_t dz2082U_33453, int64_t num_tblocks_49888, int64_t num_virt_blocks_53399, int64_t num_virt_threads_53400, __global unsigned char *mem_52571, __global unsigned char *mem_52657, __global unsigned char *mem_52659, __global unsigned char *status_flags_mem_53401, __global unsigned char *aggregates_mem_53423, __global unsigned char *incprefixes_mem_53425, __global unsigned char *global_dynid_mem_53427)\n{\n    #define segscan_tblock_sizze_49886 (calc_global_Skyline_9665zisegscan_49891zisegscan_tblock_sizze_49886)\n    #define chunk_sizze_53398 (calc_global_Skyline_9665zisegscan_49891zichunk_sizze_53398)\n    \n    volatile __local unsigned char *local_mem_53437_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53437_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_49886), chunk_sizze_53398 * segscan_tblock_sizze_49886 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_49886), chunk_sizze_53398 * segscan_tblock_sizze_49886 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53430;\n    int32_t tblock_sizze_53433;\n    int32_t wave_sizze_53432;\n    int32_t block_id_53431;\n    int32_t global_tid_53429;\n    int64_t phys_tid_49891;\n    int32_t chunk_sizze_32b_53434;\n    int64_t byte_offsets_53435;\n    int64_t warp_byte_offset_53436;\n    __local unsigned char *local_mem_53437;\n    int64_t trans_arr_len_53438;\n    int64_t phys_block_id_53444;\n    int64_t virtloop_bound_53445;\n    \n    local_tid_53430 = get_local_id(0);\n    tblock_sizze_53433 = get_local_size(0);\n    wave_sizze_53432 = LOCKSTEP_WIDTH;\n    block_id_53431 = get_tblock_id(0);\n    global_tid_53429 = block_id_53431 * tblock_",
                                    "sizze_53433 + local_tid_53430;\n    phys_tid_49891 = sext_i32_i64(global_tid_53429);\n    chunk_sizze_32b_53434 = sext_i64_i32(chunk_sizze_53398);\n    byte_offsets_53435 = segscan_tblock_sizze_49886 * (int64_t) 8;\n    warp_byte_offset_53436 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53437 = (__local unsigned char *) local_mem_53437_backing_0;\n    trans_arr_len_53438 = chunk_sizze_53398 * segscan_tblock_sizze_49886;\n    phys_block_id_53444 = get_tblock_id(0);\n    virtloop_bound_53445 = sdiv_up64(num_virt_blocks_53399 - phys_block_id_53444, num_tblocks_49888);\n    for (int64_t virtloop_i_53446 = 0; virtloop_i_53446 < virtloop_bound_53445; virtloop_i_53446++) {\n        int64_t dynamic_id_53447;\n        int64_t block_offset_53448;\n        int64_t sgm_idx_53449;\n        int32_t boundary_53450;\n        int32_t segsizze_compact_53451;\n        int64_t private_mem_53452[chunk_sizze_53398];\n        int64_t thd_offset_53454;\n        int64_t acc_53470;\n        int64_t prefix_53480;\n        bool block_new_sgm_53481;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53430 == 0) {\n                dynamic_id_53447 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53427)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53437)[(int64_t) 0] = dynamic_id_53447;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53447 == num_virt_blocks_53399 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53427)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53447 = ((__local int32_t *) local_mem_53437)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53448", " = dynamic_id_53447 * chunk_sizze_53398 * segscan_tblock_sizze_49886;\n        sgm_idx_53449 = smod64(block_offset_53448, dz2082U_33453);\n        boundary_53450 = sext_i64_i32(smin64(chunk_sizze_53398 * segscan_tblock_sizze_49886, dz2082U_33453 - sgm_idx_53449));\n        segsizze_compact_53451 = sext_i64_i32(smin64(chunk_sizze_53398 * segscan_tblock_sizze_49886, dz2082U_33453));\n        thd_offset_53454 = block_offset_53448 + sext_i32_i64(local_tid_53430);\n        // Load and map\n        {\n            for (int64_t i_53455 = 0; i_53455 < chunk_sizze_53398; i_53455++) {\n                int64_t virt_tid_53456 = thd_offset_53454 + i_53455 * segscan_tblock_sizze_49886;\n                int64_t slice_53457 = dz2082U_33453;\n                int64_t gtid_49890 = virt_tid_53456;\n                int64_t remnant_53458 = virt_tid_53456 - gtid_49890;\n                \n                if (slt64(virt_tid_53456, dz2082U_33453)) {\n                    int64_t eta_p_47807 = ((__global int64_t *) mem_52571)[gtid_49890];\n                    bool lifted_lambda_res_47808 = sle64((int64_t) 0, eta_p_47807);\n                    int64_t defunc_0_f_res_47809 = btoi_bool_i64(lifted_lambda_res_47808);\n                    \n                    ((__global int64_t *) mem_52659)[gtid_49890] = defunc_0_f_res_47809;\n                    private_mem_53452[i_53455] = defunc_0_f_res_47809;\n                } else {\n                    private_mem_53452[i_53455] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53459 = 0; i_53459 < chunk_sizze_53398; i_53459++) {\n                int64_t sharedIdx_53460 = sext_i32_i64(local_tid_53430) + i_53459 * segscan_tblock_sizze_49886;\n                int64_t tmp_53461 = private_mem_53452[i_53459];\n                \n                ((__local int64_t *) local_mem_53437)[sharedIdx_53460] = tmp_53461;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n         ", "   for (int64_t i_53462 = 0; i_53462 < chunk_sizze_53398; i_53462++) {\n                int64_t sharedIdx_53463 = sext_i32_i64(local_tid_53430) * chunk_sizze_53398 + i_53462;\n                int64_t tmp_53464 = ((__local int64_t *) local_mem_53437)[sharedIdx_53463];\n                \n                private_mem_53452[i_53462] = tmp_53464;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53465 = 0; i_53465 < chunk_sizze_53398 - (int64_t) 1; i_53465++) {\n                int64_t eta_p_45242;\n                int64_t eta_p_45243;\n                \n                eta_p_45242 = private_mem_53452[i_53465];\n                eta_p_45243 = private_mem_53452[i_53465 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_45244 = add64(eta_p_45242, eta_p_45243);\n                \n                private_mem_53452[i_53465 + (int64_t) 1] = defunc_0_op_res_45244;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53466 = private_mem_53452[chunk_sizze_53398 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = tmp_53466;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53467;\n            int64_t eta_p_53468;\n            int64_t eta_p_53471;\n            int64_t eta_p_53472;\n            bool ltid_in_bounds_53474 = slt64(sext_i32_i64(local_tid_53430), num_virt_threads_53400);\n            int32_t skip_threads_53475;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53474) {\n                    eta_p_53468 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                    if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                        eta_p_53467 = eta_p_53468;\n                    }\n             ",
                                    "   }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53475 = 1;\n                while (slt32(skip_threads_53475, 32)) {\n                    bool thread_active_53476 = sle32(skip_threads_53475, local_tid_53430 - squot32(local_tid_53430, 32) * 32) && ltid_in_bounds_53474;\n                    \n                    if (thread_active_53476) {\n                        // read operands\n                        {\n                            eta_p_53467 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53475)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53476) {\n                            int64_t defunc_0_op_res_53469 = add64(eta_p_53467, eta_p_53468);\n                            \n                            eta_p_53467 = defunc_0_op_res_53469;\n                        }\n                    }\n                    if (sle32(wave_sizze_53432, skip_threads_53475)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53476) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53467;\n                            eta_p_53468 = eta_p_53467;\n                        }\n                    }\n                    if (sle32(wave_sizze_53432, skip_threads_53475)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53475 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 31 && ltid_in_bounds_53474) {\n                    ((volatil", "e __local int64_t *) local_mem_53437)[sext_i32_i64(squot32(local_tid_53430, 32))] = eta_p_53467;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53477;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474) {\n                        eta_p_53472 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                        if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                            eta_p_53471 = eta_p_53472;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53477 = 1;\n                    while (slt32(skip_threads_53477, 32)) {\n                        bool thread_active_53478 = sle32(skip_threads_53477, local_tid_53430 - squot32(local_tid_53430, 32) * 32) && (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474);\n                        \n                        if (thread_active_53478) {\n                            // read operands\n                            {\n                                eta_p_53471 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53477)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53478) {\n                                int64_t defunc_0_op_res_53473 = add64(eta_p_53471, eta_p_53472);\n                                \n                                eta_p_53471 = defunc_0_op_res_53473;\n                            }\n                        }\n                        if (sle32(wave_sizze_53432, s", "kip_threads_53477)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53478) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53471;\n                                eta_p_53472 = eta_p_53471;\n                            }\n                        }\n                        if (sle32(wave_sizze_53432, skip_threads_53477)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53477 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53479 = squot32(local_tid_53430, 32) == 0 || !ltid_in_bounds_53474;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53479) {\n                        eta_p_53468 = eta_p_53467;\n                        eta_p_53467 = ((__local int64_t *) local_mem_53437)[sext_i32_i64(squot32(local_tid_53430, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53479) {\n                        int64_t defunc_0_op_res_53469 = add64(eta_p_53467, eta_p_53468);\n                        \n                        eta_p_53467 = defunc_0_op_res_53469;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53479) {\n                        ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53467;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if",
                                    " (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474) {\n                    ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53468;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53430 == 0) {\n                acc_53470 = ((__local int64_t *) local_mem_53437)[segscan_tblock_sizze_49886 - (int64_t) 1];\n            } else {\n                acc_53470 = ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53480 = (int64_t) 0;\n        block_new_sgm_53481 = sgm_idx_53449 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53481 && local_tid_53430 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447] = acc_53470;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 2;\n                acc_53470 = (int64_t) 0;\n            }\n            if (!block_new_sgm_53481 && slt32(local_tid_53430, wave_sizze_53432)) {\n                if (local_tid_53430 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53423)[dynamic_id_53447] = acc_53470;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 1;\n                    \n                    int8_t tmp_53482 = ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53437)[(int64_t) 0] = tmp_53482;\n                }\n                mem_fence_local();\n                \n                int8_t status_53483 = ((__local int8_t *) local_mem_53437)[(int64_t) 0];\n                \n                if (status_53483 == (int8_t) 2) {\n              ", "      if (local_tid_53430 == 0) {\n                        prefix_53480 = ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53484 = sext_i64_i32(dynamic_id_53447 - sext_i32_i64(wave_sizze_53432));\n                    \n                    while (slt32(wave_sizze_53432 * -1, readOffset_53484)) {\n                        int32_t read_i_53485 = readOffset_53484 + local_tid_53430;\n                        int64_t aggr_53486 = (int64_t) 0;\n                        int8_t flag_53487 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53485)) {\n                            flag_53487 = ((volatile __global int8_t *) status_flags_mem_53401)[sext_i32_i64(read_i_53485)];\n                            if (flag_53487 == (int8_t) 2) {\n                                aggr_53486 = ((volatile __global int64_t *) incprefixes_mem_53425)[sext_i32_i64(read_i_53485)];\n                            } else if (flag_53487 == (int8_t) 1) {\n                                aggr_53486 = ((volatile __global int64_t *) aggregates_mem_53423)[sext_i32_i64(read_i_53485)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53437)[(int64_t) 4 + sext_i32_i64(local_tid_53430)] = aggr_53486;\n                        ((__local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = flag_53487;\n                        flag_53487 = ((__local int8_t *) local_mem_53437)[sext_i32_i64(wave_sizze_53432) - (int64_t) 1];\n                        if (slt8(flag_53487, (int8_t) 2)) {\n                            int8_t flg_x_53491;\n                            int8_t flg_y_53492;\n                            int64_t eta_p_53488;\n                            int64_t eta_p_53489;\n                            int32_t skip_threads_53493;\n                            \n                            // read input for in-block sca", "n\n                            {\n                                flg_y_53492 = ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                                eta_p_53489 = ((volatile __local int64_t *) local_mem_53437)[(int64_t) 4 + sext_i32_i64(local_tid_53430)];\n                                if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                                    eta_p_53488 = eta_p_53489;\n                                    flg_x_53491 = flg_y_53492;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53493 = 1;\n                                while (slt32(skip_threads_53493, 32)) {\n                                    if (sle32(skip_threads_53493, local_tid_53430 - squot32(local_tid_53430, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53491 = ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53493)];\n                                            eta_p_53488 = ((volatile __local int64_t *) local_mem_53437)[(int64_t) 4 + (sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53493))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53492 == (int8_t) 2 || flg_y_53492 == (int8_t) 0) {\n                                                flg_x_53491 = flg_y_53492;\n                                                eta_p_53488 = eta_p_53489;\n                                            } else {\n                                                int64_t defunc_0_op_res_53490 = add64(eta_p_53488, eta_p_53489);\n                                    ",
                                    "            \n                                                eta_p_53488 = defunc_0_op_res_53490;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = flg_x_53491;\n                                            flg_y_53492 = flg_x_53491;\n                                            ((volatile __local int64_t *) local_mem_53437)[(int64_t) 4 + sext_i32_i64(local_tid_53430)] = eta_p_53488;\n                                            eta_p_53489 = eta_p_53488;\n                                        }\n                                    }\n                                    skip_threads_53493 *= 2;\n                                }\n                            }\n                        }\n                        flag_53487 = ((__local int8_t *) local_mem_53437)[sext_i32_i64(wave_sizze_53432) - (int64_t) 1];\n                        aggr_53486 = ((__local int64_t *) local_mem_53437)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53432) - (int64_t) 1)];\n                        if (flag_53487 == (int8_t) 2) {\n                            readOffset_53484 = wave_sizze_53432 * -1;\n                        } else if (flag_53487 == (int8_t) 1) {\n                            readOffset_53484 -= wave_sizze_53432;\n                        }\n                        if (slt8((int8_t) 0, flag_53487)) {\n                            int64_t eta_p_53494 = aggr_53486;\n                            int64_t eta_p_53495 = prefix_53480;\n                            int64_t defunc_0_op_res_53496 = add64(eta_p_53494, eta_p_53495);\n                            \n                            prefix_53480 = defunc_0_op_res_53496;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_534", "30 == 0) {\n                    if (boundary_53450 == sext_i64_i32(segscan_tblock_sizze_49886 * chunk_sizze_53398)) {\n                        int64_t eta_p_53497 = prefix_53480;\n                        int64_t eta_p_53498 = acc_53470;\n                        int64_t defunc_0_op_res_53499 = add64(eta_p_53497, eta_p_53498);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447] = defunc_0_op_res_53499;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53437)[(int64_t) 4] = prefix_53480;\n                    acc_53470 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_53447 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53480 = ((__local int64_t *) local_mem_53437)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53500;\n            int64_t eta_p_53501;\n            int64_t eta_p_53503 = prefix_53480;\n            int64_t eta_p_53504 = acc_53470;\n            \n            if (slt32(local_tid_53430 * chunk_sizze_32b_53434, boundary_53450) && !block_new_sgm_53481) {\n                int64_t defunc_0_op_res_53505 = add64(eta_p_53503, eta_p_53504);\n                \n                eta_p_53500 = defunc_0_op_res_53505;\n            } else {\n                eta_p_53500 = acc_53470;\n            }\n            \n            int32_t stopping_point_53506 = segsizze_compact_53451 - srem32(local_tid_53430 * chunk_sizze_32b_53434 - 1 + segsizze_compact_53451 - boundary_53450, segsizze_compact_53451);\n            \n            for (int64_t i_53507 = 0; i_53507 < chunk_sizze_53398; i_53507++) {\n                if (slt32(sext_i64_i32(i_53507), stopping_point_53506 - 1)) {\n                    et", "a_p_53501 = private_mem_53452[i_53507];\n                    \n                    int64_t defunc_0_op_res_53502 = add64(eta_p_53500, eta_p_53501);\n                    \n                    private_mem_53452[i_53507] = defunc_0_op_res_53502;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53508 = 0; i_53508 < chunk_sizze_53398; i_53508++) {\n                int64_t sharedIdx_53509 = sext_i32_i64(local_tid_53430) * chunk_sizze_53398 + i_53508;\n                int64_t tmp_53510 = private_mem_53452[i_53508];\n                \n                ((__local int64_t *) local_mem_53437)[sharedIdx_53509] = tmp_53510;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53511 = 0; i_53511 < chunk_sizze_53398; i_53511++) {\n                int64_t flat_idx_53512 = thd_offset_53454 + i_53511 * segscan_tblock_sizze_49886;\n                int64_t slice_53513 = dz2082U_33453;\n                int64_t gtid_49890 = flat_idx_53512;\n                int64_t remnant_53514 = flat_idx_53512 - gtid_49890;\n                \n                if (slt64(flat_idx_53512, dz2082U_33453)) {\n                    int64_t tmp_53515 = ((__local int64_t *) local_mem_53437)[flat_idx_53512 - block_offset_53448];\n                    \n                    ((__global int64_t *) mem_52657)[gtid_49890] = tmp_53515;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_49886\n    #undef chunk_sizze_53398\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50037_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50037(__global int *global_failure, int64_t dim_35535, int64_t dz2082U_35539, int64_t dz2082U_35541, int64_t inf_35587, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, unsigned char cond_46544_bits, unsigned char x_52545_bits, int64_t num_threads_52993, __global unsigned char *xys_mem_52",
                                    "568, __global unsigned char *mem_52574, __global unsigned char *mem_52647, __global unsigned char *color_52936)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    \n    #define segmap_tblock_sizze_50033 (filter_against_9751zisegmap_50037zisegmap_tblock_sizze_50033)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53242;\n    int32_t tblock_sizze_53245;\n    int32_t wave_sizze_53244;\n    int32_t block_id_53243;\n    int32_t global_tid_53241;\n    int64_t phys_tid_50037;\n    int64_t global_tid_53246;\n    int64_t slice_53247;\n    int64_t gtid_50036;\n    int64_t remnant_53248;\n    \n    local_tid_53242 = get_local_id(0);\n    tblock_sizze_53245 = get_local_size(0);\n    wave_sizze_53244 = LOCKSTEP_WIDTH;\n    block_id_53243 = get_tblock_id(0);\n    global_tid_53241 = block_id_53243 * tblock_sizze_53245 + local_tid_53242;\n    phys_tid_50037 = sext_i32_i64(global_tid_53241);\n    global_tid_53246 = sext_i32_i64(block_id_53243) * segmap_tblock_sizze_50033 + sext_i32_i64(local_tid_53242);\n    slice_53247 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n    gtid_50036 = global_tid_53246;\n    remnant_53248 = global_tid_53246 - gtid_50036;\n    if (slt64(gtid_50036, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593)) {\n        int64_t slice_52160;\n        bool defunc_0_reduce_res_50040;\n        bool redout_52478;\n        int64_t lifted_lambda_res_50081;\n        \n        slice_52160 = inf_35587 + gtid_50036;\n        redout_52478 = 0;\n        for (int64_t i_52479 = 0; i_52479 < dz2082U_35539; i_52479++) {\n            bool defunc_0_reduce_res_50052;\n            bool defunc_0_sm_red_res_50042;\n            bool lifted_lambda_res_50059;\n            bool defunc_0_op_res_50080;\n            bool redout_tmp_53249;\n            \n            if (x_52545) {\n                bool x_52835;\n                bool redout_52484 = 1;\n                \n                for (int64_t i_52485 = 0; i_52485 < dim_35535; i_52485++) {\n                    float eta_p_50053;\n             ", "       float eta_p_50054;\n                    bool zgze_res_50055;\n                    bool x_50058;\n                    bool redout_tmp_53250;\n                    \n                    eta_p_50053 = ((__global float *) mem_52647)[slice_52160 + i_52485 * dz2082U_35541];\n                    eta_p_50054 = ((__global float *) xys_mem_52568)[i_52479 * dim_35535 + i_52485];\n                    zgze_res_50055 = eta_p_50054 <= eta_p_50053;\n                    x_50058 = zgze_res_50055 && redout_52484;\n                    redout_tmp_53250 = x_50058;\n                    redout_52484 = redout_tmp_53250;\n                }\n                x_52835 = redout_52484;\n                defunc_0_reduce_res_50052 = x_52835;\n            } else {\n                defunc_0_reduce_res_50052 = 0;\n            }\n            if (cond_46544) {\n                bool defunc_0_foldl_res_50047;\n                bool acc_50049;\n                \n                for (int64_t i_52482 = 0; i_52482 < dim_35535; i_52482++) {\n                    float eta_p_50044;\n                    float eta_p_50045;\n                    bool zgze_res_50046;\n                    \n                    eta_p_50044 = ((__global float *) mem_52647)[slice_52160 + i_52482 * dz2082U_35541];\n                    eta_p_50045 = ((__global float *) xys_mem_52568)[i_52479 * dim_35535 + i_52482];\n                    zgze_res_50046 = eta_p_50045 <= eta_p_50044;\n                    ((__global bool *) color_52936)[phys_tid_50037 + i_52482 * num_threads_52993] = zgze_res_50046;\n                }\n                acc_50049 = 1;\n                for (int64_t i_50048 = 0; i_50048 < dim_35535; i_50048++) {\n                    bool b_50050;\n                    bool x_50051;\n                    bool acc_tmp_53252;\n                    \n                    b_50050 = ((__global bool *) color_52936)[phys_tid_50037 + i_50048 * num_threads_52993];\n                    x_50051 = acc_50049 && b_50050;\n                    acc_tmp_53252 = x_50051;\n                   ", " acc_50049 = acc_tmp_53252;\n                }\n                defunc_0_foldl_res_50047 = acc_50049;\n                defunc_0_sm_red_res_50042 = defunc_0_foldl_res_50047;\n            } else {\n                defunc_0_sm_red_res_50042 = defunc_0_reduce_res_50052;\n            }\n            if (defunc_0_sm_red_res_50042) {\n                bool defunc_0_sm_red_res_50061;\n                \n                if (cond_46544) {\n                    bool defunc_0_foldl_res_50066;\n                    bool acc_50068;\n                    \n                    for (int64_t i_52488 = 0; i_52488 < dim_35535; i_52488++) {\n                        float eta_p_50063;\n                        float eta_p_50064;\n                        bool zg_res_50065;\n                        \n                        eta_p_50063 = ((__global float *) mem_52647)[slice_52160 + i_52488 * dz2082U_35541];\n                        eta_p_50064 = ((__global float *) xys_mem_52568)[i_52479 * dim_35535 + i_52488];\n                        zg_res_50065 = eta_p_50064 < eta_p_50063;\n                        ((__global bool *) color_52936)[phys_tid_50037 + i_52488 * num_threads_52993] = zg_res_50065;\n                    }\n                    acc_50068 = 0;\n                    for (int64_t i_50067 = 0; i_50067 < dim_35535; i_50067++) {\n                        bool b_50069;\n                        bool defunc_0_f_res_50070;\n                        bool acc_tmp_53254;\n                        \n                        b_50069 = ((__global bool *) color_52936)[phys_tid_50037 + i_50067 * num_threads_52993];\n                        defunc_0_f_res_50070 = acc_50068 || b_50069;\n                        acc_tmp_53254 = defunc_0_f_res_50070;\n                        acc_50068 = acc_tmp_53254;\n                    }\n                    defunc_0_foldl_res_50066 = acc_50068;\n                    defunc_0_sm_red_res_50061 = defunc_0_foldl_res_50066;\n                } else {\n                    bool defunc_0_reduce_res_50071;\n                   ",
                                    " bool redout_52490 = 0;\n                    \n                    for (int64_t i_52491 = 0; i_52491 < dim_35535; i_52491++) {\n                        float eta_p_50072;\n                        float eta_p_50073;\n                        bool zg_res_50074;\n                        bool defunc_0_op_res_50077;\n                        bool redout_tmp_53255;\n                        \n                        eta_p_50072 = ((__global float *) mem_52647)[slice_52160 + i_52491 * dz2082U_35541];\n                        eta_p_50073 = ((__global float *) xys_mem_52568)[i_52479 * dim_35535 + i_52491];\n                        zg_res_50074 = eta_p_50073 < eta_p_50072;\n                        defunc_0_op_res_50077 = zg_res_50074 || redout_52490;\n                        redout_tmp_53255 = defunc_0_op_res_50077;\n                        redout_52490 = redout_tmp_53255;\n                    }\n                    defunc_0_reduce_res_50071 = redout_52490;\n                    defunc_0_sm_red_res_50061 = defunc_0_reduce_res_50071;\n                }\n                lifted_lambda_res_50059 = defunc_0_sm_red_res_50061;\n            } else {\n                lifted_lambda_res_50059 = 0;\n            }\n            defunc_0_op_res_50080 = lifted_lambda_res_50059 || redout_52478;\n            redout_tmp_53249 = defunc_0_op_res_50080;\n            redout_52478 = redout_tmp_53249;\n        }\n        defunc_0_reduce_res_50040 = redout_52478;\n        if (defunc_0_reduce_res_50040) {\n            lifted_lambda_res_50081 = (int64_t) -1;\n        } else {\n            lifted_lambda_res_50081 = slice_52160;\n        }\n        ((__global int64_t *) mem_52574)[inf_35587 + gtid_50036] = lifted_lambda_res_50081;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50033\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50258_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50258(__global int *global_failure, int64_t inf_35587, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, __global unsigned char *mem_52574, __gl", "obal unsigned char *mem_52615)\n{\n    #define segmap_tblock_sizze_50254 (filter_against_9751zisegmap_50258zisegmap_tblock_sizze_50254)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53384;\n    int32_t tblock_sizze_53387;\n    int32_t wave_sizze_53386;\n    int32_t block_id_53385;\n    int32_t global_tid_53383;\n    int64_t phys_tid_50258;\n    int64_t global_tid_53388;\n    int64_t slice_53389;\n    int64_t gtid_50257;\n    int64_t remnant_53390;\n    \n    local_tid_53384 = get_local_id(0);\n    tblock_sizze_53387 = get_local_size(0);\n    wave_sizze_53386 = LOCKSTEP_WIDTH;\n    block_id_53385 = get_tblock_id(0);\n    global_tid_53383 = block_id_53385 * tblock_sizze_53387 + local_tid_53384;\n    phys_tid_50258 = sext_i32_i64(global_tid_53383);\n    global_tid_53388 = sext_i32_i64(block_id_53385) * segmap_tblock_sizze_50254 + sext_i32_i64(local_tid_53384);\n    slice_53389 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n    gtid_50257 = global_tid_53388;\n    remnant_53390 = global_tid_53388 - gtid_50257;\n    if (slt64(gtid_50257, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593)) {\n        int64_t index_primexp_52165;\n        bool defunc_0_reduce_res_50260;\n        int64_t lifted_lambda_res_50261;\n        \n        index_primexp_52165 = add64(inf_35587, gtid_50257);\n        defunc_0_reduce_res_50260 = ((__global bool *) mem_52615)[gtid_50257];\n        if (defunc_0_reduce_res_50260) {\n            lifted_lambda_res_50261 = (int64_t) -1;\n        } else {\n            lifted_lambda_res_50261 = index_primexp_52165;\n        }\n        ((__global int64_t *) mem_52574)[inf_35587 + gtid_50257] = lifted_lambda_res_50261;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50254\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50273_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50273(__global int *global_failure, int64_t dz2082U_35541, int64_t m_45255, int64_t num_tblocks_50278, int32_t virt_num_tblocks_53517, __global unsigned char *mem_52574, __global unsigned char *mem", "_52671, __global unsigned char *mem_52673, __global unsigned char *mem_52675)\n{\n    #define segmap_tblock_sizze_50276 (filter_against_9751zisegmap_50273zisegmap_tblock_sizze_50276)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53519;\n    int32_t tblock_sizze_53522;\n    int32_t wave_sizze_53521;\n    int32_t block_id_53520;\n    int32_t global_tid_53518;\n    int64_t phys_tid_50273;\n    int32_t phys_tblock_id_53523;\n    int32_t iterations_53524;\n    \n    local_tid_53519 = get_local_id(0);\n    tblock_sizze_53522 = get_local_size(0);\n    wave_sizze_53521 = LOCKSTEP_WIDTH;\n    block_id_53520 = get_tblock_id(0);\n    global_tid_53518 = block_id_53520 * tblock_sizze_53522 + local_tid_53519;\n    phys_tid_50273 = sext_i32_i64(global_tid_53518);\n    phys_tblock_id_53523 = get_tblock_id(0);\n    iterations_53524 = sdiv_up32(virt_num_tblocks_53517 - phys_tblock_id_53523, sext_i64_i32(num_tblocks_50278));\n    for (int32_t i_53525 = 0; i_53525 < iterations_53524; i_53525++) {\n        int32_t virt_tblock_id_53526;\n        int64_t global_tid_53527;\n        int64_t slice_53528;\n        int64_t write_i_50272;\n        int64_t remnant_53529;\n        \n        virt_tblock_id_53526 = phys_tblock_id_53523 + i_53525 * sext_i64_i32(num_tblocks_50278);\n        global_tid_53527 = sext_i32_i64(virt_tblock_id_53526) * segmap_tblock_sizze_50276 + sext_i32_i64(local_tid_53519);\n        slice_53528 = dz2082U_35541;\n        write_i_50272 = global_tid_53527;\n        remnant_53529 = global_tid_53527 - write_i_50272;\n        if (slt64(write_i_50272, dz2082U_35541)) {\n            int64_t eta_p_47799;\n            int64_t write_value_47801;\n            bool cond_47802;\n            int64_t lifted_lambda_res_47803;\n            \n            eta_p_47799 = ((__global int64_t *) mem_52673)[write_i_50272];\n            write_value_47801 = ((__global int64_t *) mem_52574)[write_i_50272];\n            cond_47802 = eta_p_47799 == (int64_t) 1;\n            if (cond_47802) {\n                int64_",
                                    "t eta_p_47800;\n                int64_t lifted_lambda_res_t_res_48220;\n                \n                eta_p_47800 = ((__global int64_t *) mem_52671)[write_i_50272];\n                lifted_lambda_res_t_res_48220 = sub64(eta_p_47800, (int64_t) 1);\n                lifted_lambda_res_47803 = lifted_lambda_res_t_res_48220;\n            } else {\n                lifted_lambda_res_47803 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_47803) && slt64(lifted_lambda_res_47803, m_45255)) {\n                ((__global int64_t *) mem_52675)[lifted_lambda_res_47803] = write_value_47801;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_50276\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50325_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50325(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2082U_35541, int64_t m_45255, __global unsigned char *mem_52675, __global unsigned char *mem_52678)\n{\n    #define segmap_tblock_sizze_50321 (filter_against_9751zisegmap_50325zisegmap_tblock_sizze_50321)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53532;\n    int32_t tblock_sizze_53535;\n    int32_t wave_sizze_53534;\n    int32_t block_id_53533;\n    int32_t global_tid_53531;\n    int64_t phys_tid_50325;\n    int64_t global_tid_53536;\n    int64_t slice_53537;\n    int64_t gtid_50324;\n    int64_t remnant_53538;\n    \n    local_tid_53532 = get_local_id(0);\n    tblock_sizze_53535 = get_local_size(0);\n    wave_sizze_53534 = LOCKSTEP_WIDTH;\n    block_id_53533 = get_tblock_id(0);\n    global_tid_53531 = block_id_53533 * tblock_sizze_53535 + local_tid_53532;\n    phys_tid_50325 = sext_i32_i64(global_tid_53531);\n    global_tid_53536 = sext_i32_i64(block_id_53533) * segmap_tblock_sizze_50321 + sext_i32_i64(local_tid_53532);\n    slice_53537 = m_45255;\n    gtid_50324 = global_tid_53536;\n    remnan", "t_53538 = global_tid_53536 - gtid_50324;\n    if (slt64(gtid_50324, m_45255)) {\n        int64_t eta_p_50326;\n        bool x_50327;\n        bool y_50328;\n        bool bounds_check_50329;\n        bool index_certs_50330;\n        \n        eta_p_50326 = ((__global int64_t *) mem_52675)[gtid_50324];\n        x_50327 = sle64((int64_t) 0, eta_p_50326);\n        y_50328 = slt64(eta_p_50326, dz2082U_35541);\n        bounds_check_50329 = x_50327 && y_50328;\n        if (!bounds_check_50329) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_50326;\n                    global_failure_args[1] = (int64_t) dz2082U_35541;\n                    ;\n                }\n                return;\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50321\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50338_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50338(__global int *global_failure, int64_t dim_35535, int64_t m_45255, __global unsigned char *xys_mem_52571, __global unsigned char *mem_52675, __global unsigned char *mem_52678, __global unsigned char *mem_52682)\n{\n    #define segmap_tblock_sizze_50333 (filter_against_9751zisegmap_50338zisegmap_tblock_sizze_50333)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53541;\n    int32_t tblock_sizze_53544;\n    int32_t wave_sizze_53543;\n    int32_t block_id_53542;\n    int32_t global_tid_53540;\n    int64_t phys_tid_50338;\n    int64_t global_tid_53545;\n    int64_t slice_53546;\n    int64_t slice_53547;\n    int64_t gtid_50337;\n    int64_t remnant_53548;\n    int64_t gtid_slice_50336;\n    int64_t remnant_53549;\n    \n    local_tid_53541 = get_local_id(0);\n    tblock_sizze_53544 = get_local_size(0);\n    wave_sizze_53543 = LOCKSTEP_WIDTH;\n    block_id_53542 = get_tblock_id(0);\n    global_tid_53540 = block_id_53542 * tblock_sizze_53544 + local_tid_53541;\n    phys_tid_50338 = sext_i32_i64(global_tid_53", "540);\n    global_tid_53545 = sext_i32_i64(block_id_53542) * segmap_tblock_sizze_50333 + sext_i32_i64(local_tid_53541);\n    slice_53546 = dim_35535;\n    slice_53547 = m_45255 * slice_53546;\n    gtid_50337 = squot64(global_tid_53545, slice_53546);\n    remnant_53548 = global_tid_53545 - gtid_50337 * slice_53546;\n    gtid_slice_50336 = remnant_53548;\n    remnant_53549 = remnant_53548 - gtid_slice_50336;\n    if (slt64(gtid_50337, m_45255) && slt64(gtid_slice_50336, dim_35535)) {\n        int64_t eta_p_50339;\n        bool index_certs_50340;\n        float v_50341;\n        \n        eta_p_50339 = ((__global int64_t *) mem_52675)[gtid_50337];\n        index_certs_50340 = 0;\n        v_50341 = ((__global float *) xys_mem_52571)[eta_p_50339 * dim_35535 + gtid_slice_50336];\n        ((__global float *) mem_52682)[gtid_50337 * dim_35535 + gtid_slice_50336] = v_50341;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50333\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegmap_50347_dim1, 1, 1)\nvoid filter_against_9751zisegmap_50347(__global int *global_failure, int64_t m_45255, __global unsigned char *xys_mem_52572, __global unsigned char *mem_52675, __global unsigned char *mem_52678, __global unsigned char *mem_52685)\n{\n    #define segmap_tblock_sizze_50343 (filter_against_9751zisegmap_50347zisegmap_tblock_sizze_50343)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53552;\n    int32_t tblock_sizze_53555;\n    int32_t wave_sizze_53554;\n    int32_t block_id_53553;\n    int32_t global_tid_53551;\n    int64_t phys_tid_50347;\n    int64_t global_tid_53556;\n    int64_t slice_53557;\n    int64_t gtid_50346;\n    int64_t remnant_53558;\n    \n    local_tid_53552 = get_local_id(0);\n    tblock_sizze_53555 = get_local_size(0);\n    wave_sizze_53554 = LOCKSTEP_WIDTH;\n    block_id_53553 = get_tblock_id(0);\n    global_tid_53551 = block_id_53553 * tblock_sizze_53555 + local_tid_53552;\n    phys_tid_50347 = sext_i32_i64(global_tid_53551);\n    global_tid_53556 = sext_i32_i6",
                                    "4(block_id_53553) * segmap_tblock_sizze_50343 + sext_i32_i64(local_tid_53552);\n    slice_53557 = m_45255;\n    gtid_50346 = global_tid_53556;\n    remnant_53558 = global_tid_53556 - gtid_50346;\n    if (slt64(gtid_50346, m_45255)) {\n        int64_t eta_p_50348;\n        bool index_certs_50349;\n        int64_t lifted_lambda_res_50350;\n        \n        eta_p_50348 = ((__global int64_t *) mem_52675)[gtid_50346];\n        index_certs_50349 = 0;\n        lifted_lambda_res_50350 = ((__global int64_t *) xys_mem_52572)[eta_p_50348];\n        ((__global int64_t *) mem_52685)[gtid_50346] = lifted_lambda_res_50350;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50343\n}\nFUTHARK_KERNEL\nvoid filter_against_9751zisegmap_intrablock_50089(__global int *global_failure, int64_t dim_35535, int64_t dz2082U_35539, int64_t inf_35587, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, unsigned char cond_46544_bits, unsigned char x_52545_bits, int64_t ctx_53015, __global unsigned char *xys_mem_52568, __global unsigned char *xys_mem_52571, __global unsigned char *mem_52574, __global unsigned char *color_52937)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    volatile __local unsigned char *red_arr_mem_53268_backing_0 = &shared_mem[0];\n    const int64_t red_arr_mem_53268_backing_0_offset = 0 + (dz2082U_35539 + srem64((int64_t) 8 - srem64(dz2082U_35539, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53259;\n    int32_t tblock_sizze_53262;\n    int32_t wave_sizze_53261;\n    int32_t block_id_53260;\n    int32_t global_tid_53258;\n    int64_t phys_tblock_id_50089;\n    int64_t slice_53264;\n    int64_t ltid_pre_53263;\n    int64_t remnant_53265;\n    int64_t slice_53266;\n    int64_t gtid_50088;\n    int64_t remnant_53267;\n    int64_t slice_52163;\n    int64_t binop_x_53013;\n    bool defunc_0_reduce_res_50093;\n    int64_t phys_tid_50095;\n    __local unsigned char *red_arr_mem_53268;\n    int64_t gtid_50094;\n    ", "bool defunc_0_reduce_res_50110;\n    int64_t ctx_53014;\n    bool defunc_0_sm_red_res_50100;\n    bool lifted_lambda_res_50117;\n    int32_t offset_53276;\n    int32_t skip_waves_53277;\n    bool eta_p_50096;\n    bool eta_p_50097;\n    int64_t lifted_lambda_res_50136;\n    \n    local_tid_53259 = get_local_id(0);\n    tblock_sizze_53262 = get_local_size(0);\n    wave_sizze_53261 = LOCKSTEP_WIDTH;\n    block_id_53260 = get_tblock_id(0);\n    global_tid_53258 = block_id_53260 * tblock_sizze_53262 + local_tid_53259;\n    phys_tblock_id_50089 = sext_i32_i64(block_id_53260);\n    slice_53264 = dz2082U_35539;\n    ltid_pre_53263 = sext_i32_i64(local_tid_53259);\n    remnant_53265 = sext_i32_i64(local_tid_53259) - ltid_pre_53263;\n    slice_53266 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n    gtid_50088 = sext_i32_i64(block_id_53260);\n    remnant_53267 = sext_i32_i64(block_id_53260) - gtid_50088;\n    slice_52163 = inf_35587 + gtid_50088;\n    binop_x_53013 = dz2082U_35539 * phys_tblock_id_50089;\n    phys_tid_50095 = sext_i32_i64(local_tid_53259);\n    red_arr_mem_53268 = (__local unsigned char *) red_arr_mem_53268_backing_0;\n    gtid_50094 = sext_i32_i64(sext_i64_i32(ltid_pre_53263));\n    if (x_52545) {\n        bool x_52547;\n        bool redout_52496 = 1;\n        \n        for (int64_t i_52497 = 0; i_52497 < dim_35535; i_52497++) {\n            float eta_p_50111;\n            float eta_p_50112;\n            bool zgze_res_50113;\n            bool x_50116;\n            bool redout_tmp_53270;\n            \n            eta_p_50111 = ((__global float *) xys_mem_52571)[slice_52163 * dim_35535 + i_52497];\n            eta_p_50112 = ((__global float *) xys_mem_52568)[gtid_50094 * dim_35535 + i_52497];\n            zgze_res_50113 = eta_p_50112 <= eta_p_50111;\n            x_50116 = zgze_res_50113 && redout_52496;\n            redout_tmp_53270 = x_50116;\n            redout_52496 = redout_tmp_53270;\n        }\n        x_52547 = redout_52496;\n        defunc_0_reduce_res_50110 = x_52547;\n    } else {\n        defunc_0", "_reduce_res_50110 = 0;\n    }\n    ctx_53014 = phys_tid_50095 + binop_x_53013;\n    if (cond_46544) {\n        bool defunc_0_foldl_res_50105;\n        bool acc_50107;\n        \n        for (int64_t i_52494 = 0; i_52494 < dim_35535; i_52494++) {\n            float eta_p_50102;\n            float eta_p_50103;\n            bool zgze_res_50104;\n            \n            eta_p_50102 = ((__global float *) xys_mem_52571)[slice_52163 * dim_35535 + i_52494];\n            eta_p_50103 = ((__global float *) xys_mem_52568)[gtid_50094 * dim_35535 + i_52494];\n            zgze_res_50104 = eta_p_50103 <= eta_p_50102;\n            ((__global bool *) color_52937)[ctx_53014 + i_52494 * ctx_53015] = zgze_res_50104;\n        }\n        acc_50107 = 1;\n        for (int64_t i_50106 = 0; i_50106 < dim_35535; i_50106++) {\n            bool b_50108;\n            bool x_50109;\n            bool acc_tmp_53272;\n            \n            b_50108 = ((__global bool *) color_52937)[ctx_53014 + i_50106 * ctx_53015];\n            x_50109 = acc_50107 && b_50108;\n            acc_tmp_53272 = x_50109;\n            acc_50107 = acc_tmp_53272;\n        }\n        defunc_0_foldl_res_50105 = acc_50107;\n        defunc_0_sm_red_res_50100 = defunc_0_foldl_res_50105;\n    } else {\n        defunc_0_sm_red_res_50100 = defunc_0_reduce_res_50110;\n    }\n    if (defunc_0_sm_red_res_50100) {\n        bool x_52866;\n        bool defunc_0_reduce_res_50129;\n        int64_t binop_x_53022;\n        int64_t ctx_53023;\n        int64_t ctx_53024;\n        bool defunc_0_sm_red_res_50119;\n        \n        x_52866 = !cond_46544;\n        if (x_52866) {\n            bool x_52868;\n            bool redout_52502 = 0;\n            \n            for (int64_t i_52503 = 0; i_52503 < dim_35535; i_52503++) {\n                float eta_p_50130;\n                float eta_p_50131;\n                bool zg_res_50132;\n                bool defunc_0_op_res_50135;\n                bool redout_tmp_53273;\n                \n                eta_p_50130 = ((__global float *) xys_mem_52571)",
                                    "[slice_52163 * dim_35535 + i_52503];\n                eta_p_50131 = ((__global float *) xys_mem_52568)[gtid_50094 * dim_35535 + i_52503];\n                zg_res_50132 = eta_p_50131 < eta_p_50130;\n                defunc_0_op_res_50135 = zg_res_50132 || redout_52502;\n                redout_tmp_53273 = defunc_0_op_res_50135;\n                redout_52502 = redout_tmp_53273;\n            }\n            x_52868 = redout_52502;\n            defunc_0_reduce_res_50129 = x_52868;\n        } else {\n            defunc_0_reduce_res_50129 = 0;\n        }\n        binop_x_53022 = dz2082U_35539 * phys_tblock_id_50089;\n        ctx_53023 = phys_tid_50095 + binop_x_53022;\n        ctx_53024 = dz2082U_35539 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n        if (cond_46544) {\n            bool defunc_0_foldl_res_50124;\n            bool acc_50126;\n            \n            for (int64_t i_52500 = 0; i_52500 < dim_35535; i_52500++) {\n                float eta_p_50121;\n                float eta_p_50122;\n                bool zg_res_50123;\n                \n                eta_p_50121 = ((__global float *) xys_mem_52571)[slice_52163 * dim_35535 + i_52500];\n                eta_p_50122 = ((__global float *) xys_mem_52568)[gtid_50094 * dim_35535 + i_52500];\n                zg_res_50123 = eta_p_50122 < eta_p_50121;\n                ((__global bool *) color_52937)[ctx_53023 + i_52500 * ctx_53024] = zg_res_50123;\n            }\n            acc_50126 = 0;\n            for (int64_t i_50125 = 0; i_50125 < dim_35535; i_50125++) {\n                bool b_50127;\n                bool defunc_0_f_res_50128;\n                bool acc_tmp_53275;\n                \n                b_50127 = ((__global bool *) color_52937)[ctx_53023 + i_50125 * ctx_53024];\n                defunc_0_f_res_50128 = acc_50126 || b_50127;\n                acc_tmp_53275 = defunc_0_f_res_50128;\n                acc_50126 = acc_tmp_53275;\n            }\n            defunc_0_foldl_res_50124 = acc_50126;\n            defunc_0_sm_red_res_50119 = defunc_0_foldl_", "res_50124;\n        } else {\n            defunc_0_sm_red_res_50119 = defunc_0_reduce_res_50129;\n        }\n        lifted_lambda_res_50117 = defunc_0_sm_red_res_50119;\n    } else {\n        lifted_lambda_res_50117 = 0;\n    }\n    ((__local bool *) red_arr_mem_53268)[gtid_50094] = lifted_lambda_res_50117;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53277 = 1;\n    offset_53276 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53259, sext_i64_i32(dz2082U_35539))) {\n            eta_p_50096 = ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n        }\n    }\n    offset_53276 = 1;\n    while (slt32(offset_53276, wave_sizze_53261)) {\n        if (slt32(local_tid_53259 + offset_53276, sext_i64_i32(dz2082U_35539)) && ((local_tid_53259 - squot32(local_tid_53259, wave_sizze_53261) * wave_sizze_53261) & (2 * offset_53276 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_50097 = ((volatile __local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_50098 = eta_p_50096 || eta_p_50097;\n                \n                eta_p_50096 = defunc_0_op_res_50098;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259)] = eta_p_50096;\n            }\n        }\n        offset_53276 *= 2;\n    }\n    while (slt32(skip_waves_53277, squot32(sext_i64_i32(dz2082U_35539) + wave_sizze_53261 - 1, wave_sizze_53261))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53276 = skip_waves_53277 * wave_sizze_53261;\n        if (slt32(local_tid_53259 + offset_53276, sext_i64_i32(dz2082U_35539)) && ((local_tid_53259 - squot32(local_tid_53259, wave_sizze_53261) * wave_sizze_53261) == 0 && (squot32(local_tid_53259, wave_sizze_53261) & (2 * skip_waves_53277 - 1)) == 0)) {\n  ", "          // read array element\n            {\n                eta_p_50097 = ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259 + offset_53276)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_50098 = eta_p_50096 || eta_p_50097;\n                \n                eta_p_50096 = defunc_0_op_res_50098;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_mem_53268)[sext_i32_i64(local_tid_53259)] = eta_p_50096;\n            }\n        }\n        skip_waves_53277 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // Save result of reduction.\n    {\n        defunc_0_reduce_res_50093 = ((__local bool *) red_arr_mem_53268)[(int64_t) 0];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (defunc_0_reduce_res_50093) {\n        lifted_lambda_res_50136 = (int64_t) -1;\n    } else {\n        lifted_lambda_res_50136 = slice_52163;\n    }\n    if (local_tid_53259 == 0) {\n        ((__global int64_t *) mem_52574)[inf_35587 + gtid_50088] = lifted_lambda_res_50136;\n    }\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegred_large_50211_dim1, 1, 1)\nvoid filter_against_9751zisegred_large_50211(__global int *global_failure, int64_t dim_35535, int64_t dz2082U_35539, int64_t dz2082U_35541, int64_t inf_35587, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, unsigned char cond_46544_bits, int64_t num_tblocks_50206, unsigned char x_52545_bits, int64_t num_threads_53028, int64_t blocks_per_segment_53313, int64_t q_53314, int64_t num_virtblocks_53315, int64_t threads_per_segment_53316, __global unsigned char *mem_52588, __global unsigned char *mem_52599, __global unsigned char *mem_52615, __global unsigned char *color_52938, __global unsigned char *color_52939, __global unsigned char *segred_tmp_mem_53317, __global unsigned char *counters_mem_53319)\n{\n    bool cond_46544 = cond_46544_bits;\n",
                                    "    bool x_52545 = x_52545_bits;\n    \n    #define segred_tblock_sizze_50205 (filter_against_9751zisegred_large_50211zisegred_tblock_sizze_50205)\n    #define chunk_sizze_53278 (filter_against_9751zisegred_large_50211zichunk_sizze_53278)\n    \n    volatile __local unsigned char *sync_arr_mem_53348_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53348_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_53346_backing_0 = &shared_mem[sync_arr_mem_53348_backing_1_offset];\n    const int64_t red_arr_bool_mem_53346_backing_0_offset = sync_arr_mem_53348_backing_1_offset + (segred_tblock_sizze_50205 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_50205, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53342;\n    int32_t tblock_sizze_53345;\n    int32_t wave_sizze_53344;\n    int32_t block_id_53343;\n    int32_t global_tid_53341;\n    int64_t phys_tid_50211;\n    __local unsigned char *red_arr_bool_mem_53346;\n    __local unsigned char *sync_arr_mem_53348;\n    int32_t phys_tblock_id_53350;\n    int32_t iterations_53351;\n    \n    local_tid_53342 = get_local_id(0);\n    tblock_sizze_53345 = get_local_size(0);\n    wave_sizze_53344 = LOCKSTEP_WIDTH;\n    block_id_53343 = get_tblock_id(0);\n    global_tid_53341 = block_id_53343 * tblock_sizze_53345 + local_tid_53342;\n    phys_tid_50211 = sext_i32_i64(global_tid_53341);\n    red_arr_bool_mem_53346 = (__local unsigned char *) red_arr_bool_mem_53346_backing_0;\n    sync_arr_mem_53348 = (__local unsigned char *) sync_arr_mem_53348_backing_1;\n    phys_tblock_id_53350 = get_tblock_id(0);\n    iterations_53351 = sdiv_up32(sext_i64_i32(num_virtblocks_53315) - phys_tblock_id_53350, sext_i64_i32(num_tblocks_50206));\n    for (int32_t i_53352 = 0; i_53352 < iterations_53351; i_53352++) {\n        int32_t virt_tblock_id_53353;\n        int64_t flat_segment_id_53354;\n        int64_t global_tid_53355;\n        int64_t slice_53356;\n        int64_t gtid_50209;\n        i", "nt64_t remnant_53357;\n        int64_t gtid_50210;\n        bool eta_p_block_res_acc_53358;\n        bool eta_p_50212;\n        bool eta_p_50213;\n        int64_t tblock_id_in_segment_53362;\n        int64_t block_base_offset_53363;\n        int32_t offset_53372;\n        int32_t skip_waves_53373;\n        bool eta_p_53359;\n        bool eta_p_53360;\n        \n        virt_tblock_id_53353 = phys_tblock_id_53350 + i_53352 * sext_i64_i32(num_tblocks_50206);\n        flat_segment_id_53354 = squot64(sext_i32_i64(virt_tblock_id_53353), blocks_per_segment_53313);\n        global_tid_53355 = srem64(sext_i32_i64(virt_tblock_id_53353) * segred_tblock_sizze_50205 + sext_i32_i64(local_tid_53342), threads_per_segment_53316);\n        slice_53356 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n        gtid_50209 = flat_segment_id_53354;\n        remnant_53357 = flat_segment_id_53354 - gtid_50209;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_53358 = 0;\n        }\n        tblock_id_in_segment_53362 = squot64(global_tid_53355, segred_tblock_sizze_50205);\n        block_base_offset_53363 = tblock_id_in_segment_53362 * q_53314 * segred_tblock_sizze_50205;\n        for (int64_t i_53364 = 0; i_53364 < q_53314; i_53364++) {\n            int64_t block_offset_53365 = block_base_offset_53363 + i_53364 * segred_tblock_sizze_50205;\n            \n            gtid_50210 = global_tid_53355 + threads_per_segment_53316 * i_53364;\n            if (slt64(gtid_50210, dz2082U_35539)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        int64_t slice_52166 = inf_35587 + gtid_50209;\n                        bool defunc_0_reduce_res_50227;\n                        \n                        if (x_52545) {\n                            bool x_52862;\n                            bool redout_52508 = 1;\n                            \n                            for (int64_t i_52509 = 0; i_", "52509 < dim_35535; i_52509++) {\n                                float eta_p_50228 = ((__global float *) mem_52588)[slice_52166 + i_52509 * dz2082U_35541];\n                                float eta_p_50229 = ((__global float *) mem_52599)[gtid_50210 + i_52509 * dz2082U_35539];\n                                bool zgze_res_50230 = eta_p_50229 <= eta_p_50228;\n                                bool x_50233 = zgze_res_50230 && redout_52508;\n                                bool redout_tmp_53366 = x_50233;\n                                \n                                redout_52508 = redout_tmp_53366;\n                            }\n                            x_52862 = redout_52508;\n                            defunc_0_reduce_res_50227 = x_52862;\n                        } else {\n                            defunc_0_reduce_res_50227 = 0;\n                        }\n                        \n                        bool defunc_0_sm_red_res_50217;\n                        \n                        if (cond_46544) {\n                            for (int64_t i_52506 = 0; i_52506 < dim_35535; i_52506++) {\n                                float eta_p_50219 = ((__global float *) mem_52588)[slice_52166 + i_52506 * dz2082U_35541];\n                                float eta_p_50220 = ((__global float *) mem_52599)[gtid_50210 + i_52506 * dz2082U_35539];\n                                bool zgze_res_50221 = eta_p_50220 <= eta_p_50219;\n                                \n                                ((__global bool *) color_52939)[phys_tid_50211 + i_52506 * num_threads_53028] = zgze_res_50221;\n                            }\n                            \n                            bool defunc_0_foldl_res_50222;\n                            bool acc_50224 = 1;\n                            \n                            for (int64_t i_50223 = 0; i_50223 < dim_35535; i_50223++) {\n                                bool b_50225 = ((__global bool *) color_52939)[phys_tid_50211 + i_50223 * num_threads_53028];\n ",
                                    "                               bool x_50226 = acc_50224 && b_50225;\n                                bool acc_tmp_53368 = x_50226;\n                                \n                                acc_50224 = acc_tmp_53368;\n                            }\n                            defunc_0_foldl_res_50222 = acc_50224;\n                            defunc_0_sm_red_res_50217 = defunc_0_foldl_res_50222;\n                        } else {\n                            defunc_0_sm_red_res_50217 = defunc_0_reduce_res_50227;\n                        }\n                        \n                        bool lifted_lambda_res_50234;\n                        \n                        if (defunc_0_sm_red_res_50217) {\n                            bool defunc_0_sm_red_res_50236;\n                            \n                            if (cond_46544) {\n                                for (int64_t i_52512 = 0; i_52512 < dim_35535; i_52512++) {\n                                    float eta_p_50238 = ((__global float *) mem_52588)[slice_52166 + i_52512 * dz2082U_35541];\n                                    float eta_p_50239 = ((__global float *) mem_52599)[gtid_50210 + i_52512 * dz2082U_35539];\n                                    bool zg_res_50240 = eta_p_50239 < eta_p_50238;\n                                    \n                                    ((__global bool *) color_52938)[phys_tid_50211 + i_52512 * num_threads_53028] = zg_res_50240;\n                                }\n                                \n                                bool defunc_0_foldl_res_50241;\n                                bool acc_50243 = 0;\n                                \n                                for (int64_t i_50242 = 0; i_50242 < dim_35535; i_50242++) {\n                                    bool b_50244 = ((__global bool *) color_52938)[phys_tid_50211 + i_50242 * num_threads_53028];\n                                    bool defunc_0_f_res_50245 = acc_50243 || b_50244;\n                                    bool acc", "_tmp_53370 = defunc_0_f_res_50245;\n                                    \n                                    acc_50243 = acc_tmp_53370;\n                                }\n                                defunc_0_foldl_res_50241 = acc_50243;\n                                defunc_0_sm_red_res_50236 = defunc_0_foldl_res_50241;\n                            } else {\n                                bool defunc_0_reduce_res_50246;\n                                bool redout_52514 = 0;\n                                \n                                for (int64_t i_52515 = 0; i_52515 < dim_35535; i_52515++) {\n                                    float eta_p_50247 = ((__global float *) mem_52588)[slice_52166 + i_52515 * dz2082U_35541];\n                                    float eta_p_50248 = ((__global float *) mem_52599)[gtid_50210 + i_52515 * dz2082U_35539];\n                                    bool zg_res_50249 = eta_p_50248 < eta_p_50247;\n                                    bool defunc_0_op_res_50252 = zg_res_50249 || redout_52514;\n                                    bool redout_tmp_53371 = defunc_0_op_res_50252;\n                                    \n                                    redout_52514 = redout_tmp_53371;\n                                }\n                                defunc_0_reduce_res_50246 = redout_52514;\n                                defunc_0_sm_red_res_50236 = defunc_0_reduce_res_50246;\n                            }\n                            lifted_lambda_res_50234 = defunc_0_sm_red_res_50236;\n                        } else {\n                            lifted_lambda_res_50234 = 0;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_50212 = eta_p_block_res_acc_53358;\n                        }\n                        // load next value(s)\n                        {\n                            eta_p_50213 = lifted_lambda_res_50234;\n                        }\n                   ", "     // apply reduction operator(s)\n                        {\n                            bool defunc_0_op_res_50214 = eta_p_50212 || eta_p_50213;\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_53358 = defunc_0_op_res_50214;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_block_res_acc_53358;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_53373 = 1;\n        offset_53372 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_53342, sext_i64_i32(segred_tblock_sizze_50205))) {\n                eta_p_53359 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n            }\n        }\n        offset_53372 = 1;\n        while (slt32(offset_53372, wave_sizze_53344)) {\n            if (slt32(local_tid_53342 + offset_53372, sext_i64_i32(segred_tblock_sizze_50205)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) & (2 * offset_53372 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_53360 = ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                    \n                    eta_p_53359 = defunc_0_op_res_53361;\n                }\n                // write result of operation\n                {\n                    ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_533",
                                    "42)] = eta_p_53359;\n                }\n            }\n            offset_53372 *= 2;\n        }\n        while (slt32(skip_waves_53373, squot32(sext_i64_i32(segred_tblock_sizze_50205) + wave_sizze_53344 - 1, wave_sizze_53344))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_53372 = skip_waves_53373 * wave_sizze_53344;\n            if (slt32(local_tid_53342 + offset_53372, sext_i64_i32(segred_tblock_sizze_50205)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) == 0 && (squot32(local_tid_53342, wave_sizze_53344) & (2 * skip_waves_53373 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_53360 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53372)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                    \n                    eta_p_53359 = defunc_0_op_res_53361;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                }\n            }\n            skip_waves_53373 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_53342) == (int64_t) 0) {\n                eta_p_block_res_acc_53358 = eta_p_53359;\n            } else {\n                eta_p_block_res_acc_53358 = 0;\n            }\n        }\n        if (blocks_per_segment_53313 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_53342 == 0) {\n                    ((__global bool *) mem_52615)[gtid_50209] = eta_p_block_res_acc_53358;\n                }\n            }\n        } else {\n            int32_t old_counter_53", "374;\n            bool is_last_block_53375;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_53342 == 0) {\n                    ((__global bool *) segred_tmp_mem_53317)[sext_i32_i64(virt_tblock_id_53353)] = eta_p_block_res_acc_53358;\n                    mem_fence_global();\n                    old_counter_53374 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53319)[srem64(flat_segment_id_53354, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_53348)[(int64_t) 0] = old_counter_53374 == sext_i64_i32(blocks_per_segment_53313 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_53375 = ((__local bool *) sync_arr_mem_53348)[(int64_t) 0];\n            if (is_last_block_53375) {\n                if (local_tid_53342 == 0) {\n                    old_counter_53374 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53319)[srem64(flat_segment_id_53354, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_53313));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_53376 = sdiv_up64(blocks_per_segment_53313, segred_tblock_sizze_50205);\n                    \n                    eta_p_50212 = 0;\n                    for (int64_t i_53377 = 0; i_53377 < read_per_thread_53376; i_53377++) {\n                        int64_t block_res_id_53378 = sext_i32_i64(local_tid_53342) * read_per_thread_53376 + i_53377;\n                        int64_t index_of_block_res_53379 = flat_segment_id_53354 * blocks_per_segment_53313 + block_res_id_53378;\n                        \n                        if (slt64(block_res_id_53378, blocks_per_segment_53313)) {\n                            eta_p_50213 = ((__global bool *) segred_tmp_mem_53317)[index_of_block_res_53379];\n                           ", " \n                            bool defunc_0_op_res_50214 = eta_p_50212 || eta_p_50213;\n                            \n                            eta_p_50212 = defunc_0_op_res_50214;\n                        }\n                    }\n                }\n                ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_50212;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_53380;\n                    int32_t skip_waves_53381 = 1;\n                    bool eta_p_53359;\n                    bool eta_p_53360;\n                    \n                    offset_53380 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_53342, sext_i64_i32(segred_tblock_sizze_50205))) {\n                            eta_p_53359 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                        }\n                    }\n                    offset_53380 = 1;\n                    while (slt32(offset_53380, wave_sizze_53344)) {\n                        if (slt32(local_tid_53342 + offset_53380, sext_i64_i32(segred_tblock_sizze_50205)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) & (2 * offset_53380 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_53360 = ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                                \n                                eta_p_53359 = defunc_0_op_res_53361;\n                            }\n                            // write result of op",
                                    "eration\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                            }\n                        }\n                        offset_53380 *= 2;\n                    }\n                    while (slt32(skip_waves_53381, squot32(sext_i64_i32(segred_tblock_sizze_50205) + wave_sizze_53344 - 1, wave_sizze_53344))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_53380 = skip_waves_53381 * wave_sizze_53344;\n                        if (slt32(local_tid_53342 + offset_53380, sext_i64_i32(segred_tblock_sizze_50205)) && ((local_tid_53342 - squot32(local_tid_53342, wave_sizze_53344) * wave_sizze_53344) == 0 && (squot32(local_tid_53342, wave_sizze_53344) & (2 * skip_waves_53381 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_53360 = ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342 + offset_53380)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_53361 = eta_p_53359 || eta_p_53360;\n                                \n                                eta_p_53359 = defunc_0_op_res_53361;\n                            }\n                            // write result of operation\n                            {\n                                ((__local bool *) red_arr_bool_mem_53346)[sext_i32_i64(local_tid_53342)] = eta_p_53359;\n                            }\n                        }\n                        skip_waves_53381 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_53342 == 0) {\n                            ((__global bool *) mem_52615)[gtid_50209] = eta_p_53", "359;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_50205\n    #undef chunk_sizze_53278\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegred_small_50211_dim1, 1, 1)\nvoid filter_against_9751zisegred_small_50211(__global int *global_failure, int64_t dim_35535, int64_t dz2082U_35539, int64_t dz2082U_35541, int64_t inf_35587, int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, unsigned char cond_46544_bits, int64_t num_tblocks_50206, unsigned char x_52545_bits, int64_t num_threads_53028, int64_t segment_sizze_nonzzero_53279, __global unsigned char *mem_52588, __global unsigned char *mem_52599, __global unsigned char *mem_52615, __global unsigned char *color_52938, __global unsigned char *color_52939)\n{\n    bool cond_46544 = cond_46544_bits;\n    bool x_52545 = x_52545_bits;\n    \n    #define segred_tblock_sizze_50205 (filter_against_9751zisegred_small_50211zisegred_tblock_sizze_50205)\n    \n    volatile __local unsigned char *red_arr_bool_mem_53286_backing_0 = &shared_mem[0];\n    const int64_t red_arr_bool_mem_53286_backing_0_offset = 0 + (segred_tblock_sizze_50205 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_50205, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53282;\n    int32_t tblock_sizze_53285;\n    int32_t wave_sizze_53284;\n    int32_t block_id_53283;\n    int32_t global_tid_53281;\n    int64_t phys_tid_50211;\n    __local unsigned char *red_arr_bool_mem_53286;\n    int32_t phys_tblock_id_53288;\n    int32_t iterations_53289;\n    \n    local_tid_53282 = get_local_id(0);\n    tblock_sizze_53285 = get_local_size(0);\n    wave_sizze_53284 = LOCKSTEP_WIDTH;\n    block_id_53283 = get_tblock_id(0);\n    global_tid_53281 = block_id_53283 * tblock_sizze_53285 + local_tid_53282;\n    phys_tid_50211 = sext_i32_i64(global_tid_53281);\n    red_arr_bool_mem_53286 = (_", "_local unsigned char *) red_arr_bool_mem_53286_backing_0;\n    phys_tblock_id_53288 = get_tblock_id(0);\n    iterations_53289 = sdiv_up32(sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279))) - phys_tblock_id_53288, sext_i64_i32(num_tblocks_50206));\n    for (int32_t i_53290 = 0; i_53290 < iterations_53289; i_53290++) {\n        int32_t virt_tblock_id_53291;\n        int64_t slice_53292;\n        int64_t gtid_50209;\n        int64_t remnant_53293;\n        int64_t gtid_50210;\n        \n        virt_tblock_id_53291 = phys_tblock_id_53288 + i_53290 * sext_i64_i32(num_tblocks_50206);\n        slice_53292 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;\n        gtid_50209 = squot64(sext_i32_i64(local_tid_53282), segment_sizze_nonzzero_53279) + sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279);\n        remnant_53293 = squot64(sext_i32_i64(local_tid_53282), segment_sizze_nonzzero_53279) + sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279) - gtid_50209;\n        gtid_50210 = srem64(sext_i32_i64(local_tid_53282), dz2082U_35539);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, dz2082U_35539) && (slt64(gtid_50209, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593) && slt64(sext_i32_i64(local_tid_53282), dz2082U_35539 * squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279)))) {\n                // apply map function\n                {\n                    int64_t slice_52166 = inf_35587 + gtid_50209;\n                    bool defunc_0_reduce_res_50227;\n                    \n                    if (x_52545) {\n                        bool x_52862;\n                        bool redout_52508 = 1;\n                        \n                        for (int64_t i_52509 = 0; i_52509 < dim_35535; i_52509++) {\n                            float eta_p_50228 = ((__global float *) mem_52588)[slice",
                                    "_52166 + i_52509 * dz2082U_35541];\n                            float eta_p_50229 = ((__global float *) mem_52599)[gtid_50210 + i_52509 * dz2082U_35539];\n                            bool zgze_res_50230 = eta_p_50229 <= eta_p_50228;\n                            bool x_50233 = zgze_res_50230 && redout_52508;\n                            bool redout_tmp_53294 = x_50233;\n                            \n                            redout_52508 = redout_tmp_53294;\n                        }\n                        x_52862 = redout_52508;\n                        defunc_0_reduce_res_50227 = x_52862;\n                    } else {\n                        defunc_0_reduce_res_50227 = 0;\n                    }\n                    \n                    bool defunc_0_sm_red_res_50217;\n                    \n                    if (cond_46544) {\n                        for (int64_t i_52506 = 0; i_52506 < dim_35535; i_52506++) {\n                            float eta_p_50219 = ((__global float *) mem_52588)[slice_52166 + i_52506 * dz2082U_35541];\n                            float eta_p_50220 = ((__global float *) mem_52599)[gtid_50210 + i_52506 * dz2082U_35539];\n                            bool zgze_res_50221 = eta_p_50220 <= eta_p_50219;\n                            \n                            ((__global bool *) color_52939)[phys_tid_50211 + i_52506 * num_threads_53028] = zgze_res_50221;\n                        }\n                        \n                        bool defunc_0_foldl_res_50222;\n                        bool acc_50224 = 1;\n                        \n                        for (int64_t i_50223 = 0; i_50223 < dim_35535; i_50223++) {\n                            bool b_50225 = ((__global bool *) color_52939)[phys_tid_50211 + i_50223 * num_threads_53028];\n                            bool x_50226 = acc_50224 && b_50225;\n                            bool acc_tmp_53296 = x_50226;\n                            \n                            acc_50224 = acc_tmp_53296;\n                        }\n    ", "                    defunc_0_foldl_res_50222 = acc_50224;\n                        defunc_0_sm_red_res_50217 = defunc_0_foldl_res_50222;\n                    } else {\n                        defunc_0_sm_red_res_50217 = defunc_0_reduce_res_50227;\n                    }\n                    \n                    bool lifted_lambda_res_50234;\n                    \n                    if (defunc_0_sm_red_res_50217) {\n                        bool defunc_0_sm_red_res_50236;\n                        \n                        if (cond_46544) {\n                            for (int64_t i_52512 = 0; i_52512 < dim_35535; i_52512++) {\n                                float eta_p_50238 = ((__global float *) mem_52588)[slice_52166 + i_52512 * dz2082U_35541];\n                                float eta_p_50239 = ((__global float *) mem_52599)[gtid_50210 + i_52512 * dz2082U_35539];\n                                bool zg_res_50240 = eta_p_50239 < eta_p_50238;\n                                \n                                ((__global bool *) color_52938)[phys_tid_50211 + i_52512 * num_threads_53028] = zg_res_50240;\n                            }\n                            \n                            bool defunc_0_foldl_res_50241;\n                            bool acc_50243 = 0;\n                            \n                            for (int64_t i_50242 = 0; i_50242 < dim_35535; i_50242++) {\n                                bool b_50244 = ((__global bool *) color_52938)[phys_tid_50211 + i_50242 * num_threads_53028];\n                                bool defunc_0_f_res_50245 = acc_50243 || b_50244;\n                                bool acc_tmp_53298 = defunc_0_f_res_50245;\n                                \n                                acc_50243 = acc_tmp_53298;\n                            }\n                            defunc_0_foldl_res_50241 = acc_50243;\n                            defunc_0_sm_red_res_50236 = defunc_0_foldl_res_50241;\n                        } else {\n                          ", "  bool defunc_0_reduce_res_50246;\n                            bool redout_52514 = 0;\n                            \n                            for (int64_t i_52515 = 0; i_52515 < dim_35535; i_52515++) {\n                                float eta_p_50247 = ((__global float *) mem_52588)[slice_52166 + i_52515 * dz2082U_35541];\n                                float eta_p_50248 = ((__global float *) mem_52599)[gtid_50210 + i_52515 * dz2082U_35539];\n                                bool zg_res_50249 = eta_p_50248 < eta_p_50247;\n                                bool defunc_0_op_res_50252 = zg_res_50249 || redout_52514;\n                                bool redout_tmp_53299 = defunc_0_op_res_50252;\n                                \n                                redout_52514 = redout_tmp_53299;\n                            }\n                            defunc_0_reduce_res_50246 = redout_52514;\n                            defunc_0_sm_red_res_50236 = defunc_0_reduce_res_50246;\n                        }\n                        lifted_lambda_res_50234 = defunc_0_sm_red_res_50236;\n                    } else {\n                        lifted_lambda_res_50234 = 0;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = lifted_lambda_res_50234;\n                    }\n                }\n            } else {\n                ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, dz2082U_35539)) {\n            // perform segmented scan to imitate reduction\n            {\n                bool eta_p_50212;\n                bool eta_p_50213;\n                bool eta_p_53300;\n                bool eta_p_53301;\n                bool ltid_in_bounds_53303 = slt64(sext_i32_i64(local_tid_53282), dz2082U_35539 * squot64(segred_tblock_sizze_50205, segment_sizze",
                                    "_nonzzero_53279));\n                int32_t skip_threads_53304;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_53303) {\n                        eta_p_50213 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)];\n                        if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 0) {\n                            eta_p_50212 = eta_p_50213;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53304 = 1;\n                    while (slt32(skip_threads_53304, 32)) {\n                        bool thread_active_53305 = sle32(skip_threads_53304, local_tid_53282 - squot32(local_tid_53282, 32) * 32) && ltid_in_bounds_53303;\n                        \n                        if (thread_active_53305) {\n                            // read operands\n                            {\n                                eta_p_50212 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282) - sext_i32_i64(skip_threads_53304)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_53306 = slt64(srem64(sext_i32_i64(local_tid_53282), dz2082U_35539), sext_i32_i64(local_tid_53282) - sext_i32_i64(local_tid_53282 - skip_threads_53304));\n                            \n                            if (thread_active_53305 && inactive_53306) {\n                                eta_p_50212 = eta_p_50213;\n                            }\n                            if (thread_active_53305) {\n                                if (!inactive_53306) {\n                                    bool defunc_0_op_res_50214 = eta_p_50212 || eta_p_50213;\n                                    \n                                    eta_p_50212 = defunc_0_op_res", "_50214;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_53284, skip_threads_53304)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53305) {\n                            // write result\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_50212;\n                                eta_p_50213 = eta_p_50212;\n                            }\n                        }\n                        if (sle32(wave_sizze_53284, skip_threads_53304)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53304 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 31 && ltid_in_bounds_53303) {\n                        ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(squot32(local_tid_53282, 32))] = eta_p_50212;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_53307;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303) {\n                            eta_p_53301 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)];\n                            if ((local_tid_53282 - squot32(local_tid_53282, 32) * 32) == 0) {\n                                eta_p_53300 = eta_p_53301;\n                            }", "\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_53307 = 1;\n                        while (slt32(skip_threads_53307, 32)) {\n                            bool thread_active_53308 = sle32(skip_threads_53307, local_tid_53282 - squot32(local_tid_53282, 32) * 32) && (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303);\n                            \n                            if (thread_active_53308) {\n                                // read operands\n                                {\n                                    eta_p_53300 = ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282) - sext_i32_i64(skip_threads_53307)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_53309 = slt64(srem64(sext_i32_i64(local_tid_53282 * 32 + 32 - 1), dz2082U_35539), sext_i32_i64(local_tid_53282 * 32 + 32 - 1) - sext_i32_i64((local_tid_53282 - skip_threads_53307) * 32 + 32 - 1));\n                                \n                                if (thread_active_53308 && inactive_53309) {\n                                    eta_p_53300 = eta_p_53301;\n                                }\n                                if (thread_active_53308) {\n                                    if (!inactive_53309) {\n                                        bool defunc_0_op_res_53302 = eta_p_53300 || eta_p_53301;\n                                        \n                                        eta_p_53300 = defunc_0_op_res_53302;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_53284, skip_threads_53307)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                 ",
                                    "           if (thread_active_53308) {\n                                // write result\n                                {\n                                    ((volatile __local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_53300;\n                                    eta_p_53301 = eta_p_53300;\n                                }\n                            }\n                            if (sle32(wave_sizze_53284, skip_threads_53307)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_53307 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_53310 = squot32(local_tid_53282, 32) == 0 || !ltid_in_bounds_53303;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_53310) {\n                            eta_p_50213 = eta_p_50212;\n                            eta_p_50212 = ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(squot32(local_tid_53282, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_53311 = slt64(srem64(sext_i32_i64(local_tid_53282), dz2082U_35539), sext_i32_i64(local_tid_53282) - sext_i32_i64(squot32(local_tid_53282, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_53310) {\n                            if (inactive_53311) {\n                                eta_p_50212 = eta_p_50213;\n                            }\n                        }\n                        if (!no_carry_in_53310) {\n                            if (!inactive_53311) {\n                                bool defunc_0_op_res_50214 = eta_p_50212 || eta_p_50213;\n                              ", "  \n                                eta_p_50212 = defunc_0_op_res_50214;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_53310) {\n                            ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_50212;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_53282, 32) == 0 && ltid_in_bounds_53303) {\n                        ((__local bool *) red_arr_bool_mem_53286)[sext_i32_i64(local_tid_53282)] = eta_p_50213;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279) + sext_i32_i64(local_tid_53282), dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593) && slt64(sext_i32_i64(local_tid_53282), squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279))) {\n                bool tmp_53312 = ((__local bool *) red_arr_bool_mem_53286)[(sext_i32_i64(local_tid_53282) + (int64_t) 1) * segment_sizze_nonzzero_53279 - (int64_t) 1];\n                \n                ((__global bool *) mem_52615)[sext_i32_i64(virt_tblock_id_53291) * squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279) + sext_i32_i64(local_tid_53282)] = tmp_53312;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_50205\n}\nFUTHARK_KERNEL_SIZED(filter_against_9751zisegscan_50271_dim1, 1, 1)\nvoid filter_against_9751zisegscan_50271(__global int *global_failure, int64_t dz2082U_", "35541, int64_t num_tblocks_50268, int64_t num_virt_blocks_53399, int64_t num_virt_threads_53400, __global unsigned char *mem_52574, __global unsigned char *mem_52671, __global unsigned char *mem_52673, __global unsigned char *status_flags_mem_53401, __global unsigned char *aggregates_mem_53423, __global unsigned char *incprefixes_mem_53425, __global unsigned char *global_dynid_mem_53427)\n{\n    #define segscan_tblock_sizze_50266 (filter_against_9751zisegscan_50271zisegscan_tblock_sizze_50266)\n    #define chunk_sizze_53398 (filter_against_9751zisegscan_50271zichunk_sizze_53398)\n    \n    volatile __local unsigned char *local_mem_53437_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53437_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50266), chunk_sizze_53398 * segscan_tblock_sizze_50266 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50266), chunk_sizze_53398 * segscan_tblock_sizze_50266 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53430;\n    int32_t tblock_sizze_53433;\n    int32_t wave_sizze_53432;\n    int32_t block_id_53431;\n    int32_t global_tid_53429;\n    int64_t phys_tid_50271;\n    int32_t chunk_sizze_32b_53434;\n    int64_t byte_offsets_53435;\n    int64_t warp_byte_offset_53436;\n    __local unsigned char *local_mem_53437;\n    int64_t trans_arr_len_53438;\n    int64_t phys_block_id_53444;\n    int64_t virtloop_bound_53445;\n    \n    local_tid_53430 = get_local_id(0);\n    tblock_sizze_53433 = get_local_size(0);\n    wave_sizze_53432 = LOCKSTEP_WIDTH;\n    block_id_53431 = get_tblock_id(0);\n    global_tid_53429 = block_id_53431 * tblock_sizze_53433 + local_tid_53430;\n    phys_tid_50271 = sext_i32_i64(global_tid_53429);\n    chunk_sizze_32b_53434 = sext_i64_i32(chunk_sizze_53398);\n    byte_offsets_53435 = segscan_tblock_sizze_50266 * (int64_t) 8;\n    warp_byte_offset_53436 = (int64_t) 28",
                                    "8;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53437 = (__local unsigned char *) local_mem_53437_backing_0;\n    trans_arr_len_53438 = chunk_sizze_53398 * segscan_tblock_sizze_50266;\n    phys_block_id_53444 = get_tblock_id(0);\n    virtloop_bound_53445 = sdiv_up64(num_virt_blocks_53399 - phys_block_id_53444, num_tblocks_50268);\n    for (int64_t virtloop_i_53446 = 0; virtloop_i_53446 < virtloop_bound_53445; virtloop_i_53446++) {\n        int64_t dynamic_id_53447;\n        int64_t block_offset_53448;\n        int64_t sgm_idx_53449;\n        int32_t boundary_53450;\n        int32_t segsizze_compact_53451;\n        int64_t private_mem_53452[chunk_sizze_53398];\n        int64_t thd_offset_53454;\n        int64_t acc_53470;\n        int64_t prefix_53480;\n        bool block_new_sgm_53481;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53430 == 0) {\n                dynamic_id_53447 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53427)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53437)[(int64_t) 0] = dynamic_id_53447;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53447 == num_virt_blocks_53399 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53427)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53447 = ((__local int32_t *) local_mem_53437)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53448 = dynamic_id_53447 * chunk_sizze_53398 * segscan_tblock_sizze_50266;\n        sgm_idx_53449 = smod64(block_offset_53448, dz2082U_35541);\n        boundary_53450 = sext_i64_i32(smin64(chunk_sizze_53398 * segscan_tblock_sizze_50266, dz2082U_35541 - sgm_idx", "_53449));\n        segsizze_compact_53451 = sext_i64_i32(smin64(chunk_sizze_53398 * segscan_tblock_sizze_50266, dz2082U_35541));\n        thd_offset_53454 = block_offset_53448 + sext_i32_i64(local_tid_53430);\n        // Load and map\n        {\n            for (int64_t i_53455 = 0; i_53455 < chunk_sizze_53398; i_53455++) {\n                int64_t virt_tid_53456 = thd_offset_53454 + i_53455 * segscan_tblock_sizze_50266;\n                int64_t slice_53457 = dz2082U_35541;\n                int64_t gtid_50270 = virt_tid_53456;\n                int64_t remnant_53458 = virt_tid_53456 - gtid_50270;\n                \n                if (slt64(virt_tid_53456, dz2082U_35541)) {\n                    int64_t eta_p_47807 = ((__global int64_t *) mem_52574)[gtid_50270];\n                    bool lifted_lambda_res_47808 = sle64((int64_t) 0, eta_p_47807);\n                    int64_t defunc_0_f_res_47809 = btoi_bool_i64(lifted_lambda_res_47808);\n                    \n                    ((__global int64_t *) mem_52673)[gtid_50270] = defunc_0_f_res_47809;\n                    private_mem_53452[i_53455] = defunc_0_f_res_47809;\n                } else {\n                    private_mem_53452[i_53455] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53459 = 0; i_53459 < chunk_sizze_53398; i_53459++) {\n                int64_t sharedIdx_53460 = sext_i32_i64(local_tid_53430) + i_53459 * segscan_tblock_sizze_50266;\n                int64_t tmp_53461 = private_mem_53452[i_53459];\n                \n                ((__local int64_t *) local_mem_53437)[sharedIdx_53460] = tmp_53461;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53462 = 0; i_53462 < chunk_sizze_53398; i_53462++) {\n                int64_t sharedIdx_53463 = sext_i32_i64(local_tid_53430) * chunk_sizze_53398 + i_53462;\n                int64_t tmp_53464 = ((__local int64_t *) local_mem_53437)[share", "dIdx_53463];\n                \n                private_mem_53452[i_53462] = tmp_53464;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53465 = 0; i_53465 < chunk_sizze_53398 - (int64_t) 1; i_53465++) {\n                int64_t eta_p_45242;\n                int64_t eta_p_45243;\n                \n                eta_p_45242 = private_mem_53452[i_53465];\n                eta_p_45243 = private_mem_53452[i_53465 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_45244 = add64(eta_p_45242, eta_p_45243);\n                \n                private_mem_53452[i_53465 + (int64_t) 1] = defunc_0_op_res_45244;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53466 = private_mem_53452[chunk_sizze_53398 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = tmp_53466;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53467;\n            int64_t eta_p_53468;\n            int64_t eta_p_53471;\n            int64_t eta_p_53472;\n            bool ltid_in_bounds_53474 = slt64(sext_i32_i64(local_tid_53430), num_virt_threads_53400);\n            int32_t skip_threads_53475;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53474) {\n                    eta_p_53468 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                    if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                        eta_p_53467 = eta_p_53468;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53475 = 1;\n                while (slt32(skip_threads_53475, 32)) {\n                    bool thread_active_53476 = sle32(skip_thread",
                                    "s_53475, local_tid_53430 - squot32(local_tid_53430, 32) * 32) && ltid_in_bounds_53474;\n                    \n                    if (thread_active_53476) {\n                        // read operands\n                        {\n                            eta_p_53467 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53475)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53476) {\n                            int64_t defunc_0_op_res_53469 = add64(eta_p_53467, eta_p_53468);\n                            \n                            eta_p_53467 = defunc_0_op_res_53469;\n                        }\n                    }\n                    if (sle32(wave_sizze_53432, skip_threads_53475)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53476) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53467;\n                            eta_p_53468 = eta_p_53467;\n                        }\n                    }\n                    if (sle32(wave_sizze_53432, skip_threads_53475)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53475 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 31 && ltid_in_bounds_53474) {\n                    ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(squot32(local_tid_53430, 32))] = eta_p_53467;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for ", "block 'i+1'\n            {\n                int32_t skip_threads_53477;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474) {\n                        eta_p_53472 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                        if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                            eta_p_53471 = eta_p_53472;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53477 = 1;\n                    while (slt32(skip_threads_53477, 32)) {\n                        bool thread_active_53478 = sle32(skip_threads_53477, local_tid_53430 - squot32(local_tid_53430, 32) * 32) && (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474);\n                        \n                        if (thread_active_53478) {\n                            // read operands\n                            {\n                                eta_p_53471 = ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53477)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53478) {\n                                int64_t defunc_0_op_res_53473 = add64(eta_p_53471, eta_p_53472);\n                                \n                                eta_p_53471 = defunc_0_op_res_53473;\n                            }\n                        }\n                        if (sle32(wave_sizze_53432, skip_threads_53477)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53478) {\n                            // write result\n                            {\n                      ", "          ((volatile __local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53471;\n                                eta_p_53472 = eta_p_53471;\n                            }\n                        }\n                        if (sle32(wave_sizze_53432, skip_threads_53477)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53477 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53479 = squot32(local_tid_53430, 32) == 0 || !ltid_in_bounds_53474;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53479) {\n                        eta_p_53468 = eta_p_53467;\n                        eta_p_53467 = ((__local int64_t *) local_mem_53437)[sext_i32_i64(squot32(local_tid_53430, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53479) {\n                        int64_t defunc_0_op_res_53469 = add64(eta_p_53467, eta_p_53468);\n                        \n                        eta_p_53467 = defunc_0_op_res_53469;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53479) {\n                        ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53467;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53430, 32) == 0 && ltid_in_bounds_53474) {\n                    ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = eta_p_53468;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            ",
                                    "barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53430 == 0) {\n                acc_53470 = ((__local int64_t *) local_mem_53437)[segscan_tblock_sizze_50266 - (int64_t) 1];\n            } else {\n                acc_53470 = ((__local int64_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53480 = (int64_t) 0;\n        block_new_sgm_53481 = sgm_idx_53449 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53481 && local_tid_53430 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447] = acc_53470;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 2;\n                acc_53470 = (int64_t) 0;\n            }\n            if (!block_new_sgm_53481 && slt32(local_tid_53430, wave_sizze_53432)) {\n                if (local_tid_53430 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53423)[dynamic_id_53447] = acc_53470;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 1;\n                    \n                    int8_t tmp_53482 = ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53437)[(int64_t) 0] = tmp_53482;\n                }\n                mem_fence_local();\n                \n                int8_t status_53483 = ((__local int8_t *) local_mem_53437)[(int64_t) 0];\n                \n                if (status_53483 == (int8_t) 2) {\n                    if (local_tid_53430 == 0) {\n                        prefix_53480 = ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53484 =", " sext_i64_i32(dynamic_id_53447 - sext_i32_i64(wave_sizze_53432));\n                    \n                    while (slt32(wave_sizze_53432 * -1, readOffset_53484)) {\n                        int32_t read_i_53485 = readOffset_53484 + local_tid_53430;\n                        int64_t aggr_53486 = (int64_t) 0;\n                        int8_t flag_53487 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53485)) {\n                            flag_53487 = ((volatile __global int8_t *) status_flags_mem_53401)[sext_i32_i64(read_i_53485)];\n                            if (flag_53487 == (int8_t) 2) {\n                                aggr_53486 = ((volatile __global int64_t *) incprefixes_mem_53425)[sext_i32_i64(read_i_53485)];\n                            } else if (flag_53487 == (int8_t) 1) {\n                                aggr_53486 = ((volatile __global int64_t *) aggregates_mem_53423)[sext_i32_i64(read_i_53485)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53437)[(int64_t) 4 + sext_i32_i64(local_tid_53430)] = aggr_53486;\n                        ((__local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = flag_53487;\n                        flag_53487 = ((__local int8_t *) local_mem_53437)[sext_i32_i64(wave_sizze_53432) - (int64_t) 1];\n                        if (slt8(flag_53487, (int8_t) 2)) {\n                            int8_t flg_x_53491;\n                            int8_t flg_y_53492;\n                            int64_t eta_p_53488;\n                            int64_t eta_p_53489;\n                            int32_t skip_threads_53493;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53492 = ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)];\n                                eta_p_53489 = ((volatile __local int64_t *) local_mem_53437)[(int", "64_t) 4 + sext_i32_i64(local_tid_53430)];\n                                if ((local_tid_53430 - squot32(local_tid_53430, 32) * 32) == 0) {\n                                    eta_p_53488 = eta_p_53489;\n                                    flg_x_53491 = flg_y_53492;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53493 = 1;\n                                while (slt32(skip_threads_53493, 32)) {\n                                    if (sle32(skip_threads_53493, local_tid_53430 - squot32(local_tid_53430, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53491 = ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53493)];\n                                            eta_p_53488 = ((volatile __local int64_t *) local_mem_53437)[(int64_t) 4 + (sext_i32_i64(local_tid_53430) - sext_i32_i64(skip_threads_53493))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53492 == (int8_t) 2 || flg_y_53492 == (int8_t) 0) {\n                                                flg_x_53491 = flg_y_53492;\n                                                eta_p_53488 = eta_p_53489;\n                                            } else {\n                                                int64_t defunc_0_op_res_53490 = add64(eta_p_53488, eta_p_53489);\n                                                \n                                                eta_p_53488 = defunc_0_op_res_53490;\n                                            }\n                                        }\n                                        // write result\n           ",
                                    "                             {\n                                            ((volatile __local int8_t *) local_mem_53437)[sext_i32_i64(local_tid_53430)] = flg_x_53491;\n                                            flg_y_53492 = flg_x_53491;\n                                            ((volatile __local int64_t *) local_mem_53437)[(int64_t) 4 + sext_i32_i64(local_tid_53430)] = eta_p_53488;\n                                            eta_p_53489 = eta_p_53488;\n                                        }\n                                    }\n                                    skip_threads_53493 *= 2;\n                                }\n                            }\n                        }\n                        flag_53487 = ((__local int8_t *) local_mem_53437)[sext_i32_i64(wave_sizze_53432) - (int64_t) 1];\n                        aggr_53486 = ((__local int64_t *) local_mem_53437)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53432) - (int64_t) 1)];\n                        if (flag_53487 == (int8_t) 2) {\n                            readOffset_53484 = wave_sizze_53432 * -1;\n                        } else if (flag_53487 == (int8_t) 1) {\n                            readOffset_53484 -= wave_sizze_53432;\n                        }\n                        if (slt8((int8_t) 0, flag_53487)) {\n                            int64_t eta_p_53494 = aggr_53486;\n                            int64_t eta_p_53495 = prefix_53480;\n                            int64_t defunc_0_op_res_53496 = add64(eta_p_53494, eta_p_53495);\n                            \n                            prefix_53480 = defunc_0_op_res_53496;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53430 == 0) {\n                    if (boundary_53450 == sext_i64_i32(segscan_tblock_sizze_50266 * chunk_sizze_53398)) {\n                        int64_t eta_p_53497 = prefix_53480;\n                        int64_t eta_p_53498 = acc_53470;\n                   ", "     int64_t defunc_0_op_res_53499 = add64(eta_p_53497, eta_p_53498);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53425)[dynamic_id_53447] = defunc_0_op_res_53499;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53401)[dynamic_id_53447] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53437)[(int64_t) 4] = prefix_53480;\n                    acc_53470 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_53447 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53480 = ((__local int64_t *) local_mem_53437)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53500;\n            int64_t eta_p_53501;\n            int64_t eta_p_53503 = prefix_53480;\n            int64_t eta_p_53504 = acc_53470;\n            \n            if (slt32(local_tid_53430 * chunk_sizze_32b_53434, boundary_53450) && !block_new_sgm_53481) {\n                int64_t defunc_0_op_res_53505 = add64(eta_p_53503, eta_p_53504);\n                \n                eta_p_53500 = defunc_0_op_res_53505;\n            } else {\n                eta_p_53500 = acc_53470;\n            }\n            \n            int32_t stopping_point_53506 = segsizze_compact_53451 - srem32(local_tid_53430 * chunk_sizze_32b_53434 - 1 + segsizze_compact_53451 - boundary_53450, segsizze_compact_53451);\n            \n            for (int64_t i_53507 = 0; i_53507 < chunk_sizze_53398; i_53507++) {\n                if (slt32(sext_i64_i32(i_53507), stopping_point_53506 - 1)) {\n                    eta_p_53501 = private_mem_53452[i_53507];\n                    \n                    int64_t defunc_0_op_res_53502 = add64(eta_p_53500, eta_p_53501);\n                    \n                    private_mem_53452[i_53507] = defunc_0_op_res_53502;\n              ", "  }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53508 = 0; i_53508 < chunk_sizze_53398; i_53508++) {\n                int64_t sharedIdx_53509 = sext_i32_i64(local_tid_53430) * chunk_sizze_53398 + i_53508;\n                int64_t tmp_53510 = private_mem_53452[i_53508];\n                \n                ((__local int64_t *) local_mem_53437)[sharedIdx_53509] = tmp_53510;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53511 = 0; i_53511 < chunk_sizze_53398; i_53511++) {\n                int64_t flat_idx_53512 = thd_offset_53454 + i_53511 * segscan_tblock_sizze_50266;\n                int64_t slice_53513 = dz2082U_35541;\n                int64_t gtid_50270 = flat_idx_53512;\n                int64_t remnant_53514 = flat_idx_53512 - gtid_50270;\n                \n                if (slt64(flat_idx_53512, dz2082U_35541)) {\n                    int64_t tmp_53515 = ((__local int64_t *) local_mem_53437)[flat_idx_53512 - block_offset_53448];\n                    \n                    ((__global int64_t *) mem_52671)[gtid_50270] = tmp_53515;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_50266\n    #undef chunk_sizze_53398\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegmap_50410_dim1, 1, 1)\nvoid make_skylineBase_floatzisegmap_50410(__global int *global_failure, int64_t dim_26085, __global unsigned char *mem_52567, __global unsigned char *mem_52583)\n{\n    #define segmap_tblock_sizze_50406 (make_skylineBase_floatzisegmap_50410zisegmap_tblock_sizze_50406)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53546;\n    int32_t tblock_sizze_53549;\n    int32_t wave_sizze_53548;\n    int32_t block_id_53547;\n    int32_t global_tid_53545;\n    int64_t phys_tid_50410;\n    int64_t global_tid_53550;\n    int64_t slice_53551;\n    int64_t gtid_50409",
                                    ";\n    int64_t remnant_53552;\n    \n    local_tid_53546 = get_local_id(0);\n    tblock_sizze_53549 = get_local_size(0);\n    wave_sizze_53548 = LOCKSTEP_WIDTH;\n    block_id_53547 = get_tblock_id(0);\n    global_tid_53545 = block_id_53547 * tblock_sizze_53549 + local_tid_53546;\n    phys_tid_50410 = sext_i32_i64(global_tid_53545);\n    global_tid_53550 = sext_i32_i64(block_id_53547) * segmap_tblock_sizze_50406 + sext_i32_i64(local_tid_53546);\n    slice_53551 = dim_26085;\n    gtid_50409 = global_tid_53550;\n    remnant_53552 = global_tid_53550 - gtid_50409;\n    if (slt64(gtid_50409, dim_26085)) {\n        int64_t zv_lhs_50412;\n        int64_t tmp_50413;\n        bool cond_50415;\n        int64_t lifted_lambda_res_50416;\n        \n        zv_lhs_50412 = add64((int64_t) -1, gtid_50409);\n        tmp_50413 = smod64(zv_lhs_50412, dim_26085);\n        cond_50415 = gtid_50409 == (int64_t) 0;\n        if (cond_50415) {\n            lifted_lambda_res_50416 = (int64_t) 1;\n        } else {\n            int64_t lifted_lambda_res_50414 = ((__global int64_t *) mem_52567)[tmp_50413];\n            \n            lifted_lambda_res_50416 = lifted_lambda_res_50414;\n        }\n        ((__global int64_t *) mem_52583)[gtid_50409] = lifted_lambda_res_50416;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50406\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegmap_50436_dim1, 1, 1)\nvoid make_skylineBase_floatzisegmap_50436(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, __global unsigned char *mem_52576, __global unsigned char *mem_52586)\n{\n    #define segmap_tblock_sizze_50432 (make_skylineBase_floatzisegmap_50436zisegmap_tblock_sizze_50432)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53555;\n    int32_t tblock_sizze_53558;\n    int32_t wave_sizze_53557;\n    int32_t block_id_53556;\n    int32_t global_tid_53554;\n    int64_t phys_tid_50436;\n    int64_t global_tid_53559;\n    int64_t slice_53560;\n    int64_t gtid_50435;\n    int64_t remnant_5", "3561;\n    \n    local_tid_53555 = get_local_id(0);\n    tblock_sizze_53558 = get_local_size(0);\n    wave_sizze_53557 = LOCKSTEP_WIDTH;\n    block_id_53556 = get_tblock_id(0);\n    global_tid_53554 = block_id_53556 * tblock_sizze_53558 + local_tid_53555;\n    phys_tid_50436 = sext_i32_i64(global_tid_53554);\n    global_tid_53559 = sext_i32_i64(block_id_53556) * segmap_tblock_sizze_50432 + sext_i32_i64(local_tid_53555);\n    slice_53560 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;\n    gtid_50435 = global_tid_53559;\n    remnant_53561 = global_tid_53559 - gtid_50435;\n    if (slt64(gtid_50435, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086)) {\n        int64_t zv_lhs_50438;\n        int64_t tmp_50439;\n        bool cond_50441;\n        int64_t lifted_lambda_res_50442;\n        \n        zv_lhs_50438 = add64((int64_t) -1, gtid_50435);\n        tmp_50439 = smod64(zv_lhs_50438, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086);\n        cond_50441 = gtid_50435 == (int64_t) 0;\n        if (cond_50441) {\n            lifted_lambda_res_50442 = (int64_t) 1;\n        } else {\n            int64_t lifted_lambda_res_50440 = ((__global int64_t *) mem_52576)[tmp_50439];\n            \n            lifted_lambda_res_50442 = lifted_lambda_res_50440;\n        }\n        ((__global int64_t *) mem_52586)[gtid_50435] = lifted_lambda_res_50442;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50432\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegmap_50523_dim1, 1, 1)\nvoid make_skylineBase_floatzisegmap_50523(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_26085, int64_t defunc_res_47853, __global unsigned char *min_per_dim_mem_52561, __global unsigned char *grid_partitions_per_dim_mem_52563, __global unsigned char *mem_52571, __global unsigned char *mem_52583, __global unsigned char *mem_52590)\n{\n    #define segmap_tblock_sizze_50518 (make_skylineBase_floatzisegmap_50523zisegmap_tblock_sizze_50518)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t ", "local_tid_53564;\n    int32_t tblock_sizze_53567;\n    int32_t wave_sizze_53566;\n    int32_t block_id_53565;\n    int32_t global_tid_53563;\n    int64_t phys_tid_50523;\n    int64_t global_tid_53568;\n    int64_t slice_53569;\n    int64_t slice_53570;\n    int64_t gtid_50521;\n    int64_t remnant_53571;\n    int64_t gtid_50522;\n    int64_t remnant_53572;\n    \n    local_tid_53564 = get_local_id(0);\n    tblock_sizze_53567 = get_local_size(0);\n    wave_sizze_53566 = LOCKSTEP_WIDTH;\n    block_id_53565 = get_tblock_id(0);\n    global_tid_53563 = block_id_53565 * tblock_sizze_53567 + local_tid_53564;\n    phys_tid_50523 = sext_i32_i64(global_tid_53563);\n    global_tid_53568 = sext_i32_i64(block_id_53565) * segmap_tblock_sizze_50518 + sext_i32_i64(local_tid_53564);\n    slice_53569 = dim_26085;\n    slice_53570 = defunc_res_47853 * slice_53569;\n    gtid_50521 = squot64(global_tid_53568, slice_53569);\n    remnant_53571 = global_tid_53568 - gtid_50521 * slice_53569;\n    gtid_50522 = remnant_53571;\n    remnant_53572 = remnant_53571 - gtid_50522;\n    if (slt64(gtid_50521, defunc_res_47853) && slt64(gtid_50522, dim_26085)) {\n        int64_t perDim_50530;\n        int64_t preDim_50531;\n        bool zzero_50532;\n        bool nonzzero_50533;\n        bool nonzzero_cert_50534;\n        bool zzero_50536;\n        bool nonzzero_50537;\n        bool nonzzero_cert_50538;\n        int64_t zv_lhs_50535;\n        int64_t from_i64_arg0_50539;\n        float i64_res_50540;\n        float times_arg1_50541;\n        float zt_res_50542;\n        float plus_arg0_50543;\n        float zp_res_50544;\n        \n        perDim_50530 = ((__global int64_t *) grid_partitions_per_dim_mem_52563)[gtid_50522];\n        preDim_50531 = ((__global int64_t *) mem_52583)[gtid_50522];\n        zzero_50532 = preDim_50531 == (int64_t) 0;\n        nonzzero_50533 = !zzero_50532;\n        if (!nonzzero_50533) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    ;\n                }\n      ",
                                    "          return;\n            }\n        }\n        zzero_50536 = perDim_50530 == (int64_t) 0;\n        nonzzero_50537 = !zzero_50536;\n        if (!nonzzero_50537) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    ;\n                }\n                return;\n            }\n        }\n        zv_lhs_50535 = sdiv64(gtid_50521, preDim_50531);\n        from_i64_arg0_50539 = smod64(zv_lhs_50535, perDim_50530);\n        i64_res_50540 = sitofp_i64_f32(from_i64_arg0_50539);\n        times_arg1_50541 = ((__global float *) mem_52571)[gtid_50522];\n        zt_res_50542 = i64_res_50540 * times_arg1_50541;\n        plus_arg0_50543 = ((__global float *) min_per_dim_mem_52561)[gtid_50522];\n        zp_res_50544 = zt_res_50542 + plus_arg0_50543;\n        ((__global float *) mem_52590)[gtid_50521 * dim_26085 + gtid_50522] = zp_res_50544;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50518\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegred_nonseg_50370_dim1, 1, 1)\nvoid make_skylineBase_floatzisegred_nonseg_50370(__global int *global_failure, int64_t dim_26085, int64_t num_tblocks_50365, int64_t num_threads_53377, __global unsigned char *mem_52569, __global unsigned char *mem_52573, __global unsigned char *counters_mem_53373, __global unsigned char *segred_tmp_mem_53375)\n{\n    #define segred_tblock_sizze_50363 (make_skylineBase_floatzisegred_nonseg_50370zisegred_tblock_sizze_50363)\n    #define chunk_sizze_53372 (make_skylineBase_floatzisegred_nonseg_50370zichunk_sizze_53372)\n    \n    volatile __local unsigned char *sync_arr_mem_53385_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53385_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_53383_backing_0 = &shared_mem[sync_arr_mem_53385_backing_1_offset];\n    const int64_t red_arr_i64_mem_53383_backing_0_offset = sync_arr_mem_53385_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_50363 + srem64((int64_t) 8 - srem64((int64_", "t) 8 * segred_tblock_sizze_50363, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53379;\n    int32_t tblock_sizze_53382;\n    int32_t wave_sizze_53381;\n    int32_t block_id_53380;\n    int32_t global_tid_53378;\n    int64_t phys_tid_50370;\n    __local unsigned char *red_arr_i64_mem_53383;\n    __local unsigned char *sync_arr_mem_53385;\n    int64_t dummy_50368;\n    int64_t gtid_50369;\n    int64_t q_53387;\n    int64_t eta_p_block_res_acc_53388;\n    int64_t eta_p_47741;\n    int64_t eta_p_47742;\n    int64_t tblock_id_in_segment_53392;\n    int64_t block_base_offset_53393;\n    int32_t offset_53396;\n    int32_t skip_waves_53397;\n    int64_t eta_p_53389;\n    int64_t eta_p_53390;\n    int32_t old_counter_53398;\n    bool is_last_block_53399;\n    \n    local_tid_53379 = get_local_id(0);\n    tblock_sizze_53382 = get_local_size(0);\n    wave_sizze_53381 = LOCKSTEP_WIDTH;\n    block_id_53380 = get_tblock_id(0);\n    global_tid_53378 = block_id_53380 * tblock_sizze_53382 + local_tid_53379;\n    phys_tid_50370 = sext_i32_i64(global_tid_53378);\n    red_arr_i64_mem_53383 = (__local unsigned char *) red_arr_i64_mem_53383_backing_0;\n    sync_arr_mem_53385 = (__local unsigned char *) sync_arr_mem_53385_backing_1;\n    dummy_50368 = (int64_t) 0;\n    gtid_50369 = (int64_t) 0;\n    q_53387 = sdiv_up64(dim_26085, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_50363 * num_tblocks_50365)) * chunk_sizze_53372);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53388 = (int64_t) 1;\n    }\n    tblock_id_in_segment_53392 = squot64(phys_tid_50370, segred_tblock_sizze_50363);\n    block_base_offset_53393 = tblock_id_in_segment_53392 * q_53387 * segred_tblock_sizze_50363;\n    for (int64_t i_53394 = 0; i_53394 < q_53387; i_53394++) {\n        int64_t block_offset_53395 = block_base_offset_53393 + i_53394 * segred_tblock_sizze_50363;\n        \n        gtid_50369 = phys_tid_50370 + num_threads_53377 * i_53394;\n        i", "f (slt64(gtid_50369, dim_26085)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_50352 = ((__global int64_t *) mem_52569)[gtid_50369];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_47741 = eta_p_block_res_acc_53388;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47742 = x_50352;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t zt_res_47743 = mul64(eta_p_47741, eta_p_47742);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53388 = zt_res_47743;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_block_res_acc_53388;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53397 = 1;\n    offset_53396 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53379, sext_i64_i32(segred_tblock_sizze_50363))) {\n            eta_p_53389 = ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53396)];\n        }\n    }\n    offset_53396 = 1;\n    while (slt32(offset_53396, wave_sizze_53381)) {\n        if (slt32(local_tid_53379 + offset_53396, sext_i64_i32(segred_tblock_sizze_50363)) && ((local_tid_53379 - squot32(local_tid_53379, wave_sizze_53381) * wave_sizze_53381) & (2 * offset_53396 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_53390 = ((volatile __local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53396)];",
                                    "\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53391 = mul64(eta_p_53389, eta_p_53390);\n                \n                eta_p_53389 = zt_res_53391;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_53389;\n            }\n        }\n        offset_53396 *= 2;\n    }\n    while (slt32(skip_waves_53397, squot32(sext_i64_i32(segred_tblock_sizze_50363) + wave_sizze_53381 - 1, wave_sizze_53381))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53396 = skip_waves_53397 * wave_sizze_53381;\n        if (slt32(local_tid_53379 + offset_53396, sext_i64_i32(segred_tblock_sizze_50363)) && ((local_tid_53379 - squot32(local_tid_53379, wave_sizze_53381) * wave_sizze_53381) == 0 && (squot32(local_tid_53379, wave_sizze_53381) & (2 * skip_waves_53397 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53390 = ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53396)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53391 = mul64(eta_p_53389, eta_p_53390);\n                \n                eta_p_53389 = zt_res_53391;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_53389;\n            }\n        }\n        skip_waves_53397 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53379) == (int64_t) 0) {\n            eta_p_block_res_acc_53388 = eta_p_53389;\n        } else {\n            eta_p_block_res_acc_53388 = (int64_t) 1;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_53379 == 0) {\n            ((_", "_global int64_t *) segred_tmp_mem_53375)[sext_i32_i64(block_id_53380)] = eta_p_block_res_acc_53388;\n            mem_fence_global();\n            old_counter_53398 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53373)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53385)[(int64_t) 0] = old_counter_53398 == sext_i64_i32(num_tblocks_50365 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53399 = ((__local bool *) sync_arr_mem_53385)[(int64_t) 0];\n    if (is_last_block_53399) {\n        if (local_tid_53379 == 0) {\n            old_counter_53398 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53373)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_50365));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53400 = sdiv_up64(num_tblocks_50365, segred_tblock_sizze_50363);\n            \n            eta_p_47741 = (int64_t) 1;\n            for (int64_t i_53401 = 0; i_53401 < read_per_thread_53400; i_53401++) {\n                int64_t block_res_id_53402 = sext_i32_i64(local_tid_53379) * read_per_thread_53400 + i_53401;\n                int64_t index_of_block_res_53403 = block_res_id_53402;\n                \n                if (slt64(block_res_id_53402, num_tblocks_50365)) {\n                    eta_p_47742 = ((__global int64_t *) segred_tmp_mem_53375)[index_of_block_res_53403];\n                    \n                    int64_t zt_res_47743 = mul64(eta_p_47741, eta_p_47742);\n                    \n                    eta_p_47741 = zt_res_47743;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_47741;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_53404;\n            int32_t skip_waves_53405 = 1;\n            int64_t eta_p_53389;\n            int64_t eta_p_53390;\n            \n   ", "         offset_53404 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_53379, sext_i64_i32(segred_tblock_sizze_50363))) {\n                    eta_p_53389 = ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53404)];\n                }\n            }\n            offset_53404 = 1;\n            while (slt32(offset_53404, wave_sizze_53381)) {\n                if (slt32(local_tid_53379 + offset_53404, sext_i64_i32(segred_tblock_sizze_50363)) && ((local_tid_53379 - squot32(local_tid_53379, wave_sizze_53381) * wave_sizze_53381) & (2 * offset_53404 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53390 = ((volatile __local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53404)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53391 = mul64(eta_p_53389, eta_p_53390);\n                        \n                        eta_p_53389 = zt_res_53391;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_53389;\n                    }\n                }\n                offset_53404 *= 2;\n            }\n            while (slt32(skip_waves_53405, squot32(sext_i64_i32(segred_tblock_sizze_50363) + wave_sizze_53381 - 1, wave_sizze_53381))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53404 = skip_waves_53405 * wave_sizze_53381;\n                if (slt32(local_tid_53379 + offset_53404, sext_i64_i32(segred_tblock_sizze_50363)) && ((local_tid_53379 - squot32(local_tid_53379, wave_sizze_53381) * wave_sizze_53381) == 0 && (squot32(local_tid_53379, wave_sizze_53381) & (2 * skip_waves_53405 - 1)) == 0)) {\n                    // read array element\n                  ",
                                    "  {\n                        eta_p_53390 = ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379 + offset_53404)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53391 = mul64(eta_p_53389, eta_p_53390);\n                        \n                        eta_p_53389 = zt_res_53391;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_53383)[sext_i32_i64(local_tid_53379)] = eta_p_53389;\n                    }\n                }\n                skip_waves_53405 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53379 == 0) {\n                    ((__global int64_t *) mem_52573)[(int64_t) 0] = eta_p_53389;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_50363\n    #undef chunk_sizze_53372\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegred_nonseg_50390_dim1, 1, 1)\nvoid make_skylineBase_floatzisegred_nonseg_50390(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, int64_t num_tblocks_50385, int64_t num_threads_53515, __global unsigned char *mem_52578, __global unsigned char *mem_52580, __global unsigned char *counters_mem_53511, __global unsigned char *segred_tmp_mem_53513)\n{\n    #define segred_tblock_sizze_50383 (make_skylineBase_floatzisegred_nonseg_50390zisegred_tblock_sizze_50383)\n    #define chunk_sizze_53510 (make_skylineBase_floatzisegred_nonseg_50390zichunk_sizze_53510)\n    \n    volatile __local unsigned char *sync_arr_mem_53523_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53523_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_53521_backing_0 = &shared_mem[sync_arr_mem_53523_backing_1_offset];\n    const int64_t red_arr_i64_mem_53521_", "backing_0_offset = sync_arr_mem_53523_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_50383 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50383, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53517;\n    int32_t tblock_sizze_53520;\n    int32_t wave_sizze_53519;\n    int32_t block_id_53518;\n    int32_t global_tid_53516;\n    int64_t phys_tid_50390;\n    __local unsigned char *red_arr_i64_mem_53521;\n    __local unsigned char *sync_arr_mem_53523;\n    int64_t dummy_50388;\n    int64_t gtid_50389;\n    int64_t q_53525;\n    int64_t eta_p_block_res_acc_53526;\n    int64_t eta_p_47748;\n    int64_t eta_p_47749;\n    int64_t tblock_id_in_segment_53530;\n    int64_t block_base_offset_53531;\n    int32_t offset_53534;\n    int32_t skip_waves_53535;\n    int64_t eta_p_53527;\n    int64_t eta_p_53528;\n    int32_t old_counter_53536;\n    bool is_last_block_53537;\n    \n    local_tid_53517 = get_local_id(0);\n    tblock_sizze_53520 = get_local_size(0);\n    wave_sizze_53519 = LOCKSTEP_WIDTH;\n    block_id_53518 = get_tblock_id(0);\n    global_tid_53516 = block_id_53518 * tblock_sizze_53520 + local_tid_53517;\n    phys_tid_50390 = sext_i32_i64(global_tid_53516);\n    red_arr_i64_mem_53521 = (__local unsigned char *) red_arr_i64_mem_53521_backing_0;\n    sync_arr_mem_53523 = (__local unsigned char *) sync_arr_mem_53523_backing_1;\n    dummy_50388 = (int64_t) 0;\n    gtid_50389 = (int64_t) 0;\n    q_53525 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_50383 * num_tblocks_50385)) * chunk_sizze_53510);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53526 = (int64_t) 1;\n    }\n    tblock_id_in_segment_53530 = squot64(phys_tid_50390, segred_tblock_sizze_50383);\n    block_base_offset_53531 = tblock_id_in_segment_53530 * q_53525 * segred_tblock_sizze_50383;\n    for (int64_t i_53532 = 0; i_53532 < q_53525; i_53532++) {\n        int64_t block_", "offset_53533 = block_base_offset_53531 + i_53532 * segred_tblock_sizze_50383;\n        \n        gtid_50389 = phys_tid_50390 + num_threads_53515 * i_53532;\n        if (slt64(gtid_50389, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_50372 = ((__global int64_t *) mem_52578)[gtid_50389];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_47748 = eta_p_block_res_acc_53526;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47749 = x_50372;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t zt_res_47750 = mul64(eta_p_47748, eta_p_47749);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53526 = zt_res_47750;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_block_res_acc_53526;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53535 = 1;\n    offset_53534 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53517, sext_i64_i32(segred_tblock_sizze_50383))) {\n            eta_p_53527 = ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53534)];\n        }\n    }\n    offset_53534 = 1;\n    while (slt32(offset_53534, wave_sizze_53519)) {\n        if (slt32(local_tid_53517 + offset_53534, sext_i64_i32(segred_tblock_sizze_50383)) && ((local_tid_53517 - squot32(local_tid_53517, wave_sizze_53519) * wave_sizze_53519) & (2 * offset_53534 ",
                                    "- 1)) == 0) {\n            // read array element\n            {\n                eta_p_53528 = ((volatile __local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53534)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53529 = mul64(eta_p_53527, eta_p_53528);\n                \n                eta_p_53527 = zt_res_53529;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_53527;\n            }\n        }\n        offset_53534 *= 2;\n    }\n    while (slt32(skip_waves_53535, squot32(sext_i64_i32(segred_tblock_sizze_50383) + wave_sizze_53519 - 1, wave_sizze_53519))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53534 = skip_waves_53535 * wave_sizze_53519;\n        if (slt32(local_tid_53517 + offset_53534, sext_i64_i32(segred_tblock_sizze_50383)) && ((local_tid_53517 - squot32(local_tid_53517, wave_sizze_53519) * wave_sizze_53519) == 0 && (squot32(local_tid_53517, wave_sizze_53519) & (2 * skip_waves_53535 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53528 = ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53534)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53529 = mul64(eta_p_53527, eta_p_53528);\n                \n                eta_p_53527 = zt_res_53529;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_53527;\n            }\n        }\n        skip_waves_53535 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53517) == (int64_t) 0) {\n            eta_p_block_res_acc_53526 = eta_p_53527;\n        } else {\n", "            eta_p_block_res_acc_53526 = (int64_t) 1;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_53517 == 0) {\n            ((__global int64_t *) segred_tmp_mem_53513)[sext_i32_i64(block_id_53518)] = eta_p_block_res_acc_53526;\n            mem_fence_global();\n            old_counter_53536 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53511)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53523)[(int64_t) 0] = old_counter_53536 == sext_i64_i32(num_tblocks_50385 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53537 = ((__local bool *) sync_arr_mem_53523)[(int64_t) 0];\n    if (is_last_block_53537) {\n        if (local_tid_53517 == 0) {\n            old_counter_53536 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53511)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_50385));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53538 = sdiv_up64(num_tblocks_50385, segred_tblock_sizze_50383);\n            \n            eta_p_47748 = (int64_t) 1;\n            for (int64_t i_53539 = 0; i_53539 < read_per_thread_53538; i_53539++) {\n                int64_t block_res_id_53540 = sext_i32_i64(local_tid_53517) * read_per_thread_53538 + i_53539;\n                int64_t index_of_block_res_53541 = block_res_id_53540;\n                \n                if (slt64(block_res_id_53540, num_tblocks_50385)) {\n                    eta_p_47749 = ((__global int64_t *) segred_tmp_mem_53513)[index_of_block_res_53541];\n                    \n                    int64_t zt_res_47750 = mul64(eta_p_47748, eta_p_47749);\n                    \n                    eta_p_47748 = zt_res_47750;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_47748;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce", " the per-block results\n        {\n            int32_t offset_53542;\n            int32_t skip_waves_53543 = 1;\n            int64_t eta_p_53527;\n            int64_t eta_p_53528;\n            \n            offset_53542 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_53517, sext_i64_i32(segred_tblock_sizze_50383))) {\n                    eta_p_53527 = ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53542)];\n                }\n            }\n            offset_53542 = 1;\n            while (slt32(offset_53542, wave_sizze_53519)) {\n                if (slt32(local_tid_53517 + offset_53542, sext_i64_i32(segred_tblock_sizze_50383)) && ((local_tid_53517 - squot32(local_tid_53517, wave_sizze_53519) * wave_sizze_53519) & (2 * offset_53542 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53528 = ((volatile __local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53542)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53529 = mul64(eta_p_53527, eta_p_53528);\n                        \n                        eta_p_53527 = zt_res_53529;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_53527;\n                    }\n                }\n                offset_53542 *= 2;\n            }\n            while (slt32(skip_waves_53543, squot32(sext_i64_i32(segred_tblock_sizze_50383) + wave_sizze_53519 - 1, wave_sizze_53519))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53542 = skip_waves_53543 * wave_sizze_53519;\n                if (slt32(local_tid_53517 + offset_53542, sext_i64_i32(segred_tblock_sizze_50383)) && ((local_tid_53517 - squot32(local_tid_53517",
                                    ", wave_sizze_53519) * wave_sizze_53519) == 0 && (squot32(local_tid_53517, wave_sizze_53519) & (2 * skip_waves_53543 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_53528 = ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517 + offset_53542)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53529 = mul64(eta_p_53527, eta_p_53528);\n                        \n                        eta_p_53527 = zt_res_53529;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_53521)[sext_i32_i64(local_tid_53517)] = eta_p_53527;\n                    }\n                }\n                skip_waves_53543 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53517 == 0) {\n                    ((__global int64_t *) mem_52580)[(int64_t) 0] = eta_p_53527;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_50383\n    #undef chunk_sizze_53510\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegscan_50360_dim1, 1, 1)\nvoid make_skylineBase_floatzisegscan_50360(__global int *global_failure, int64_t dim_26085, int64_t num_tblocks_50357, int64_t num_virt_blocks_53234, int64_t num_virt_threads_53235, __global unsigned char *min_per_dim_mem_52561, __global unsigned char *max_per_dim_mem_52562, __global unsigned char *grid_partitions_per_dim_mem_52563, __global unsigned char *mem_52567, __global unsigned char *mem_52569, __global unsigned char *mem_52571, __global unsigned char *status_flags_mem_53236, __global unsigned char *aggregates_mem_53258, __global unsigned char *incprefixes_mem_53260, __global unsigned char *global_dynid_mem_53262)\n{\n    #define segscan_tblock_sizze_50355 (mak", "e_skylineBase_floatzisegscan_50360zisegscan_tblock_sizze_50355)\n    #define chunk_sizze_53233 (make_skylineBase_floatzisegscan_50360zichunk_sizze_53233)\n    \n    volatile __local unsigned char *local_mem_53292_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53292_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50355), chunk_sizze_53233 * segscan_tblock_sizze_50355 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50355), chunk_sizze_53233 * segscan_tblock_sizze_50355 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53285;\n    int32_t tblock_sizze_53288;\n    int32_t wave_sizze_53287;\n    int32_t block_id_53286;\n    int32_t global_tid_53284;\n    int64_t phys_tid_50360;\n    int32_t chunk_sizze_32b_53289;\n    int64_t byte_offsets_53290;\n    int64_t warp_byte_offset_53291;\n    __local unsigned char *local_mem_53292;\n    int64_t trans_arr_len_53293;\n    int64_t phys_block_id_53299;\n    int64_t virtloop_bound_53300;\n    \n    local_tid_53285 = get_local_id(0);\n    tblock_sizze_53288 = get_local_size(0);\n    wave_sizze_53287 = LOCKSTEP_WIDTH;\n    block_id_53286 = get_tblock_id(0);\n    global_tid_53284 = block_id_53286 * tblock_sizze_53288 + local_tid_53285;\n    phys_tid_50360 = sext_i32_i64(global_tid_53284);\n    chunk_sizze_32b_53289 = sext_i64_i32(chunk_sizze_53233);\n    byte_offsets_53290 = segscan_tblock_sizze_50355 * (int64_t) 8;\n    warp_byte_offset_53291 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53292 = (__local unsigned char *) local_mem_53292_backing_0;\n    trans_arr_len_53293 = chunk_sizze_53233 * segscan_tblock_sizze_50355;\n    phys_block_id_53299 = get_tblock_id(0);\n    virtloop_bound_53300 = sdiv_up64(num_virt_blocks_53234 - phys_block_id_53299, num_tblocks_50357);\n    for (int64_t virtloop_i_53301 = 0; virtloop_i_53301 < virtloop_bound_53300; virtl", "oop_i_53301++) {\n        int64_t dynamic_id_53302;\n        int64_t block_offset_53303;\n        int64_t sgm_idx_53304;\n        int32_t boundary_53305;\n        int32_t segsizze_compact_53306;\n        int64_t private_mem_53307[chunk_sizze_53233];\n        int64_t thd_offset_53309;\n        int64_t acc_53325;\n        int64_t prefix_53335;\n        bool block_new_sgm_53336;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53285 == 0) {\n                dynamic_id_53302 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53262)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53292)[(int64_t) 0] = dynamic_id_53302;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53302 == num_virt_blocks_53234 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53262)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53302 = ((__local int32_t *) local_mem_53292)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53303 = dynamic_id_53302 * chunk_sizze_53233 * segscan_tblock_sizze_50355;\n        sgm_idx_53304 = smod64(block_offset_53303, dim_26085);\n        boundary_53305 = sext_i64_i32(smin64(chunk_sizze_53233 * segscan_tblock_sizze_50355, dim_26085 - sgm_idx_53304));\n        segsizze_compact_53306 = sext_i64_i32(smin64(chunk_sizze_53233 * segscan_tblock_sizze_50355, dim_26085));\n        thd_offset_53309 = block_offset_53303 + sext_i32_i64(local_tid_53285);\n        // Load and map\n        {\n            for (int64_t i_53310 = 0; i_53310 < chunk_sizze_53233; i_53310++) {\n                int64_t virt_tid_53311 = thd_offset_53309 + i_53310 * segscan_tblock_sizze_50355;\n                int64_t",
                                    " slice_53312 = dim_26085;\n                int64_t gtid_50359 = virt_tid_53311;\n                int64_t remnant_53313 = virt_tid_53311 - gtid_50359;\n                \n                if (slt64(virt_tid_53311, dim_26085)) {\n                    int64_t x_47836 = ((__global int64_t *) grid_partitions_per_dim_mem_52563)[gtid_50359];\n                    float eta_p_47837 = ((__global float *) min_per_dim_mem_52561)[gtid_50359];\n                    float eta_p_47838 = ((__global float *) max_per_dim_mem_52562)[gtid_50359];\n                    float i64_res_47841 = sitofp_i64_f32(x_47836);\n                    float zm_res_47843 = eta_p_47838 - eta_p_47837;\n                    float zs_res_47844 = zm_res_47843 / i64_res_47841;\n                    \n                    ((__global int64_t *) mem_52569)[gtid_50359] = x_47836;\n                    ((__global float *) mem_52571)[gtid_50359] = zs_res_47844;\n                    private_mem_53307[i_53310] = x_47836;\n                } else {\n                    private_mem_53307[i_53310] = (int64_t) 1;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53314 = 0; i_53314 < chunk_sizze_53233; i_53314++) {\n                int64_t sharedIdx_53315 = sext_i32_i64(local_tid_53285) + i_53314 * segscan_tblock_sizze_50355;\n                int64_t tmp_53316 = private_mem_53307[i_53314];\n                \n                ((__local int64_t *) local_mem_53292)[sharedIdx_53315] = tmp_53316;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53317 = 0; i_53317 < chunk_sizze_53233; i_53317++) {\n                int64_t sharedIdx_53318 = sext_i32_i64(local_tid_53285) * chunk_sizze_53233 + i_53317;\n                int64_t tmp_53319 = ((__local int64_t *) local_mem_53292)[sharedIdx_53318];\n                \n                private_mem_53307[i_53317] = tmp_53319;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n  ", "      // Per thread scan\n        {\n            for (int64_t i_53320 = 0; i_53320 < chunk_sizze_53233 - (int64_t) 1; i_53320++) {\n                int64_t eta_p_46410;\n                int64_t eta_p_46411;\n                \n                eta_p_46410 = private_mem_53307[i_53320];\n                eta_p_46411 = private_mem_53307[i_53320 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_46412 = mul64(eta_p_46410, eta_p_46411);\n                \n                private_mem_53307[i_53320 + (int64_t) 1] = defunc_0_op_res_46412;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53321 = private_mem_53307[chunk_sizze_53233 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = tmp_53321;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53322;\n            int64_t eta_p_53323;\n            int64_t eta_p_53326;\n            int64_t eta_p_53327;\n            bool ltid_in_bounds_53329 = slt64(sext_i32_i64(local_tid_53285), num_virt_threads_53235);\n            int32_t skip_threads_53330;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53329) {\n                    eta_p_53323 = ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)];\n                    if ((local_tid_53285 - squot32(local_tid_53285, 32) * 32) == 0) {\n                        eta_p_53322 = eta_p_53323;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53330 = 1;\n                while (slt32(skip_threads_53330, 32)) {\n                    bool thread_active_53331 = sle32(skip_threads_53330, local_tid_53285 - squot32(local_tid_53285, 32) * 32) && ltid_in_bounds_53329;\n                    \n                    if (thread_active_53331) {", "\n                        // read operands\n                        {\n                            eta_p_53322 = ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285) - sext_i32_i64(skip_threads_53330)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53331) {\n                            int64_t defunc_0_op_res_53324 = mul64(eta_p_53322, eta_p_53323);\n                            \n                            eta_p_53322 = defunc_0_op_res_53324;\n                        }\n                    }\n                    if (sle32(wave_sizze_53287, skip_threads_53330)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53331) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = eta_p_53322;\n                            eta_p_53323 = eta_p_53322;\n                        }\n                    }\n                    if (sle32(wave_sizze_53287, skip_threads_53330)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53330 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53285 - squot32(local_tid_53285, 32) * 32) == 31 && ltid_in_bounds_53329) {\n                    ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(squot32(local_tid_53285, 32))] = eta_p_53322;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53332;\n                \n                // read input for in-block scan\n                {\n ",
                                    "                   if (squot32(local_tid_53285, 32) == 0 && ltid_in_bounds_53329) {\n                        eta_p_53327 = ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)];\n                        if ((local_tid_53285 - squot32(local_tid_53285, 32) * 32) == 0) {\n                            eta_p_53326 = eta_p_53327;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53332 = 1;\n                    while (slt32(skip_threads_53332, 32)) {\n                        bool thread_active_53333 = sle32(skip_threads_53332, local_tid_53285 - squot32(local_tid_53285, 32) * 32) && (squot32(local_tid_53285, 32) == 0 && ltid_in_bounds_53329);\n                        \n                        if (thread_active_53333) {\n                            // read operands\n                            {\n                                eta_p_53326 = ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285) - sext_i32_i64(skip_threads_53332)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53333) {\n                                int64_t defunc_0_op_res_53328 = mul64(eta_p_53326, eta_p_53327);\n                                \n                                eta_p_53326 = defunc_0_op_res_53328;\n                            }\n                        }\n                        if (sle32(wave_sizze_53287, skip_threads_53332)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53333) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = eta_p_53326;\n                                eta_p_53327 = eta_p", "_53326;\n                            }\n                        }\n                        if (sle32(wave_sizze_53287, skip_threads_53332)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53332 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53334 = squot32(local_tid_53285, 32) == 0 || !ltid_in_bounds_53329;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53334) {\n                        eta_p_53323 = eta_p_53322;\n                        eta_p_53322 = ((__local int64_t *) local_mem_53292)[sext_i32_i64(squot32(local_tid_53285, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53334) {\n                        int64_t defunc_0_op_res_53324 = mul64(eta_p_53322, eta_p_53323);\n                        \n                        eta_p_53322 = defunc_0_op_res_53324;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53334) {\n                        ((__local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = eta_p_53322;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53285, 32) == 0 && ltid_in_bounds_53329) {\n                    ((__local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = eta_p_53323;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53285 == 0) {\n                acc_53325 = ((__local int64_t *) local_mem_53292)[segscan_tblock_siz", "ze_50355 - (int64_t) 1];\n            } else {\n                acc_53325 = ((__local int64_t *) local_mem_53292)[sext_i32_i64(local_tid_53285) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53335 = (int64_t) 1;\n        block_new_sgm_53336 = sgm_idx_53304 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53336 && local_tid_53285 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53260)[dynamic_id_53302] = acc_53325;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53236)[dynamic_id_53302] = (int8_t) 2;\n                acc_53325 = (int64_t) 1;\n            }\n            if (!block_new_sgm_53336 && slt32(local_tid_53285, wave_sizze_53287)) {\n                if (local_tid_53285 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53258)[dynamic_id_53302] = acc_53325;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53236)[dynamic_id_53302] = (int8_t) 1;\n                    \n                    int8_t tmp_53337 = ((volatile __global int8_t *) status_flags_mem_53236)[dynamic_id_53302 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53292)[(int64_t) 0] = tmp_53337;\n                }\n                mem_fence_local();\n                \n                int8_t status_53338 = ((__local int8_t *) local_mem_53292)[(int64_t) 0];\n                \n                if (status_53338 == (int8_t) 2) {\n                    if (local_tid_53285 == 0) {\n                        prefix_53335 = ((volatile __global int64_t *) incprefixes_mem_53260)[dynamic_id_53302 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53339 = sext_i64_i32(dynamic_id_53302 - sext_i32_i64(wave_sizze_53287));\n                    \n                    while (slt32(wave_sizze_53287 * -1, readOffset_",
                                    "53339)) {\n                        int32_t read_i_53340 = readOffset_53339 + local_tid_53285;\n                        int64_t aggr_53341 = (int64_t) 1;\n                        int8_t flag_53342 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53340)) {\n                            flag_53342 = ((volatile __global int8_t *) status_flags_mem_53236)[sext_i32_i64(read_i_53340)];\n                            if (flag_53342 == (int8_t) 2) {\n                                aggr_53341 = ((volatile __global int64_t *) incprefixes_mem_53260)[sext_i32_i64(read_i_53340)];\n                            } else if (flag_53342 == (int8_t) 1) {\n                                aggr_53341 = ((volatile __global int64_t *) aggregates_mem_53258)[sext_i32_i64(read_i_53340)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53292)[(int64_t) 4 + sext_i32_i64(local_tid_53285)] = aggr_53341;\n                        ((__local int8_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = flag_53342;\n                        flag_53342 = ((__local int8_t *) local_mem_53292)[sext_i32_i64(wave_sizze_53287) - (int64_t) 1];\n                        if (slt8(flag_53342, (int8_t) 2)) {\n                            int8_t flg_x_53346;\n                            int8_t flg_y_53347;\n                            int64_t eta_p_53343;\n                            int64_t eta_p_53344;\n                            int32_t skip_threads_53348;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53347 = ((volatile __local int8_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)];\n                                eta_p_53344 = ((volatile __local int64_t *) local_mem_53292)[(int64_t) 4 + sext_i32_i64(local_tid_53285)];\n                                if ((local_tid_53285 - squot32(local_tid_53285, 32) * 32) == 0) {\n              ", "                      eta_p_53343 = eta_p_53344;\n                                    flg_x_53346 = flg_y_53347;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53348 = 1;\n                                while (slt32(skip_threads_53348, 32)) {\n                                    if (sle32(skip_threads_53348, local_tid_53285 - squot32(local_tid_53285, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53346 = ((volatile __local int8_t *) local_mem_53292)[sext_i32_i64(local_tid_53285) - sext_i32_i64(skip_threads_53348)];\n                                            eta_p_53343 = ((volatile __local int64_t *) local_mem_53292)[(int64_t) 4 + (sext_i32_i64(local_tid_53285) - sext_i32_i64(skip_threads_53348))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53347 == (int8_t) 2 || flg_y_53347 == (int8_t) 0) {\n                                                flg_x_53346 = flg_y_53347;\n                                                eta_p_53343 = eta_p_53344;\n                                            } else {\n                                                int64_t defunc_0_op_res_53345 = mul64(eta_p_53343, eta_p_53344);\n                                                \n                                                eta_p_53343 = defunc_0_op_res_53345;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53292)[sext_i32_i64(local_tid_53285)] = ", "flg_x_53346;\n                                            flg_y_53347 = flg_x_53346;\n                                            ((volatile __local int64_t *) local_mem_53292)[(int64_t) 4 + sext_i32_i64(local_tid_53285)] = eta_p_53343;\n                                            eta_p_53344 = eta_p_53343;\n                                        }\n                                    }\n                                    skip_threads_53348 *= 2;\n                                }\n                            }\n                        }\n                        flag_53342 = ((__local int8_t *) local_mem_53292)[sext_i32_i64(wave_sizze_53287) - (int64_t) 1];\n                        aggr_53341 = ((__local int64_t *) local_mem_53292)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53287) - (int64_t) 1)];\n                        if (flag_53342 == (int8_t) 2) {\n                            readOffset_53339 = wave_sizze_53287 * -1;\n                        } else if (flag_53342 == (int8_t) 1) {\n                            readOffset_53339 -= wave_sizze_53287;\n                        }\n                        if (slt8((int8_t) 0, flag_53342)) {\n                            int64_t eta_p_53349 = aggr_53341;\n                            int64_t eta_p_53350 = prefix_53335;\n                            int64_t defunc_0_op_res_53351 = mul64(eta_p_53349, eta_p_53350);\n                            \n                            prefix_53335 = defunc_0_op_res_53351;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53285 == 0) {\n                    if (boundary_53305 == sext_i64_i32(segscan_tblock_sizze_50355 * chunk_sizze_53233)) {\n                        int64_t eta_p_53352 = prefix_53335;\n                        int64_t eta_p_53353 = acc_53325;\n                        int64_t defunc_0_op_res_53354 = mul64(eta_p_53352, eta_p_53353);\n                        \n                        ((volatile __global int64_t *) incp",
                                    "refixes_mem_53260)[dynamic_id_53302] = defunc_0_op_res_53354;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53236)[dynamic_id_53302] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53292)[(int64_t) 4] = prefix_53335;\n                    acc_53325 = (int64_t) 1;\n                }\n            }\n            if (!(dynamic_id_53302 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53335 = ((__local int64_t *) local_mem_53292)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53355;\n            int64_t eta_p_53356;\n            int64_t eta_p_53358 = prefix_53335;\n            int64_t eta_p_53359 = acc_53325;\n            \n            if (slt32(local_tid_53285 * chunk_sizze_32b_53289, boundary_53305) && !block_new_sgm_53336) {\n                int64_t defunc_0_op_res_53360 = mul64(eta_p_53358, eta_p_53359);\n                \n                eta_p_53355 = defunc_0_op_res_53360;\n            } else {\n                eta_p_53355 = acc_53325;\n            }\n            \n            int32_t stopping_point_53361 = segsizze_compact_53306 - srem32(local_tid_53285 * chunk_sizze_32b_53289 - 1 + segsizze_compact_53306 - boundary_53305, segsizze_compact_53306);\n            \n            for (int64_t i_53362 = 0; i_53362 < chunk_sizze_53233; i_53362++) {\n                if (slt32(sext_i64_i32(i_53362), stopping_point_53361 - 1)) {\n                    eta_p_53356 = private_mem_53307[i_53362];\n                    \n                    int64_t defunc_0_op_res_53357 = mul64(eta_p_53355, eta_p_53356);\n                    \n                    private_mem_53307[i_53362] = defunc_0_op_res_53357;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53363", " = 0; i_53363 < chunk_sizze_53233; i_53363++) {\n                int64_t sharedIdx_53364 = sext_i32_i64(local_tid_53285) * chunk_sizze_53233 + i_53363;\n                int64_t tmp_53365 = private_mem_53307[i_53363];\n                \n                ((__local int64_t *) local_mem_53292)[sharedIdx_53364] = tmp_53365;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53366 = 0; i_53366 < chunk_sizze_53233; i_53366++) {\n                int64_t flat_idx_53367 = thd_offset_53309 + i_53366 * segscan_tblock_sizze_50355;\n                int64_t slice_53368 = dim_26085;\n                int64_t gtid_50359 = flat_idx_53367;\n                int64_t remnant_53369 = flat_idx_53367 - gtid_50359;\n                \n                if (slt64(flat_idx_53367, dim_26085)) {\n                    int64_t tmp_53370 = ((__local int64_t *) local_mem_53292)[flat_idx_53367 - block_offset_53303];\n                    \n                    ((__global int64_t *) mem_52567)[gtid_50359] = tmp_53370;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_50355\n    #undef chunk_sizze_53233\n}\nFUTHARK_KERNEL_SIZED(make_skylineBase_floatzisegscan_50380_dim1, 1, 1)\nvoid make_skylineBase_floatzisegscan_50380(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, int64_t num_tblocks_50377, int64_t num_virt_blocks_53412, int64_t num_virt_threads_53413, __global unsigned char *angle_partitions_per_dim_mem_52564, __global unsigned char *mem_52576, __global unsigned char *mem_52578, __global unsigned char *status_flags_mem_53414, __global unsigned char *aggregates_mem_53416, __global unsigned char *incprefixes_mem_53418, __global unsigned char *global_dynid_mem_53420)\n{\n    #define segscan_tblock_sizze_50375 (make_skylineBase_floatzisegscan_50380zisegscan_tblock_sizze_50375)\n    #define chunk_sizze_53411 (make_skylineBase_floatzisegscan_50380zichunk_sizze_53411)\n    \n ", "   volatile __local unsigned char *local_mem_53430_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53430_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50375), chunk_sizze_53411 * segscan_tblock_sizze_50375 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50375), chunk_sizze_53411 * segscan_tblock_sizze_50375 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53423;\n    int32_t tblock_sizze_53426;\n    int32_t wave_sizze_53425;\n    int32_t block_id_53424;\n    int32_t global_tid_53422;\n    int64_t phys_tid_50380;\n    int32_t chunk_sizze_32b_53427;\n    int64_t byte_offsets_53428;\n    int64_t warp_byte_offset_53429;\n    __local unsigned char *local_mem_53430;\n    int64_t trans_arr_len_53431;\n    int64_t phys_block_id_53437;\n    int64_t virtloop_bound_53438;\n    \n    local_tid_53423 = get_local_id(0);\n    tblock_sizze_53426 = get_local_size(0);\n    wave_sizze_53425 = LOCKSTEP_WIDTH;\n    block_id_53424 = get_tblock_id(0);\n    global_tid_53422 = block_id_53424 * tblock_sizze_53426 + local_tid_53423;\n    phys_tid_50380 = sext_i32_i64(global_tid_53422);\n    chunk_sizze_32b_53427 = sext_i64_i32(chunk_sizze_53411);\n    byte_offsets_53428 = segscan_tblock_sizze_50375 * (int64_t) 8;\n    warp_byte_offset_53429 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53430 = (__local unsigned char *) local_mem_53430_backing_0;\n    trans_arr_len_53431 = chunk_sizze_53411 * segscan_tblock_sizze_50375;\n    phys_block_id_53437 = get_tblock_id(0);\n    virtloop_bound_53438 = sdiv_up64(num_virt_blocks_53412 - phys_block_id_53437, num_tblocks_50377);\n    for (int64_t virtloop_i_53439 = 0; virtloop_i_53439 < virtloop_bound_53438; virtloop_i_53439++) {\n        int64_t dynamic_id_53440;\n        int64_t block_offset_53441;\n        int64_t sgm_idx_53442;\n        int32_t boundary_53443;\n        i",
                                    "nt32_t segsizze_compact_53444;\n        int64_t private_mem_53445[chunk_sizze_53411];\n        int64_t thd_offset_53447;\n        int64_t acc_53463;\n        int64_t prefix_53473;\n        bool block_new_sgm_53474;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53423 == 0) {\n                dynamic_id_53440 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53420)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53430)[(int64_t) 0] = dynamic_id_53440;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53440 == num_virt_blocks_53412 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53420)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53440 = ((__local int32_t *) local_mem_53430)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53441 = dynamic_id_53440 * chunk_sizze_53411 * segscan_tblock_sizze_50375;\n        sgm_idx_53442 = smod64(block_offset_53441, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086);\n        boundary_53443 = sext_i64_i32(smin64(chunk_sizze_53411 * segscan_tblock_sizze_50375, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086 - sgm_idx_53442));\n        segsizze_compact_53444 = sext_i64_i32(smin64(chunk_sizze_53411 * segscan_tblock_sizze_50375, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086));\n        thd_offset_53447 = block_offset_53441 + sext_i32_i64(local_tid_53423);\n        // Load and map\n        {\n            for (int64_t i_53448 = 0; i_53448 < chunk_sizze_53411; i_53448++) {\n                int64_t virt_tid_53449 = thd_offset_53447 + i_53448 * segscan_tblock_sizze_50375;\n                int64_t slice_53450 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;\n                int64", "_t gtid_50379 = virt_tid_53449;\n                int64_t remnant_53451 = virt_tid_53449 - gtid_50379;\n                \n                if (slt64(virt_tid_53449, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086)) {\n                    int64_t x_47848 = ((__global int64_t *) angle_partitions_per_dim_mem_52564)[gtid_50379];\n                    \n                    ((__global int64_t *) mem_52578)[gtid_50379] = x_47848;\n                    private_mem_53445[i_53448] = x_47848;\n                } else {\n                    private_mem_53445[i_53448] = (int64_t) 1;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53452 = 0; i_53452 < chunk_sizze_53411; i_53452++) {\n                int64_t sharedIdx_53453 = sext_i32_i64(local_tid_53423) + i_53452 * segscan_tblock_sizze_50375;\n                int64_t tmp_53454 = private_mem_53445[i_53452];\n                \n                ((__local int64_t *) local_mem_53430)[sharedIdx_53453] = tmp_53454;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53455 = 0; i_53455 < chunk_sizze_53411; i_53455++) {\n                int64_t sharedIdx_53456 = sext_i32_i64(local_tid_53423) * chunk_sizze_53411 + i_53455;\n                int64_t tmp_53457 = ((__local int64_t *) local_mem_53430)[sharedIdx_53456];\n                \n                private_mem_53445[i_53455] = tmp_53457;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53458 = 0; i_53458 < chunk_sizze_53411 - (int64_t) 1; i_53458++) {\n                int64_t eta_p_46426;\n                int64_t eta_p_46427;\n                \n                eta_p_46426 = private_mem_53445[i_53458];\n                eta_p_46427 = private_mem_53445[i_53458 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_46428 = mul64(eta_p_46426, eta_p_46427);\n                \n                private_mem_53", "445[i_53458 + (int64_t) 1] = defunc_0_op_res_46428;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53459 = private_mem_53445[chunk_sizze_53411 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = tmp_53459;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53460;\n            int64_t eta_p_53461;\n            int64_t eta_p_53464;\n            int64_t eta_p_53465;\n            bool ltid_in_bounds_53467 = slt64(sext_i32_i64(local_tid_53423), num_virt_threads_53413);\n            int32_t skip_threads_53468;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53467) {\n                    eta_p_53461 = ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)];\n                    if ((local_tid_53423 - squot32(local_tid_53423, 32) * 32) == 0) {\n                        eta_p_53460 = eta_p_53461;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53468 = 1;\n                while (slt32(skip_threads_53468, 32)) {\n                    bool thread_active_53469 = sle32(skip_threads_53468, local_tid_53423 - squot32(local_tid_53423, 32) * 32) && ltid_in_bounds_53467;\n                    \n                    if (thread_active_53469) {\n                        // read operands\n                        {\n                            eta_p_53460 = ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423) - sext_i32_i64(skip_threads_53468)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53469) {\n                            int64_t defunc_0_op_res_53462 = mul64(eta_p_53460, eta_p_53461);\n                ",
                                    "            \n                            eta_p_53460 = defunc_0_op_res_53462;\n                        }\n                    }\n                    if (sle32(wave_sizze_53425, skip_threads_53468)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53469) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = eta_p_53460;\n                            eta_p_53461 = eta_p_53460;\n                        }\n                    }\n                    if (sle32(wave_sizze_53425, skip_threads_53468)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53468 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53423 - squot32(local_tid_53423, 32) * 32) == 31 && ltid_in_bounds_53467) {\n                    ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(squot32(local_tid_53423, 32))] = eta_p_53460;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53470;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53423, 32) == 0 && ltid_in_bounds_53467) {\n                        eta_p_53465 = ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)];\n                        if ((local_tid_53423 - squot32(local_tid_53423, 32) * 32) == 0) {\n                            eta_p_53464 = eta_p_53465;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n ", "                   skip_threads_53470 = 1;\n                    while (slt32(skip_threads_53470, 32)) {\n                        bool thread_active_53471 = sle32(skip_threads_53470, local_tid_53423 - squot32(local_tid_53423, 32) * 32) && (squot32(local_tid_53423, 32) == 0 && ltid_in_bounds_53467);\n                        \n                        if (thread_active_53471) {\n                            // read operands\n                            {\n                                eta_p_53464 = ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423) - sext_i32_i64(skip_threads_53470)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53471) {\n                                int64_t defunc_0_op_res_53466 = mul64(eta_p_53464, eta_p_53465);\n                                \n                                eta_p_53464 = defunc_0_op_res_53466;\n                            }\n                        }\n                        if (sle32(wave_sizze_53425, skip_threads_53470)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53471) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = eta_p_53464;\n                                eta_p_53465 = eta_p_53464;\n                            }\n                        }\n                        if (sle32(wave_sizze_53425, skip_threads_53470)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53470 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53472 = squot32(local_tid_53423, 32) == 0 || !ltid_in_bounds_53467;\n            \n    ", "        // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53472) {\n                        eta_p_53461 = eta_p_53460;\n                        eta_p_53460 = ((__local int64_t *) local_mem_53430)[sext_i32_i64(squot32(local_tid_53423, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53472) {\n                        int64_t defunc_0_op_res_53462 = mul64(eta_p_53460, eta_p_53461);\n                        \n                        eta_p_53460 = defunc_0_op_res_53462;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53472) {\n                        ((__local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = eta_p_53460;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53423, 32) == 0 && ltid_in_bounds_53467) {\n                    ((__local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = eta_p_53461;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53423 == 0) {\n                acc_53463 = ((__local int64_t *) local_mem_53430)[segscan_tblock_sizze_50375 - (int64_t) 1];\n            } else {\n                acc_53463 = ((__local int64_t *) local_mem_53430)[sext_i32_i64(local_tid_53423) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53473 = (int64_t) 1;\n        block_new_sgm_53474 = sgm_idx_53442 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53474 && local_tid_53423 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53418)[dyna",
                                    "mic_id_53440] = acc_53463;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53414)[dynamic_id_53440] = (int8_t) 2;\n                acc_53463 = (int64_t) 1;\n            }\n            if (!block_new_sgm_53474 && slt32(local_tid_53423, wave_sizze_53425)) {\n                if (local_tid_53423 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53416)[dynamic_id_53440] = acc_53463;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53414)[dynamic_id_53440] = (int8_t) 1;\n                    \n                    int8_t tmp_53475 = ((volatile __global int8_t *) status_flags_mem_53414)[dynamic_id_53440 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53430)[(int64_t) 0] = tmp_53475;\n                }\n                mem_fence_local();\n                \n                int8_t status_53476 = ((__local int8_t *) local_mem_53430)[(int64_t) 0];\n                \n                if (status_53476 == (int8_t) 2) {\n                    if (local_tid_53423 == 0) {\n                        prefix_53473 = ((volatile __global int64_t *) incprefixes_mem_53418)[dynamic_id_53440 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53477 = sext_i64_i32(dynamic_id_53440 - sext_i32_i64(wave_sizze_53425));\n                    \n                    while (slt32(wave_sizze_53425 * -1, readOffset_53477)) {\n                        int32_t read_i_53478 = readOffset_53477 + local_tid_53423;\n                        int64_t aggr_53479 = (int64_t) 1;\n                        int8_t flag_53480 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53478)) {\n                            flag_53480 = ((volatile __global int8_t *) status_flags_mem_53414)[sext_i32_i64(read_i_53478)];\n                            if (flag_53480 == (int8_t) 2) {\n                         ", "       aggr_53479 = ((volatile __global int64_t *) incprefixes_mem_53418)[sext_i32_i64(read_i_53478)];\n                            } else if (flag_53480 == (int8_t) 1) {\n                                aggr_53479 = ((volatile __global int64_t *) aggregates_mem_53416)[sext_i32_i64(read_i_53478)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53430)[(int64_t) 4 + sext_i32_i64(local_tid_53423)] = aggr_53479;\n                        ((__local int8_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = flag_53480;\n                        flag_53480 = ((__local int8_t *) local_mem_53430)[sext_i32_i64(wave_sizze_53425) - (int64_t) 1];\n                        if (slt8(flag_53480, (int8_t) 2)) {\n                            int8_t flg_x_53484;\n                            int8_t flg_y_53485;\n                            int64_t eta_p_53481;\n                            int64_t eta_p_53482;\n                            int32_t skip_threads_53486;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53485 = ((volatile __local int8_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)];\n                                eta_p_53482 = ((volatile __local int64_t *) local_mem_53430)[(int64_t) 4 + sext_i32_i64(local_tid_53423)];\n                                if ((local_tid_53423 - squot32(local_tid_53423, 32) * 32) == 0) {\n                                    eta_p_53481 = eta_p_53482;\n                                    flg_x_53484 = flg_y_53485;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53486 = 1;\n                                while (slt32(skip_threads_53486, 32)) {\n                                    if (sle32(skip_threads_53486, local_tid_53423 - s", "quot32(local_tid_53423, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53484 = ((volatile __local int8_t *) local_mem_53430)[sext_i32_i64(local_tid_53423) - sext_i32_i64(skip_threads_53486)];\n                                            eta_p_53481 = ((volatile __local int64_t *) local_mem_53430)[(int64_t) 4 + (sext_i32_i64(local_tid_53423) - sext_i32_i64(skip_threads_53486))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53485 == (int8_t) 2 || flg_y_53485 == (int8_t) 0) {\n                                                flg_x_53484 = flg_y_53485;\n                                                eta_p_53481 = eta_p_53482;\n                                            } else {\n                                                int64_t defunc_0_op_res_53483 = mul64(eta_p_53481, eta_p_53482);\n                                                \n                                                eta_p_53481 = defunc_0_op_res_53483;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53430)[sext_i32_i64(local_tid_53423)] = flg_x_53484;\n                                            flg_y_53485 = flg_x_53484;\n                                            ((volatile __local int64_t *) local_mem_53430)[(int64_t) 4 + sext_i32_i64(local_tid_53423)] = eta_p_53481;\n                                            eta_p_53482 = eta_p_53481;\n                                        }\n                                    }\n                                    skip_threads_53486 *= 2;\n                                }\n              ",
                                    "              }\n                        }\n                        flag_53480 = ((__local int8_t *) local_mem_53430)[sext_i32_i64(wave_sizze_53425) - (int64_t) 1];\n                        aggr_53479 = ((__local int64_t *) local_mem_53430)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53425) - (int64_t) 1)];\n                        if (flag_53480 == (int8_t) 2) {\n                            readOffset_53477 = wave_sizze_53425 * -1;\n                        } else if (flag_53480 == (int8_t) 1) {\n                            readOffset_53477 -= wave_sizze_53425;\n                        }\n                        if (slt8((int8_t) 0, flag_53480)) {\n                            int64_t eta_p_53487 = aggr_53479;\n                            int64_t eta_p_53488 = prefix_53473;\n                            int64_t defunc_0_op_res_53489 = mul64(eta_p_53487, eta_p_53488);\n                            \n                            prefix_53473 = defunc_0_op_res_53489;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53423 == 0) {\n                    if (boundary_53443 == sext_i64_i32(segscan_tblock_sizze_50375 * chunk_sizze_53411)) {\n                        int64_t eta_p_53490 = prefix_53473;\n                        int64_t eta_p_53491 = acc_53463;\n                        int64_t defunc_0_op_res_53492 = mul64(eta_p_53490, eta_p_53491);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53418)[dynamic_id_53440] = defunc_0_op_res_53492;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53414)[dynamic_id_53440] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53430)[(int64_t) 4] = prefix_53473;\n                    acc_53463 = (int64_t) 1;\n                }\n            }\n            if (!(dynamic_id_53440 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_F", "ENCE);\n                prefix_53473 = ((__local int64_t *) local_mem_53430)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53493;\n            int64_t eta_p_53494;\n            int64_t eta_p_53496 = prefix_53473;\n            int64_t eta_p_53497 = acc_53463;\n            \n            if (slt32(local_tid_53423 * chunk_sizze_32b_53427, boundary_53443) && !block_new_sgm_53474) {\n                int64_t defunc_0_op_res_53498 = mul64(eta_p_53496, eta_p_53497);\n                \n                eta_p_53493 = defunc_0_op_res_53498;\n            } else {\n                eta_p_53493 = acc_53463;\n            }\n            \n            int32_t stopping_point_53499 = segsizze_compact_53444 - srem32(local_tid_53423 * chunk_sizze_32b_53427 - 1 + segsizze_compact_53444 - boundary_53443, segsizze_compact_53444);\n            \n            for (int64_t i_53500 = 0; i_53500 < chunk_sizze_53411; i_53500++) {\n                if (slt32(sext_i64_i32(i_53500), stopping_point_53499 - 1)) {\n                    eta_p_53494 = private_mem_53445[i_53500];\n                    \n                    int64_t defunc_0_op_res_53495 = mul64(eta_p_53493, eta_p_53494);\n                    \n                    private_mem_53445[i_53500] = defunc_0_op_res_53495;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53501 = 0; i_53501 < chunk_sizze_53411; i_53501++) {\n                int64_t sharedIdx_53502 = sext_i32_i64(local_tid_53423) * chunk_sizze_53411 + i_53501;\n                int64_t tmp_53503 = private_mem_53445[i_53501];\n                \n                ((__local int64_t *) local_mem_53430)[sharedIdx_53502] = tmp_53503;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53504 = 0; i_53504 < chunk_sizze_53411; i_53504++) {\n                int64_t flat_idx_53505 = th", "d_offset_53447 + i_53504 * segscan_tblock_sizze_50375;\n                int64_t slice_53506 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;\n                int64_t gtid_50379 = flat_idx_53505;\n                int64_t remnant_53507 = flat_idx_53505 - gtid_50379;\n                \n                if (slt64(flat_idx_53505, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086)) {\n                    int64_t tmp_53508 = ((__local int64_t *) local_mem_53430)[flat_idx_53505 - block_offset_53441];\n                    \n                    ((__global int64_t *) mem_52576)[gtid_50379] = tmp_53508;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_50375\n    #undef chunk_sizze_53411\n}\nFUTHARK_KERNEL\nvoid skyline_intermediate_filter_floatzireplicate_53457(int64_t dim_33939, int64_t dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595, int64_t replicate_n_53456, int64_t virt_num_tblocks_53462, int64_t num_tblocks_53463, __global unsigned char *mem_52593, __global unsigned char *mem_52598)\n{\n    int32_t replicate_ltid_53458;\n    int32_t tblock_sizze_53460;\n    int32_t replicate_gid_53459;\n    int32_t replicate_gtid_53457;\n    int32_t phys_tblock_id_53464;\n    int32_t iterations_53465;\n    \n    replicate_ltid_53458 = get_local_id(0);\n    tblock_sizze_53460 = get_local_size(0);\n    replicate_gid_53459 = get_tblock_id(0);\n    replicate_gtid_53457 = replicate_gid_53459 * tblock_sizze_53460 + replicate_ltid_53458;\n    phys_tblock_id_53464 = get_tblock_id(0);\n    iterations_53465 = sdiv_up32(sext_i64_i32(virt_num_tblocks_53462) - phys_tblock_id_53464, sext_i64_i32(num_tblocks_53463));\n    for (int32_t i_53466 = 0; i_53466 < iterations_53465; i_53466++) {\n        int32_t virt_tblock_id_53467;\n        int64_t global_tid_53468;\n        int64_t slice_53471;\n        int64_t slice_53472;\n        int64_t rep_i_53469;\n        int64_t remnant_53473;\n        int64_t rep_i_53470;\n        int64_t remnant_53474;\n        \n   ",
                                    "     virt_tblock_id_53467 = phys_tblock_id_53464 + i_53466 * sext_i64_i32(num_tblocks_53463);\n        global_tid_53468 = sext_i32_i64(virt_tblock_id_53467) * sext_i32_i64(tblock_sizze_53460) + sext_i32_i64(replicate_ltid_53458);\n        slice_53471 = dim_33939;\n        slice_53472 = dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595 * slice_53471;\n        rep_i_53469 = squot64(global_tid_53468, slice_53471);\n        remnant_53473 = global_tid_53468 - rep_i_53469 * slice_53471;\n        rep_i_53470 = remnant_53473;\n        remnant_53474 = remnant_53473 - rep_i_53470;\n        if (slt64(global_tid_53468, replicate_n_53456)) {\n            float tmp_53475 = ((__global float *) mem_52593)[rep_i_53470];\n            \n            ((__global float *) mem_52598)[rep_i_53469 * dim_33939 + rep_i_53470] = tmp_53475;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegmap_50572_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegmap_50572(__global int *global_failure, int64_t dim_33939, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52587)\n{\n    #define segmap_tblock_sizze_50568 (skyline_intermediate_filter_floatzisegmap_50572zisegmap_tblock_sizze_50568)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53318;\n    int32_t tblock_sizze_53321;\n    int32_t wave_sizze_53320;\n    int32_t block_id_53319;\n    int32_t global_tid_53317;\n    int64_t phys_tid_50572;\n    int64_t global_tid_53322;\n    int64_t slice_53323;\n    int64_t gtid_50571;\n    int64_t remnant_53324;\n    \n    local_tid_53318 = get_local_id(0);\n    tblock_sizze_53321 = get_local_size(0);\n    wave_sizze_53320 = LOCKSTEP_WIDTH;\n    block_id_53319 = get_tblock_id(0);\n    global_tid_53317 = block_id_53319 * tblock_sizze_53321 + local_tid_53318;\n    phys_tid_50572 = sext_i32_i64(global_tid_53317);\n    global_tid_53322 = sext_i32_i64(block_id_53319) ", "* segmap_tblock_sizze_50568 + sext_i32_i64(local_tid_53318);\n    slice_53323 = dim_33939;\n    gtid_50571 = global_tid_53322;\n    remnant_53324 = global_tid_53322 - gtid_50571;\n    if (slt64(gtid_50571, dim_33939)) {\n        float eta_p_50573;\n        float zm_res_50575;\n        \n        eta_p_50573 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_50571];\n        zm_res_50575 = eta_p_50573 - eta_p_50573;\n        ((__global float *) mem_52587)[gtid_50571] = zm_res_50575;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50568\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegmap_50629_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegmap_50629(__global int *global_failure, int64_t dim_33939, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52590, __global unsigned char *mem_52593, __global unsigned char *mem_52595)\n{\n    #define segmap_tblock_sizze_50624 (skyline_intermediate_filter_floatzisegmap_50629zisegmap_tblock_sizze_50624)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53449;\n    int32_t tblock_sizze_53452;\n    int32_t wave_sizze_53451;\n    int32_t block_id_53450;\n    int32_t global_tid_53448;\n    int64_t phys_tid_50629;\n    int64_t global_tid_53453;\n    int64_t slice_53454;\n    int64_t gtid_50628;\n    int64_t remnant_53455;\n    \n    local_tid_53449 = get_local_id(0);\n    tblock_sizze_53452 = get_local_size(0);\n    wave_sizze_53451 = LOCKSTEP_WIDTH;\n    block_id_53450 = get_tblock_id(0);\n    global_tid_53448 = block_id_53450 * tblock_sizze_53452 + local_tid_53449;\n    phys_tid_50629 = sext_i32_i64(global_tid_53448);\n    global_tid_53453 = sext_i32_i64(block_id_53450) * segmap_tblock_sizze_50624 + sext_i32_i64(local_tid_53449);\n    slice_53454 = dim_33939;\n    gtid_50628 = global_tid_53453;\n    remnant_53455 = global_tid_53453 - gtid_50628;\n    if (slt64(gtid_50628, dim_33939)) {\n        int64_t zv_lhs_50631;\n        int64_t tmp_50632;\n        bool cond_50", "634;\n        int64_t lifted_lambda_res_50635;\n        float plus_arg0_50640;\n        \n        zv_lhs_50631 = add64((int64_t) -1, gtid_50628);\n        tmp_50632 = smod64(zv_lhs_50631, dim_33939);\n        cond_50634 = gtid_50628 == (int64_t) 0;\n        if (cond_50634) {\n            lifted_lambda_res_50635 = (int64_t) 1;\n        } else {\n            int64_t lifted_lambda_res_50633 = ((__global int64_t *) mem_52590)[tmp_50632];\n            \n            lifted_lambda_res_50635 = lifted_lambda_res_50633;\n        }\n        plus_arg0_50640 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_50628];\n        ((__global float *) mem_52593)[gtid_50628] = plus_arg0_50640;\n        ((__global int64_t *) mem_52595)[gtid_50628] = lifted_lambda_res_50635;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50624\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegmap_50660_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegmap_50660(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, __global unsigned char *mem_52613, __global unsigned char *mem_52620)\n{\n    #define segmap_tblock_sizze_50656 (skyline_intermediate_filter_floatzisegmap_50660zisegmap_tblock_sizze_50656)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53630;\n    int32_t tblock_sizze_53633;\n    int32_t wave_sizze_53632;\n    int32_t block_id_53631;\n    int32_t global_tid_53629;\n    int64_t phys_tid_50660;\n    int64_t global_tid_53634;\n    int64_t slice_53635;\n    int64_t gtid_50659;\n    int64_t remnant_53636;\n    \n    local_tid_53630 = get_local_id(0);\n    tblock_sizze_53633 = get_local_size(0);\n    wave_sizze_53632 = LOCKSTEP_WIDTH;\n    block_id_53631 = get_tblock_id(0);\n    global_tid_53629 = block_id_53631 * tblock_sizze_53633 + local_tid_53630;\n    phys_tid_50660 = sext_i32_i64(global_tid_53629);\n    global_tid_53634 = sext_i32_i64(block_id_53631) * segmap_tblock_sizze_50656 + sext_i32_i64(local_tid_53630);\n    slice_53635 = dzlz7bUZL",
                                    "zmZRz20Udimz20U1z7dUzg_33941;\n    gtid_50659 = global_tid_53634;\n    remnant_53636 = global_tid_53634 - gtid_50659;\n    if (slt64(gtid_50659, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941)) {\n        int64_t zv_lhs_50662;\n        int64_t tmp_50663;\n        bool cond_50665;\n        int64_t lifted_lambda_res_50666;\n        \n        zv_lhs_50662 = add64((int64_t) -1, gtid_50659);\n        tmp_50663 = smod64(zv_lhs_50662, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941);\n        cond_50665 = gtid_50659 == (int64_t) 0;\n        if (cond_50665) {\n            lifted_lambda_res_50666 = (int64_t) 1;\n        } else {\n            int64_t lifted_lambda_res_50664 = ((__global int64_t *) mem_52613)[tmp_50663];\n            \n            lifted_lambda_res_50666 = lifted_lambda_res_50664;\n        }\n        ((__global int64_t *) mem_52620)[gtid_50659] = lifted_lambda_res_50666;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50656\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegred_nonseg_50555_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegred_nonseg_50555(__global int *global_failure, int64_t dim_33939, int64_t num_tblocks_50550, int64_t num_threads_53267, __global unsigned char *mem_52582, __global unsigned char *counters_mem_53243, __global unsigned char *segred_tmp_mem_53265)\n{\n    #define segred_tblock_sizze_50548 (skyline_intermediate_filter_floatzisegred_nonseg_50555zisegred_tblock_sizze_50548)\n    #define chunk_sizze_53242 (skyline_intermediate_filter_floatzisegred_nonseg_50555zichunk_sizze_53242)\n    \n    volatile __local unsigned char *sync_arr_mem_53275_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53275_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_53273_backing_0 = &shared_mem[sync_arr_mem_53275_backing_1_offset];\n    const int64_t red_arr_i64_mem_53273_backing_0_offset = sync_arr_mem_53275_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_50548 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_si", "zze_50548, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53269;\n    int32_t tblock_sizze_53272;\n    int32_t wave_sizze_53271;\n    int32_t block_id_53270;\n    int32_t global_tid_53268;\n    int64_t phys_tid_50555;\n    __local unsigned char *red_arr_i64_mem_53273;\n    __local unsigned char *sync_arr_mem_53275;\n    int64_t dummy_50553;\n    int64_t gtid_50554;\n    int64_t q_53277;\n    int64_t eta_p_block_res_acc_53278;\n    int64_t eta_p_47901;\n    int64_t eta_p_47902;\n    int64_t tblock_id_in_segment_53282;\n    int64_t block_base_offset_53283;\n    int32_t offset_53286;\n    int32_t skip_waves_53287;\n    int64_t eta_p_53279;\n    int64_t eta_p_53280;\n    int32_t old_counter_53288;\n    bool is_last_block_53289;\n    \n    local_tid_53269 = get_local_id(0);\n    tblock_sizze_53272 = get_local_size(0);\n    wave_sizze_53271 = LOCKSTEP_WIDTH;\n    block_id_53270 = get_tblock_id(0);\n    global_tid_53268 = block_id_53270 * tblock_sizze_53272 + local_tid_53269;\n    phys_tid_50555 = sext_i32_i64(global_tid_53268);\n    red_arr_i64_mem_53273 = (__local unsigned char *) red_arr_i64_mem_53273_backing_0;\n    sync_arr_mem_53275 = (__local unsigned char *) sync_arr_mem_53275_backing_1;\n    dummy_50553 = (int64_t) 0;\n    gtid_50554 = (int64_t) 0;\n    q_53277 = sdiv_up64(dim_33939, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_50548 * num_tblocks_50550)) * chunk_sizze_53242);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53278 = (int64_t) 1;\n    }\n    tblock_id_in_segment_53282 = squot64(phys_tid_50555, segred_tblock_sizze_50548);\n    block_base_offset_53283 = tblock_id_in_segment_53282 * q_53277 * segred_tblock_sizze_50548;\n    for (int64_t i_53284 = 0; i_53284 < q_53277; i_53284++) {\n        int64_t block_offset_53285 = block_base_offset_53283 + i_53284 * segred_tblock_sizze_50548;\n        \n        gtid_50554 = phys_tid_50555 + num_threads_53267 * i_53284;\n        if (slt64(gtid_50554, di", "m_33939)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    // load accumulator(s)\n                    {\n                        eta_p_47901 = eta_p_block_res_acc_53278;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47902 = (int64_t) 1;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t zt_res_47903 = mul64(eta_p_47901, eta_p_47902);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53278 = zt_res_47903;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_block_res_acc_53278;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53287 = 1;\n    offset_53286 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53269, sext_i64_i32(segred_tblock_sizze_50548))) {\n            eta_p_53279 = ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_53286)];\n        }\n    }\n    offset_53286 = 1;\n    while (slt32(offset_53286, wave_sizze_53271)) {\n        if (slt32(local_tid_53269 + offset_53286, sext_i64_i32(segred_tblock_sizze_50548)) && ((local_tid_53269 - squot32(local_tid_53269, wave_sizze_53271) * wave_sizze_53271) & (2 * offset_53286 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_53280 = ((volatile __local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_53286)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53281 = mul64(eta_p_532",
                                    "79, eta_p_53280);\n                \n                eta_p_53279 = zt_res_53281;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_53279;\n            }\n        }\n        offset_53286 *= 2;\n    }\n    while (slt32(skip_waves_53287, squot32(sext_i64_i32(segred_tblock_sizze_50548) + wave_sizze_53271 - 1, wave_sizze_53271))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53286 = skip_waves_53287 * wave_sizze_53271;\n        if (slt32(local_tid_53269 + offset_53286, sext_i64_i32(segred_tblock_sizze_50548)) && ((local_tid_53269 - squot32(local_tid_53269, wave_sizze_53271) * wave_sizze_53271) == 0 && (squot32(local_tid_53269, wave_sizze_53271) & (2 * skip_waves_53287 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53280 = ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_53286)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53281 = mul64(eta_p_53279, eta_p_53280);\n                \n                eta_p_53279 = zt_res_53281;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_53279;\n            }\n        }\n        skip_waves_53287 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53269) == (int64_t) 0) {\n            eta_p_block_res_acc_53278 = eta_p_53279;\n        } else {\n            eta_p_block_res_acc_53278 = (int64_t) 1;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_53269 == 0) {\n            ((__global int64_t *) segred_tmp_mem_53265)[sext_i32_i64(block_id_53270)] = eta_p_block_res_acc_53278;\n            mem_fence_gl", "obal();\n            old_counter_53288 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53243)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53275)[(int64_t) 0] = old_counter_53288 == sext_i64_i32(num_tblocks_50550 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53289 = ((__local bool *) sync_arr_mem_53275)[(int64_t) 0];\n    if (is_last_block_53289) {\n        if (local_tid_53269 == 0) {\n            old_counter_53288 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53243)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_50550));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53290 = sdiv_up64(num_tblocks_50550, segred_tblock_sizze_50548);\n            \n            eta_p_47901 = (int64_t) 1;\n            for (int64_t i_53291 = 0; i_53291 < read_per_thread_53290; i_53291++) {\n                int64_t block_res_id_53292 = sext_i32_i64(local_tid_53269) * read_per_thread_53290 + i_53291;\n                int64_t index_of_block_res_53293 = block_res_id_53292;\n                \n                if (slt64(block_res_id_53292, num_tblocks_50550)) {\n                    eta_p_47902 = ((__global int64_t *) segred_tmp_mem_53265)[index_of_block_res_53293];\n                    \n                    int64_t zt_res_47903 = mul64(eta_p_47901, eta_p_47902);\n                    \n                    eta_p_47901 = zt_res_47903;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_47901;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_53294;\n            int32_t skip_waves_53295 = 1;\n            int64_t eta_p_53279;\n            int64_t eta_p_53280;\n            \n            offset_53294 = 0;\n            // participating threads read initial accumulator\n            {\n                if (s", "lt32(local_tid_53269, sext_i64_i32(segred_tblock_sizze_50548))) {\n                    eta_p_53279 = ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_53294)];\n                }\n            }\n            offset_53294 = 1;\n            while (slt32(offset_53294, wave_sizze_53271)) {\n                if (slt32(local_tid_53269 + offset_53294, sext_i64_i32(segred_tblock_sizze_50548)) && ((local_tid_53269 - squot32(local_tid_53269, wave_sizze_53271) * wave_sizze_53271) & (2 * offset_53294 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53280 = ((volatile __local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_53294)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53281 = mul64(eta_p_53279, eta_p_53280);\n                        \n                        eta_p_53279 = zt_res_53281;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_53279;\n                    }\n                }\n                offset_53294 *= 2;\n            }\n            while (slt32(skip_waves_53295, squot32(sext_i64_i32(segred_tblock_sizze_50548) + wave_sizze_53271 - 1, wave_sizze_53271))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53294 = skip_waves_53295 * wave_sizze_53271;\n                if (slt32(local_tid_53269 + offset_53294, sext_i64_i32(segred_tblock_sizze_50548)) && ((local_tid_53269 - squot32(local_tid_53269, wave_sizze_53271) * wave_sizze_53271) == 0 && (squot32(local_tid_53269, wave_sizze_53271) & (2 * skip_waves_53295 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_53280 = ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269 + offset_",
                                    "53294)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53281 = mul64(eta_p_53279, eta_p_53280);\n                        \n                        eta_p_53279 = zt_res_53281;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_53273)[sext_i32_i64(local_tid_53269)] = eta_p_53279;\n                    }\n                }\n                skip_waves_53295 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53269 == 0) {\n                    ((__global int64_t *) mem_52582)[(int64_t) 0] = eta_p_53279;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_50548\n    #undef chunk_sizze_53242\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegred_nonseg_50595_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegred_nonseg_50595(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, int64_t num_tblocks_50590, int64_t num_threads_53599, __global unsigned char *mem_52615, __global unsigned char *mem_52617, __global unsigned char *counters_mem_53595, __global unsigned char *segred_tmp_mem_53597)\n{\n    #define segred_tblock_sizze_50588 (skyline_intermediate_filter_floatzisegred_nonseg_50595zisegred_tblock_sizze_50588)\n    #define chunk_sizze_53594 (skyline_intermediate_filter_floatzisegred_nonseg_50595zichunk_sizze_53594)\n    \n    volatile __local unsigned char *sync_arr_mem_53607_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53607_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_53605_backing_0 = &shared_mem[sync_arr_mem_53607_backing_1_offset];\n    const int64_t red_arr_i64_mem_53605_backing_0_offset = sync_arr_mem_53607_backing_1_offset + ((int64_t) 8 * segred_t", "block_sizze_50588 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50588, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53601;\n    int32_t tblock_sizze_53604;\n    int32_t wave_sizze_53603;\n    int32_t block_id_53602;\n    int32_t global_tid_53600;\n    int64_t phys_tid_50595;\n    __local unsigned char *red_arr_i64_mem_53605;\n    __local unsigned char *sync_arr_mem_53607;\n    int64_t dummy_50593;\n    int64_t gtid_50594;\n    int64_t q_53609;\n    int64_t eta_p_block_res_acc_53610;\n    int64_t eta_p_47748;\n    int64_t eta_p_47749;\n    int64_t tblock_id_in_segment_53614;\n    int64_t block_base_offset_53615;\n    int32_t offset_53618;\n    int32_t skip_waves_53619;\n    int64_t eta_p_53611;\n    int64_t eta_p_53612;\n    int32_t old_counter_53620;\n    bool is_last_block_53621;\n    \n    local_tid_53601 = get_local_id(0);\n    tblock_sizze_53604 = get_local_size(0);\n    wave_sizze_53603 = LOCKSTEP_WIDTH;\n    block_id_53602 = get_tblock_id(0);\n    global_tid_53600 = block_id_53602 * tblock_sizze_53604 + local_tid_53601;\n    phys_tid_50595 = sext_i32_i64(global_tid_53600);\n    red_arr_i64_mem_53605 = (__local unsigned char *) red_arr_i64_mem_53605_backing_0;\n    sync_arr_mem_53607 = (__local unsigned char *) sync_arr_mem_53607_backing_1;\n    dummy_50593 = (int64_t) 0;\n    gtid_50594 = (int64_t) 0;\n    q_53609 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_50588 * num_tblocks_50590)) * chunk_sizze_53594);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53610 = (int64_t) 1;\n    }\n    tblock_id_in_segment_53614 = squot64(phys_tid_50595, segred_tblock_sizze_50588);\n    block_base_offset_53615 = tblock_id_in_segment_53614 * q_53609 * segred_tblock_sizze_50588;\n    for (int64_t i_53616 = 0; i_53616 < q_53609; i_53616++) {\n        int64_t block_offset_53617 = block_base_offset_53615 + i_53616 * segred_tblock_sizze_50588;\n  ", "      \n        gtid_50594 = phys_tid_50595 + num_threads_53599 * i_53616;\n        if (slt64(gtid_50594, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_50577 = ((__global int64_t *) mem_52615)[gtid_50594];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_47748 = eta_p_block_res_acc_53610;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47749 = x_50577;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int64_t zt_res_47750 = mul64(eta_p_47748, eta_p_47749);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53610 = zt_res_47750;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_block_res_acc_53610;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53619 = 1;\n    offset_53618 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53601, sext_i64_i32(segred_tblock_sizze_50588))) {\n            eta_p_53611 = ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53618)];\n        }\n    }\n    offset_53618 = 1;\n    while (slt32(offset_53618, wave_sizze_53603)) {\n        if (slt32(local_tid_53601 + offset_53618, sext_i64_i32(segred_tblock_sizze_50588)) && ((local_tid_53601 - squot32(local_tid_53601, wave_sizze_53603) * wave_sizze_53603) & (2 * offset_53618 - 1)) == 0) {\n            // read array element\n            {\n                et",
                                    "a_p_53612 = ((volatile __local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53618)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53613 = mul64(eta_p_53611, eta_p_53612);\n                \n                eta_p_53611 = zt_res_53613;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_53611;\n            }\n        }\n        offset_53618 *= 2;\n    }\n    while (slt32(skip_waves_53619, squot32(sext_i64_i32(segred_tblock_sizze_50588) + wave_sizze_53603 - 1, wave_sizze_53603))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53618 = skip_waves_53619 * wave_sizze_53603;\n        if (slt32(local_tid_53601 + offset_53618, sext_i64_i32(segred_tblock_sizze_50588)) && ((local_tid_53601 - squot32(local_tid_53601, wave_sizze_53603) * wave_sizze_53603) == 0 && (squot32(local_tid_53601, wave_sizze_53603) & (2 * skip_waves_53619 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53612 = ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53618)];\n            }\n            // apply reduction operation\n            {\n                int64_t zt_res_53613 = mul64(eta_p_53611, eta_p_53612);\n                \n                eta_p_53611 = zt_res_53613;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_53611;\n            }\n        }\n        skip_waves_53619 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53601) == (int64_t) 0) {\n            eta_p_block_res_acc_53610 = eta_p_53611;\n        } else {\n            eta_p_block_res_acc_53610 = (int64_t) 1;\n        }\n    }\n    // firs", "t thread in block saves block result to global memory\n    {\n        if (local_tid_53601 == 0) {\n            ((__global int64_t *) segred_tmp_mem_53597)[sext_i32_i64(block_id_53602)] = eta_p_block_res_acc_53610;\n            mem_fence_global();\n            old_counter_53620 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53595)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53607)[(int64_t) 0] = old_counter_53620 == sext_i64_i32(num_tblocks_50590 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53621 = ((__local bool *) sync_arr_mem_53607)[(int64_t) 0];\n    if (is_last_block_53621) {\n        if (local_tid_53601 == 0) {\n            old_counter_53620 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53595)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_50590));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53622 = sdiv_up64(num_tblocks_50590, segred_tblock_sizze_50588);\n            \n            eta_p_47748 = (int64_t) 1;\n            for (int64_t i_53623 = 0; i_53623 < read_per_thread_53622; i_53623++) {\n                int64_t block_res_id_53624 = sext_i32_i64(local_tid_53601) * read_per_thread_53622 + i_53623;\n                int64_t index_of_block_res_53625 = block_res_id_53624;\n                \n                if (slt64(block_res_id_53624, num_tblocks_50590)) {\n                    eta_p_47749 = ((__global int64_t *) segred_tmp_mem_53597)[index_of_block_res_53625];\n                    \n                    int64_t zt_res_47750 = mul64(eta_p_47748, eta_p_47749);\n                    \n                    eta_p_47748 = zt_res_47750;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_47748;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_53626;\n            i", "nt32_t skip_waves_53627 = 1;\n            int64_t eta_p_53611;\n            int64_t eta_p_53612;\n            \n            offset_53626 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_53601, sext_i64_i32(segred_tblock_sizze_50588))) {\n                    eta_p_53611 = ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53626)];\n                }\n            }\n            offset_53626 = 1;\n            while (slt32(offset_53626, wave_sizze_53603)) {\n                if (slt32(local_tid_53601 + offset_53626, sext_i64_i32(segred_tblock_sizze_50588)) && ((local_tid_53601 - squot32(local_tid_53601, wave_sizze_53603) * wave_sizze_53603) & (2 * offset_53626 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53612 = ((volatile __local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53626)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53613 = mul64(eta_p_53611, eta_p_53612);\n                        \n                        eta_p_53611 = zt_res_53613;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_53611;\n                    }\n                }\n                offset_53626 *= 2;\n            }\n            while (slt32(skip_waves_53627, squot32(sext_i64_i32(segred_tblock_sizze_50588) + wave_sizze_53603 - 1, wave_sizze_53603))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53626 = skip_waves_53627 * wave_sizze_53603;\n                if (slt32(local_tid_53601 + offset_53626, sext_i64_i32(segred_tblock_sizze_50588)) && ((local_tid_53601 - squot32(local_tid_53601, wave_sizze_53603) * wave_sizze_53603) == 0 && (squot32(local_tid_53601, wave_s",
                                    "izze_53603) & (2 * skip_waves_53627 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_53612 = ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601 + offset_53626)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zt_res_53613 = mul64(eta_p_53611, eta_p_53612);\n                        \n                        eta_p_53611 = zt_res_53613;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_53605)[sext_i32_i64(local_tid_53601)] = eta_p_53611;\n                    }\n                }\n                skip_waves_53627 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53601 == 0) {\n                    ((__global int64_t *) mem_52617)[(int64_t) 0] = eta_p_53611;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_50588\n    #undef chunk_sizze_53594\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegscan_50585_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegscan_50585(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, int64_t num_tblocks_50582, int64_t num_virt_blocks_53497, int64_t num_virt_threads_53498, __global unsigned char *mem_52610, __global unsigned char *mem_52613, __global unsigned char *mem_52615, __global unsigned char *status_flags_mem_53499, __global unsigned char *aggregates_mem_53501, __global unsigned char *incprefixes_mem_53503, __global unsigned char *global_dynid_mem_53505)\n{\n    #define segscan_tblock_sizze_50580 (skyline_intermediate_filter_floatzisegscan_50585zisegscan_tblock_sizze_50580)\n    #define chunk_sizze_53496 (skyline_intermediate_filter_floatzisegscan_50585zichunk_sizze_53496)\n    \n   ", " volatile __local unsigned char *local_mem_53515_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53515_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50580), chunk_sizze_53496 * segscan_tblock_sizze_50580 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50580), chunk_sizze_53496 * segscan_tblock_sizze_50580 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53508;\n    int32_t tblock_sizze_53511;\n    int32_t wave_sizze_53510;\n    int32_t block_id_53509;\n    int32_t global_tid_53507;\n    int64_t phys_tid_50585;\n    int32_t chunk_sizze_32b_53512;\n    int64_t byte_offsets_53513;\n    int64_t warp_byte_offset_53514;\n    __local unsigned char *local_mem_53515;\n    int64_t trans_arr_len_53516;\n    int64_t phys_block_id_53522;\n    int64_t virtloop_bound_53523;\n    \n    local_tid_53508 = get_local_id(0);\n    tblock_sizze_53511 = get_local_size(0);\n    wave_sizze_53510 = LOCKSTEP_WIDTH;\n    block_id_53509 = get_tblock_id(0);\n    global_tid_53507 = block_id_53509 * tblock_sizze_53511 + local_tid_53508;\n    phys_tid_50585 = sext_i32_i64(global_tid_53507);\n    chunk_sizze_32b_53512 = sext_i64_i32(chunk_sizze_53496);\n    byte_offsets_53513 = segscan_tblock_sizze_50580 * (int64_t) 8;\n    warp_byte_offset_53514 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53515 = (__local unsigned char *) local_mem_53515_backing_0;\n    trans_arr_len_53516 = chunk_sizze_53496 * segscan_tblock_sizze_50580;\n    phys_block_id_53522 = get_tblock_id(0);\n    virtloop_bound_53523 = sdiv_up64(num_virt_blocks_53497 - phys_block_id_53522, num_tblocks_50582);\n    for (int64_t virtloop_i_53524 = 0; virtloop_i_53524 < virtloop_bound_53523; virtloop_i_53524++) {\n        int64_t dynamic_id_53525;\n        int64_t block_offset_53526;\n        int64_t sgm_idx_53527;\n        int32_t boundary_53528;\n        int", "32_t segsizze_compact_53529;\n        int64_t private_mem_53530[chunk_sizze_53496];\n        int64_t thd_offset_53532;\n        int64_t acc_53548;\n        int64_t prefix_53558;\n        bool block_new_sgm_53559;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53508 == 0) {\n                dynamic_id_53525 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53505)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53515)[(int64_t) 0] = dynamic_id_53525;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53525 == num_virt_blocks_53497 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53505)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53525 = ((__local int32_t *) local_mem_53515)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53526 = dynamic_id_53525 * chunk_sizze_53496 * segscan_tblock_sizze_50580;\n        sgm_idx_53527 = smod64(block_offset_53526, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941);\n        boundary_53528 = sext_i64_i32(smin64(chunk_sizze_53496 * segscan_tblock_sizze_50580, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 - sgm_idx_53527));\n        segsizze_compact_53529 = sext_i64_i32(smin64(chunk_sizze_53496 * segscan_tblock_sizze_50580, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941));\n        thd_offset_53532 = block_offset_53526 + sext_i32_i64(local_tid_53508);\n        // Load and map\n        {\n            for (int64_t i_53533 = 0; i_53533 < chunk_sizze_53496; i_53533++) {\n                int64_t virt_tid_53534 = thd_offset_53532 + i_53533 * segscan_tblock_sizze_50580;\n                int64_t slice_53535 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941;\n                int64_t",
                                    " gtid_50584 = virt_tid_53534;\n                int64_t remnant_53536 = virt_tid_53534 - gtid_50584;\n                \n                if (slt64(virt_tid_53534, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941)) {\n                    int64_t x_47828 = ((__global int64_t *) mem_52610)[gtid_50584];\n                    \n                    ((__global int64_t *) mem_52615)[gtid_50584] = x_47828;\n                    private_mem_53530[i_53533] = x_47828;\n                } else {\n                    private_mem_53530[i_53533] = (int64_t) 1;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53537 = 0; i_53537 < chunk_sizze_53496; i_53537++) {\n                int64_t sharedIdx_53538 = sext_i32_i64(local_tid_53508) + i_53537 * segscan_tblock_sizze_50580;\n                int64_t tmp_53539 = private_mem_53530[i_53537];\n                \n                ((__local int64_t *) local_mem_53515)[sharedIdx_53538] = tmp_53539;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53540 = 0; i_53540 < chunk_sizze_53496; i_53540++) {\n                int64_t sharedIdx_53541 = sext_i32_i64(local_tid_53508) * chunk_sizze_53496 + i_53540;\n                int64_t tmp_53542 = ((__local int64_t *) local_mem_53515)[sharedIdx_53541];\n                \n                private_mem_53530[i_53540] = tmp_53542;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53543 = 0; i_53543 < chunk_sizze_53496 - (int64_t) 1; i_53543++) {\n                int64_t eta_p_46641;\n                int64_t eta_p_46642;\n                \n                eta_p_46641 = private_mem_53530[i_53543];\n                eta_p_46642 = private_mem_53530[i_53543 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_46643 = mul64(eta_p_46641, eta_p_46642);\n                \n                private_mem_53530[i_53543 + (int64_t) 1] ", "= defunc_0_op_res_46643;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53544 = private_mem_53530[chunk_sizze_53496 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = tmp_53544;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53545;\n            int64_t eta_p_53546;\n            int64_t eta_p_53549;\n            int64_t eta_p_53550;\n            bool ltid_in_bounds_53552 = slt64(sext_i32_i64(local_tid_53508), num_virt_threads_53498);\n            int32_t skip_threads_53553;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53552) {\n                    eta_p_53546 = ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)];\n                    if ((local_tid_53508 - squot32(local_tid_53508, 32) * 32) == 0) {\n                        eta_p_53545 = eta_p_53546;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53553 = 1;\n                while (slt32(skip_threads_53553, 32)) {\n                    bool thread_active_53554 = sle32(skip_threads_53553, local_tid_53508 - squot32(local_tid_53508, 32) * 32) && ltid_in_bounds_53552;\n                    \n                    if (thread_active_53554) {\n                        // read operands\n                        {\n                            eta_p_53545 = ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508) - sext_i32_i64(skip_threads_53553)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53554) {\n                            int64_t defunc_0_op_res_53547 = mul64(eta_p_53545, eta_p_53546);\n                            \n              ", "              eta_p_53545 = defunc_0_op_res_53547;\n                        }\n                    }\n                    if (sle32(wave_sizze_53510, skip_threads_53553)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53554) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = eta_p_53545;\n                            eta_p_53546 = eta_p_53545;\n                        }\n                    }\n                    if (sle32(wave_sizze_53510, skip_threads_53553)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53553 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53508 - squot32(local_tid_53508, 32) * 32) == 31 && ltid_in_bounds_53552) {\n                    ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(squot32(local_tid_53508, 32))] = eta_p_53545;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53555;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53508, 32) == 0 && ltid_in_bounds_53552) {\n                        eta_p_53550 = ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)];\n                        if ((local_tid_53508 - squot32(local_tid_53508, 32) * 32) == 0) {\n                            eta_p_53549 = eta_p_53550;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_thr",
                                    "eads_53555 = 1;\n                    while (slt32(skip_threads_53555, 32)) {\n                        bool thread_active_53556 = sle32(skip_threads_53555, local_tid_53508 - squot32(local_tid_53508, 32) * 32) && (squot32(local_tid_53508, 32) == 0 && ltid_in_bounds_53552);\n                        \n                        if (thread_active_53556) {\n                            // read operands\n                            {\n                                eta_p_53549 = ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508) - sext_i32_i64(skip_threads_53555)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53556) {\n                                int64_t defunc_0_op_res_53551 = mul64(eta_p_53549, eta_p_53550);\n                                \n                                eta_p_53549 = defunc_0_op_res_53551;\n                            }\n                        }\n                        if (sle32(wave_sizze_53510, skip_threads_53555)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53556) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = eta_p_53549;\n                                eta_p_53550 = eta_p_53549;\n                            }\n                        }\n                        if (sle32(wave_sizze_53510, skip_threads_53555)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53555 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53557 = squot32(local_tid_53508, 32) == 0 || !ltid_in_bounds_53552;\n            \n            // carry-in for eve", "ry block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53557) {\n                        eta_p_53546 = eta_p_53545;\n                        eta_p_53545 = ((__local int64_t *) local_mem_53515)[sext_i32_i64(squot32(local_tid_53508, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53557) {\n                        int64_t defunc_0_op_res_53547 = mul64(eta_p_53545, eta_p_53546);\n                        \n                        eta_p_53545 = defunc_0_op_res_53547;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53557) {\n                        ((__local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = eta_p_53545;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53508, 32) == 0 && ltid_in_bounds_53552) {\n                    ((__local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = eta_p_53546;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53508 == 0) {\n                acc_53548 = ((__local int64_t *) local_mem_53515)[segscan_tblock_sizze_50580 - (int64_t) 1];\n            } else {\n                acc_53548 = ((__local int64_t *) local_mem_53515)[sext_i32_i64(local_tid_53508) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53558 = (int64_t) 1;\n        block_new_sgm_53559 = sgm_idx_53527 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53559 && local_tid_53508 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53503)[dynamic_id_53525] = acc_53548;\n", "                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53499)[dynamic_id_53525] = (int8_t) 2;\n                acc_53548 = (int64_t) 1;\n            }\n            if (!block_new_sgm_53559 && slt32(local_tid_53508, wave_sizze_53510)) {\n                if (local_tid_53508 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53501)[dynamic_id_53525] = acc_53548;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53499)[dynamic_id_53525] = (int8_t) 1;\n                    \n                    int8_t tmp_53560 = ((volatile __global int8_t *) status_flags_mem_53499)[dynamic_id_53525 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53515)[(int64_t) 0] = tmp_53560;\n                }\n                mem_fence_local();\n                \n                int8_t status_53561 = ((__local int8_t *) local_mem_53515)[(int64_t) 0];\n                \n                if (status_53561 == (int8_t) 2) {\n                    if (local_tid_53508 == 0) {\n                        prefix_53558 = ((volatile __global int64_t *) incprefixes_mem_53503)[dynamic_id_53525 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53562 = sext_i64_i32(dynamic_id_53525 - sext_i32_i64(wave_sizze_53510));\n                    \n                    while (slt32(wave_sizze_53510 * -1, readOffset_53562)) {\n                        int32_t read_i_53563 = readOffset_53562 + local_tid_53508;\n                        int64_t aggr_53564 = (int64_t) 1;\n                        int8_t flag_53565 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53563)) {\n                            flag_53565 = ((volatile __global int8_t *) status_flags_mem_53499)[sext_i32_i64(read_i_53563)];\n                            if (flag_53565 == (int8_t) 2) {\n                                aggr_53564 = ((volat",
                                    "ile __global int64_t *) incprefixes_mem_53503)[sext_i32_i64(read_i_53563)];\n                            } else if (flag_53565 == (int8_t) 1) {\n                                aggr_53564 = ((volatile __global int64_t *) aggregates_mem_53501)[sext_i32_i64(read_i_53563)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53515)[(int64_t) 4 + sext_i32_i64(local_tid_53508)] = aggr_53564;\n                        ((__local int8_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = flag_53565;\n                        flag_53565 = ((__local int8_t *) local_mem_53515)[sext_i32_i64(wave_sizze_53510) - (int64_t) 1];\n                        if (slt8(flag_53565, (int8_t) 2)) {\n                            int8_t flg_x_53569;\n                            int8_t flg_y_53570;\n                            int64_t eta_p_53566;\n                            int64_t eta_p_53567;\n                            int32_t skip_threads_53571;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53570 = ((volatile __local int8_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)];\n                                eta_p_53567 = ((volatile __local int64_t *) local_mem_53515)[(int64_t) 4 + sext_i32_i64(local_tid_53508)];\n                                if ((local_tid_53508 - squot32(local_tid_53508, 32) * 32) == 0) {\n                                    eta_p_53566 = eta_p_53567;\n                                    flg_x_53569 = flg_y_53570;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53571 = 1;\n                                while (slt32(skip_threads_53571, 32)) {\n                                    if (sle32(skip_threads_53571, local_tid_53508 - squot32(local_tid_53508, 32)", " * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53569 = ((volatile __local int8_t *) local_mem_53515)[sext_i32_i64(local_tid_53508) - sext_i32_i64(skip_threads_53571)];\n                                            eta_p_53566 = ((volatile __local int64_t *) local_mem_53515)[(int64_t) 4 + (sext_i32_i64(local_tid_53508) - sext_i32_i64(skip_threads_53571))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53570 == (int8_t) 2 || flg_y_53570 == (int8_t) 0) {\n                                                flg_x_53569 = flg_y_53570;\n                                                eta_p_53566 = eta_p_53567;\n                                            } else {\n                                                int64_t defunc_0_op_res_53568 = mul64(eta_p_53566, eta_p_53567);\n                                                \n                                                eta_p_53566 = defunc_0_op_res_53568;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53515)[sext_i32_i64(local_tid_53508)] = flg_x_53569;\n                                            flg_y_53570 = flg_x_53569;\n                                            ((volatile __local int64_t *) local_mem_53515)[(int64_t) 4 + sext_i32_i64(local_tid_53508)] = eta_p_53566;\n                                            eta_p_53567 = eta_p_53566;\n                                        }\n                                    }\n                                    skip_threads_53571 *= 2;\n                                }\n                            }\n           ", "             }\n                        flag_53565 = ((__local int8_t *) local_mem_53515)[sext_i32_i64(wave_sizze_53510) - (int64_t) 1];\n                        aggr_53564 = ((__local int64_t *) local_mem_53515)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53510) - (int64_t) 1)];\n                        if (flag_53565 == (int8_t) 2) {\n                            readOffset_53562 = wave_sizze_53510 * -1;\n                        } else if (flag_53565 == (int8_t) 1) {\n                            readOffset_53562 -= wave_sizze_53510;\n                        }\n                        if (slt8((int8_t) 0, flag_53565)) {\n                            int64_t eta_p_53572 = aggr_53564;\n                            int64_t eta_p_53573 = prefix_53558;\n                            int64_t defunc_0_op_res_53574 = mul64(eta_p_53572, eta_p_53573);\n                            \n                            prefix_53558 = defunc_0_op_res_53574;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53508 == 0) {\n                    if (boundary_53528 == sext_i64_i32(segscan_tblock_sizze_50580 * chunk_sizze_53496)) {\n                        int64_t eta_p_53575 = prefix_53558;\n                        int64_t eta_p_53576 = acc_53548;\n                        int64_t defunc_0_op_res_53577 = mul64(eta_p_53575, eta_p_53576);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53503)[dynamic_id_53525] = defunc_0_op_res_53577;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53499)[dynamic_id_53525] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53515)[(int64_t) 4] = prefix_53558;\n                    acc_53548 = (int64_t) 1;\n                }\n            }\n            if (!(dynamic_id_53525 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                pref",
                                    "ix_53558 = ((__local int64_t *) local_mem_53515)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53578;\n            int64_t eta_p_53579;\n            int64_t eta_p_53581 = prefix_53558;\n            int64_t eta_p_53582 = acc_53548;\n            \n            if (slt32(local_tid_53508 * chunk_sizze_32b_53512, boundary_53528) && !block_new_sgm_53559) {\n                int64_t defunc_0_op_res_53583 = mul64(eta_p_53581, eta_p_53582);\n                \n                eta_p_53578 = defunc_0_op_res_53583;\n            } else {\n                eta_p_53578 = acc_53548;\n            }\n            \n            int32_t stopping_point_53584 = segsizze_compact_53529 - srem32(local_tid_53508 * chunk_sizze_32b_53512 - 1 + segsizze_compact_53529 - boundary_53528, segsizze_compact_53529);\n            \n            for (int64_t i_53585 = 0; i_53585 < chunk_sizze_53496; i_53585++) {\n                if (slt32(sext_i64_i32(i_53585), stopping_point_53584 - 1)) {\n                    eta_p_53579 = private_mem_53530[i_53585];\n                    \n                    int64_t defunc_0_op_res_53580 = mul64(eta_p_53578, eta_p_53579);\n                    \n                    private_mem_53530[i_53585] = defunc_0_op_res_53580;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53586 = 0; i_53586 < chunk_sizze_53496; i_53586++) {\n                int64_t sharedIdx_53587 = sext_i32_i64(local_tid_53508) * chunk_sizze_53496 + i_53586;\n                int64_t tmp_53588 = private_mem_53530[i_53586];\n                \n                ((__local int64_t *) local_mem_53515)[sharedIdx_53587] = tmp_53588;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53589 = 0; i_53589 < chunk_sizze_53496; i_53589++) {\n                int64_t flat_idx_53590 = thd_offset_53532 + i_53589 * ", "segscan_tblock_sizze_50580;\n                int64_t slice_53591 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941;\n                int64_t gtid_50584 = flat_idx_53590;\n                int64_t remnant_53592 = flat_idx_53590 - gtid_50584;\n                \n                if (slt64(flat_idx_53590, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941)) {\n                    int64_t tmp_53593 = ((__local int64_t *) local_mem_53515)[flat_idx_53590 - block_offset_53526];\n                    \n                    ((__global int64_t *) mem_52613)[gtid_50584] = tmp_53593;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_50580\n    #undef chunk_sizze_53496\n}\nFUTHARK_KERNEL_SIZED(skyline_intermediate_filter_floatzisegscan_50603_dim1, 1, 1)\nvoid skyline_intermediate_filter_floatzisegscan_50603(__global int *global_failure, int64_t dim_33939, int64_t num_tblocks_50600, int64_t num_virt_blocks_53330, int64_t num_virt_threads_53331, __global unsigned char *mem_52590, __global unsigned char *status_flags_mem_53332, __global unsigned char *aggregates_mem_53354, __global unsigned char *incprefixes_mem_53356, __global unsigned char *global_dynid_mem_53358)\n{\n    #define segscan_tblock_sizze_50598 (skyline_intermediate_filter_floatzisegscan_50603zisegscan_tblock_sizze_50598)\n    #define chunk_sizze_53329 (skyline_intermediate_filter_floatzisegscan_50603zichunk_sizze_53329)\n    \n    volatile __local unsigned char *local_mem_53368_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53368_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50598), chunk_sizze_53329 * segscan_tblock_sizze_50598 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50598), chunk_sizze_53329 * segscan_tblock_sizze_50598 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53", "361;\n    int32_t tblock_sizze_53364;\n    int32_t wave_sizze_53363;\n    int32_t block_id_53362;\n    int32_t global_tid_53360;\n    int64_t phys_tid_50603;\n    int32_t chunk_sizze_32b_53365;\n    int64_t byte_offsets_53366;\n    int64_t warp_byte_offset_53367;\n    __local unsigned char *local_mem_53368;\n    int64_t trans_arr_len_53369;\n    int64_t phys_block_id_53375;\n    int64_t virtloop_bound_53376;\n    \n    local_tid_53361 = get_local_id(0);\n    tblock_sizze_53364 = get_local_size(0);\n    wave_sizze_53363 = LOCKSTEP_WIDTH;\n    block_id_53362 = get_tblock_id(0);\n    global_tid_53360 = block_id_53362 * tblock_sizze_53364 + local_tid_53361;\n    phys_tid_50603 = sext_i32_i64(global_tid_53360);\n    chunk_sizze_32b_53365 = sext_i64_i32(chunk_sizze_53329);\n    byte_offsets_53366 = segscan_tblock_sizze_50598 * (int64_t) 8;\n    warp_byte_offset_53367 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53368 = (__local unsigned char *) local_mem_53368_backing_0;\n    trans_arr_len_53369 = chunk_sizze_53329 * segscan_tblock_sizze_50598;\n    phys_block_id_53375 = get_tblock_id(0);\n    virtloop_bound_53376 = sdiv_up64(num_virt_blocks_53330 - phys_block_id_53375, num_tblocks_50600);\n    for (int64_t virtloop_i_53377 = 0; virtloop_i_53377 < virtloop_bound_53376; virtloop_i_53377++) {\n        int64_t dynamic_id_53378;\n        int64_t block_offset_53379;\n        int64_t sgm_idx_53380;\n        int32_t boundary_53381;\n        int32_t segsizze_compact_53382;\n        int64_t private_mem_53383[chunk_sizze_53329];\n        int64_t thd_offset_53385;\n        int64_t acc_53401;\n        int64_t prefix_53411;\n        bool block_new_sgm_53412;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53361 == 0) {\n                dynamic_id_53378 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53358)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n           ",
                                    "         ((__local int64_t *) local_mem_53368)[(int64_t) 0] = dynamic_id_53378;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53378 == num_virt_blocks_53330 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53358)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53378 = ((__local int32_t *) local_mem_53368)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53379 = dynamic_id_53378 * chunk_sizze_53329 * segscan_tblock_sizze_50598;\n        sgm_idx_53380 = smod64(block_offset_53379, dim_33939);\n        boundary_53381 = sext_i64_i32(smin64(chunk_sizze_53329 * segscan_tblock_sizze_50598, dim_33939 - sgm_idx_53380));\n        segsizze_compact_53382 = sext_i64_i32(smin64(chunk_sizze_53329 * segscan_tblock_sizze_50598, dim_33939));\n        thd_offset_53385 = block_offset_53379 + sext_i32_i64(local_tid_53361);\n        // Load and map\n        {\n            for (int64_t i_53386 = 0; i_53386 < chunk_sizze_53329; i_53386++) {\n                int64_t virt_tid_53387 = thd_offset_53385 + i_53386 * segscan_tblock_sizze_50598;\n                int64_t slice_53388 = dim_33939;\n                int64_t gtid_50602 = virt_tid_53387;\n                int64_t remnant_53389 = virt_tid_53387 - gtid_50602;\n                \n                if (slt64(virt_tid_53387, dim_33939)) {\n                    private_mem_53383[i_53386] = (int64_t) 1;\n                } else {\n                    private_mem_53383[i_53386] = (int64_t) 1;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53390 = 0; i_53390 < chunk_sizze_53329; i_53390++) {\n                int64_t sharedIdx_53391 = sext_i32_i64(local_tid_53361) + i_53390 * segscan_tblock_sizze_50598;\n                int", "64_t tmp_53392 = private_mem_53383[i_53390];\n                \n                ((__local int64_t *) local_mem_53368)[sharedIdx_53391] = tmp_53392;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53393 = 0; i_53393 < chunk_sizze_53329; i_53393++) {\n                int64_t sharedIdx_53394 = sext_i32_i64(local_tid_53361) * chunk_sizze_53329 + i_53393;\n                int64_t tmp_53395 = ((__local int64_t *) local_mem_53368)[sharedIdx_53394];\n                \n                private_mem_53383[i_53393] = tmp_53395;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53396 = 0; i_53396 < chunk_sizze_53329 - (int64_t) 1; i_53396++) {\n                int64_t eta_p_46626;\n                int64_t eta_p_46627;\n                \n                eta_p_46626 = private_mem_53383[i_53396];\n                eta_p_46627 = private_mem_53383[i_53396 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_46628 = mul64(eta_p_46626, eta_p_46627);\n                \n                private_mem_53383[i_53396 + (int64_t) 1] = defunc_0_op_res_46628;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53397 = private_mem_53383[chunk_sizze_53329 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = tmp_53397;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53398;\n            int64_t eta_p_53399;\n            int64_t eta_p_53402;\n            int64_t eta_p_53403;\n            bool ltid_in_bounds_53405 = slt64(sext_i32_i64(local_tid_53361), num_virt_threads_53331);\n            int32_t skip_threads_53406;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53405) {\n                    eta_p_53399 = ((volatile __local int64_t *) local_mem_", "53368)[sext_i32_i64(local_tid_53361)];\n                    if ((local_tid_53361 - squot32(local_tid_53361, 32) * 32) == 0) {\n                        eta_p_53398 = eta_p_53399;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53406 = 1;\n                while (slt32(skip_threads_53406, 32)) {\n                    bool thread_active_53407 = sle32(skip_threads_53406, local_tid_53361 - squot32(local_tid_53361, 32) * 32) && ltid_in_bounds_53405;\n                    \n                    if (thread_active_53407) {\n                        // read operands\n                        {\n                            eta_p_53398 = ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361) - sext_i32_i64(skip_threads_53406)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53407) {\n                            int64_t defunc_0_op_res_53400 = mul64(eta_p_53398, eta_p_53399);\n                            \n                            eta_p_53398 = defunc_0_op_res_53400;\n                        }\n                    }\n                    if (sle32(wave_sizze_53363, skip_threads_53406)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53407) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = eta_p_53398;\n                            eta_p_53399 = eta_p_53398;\n                        }\n                    }\n                    if (sle32(wave_sizze_53363, skip_threads_53406)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53406 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n           ",
                                    " // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53361 - squot32(local_tid_53361, 32) * 32) == 31 && ltid_in_bounds_53405) {\n                    ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(squot32(local_tid_53361, 32))] = eta_p_53398;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53408;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53361, 32) == 0 && ltid_in_bounds_53405) {\n                        eta_p_53403 = ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)];\n                        if ((local_tid_53361 - squot32(local_tid_53361, 32) * 32) == 0) {\n                            eta_p_53402 = eta_p_53403;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53408 = 1;\n                    while (slt32(skip_threads_53408, 32)) {\n                        bool thread_active_53409 = sle32(skip_threads_53408, local_tid_53361 - squot32(local_tid_53361, 32) * 32) && (squot32(local_tid_53361, 32) == 0 && ltid_in_bounds_53405);\n                        \n                        if (thread_active_53409) {\n                            // read operands\n                            {\n                                eta_p_53402 = ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361) - sext_i32_i64(skip_threads_53408)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53409) {\n                                int64_t defunc_0_op_res_53404 = mul64(eta_p_53402, eta_p_53403);\n", "                                \n                                eta_p_53402 = defunc_0_op_res_53404;\n                            }\n                        }\n                        if (sle32(wave_sizze_53363, skip_threads_53408)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53409) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = eta_p_53402;\n                                eta_p_53403 = eta_p_53402;\n                            }\n                        }\n                        if (sle32(wave_sizze_53363, skip_threads_53408)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53408 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53410 = squot32(local_tid_53361, 32) == 0 || !ltid_in_bounds_53405;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53410) {\n                        eta_p_53399 = eta_p_53398;\n                        eta_p_53398 = ((__local int64_t *) local_mem_53368)[sext_i32_i64(squot32(local_tid_53361, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53410) {\n                        int64_t defunc_0_op_res_53400 = mul64(eta_p_53398, eta_p_53399);\n                        \n                        eta_p_53398 = defunc_0_op_res_53400;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53410) {\n                        ((__local int64_t *) local_mem_53368)[sext_i32_i64(loca", "l_tid_53361)] = eta_p_53398;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53361, 32) == 0 && ltid_in_bounds_53405) {\n                    ((__local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = eta_p_53399;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53361 == 0) {\n                acc_53401 = ((__local int64_t *) local_mem_53368)[segscan_tblock_sizze_50598 - (int64_t) 1];\n            } else {\n                acc_53401 = ((__local int64_t *) local_mem_53368)[sext_i32_i64(local_tid_53361) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53411 = (int64_t) 1;\n        block_new_sgm_53412 = sgm_idx_53380 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53412 && local_tid_53361 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53356)[dynamic_id_53378] = acc_53401;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53332)[dynamic_id_53378] = (int8_t) 2;\n                acc_53401 = (int64_t) 1;\n            }\n            if (!block_new_sgm_53412 && slt32(local_tid_53361, wave_sizze_53363)) {\n                if (local_tid_53361 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53354)[dynamic_id_53378] = acc_53401;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53332)[dynamic_id_53378] = (int8_t) 1;\n                    \n                    int8_t tmp_53413 = ((volatile __global int8_t *) status_flags_mem_53332)[dynamic_id_53378 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53368)[(int64_t) 0] = tmp_53413;\n                }\n           ",
                                    "     mem_fence_local();\n                \n                int8_t status_53414 = ((__local int8_t *) local_mem_53368)[(int64_t) 0];\n                \n                if (status_53414 == (int8_t) 2) {\n                    if (local_tid_53361 == 0) {\n                        prefix_53411 = ((volatile __global int64_t *) incprefixes_mem_53356)[dynamic_id_53378 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53415 = sext_i64_i32(dynamic_id_53378 - sext_i32_i64(wave_sizze_53363));\n                    \n                    while (slt32(wave_sizze_53363 * -1, readOffset_53415)) {\n                        int32_t read_i_53416 = readOffset_53415 + local_tid_53361;\n                        int64_t aggr_53417 = (int64_t) 1;\n                        int8_t flag_53418 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53416)) {\n                            flag_53418 = ((volatile __global int8_t *) status_flags_mem_53332)[sext_i32_i64(read_i_53416)];\n                            if (flag_53418 == (int8_t) 2) {\n                                aggr_53417 = ((volatile __global int64_t *) incprefixes_mem_53356)[sext_i32_i64(read_i_53416)];\n                            } else if (flag_53418 == (int8_t) 1) {\n                                aggr_53417 = ((volatile __global int64_t *) aggregates_mem_53354)[sext_i32_i64(read_i_53416)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53368)[(int64_t) 4 + sext_i32_i64(local_tid_53361)] = aggr_53417;\n                        ((__local int8_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = flag_53418;\n                        flag_53418 = ((__local int8_t *) local_mem_53368)[sext_i32_i64(wave_sizze_53363) - (int64_t) 1];\n                        if (slt8(flag_53418, (int8_t) 2)) {\n                            int8_t flg_x_53422;\n                            int8_t flg_y_53423;\n                            in", "t64_t eta_p_53419;\n                            int64_t eta_p_53420;\n                            int32_t skip_threads_53424;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53423 = ((volatile __local int8_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)];\n                                eta_p_53420 = ((volatile __local int64_t *) local_mem_53368)[(int64_t) 4 + sext_i32_i64(local_tid_53361)];\n                                if ((local_tid_53361 - squot32(local_tid_53361, 32) * 32) == 0) {\n                                    eta_p_53419 = eta_p_53420;\n                                    flg_x_53422 = flg_y_53423;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53424 = 1;\n                                while (slt32(skip_threads_53424, 32)) {\n                                    if (sle32(skip_threads_53424, local_tid_53361 - squot32(local_tid_53361, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53422 = ((volatile __local int8_t *) local_mem_53368)[sext_i32_i64(local_tid_53361) - sext_i32_i64(skip_threads_53424)];\n                                            eta_p_53419 = ((volatile __local int64_t *) local_mem_53368)[(int64_t) 4 + (sext_i32_i64(local_tid_53361) - sext_i32_i64(skip_threads_53424))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53423 == (int8_t) 2 || flg_y_53423 == (int8_t) 0) {\n                                                flg_x_53422 = flg_y_53423;\n                                                eta_p_53419 = eta_", "p_53420;\n                                            } else {\n                                                int64_t defunc_0_op_res_53421 = mul64(eta_p_53419, eta_p_53420);\n                                                \n                                                eta_p_53419 = defunc_0_op_res_53421;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53368)[sext_i32_i64(local_tid_53361)] = flg_x_53422;\n                                            flg_y_53423 = flg_x_53422;\n                                            ((volatile __local int64_t *) local_mem_53368)[(int64_t) 4 + sext_i32_i64(local_tid_53361)] = eta_p_53419;\n                                            eta_p_53420 = eta_p_53419;\n                                        }\n                                    }\n                                    skip_threads_53424 *= 2;\n                                }\n                            }\n                        }\n                        flag_53418 = ((__local int8_t *) local_mem_53368)[sext_i32_i64(wave_sizze_53363) - (int64_t) 1];\n                        aggr_53417 = ((__local int64_t *) local_mem_53368)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53363) - (int64_t) 1)];\n                        if (flag_53418 == (int8_t) 2) {\n                            readOffset_53415 = wave_sizze_53363 * -1;\n                        } else if (flag_53418 == (int8_t) 1) {\n                            readOffset_53415 -= wave_sizze_53363;\n                        }\n                        if (slt8((int8_t) 0, flag_53418)) {\n                            int64_t eta_p_53425 = aggr_53417;\n                            int64_t eta_p_53426 = prefix_53411;\n                            int64_t defunc_0_op_res_53427 = mul64(eta_p_53425, eta_p_53426);\n                          ",
                                    "  \n                            prefix_53411 = defunc_0_op_res_53427;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53361 == 0) {\n                    if (boundary_53381 == sext_i64_i32(segscan_tblock_sizze_50598 * chunk_sizze_53329)) {\n                        int64_t eta_p_53428 = prefix_53411;\n                        int64_t eta_p_53429 = acc_53401;\n                        int64_t defunc_0_op_res_53430 = mul64(eta_p_53428, eta_p_53429);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53356)[dynamic_id_53378] = defunc_0_op_res_53430;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53332)[dynamic_id_53378] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53368)[(int64_t) 4] = prefix_53411;\n                    acc_53401 = (int64_t) 1;\n                }\n            }\n            if (!(dynamic_id_53378 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53411 = ((__local int64_t *) local_mem_53368)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53431;\n            int64_t eta_p_53432;\n            int64_t eta_p_53434 = prefix_53411;\n            int64_t eta_p_53435 = acc_53401;\n            \n            if (slt32(local_tid_53361 * chunk_sizze_32b_53365, boundary_53381) && !block_new_sgm_53412) {\n                int64_t defunc_0_op_res_53436 = mul64(eta_p_53434, eta_p_53435);\n                \n                eta_p_53431 = defunc_0_op_res_53436;\n            } else {\n                eta_p_53431 = acc_53401;\n            }\n            \n            int32_t stopping_point_53437 = segsizze_compact_53382 - srem32(local_tid_53361 * chunk_sizze_32b_53365 - 1 + segsizze_compact_53382 - boundary_53381, segsizz", "e_compact_53382);\n            \n            for (int64_t i_53438 = 0; i_53438 < chunk_sizze_53329; i_53438++) {\n                if (slt32(sext_i64_i32(i_53438), stopping_point_53437 - 1)) {\n                    eta_p_53432 = private_mem_53383[i_53438];\n                    \n                    int64_t defunc_0_op_res_53433 = mul64(eta_p_53431, eta_p_53432);\n                    \n                    private_mem_53383[i_53438] = defunc_0_op_res_53433;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53439 = 0; i_53439 < chunk_sizze_53329; i_53439++) {\n                int64_t sharedIdx_53440 = sext_i32_i64(local_tid_53361) * chunk_sizze_53329 + i_53439;\n                int64_t tmp_53441 = private_mem_53383[i_53439];\n                \n                ((__local int64_t *) local_mem_53368)[sharedIdx_53440] = tmp_53441;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53442 = 0; i_53442 < chunk_sizze_53329; i_53442++) {\n                int64_t flat_idx_53443 = thd_offset_53385 + i_53442 * segscan_tblock_sizze_50598;\n                int64_t slice_53444 = dim_33939;\n                int64_t gtid_50602 = flat_idx_53443;\n                int64_t remnant_53445 = flat_idx_53443 - gtid_50602;\n                \n                if (slt64(flat_idx_53443, dim_33939)) {\n                    int64_t tmp_53446 = ((__local int64_t *) local_mem_53368)[flat_idx_53443 - block_offset_53379];\n                    \n                    ((__global int64_t *) mem_52590)[gtid_50602] = tmp_53446;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_50598\n    #undef chunk_sizze_53329\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621ziseghist_global_51265_dim1, 1, 1)\nvoid skyline_local_filter_9621ziseghist_global_51265(__global int *global_failure, int64_t coercez2081Uz2", "080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_tblocks_51260, int64_t num_subhistos_53375, int32_t chk_i_53483, int64_t hist_H_chk_53484, __global unsigned char *mem_52616, __global unsigned char *mem_52683, __global unsigned char *defunc_0_map_res_subhistos_mem_53376, __global unsigned char *defunc_0_map_res_subhistos_mem_53378, __global unsigned char *hist_locks_mem_53461)\n{\n    #define seghist_tblock_sizze_51258 (skyline_local_filter_9621ziseghist_global_51265ziseghist_tblock_sizze_51258)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53486;\n    int32_t tblock_sizze_53489;\n    int32_t wave_sizze_53488;\n    int32_t block_id_53487;\n    int32_t global_tid_53485;\n    int64_t phys_tid_51265;\n    int32_t subhisto_ind_53490;\n    int64_t num_chunks_53491;\n    \n    local_tid_53486 = get_local_id(0);\n    tblock_sizze_53489 = get_local_size(0);\n    wave_sizze_53488 = LOCKSTEP_WIDTH;\n    block_id_53487 = get_tblock_id(0);\n    global_tid_53485 = block_id_53487 * tblock_sizze_53489 + local_tid_53486;\n    phys_tid_51265 = sext_i32_i64(global_tid_53485);\n    subhisto_ind_53490 = squot32(global_tid_53485, sdiv_up32(sext_i64_i32(seghist_tblock_sizze_51258 * num_tblocks_51260), sext_i64_i32(num_subhistos_53375)));\n    num_chunks_53491 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_51258 * num_tblocks_51260)));\n    for (int64_t chunk_i_53492 = 0; chunk_i_53492 < num_chunks_53491; chunk_i_53492++) {\n        int64_t i_53493 = chunk_i_53492 * sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_51258 * num_tblocks_51260)) + sext_i32_i64(global_tid_53485);\n        \n        if (slt64(i_53493, coercez2081Uz2080Uz2084U_32143)) {\n            int64_t slice_53494;\n            int64_t gtid_51264;\n            int64_t remnant_53495;\n            \n            slice_53494 = coercez2081Uz2080Uz2084U_32143;\n            gtid_51264 = i_53493;\n            remnant_53495 = i_53493 - gtid_51264;\n            if (slt64(i_53493, coerc",
                                    "ez2081Uz2080Uz2084U_32143)) {\n                int64_t bucket_p_51279;\n                float img_p_51281;\n                \n                bucket_p_51279 = ((__global int64_t *) mem_52683)[gtid_51264];\n                img_p_51281 = ((__global float *) mem_52616)[gtid_51264];\n                // save map-out results\n                { }\n                // perform atomic updates\n                {\n                    if (sle64(sext_i32_i64(chk_i_53483) * hist_H_chk_53484, bucket_p_51279) && (slt64(bucket_p_51279, sext_i32_i64(chk_i_53483) * hist_H_chk_53484 + hist_H_chk_53484) && (sle64((int64_t) 0, bucket_p_51279) && slt64(bucket_p_51279, total_part_no_32153)))) {\n                        int64_t eta_p_51266;\n                        float eta_p_51267;\n                        int64_t eta_p_51268;\n                        float eta_p_51269;\n                        \n                        eta_p_51268 = gtid_51264;\n                        eta_p_51269 = img_p_51281;\n                        \n                        int32_t old_53496;\n                        volatile bool continue_53497 = 1;\n                        \n                        while (continue_53497) {\n                            old_53496 = atomic_cmpxchg_i32_global(&((volatile __global int *) hist_locks_mem_53461)[srem64(sext_i32_i64(subhisto_ind_53490) * total_part_no_32153 + bucket_p_51279, (int64_t) 100151)], 0, 1);\n                            if (old_53496 == 0) {\n                                int64_t eta_p_51266;\n                                float eta_p_51267;\n                                \n                                // bind lhs\n                                {\n                                    eta_p_51266 = ((volatile __global int64_t *) defunc_0_map_res_subhistos_mem_53376)[sext_i32_i64(subhisto_ind_53490) * total_part_no_32153 + bucket_p_51279];\n                                    eta_p_51267 = ((volatile __global float *) defunc_0_map_res_subhistos_mem_53378)[sext_i32_i64(subhisto_ind_53490)", " * total_part_no_32153 + bucket_p_51279];\n                                }\n                                // execute operation\n                                {\n                                    bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                                    bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                                    bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                                    bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                                    bool x_51274 = !zl_res_51270;\n                                    bool y_51275 = x_51273 && x_51274;\n                                    bool cond_51276 = zl_res_51270 || y_51275;\n                                    int64_t lifted_lambda_res_51277;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51277 = eta_p_51266;\n                                    } else {\n                                        lifted_lambda_res_51277 = eta_p_51268;\n                                    }\n                                    \n                                    float lifted_lambda_res_51278;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51278 = eta_p_51267;\n                                    } else {\n                                        lifted_lambda_res_51278 = eta_p_51269;\n                                    }\n                                    eta_p_51266 = lifted_lambda_res_51277;\n                                    eta_p_51267 = lifted_lambda_res_51278;\n                                }\n                                // update global result\n                                {\n                                    ((__global int64_t *) defunc_0_map_res_subhistos_mem_53376)[sext_i32_i64(subhisto_ind_53490) * total_part_no_3215", "3 + bucket_p_51279] = eta_p_51266;\n                                    mem_fence_global();\n                                    ((__global float *) defunc_0_map_res_subhistos_mem_53378)[sext_i32_i64(subhisto_ind_53490) * total_part_no_32153 + bucket_p_51279] = eta_p_51267;\n                                    mem_fence_global();\n                                }\n                                old_53496 = atomic_cmpxchg_i32_global(&((volatile __global int *) hist_locks_mem_53461)[srem64(sext_i32_i64(subhisto_ind_53490) * total_part_no_32153 + bucket_p_51279, (int64_t) 100151)], 1, 0);\n                                continue_53497 = 0;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_tblock_sizze_51258\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621ziseghist_local_51265_dim1, 1, 1)\nvoid skyline_local_filter_9621ziseghist_local_51265(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_subhistos_53375, int64_t num_tblocks_53388, int32_t hist_M_53394, int32_t chk_i_53398, int64_t num_segments_53399, int64_t hist_H_chk_53400, int64_t histo_sizze_53401, int32_t init_per_thread_53402, __global unsigned char *mem_52616, __global unsigned char *mem_52683, __global unsigned char *defunc_0_map_res_subhistos_mem_53376, __global unsigned char *defunc_0_map_res_subhistos_mem_53378)\n{\n    #define max_tblock_sizze_53387 (skyline_local_filter_9621ziseghist_local_51265zimax_tblock_sizze_53387)\n    \n    volatile __local unsigned char *locks_mem_53420_backing_2 = &shared_mem[0];\n    const int64_t locks_mem_53420_backing_2_offset = 0 + ((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *subhistogram_local_mem_53418_backing_1 = &shared_mem[locks_mem_53420_backing_2_offs",
                                    "et];\n    const int64_t subhistogram_local_mem_53418_backing_1_offset = locks_mem_53420_backing_2_offset + ((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *subhistogram_local_mem_53416_backing_0 = &shared_mem[subhistogram_local_mem_53418_backing_1_offset];\n    const int64_t subhistogram_local_mem_53416_backing_0_offset = subhistogram_local_mem_53418_backing_1_offset + ((int64_t) 8 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 8 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53404;\n    int32_t tblock_sizze_53407;\n    int32_t wave_sizze_53406;\n    int32_t block_id_53405;\n    int32_t global_tid_53403;\n    int64_t phys_tid_51265;\n    int32_t phys_tblock_id_53408;\n    int32_t iterations_53409;\n    \n    local_tid_53404 = get_local_id(0);\n    tblock_sizze_53407 = get_local_size(0);\n    wave_sizze_53406 = LOCKSTEP_WIDTH;\n    block_id_53405 = get_tblock_id(0);\n    global_tid_53403 = block_id_53405 * tblock_sizze_53407 + local_tid_53404;\n    phys_tid_51265 = sext_i32_i64(global_tid_53403);\n    phys_tblock_id_53408 = get_tblock_id(0);\n    iterations_53409 = sdiv_up32(sext_i64_i32(num_tblocks_53388 * num_segments_53399) - phys_tblock_id_53408, sext_i64_i32(num_tblocks_53388));\n    for (int32_t i_53410 = 0; i_53410 < iterations_53409; i_53410++) {\n        int32_t virt_tblock_id_53411;\n        int32_t flat_segment_id_53412;\n        int32_t gid_in_segment_53413;\n        int32_t pgtid_in_segment_53414;\n        int32_t threads_per_segment_53415;\n        __local unsigned char *subhistogram_local_mem_53416;\n        __local unsigned char *subhistogram_local_mem_53418;\n        __local unsigned char *locks_mem_53420;\n        int32_t thread_local_subhisto_i_53425;\n        int64_t num_chunks_53438;\n        \n        virt_tblo", "ck_id_53411 = phys_tblock_id_53408 + i_53410 * sext_i64_i32(num_tblocks_53388);\n        flat_segment_id_53412 = squot32(virt_tblock_id_53411, sext_i64_i32(num_tblocks_53388));\n        gid_in_segment_53413 = srem32(virt_tblock_id_53411, sext_i64_i32(num_tblocks_53388));\n        pgtid_in_segment_53414 = gid_in_segment_53413 * sext_i64_i32(max_tblock_sizze_53387) + local_tid_53404;\n        threads_per_segment_53415 = sext_i64_i32(num_tblocks_53388 * max_tblock_sizze_53387);\n        subhistogram_local_mem_53416 = (__local unsigned char *) subhistogram_local_mem_53416_backing_0;\n        subhistogram_local_mem_53418 = (__local unsigned char *) subhistogram_local_mem_53418_backing_1;\n        locks_mem_53420 = (__local unsigned char *) locks_mem_53420_backing_2;\n        // All locks start out unlocked\n        {\n            int64_t num_chunks_53422 = sdiv_up64(hist_M_53394 * hist_H_chk_53400, max_tblock_sizze_53387);\n            \n            for (int64_t chunk_i_53423 = 0; chunk_i_53423 < num_chunks_53422; chunk_i_53423++) {\n                int64_t i_53424 = chunk_i_53423 * max_tblock_sizze_53387 + sext_i32_i64(local_tid_53404);\n                \n                if (slt64(i_53424, hist_M_53394 * hist_H_chk_53400)) {\n                    ((__local int32_t *) locks_mem_53420)[squot64(i_53424, hist_H_chk_53400) * hist_H_chk_53400 + (i_53424 - squot64(i_53424, hist_H_chk_53400) * hist_H_chk_53400)] = 0;\n                }\n            }\n        }\n        thread_local_subhisto_i_53425 = srem32(local_tid_53404, hist_M_53394);\n        // initialize histograms in shared memory\n        {\n            for (int32_t local_i_53426 = 0; local_i_53426 < init_per_thread_53402; local_i_53426++) {\n                int32_t j_53427 = local_i_53426 * sext_i64_i32(max_tblock_sizze_53387) + local_tid_53404;\n                int32_t j_offset_53428 = hist_M_53394 * sext_i64_i32(histo_sizze_53401) * gid_in_segment_53413 + j_53427;\n                int32_t local_subhisto_i_53429 = squot32(j_53427, sext_i64_i3", "2(histo_sizze_53401));\n                int32_t global_subhisto_i_53430 = squot32(j_offset_53428, sext_i64_i32(histo_sizze_53401));\n                \n                if (slt32(j_53427, hist_M_53394 * sext_i64_i32(histo_sizze_53401))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_53430 == 0 && ((sle64((int64_t) 0, (int64_t) 0) && slt64((int64_t) 0, num_subhistos_53375)) && (sle64((int64_t) 0, sext_i32_i64(srem32(j_53427, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400) && slt64(sext_i32_i64(srem32(j_53427, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400, total_part_no_32153)))) {\n                            int64_t tmp_53431 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_53376)[sext_i32_i64(srem32(j_53427, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400];\n                            \n                            ((__local int64_t *) subhistogram_local_mem_53416)[sext_i32_i64(local_subhisto_i_53429) * hist_H_chk_53400 + sext_i32_i64(srem32(j_53427, sext_i64_i32(histo_sizze_53401)))] = tmp_53431;\n                        } else {\n                            ((__local int64_t *) subhistogram_local_mem_53416)[sext_i32_i64(local_subhisto_i_53429) * hist_H_chk_53400 + sext_i32_i64(srem32(j_53427, sext_i64_i32(histo_sizze_53401)))] = coercez2081Uz2080Uz2084U_32143;\n                        }\n                    }\n                }\n            }\n            for (int32_t local_i_53432 = 0; local_i_53432 < init_per_thread_53402; local_i_53432++) {\n                int32_t j_53433 = local_i_53432 * sext_i64_i32(max_tblock_sizze_53387) + local_tid_53404;\n                int32_t j_offset_53434 = hist_M_53394 * sext_i64_i32(histo_sizze_53401) * gid_in_segment_53413 + j_53433;\n                int32_t local_subhisto_i_53435 = squot32(j_53433, sext_i64_i32(",
                                    "histo_sizze_53401));\n                int32_t global_subhisto_i_53436 = squot32(j_offset_53434, sext_i64_i32(histo_sizze_53401));\n                \n                if (slt32(j_53433, hist_M_53394 * sext_i64_i32(histo_sizze_53401))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_53436 == 0 && ((sle64((int64_t) 0, (int64_t) 0) && slt64((int64_t) 0, num_subhistos_53375)) && (sle64((int64_t) 0, sext_i32_i64(srem32(j_53433, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400) && slt64(sext_i32_i64(srem32(j_53433, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400, total_part_no_32153)))) {\n                            float tmp_53437 = ((__global float *) defunc_0_map_res_subhistos_mem_53378)[sext_i32_i64(srem32(j_53433, sext_i64_i32(histo_sizze_53401))) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400];\n                            \n                            ((__local float *) subhistogram_local_mem_53418)[sext_i32_i64(local_subhisto_i_53435) * hist_H_chk_53400 + sext_i32_i64(srem32(j_53433, sext_i64_i32(histo_sizze_53401)))] = tmp_53437;\n                        } else {\n                            ((__local float *) subhistogram_local_mem_53418)[sext_i32_i64(local_subhisto_i_53435) * hist_H_chk_53400 + sext_i32_i64(srem32(j_53433, sext_i64_i32(histo_sizze_53401)))] = INFINITY;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        num_chunks_53438 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, sext_i32_i64(threads_per_segment_53415));\n        for (int64_t chunk_i_53439 = 0; chunk_i_53439 < num_chunks_53438; chunk_i_53439++) {\n            int64_t i_53440 = chunk_i_53439 * sext_i32_i64(threads_per_segment_53415) + sext_i32_i64(pgtid_in_segment_53414);\n            \n            if (slt64(i_53440, coercez2081Uz2080Uz", "2084U_32143)) {\n                int64_t gtid_51264;\n                int64_t bucket_p_51279;\n                float img_p_51281;\n                \n                gtid_51264 = i_53440;\n                bucket_p_51279 = ((__global int64_t *) mem_52683)[gtid_51264];\n                img_p_51281 = ((__global float *) mem_52616)[gtid_51264];\n                if (chk_i_53398 == 0) {\n                    // save map-out results\n                    { }\n                }\n                // perform atomic updates\n                {\n                    if ((sle64((int64_t) 0, bucket_p_51279) && slt64(bucket_p_51279, total_part_no_32153)) && (sle64(sext_i32_i64(chk_i_53398) * hist_H_chk_53400, bucket_p_51279) && slt64(bucket_p_51279, sext_i32_i64(chk_i_53398) * hist_H_chk_53400 + hist_H_chk_53400))) {\n                        int64_t eta_p_51266;\n                        float eta_p_51267;\n                        int64_t eta_p_51268;\n                        float eta_p_51269;\n                        \n                        eta_p_51268 = gtid_51264;\n                        eta_p_51269 = img_p_51281;\n                        \n                        int32_t old_53441;\n                        volatile bool continue_53442 = 1;\n                        \n                        while (continue_53442) {\n                            old_53441 = atomic_cmpxchg_i32_shared(&((volatile __local int *) locks_mem_53420)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400)], 0, 1);\n                            if (old_53441 == 0) {\n                                int64_t eta_p_51266;\n                                float eta_p_51267;\n                                \n                                // bind lhs\n                                {\n                                    eta_p_51266 = ((volatile __local int64_t *) subhistogram_local_mem_53416)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 ", "- sext_i32_i64(chk_i_53398) * hist_H_chk_53400)];\n                                    eta_p_51267 = ((volatile __local float *) subhistogram_local_mem_53418)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400)];\n                                }\n                                // execute operation\n                                {\n                                    bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                                    bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                                    bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                                    bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                                    bool x_51274 = !zl_res_51270;\n                                    bool y_51275 = x_51273 && x_51274;\n                                    bool cond_51276 = zl_res_51270 || y_51275;\n                                    int64_t lifted_lambda_res_51277;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51277 = eta_p_51266;\n                                    } else {\n                                        lifted_lambda_res_51277 = eta_p_51268;\n                                    }\n                                    \n                                    float lifted_lambda_res_51278;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51278 = eta_p_51267;\n                                    } else {\n                                        lifted_lambda_res_51278 = eta_p_51269;\n                                    }\n                                    eta_p_51266 = lifted_lambda_res_51277;\n                                    eta_p_51267 = lifted_lambda_res_51278;\n                          ",
                                    "      }\n                                // update global result\n                                {\n                                    ((__local int64_t *) subhistogram_local_mem_53416)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400)] = eta_p_51266;\n                                    mem_fence_local();\n                                    ((__local float *) subhistogram_local_mem_53418)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400)] = eta_p_51267;\n                                    mem_fence_local();\n                                }\n                                old_53441 = atomic_cmpxchg_i32_shared(&((volatile __local int *) locks_mem_53420)[sext_i32_i64(thread_local_subhisto_i_53425) * hist_H_chk_53400 + (bucket_p_51279 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400)], 1, 0);\n                                continue_53442 = 0;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple shared memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_53443 = smin64(hist_H_chk_53400, total_part_no_32153 - sext_i32_i64(chk_i_53398) * hist_H_chk_53400);\n            int32_t histo_sizze_53444 = sext_i64_i32(trunc_H_53443);\n            \n            for (int32_t local_i_53445 = 0; local_i_53445 < init_per_thread_53402; local_i_53445++) {\n                int32_t j_53446 = local_i_53445 * sext_i64_i32(max_tblock_sizze_53387) + local_tid_53404;\n                \n                if (slt32(j_53446, histo_sizze_53444)) {\n                    int64_t eta_p_51266;\n                    float eta_p_51267;\n                    int64_t eta_p_51268;\n                    float eta_p_51269;\n                    \n                    // Read values from", " subhistogram 0.\n                    {\n                        eta_p_51266 = ((__local int64_t *) subhistogram_local_mem_53416)[sext_i32_i64(j_53446)];\n                        eta_p_51267 = ((__local float *) subhistogram_local_mem_53418)[sext_i32_i64(j_53446)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_53447 = 0; subhisto_id_53447 < hist_M_53394 - 1; subhisto_id_53447++) {\n                            eta_p_51268 = ((__local int64_t *) subhistogram_local_mem_53416)[(sext_i32_i64(subhisto_id_53447) + (int64_t) 1) * hist_H_chk_53400 + sext_i32_i64(j_53446)];\n                            eta_p_51269 = ((__local float *) subhistogram_local_mem_53418)[(sext_i32_i64(subhisto_id_53447) + (int64_t) 1) * hist_H_chk_53400 + sext_i32_i64(j_53446)];\n                            \n                            bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                            bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                            bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                            bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                            bool x_51274 = !zl_res_51270;\n                            bool y_51275 = x_51273 && x_51274;\n                            bool cond_51276 = zl_res_51270 || y_51275;\n                            int64_t lifted_lambda_res_51277;\n                            \n                            if (cond_51276) {\n                                lifted_lambda_res_51277 = eta_p_51266;\n                            } else {\n                                lifted_lambda_res_51277 = eta_p_51268;\n                            }\n                            \n                            float lifted_lambda_res_51278;\n                            \n                            if (cond_51276) {\n                                lifted_lambda_res_51278 = eta_p_51267;", "\n                            } else {\n                                lifted_lambda_res_51278 = eta_p_51269;\n                            }\n                            eta_p_51266 = lifted_lambda_res_51277;\n                            eta_p_51267 = lifted_lambda_res_51278;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global int64_t *) defunc_0_map_res_subhistos_mem_53376)[srem64(sext_i32_i64(virt_tblock_id_53411), num_tblocks_53388) * total_part_no_32153 + (sext_i32_i64(j_53446) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400)] = eta_p_51266;\n                        ((__global float *) defunc_0_map_res_subhistos_mem_53378)[srem64(sext_i32_i64(virt_tblock_id_53411), num_tblocks_53388) * total_part_no_32153 + (sext_i32_i64(j_53446) + sext_i32_i64(chk_i_53398) * hist_H_chk_53400)] = eta_p_51267;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_2:\n    return;\n    #undef max_tblock_sizze_53387\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_50688_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_50688(__global int *global_failure, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, __global unsigned char *angle_partitions_per_dim_mem_52562, __global unsigned char *mem_52572)\n{\n    #define segmap_tblock_sizze_50684 (skyline_local_filter_9621zisegmap_50688zisegmap_tblock_sizze_50684)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53223;\n    int32_t tblock_sizze_53226;\n    int32_t wave_sizze_53225;\n    int32_t block_id_53224;\n    int32_t global_tid_53222;\n    int64_t phys_tid_50688;\n    int64_t global_tid_53227;\n    int64_t slice_53228;\n    int64_t gtid_50687;\n    int64_t remnant_53229;\n    \n    local_tid_53223 = get_local_id(0);\n    tblock_sizze_53226 = get_local_size(0);\n    wave_sizze_53225 = LOCKSTEP_WIDTH;\n    block_id_53224 = get_t",
                                    "block_id(0);\n    global_tid_53222 = block_id_53224 * tblock_sizze_53226 + local_tid_53223;\n    phys_tid_50688 = sext_i32_i64(global_tid_53222);\n    global_tid_53227 = sext_i32_i64(block_id_53224) * segmap_tblock_sizze_50684 + sext_i32_i64(local_tid_53223);\n    slice_53228 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141;\n    gtid_50687 = global_tid_53227;\n    remnant_53229 = global_tid_53227 - gtid_50687;\n    if (slt64(gtid_50687, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141)) {\n        int64_t from_i64_arg0_50694;\n        float i64_res_50695;\n        float zs_res_50696;\n        \n        from_i64_arg0_50694 = ((__global int64_t *) angle_partitions_per_dim_mem_52562)[gtid_50687];\n        i64_res_50695 = sitofp_i64_f32(from_i64_arg0_50694);\n        zs_res_50696 = 1.5707964F / i64_res_50695;\n        ((__global float *) mem_52572)[gtid_50687] = zs_res_50696;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_50684\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51079_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51079(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *grid_part_prefix_sum_mem_52563, __global unsigned char *grid_part_sizze_per_dim_mem_52564, __global unsigned char *grid_partitions_per_dim_mem_52565, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52576)\n{\n    #define segmap_tblock_sizze_51074 (skyline_local_filter_9621zisegmap_51079zisegmap_tblock_sizze_51074)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53232;\n    int32_t tblock_sizze_53235;\n    int32_t wave_sizze_53234;\n    int32_t block_id_53233;\n    int32_t global_tid_53231;\n    int64_t phys_tid_51079;\n    int64_t global_tid_53236;\n    int64_t slice_53237;\n    int64_t slice_53238;\n    int64_t gtid_51077;\n    int64_t remnant_53239;\n    int64_t gtid_51078;\n    int64_t remnant_53240;\n    \n    local_tid_53232 = get_local_id(0);", "\n    tblock_sizze_53235 = get_local_size(0);\n    wave_sizze_53234 = LOCKSTEP_WIDTH;\n    block_id_53233 = get_tblock_id(0);\n    global_tid_53231 = block_id_53233 * tblock_sizze_53235 + local_tid_53232;\n    phys_tid_51079 = sext_i32_i64(global_tid_53231);\n    global_tid_53236 = sext_i32_i64(block_id_53233) * segmap_tblock_sizze_51074 + sext_i32_i64(local_tid_53232);\n    slice_53237 = dim_32139;\n    slice_53238 = coercez2081Uz2080Uz2084U_32143 * slice_53237;\n    gtid_51077 = squot64(global_tid_53236, slice_53237);\n    remnant_53239 = global_tid_53236 - gtid_51077 * slice_53237;\n    gtid_51078 = remnant_53239;\n    remnant_53240 = remnant_53239 - gtid_51078;\n    if (slt64(gtid_51077, coercez2081Uz2080Uz2084U_32143) && slt64(gtid_51078, dim_32139)) {\n        float eta_p_51080;\n        float eta_p_51081;\n        float eta_p_51082;\n        int64_t eta_p_51084;\n        float zm_res_51085;\n        float zs_res_51086;\n        int64_t to_i64_res_51087;\n        int64_t max_res_51088;\n        int64_t zm_lhs_51093;\n        int64_t min_arg1_51094;\n        int64_t min_res_51095;\n        int64_t defunc_0_f_res_51096;\n        \n        eta_p_51080 = ((__global float *) xys_mem_52568)[gtid_51077 * dim_32139 + gtid_51078];\n        eta_p_51081 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51078];\n        eta_p_51082 = ((__global float *) grid_part_sizze_per_dim_mem_52564)[gtid_51078];\n        eta_p_51084 = ((__global int64_t *) grid_part_prefix_sum_mem_52563)[gtid_51078];\n        zm_res_51085 = eta_p_51080 - eta_p_51081;\n        zs_res_51086 = zm_res_51085 / eta_p_51082;\n        to_i64_res_51087 = fptosi_f32_i64(zs_res_51086);\n        max_res_51088 = smax64((int64_t) 0, to_i64_res_51087);\n        zm_lhs_51093 = ((__global int64_t *) grid_partitions_per_dim_mem_52565)[gtid_51078];\n        min_arg1_51094 = sub64(zm_lhs_51093, (int64_t) 1);\n        min_res_51095 = smin64(max_res_51088, min_arg1_51094);\n        defunc_0_f_res_51096 = mul64(eta_p_51084, min_res_51095);\n        ", "((__global int64_t *) mem_52576)[gtid_51077 * dim_32139 + gtid_51078] = defunc_0_f_res_51096;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51074\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51104_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51104(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_32139, int64_t dz2080U_32140, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *mem_52587, __global unsigned char *mem_52589, __global unsigned char *mem_52591)\n{\n    #define segmap_tblock_sizze_51099 (skyline_local_filter_9621zisegmap_51104zisegmap_tblock_sizze_51099)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53243;\n    int32_t tblock_sizze_53246;\n    int32_t wave_sizze_53245;\n    int32_t block_id_53244;\n    int32_t global_tid_53242;\n    int64_t phys_tid_51104;\n    int64_t global_tid_53247;\n    int64_t slice_53248;\n    int64_t gtid_51103;\n    int64_t remnant_53249;\n    \n    local_tid_53243 = get_local_id(0);\n    tblock_sizze_53246 = get_local_size(0);\n    wave_sizze_53245 = LOCKSTEP_WIDTH;\n    block_id_53244 = get_tblock_id(0);\n    global_tid_53242 = block_id_53244 * tblock_sizze_53246 + local_tid_53243;\n    phys_tid_51104 = sext_i32_i64(global_tid_53242);\n    global_tid_53247 = sext_i32_i64(block_id_53244) * segmap_tblock_sizze_51099 + sext_i32_i64(local_tid_53243);\n    slice_53248 = coercez2081Uz2080Uz2084U_32143;\n    gtid_51103 = global_tid_53247;\n    remnant_53249 = global_tid_53247 - gtid_51103;\n    if (slt64(gtid_51103, coercez2081Uz2080Uz2084U_32143)) {\n        int64_t defunc_0_foldl_res_51106;\n        int64_t acc_51108;\n        bool x_51111;\n        bool y_51112;\n        bool bounds_check_51113;\n        bool index_certs_51114;\n        \n        acc_51108 = (int64_t) 0;\n        for (int64_t i_51107 = 0; i_51107 < dim_32139; i_51107++) {\n            int64_t b_51109;\n            int64_t defunc_0_f_res_51110;\n            int64_t acc_",
                                    "tmp_53250;\n            \n            b_51109 = ((__global int64_t *) mem_52587)[gtid_51103 + i_51107 * coercez2081Uz2080Uz2084U_32143];\n            defunc_0_f_res_51110 = add64(acc_51108, b_51109);\n            acc_tmp_53250 = defunc_0_f_res_51110;\n            acc_51108 = acc_tmp_53250;\n        }\n        defunc_0_foldl_res_51106 = acc_51108;\n        x_51111 = sle64((int64_t) 0, defunc_0_foldl_res_51106);\n        y_51112 = slt64(defunc_0_foldl_res_51106, dz2080U_32140);\n        bounds_check_51113 = x_51111 && y_51112;\n        if (!bounds_check_51113) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                    global_failure_args[0] = (int64_t) defunc_0_foldl_res_51106;\n                    global_failure_args[1] = (int64_t) dz2080U_32140;\n                    ;\n                }\n                return;\n            }\n        }\n        ((__global int64_t *) mem_52591)[gtid_51103] = defunc_0_foldl_res_51106;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51099\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51122_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51122(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52589, __global unsigned char *mem_52591, __global unsigned char *mem_52595)\n{\n    #define segmap_tblock_sizze_51117 (skyline_local_filter_9621zisegmap_51122zisegmap_tblock_sizze_51117)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53253;\n    int32_t tblock_sizze_53256;\n    int32_t wave_sizze_53255;\n    int32_t block_id_53254;\n    int32_t global_tid_53252;\n    int64_t phys_tid_51122;\n    int64_t global_tid_53257;\n    int64_t slice_53258;\n    int64_t slice_53259;\n    int64_t gtid_51121;\n    int64_t remnant_53260;\n    int64_t gtid_slice_51120;\n    int64_t remnant_53261;\n    \n    local_tid_53253 = get_local_id(0);\n    tblock_sizze_5", "3256 = get_local_size(0);\n    wave_sizze_53255 = LOCKSTEP_WIDTH;\n    block_id_53254 = get_tblock_id(0);\n    global_tid_53252 = block_id_53254 * tblock_sizze_53256 + local_tid_53253;\n    phys_tid_51122 = sext_i32_i64(global_tid_53252);\n    global_tid_53257 = sext_i32_i64(block_id_53254) * segmap_tblock_sizze_51117 + sext_i32_i64(local_tid_53253);\n    slice_53258 = dim_32139;\n    slice_53259 = coercez2081Uz2080Uz2084U_32143 * slice_53258;\n    gtid_51121 = squot64(global_tid_53257, slice_53258);\n    remnant_53260 = global_tid_53257 - gtid_51121 * slice_53258;\n    gtid_slice_51120 = remnant_53260;\n    remnant_53261 = remnant_53260 - gtid_slice_51120;\n    if (slt64(gtid_51121, coercez2081Uz2080Uz2084U_32143) && slt64(gtid_slice_51120, dim_32139)) {\n        bool index_certs_51123;\n        int64_t defunc_0_foldl_res_51124;\n        float v_51125;\n        \n        index_certs_51123 = 0;\n        defunc_0_foldl_res_51124 = ((__global int64_t *) mem_52591)[gtid_51121];\n        v_51125 = ((__global float *) start_of_grid_partition_mem_52566)[defunc_0_foldl_res_51124 * dim_32139 + gtid_slice_51120];\n        ((__global float *) mem_52595)[gtid_51121 * dim_32139 + gtid_slice_51120] = v_51125;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51117\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51138_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51138(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52595, __global unsigned char *mem_52599, __global unsigned char *mem_52602)\n{\n    #define segmap_tblock_sizze_51132 (skyline_local_filter_9621zisegmap_51138zisegmap_tblock_sizze_51132)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53264;\n    int32_t tblock_sizze_53267;\n    int32_t wave_sizze_53266;\n    int32_t block_id_53265;\n    int32_t global_tid_53263;\n    int64_t phys_tid_51138;\n    int64_t global_tid_53268;\n    int64_t s", "lice_53269;\n    int64_t slice_53270;\n    int64_t gtid_51136;\n    int64_t remnant_53271;\n    int64_t gtid_51137;\n    int64_t remnant_53272;\n    \n    local_tid_53264 = get_local_id(0);\n    tblock_sizze_53267 = get_local_size(0);\n    wave_sizze_53266 = LOCKSTEP_WIDTH;\n    block_id_53265 = get_tblock_id(0);\n    global_tid_53263 = block_id_53265 * tblock_sizze_53267 + local_tid_53264;\n    phys_tid_51138 = sext_i32_i64(global_tid_53263);\n    global_tid_53268 = sext_i32_i64(block_id_53265) * segmap_tblock_sizze_51132 + sext_i32_i64(local_tid_53264);\n    slice_53269 = dim_32139;\n    slice_53270 = coercez2081Uz2080Uz2084U_32143 * slice_53269;\n    gtid_51136 = squot64(global_tid_53268, slice_53269);\n    remnant_53271 = global_tid_53268 - gtid_51136 * slice_53269;\n    gtid_51137 = remnant_53271;\n    remnant_53272 = remnant_53271 - gtid_51137;\n    if (slt64(gtid_51136, coercez2081Uz2080Uz2084U_32143) && slt64(gtid_51137, dim_32139)) {\n        float eta_p_51139;\n        float eta_p_51140;\n        float zm_res_51141;\n        float zt_res_51142;\n        \n        eta_p_51139 = ((__global float *) xys_mem_52568)[gtid_51136 * dim_32139 + gtid_51137];\n        eta_p_51140 = ((__global float *) mem_52595)[gtid_51136 * dim_32139 + gtid_51137];\n        zm_res_51141 = eta_p_51139 - eta_p_51140;\n        zt_res_51142 = zm_res_51141 * zm_res_51141;\n        ((__global float *) mem_52599)[gtid_51136 * dim_32139 + gtid_51137] = zt_res_51142;\n        ((__global float *) mem_52602)[gtid_51136 * dim_32139 + gtid_51137] = zm_res_51141;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51132\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51150_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51150(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *mem_52613, __global unsigned char *mem_52616)\n{\n    #define segmap_tblock_sizze_51146 (skyline_local_filter_9621zisegmap_51150zisegmap_tblock_sizze_51146)\n    if (*glob",
                                    "al_failure >= 0)\n        return;\n    \n    int32_t local_tid_53275;\n    int32_t tblock_sizze_53278;\n    int32_t wave_sizze_53277;\n    int32_t block_id_53276;\n    int32_t global_tid_53274;\n    int64_t phys_tid_51150;\n    int64_t global_tid_53279;\n    int64_t slice_53280;\n    int64_t gtid_51149;\n    int64_t remnant_53281;\n    \n    local_tid_53275 = get_local_id(0);\n    tblock_sizze_53278 = get_local_size(0);\n    wave_sizze_53277 = LOCKSTEP_WIDTH;\n    block_id_53276 = get_tblock_id(0);\n    global_tid_53274 = block_id_53276 * tblock_sizze_53278 + local_tid_53275;\n    phys_tid_51150 = sext_i32_i64(global_tid_53274);\n    global_tid_53279 = sext_i32_i64(block_id_53276) * segmap_tblock_sizze_51146 + sext_i32_i64(local_tid_53275);\n    slice_53280 = coercez2081Uz2080Uz2084U_32143;\n    gtid_51149 = global_tid_53279;\n    remnant_53281 = global_tid_53279 - gtid_51149;\n    if (slt64(gtid_51149, coercez2081Uz2080Uz2084U_32143)) {\n        float defunc_0_f_res_51152;\n        float acc_51154;\n        float sqrt_res_51157;\n        \n        acc_51154 = 0.0F;\n        for (int64_t i_51153 = 0; i_51153 < dim_32139; i_51153++) {\n            float b_51155;\n            float zp_res_51156;\n            float acc_tmp_53282;\n            \n            b_51155 = ((__global float *) mem_52613)[gtid_51149 + i_51153 * coercez2081Uz2080Uz2084U_32143];\n            zp_res_51156 = acc_51154 + b_51155;\n            acc_tmp_53282 = zp_res_51156;\n            acc_51154 = acc_tmp_53282;\n        }\n        defunc_0_f_res_51152 = acc_51154;\n        sqrt_res_51157 = futrts_sqrt32(defunc_0_f_res_51152);\n        ((__global float *) mem_52616)[gtid_51149] = sqrt_res_51157;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51146\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51192_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51192(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, int64_t arg_51163, int64_t dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz", "7dUzg_51164, __global unsigned char *mem_52602, __global unsigned char *mem_52627)\n{\n    #define segmap_tblock_sizze_51187 (skyline_local_filter_9621zisegmap_51192zisegmap_tblock_sizze_51187)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53310;\n    int32_t tblock_sizze_53313;\n    int32_t wave_sizze_53312;\n    int32_t block_id_53311;\n    int32_t global_tid_53309;\n    int64_t phys_tid_51192;\n    int64_t global_tid_53314;\n    int64_t slice_53315;\n    int64_t slice_53316;\n    int64_t gtid_51190;\n    int64_t remnant_53317;\n    int64_t gtid_51191;\n    int64_t remnant_53318;\n    \n    local_tid_53310 = get_local_id(0);\n    tblock_sizze_53313 = get_local_size(0);\n    wave_sizze_53312 = LOCKSTEP_WIDTH;\n    block_id_53311 = get_tblock_id(0);\n    global_tid_53309 = block_id_53311 * tblock_sizze_53313 + local_tid_53310;\n    phys_tid_51192 = sext_i32_i64(global_tid_53309);\n    global_tid_53314 = sext_i32_i64(block_id_53311) * segmap_tblock_sizze_51187 + sext_i32_i64(local_tid_53310);\n    slice_53315 = dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164;\n    slice_53316 = coercez2081Uz2080Uz2084U_32143 * slice_53315;\n    gtid_51190 = squot64(global_tid_53314, slice_53315);\n    remnant_53317 = global_tid_53314 - gtid_51190 * slice_53315;\n    gtid_51191 = remnant_53317;\n    remnant_53318 = remnant_53317 - gtid_51191;\n    if (slt64(gtid_51190, coercez2081Uz2080Uz2084U_32143) && slt64(gtid_51191, dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164)) {\n        int64_t slice_52162;\n        float eta_p_51193;\n        float zt_res_51194;\n        \n        slice_52162 = arg_51163 + gtid_51191;\n        eta_p_51193 = ((__global float *) mem_52602)[gtid_51190 * dim_32139 + slice_52162];\n        zt_res_51194 = eta_p_51193 * eta_p_51193;\n        ((__global float *) mem_52627)[gtid_51190 * dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164 + gtid_51191] = zt_res_51194;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51187\n}\nFUTHARK_KERNE", "L_SIZED(skyline_local_filter_9621zisegmap_51202_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51202(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, int64_t i_51161, int64_t dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, int64_t num_tblocks_51198, int32_t virt_num_tblocks_53319, __global unsigned char *mem_52602, __global unsigned char *mem_52638, __global unsigned char *mem_52649, __global unsigned char *mem_52661)\n{\n    #define segmap_tblock_sizze_51197 (skyline_local_filter_9621zisegmap_51202zisegmap_tblock_sizze_51197)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53321;\n    int32_t tblock_sizze_53324;\n    int32_t wave_sizze_53323;\n    int32_t block_id_53322;\n    int32_t global_tid_53320;\n    int64_t phys_tid_51202;\n    int32_t phys_tblock_id_53325;\n    int32_t iterations_53326;\n    \n    local_tid_53321 = get_local_id(0);\n    tblock_sizze_53324 = get_local_size(0);\n    wave_sizze_53323 = LOCKSTEP_WIDTH;\n    block_id_53322 = get_tblock_id(0);\n    global_tid_53320 = block_id_53322 * tblock_sizze_53324 + local_tid_53321;\n    phys_tid_51202 = sext_i32_i64(global_tid_53320);\n    phys_tblock_id_53325 = get_tblock_id(0);\n    iterations_53326 = sdiv_up32(virt_num_tblocks_53319 - phys_tblock_id_53325, sext_i64_i32(num_tblocks_51198));\n    for (int32_t i_53327 = 0; i_53327 < iterations_53326; i_53327++) {\n        int32_t virt_tblock_id_53328;\n        int64_t global_tid_53329;\n        int64_t slice_53330;\n        int64_t gtid_51201;\n        int64_t remnant_53331;\n        \n        virt_tblock_id_53328 = phys_tblock_id_53325 + i_53327 * sext_i64_i32(num_tblocks_51198);\n        global_tid_53329 = sext_i32_i64(virt_tblock_id_53328) * segmap_tblock_sizze_51197 + sext_i32_i64(local_tid_53321);\n        slice_53330 = coercez2081Uz2080Uz2084U_32143;\n        gtid_51201 = global_tid_53329;\n        remnant_53331 = global_tid_53329 - gtid_51201;\n        if (",
                                    "slt64(gtid_51201, coercez2081Uz2080Uz2084U_32143)) {\n            float defunc_0_map_res_r_transformed_row_51204;\n            float defunc_0_f_res_51206;\n            float acc_51208;\n            float sqrt_res_51211;\n            float atan2_res_51212;\n            \n            defunc_0_map_res_r_transformed_row_51204 = ((__global float *) mem_52602)[gtid_51201 * dim_32139 + i_51161];\n            acc_51208 = 0.0F;\n            for (int64_t i_51207 = 0; i_51207 < dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164; i_51207++) {\n                float b_51209;\n                float zp_res_51210;\n                float acc_tmp_53332;\n                \n                b_51209 = ((__global float *) mem_52649)[gtid_51201 + i_51207 * coercez2081Uz2080Uz2084U_32143];\n                zp_res_51210 = acc_51208 + b_51209;\n                acc_tmp_53332 = zp_res_51210;\n                acc_51208 = acc_tmp_53332;\n            }\n            defunc_0_f_res_51206 = acc_51208;\n            sqrt_res_51211 = futrts_sqrt32(defunc_0_f_res_51206);\n            atan2_res_51212 = futrts_atan2_32(sqrt_res_51211, defunc_0_map_res_r_transformed_row_51204);\n            ((__global float *) mem_52638)[gtid_51201 + i_51161 * coercez2081Uz2080Uz2084U_32143] = atan2_res_51212;\n            for (int64_t i_0 = 0; i_0 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403; i_0++) {\n                ((__global float *) mem_52661)[gtid_51201 + i_0 * coercez2081Uz2080Uz2084U_32143] = ((__global float *) mem_52638)[gtid_51201 + i_0 * coercez2081Uz2080Uz2084U_32143];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51197\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51226_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51226(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, int64_t ext_52662, int64_t ext_52663, __global unsigned char *angle_part_prefix", "_sum_mem_52561, __global unsigned char *angle_partitions_per_dim_mem_52562, __global unsigned char *mem_52572, __global unsigned char *ext_mem_52665, __global unsigned char *mem_52669)\n{\n    #define segmap_tblock_sizze_51221 (skyline_local_filter_9621zisegmap_51226zisegmap_tblock_sizze_51221)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53335;\n    int32_t tblock_sizze_53338;\n    int32_t wave_sizze_53337;\n    int32_t block_id_53336;\n    int32_t global_tid_53334;\n    int64_t phys_tid_51226;\n    int64_t global_tid_53339;\n    int64_t slice_53340;\n    int64_t slice_53341;\n    int64_t gtid_51224;\n    int64_t remnant_53342;\n    int64_t gtid_51225;\n    int64_t remnant_53343;\n    \n    local_tid_53335 = get_local_id(0);\n    tblock_sizze_53338 = get_local_size(0);\n    wave_sizze_53337 = LOCKSTEP_WIDTH;\n    block_id_53336 = get_tblock_id(0);\n    global_tid_53334 = block_id_53336 * tblock_sizze_53338 + local_tid_53335;\n    phys_tid_51226 = sext_i32_i64(global_tid_53334);\n    global_tid_53339 = sext_i32_i64(block_id_53336) * segmap_tblock_sizze_51221 + sext_i32_i64(local_tid_53335);\n    slice_53340 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403;\n    slice_53341 = coercez2081Uz2080Uz2084U_32143 * slice_53340;\n    gtid_51224 = squot64(global_tid_53339, slice_53340);\n    remnant_53342 = global_tid_53339 - gtid_51224 * slice_53340;\n    gtid_51225 = remnant_53342;\n    remnant_53343 = remnant_53342 - gtid_51225;\n    if (slt64(gtid_51224, coercez2081Uz2080Uz2084U_32143) && slt64(gtid_51225, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403)) {\n        float eta_p_51227;\n        float eta_p_51228;\n        int64_t eta_p_51229;\n        float i64_res_51231;\n        float zs_res_51232;\n        float zt_res_51233;\n        int64_t to_i64_res_51234;\n        bool cond_51235;\n        int64_t lifted_lambda_res_51236;\n        \n        eta_p_51227 = ((__global float *) ext_mem_52665)[gtid_51224 * ext_52663 + gtid_51225 * ext_52662];\n        eta_p_51228 = ((__global float *) mem_52572)[gtid_", "51225];\n        eta_p_51229 = ((__global int64_t *) angle_part_prefix_sum_mem_52561)[gtid_51225];\n        i64_res_51231 = sitofp_i64_f32(eta_p_51229);\n        zs_res_51232 = eta_p_51227 / eta_p_51228;\n        zt_res_51233 = i64_res_51231 * zs_res_51232;\n        to_i64_res_51234 = fptosi_f32_i64(zt_res_51233);\n        cond_51235 = slt64(to_i64_res_51234, (int64_t) 0);\n        if (cond_51235) {\n            lifted_lambda_res_51236 = (int64_t) 0;\n        } else {\n            int64_t eta_p_51230;\n            bool cond_51237;\n            int64_t lifted_lambda_res_f_res_51238;\n            \n            eta_p_51230 = ((__global int64_t *) angle_partitions_per_dim_mem_52562)[gtid_51225];\n            cond_51237 = sle64(eta_p_51230, to_i64_res_51234);\n            if (cond_51237) {\n                int64_t lifted_lambda_res_f_res_t_res_51239 = sub64(eta_p_51230, (int64_t) 1);\n                \n                lifted_lambda_res_f_res_51238 = lifted_lambda_res_f_res_t_res_51239;\n            } else {\n                lifted_lambda_res_f_res_51238 = to_i64_res_51234;\n            }\n            lifted_lambda_res_51236 = lifted_lambda_res_f_res_51238;\n        }\n        ((__global int64_t *) mem_52669)[gtid_51224 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 + gtid_51225] = lifted_lambda_res_51236;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51221\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51246_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51246(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_angle_no_32151, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, __global unsigned char *mem_52591, __global unsigned char *mem_52680, __global unsigned char *mem_52683)\n{\n    #define segmap_tblock_sizze_51242 (skyline_local_filter_9621zisegmap_51246zisegmap_tblock_sizze_51242)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53346;\n    int32_t tblock_sizze_53349;\n    int32_t wave_sizze_53348;\n    int32_t bloc",
                                    "k_id_53347;\n    int32_t global_tid_53345;\n    int64_t phys_tid_51246;\n    int64_t global_tid_53350;\n    int64_t slice_53351;\n    int64_t gtid_51245;\n    int64_t remnant_53352;\n    \n    local_tid_53346 = get_local_id(0);\n    tblock_sizze_53349 = get_local_size(0);\n    wave_sizze_53348 = LOCKSTEP_WIDTH;\n    block_id_53347 = get_tblock_id(0);\n    global_tid_53345 = block_id_53347 * tblock_sizze_53349 + local_tid_53346;\n    phys_tid_51246 = sext_i32_i64(global_tid_53345);\n    global_tid_53350 = sext_i32_i64(block_id_53347) * segmap_tblock_sizze_51242 + sext_i32_i64(local_tid_53346);\n    slice_53351 = coercez2081Uz2080Uz2084U_32143;\n    gtid_51245 = global_tid_53350;\n    remnant_53352 = global_tid_53350 - gtid_51245;\n    if (slt64(gtid_51245, coercez2081Uz2080Uz2084U_32143)) {\n        int64_t defunc_0_foldl_res_51247;\n        int64_t defunc_0_foldl_res_51249;\n        int64_t acc_51251;\n        int64_t zp_lhs_51254;\n        int64_t get_id_from_grid_angle_res_51255;\n        \n        defunc_0_foldl_res_51247 = ((__global int64_t *) mem_52591)[gtid_51245];\n        acc_51251 = (int64_t) 0;\n        for (int64_t i_51250 = 0; i_51250 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403; i_51250++) {\n            int64_t b_51252;\n            int64_t defunc_0_f_res_51253;\n            int64_t acc_tmp_53353;\n            \n            b_51252 = ((__global int64_t *) mem_52680)[gtid_51245 + i_51250 * coercez2081Uz2080Uz2084U_32143];\n            defunc_0_f_res_51253 = add64(acc_51251, b_51252);\n            acc_tmp_53353 = defunc_0_f_res_51253;\n            acc_51251 = acc_tmp_53353;\n        }\n        defunc_0_foldl_res_51249 = acc_51251;\n        zp_lhs_51254 = mul64(total_angle_no_32151, defunc_0_foldl_res_51247);\n        get_id_from_grid_angle_res_51255 = add64(defunc_0_foldl_res_51249, zp_lhs_51254);\n        ((__global int64_t *) mem_52683)[gtid_51245] = get_id_from_grid_angle_res_51255;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51242\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filte", "r_9621zisegmap_51307_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51307(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_tblocks_51303, int64_t num_threads_53043, int32_t virt_num_tblocks_53604, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52685, __global unsigned char *mem_52705, __global unsigned char *color_52936)\n{\n    #define segmap_tblock_sizze_51302 (skyline_local_filter_9621zisegmap_51307zisegmap_tblock_sizze_51302)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53606;\n    int32_t tblock_sizze_53609;\n    int32_t wave_sizze_53608;\n    int32_t block_id_53607;\n    int32_t global_tid_53605;\n    int64_t phys_tid_51307;\n    int32_t phys_tblock_id_53610;\n    int32_t iterations_53611;\n    \n    local_tid_53606 = get_local_id(0);\n    tblock_sizze_53609 = get_local_size(0);\n    wave_sizze_53608 = LOCKSTEP_WIDTH;\n    block_id_53607 = get_tblock_id(0);\n    global_tid_53605 = block_id_53607 * tblock_sizze_53609 + local_tid_53606;\n    phys_tid_51307 = sext_i32_i64(global_tid_53605);\n    phys_tblock_id_53610 = get_tblock_id(0);\n    iterations_53611 = sdiv_up32(virt_num_tblocks_53604 - phys_tblock_id_53610, sext_i64_i32(num_tblocks_51303));\n    for (int32_t i_53612 = 0; i_53612 < iterations_53611; i_53612++) {\n        int32_t virt_tblock_id_53613;\n        int64_t global_tid_53614;\n        int64_t slice_53615;\n        int64_t gtid_51306;\n        int64_t remnant_53616;\n        \n        virt_tblock_id_53613 = phys_tblock_id_53610 + i_53612 * sext_i64_i32(num_tblocks_51303);\n        global_tid_53614 = sext_i32_i64(virt_tblock_id_53613) * segmap_tblock_sizze_51302 + sext_i32_i64(local_tid_53606);", "\n        slice_53615 = total_part_no_32153;\n        gtid_51306 = global_tid_53614;\n        remnant_53616 = global_tid_53614 - gtid_51306;\n        if (slt64(gtid_51306, total_part_no_32153)) {\n            int64_t eta_p_51308;\n            bool cond_51309;\n            int64_t ext_53048;\n            int64_t ctx_53045;\n            int64_t ext_53047;\n            __global unsigned char *ext_mem_ext_53046;\n            \n            eta_p_51308 = ((__global int64_t *) mem_52685)[gtid_51306];\n            cond_51309 = slt64(eta_p_51308, coercez2081Uz2080Uz2084U_32143);\n            if (cond_51309) {\n                ext_53048 = (int64_t) 1;\n            } else {\n                ext_53048 = num_threads_53043;\n            }\n            ctx_53045 = dim_32139 * eta_p_51308;\n            if (cond_51309) {\n                ext_53047 = ctx_53045;\n            } else {\n                ext_53047 = phys_tid_51307;\n            }\n            if (cond_51309) {\n                bool x_51311;\n                bool bounds_check_51312;\n                bool index_certs_51313;\n                \n                x_51311 = sle64((int64_t) 0, eta_p_51308);\n                bounds_check_51312 = cond_51309 && x_51311;\n                if (!bounds_check_51312) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                            global_failure_args[0] = (int64_t) eta_p_51308;\n                            global_failure_args[1] = (int64_t) coercez2081Uz2080Uz2084U_32143;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_0;\n                    }\n                }\n                ext_mem_ext_53046 = xys_mem_52568;\n            } else {\n                for (int64_t nest_i_53617 = 0; nest_i_53617 < dim_32139; nest_i_53617++) {\n                    ((__global float *) color_52936)[phys_tid_51307 + nest_i_53617 * num_threads_53043] = INFINITY;\n                }\n            ",
                                    "    ext_mem_ext_53046 = color_52936;\n            }\n            for (int64_t i_0 = 0; i_0 < dim_32139; i_0++) {\n                ((__global float *) mem_52705)[gtid_51306 + i_0 * total_part_no_32153] = ((__global float *) ext_mem_ext_53046)[ext_53047 + i_0 * ext_53048];\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51302\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51372_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51372(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_fpts_32339, int64_t num_tblocks_51368, int64_t num_threads_53049, int64_t ctx_53076, int32_t virt_num_tblocks_53619, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52683, __global unsigned char *mem_52705, __global unsigned char *mem_52759, __global unsigned char *color_52937, __global unsigned char *color_52938, __global unsigned char *color_52939, __global unsigned char *color_52940)\n{\n    #define segmap_tblock_sizze_51367 (skyline_local_filter_9621zisegmap_51372zisegmap_tblock_sizze_51367)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53621;\n    int32_t tblock_sizze_53624;\n    int32_t wave_sizze_53623;\n    int32_t block_id_53622;\n    int32_t global_tid_53620;\n    int64_t phys_tid_51372;\n    int32_t phys_tblock_id_53625;\n    int32_t iterations_53626;\n    \n    local_tid_53621 = get_local_id(0);\n    tblock_sizze_53624 = get_local_size(0);\n    wave_sizze_53623 = LOCKSTEP_WIDTH;\n", "    block_id_53622 = get_tblock_id(0);\n    global_tid_53620 = block_id_53622 * tblock_sizze_53624 + local_tid_53621;\n    phys_tid_51372 = sext_i32_i64(global_tid_53620);\n    phys_tblock_id_53625 = get_tblock_id(0);\n    iterations_53626 = sdiv_up32(virt_num_tblocks_53619 - phys_tblock_id_53625, sext_i64_i32(num_tblocks_51368));\n    for (int32_t i_53627 = 0; i_53627 < iterations_53626; i_53627++) {\n        int32_t virt_tblock_id_53628;\n        int64_t global_tid_53629;\n        int64_t slice_53630;\n        int64_t gtid_51371;\n        int64_t remnant_53631;\n        \n        virt_tblock_id_53628 = phys_tblock_id_53625 + i_53627 * sext_i64_i32(num_tblocks_51368);\n        global_tid_53629 = sext_i32_i64(virt_tblock_id_53628) * segmap_tblock_sizze_51367 + sext_i32_i64(local_tid_53621);\n        slice_53630 = num_fpts_32339;\n        gtid_51371 = global_tid_53629;\n        remnant_53631 = global_tid_53629 - gtid_51371;\n        if (slt64(gtid_51371, num_fpts_32339)) {\n            bool cond_51374;\n            int64_t ext_53086;\n            int64_t ext_53087;\n            int64_t ext_53088;\n            __global unsigned char *ext_mem_ext_53085;\n            \n            cond_51374 = gtid_51371 == (int64_t) 0;\n            if (cond_51374) {\n                ext_53086 = (int64_t) 0;\n            } else {\n                ext_53086 = phys_tid_51372;\n            }\n            if (cond_51374) {\n                ext_53087 = (int64_t) 1;\n            } else {\n                ext_53087 = ctx_53076;\n            }\n            if (cond_51374) {\n                ext_53088 = total_part_no_32153;\n            } else {\n                ext_53088 = num_threads_53049;\n            }\n            if (cond_51374) {\n                ext_mem_ext_53085 = mem_52705;\n            } else {\n                int64_t tmp_51376;\n                bool x_51377;\n                bool y_51378;\n                bool bounds_check_51379;\n                bool index_certs_51380;\n                \n                tmp_51376 = sub64(gtid_51", "371, (int64_t) 1);\n                x_51377 = sle64((int64_t) 0, tmp_51376);\n                y_51378 = slt64(tmp_51376, dim_32139);\n                bounds_check_51379 = x_51377 && y_51378;\n                if (!bounds_check_51379) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_51376;\n                            global_failure_args[1] = (int64_t) dim_32139;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_0;\n                    }\n                }\n                for (int64_t nest_i_53632 = 0; nest_i_53632 < total_part_no_32153; nest_i_53632++) {\n                    ((__global float *) color_52940)[phys_tid_51372 + nest_i_53632 * num_threads_53049] = INFINITY;\n                }\n                for (int64_t nest_i_53633 = 0; nest_i_53633 < total_part_no_32153; nest_i_53633++) {\n                    ((__global int64_t *) color_52939)[phys_tid_51372 + nest_i_53633 * num_threads_53049] = coercez2081Uz2080Uz2084U_32143;\n                }\n                for (int64_t iter_52478 = 0; iter_52478 < coercez2081Uz2080Uz2084U_32143; iter_52478++) {\n                    int64_t pixel_52481;\n                    bool less_than_zzero_52484;\n                    bool greater_than_sizze_52485;\n                    bool outside_bounds_dim_52486;\n                    \n                    pixel_52481 = ((__global int64_t *) mem_52683)[iter_52478];\n                    less_than_zzero_52484 = slt64(pixel_52481, (int64_t) 0);\n                    greater_than_sizze_52485 = sle64(total_part_no_32153, pixel_52481);\n                    outside_bounds_dim_52486 = less_than_zzero_52484 || greater_than_sizze_52485;\n                    if (!outside_bounds_dim_52486) {\n                        float pixel_52483;\n                        int64_t read_hist_52488;\n                        float read_",
                                    "hist_52489;\n                        bool zl_res_51391;\n                        bool zeze_res_51392;\n                        bool cond_f_res_t_res_51393;\n                        bool x_51394;\n                        bool x_51395;\n                        bool y_51396;\n                        bool cond_51397;\n                        int64_t lifted_lambda_res_51398;\n                        float lifted_lambda_res_51399;\n                        \n                        pixel_52483 = ((__global float *) xys_mem_52568)[iter_52478 * dim_32139 + tmp_51376];\n                        read_hist_52488 = ((__global int64_t *) color_52939)[phys_tid_51372 + pixel_52481 * num_threads_53049];\n                        read_hist_52489 = ((__global float *) color_52940)[phys_tid_51372 + pixel_52481 * num_threads_53049];\n                        zl_res_51391 = read_hist_52489 < pixel_52483;\n                        zeze_res_51392 = read_hist_52489 == pixel_52483;\n                        cond_f_res_t_res_51393 = slt64(read_hist_52488, iter_52478);\n                        x_51394 = zeze_res_51392 && cond_f_res_t_res_51393;\n                        x_51395 = !zl_res_51391;\n                        y_51396 = x_51394 && x_51395;\n                        cond_51397 = zl_res_51391 || y_51396;\n                        if (cond_51397) {\n                            lifted_lambda_res_51398 = read_hist_52488;\n                        } else {\n                            lifted_lambda_res_51398 = iter_52478;\n                        }\n                        if (cond_51397) {\n                            lifted_lambda_res_51399 = read_hist_52489;\n                        } else {\n                            lifted_lambda_res_51399 = pixel_52483;\n                        }\n                        ((__global int64_t *) color_52939)[phys_tid_51372 + pixel_52481 * num_threads_53049] = lifted_lambda_res_51398;\n                        ((__global float *) color_52940)[phys_tid_51372 + pixel_52481 * num_threads_53049] = ", "lifted_lambda_res_51399;\n                    }\n                }\n                for (int64_t i_52496 = 0; i_52496 < total_part_no_32153; i_52496++) {\n                    int64_t eta_p_51404;\n                    bool cond_51405;\n                    int64_t ext_53080;\n                    int64_t ctx_53077;\n                    int64_t ext_53079;\n                    __global unsigned char *ext_mem_ext_53078;\n                    \n                    eta_p_51404 = ((__global int64_t *) color_52939)[phys_tid_51372 + i_52496 * num_threads_53049];\n                    cond_51405 = slt64(eta_p_51404, coercez2081Uz2080Uz2084U_32143);\n                    if (cond_51405) {\n                        ext_53080 = (int64_t) 1;\n                    } else {\n                        ext_53080 = num_threads_53049;\n                    }\n                    ctx_53077 = dim_32139 * eta_p_51404;\n                    if (cond_51405) {\n                        ext_53079 = ctx_53077;\n                    } else {\n                        ext_53079 = phys_tid_51372;\n                    }\n                    if (cond_51405) {\n                        bool x_51407;\n                        bool bounds_check_51408;\n                        bool index_certs_51409;\n                        \n                        x_51407 = sle64((int64_t) 0, eta_p_51404);\n                        bounds_check_51408 = cond_51405 && x_51407;\n                        if (!bounds_check_51408) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                                    global_failure_args[0] = (int64_t) eta_p_51404;\n                                    global_failure_args[1] = (int64_t) coercez2081Uz2080Uz2084U_32143;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n          ", "              ext_mem_ext_53078 = xys_mem_52568;\n                    } else {\n                        for (int64_t nest_i_53637 = 0; nest_i_53637 < dim_32139; nest_i_53637++) {\n                            ((__global float *) color_52937)[phys_tid_51372 + nest_i_53637 * num_threads_53049] = INFINITY;\n                        }\n                        ext_mem_ext_53078 = color_52937;\n                    }\n                    for (int64_t i_0 = 0; i_0 < dim_32139; i_0++) {\n                        ((__global float *) color_52938)[phys_tid_51372 + i_52496 * ctx_53076 + i_0 * num_threads_53049] = ((__global float *) ext_mem_ext_53078)[ext_53079 + i_0 * ext_53080];\n                    }\n                }\n                ext_mem_ext_53085 = color_52938;\n            }\n            for (int64_t i_0 = 0; i_0 < total_part_no_32153; i_0++) {\n                for (int64_t i_1 = 0; i_1 < dim_32139; i_1++) {\n                    ((__global float *) mem_52759)[gtid_51371 + (i_0 * (num_fpts_32339 * dim_32139) + i_1 * num_fpts_32339)] = ((__global float *) ext_mem_ext_53085)[ext_53086 + (i_0 * ext_53087 + i_1 * ext_53088)];\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51367\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51443_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51443(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, __global unsigned char *mem_52808, __global unsigned char *mem_52810, __global unsigned char *mem_52818, __global unsigned char *mem_52820)\n{\n    #define segmap_tblock_sizze_51438 (skyline_local_filter_9621zisegmap_51443zisegmap_tblock_sizze_51438)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53778;\n    int32_t tblock_sizze_53781;\n    int32_t wave_sizze_5",
                                    "3780;\n    int32_t block_id_53779;\n    int32_t global_tid_53777;\n    int64_t phys_tid_51443;\n    int64_t global_tid_53782;\n    int64_t slice_53783;\n    int64_t gtid_51442;\n    int64_t remnant_53784;\n    \n    local_tid_53778 = get_local_id(0);\n    tblock_sizze_53781 = get_local_size(0);\n    wave_sizze_53780 = LOCKSTEP_WIDTH;\n    block_id_53779 = get_tblock_id(0);\n    global_tid_53777 = block_id_53779 * tblock_sizze_53781 + local_tid_53778;\n    phys_tid_51443 = sext_i32_i64(global_tid_53777);\n    global_tid_53782 = sext_i32_i64(block_id_53779) * segmap_tblock_sizze_51438 + sext_i32_i64(local_tid_53778);\n    slice_53783 = coercez2081Uz2080Uz2084U_32143;\n    gtid_51442 = global_tid_53782;\n    remnant_53784 = global_tid_53782 - gtid_51442;\n    if (slt64(gtid_51442, coercez2081Uz2080Uz2084U_32143)) {\n        int64_t eta_p_51444;\n        bool cond_51446;\n        int64_t lifted_lambda_res_51447;\n        \n        eta_p_51444 = ((__global int64_t *) mem_52810)[gtid_51442];\n        cond_51446 = eta_p_51444 == (int64_t) 1;\n        if (cond_51446) {\n            int64_t eta_p_51445;\n            int64_t lifted_lambda_res_t_res_51448;\n            \n            eta_p_51445 = ((__global int64_t *) mem_52808)[gtid_51442];\n            lifted_lambda_res_t_res_51448 = sub64(eta_p_51445, (int64_t) 1);\n            lifted_lambda_res_51447 = lifted_lambda_res_t_res_51448;\n        } else {\n            lifted_lambda_res_51447 = (int64_t) -1;\n        }\n        ((__global int64_t *) mem_52818)[gtid_51442] = lifted_lambda_res_51447;\n        ((__global int64_t *) mem_52820)[gtid_51442] = lifted_lambda_res_51447;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51438\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51455_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51455(__global int *global_failure, int64_t dim_32139, int64_t coercez2081Uz2080Uz2084U_32143, int64_t m_45259, int64_t num_tblocks_51461, int32_t virt_num_tblocks_53786, __global unsigned char *xys_mem_52568,", " __global unsigned char *mem_52813, __global unsigned char *mem_52818)\n{\n    #define segmap_tblock_sizze_51459 (skyline_local_filter_9621zisegmap_51455zisegmap_tblock_sizze_51459)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53788;\n    int32_t tblock_sizze_53791;\n    int32_t wave_sizze_53790;\n    int32_t block_id_53789;\n    int32_t global_tid_53787;\n    int64_t phys_tid_51455;\n    int32_t phys_tblock_id_53792;\n    int32_t iterations_53793;\n    \n    local_tid_53788 = get_local_id(0);\n    tblock_sizze_53791 = get_local_size(0);\n    wave_sizze_53790 = LOCKSTEP_WIDTH;\n    block_id_53789 = get_tblock_id(0);\n    global_tid_53787 = block_id_53789 * tblock_sizze_53791 + local_tid_53788;\n    phys_tid_51455 = sext_i32_i64(global_tid_53787);\n    phys_tblock_id_53792 = get_tblock_id(0);\n    iterations_53793 = sdiv_up32(virt_num_tblocks_53786 - phys_tblock_id_53792, sext_i64_i32(num_tblocks_51461));\n    for (int32_t i_53794 = 0; i_53794 < iterations_53793; i_53794++) {\n        int32_t virt_tblock_id_53795;\n        int64_t global_tid_53796;\n        int64_t slice_53797;\n        int64_t slice_53798;\n        int64_t write_i_51451;\n        int64_t remnant_53799;\n        int64_t val_i_51452;\n        int64_t remnant_53800;\n        \n        virt_tblock_id_53795 = phys_tblock_id_53792 + i_53794 * sext_i64_i32(num_tblocks_51461);\n        global_tid_53796 = sext_i32_i64(virt_tblock_id_53795) * segmap_tblock_sizze_51459 + sext_i32_i64(local_tid_53788);\n        slice_53797 = dim_32139;\n        slice_53798 = coercez2081Uz2080Uz2084U_32143 * slice_53797;\n        write_i_51451 = squot64(global_tid_53796, slice_53797);\n        remnant_53799 = global_tid_53796 - write_i_51451 * slice_53797;\n        val_i_51452 = remnant_53799;\n        remnant_53800 = remnant_53799 - val_i_51452;\n        if (slt64(write_i_51451, coercez2081Uz2080Uz2084U_32143) && slt64(val_i_51452, dim_32139)) {\n            float scatter_tmp_elem_51453;\n            int64_t scatter_tmp_i_51454;\n         ", "   \n            scatter_tmp_elem_51453 = ((__global float *) xys_mem_52568)[write_i_51451 * dim_32139 + val_i_51452];\n            scatter_tmp_i_51454 = ((__global int64_t *) mem_52818)[write_i_51451];\n            if ((sle64((int64_t) 0, scatter_tmp_i_51454) && slt64(scatter_tmp_i_51454, m_45259)) && (sle64((int64_t) 0, val_i_51452) && slt64(val_i_51452, dim_32139))) {\n                ((__global float *) mem_52813)[scatter_tmp_i_51454 * dim_32139 + val_i_51452] = scatter_tmp_elem_51453;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51459\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegmap_51466_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegmap_51466(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t m_45259, int64_t num_tblocks_51471, int32_t virt_num_tblocks_53802, __global unsigned char *xys_mem_52569, __global unsigned char *mem_52815, __global unsigned char *mem_52820)\n{\n    #define segmap_tblock_sizze_51469 (skyline_local_filter_9621zisegmap_51466zisegmap_tblock_sizze_51469)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53804;\n    int32_t tblock_sizze_53807;\n    int32_t wave_sizze_53806;\n    int32_t block_id_53805;\n    int32_t global_tid_53803;\n    int64_t phys_tid_51466;\n    int32_t phys_tblock_id_53808;\n    int32_t iterations_53809;\n    \n    local_tid_53804 = get_local_id(0);\n    tblock_sizze_53807 = get_local_size(0);\n    wave_sizze_53806 = LOCKSTEP_WIDTH;\n    block_id_53805 = get_tblock_id(0);\n    global_tid_53803 = block_id_53805 * tblock_sizze_53807 + local_tid_53804;\n    phys_tid_51466 = sext_i32_i64(global_tid_53803);\n    phys_tblock_id_53808 = get_tblock_id(0);\n    iterations_53809 = sdiv_up32(virt_num_tblocks_53802 - phys_tblock_id_53808, sext_i64_i32(num_tblocks_51471));\n    for (int32_t i_53810 = 0; i_53810 < iterations_53809; i_53810++) {\n        int32_t virt_tblock_id_53811;\n        int6",
                                    "4_t global_tid_53812;\n        int64_t slice_53813;\n        int64_t write_i_51463;\n        int64_t remnant_53814;\n        \n        virt_tblock_id_53811 = phys_tblock_id_53808 + i_53810 * sext_i64_i32(num_tblocks_51471);\n        global_tid_53812 = sext_i32_i64(virt_tblock_id_53811) * segmap_tblock_sizze_51469 + sext_i32_i64(local_tid_53804);\n        slice_53813 = coercez2081Uz2080Uz2084U_32143;\n        write_i_51463 = global_tid_53812;\n        remnant_53814 = global_tid_53812 - write_i_51463;\n        if (slt64(write_i_51463, coercez2081Uz2080Uz2084U_32143)) {\n            int64_t scatter_tmp_elem_51464;\n            int64_t scatter_tmp_i_51465;\n            \n            scatter_tmp_elem_51464 = ((__global int64_t *) xys_mem_52569)[write_i_51463];\n            scatter_tmp_i_51465 = ((__global int64_t *) mem_52820)[write_i_51463];\n            if (sle64((int64_t) 0, scatter_tmp_i_51465) && slt64(scatter_tmp_i_51465, m_45259)) {\n                ((__global int64_t *) mem_52815)[scatter_tmp_i_51465] = scatter_tmp_elem_51464;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51469\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegred_large_53500_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegred_large_53500(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_tblocks_51260, int64_t num_subhistos_53375, int64_t blocks_per_segment_53545, int64_t q_53546, int64_t num_virtblocks_53547, int64_t threads_per_segment_53548, __global unsigned char *mem_52685, __global unsigned char *mem_52687, __global unsigned char *defunc_0_map_res_subhistos_mem_53376, __global unsigned char *defunc_0_map_res_subhistos_mem_53378, __global unsigned char *segred_tmp_mem_53549, __global unsigned char *segred_tmp_mem_53551, __global unsigned char *counters_mem_53553)\n{\n    #define seghist_tblock_sizze_51258 (skyline_local_filter_9621zisegred_large_", "53500ziseghist_tblock_sizze_51258)\n    #define chunk_sizze_53501 (skyline_local_filter_9621zisegred_large_53500zichunk_sizze_53501)\n    \n    volatile __local unsigned char *sync_arr_mem_53564_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_53564_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f32_mem_53562_backing_1 = &shared_mem[sync_arr_mem_53564_backing_2_offset];\n    const int64_t red_arr_f32_mem_53562_backing_1_offset = sync_arr_mem_53564_backing_2_offset + ((int64_t) 4 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_53560_backing_0 = &shared_mem[red_arr_f32_mem_53562_backing_1_offset];\n    const int64_t red_arr_i64_mem_53560_backing_0_offset = red_arr_f32_mem_53562_backing_1_offset + ((int64_t) 8 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53556;\n    int32_t tblock_sizze_53559;\n    int32_t wave_sizze_53558;\n    int32_t block_id_53557;\n    int32_t global_tid_53555;\n    int64_t flat_gtid_53500;\n    __local unsigned char *red_arr_i64_mem_53560;\n    __local unsigned char *red_arr_f32_mem_53562;\n    __local unsigned char *sync_arr_mem_53564;\n    int32_t phys_tblock_id_53566;\n    int32_t iterations_53567;\n    \n    local_tid_53556 = get_local_id(0);\n    tblock_sizze_53559 = get_local_size(0);\n    wave_sizze_53558 = LOCKSTEP_WIDTH;\n    block_id_53557 = get_tblock_id(0);\n    global_tid_53555 = block_id_53557 * tblock_sizze_53559 + local_tid_53556;\n    flat_gtid_53500 = sext_i32_i64(global_tid_53555);\n    red_arr_i64_mem_53560 = (__local unsigned char *) red_arr_i64_mem_53560_backing_0;\n    red_arr_f32_mem_53562 = (__local unsigned char *) red_arr_f32_mem_53562_backing_1;\n    sync_arr_mem_53564 = (__local unsigned char *) sync_arr_mem_53564_back", "ing_2;\n    phys_tblock_id_53566 = get_tblock_id(0);\n    iterations_53567 = sdiv_up32(sext_i64_i32(num_virtblocks_53547) - phys_tblock_id_53566, sext_i64_i32(num_tblocks_51260));\n    for (int32_t i_53568 = 0; i_53568 < iterations_53567; i_53568++) {\n        int32_t virt_tblock_id_53569;\n        int64_t flat_segment_id_53570;\n        int64_t global_tid_53571;\n        int64_t slice_53572;\n        int64_t bucket_id_53498;\n        int64_t remnant_53573;\n        int64_t subhistogram_id_53499;\n        int64_t eta_p_block_res_acc_53574;\n        float eta_p_block_res_acc_53575;\n        int64_t eta_p_51266;\n        float eta_p_51267;\n        int64_t eta_p_51268;\n        float eta_p_51269;\n        int64_t tblock_id_in_segment_53589;\n        int64_t block_base_offset_53590;\n        int32_t offset_53593;\n        int32_t skip_waves_53594;\n        int64_t eta_p_53576;\n        float eta_p_53577;\n        int64_t eta_p_53578;\n        float eta_p_53579;\n        \n        virt_tblock_id_53569 = phys_tblock_id_53566 + i_53568 * sext_i64_i32(num_tblocks_51260);\n        flat_segment_id_53570 = squot64(sext_i32_i64(virt_tblock_id_53569), blocks_per_segment_53545);\n        global_tid_53571 = srem64(sext_i32_i64(virt_tblock_id_53569) * seghist_tblock_sizze_51258 + sext_i32_i64(local_tid_53556), threads_per_segment_53548);\n        slice_53572 = total_part_no_32153;\n        bucket_id_53498 = flat_segment_id_53570;\n        remnant_53573 = flat_segment_id_53570 - bucket_id_53498;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_53574 = coercez2081Uz2080Uz2084U_32143;\n            eta_p_block_res_acc_53575 = INFINITY;\n        }\n        tblock_id_in_segment_53589 = squot64(global_tid_53571, seghist_tblock_sizze_51258);\n        block_base_offset_53590 = tblock_id_in_segment_53589 * q_53546 * seghist_tblock_sizze_51258;\n        for (int64_t i_53591 = 0; i_53591 < q_53546; i_53591++) {\n            int64_t block_offset_53592 = block_base_offset_5359",
                                    "0 + i_53591 * seghist_tblock_sizze_51258;\n            \n            subhistogram_id_53499 = global_tid_53571 + threads_per_segment_53548 * i_53591;\n            if (slt64(subhistogram_id_53499, num_subhistos_53375)) {\n                // apply map function(s)\n                {\n                    // load accumulator(s)\n                    {\n                        eta_p_51266 = eta_p_block_res_acc_53574;\n                        eta_p_51267 = eta_p_block_res_acc_53575;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_51268 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_53376)[subhistogram_id_53499 * total_part_no_32153 + bucket_id_53498];\n                        eta_p_51269 = ((__global float *) defunc_0_map_res_subhistos_mem_53378)[subhistogram_id_53499 * total_part_no_32153 + bucket_id_53498];\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                        bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                        bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                        bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                        bool x_51274 = !zl_res_51270;\n                        bool y_51275 = x_51273 && x_51274;\n                        bool cond_51276 = zl_res_51270 || y_51275;\n                        int64_t lifted_lambda_res_51277;\n                        \n                        if (cond_51276) {\n                            lifted_lambda_res_51277 = eta_p_51266;\n                        } else {\n                            lifted_lambda_res_51277 = eta_p_51268;\n                        }\n                        \n                        float lifted_lambda_res_51278;\n                        \n                        if (cond_51276) {\n                            lifted_lambda_res_51278 = eta_p_51267;\n   ", "                     } else {\n                            lifted_lambda_res_51278 = eta_p_51269;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53574 = lifted_lambda_res_51277;\n                            eta_p_block_res_acc_53575 = lifted_lambda_res_51278;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_block_res_acc_53574;\n            ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_block_res_acc_53575;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_53594 = 1;\n        offset_53593 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_53556, sext_i64_i32(seghist_tblock_sizze_51258))) {\n                eta_p_53576 = ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53593)];\n                eta_p_53577 = ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53593)];\n            }\n        }\n        offset_53593 = 1;\n        while (slt32(offset_53593, wave_sizze_53558)) {\n            if (slt32(local_tid_53556 + offset_53593, sext_i64_i32(seghist_tblock_sizze_51258)) && ((local_tid_53556 - squot32(local_tid_53556, wave_sizze_53558) * wave_sizze_53558) & (2 * offset_53593 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_53578 = ((volatile __local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53593)];\n                    eta_p_53579 = ((volatile __local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53593)];\n                }\n                // apply reduction ", "operation\n                {\n                    bool zl_res_53580 = eta_p_53577 < eta_p_53579;\n                    bool zeze_res_53581 = eta_p_53577 == eta_p_53579;\n                    bool cond_f_res_t_res_53582 = slt64(eta_p_53576, eta_p_53578);\n                    bool x_53583 = zeze_res_53581 && cond_f_res_t_res_53582;\n                    bool x_53584 = !zl_res_53580;\n                    bool y_53585 = x_53583 && x_53584;\n                    bool cond_53586 = zl_res_53580 || y_53585;\n                    int64_t lifted_lambda_res_53587;\n                    \n                    if (cond_53586) {\n                        lifted_lambda_res_53587 = eta_p_53576;\n                    } else {\n                        lifted_lambda_res_53587 = eta_p_53578;\n                    }\n                    \n                    float lifted_lambda_res_53588;\n                    \n                    if (cond_53586) {\n                        lifted_lambda_res_53588 = eta_p_53577;\n                    } else {\n                        lifted_lambda_res_53588 = eta_p_53579;\n                    }\n                    eta_p_53576 = lifted_lambda_res_53587;\n                    eta_p_53577 = lifted_lambda_res_53588;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_53576;\n                    ((volatile __local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_53577;\n                }\n            }\n            offset_53593 *= 2;\n        }\n        while (slt32(skip_waves_53594, squot32(sext_i64_i32(seghist_tblock_sizze_51258) + wave_sizze_53558 - 1, wave_sizze_53558))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_53593 = skip_waves_53594 * wave_sizze_53558;\n            if (slt32(local_tid_53556 + offset_53593, sext_i64_i32(seghist_tblock_sizze_51258)) && ((local_tid_53556 - squot32(local_tid_53556, wave_sizze_53558) ",
                                    "* wave_sizze_53558) == 0 && (squot32(local_tid_53556, wave_sizze_53558) & (2 * skip_waves_53594 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_53578 = ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53593)];\n                    eta_p_53579 = ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53593)];\n                }\n                // apply reduction operation\n                {\n                    bool zl_res_53580 = eta_p_53577 < eta_p_53579;\n                    bool zeze_res_53581 = eta_p_53577 == eta_p_53579;\n                    bool cond_f_res_t_res_53582 = slt64(eta_p_53576, eta_p_53578);\n                    bool x_53583 = zeze_res_53581 && cond_f_res_t_res_53582;\n                    bool x_53584 = !zl_res_53580;\n                    bool y_53585 = x_53583 && x_53584;\n                    bool cond_53586 = zl_res_53580 || y_53585;\n                    int64_t lifted_lambda_res_53587;\n                    \n                    if (cond_53586) {\n                        lifted_lambda_res_53587 = eta_p_53576;\n                    } else {\n                        lifted_lambda_res_53587 = eta_p_53578;\n                    }\n                    \n                    float lifted_lambda_res_53588;\n                    \n                    if (cond_53586) {\n                        lifted_lambda_res_53588 = eta_p_53577;\n                    } else {\n                        lifted_lambda_res_53588 = eta_p_53579;\n                    }\n                    eta_p_53576 = lifted_lambda_res_53587;\n                    eta_p_53577 = lifted_lambda_res_53588;\n                }\n                // write result of operation\n                {\n                    ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_53576;\n                    ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_53577;\n                }\n       ", "     }\n            skip_waves_53594 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_53556) == (int64_t) 0) {\n                eta_p_block_res_acc_53574 = eta_p_53576;\n                eta_p_block_res_acc_53575 = eta_p_53577;\n            } else {\n                eta_p_block_res_acc_53574 = coercez2081Uz2080Uz2084U_32143;\n                eta_p_block_res_acc_53575 = INFINITY;\n            }\n        }\n        if (blocks_per_segment_53545 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_53556 == 0) {\n                    ((__global int64_t *) mem_52685)[bucket_id_53498] = eta_p_block_res_acc_53574;\n                    ((__global float *) mem_52687)[bucket_id_53498] = eta_p_block_res_acc_53575;\n                }\n            }\n        } else {\n            int32_t old_counter_53595;\n            bool is_last_block_53596;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_53556 == 0) {\n                    ((__global int64_t *) segred_tmp_mem_53549)[sext_i32_i64(virt_tblock_id_53569)] = eta_p_block_res_acc_53574;\n                    mem_fence_global();\n                    ((__global float *) segred_tmp_mem_53551)[sext_i32_i64(virt_tblock_id_53569)] = eta_p_block_res_acc_53575;\n                    mem_fence_global();\n                    old_counter_53595 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53553)[srem64(flat_segment_id_53570, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_53564)[(int64_t) 0] = old_counter_53595 == sext_i64_i32(blocks_per_segment_53545 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_53596 = ((__local bool *)", " sync_arr_mem_53564)[(int64_t) 0];\n            if (is_last_block_53596) {\n                if (local_tid_53556 == 0) {\n                    old_counter_53595 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53553)[srem64(flat_segment_id_53570, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_53545));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_53597 = sdiv_up64(blocks_per_segment_53545, seghist_tblock_sizze_51258);\n                    \n                    eta_p_51266 = coercez2081Uz2080Uz2084U_32143;\n                    eta_p_51267 = INFINITY;\n                    for (int64_t i_53598 = 0; i_53598 < read_per_thread_53597; i_53598++) {\n                        int64_t block_res_id_53599 = sext_i32_i64(local_tid_53556) * read_per_thread_53597 + i_53598;\n                        int64_t index_of_block_res_53600 = flat_segment_id_53570 * blocks_per_segment_53545 + block_res_id_53599;\n                        \n                        if (slt64(block_res_id_53599, blocks_per_segment_53545)) {\n                            eta_p_51268 = ((__global int64_t *) segred_tmp_mem_53549)[index_of_block_res_53600];\n                            eta_p_51269 = ((__global float *) segred_tmp_mem_53551)[index_of_block_res_53600];\n                            \n                            bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                            bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                            bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                            bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                            bool x_51274 = !zl_res_51270;\n                            bool y_51275 = x_51273 && x_51274;\n                            bool cond_51276 = zl_res_51270 || y_51275;\n                            int64_t lifted_lambda_res_51277;\n                            \n                 ",
                                    "           if (cond_51276) {\n                                lifted_lambda_res_51277 = eta_p_51266;\n                            } else {\n                                lifted_lambda_res_51277 = eta_p_51268;\n                            }\n                            \n                            float lifted_lambda_res_51278;\n                            \n                            if (cond_51276) {\n                                lifted_lambda_res_51278 = eta_p_51267;\n                            } else {\n                                lifted_lambda_res_51278 = eta_p_51269;\n                            }\n                            eta_p_51266 = lifted_lambda_res_51277;\n                            eta_p_51267 = lifted_lambda_res_51278;\n                        }\n                    }\n                }\n                ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_51266;\n                ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_51267;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_53601;\n                    int32_t skip_waves_53602 = 1;\n                    int64_t eta_p_53576;\n                    float eta_p_53577;\n                    int64_t eta_p_53578;\n                    float eta_p_53579;\n                    \n                    offset_53601 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_53556, sext_i64_i32(seghist_tblock_sizze_51258))) {\n                            eta_p_53576 = ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                            eta_p_53577 = ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                        }\n                    }\n                    offset_53601 = 1;\n                   ", " while (slt32(offset_53601, wave_sizze_53558)) {\n                        if (slt32(local_tid_53556 + offset_53601, sext_i64_i32(seghist_tblock_sizze_51258)) && ((local_tid_53556 - squot32(local_tid_53556, wave_sizze_53558) * wave_sizze_53558) & (2 * offset_53601 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_53578 = ((volatile __local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                                eta_p_53579 = ((volatile __local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zl_res_53580 = eta_p_53577 < eta_p_53579;\n                                bool zeze_res_53581 = eta_p_53577 == eta_p_53579;\n                                bool cond_f_res_t_res_53582 = slt64(eta_p_53576, eta_p_53578);\n                                bool x_53583 = zeze_res_53581 && cond_f_res_t_res_53582;\n                                bool x_53584 = !zl_res_53580;\n                                bool y_53585 = x_53583 && x_53584;\n                                bool cond_53586 = zl_res_53580 || y_53585;\n                                int64_t lifted_lambda_res_53587;\n                                \n                                if (cond_53586) {\n                                    lifted_lambda_res_53587 = eta_p_53576;\n                                } else {\n                                    lifted_lambda_res_53587 = eta_p_53578;\n                                }\n                                \n                                float lifted_lambda_res_53588;\n                                \n                                if (cond_53586) {\n                                    lifted_lambda_res_53588 = eta_p_53577;\n                                } else {\n                   ", "                 lifted_lambda_res_53588 = eta_p_53579;\n                                }\n                                eta_p_53576 = lifted_lambda_res_53587;\n                                eta_p_53577 = lifted_lambda_res_53588;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_53576;\n                                ((volatile __local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_53577;\n                            }\n                        }\n                        offset_53601 *= 2;\n                    }\n                    while (slt32(skip_waves_53602, squot32(sext_i64_i32(seghist_tblock_sizze_51258) + wave_sizze_53558 - 1, wave_sizze_53558))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_53601 = skip_waves_53602 * wave_sizze_53558;\n                        if (slt32(local_tid_53556 + offset_53601, sext_i64_i32(seghist_tblock_sizze_51258)) && ((local_tid_53556 - squot32(local_tid_53556, wave_sizze_53558) * wave_sizze_53558) == 0 && (squot32(local_tid_53556, wave_sizze_53558) & (2 * skip_waves_53602 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_53578 = ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                                eta_p_53579 = ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556 + offset_53601)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool zl_res_53580 = eta_p_53577 < eta_p_53579;\n                                bool zeze_res_53581 = eta_p_53577 == eta_p_53579;\n                                bool cond_f_res_t_res_53582 = slt64(eta_p_53576",
                                    ", eta_p_53578);\n                                bool x_53583 = zeze_res_53581 && cond_f_res_t_res_53582;\n                                bool x_53584 = !zl_res_53580;\n                                bool y_53585 = x_53583 && x_53584;\n                                bool cond_53586 = zl_res_53580 || y_53585;\n                                int64_t lifted_lambda_res_53587;\n                                \n                                if (cond_53586) {\n                                    lifted_lambda_res_53587 = eta_p_53576;\n                                } else {\n                                    lifted_lambda_res_53587 = eta_p_53578;\n                                }\n                                \n                                float lifted_lambda_res_53588;\n                                \n                                if (cond_53586) {\n                                    lifted_lambda_res_53588 = eta_p_53577;\n                                } else {\n                                    lifted_lambda_res_53588 = eta_p_53579;\n                                }\n                                eta_p_53576 = lifted_lambda_res_53587;\n                                eta_p_53577 = lifted_lambda_res_53588;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int64_t *) red_arr_i64_mem_53560)[sext_i32_i64(local_tid_53556)] = eta_p_53576;\n                                ((__local float *) red_arr_f32_mem_53562)[sext_i32_i64(local_tid_53556)] = eta_p_53577;\n                            }\n                        }\n                        skip_waves_53602 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_53556 == 0) {\n                            ((__global int64_t *) mem_52685)[bucket_id_53498] = eta_p_53576;\n       ", "                     ((__global float *) mem_52687)[bucket_id_53498] = eta_p_53577;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef seghist_tblock_sizze_51258\n    #undef chunk_sizze_53501\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegred_small_53500_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegred_small_53500(__global int *global_failure, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_part_no_32153, int64_t num_tblocks_51260, int64_t num_subhistos_53375, int64_t segment_sizze_nonzzero_53502, __global unsigned char *mem_52685, __global unsigned char *mem_52687, __global unsigned char *defunc_0_map_res_subhistos_mem_53376, __global unsigned char *defunc_0_map_res_subhistos_mem_53378)\n{\n    #define seghist_tblock_sizze_51258 (skyline_local_filter_9621zisegred_small_53500ziseghist_tblock_sizze_51258)\n    \n    volatile __local unsigned char *red_arr_f32_mem_53511_backing_1 = &shared_mem[0];\n    const int64_t red_arr_f32_mem_53511_backing_1_offset = 0 + ((int64_t) 4 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_53509_backing_0 = &shared_mem[red_arr_f32_mem_53511_backing_1_offset];\n    const int64_t red_arr_i64_mem_53509_backing_0_offset = red_arr_f32_mem_53511_backing_1_offset + ((int64_t) 8 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53505;\n    int32_t tblock_sizze_53508;\n    int32_t wave_sizze_53507;\n    int32_t block_id_53506;\n    int32_t global_tid_53504;\n    int64_t flat_gtid_53500;\n    __local unsigned char *red_arr_i64_mem_53509;\n    __local unsigned char *red_arr_f32_mem_53511;\n    int32_t phys_tblock_id_5351", "3;\n    int32_t iterations_53514;\n    \n    local_tid_53505 = get_local_id(0);\n    tblock_sizze_53508 = get_local_size(0);\n    wave_sizze_53507 = LOCKSTEP_WIDTH;\n    block_id_53506 = get_tblock_id(0);\n    global_tid_53504 = block_id_53506 * tblock_sizze_53508 + local_tid_53505;\n    flat_gtid_53500 = sext_i32_i64(global_tid_53504);\n    red_arr_i64_mem_53509 = (__local unsigned char *) red_arr_i64_mem_53509_backing_0;\n    red_arr_f32_mem_53511 = (__local unsigned char *) red_arr_f32_mem_53511_backing_1;\n    phys_tblock_id_53513 = get_tblock_id(0);\n    iterations_53514 = sdiv_up32(sext_i64_i32(sdiv_up64(total_part_no_32153, squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502))) - phys_tblock_id_53513, sext_i64_i32(num_tblocks_51260));\n    for (int32_t i_53515 = 0; i_53515 < iterations_53514; i_53515++) {\n        int32_t virt_tblock_id_53516;\n        int64_t slice_53517;\n        int64_t bucket_id_53498;\n        int64_t remnant_53518;\n        int64_t subhistogram_id_53499;\n        \n        virt_tblock_id_53516 = phys_tblock_id_53513 + i_53515 * sext_i64_i32(num_tblocks_51260);\n        slice_53517 = total_part_no_32153;\n        bucket_id_53498 = squot64(sext_i32_i64(local_tid_53505), segment_sizze_nonzzero_53502) + sext_i32_i64(virt_tblock_id_53516) * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502);\n        remnant_53518 = squot64(sext_i32_i64(local_tid_53505), segment_sizze_nonzzero_53502) + sext_i32_i64(virt_tblock_id_53516) * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502) - bucket_id_53498;\n        subhistogram_id_53499 = srem64(sext_i32_i64(local_tid_53505), num_subhistos_53375);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_53375) && (slt64(bucket_id_53498, total_part_no_32153) && slt64(sext_i32_i64(local_tid_53505), num_subhistos_53375 * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502)))) {\n                // save results to be reduced\n           ",
                                    "     {\n                    int64_t tmp_53519 = ((__global int64_t *) defunc_0_map_res_subhistos_mem_53376)[subhistogram_id_53499 * total_part_no_32153 + bucket_id_53498];\n                    \n                    ((__local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = tmp_53519;\n                    \n                    float tmp_53520 = ((__global float *) defunc_0_map_res_subhistos_mem_53378)[subhistogram_id_53499 * total_part_no_32153 + bucket_id_53498];\n                    \n                    ((__local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = tmp_53520;\n                }\n            } else {\n                ((__local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = coercez2081Uz2080Uz2084U_32143;\n                ((__local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = INFINITY;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_53375)) {\n            // perform segmented scan to imitate reduction\n            {\n                int64_t eta_p_51266;\n                float eta_p_51267;\n                int64_t eta_p_51268;\n                float eta_p_51269;\n                int64_t eta_p_53521;\n                float eta_p_53522;\n                int64_t eta_p_53523;\n                float eta_p_53524;\n                bool ltid_in_bounds_53534 = slt64(sext_i32_i64(local_tid_53505), num_subhistos_53375 * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502));\n                int32_t skip_threads_53535;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_53534) {\n                        eta_p_51268 = ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)];\n                        eta_p_51269 = ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)];\n                        if ((local_tid_53505 - squot32(loca", "l_tid_53505, 32) * 32) == 0) {\n                            eta_p_51266 = eta_p_51268;\n                            eta_p_51267 = eta_p_51269;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53535 = 1;\n                    while (slt32(skip_threads_53535, 32)) {\n                        bool thread_active_53536 = sle32(skip_threads_53535, local_tid_53505 - squot32(local_tid_53505, 32) * 32) && ltid_in_bounds_53534;\n                        \n                        if (thread_active_53536) {\n                            // read operands\n                            {\n                                eta_p_51266 = ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505) - sext_i32_i64(skip_threads_53535)];\n                                eta_p_51267 = ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505) - sext_i32_i64(skip_threads_53535)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_53537 = slt64(srem64(sext_i32_i64(local_tid_53505), num_subhistos_53375), sext_i32_i64(local_tid_53505) - sext_i32_i64(local_tid_53505 - skip_threads_53535));\n                            \n                            if (thread_active_53536 && inactive_53537) {\n                                eta_p_51266 = eta_p_51268;\n                                eta_p_51267 = eta_p_51269;\n                            }\n                            if (thread_active_53536) {\n                                if (!inactive_53537) {\n                                    bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                                    bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                                    bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n               ", "                     bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                                    bool x_51274 = !zl_res_51270;\n                                    bool y_51275 = x_51273 && x_51274;\n                                    bool cond_51276 = zl_res_51270 || y_51275;\n                                    int64_t lifted_lambda_res_51277;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51277 = eta_p_51266;\n                                    } else {\n                                        lifted_lambda_res_51277 = eta_p_51268;\n                                    }\n                                    \n                                    float lifted_lambda_res_51278;\n                                    \n                                    if (cond_51276) {\n                                        lifted_lambda_res_51278 = eta_p_51267;\n                                    } else {\n                                        lifted_lambda_res_51278 = eta_p_51269;\n                                    }\n                                    eta_p_51266 = lifted_lambda_res_51277;\n                                    eta_p_51267 = lifted_lambda_res_51278;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_53507, skip_threads_53535)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53536) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = eta_p_51266;\n                                eta_p_51268 = eta_p_51266;\n                                ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = eta_p_51267;\n                          ",
                                    "      eta_p_51269 = eta_p_51267;\n                            }\n                        }\n                        if (sle32(wave_sizze_53507, skip_threads_53535)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53535 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_53505 - squot32(local_tid_53505, 32) * 32) == 31 && ltid_in_bounds_53534) {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(squot32(local_tid_53505, 32))] = eta_p_51266;\n                        ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(squot32(local_tid_53505, 32))] = eta_p_51267;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_53538;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_53505, 32) == 0 && ltid_in_bounds_53534) {\n                            eta_p_53523 = ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)];\n                            eta_p_53524 = ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)];\n                            if ((local_tid_53505 - squot32(local_tid_53505, 32) * 32) == 0) {\n                                eta_p_53521 = eta_p_53523;\n                                eta_p_53522 = eta_p_53524;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_53538 = 1;\n                        whil", "e (slt32(skip_threads_53538, 32)) {\n                            bool thread_active_53539 = sle32(skip_threads_53538, local_tid_53505 - squot32(local_tid_53505, 32) * 32) && (squot32(local_tid_53505, 32) == 0 && ltid_in_bounds_53534);\n                            \n                            if (thread_active_53539) {\n                                // read operands\n                                {\n                                    eta_p_53521 = ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505) - sext_i32_i64(skip_threads_53538)];\n                                    eta_p_53522 = ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505) - sext_i32_i64(skip_threads_53538)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_53540 = slt64(srem64(sext_i32_i64(local_tid_53505 * 32 + 32 - 1), num_subhistos_53375), sext_i32_i64(local_tid_53505 * 32 + 32 - 1) - sext_i32_i64((local_tid_53505 - skip_threads_53538) * 32 + 32 - 1));\n                                \n                                if (thread_active_53539 && inactive_53540) {\n                                    eta_p_53521 = eta_p_53523;\n                                    eta_p_53522 = eta_p_53524;\n                                }\n                                if (thread_active_53539) {\n                                    if (!inactive_53540) {\n                                        bool zl_res_53525 = eta_p_53522 < eta_p_53524;\n                                        bool zeze_res_53526 = eta_p_53522 == eta_p_53524;\n                                        bool cond_f_res_t_res_53527 = slt64(eta_p_53521, eta_p_53523);\n                                        bool x_53528 = zeze_res_53526 && cond_f_res_t_res_53527;\n                                        bool x_53529 = !zl_res_53525;\n                                  ", "      bool y_53530 = x_53528 && x_53529;\n                                        bool cond_53531 = zl_res_53525 || y_53530;\n                                        int64_t lifted_lambda_res_53532;\n                                        \n                                        if (cond_53531) {\n                                            lifted_lambda_res_53532 = eta_p_53521;\n                                        } else {\n                                            lifted_lambda_res_53532 = eta_p_53523;\n                                        }\n                                        \n                                        float lifted_lambda_res_53533;\n                                        \n                                        if (cond_53531) {\n                                            lifted_lambda_res_53533 = eta_p_53522;\n                                        } else {\n                                            lifted_lambda_res_53533 = eta_p_53524;\n                                        }\n                                        eta_p_53521 = lifted_lambda_res_53532;\n                                        eta_p_53522 = lifted_lambda_res_53533;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_53507, skip_threads_53538)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_53539) {\n                                // write result\n                                {\n                                    ((volatile __local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = eta_p_53521;\n                                    eta_p_53523 = eta_p_53521;\n                                    ((volatile __local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = eta_p_53522;\n                                    eta_p_53524 = eta_p_53522;\n                 ",
                                    "               }\n                            }\n                            if (sle32(wave_sizze_53507, skip_threads_53538)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_53538 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_53541 = squot32(local_tid_53505, 32) == 0 || !ltid_in_bounds_53534;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_53541) {\n                            eta_p_51268 = eta_p_51266;\n                            eta_p_51269 = eta_p_51267;\n                            eta_p_51266 = ((__local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(squot32(local_tid_53505, 32)) - (int64_t) 1];\n                            eta_p_51267 = ((__local float *) red_arr_f32_mem_53511)[sext_i32_i64(squot32(local_tid_53505, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_53542 = slt64(srem64(sext_i32_i64(local_tid_53505), num_subhistos_53375), sext_i32_i64(local_tid_53505) - sext_i32_i64(squot32(local_tid_53505, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_53541) {\n                            if (inactive_53542) {\n                                eta_p_51266 = eta_p_51268;\n                                eta_p_51267 = eta_p_51269;\n                            }\n                        }\n                        if (!no_carry_in_53541) {\n                            if (!inactive_53542) {\n                                bool zl_res_51270 = eta_p_51267 < eta_p_51269;\n                                bool zeze_res_51271 = eta_p_51267 == eta_p_51269;\n                          ", "      bool cond_f_res_t_res_51272 = slt64(eta_p_51266, eta_p_51268);\n                                bool x_51273 = zeze_res_51271 && cond_f_res_t_res_51272;\n                                bool x_51274 = !zl_res_51270;\n                                bool y_51275 = x_51273 && x_51274;\n                                bool cond_51276 = zl_res_51270 || y_51275;\n                                int64_t lifted_lambda_res_51277;\n                                \n                                if (cond_51276) {\n                                    lifted_lambda_res_51277 = eta_p_51266;\n                                } else {\n                                    lifted_lambda_res_51277 = eta_p_51268;\n                                }\n                                \n                                float lifted_lambda_res_51278;\n                                \n                                if (cond_51276) {\n                                    lifted_lambda_res_51278 = eta_p_51267;\n                                } else {\n                                    lifted_lambda_res_51278 = eta_p_51269;\n                                }\n                                eta_p_51266 = lifted_lambda_res_51277;\n                                eta_p_51267 = lifted_lambda_res_51278;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_53541) {\n                            ((__local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = eta_p_51266;\n                            ((__local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = eta_p_51267;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_53505, 32) == 0 && ltid_in_bounds_53534) {\n                    ", "    ((__local int64_t *) red_arr_i64_mem_53509)[sext_i32_i64(local_tid_53505)] = eta_p_51268;\n                        ((__local float *) red_arr_f32_mem_53511)[sext_i32_i64(local_tid_53505)] = eta_p_51269;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_53516) * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502) + sext_i32_i64(local_tid_53505), total_part_no_32153) && slt64(sext_i32_i64(local_tid_53505), squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502))) {\n                int64_t tmp_53543 = ((__local int64_t *) red_arr_i64_mem_53509)[(sext_i32_i64(local_tid_53505) + (int64_t) 1) * segment_sizze_nonzzero_53502 - (int64_t) 1];\n                \n                ((__global int64_t *) mem_52685)[sext_i32_i64(virt_tblock_id_53516) * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502) + sext_i32_i64(local_tid_53505)] = tmp_53543;\n                \n                float tmp_53544 = ((__local float *) red_arr_f32_mem_53511)[(sext_i32_i64(local_tid_53505) + (int64_t) 1) * segment_sizze_nonzzero_53502 - (int64_t) 1];\n                \n                ((__global float *) mem_52687)[sext_i32_i64(virt_tblock_id_53516) * squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502) + sext_i32_i64(local_tid_53505)] = tmp_53544;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef seghist_tblock_sizze_51258\n}\nFUTHARK_KERNEL_SIZED(skyline_local_filter_9621zisegscan_51419_dim1, 1, 1)\nvoid skyline_local_filter_9621zisegscan_51419(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_32139, int64_t dz2081U_32142, int64_t coercez2081Uz2080Uz2084U_32143, int64_t total_angle_no_32",
                                    "151, int64_t total_part_no_32153, int64_t num_fpts_32339, unsigned char cond_46560_bits, unsigned char cond_46561_bits, int64_t num_tblocks_51416, unsigned char x_52856_bits, int64_t num_threads_53089, int64_t num_virt_blocks_53644, int64_t num_virt_threads_53645, __global unsigned char *isPartitionDominated_mem_52567, __global unsigned char *xys_mem_52568, __global unsigned char *mem_52683, __global unsigned char *mem_52759, __global unsigned char *mem_52770, __global unsigned char *mem_52808, __global unsigned char *mem_52810, __global unsigned char *color_52941, __global unsigned char *color_52942, __global unsigned char *status_flags_mem_53646, __global unsigned char *aggregates_mem_53668, __global unsigned char *incprefixes_mem_53670, __global unsigned char *global_dynid_mem_53672)\n{\n    bool cond_46560 = cond_46560_bits;\n    bool cond_46561 = cond_46561_bits;\n    bool x_52856 = x_52856_bits;\n    \n    #define segscan_tblock_sizze_51414 (skyline_local_filter_9621zisegscan_51419zisegscan_tblock_sizze_51414)\n    #define chunk_sizze_53643 (skyline_local_filter_9621zisegscan_51419zichunk_sizze_53643)\n    \n    volatile __local unsigned char *local_mem_53682_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53682_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51414), chunk_sizze_53643 * segscan_tblock_sizze_51414 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51414), chunk_sizze_53643 * segscan_tblock_sizze_51414 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53675;\n    int32_t tblock_sizze_53678;\n    int32_t wave_sizze_53677;\n    int32_t block_id_53676;\n    int32_t global_tid_53674;\n    int64_t phys_tid_5141", "9;\n    int32_t chunk_sizze_32b_53679;\n    int64_t byte_offsets_53680;\n    int64_t warp_byte_offset_53681;\n    __local unsigned char *local_mem_53682;\n    int64_t trans_arr_len_53683;\n    int64_t phys_block_id_53689;\n    int64_t virtloop_bound_53690;\n    \n    local_tid_53675 = get_local_id(0);\n    tblock_sizze_53678 = get_local_size(0);\n    wave_sizze_53677 = LOCKSTEP_WIDTH;\n    block_id_53676 = get_tblock_id(0);\n    global_tid_53674 = block_id_53676 * tblock_sizze_53678 + local_tid_53675;\n    phys_tid_51419 = sext_i32_i64(global_tid_53674);\n    chunk_sizze_32b_53679 = sext_i64_i32(chunk_sizze_53643);\n    byte_offsets_53680 = segscan_tblock_sizze_51414 * (int64_t) 8;\n    warp_byte_offset_53681 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53682 = (__local unsigned char *) local_mem_53682_backing_0;\n    trans_arr_len_53683 = chunk_sizze_53643 * segscan_tblock_sizze_51414;\n    phys_block_id_53689 = get_tblock_id(0);\n    virtloop_bound_53690 = sdiv_up64(num_virt_blocks_53644 - phys_block_id_53689, num_tblocks_51416);\n    for (int64_t virtloop_i_53691 = 0; virtloop_i_53691 < virtloop_bound_53690; virtloop_i_53691++) {\n        int64_t dynamic_id_53692;\n        int64_t block_offset_53693;\n        int64_t sgm_idx_53694;\n        int32_t boundary_53695;\n        int32_t segsizze_compact_53696;\n        int64_t private_mem_53697[chunk_sizze_53643];\n        int64_t thd_offset_53699;\n        int64_t acc_53730;\n        int64_t prefix_53740;\n        bool block_new_sgm_53741;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53675 == 0) {\n                dynamic_id_53692 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53672)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53682)[(int64_t) 0] = dynamic_id_53692;\n                }\n                // First thread in last (virtual) bl", "ock resets global dynamic_id\n                {\n                    if (dynamic_id_53692 == num_virt_blocks_53644 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53672)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53692 = ((__local int32_t *) local_mem_53682)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53693 = dynamic_id_53692 * chunk_sizze_53643 * segscan_tblock_sizze_51414;\n        sgm_idx_53694 = smod64(block_offset_53693, coercez2081Uz2080Uz2084U_32143);\n        boundary_53695 = sext_i64_i32(smin64(chunk_sizze_53643 * segscan_tblock_sizze_51414, coercez2081Uz2080Uz2084U_32143 - sgm_idx_53694));\n        segsizze_compact_53696 = sext_i64_i32(smin64(chunk_sizze_53643 * segscan_tblock_sizze_51414, coercez2081Uz2080Uz2084U_32143));\n        thd_offset_53699 = block_offset_53693 + sext_i32_i64(local_tid_53675);\n        // Load and map\n        {\n            for (int64_t i_53700 = 0; i_53700 < chunk_sizze_53643; i_53700++) {\n                int64_t virt_tid_53701 = thd_offset_53699 + i_53700 * segscan_tblock_sizze_51414;\n                int64_t slice_53702 = coercez2081Uz2080Uz2084U_32143;\n                int64_t gtid_51418 = virt_tid_53701;\n                int64_t remnant_53703 = virt_tid_53701 - gtid_51418;\n                \n                if (slt64(virt_tid_53701, coercez2081Uz2080Uz2084U_32143)) {\n                    int64_t eta_p_47813 = ((__global int64_t *) mem_52683)[gtid_51418];\n                    bool x_47815 = sle64((int64_t) 0, eta_p_47813);\n                    bool y_47816 = slt64(eta_p_47813, total_part_no_32153);\n                    bool bounds_check_47817 = x_47815 && y_47816;\n                    bool index_certs_47818;\n                    \n                    if (!bounds_check_47817) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n ",
                                    "                               global_failure_args[0] = (int64_t) eta_p_47813;\n                                global_failure_args[1] = (int64_t) total_part_no_32153;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    int64_t grid_id_47865 = sdiv64(eta_p_47813, total_angle_no_32151);\n                    bool x_47866 = sle64((int64_t) 0, grid_id_47865);\n                    bool y_47867 = slt64(grid_id_47865, dz2081U_32142);\n                    bool bounds_check_47868 = x_47866 && y_47867;\n                    bool index_certs_47869;\n                    \n                    if (!bounds_check_47868) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 23) == -1) {\n                                global_failure_args[0] = (int64_t) grid_id_47865;\n                                global_failure_args[1] = (int64_t) dz2081U_32142;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    bool defunc_0_f_res_47854;\n                    \n                    if (cond_46561) {\n                        for (int64_t i_52500 = 0; i_52500 < num_fpts_32339; i_52500++) {\n                            bool defunc_0_reduce_res_48844;\n                            \n                            if (x_52856) {\n                                bool x_52835;\n                                bool redout_52506 = 1;\n                                \n                                for (int64_t i_52507 = 0; i_52507 < dim_32139; i_52507++) {\n                                    float eta_p_48845 = ((__global float *) xys_mem_52568)[gtid_51418 * dim_32139 + i_52507];\n                      ", "              float eta_p_48846 = ((__global float *) mem_52759)[i_52500 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52507 * num_fpts_32339];\n                                    bool zgze_res_48847 = eta_p_48846 <= eta_p_48845;\n                                    bool x_48850 = zgze_res_48847 && redout_52506;\n                                    bool redout_tmp_53705 = x_48850;\n                                    \n                                    redout_52506 = redout_tmp_53705;\n                                }\n                                x_52835 = redout_52506;\n                                defunc_0_reduce_res_48844 = x_52835;\n                            } else {\n                                defunc_0_reduce_res_48844 = 0;\n                            }\n                            \n                            bool defunc_0_sm_red_res_48833;\n                            \n                            if (cond_46560) {\n                                for (int64_t i_52504 = 0; i_52504 < dim_32139; i_52504++) {\n                                    float eta_p_48835 = ((__global float *) xys_mem_52568)[gtid_51418 * dim_32139 + i_52504];\n                                    float eta_p_48836 = ((__global float *) mem_52759)[i_52500 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52504 * num_fpts_32339];\n                                    bool zgze_res_48837 = eta_p_48836 <= eta_p_48835;\n                                    \n                                    ((__global bool *) color_52941)[phys_tid_51419 + i_52504 * num_threads_53089] = zgze_res_48837;\n                                }\n                                \n                                bool defunc_0_foldl_res_48839;\n                                bool acc_48841 = 1;\n                                \n                                for (int64_t i_48840 = 0; i_48840 < dim_32139; i_48840++) {\n                                    bool b_48842 = ((__global bool *) color_52941)[phys_tid_51419 + i_48840", " * num_threads_53089];\n                                    bool x_48843 = acc_48841 && b_48842;\n                                    bool acc_tmp_53707 = x_48843;\n                                    \n                                    acc_48841 = acc_tmp_53707;\n                                }\n                                defunc_0_foldl_res_48839 = acc_48841;\n                                defunc_0_sm_red_res_48833 = defunc_0_foldl_res_48839;\n                            } else {\n                                defunc_0_sm_red_res_48833 = defunc_0_reduce_res_48844;\n                            }\n                            \n                            bool lifted_lambda_res_48852;\n                            \n                            if (defunc_0_sm_red_res_48833) {\n                                bool defunc_0_sm_red_res_48854;\n                                \n                                if (cond_46560) {\n                                    for (int64_t i_52510 = 0; i_52510 < dim_32139; i_52510++) {\n                                        float eta_p_48856 = ((__global float *) xys_mem_52568)[gtid_51418 * dim_32139 + i_52510];\n                                        float eta_p_48857 = ((__global float *) mem_52759)[i_52500 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52510 * num_fpts_32339];\n                                        bool zg_res_48858 = eta_p_48857 < eta_p_48856;\n                                        \n                                        ((__global bool *) color_52941)[phys_tid_51419 + i_52510 * num_threads_53089] = zg_res_48858;\n                                    }\n                                    \n                                    bool defunc_0_foldl_res_48860;\n                                    bool acc_48862 = 0;\n                                    \n                                    for (int64_t i_48861 = 0; i_48861 < dim_32139; i_48861++) {\n                                        bool b_48863 = ((__global bool *) colo",
                                    "r_52941)[phys_tid_51419 + i_48861 * num_threads_53089];\n                                        bool defunc_0_f_res_48864 = acc_48862 || b_48863;\n                                        bool acc_tmp_53709 = defunc_0_f_res_48864;\n                                        \n                                        acc_48862 = acc_tmp_53709;\n                                    }\n                                    defunc_0_foldl_res_48860 = acc_48862;\n                                    defunc_0_sm_red_res_48854 = defunc_0_foldl_res_48860;\n                                } else {\n                                    bool defunc_0_reduce_res_48865;\n                                    bool redout_52512 = 0;\n                                    \n                                    for (int64_t i_52513 = 0; i_52513 < dim_32139; i_52513++) {\n                                        float eta_p_48866 = ((__global float *) xys_mem_52568)[gtid_51418 * dim_32139 + i_52513];\n                                        float eta_p_48867 = ((__global float *) mem_52759)[i_52500 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52513 * num_fpts_32339];\n                                        bool zg_res_48868 = eta_p_48867 < eta_p_48866;\n                                        bool defunc_0_op_res_48871 = zg_res_48868 || redout_52512;\n                                        bool redout_tmp_53710 = defunc_0_op_res_48871;\n                                        \n                                        redout_52512 = redout_tmp_53710;\n                                    }\n                                    defunc_0_reduce_res_48865 = redout_52512;\n                                    defunc_0_sm_red_res_48854 = defunc_0_reduce_res_48865;\n                                }\n                                lifted_lambda_res_48852 = defunc_0_sm_red_res_48854;\n                            } else {\n                                lifted_lambda_res_48852 = 0;\n                            }\n                ", "            ((__global bool *) color_52942)[phys_tid_51419 + i_52500 * num_threads_53089] = lifted_lambda_res_48852;\n                        }\n                        \n                        bool defunc_0_foldl_res_48874;\n                        bool acc_48876 = 0;\n                        \n                        for (int64_t i_48875 = 0; i_48875 < num_fpts_32339; i_48875++) {\n                            bool b_48877 = ((__global bool *) color_52942)[phys_tid_51419 + i_48875 * num_threads_53089];\n                            bool defunc_0_f_res_48878 = acc_48876 || b_48877;\n                            bool acc_tmp_53711 = defunc_0_f_res_48878;\n                            \n                            acc_48876 = acc_tmp_53711;\n                        }\n                        defunc_0_foldl_res_48874 = acc_48876;\n                        defunc_0_f_res_47854 = defunc_0_foldl_res_48874;\n                    } else {\n                        bool defunc_0_reduce_res_48923;\n                        bool redout_52514 = 0;\n                        \n                        for (int64_t i_52515 = 0; i_52515 < num_fpts_32339; i_52515++) {\n                            bool defunc_0_reduce_res_48890;\n                            \n                            if (x_52856) {\n                                bool x_52858;\n                                bool redout_52520 = 1;\n                                \n                                for (int64_t i_52521 = 0; i_52521 < dim_32139; i_52521++) {\n                                    float eta_p_48466 = ((__global float *) mem_52770)[gtid_51418 + i_52521 * coercez2081Uz2080Uz2084U_32143];\n                                    float eta_p_48467 = ((__global float *) mem_52759)[i_52515 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52521 * num_fpts_32339];\n                                    bool zgze_res_48468 = eta_p_48467 <= eta_p_48466;\n                                    bool x_48431 = zgze_res_48468 && redout_52520;\n                  ", "                  bool redout_tmp_53713 = x_48431;\n                                    \n                                    redout_52520 = redout_tmp_53713;\n                                }\n                                x_52858 = redout_52520;\n                                defunc_0_reduce_res_48890 = x_52858;\n                            } else {\n                                defunc_0_reduce_res_48890 = 0;\n                            }\n                            \n                            bool defunc_0_sm_red_res_48413;\n                            \n                            if (cond_46560) {\n                                for (int64_t i_52518 = 0; i_52518 < dim_32139; i_52518++) {\n                                    float eta_p_48881 = ((__global float *) mem_52770)[gtid_51418 + i_52518 * coercez2081Uz2080Uz2084U_32143];\n                                    float eta_p_48882 = ((__global float *) mem_52759)[i_52515 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52518 * num_fpts_32339];\n                                    bool zgze_res_48883 = eta_p_48882 <= eta_p_48881;\n                                    \n                                    ((__global bool *) color_52941)[phys_tid_51419 + i_52518 * num_threads_53089] = zgze_res_48883;\n                                }\n                                \n                                bool defunc_0_foldl_res_48885;\n                                bool acc_48887 = 1;\n                                \n                                for (int64_t i_48886 = 0; i_48886 < dim_32139; i_48886++) {\n                                    bool b_48888 = ((__global bool *) color_52941)[phys_tid_51419 + i_48886 * num_threads_53089];\n                                    bool x_48889 = acc_48887 && b_48888;\n                                    bool acc_tmp_53715 = x_48889;\n                                    \n                                    acc_48887 = acc_tmp_53715;\n                                }\n                     ",
                                    "           defunc_0_foldl_res_48885 = acc_48887;\n                                defunc_0_sm_red_res_48413 = defunc_0_foldl_res_48885;\n                            } else {\n                                defunc_0_sm_red_res_48413 = defunc_0_reduce_res_48890;\n                            }\n                            \n                            bool lifted_lambda_res_48432;\n                            \n                            if (defunc_0_sm_red_res_48413) {\n                                bool defunc_0_sm_red_res_48904;\n                                \n                                if (cond_46560) {\n                                    for (int64_t i_52524 = 0; i_52524 < dim_32139; i_52524++) {\n                                        float eta_p_48906 = ((__global float *) mem_52770)[gtid_51418 + i_52524 * coercez2081Uz2080Uz2084U_32143];\n                                        float eta_p_48907 = ((__global float *) mem_52759)[i_52515 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52524 * num_fpts_32339];\n                                        bool zg_res_48908 = eta_p_48907 < eta_p_48906;\n                                        \n                                        ((__global bool *) color_52941)[phys_tid_51419 + i_52524 * num_threads_53089] = zg_res_48908;\n                                    }\n                                    \n                                    bool defunc_0_foldl_res_48910;\n                                    bool acc_48912 = 0;\n                                    \n                                    for (int64_t i_48911 = 0; i_48911 < dim_32139; i_48911++) {\n                                        bool b_48913 = ((__global bool *) color_52941)[phys_tid_51419 + i_48911 * num_threads_53089];\n                                        bool defunc_0_f_res_48914 = acc_48912 || b_48913;\n                                        bool acc_tmp_53717 = defunc_0_f_res_48914;\n                                        \n                              ", "          acc_48912 = acc_tmp_53717;\n                                    }\n                                    defunc_0_foldl_res_48910 = acc_48912;\n                                    defunc_0_sm_red_res_48904 = defunc_0_foldl_res_48910;\n                                } else {\n                                    bool defunc_0_reduce_res_48915;\n                                    bool redout_52526 = 0;\n                                    \n                                    for (int64_t i_52527 = 0; i_52527 < dim_32139; i_52527++) {\n                                        float eta_p_48916 = ((__global float *) mem_52770)[gtid_51418 + i_52527 * coercez2081Uz2080Uz2084U_32143];\n                                        float eta_p_48917 = ((__global float *) mem_52759)[i_52515 + eta_p_47813 * (num_fpts_32339 * dim_32139) + i_52527 * num_fpts_32339];\n                                        bool zg_res_48918 = eta_p_48917 < eta_p_48916;\n                                        bool defunc_0_op_res_48921 = zg_res_48918 || redout_52526;\n                                        bool redout_tmp_53718 = defunc_0_op_res_48921;\n                                        \n                                        redout_52526 = redout_tmp_53718;\n                                    }\n                                    defunc_0_reduce_res_48915 = redout_52526;\n                                    defunc_0_sm_red_res_48904 = defunc_0_reduce_res_48915;\n                                }\n                                lifted_lambda_res_48432 = defunc_0_sm_red_res_48904;\n                            } else {\n                                lifted_lambda_res_48432 = 0;\n                            }\n                            \n                            bool defunc_0_op_res_47864 = lifted_lambda_res_48432 || redout_52514;\n                            bool redout_tmp_53712 = defunc_0_op_res_47864;\n                            \n                            redout_52514 = redout_tmp_53712;\n       ", "                 }\n                        defunc_0_reduce_res_48923 = redout_52514;\n                        defunc_0_f_res_47854 = defunc_0_reduce_res_48923;\n                    }\n                    \n                    bool cond_47870 = ((__global bool *) isPartitionDominated_mem_52567)[grid_id_47865];\n                    bool tmp_47871 = defunc_0_f_res_47854 || cond_47870;\n                    bool lifted_lambda_res_47873 = !tmp_47871;\n                    int64_t defunc_0_f_res_47874 = btoi_bool_i64(lifted_lambda_res_47873);\n                    \n                    ((__global int64_t *) mem_52810)[gtid_51418] = defunc_0_f_res_47874;\n                    private_mem_53697[i_53700] = defunc_0_f_res_47874;\n                } else {\n                    private_mem_53697[i_53700] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53719 = 0; i_53719 < chunk_sizze_53643; i_53719++) {\n                int64_t sharedIdx_53720 = sext_i32_i64(local_tid_53675) + i_53719 * segscan_tblock_sizze_51414;\n                int64_t tmp_53721 = private_mem_53697[i_53719];\n                \n                ((__local int64_t *) local_mem_53682)[sharedIdx_53720] = tmp_53721;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53722 = 0; i_53722 < chunk_sizze_53643; i_53722++) {\n                int64_t sharedIdx_53723 = sext_i32_i64(local_tid_53675) * chunk_sizze_53643 + i_53722;\n                int64_t tmp_53724 = ((__local int64_t *) local_mem_53682)[sharedIdx_53723];\n                \n                private_mem_53697[i_53722] = tmp_53724;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53725 = 0; i_53725 < chunk_sizze_53643 - (int64_t) 1; i_53725++) {\n        ",
                                    "        int64_t eta_p_45246;\n                int64_t eta_p_45247;\n                \n                eta_p_45246 = private_mem_53697[i_53725];\n                eta_p_45247 = private_mem_53697[i_53725 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_45248 = add64(eta_p_45246, eta_p_45247);\n                \n                private_mem_53697[i_53725 + (int64_t) 1] = defunc_0_op_res_45248;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53726 = private_mem_53697[chunk_sizze_53643 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = tmp_53726;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53727;\n            int64_t eta_p_53728;\n            int64_t eta_p_53731;\n            int64_t eta_p_53732;\n            bool ltid_in_bounds_53734 = slt64(sext_i32_i64(local_tid_53675), num_virt_threads_53645);\n            int32_t skip_threads_53735;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53734) {\n                    eta_p_53728 = ((volatile __local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)];\n                    if ((local_tid_53675 - squot32(local_tid_53675, 32) * 32) == 0) {\n                        eta_p_53727 = eta_p_53728;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53735 = 1;\n                while (slt32(skip_threads_53735, 32)) {\n                    bool thread_active_53736 = sle32(skip_threads_53735, local_tid_53675 - squot32(local_tid_53675, 32) * 32) && ltid_in_bounds_53734;\n                    \n                    if (thread_active_53736) {\n                        // read operands\n                        {\n                            eta_p_53727 = ((volatile __local int64_t ", "*) local_mem_53682)[sext_i32_i64(local_tid_53675) - sext_i32_i64(skip_threads_53735)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53736) {\n                            int64_t defunc_0_op_res_53729 = add64(eta_p_53727, eta_p_53728);\n                            \n                            eta_p_53727 = defunc_0_op_res_53729;\n                        }\n                    }\n                    if (sle32(wave_sizze_53677, skip_threads_53735)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53736) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = eta_p_53727;\n                            eta_p_53728 = eta_p_53727;\n                        }\n                    }\n                    if (sle32(wave_sizze_53677, skip_threads_53735)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53735 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53675 - squot32(local_tid_53675, 32) * 32) == 31 && ltid_in_bounds_53734) {\n                    ((volatile __local int64_t *) local_mem_53682)[sext_i32_i64(squot32(local_tid_53675, 32))] = eta_p_53727;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53737;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53675, 32) == 0 && ltid_in_bounds_53734) {\n                        eta_p_53732 = ((volatile __lo", "cal int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)];\n                        if ((local_tid_53675 - squot32(local_tid_53675, 32) * 32) == 0) {\n                            eta_p_53731 = eta_p_53732;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53737 = 1;\n                    while (slt32(skip_threads_53737, 32)) {\n                        bool thread_active_53738 = sle32(skip_threads_53737, local_tid_53675 - squot32(local_tid_53675, 32) * 32) && (squot32(local_tid_53675, 32) == 0 && ltid_in_bounds_53734);\n                        \n                        if (thread_active_53738) {\n                            // read operands\n                            {\n                                eta_p_53731 = ((volatile __local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675) - sext_i32_i64(skip_threads_53737)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53738) {\n                                int64_t defunc_0_op_res_53733 = add64(eta_p_53731, eta_p_53732);\n                                \n                                eta_p_53731 = defunc_0_op_res_53733;\n                            }\n                        }\n                        if (sle32(wave_sizze_53677, skip_threads_53737)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53738) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = eta_p_53731;\n                                eta_p_53732 = eta_p_53731;\n                            }\n                        }\n                        if (sle32(wave_sizze_53677, skip_threads_53737)) ",
                                    "{\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53737 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53739 = squot32(local_tid_53675, 32) == 0 || !ltid_in_bounds_53734;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53739) {\n                        eta_p_53728 = eta_p_53727;\n                        eta_p_53727 = ((__local int64_t *) local_mem_53682)[sext_i32_i64(squot32(local_tid_53675, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53739) {\n                        int64_t defunc_0_op_res_53729 = add64(eta_p_53727, eta_p_53728);\n                        \n                        eta_p_53727 = defunc_0_op_res_53729;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53739) {\n                        ((__local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = eta_p_53727;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53675, 32) == 0 && ltid_in_bounds_53734) {\n                    ((__local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = eta_p_53728;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53675 == 0) {\n                acc_53730 = ((__local int64_t *) local_mem_53682)[segscan_tblock_sizze_51414 - (int64_t) 1];\n            } else {\n                acc_53730 = ((__local int64_t *) local_mem_53682)[sext_i32_i64(local_tid_53", "675) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53740 = (int64_t) 0;\n        block_new_sgm_53741 = sgm_idx_53694 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53741 && local_tid_53675 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53670)[dynamic_id_53692] = acc_53730;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53646)[dynamic_id_53692] = (int8_t) 2;\n                acc_53730 = (int64_t) 0;\n            }\n            if (!block_new_sgm_53741 && slt32(local_tid_53675, wave_sizze_53677)) {\n                if (local_tid_53675 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53668)[dynamic_id_53692] = acc_53730;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53646)[dynamic_id_53692] = (int8_t) 1;\n                    \n                    int8_t tmp_53742 = ((volatile __global int8_t *) status_flags_mem_53646)[dynamic_id_53692 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53682)[(int64_t) 0] = tmp_53742;\n                }\n                mem_fence_local();\n                \n                int8_t status_53743 = ((__local int8_t *) local_mem_53682)[(int64_t) 0];\n                \n                if (status_53743 == (int8_t) 2) {\n                    if (local_tid_53675 == 0) {\n                        prefix_53740 = ((volatile __global int64_t *) incprefixes_mem_53670)[dynamic_id_53692 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53744 = sext_i64_i32(dynamic_id_53692 - sext_i32_i64(wave_sizze_53677));\n                    \n                    while (slt32(wave_sizze_53677 * -1, readOffset_53744)) {\n                        int32_t read_i_53745 = readOffset_53744 + local_tid_53675;\n                        int64_t aggr_53746 =", " (int64_t) 0;\n                        int8_t flag_53747 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53745)) {\n                            flag_53747 = ((volatile __global int8_t *) status_flags_mem_53646)[sext_i32_i64(read_i_53745)];\n                            if (flag_53747 == (int8_t) 2) {\n                                aggr_53746 = ((volatile __global int64_t *) incprefixes_mem_53670)[sext_i32_i64(read_i_53745)];\n                            } else if (flag_53747 == (int8_t) 1) {\n                                aggr_53746 = ((volatile __global int64_t *) aggregates_mem_53668)[sext_i32_i64(read_i_53745)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53682)[(int64_t) 4 + sext_i32_i64(local_tid_53675)] = aggr_53746;\n                        ((__local int8_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = flag_53747;\n                        flag_53747 = ((__local int8_t *) local_mem_53682)[sext_i32_i64(wave_sizze_53677) - (int64_t) 1];\n                        if (slt8(flag_53747, (int8_t) 2)) {\n                            int8_t flg_x_53751;\n                            int8_t flg_y_53752;\n                            int64_t eta_p_53748;\n                            int64_t eta_p_53749;\n                            int32_t skip_threads_53753;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53752 = ((volatile __local int8_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)];\n                                eta_p_53749 = ((volatile __local int64_t *) local_mem_53682)[(int64_t) 4 + sext_i32_i64(local_tid_53675)];\n                                if ((local_tid_53675 - squot32(local_tid_53675, 32) * 32) == 0) {\n                                    eta_p_53748 = eta_p_53749;\n                                    flg_x_53751 = flg_y_53752;\n                         ",
                                    "       }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53753 = 1;\n                                while (slt32(skip_threads_53753, 32)) {\n                                    if (sle32(skip_threads_53753, local_tid_53675 - squot32(local_tid_53675, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53751 = ((volatile __local int8_t *) local_mem_53682)[sext_i32_i64(local_tid_53675) - sext_i32_i64(skip_threads_53753)];\n                                            eta_p_53748 = ((volatile __local int64_t *) local_mem_53682)[(int64_t) 4 + (sext_i32_i64(local_tid_53675) - sext_i32_i64(skip_threads_53753))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53752 == (int8_t) 2 || flg_y_53752 == (int8_t) 0) {\n                                                flg_x_53751 = flg_y_53752;\n                                                eta_p_53748 = eta_p_53749;\n                                            } else {\n                                                int64_t defunc_0_op_res_53750 = add64(eta_p_53748, eta_p_53749);\n                                                \n                                                eta_p_53748 = defunc_0_op_res_53750;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53682)[sext_i32_i64(local_tid_53675)] = flg_x_53751;\n                                            flg_y_53752 = flg_x_53751;\n                                            ((volatil", "e __local int64_t *) local_mem_53682)[(int64_t) 4 + sext_i32_i64(local_tid_53675)] = eta_p_53748;\n                                            eta_p_53749 = eta_p_53748;\n                                        }\n                                    }\n                                    skip_threads_53753 *= 2;\n                                }\n                            }\n                        }\n                        flag_53747 = ((__local int8_t *) local_mem_53682)[sext_i32_i64(wave_sizze_53677) - (int64_t) 1];\n                        aggr_53746 = ((__local int64_t *) local_mem_53682)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53677) - (int64_t) 1)];\n                        if (flag_53747 == (int8_t) 2) {\n                            readOffset_53744 = wave_sizze_53677 * -1;\n                        } else if (flag_53747 == (int8_t) 1) {\n                            readOffset_53744 -= wave_sizze_53677;\n                        }\n                        if (slt8((int8_t) 0, flag_53747)) {\n                            int64_t eta_p_53754 = aggr_53746;\n                            int64_t eta_p_53755 = prefix_53740;\n                            int64_t defunc_0_op_res_53756 = add64(eta_p_53754, eta_p_53755);\n                            \n                            prefix_53740 = defunc_0_op_res_53756;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53675 == 0) {\n                    if (boundary_53695 == sext_i64_i32(segscan_tblock_sizze_51414 * chunk_sizze_53643)) {\n                        int64_t eta_p_53757 = prefix_53740;\n                        int64_t eta_p_53758 = acc_53730;\n                        int64_t defunc_0_op_res_53759 = add64(eta_p_53757, eta_p_53758);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53670)[dynamic_id_53692] = defunc_0_op_res_53759;\n                        mem_fence_global();\n                        ((volat", "ile __global int8_t *) status_flags_mem_53646)[dynamic_id_53692] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53682)[(int64_t) 4] = prefix_53740;\n                    acc_53730 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_53692 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53740 = ((__local int64_t *) local_mem_53682)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53760;\n            int64_t eta_p_53761;\n            int64_t eta_p_53763 = prefix_53740;\n            int64_t eta_p_53764 = acc_53730;\n            \n            if (slt32(local_tid_53675 * chunk_sizze_32b_53679, boundary_53695) && !block_new_sgm_53741) {\n                int64_t defunc_0_op_res_53765 = add64(eta_p_53763, eta_p_53764);\n                \n                eta_p_53760 = defunc_0_op_res_53765;\n            } else {\n                eta_p_53760 = acc_53730;\n            }\n            \n            int32_t stopping_point_53766 = segsizze_compact_53696 - srem32(local_tid_53675 * chunk_sizze_32b_53679 - 1 + segsizze_compact_53696 - boundary_53695, segsizze_compact_53696);\n            \n            for (int64_t i_53767 = 0; i_53767 < chunk_sizze_53643; i_53767++) {\n                if (slt32(sext_i64_i32(i_53767), stopping_point_53766 - 1)) {\n                    eta_p_53761 = private_mem_53697[i_53767];\n                    \n                    int64_t defunc_0_op_res_53762 = add64(eta_p_53760, eta_p_53761);\n                    \n                    private_mem_53697[i_53767] = defunc_0_op_res_53762;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53768 = 0; i_53768 < chunk_sizze_53643; i_53768++) {\n                int64_t sharedIdx_53769 = sext_i32_i64(local_tid_53675) * chunk_sizze_536",
                                    "43 + i_53768;\n                int64_t tmp_53770 = private_mem_53697[i_53768];\n                \n                ((__local int64_t *) local_mem_53682)[sharedIdx_53769] = tmp_53770;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53771 = 0; i_53771 < chunk_sizze_53643; i_53771++) {\n                int64_t flat_idx_53772 = thd_offset_53699 + i_53771 * segscan_tblock_sizze_51414;\n                int64_t slice_53773 = coercez2081Uz2080Uz2084U_32143;\n                int64_t gtid_51418 = flat_idx_53772;\n                int64_t remnant_53774 = flat_idx_53772 - gtid_51418;\n                \n                if (slt64(flat_idx_53772, coercez2081Uz2080Uz2084U_32143)) {\n                    int64_t tmp_53775 = ((__local int64_t *) local_mem_53682)[flat_idx_53772 - block_offset_53693];\n                    \n                    ((__global int64_t *) mem_52808)[gtid_51418] = tmp_53775;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_51414\n    #undef chunk_sizze_53643\n}\nFUTHARK_KERNEL_SIZED(skyline_mergeFilter_2_floatzisegmap_49495_dim1, 1, 1)\nvoid skyline_mergeFilter_2_floatzisegmap_49495(__global int *global_failure, int64_t dz2081U_43210, __global unsigned char *ext_mem_52584, __global unsigned char *ext_mem_52587, __global unsigned char *mem_52594)\n{\n    #define segmap_tblock_sizze_49491 (skyline_mergeFilter_2_floatzisegmap_49495zisegmap_tblock_sizze_49491)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49495;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49494;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n", "    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49495 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49491 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_43210;\n    gtid_49494 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49494;\n    if (slt64(gtid_49494, dz2081U_43210)) {\n        bool eta_p_49496;\n        bool eta_p_49497;\n        bool lifted_lambda_res_49498;\n        \n        eta_p_49496 = ((__global bool *) ext_mem_52587)[gtid_49494];\n        eta_p_49497 = ((__global bool *) ext_mem_52584)[gtid_49494];\n        lifted_lambda_res_49498 = eta_p_49496 || eta_p_49497;\n        ((__global bool *) mem_52594)[gtid_49494] = lifted_lambda_res_49498;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49491\n}\nFUTHARK_KERNEL_SIZED(skyline_mergeFilter_3_floatzisegmap_49473_dim1, 1, 1)\nvoid skyline_mergeFilter_3_floatzisegmap_49473(__global int *global_failure, int64_t dz2081U_42763, __global unsigned char *ext_mem_52599, __global unsigned char *ext_mem_52602, __global unsigned char *ext_mem_52605, __global unsigned char *mem_52612)\n{\n    #define segmap_tblock_sizze_49469 (skyline_mergeFilter_3_floatzisegmap_49473zisegmap_tblock_sizze_49469)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49473;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49472;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49473 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_4", "9469 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_42763;\n    gtid_49472 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49472;\n    if (slt64(gtid_49472, dz2081U_42763)) {\n        bool eta_p_49474;\n        bool eta_p_49475;\n        bool eta_p_49476;\n        bool cond_49477;\n        bool lifted_lambda_res_49478;\n        \n        eta_p_49474 = ((__global bool *) ext_mem_52599)[gtid_49472];\n        eta_p_49475 = ((__global bool *) ext_mem_52602)[gtid_49472];\n        eta_p_49476 = ((__global bool *) ext_mem_52605)[gtid_49472];\n        cond_49477 = eta_p_49474 || eta_p_49475;\n        lifted_lambda_res_49478 = eta_p_49476 || cond_49477;\n        ((__global bool *) mem_52612)[gtid_49472] = lifted_lambda_res_49478;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49469\n}\nFUTHARK_KERNEL_SIZED(skyline_mergeFilter_4_floatzisegmap_49551_dim1, 1, 1)\nvoid skyline_mergeFilter_4_floatzisegmap_49551(__global int *global_failure, int64_t dz2081U_41606, __global unsigned char *ext_mem_52611, __global unsigned char *ext_mem_52617, __global unsigned char *ext_mem_52623, __global unsigned char *ext_mem_52629, __global unsigned char *mem_52636)\n{\n    #define segmap_tblock_sizze_49547 (skyline_mergeFilter_4_floatzisegmap_49551zisegmap_tblock_sizze_49547)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49551;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49550;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49551 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_",
                                    "49547 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_41606;\n    gtid_49550 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49550;\n    if (slt64(gtid_49550, dz2081U_41606)) {\n        bool eta_p_49552;\n        bool eta_p_49553;\n        bool eta_p_49554;\n        bool eta_p_49555;\n        bool cond_49556;\n        bool cond_49557;\n        bool lifted_lambda_res_49558;\n        \n        eta_p_49552 = ((__global bool *) ext_mem_52611)[gtid_49550];\n        eta_p_49553 = ((__global bool *) ext_mem_52617)[gtid_49550];\n        eta_p_49554 = ((__global bool *) ext_mem_52623)[gtid_49550];\n        eta_p_49555 = ((__global bool *) ext_mem_52629)[gtid_49550];\n        cond_49556 = eta_p_49552 || eta_p_49553;\n        cond_49557 = eta_p_49554 || cond_49556;\n        lifted_lambda_res_49558 = eta_p_49555 || cond_49557;\n        ((__global bool *) mem_52636)[gtid_49550] = lifted_lambda_res_49558;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49547\n}\nFUTHARK_KERNEL_SIZED(skyline_mergeFilter_5_floatzisegmap_49581_dim1, 1, 1)\nvoid skyline_mergeFilter_5_floatzisegmap_49581(__global int *global_failure, int64_t dz2081U_39387, __global unsigned char *ext_mem_52623, __global unsigned char *ext_mem_52632, __global unsigned char *ext_mem_52641, __global unsigned char *ext_mem_52650, __global unsigned char *ext_mem_52659, __global unsigned char *mem_52666)\n{\n    #define segmap_tblock_sizze_49577 (skyline_mergeFilter_5_floatzisegmap_49581zisegmap_tblock_sizze_49577)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49581;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49580;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0", ");\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49581 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49577 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_39387;\n    gtid_49580 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49580;\n    if (slt64(gtid_49580, dz2081U_39387)) {\n        bool eta_p_49582;\n        bool eta_p_49583;\n        bool eta_p_49584;\n        bool eta_p_49585;\n        bool eta_p_49586;\n        bool cond_49587;\n        bool cond_49588;\n        bool cond_49589;\n        bool lifted_lambda_res_49590;\n        \n        eta_p_49582 = ((__global bool *) ext_mem_52623)[gtid_49580];\n        eta_p_49583 = ((__global bool *) ext_mem_52632)[gtid_49580];\n        eta_p_49584 = ((__global bool *) ext_mem_52641)[gtid_49580];\n        eta_p_49585 = ((__global bool *) ext_mem_52650)[gtid_49580];\n        eta_p_49586 = ((__global bool *) ext_mem_52659)[gtid_49580];\n        cond_49587 = eta_p_49582 || eta_p_49583;\n        cond_49588 = eta_p_49584 || cond_49587;\n        cond_49589 = eta_p_49585 || cond_49588;\n        lifted_lambda_res_49590 = eta_p_49586 || cond_49589;\n        ((__global bool *) mem_52666)[gtid_49580] = lifted_lambda_res_49590;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49577\n}\nFUTHARK_KERNEL_SIZED(skyline_merge_2_floatzisegmap_49423_dim1, 1, 1)\nvoid skyline_merge_2_floatzisegmap_49423(__global int *global_failure, int64_t dz2081U_34827, __global unsigned char *isPartitionDominated_mem_52561, __global unsigned char *isPartitionDominated_mem_52564, __global unsigned char *mem_52573)\n{\n    #define segmap_tblock_sizze_49419 (skyline_merge_2_floatzisegmap_49423zisegmap_tblock_sizze_49419)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_4", "9423;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49422;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49423 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49419 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_34827;\n    gtid_49422 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49422;\n    if (slt64(gtid_49422, dz2081U_34827)) {\n        bool eta_p_49424;\n        bool eta_p_49425;\n        bool lifted_lambda_res_49426;\n        \n        eta_p_49424 = ((__global bool *) isPartitionDominated_mem_52561)[gtid_49422];\n        eta_p_49425 = ((__global bool *) isPartitionDominated_mem_52564)[gtid_49422];\n        lifted_lambda_res_49426 = eta_p_49424 || eta_p_49425;\n        ((__global bool *) mem_52573)[gtid_49422] = lifted_lambda_res_49426;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49419\n}\nFUTHARK_KERNEL_SIZED(skyline_merge_3_floatzisegmap_49401_dim1, 1, 1)\nvoid skyline_merge_3_floatzisegmap_49401(__global int *global_failure, int64_t dz2081U_34726, __global unsigned char *isPartitionDominated_mem_52561, __global unsigned char *isPartitionDominated_mem_52564, __global unsigned char *isPartitionDominated_mem_52567, __global unsigned char *mem_52576)\n{\n    #define segmap_tblock_sizze_49397 (skyline_merge_3_floatzisegmap_49401zisegmap_tblock_sizze_49397)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49401;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49400;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = ",
                                    "get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49401 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49397 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_34726;\n    gtid_49400 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49400;\n    if (slt64(gtid_49400, dz2081U_34726)) {\n        bool eta_p_49402;\n        bool eta_p_49403;\n        bool eta_p_49404;\n        bool cond_49405;\n        bool lifted_lambda_res_49406;\n        \n        eta_p_49402 = ((__global bool *) isPartitionDominated_mem_52561)[gtid_49400];\n        eta_p_49403 = ((__global bool *) isPartitionDominated_mem_52564)[gtid_49400];\n        eta_p_49404 = ((__global bool *) isPartitionDominated_mem_52567)[gtid_49400];\n        cond_49405 = eta_p_49402 || eta_p_49403;\n        lifted_lambda_res_49406 = eta_p_49404 || cond_49405;\n        ((__global bool *) mem_52576)[gtid_49400] = lifted_lambda_res_49406;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49397\n}\nFUTHARK_KERNEL_SIZED(skyline_merge_4_floatzisegmap_49447_dim1, 1, 1)\nvoid skyline_merge_4_floatzisegmap_49447(__global int *global_failure, int64_t dz2081U_34584, __global unsigned char *isPartitionDominated_mem_52561, __global unsigned char *isPartitionDominated_mem_52564, __global unsigned char *isPartitionDominated_mem_52567, __global unsigned char *isPartitionDominated_mem_52570, __global unsigned char *mem_52579)\n{\n    #define segmap_tblock_sizze_49443 (skyline_merge_4_floatzisegmap_49447zisegmap_tblock_sizze_49443)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49447;\n    int64_t global_tid_53229;\n ", "   int64_t slice_53230;\n    int64_t gtid_49446;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49447 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49443 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_34584;\n    gtid_49446 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49446;\n    if (slt64(gtid_49446, dz2081U_34584)) {\n        bool eta_p_49448;\n        bool eta_p_49449;\n        bool eta_p_49450;\n        bool eta_p_49451;\n        bool cond_49452;\n        bool cond_49453;\n        bool lifted_lambda_res_49454;\n        \n        eta_p_49448 = ((__global bool *) isPartitionDominated_mem_52561)[gtid_49446];\n        eta_p_49449 = ((__global bool *) isPartitionDominated_mem_52564)[gtid_49446];\n        eta_p_49450 = ((__global bool *) isPartitionDominated_mem_52567)[gtid_49446];\n        eta_p_49451 = ((__global bool *) isPartitionDominated_mem_52570)[gtid_49446];\n        cond_49452 = eta_p_49448 || eta_p_49449;\n        cond_49453 = eta_p_49450 || cond_49452;\n        lifted_lambda_res_49454 = eta_p_49451 || cond_49453;\n        ((__global bool *) mem_52579)[gtid_49446] = lifted_lambda_res_49454;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_49443\n}\nFUTHARK_KERNEL_SIZED(skyline_merge_5_floatzisegmap_49521_dim1, 1, 1)\nvoid skyline_merge_5_floatzisegmap_49521(__global int *global_failure, int64_t dz2081U_34397, __global unsigned char *isPartitionDominated_mem_52561, __global unsigned char *isPartitionDominated_mem_52564, __global unsigned char *isPartitionDominated_mem_52567, __global unsigned char *isPartitionDominated_mem_52570, __global unsigned char *isPartitionDominated_mem_52573, __global unsigned char *mem_52582)\n{\n    #define segmap_", "tblock_sizze_49517 (skyline_merge_5_floatzisegmap_49521zisegmap_tblock_sizze_49517)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53225;\n    int32_t tblock_sizze_53228;\n    int32_t wave_sizze_53227;\n    int32_t block_id_53226;\n    int32_t global_tid_53224;\n    int64_t phys_tid_49521;\n    int64_t global_tid_53229;\n    int64_t slice_53230;\n    int64_t gtid_49520;\n    int64_t remnant_53231;\n    \n    local_tid_53225 = get_local_id(0);\n    tblock_sizze_53228 = get_local_size(0);\n    wave_sizze_53227 = LOCKSTEP_WIDTH;\n    block_id_53226 = get_tblock_id(0);\n    global_tid_53224 = block_id_53226 * tblock_sizze_53228 + local_tid_53225;\n    phys_tid_49521 = sext_i32_i64(global_tid_53224);\n    global_tid_53229 = sext_i32_i64(block_id_53226) * segmap_tblock_sizze_49517 + sext_i32_i64(local_tid_53225);\n    slice_53230 = dz2081U_34397;\n    gtid_49520 = global_tid_53229;\n    remnant_53231 = global_tid_53229 - gtid_49520;\n    if (slt64(gtid_49520, dz2081U_34397)) {\n        bool eta_p_49522;\n        bool eta_p_49523;\n        bool eta_p_49524;\n        bool eta_p_49525;\n        bool eta_p_49526;\n        bool cond_49527;\n        bool cond_49528;\n        bool cond_49529;\n        bool lifted_lambda_res_49530;\n        \n        eta_p_49522 = ((__global bool *) isPartitionDominated_mem_52561)[gtid_49520];\n        eta_p_49523 = ((__global bool *) isPartitionDominated_mem_52564)[gtid_49520];\n        eta_p_49524 = ((__global bool *) isPartitionDominated_mem_52567)[gtid_49520];\n        eta_p_49525 = ((__global bool *) isPartitionDominated_mem_52570)[gtid_49520];\n        eta_p_49526 = ((__global bool *) isPartitionDominated_mem_52573)[gtid_49520];\n        cond_49527 = eta_p_49522 || eta_p_49523;\n        cond_49528 = eta_p_49524 || cond_49527;\n        cond_49529 = eta_p_49525 || cond_49528;\n        lifted_lambda_res_49530 = eta_p_49526 || cond_49529;\n        ((__global bool *) mem_52582)[gtid_49520] = lifted_lambda_res_49530;\n    }\n    \n  error_0:\n    return;\n    #undef",
                                    " segmap_tblock_sizze_49517\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatziseghist_global_51790_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatziseghist_global_51790(__global int *global_failure, int64_t total_grid_no_29491, int64_t m_47581, int64_t num_tblocks_51785, int64_t num_subhistos_53588, int32_t chk_i_53658, int64_t hist_H_chk_53659, __global unsigned char *mem_52677, __global unsigned char *defunc_0_map_res_subhistos_mem_53589)\n{\n    #define seghist_tblock_sizze_51783 (skyline_slice_and_dice_floatziseghist_global_51790ziseghist_tblock_sizze_51783)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53661;\n    int32_t tblock_sizze_53664;\n    int32_t wave_sizze_53663;\n    int32_t block_id_53662;\n    int32_t global_tid_53660;\n    int64_t phys_tid_51790;\n    int32_t subhisto_ind_53665;\n    int64_t num_chunks_53666;\n    \n    local_tid_53661 = get_local_id(0);\n    tblock_sizze_53664 = get_local_size(0);\n    wave_sizze_53663 = LOCKSTEP_WIDTH;\n    block_id_53662 = get_tblock_id(0);\n    global_tid_53660 = block_id_53662 * tblock_sizze_53664 + local_tid_53661;\n    phys_tid_51790 = sext_i32_i64(global_tid_53660);\n    subhisto_ind_53665 = squot32(global_tid_53660, sdiv_up32(sext_i64_i32(seghist_tblock_sizze_51783 * num_tblocks_51785), sext_i64_i32(num_subhistos_53588)));\n    num_chunks_53666 = sdiv_up64(m_47581, sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_51783 * num_tblocks_51785)));\n    for (int64_t chunk_i_53667 = 0; chunk_i_53667 < num_chunks_53666; chunk_i_53667++) {\n        int64_t i_53668 = chunk_i_53667 * sext_i32_i64(sext_i64_i32(seghist_tblock_sizze_51783 * num_tblocks_51785)) + sext_i32_i64(global_tid_53660);\n        \n        if (slt64(i_53668, m_47581)) {\n            int64_t slice_53669;\n            int64_t gtid_51789;\n            int64_t remnant_53670;\n            \n            slice_53669 = m_47581;\n            gtid_51789 = i_53668;\n            remnant_53670 = i_53668 - gtid_51789;\n            if (slt64(i_53668, m_47581)) {\n    ", "            int64_t bucket_p_51794 = ((__global int64_t *) mem_52677)[gtid_51789];\n                \n                // save map-out results\n                { }\n                // perform atomic updates\n                {\n                    if (sle64(sext_i32_i64(chk_i_53658) * hist_H_chk_53659, bucket_p_51794) && (slt64(bucket_p_51794, sext_i32_i64(chk_i_53658) * hist_H_chk_53659 + hist_H_chk_53659) && (sle64((int64_t) 0, bucket_p_51794) && slt64(bucket_p_51794, total_grid_no_29491)))) {\n                        int32_t eta_p_51791;\n                        int32_t eta_p_51792 = 1;\n                        int32_t old_53671;\n                        \n                        old_53671 = atomic_add_i32_global(&((volatile __global int *) defunc_0_map_res_subhistos_mem_53589)[sext_i32_i64(subhisto_ind_53665) * total_grid_no_29491 + bucket_p_51794], (int) eta_p_51792);\n                    }\n                }\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef seghist_tblock_sizze_51783\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatziseghist_local_51790_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatziseghist_local_51790(__global int *global_failure, int64_t total_grid_no_29491, int64_t m_47581, int64_t num_subhistos_53588, int64_t num_tblocks_53599, int32_t hist_M_53605, int32_t chk_i_53609, int64_t num_segments_53610, int64_t hist_H_chk_53611, int64_t histo_sizze_53612, int32_t init_per_thread_53613, __global unsigned char *mem_52677, __global unsigned char *defunc_0_map_res_subhistos_mem_53589)\n{\n    #define max_tblock_sizze_53598 (skyline_slice_and_dice_floatziseghist_local_51790zimax_tblock_sizze_53598)\n    \n    volatile __local unsigned char *subhistogram_local_mem_53627_backing_0 = &shared_mem[0];\n    const int64_t subhistogram_local_mem_53627_backing_0_offset = 0 + ((int64_t) 4 * (hist_M_53605 * hist_H_chk_53611) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53605 * hist_H_chk_53611), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure ", ">= 0)\n        return;\n    \n    int32_t local_tid_53615;\n    int32_t tblock_sizze_53618;\n    int32_t wave_sizze_53617;\n    int32_t block_id_53616;\n    int32_t global_tid_53614;\n    int64_t phys_tid_51790;\n    int32_t phys_tblock_id_53619;\n    int32_t iterations_53620;\n    \n    local_tid_53615 = get_local_id(0);\n    tblock_sizze_53618 = get_local_size(0);\n    wave_sizze_53617 = LOCKSTEP_WIDTH;\n    block_id_53616 = get_tblock_id(0);\n    global_tid_53614 = block_id_53616 * tblock_sizze_53618 + local_tid_53615;\n    phys_tid_51790 = sext_i32_i64(global_tid_53614);\n    phys_tblock_id_53619 = get_tblock_id(0);\n    iterations_53620 = sdiv_up32(sext_i64_i32(num_tblocks_53599 * num_segments_53610) - phys_tblock_id_53619, sext_i64_i32(num_tblocks_53599));\n    for (int32_t i_53621 = 0; i_53621 < iterations_53620; i_53621++) {\n        int32_t virt_tblock_id_53622;\n        int32_t flat_segment_id_53623;\n        int32_t gid_in_segment_53624;\n        int32_t pgtid_in_segment_53625;\n        int32_t threads_per_segment_53626;\n        __local unsigned char *subhistogram_local_mem_53627;\n        int32_t thread_local_subhisto_i_53629;\n        int64_t num_chunks_53636;\n        \n        virt_tblock_id_53622 = phys_tblock_id_53619 + i_53621 * sext_i64_i32(num_tblocks_53599);\n        flat_segment_id_53623 = squot32(virt_tblock_id_53622, sext_i64_i32(num_tblocks_53599));\n        gid_in_segment_53624 = srem32(virt_tblock_id_53622, sext_i64_i32(num_tblocks_53599));\n        pgtid_in_segment_53625 = gid_in_segment_53624 * sext_i64_i32(max_tblock_sizze_53598) + local_tid_53615;\n        threads_per_segment_53626 = sext_i64_i32(num_tblocks_53599 * max_tblock_sizze_53598);\n        subhistogram_local_mem_53627 = (__local unsigned char *) subhistogram_local_mem_53627_backing_0;\n        thread_local_subhisto_i_53629 = srem32(local_tid_53615, hist_M_53605);\n        // initialize histograms in shared memory\n        {\n            for (int32_t local_i_53630 = 0; local_i_53630 < init_per_thread_53613; local_",
                                    "i_53630++) {\n                int32_t j_53631 = local_i_53630 * sext_i64_i32(max_tblock_sizze_53598) + local_tid_53615;\n                int32_t j_offset_53632 = hist_M_53605 * sext_i64_i32(histo_sizze_53612) * gid_in_segment_53624 + j_53631;\n                int32_t local_subhisto_i_53633 = squot32(j_53631, sext_i64_i32(histo_sizze_53612));\n                int32_t global_subhisto_i_53634 = squot32(j_offset_53632, sext_i64_i32(histo_sizze_53612));\n                \n                if (slt32(j_53631, hist_M_53605 * sext_i64_i32(histo_sizze_53612))) {\n                    // First subhistogram is initialised from global memory; others with neutral element.\n                    {\n                        if (global_subhisto_i_53634 == 0 && ((sle64((int64_t) 0, (int64_t) 0) && slt64((int64_t) 0, num_subhistos_53588)) && (sle64((int64_t) 0, sext_i32_i64(srem32(j_53631, sext_i64_i32(histo_sizze_53612))) + sext_i32_i64(chk_i_53609) * hist_H_chk_53611) && slt64(sext_i32_i64(srem32(j_53631, sext_i64_i32(histo_sizze_53612))) + sext_i32_i64(chk_i_53609) * hist_H_chk_53611, total_grid_no_29491)))) {\n                            int32_t tmp_53635 = ((__global int32_t *) defunc_0_map_res_subhistos_mem_53589)[sext_i32_i64(srem32(j_53631, sext_i64_i32(histo_sizze_53612))) + sext_i32_i64(chk_i_53609) * hist_H_chk_53611];\n                            \n                            ((__local int32_t *) subhistogram_local_mem_53627)[sext_i32_i64(local_subhisto_i_53633) * hist_H_chk_53611 + sext_i32_i64(srem32(j_53631, sext_i64_i32(histo_sizze_53612)))] = tmp_53635;\n                        } else {\n                            ((__local int32_t *) subhistogram_local_mem_53627)[sext_i32_i64(local_subhisto_i_53633) * hist_H_chk_53611 + sext_i32_i64(srem32(j_53631, sext_i64_i32(histo_sizze_53612)))] = 0;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        num_chunks_53636 = sdiv_up64(m_47581, sext_i32_i64(threads_per_s", "egment_53626));\n        for (int64_t chunk_i_53637 = 0; chunk_i_53637 < num_chunks_53636; chunk_i_53637++) {\n            int64_t i_53638 = chunk_i_53637 * sext_i32_i64(threads_per_segment_53626) + sext_i32_i64(pgtid_in_segment_53625);\n            \n            if (slt64(i_53638, m_47581)) {\n                int64_t gtid_51789;\n                int64_t bucket_p_51794;\n                \n                gtid_51789 = i_53638;\n                bucket_p_51794 = ((__global int64_t *) mem_52677)[gtid_51789];\n                if (chk_i_53609 == 0) {\n                    // save map-out results\n                    { }\n                }\n                // perform atomic updates\n                {\n                    if ((sle64((int64_t) 0, bucket_p_51794) && slt64(bucket_p_51794, total_grid_no_29491)) && (sle64(sext_i32_i64(chk_i_53609) * hist_H_chk_53611, bucket_p_51794) && slt64(bucket_p_51794, sext_i32_i64(chk_i_53609) * hist_H_chk_53611 + hist_H_chk_53611))) {\n                        int32_t eta_p_51791;\n                        int32_t eta_p_51792 = 1;\n                        int32_t old_53639;\n                        \n                        old_53639 = atomic_add_i32_shared(&((volatile __local int *) subhistogram_local_mem_53627)[sext_i32_i64(thread_local_subhisto_i_53629) * hist_H_chk_53611 + (bucket_p_51794 - sext_i32_i64(chk_i_53609) * hist_H_chk_53611)], (int) eta_p_51792);\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        // Compact the multiple shared memory subhistograms to result in global memory\n        {\n            int64_t trunc_H_53640 = smin64(hist_H_chk_53611, total_grid_no_29491 - sext_i32_i64(chk_i_53609) * hist_H_chk_53611);\n            int32_t histo_sizze_53641 = sext_i64_i32(trunc_H_53640);\n            \n            for (int32_t local_i_53642 = 0; local_i_53642 < init_per_thread_53613; local_i_53642++) {\n                int32_t j_53643 = local_i_53642 * sext_i64_i32(max_tblock_si", "zze_53598) + local_tid_53615;\n                \n                if (slt32(j_53643, histo_sizze_53641)) {\n                    int32_t eta_p_51791;\n                    int32_t eta_p_51792;\n                    \n                    // Read values from subhistogram 0.\n                    {\n                        eta_p_51791 = ((__local int32_t *) subhistogram_local_mem_53627)[sext_i32_i64(j_53643)];\n                    }\n                    // Accumulate based on values in other subhistograms.\n                    {\n                        for (int32_t subhisto_id_53644 = 0; subhisto_id_53644 < hist_M_53605 - 1; subhisto_id_53644++) {\n                            eta_p_51792 = ((__local int32_t *) subhistogram_local_mem_53627)[(sext_i32_i64(subhisto_id_53644) + (int64_t) 1) * hist_H_chk_53611 + sext_i32_i64(j_53643)];\n                            \n                            int32_t defunc_0_op_res_51793 = add32(eta_p_51791, eta_p_51792);\n                            \n                            eta_p_51791 = defunc_0_op_res_51793;\n                        }\n                    }\n                    // Put final bucket value in global memory.\n                    {\n                        ((__global int32_t *) defunc_0_map_res_subhistos_mem_53589)[srem64(sext_i32_i64(virt_tblock_id_53622), num_tblocks_53599) * total_grid_no_29491 + (sext_i32_i64(j_53643) + sext_i32_i64(chk_i_53609) * hist_H_chk_53611)] = eta_p_51791;\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_2:\n    return;\n    #undef max_tblock_sizze_53598\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51533_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51533(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_29479, int64_t n_29482, int64_t num_fpts_47475, int64_t num_tblocks_51529, int64_t lmad_ext_52581, int32_t virt_num_tblocks_53296, __global unsi",
                                    "gned char *xs_mem_52567, __global unsigned char *mem_52593)\n{\n    #define segmap_tblock_sizze_51528 (skyline_slice_and_dice_floatzisegmap_51533zisegmap_tblock_sizze_51528)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53298;\n    int32_t tblock_sizze_53301;\n    int32_t wave_sizze_53300;\n    int32_t block_id_53299;\n    int32_t global_tid_53297;\n    int64_t phys_tid_51533;\n    int32_t phys_tblock_id_53302;\n    int32_t iterations_53303;\n    \n    local_tid_53298 = get_local_id(0);\n    tblock_sizze_53301 = get_local_size(0);\n    wave_sizze_53300 = LOCKSTEP_WIDTH;\n    block_id_53299 = get_tblock_id(0);\n    global_tid_53297 = block_id_53299 * tblock_sizze_53301 + local_tid_53298;\n    phys_tid_51533 = sext_i32_i64(global_tid_53297);\n    phys_tblock_id_53302 = get_tblock_id(0);\n    iterations_53303 = sdiv_up32(virt_num_tblocks_53296 - phys_tblock_id_53302, sext_i64_i32(num_tblocks_51529));\n    for (int32_t i_53304 = 0; i_53304 < iterations_53303; i_53304++) {\n        int32_t virt_tblock_id_53305;\n        int64_t global_tid_53306;\n        int64_t slice_53307;\n        int64_t gtid_51532;\n        int64_t remnant_53308;\n        \n        virt_tblock_id_53305 = phys_tblock_id_53302 + i_53304 * sext_i64_i32(num_tblocks_51529);\n        global_tid_53306 = sext_i32_i64(virt_tblock_id_53305) * segmap_tblock_sizze_51528 + sext_i32_i64(local_tid_53298);\n        slice_53307 = num_fpts_47475;\n        gtid_51532 = global_tid_53306;\n        remnant_53308 = global_tid_53306 - gtid_51532;\n        if (slt64(gtid_51532, num_fpts_47475)) {\n            bool cond_51535;\n            int64_t tmp_51537;\n            bool x_51538;\n            bool y_51539;\n            bool bounds_check_51540;\n            bool protect_assert_disj_52900;\n            bool index_certs_51541;\n            bool x_", "52897;\n            int64_t defunc_0_reduce_comm_res_51544;\n            int64_t lmad_ext_52580;\n            int64_t ext_52582;\n            \n            cond_51535 = gtid_51532 == (int64_t) 0;\n            tmp_51537 = sub64(gtid_51532, (int64_t) 1);\n            x_51538 = sle64((int64_t) 0, tmp_51537);\n            y_51539 = slt64(tmp_51537, dim_29479);\n            bounds_check_51540 = x_51538 && y_51539;\n            protect_assert_disj_52900 = cond_51535 || bounds_check_51540;\n            if (!protect_assert_disj_52900) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                        global_failure_args[0] = (int64_t) tmp_51537;\n                        global_failure_args[1] = (int64_t) dim_29479;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_52897 = !cond_51535;\n            if (x_52897) {\n                int64_t x_52901;\n                float x_52902;\n                int64_t redout_52484;\n                float redout_52485;\n                \n                redout_52484 = n_29482;\n                redout_52485 = INFINITY;\n                for (int64_t i_52486 = 0; i_52486 < n_29482; i_52486++) {\n                    float x_51547;\n                    bool zl_res_51552;\n                    bool zeze_res_51553;\n                    bool cond_f_res_t_res_51554;\n                    bool x_51555;\n                    bool x_51556;\n                    bool y_51557;\n                    bool cond_51558;\n                    int64_t defunc_0_op_res_51559;\n                    float defunc_0_op_res_51560;\n                    int64_t redout_tmp_53309;\n                    float redout_tmp_53310;\n                    \n                    x_51547 = ((__global float *) xs_mem_52567)[i_52486 * dim_29479 + tmp_51537];\n                    zl_res_51552 = redout_52485 < x_51547;\n                    zeze_res_51553 = red", "out_52485 == x_51547;\n                    cond_f_res_t_res_51554 = slt64(redout_52484, i_52486);\n                    x_51555 = zeze_res_51553 && cond_f_res_t_res_51554;\n                    x_51556 = !zl_res_51552;\n                    y_51557 = x_51555 && x_51556;\n                    cond_51558 = zl_res_51552 || y_51557;\n                    if (cond_51558) {\n                        defunc_0_op_res_51559 = redout_52484;\n                    } else {\n                        defunc_0_op_res_51559 = i_52486;\n                    }\n                    if (cond_51558) {\n                        defunc_0_op_res_51560 = redout_52485;\n                    } else {\n                        defunc_0_op_res_51560 = x_51547;\n                    }\n                    redout_tmp_53309 = defunc_0_op_res_51559;\n                    redout_tmp_53310 = defunc_0_op_res_51560;\n                    redout_52484 = redout_tmp_53309;\n                    redout_52485 = redout_tmp_53310;\n                }\n                x_52901 = redout_52484;\n                x_52902 = redout_52485;\n                defunc_0_reduce_comm_res_51544 = x_52901;\n            } else {\n                defunc_0_reduce_comm_res_51544 = (int64_t) 0;\n            }\n            lmad_ext_52580 = dim_29479 * defunc_0_reduce_comm_res_51544;\n            if (cond_51535) {\n                ext_52582 = lmad_ext_52581;\n            } else {\n                ext_52582 = lmad_ext_52580;\n            }\n            if (!cond_51535) {\n                bool x_51561;\n                bool y_51562;\n                bool bounds_check_51563;\n                bool index_certs_51564;\n                \n                x_51561 = sle64((int64_t) 0, defunc_0_reduce_comm_res_51544);\n                y_51562 = slt64(defunc_0_reduce_comm_res_51544, n_29482);\n                bounds_check_51563 = x_51561 && y_51562;\n                if (!bounds_check_51563) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n    ",
                                    "                        global_failure_args[0] = (int64_t) defunc_0_reduce_comm_res_51544;\n                            global_failure_args[1] = (int64_t) n_29482;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_0;\n                    }\n                }\n            }\n            for (int64_t i_0 = 0; i_0 < dim_29479; i_0++) {\n                ((__global float *) mem_52593)[gtid_51532 + i_0 * num_fpts_47475] = ((__global float *) xs_mem_52567)[ext_52582 + i_0];\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51528\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51575_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51575(__global int *global_failure, int64_t n_29482, int64_t m_47581, int64_t num_tblocks_51580, int32_t virt_num_tblocks_53467, __global unsigned char *mem_52642, __global unsigned char *mem_52644, __global unsigned char *mem_52646)\n{\n    #define segmap_tblock_sizze_51578 (skyline_slice_and_dice_floatzisegmap_51575zisegmap_tblock_sizze_51578)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53469;\n    int32_t tblock_sizze_53472;\n    int32_t wave_sizze_53471;\n    int32_t block_id_53470;\n    int32_t global_tid_53468;\n    int64_t phys_tid_51575;\n    int32_t phys_tblock_id_53473;\n    int32_t iterations_53474;\n    \n    local_tid_53469 = get_local_id(0);\n    tblock_sizze_53472 = get_local_size(0);\n    wave_sizze_53471 = LOCKSTEP_WIDTH;\n    block_id_53470 = get_tblock_id(0);\n    global_tid_53468 = block_id_53470 * tblock_sizze_53472 + local_tid_53469;\n    phys_tid_51575 = sext_i32_i64(global_tid_53468);\n    phys_tblock_id_53473 = get_tblock_id(0);\n    iterations_53474 = sdiv_up32(virt_num_tblocks_53467 - phys", "_tblock_id_53473, sext_i64_i32(num_tblocks_51580));\n    for (int32_t i_53475 = 0; i_53475 < iterations_53474; i_53475++) {\n        int32_t virt_tblock_id_53476;\n        int64_t global_tid_53477;\n        int64_t slice_53478;\n        int64_t write_i_51574;\n        int64_t remnant_53479;\n        \n        virt_tblock_id_53476 = phys_tblock_id_53473 + i_53475 * sext_i64_i32(num_tblocks_51580);\n        global_tid_53477 = sext_i32_i64(virt_tblock_id_53476) * segmap_tblock_sizze_51578 + sext_i32_i64(local_tid_53469);\n        slice_53478 = n_29482;\n        write_i_51574 = global_tid_53477;\n        remnant_53479 = global_tid_53477 - write_i_51574;\n        if (slt64(write_i_51574, n_29482)) {\n            int64_t eta_p_47803;\n            bool cond_47806;\n            int64_t lifted_lambda_res_47807;\n            \n            eta_p_47803 = ((__global int64_t *) mem_52644)[write_i_51574];\n            cond_47806 = eta_p_47803 == (int64_t) 1;\n            if (cond_47806) {\n                int64_t eta_p_47804;\n                int64_t lifted_lambda_res_t_res_49325;\n                \n                eta_p_47804 = ((__global int64_t *) mem_52642)[write_i_51574];\n                lifted_lambda_res_t_res_49325 = sub64(eta_p_47804, (int64_t) 1);\n                lifted_lambda_res_47807 = lifted_lambda_res_t_res_49325;\n            } else {\n                lifted_lambda_res_47807 = (int64_t) -1;\n            }\n            if (sle64((int64_t) 0, lifted_lambda_res_47807) && slt64(lifted_lambda_res_47807, m_47581)) {\n                ((__global int64_t *) mem_52646)[lifted_lambda_res_47807] = write_i_51574;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_51578\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51627_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51627(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_29482, int64_t", " m_47581, __global unsigned char *mem_52646, __global unsigned char *mem_52649)\n{\n    #define segmap_tblock_sizze_51623 (skyline_slice_and_dice_floatzisegmap_51627zisegmap_tblock_sizze_51623)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53482;\n    int32_t tblock_sizze_53485;\n    int32_t wave_sizze_53484;\n    int32_t block_id_53483;\n    int32_t global_tid_53481;\n    int64_t phys_tid_51627;\n    int64_t global_tid_53486;\n    int64_t slice_53487;\n    int64_t gtid_51626;\n    int64_t remnant_53488;\n    \n    local_tid_53482 = get_local_id(0);\n    tblock_sizze_53485 = get_local_size(0);\n    wave_sizze_53484 = LOCKSTEP_WIDTH;\n    block_id_53483 = get_tblock_id(0);\n    global_tid_53481 = block_id_53483 * tblock_sizze_53485 + local_tid_53482;\n    phys_tid_51627 = sext_i32_i64(global_tid_53481);\n    global_tid_53486 = sext_i32_i64(block_id_53483) * segmap_tblock_sizze_51623 + sext_i32_i64(local_tid_53482);\n    slice_53487 = m_47581;\n    gtid_51626 = global_tid_53486;\n    remnant_53488 = global_tid_53486 - gtid_51626;\n    if (slt64(gtid_51626, m_47581)) {\n        int64_t eta_p_51628;\n        bool x_51629;\n        bool y_51630;\n        bool bounds_check_51631;\n        bool index_certs_51632;\n        \n        eta_p_51628 = ((__global int64_t *) mem_52646)[gtid_51626];\n        x_51629 = sle64((int64_t) 0, eta_p_51628);\n        y_51630 = slt64(eta_p_51628, n_29482);\n        bounds_check_51631 = x_51629 && y_51630;\n        if (!bounds_check_51631) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_51628;\n                    global_failure_args[1] = (int64_t) n_29482;\n                    ;\n                }\n                return;\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51623\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51640_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51640(__globa",
                                    "l int *global_failure, int64_t dim_29479, int64_t m_47581, __global unsigned char *xs_mem_52567, __global unsigned char *mem_52646, __global unsigned char *mem_52649, __global unsigned char *mem_52653)\n{\n    #define segmap_tblock_sizze_51635 (skyline_slice_and_dice_floatzisegmap_51640zisegmap_tblock_sizze_51635)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53491;\n    int32_t tblock_sizze_53494;\n    int32_t wave_sizze_53493;\n    int32_t block_id_53492;\n    int32_t global_tid_53490;\n    int64_t phys_tid_51640;\n    int64_t global_tid_53495;\n    int64_t slice_53496;\n    int64_t slice_53497;\n    int64_t gtid_51639;\n    int64_t remnant_53498;\n    int64_t gtid_slice_51638;\n    int64_t remnant_53499;\n    \n    local_tid_53491 = get_local_id(0);\n    tblock_sizze_53494 = get_local_size(0);\n    wave_sizze_53493 = LOCKSTEP_WIDTH;\n    block_id_53492 = get_tblock_id(0);\n    global_tid_53490 = block_id_53492 * tblock_sizze_53494 + local_tid_53491;\n    phys_tid_51640 = sext_i32_i64(global_tid_53490);\n    global_tid_53495 = sext_i32_i64(block_id_53492) * segmap_tblock_sizze_51635 + sext_i32_i64(local_tid_53491);\n    slice_53496 = dim_29479;\n    slice_53497 = m_47581 * slice_53496;\n    gtid_51639 = squot64(global_tid_53495, slice_53496);\n    remnant_53498 = global_tid_53495 - gtid_51639 * slice_53496;\n    gtid_slice_51638 = remnant_53498;\n    remnant_53499 = remnant_53498 - gtid_slice_51638;\n    if (slt64(gtid_51639, m_47581) && slt64(gtid_slice_51638, dim_29479)) {\n        int64_t eta_p_51641;\n        bool index_certs_51642;\n        float v_51643;\n        \n        eta_p_51641 = ((__global int64_t *) mem_52646)[gtid_51639];\n        index_certs_51642 = 0;\n        v_51643 = ((__global float *) xs_mem_52567)[eta_p_51641 * dim_29479 + gtid_slice_51638];\n        ((__global float *) mem_52653)[gtid_51639 * dim_29479 + gtid_slice_51638] = v_51643;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51635\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_f", "loatzisegmap_51649_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51649(__global int *global_failure, int64_t offs_29494, int64_t m_47581, __global unsigned char *mem_52646, __global unsigned char *mem_52649, __global unsigned char *mem_52656)\n{\n    #define segmap_tblock_sizze_51645 (skyline_slice_and_dice_floatzisegmap_51649zisegmap_tblock_sizze_51645)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53502;\n    int32_t tblock_sizze_53505;\n    int32_t wave_sizze_53504;\n    int32_t block_id_53503;\n    int32_t global_tid_53501;\n    int64_t phys_tid_51649;\n    int64_t global_tid_53506;\n    int64_t slice_53507;\n    int64_t gtid_51648;\n    int64_t remnant_53508;\n    \n    local_tid_53502 = get_local_id(0);\n    tblock_sizze_53505 = get_local_size(0);\n    wave_sizze_53504 = LOCKSTEP_WIDTH;\n    block_id_53503 = get_tblock_id(0);\n    global_tid_53501 = block_id_53503 * tblock_sizze_53505 + local_tid_53502;\n    phys_tid_51649 = sext_i32_i64(global_tid_53501);\n    global_tid_53506 = sext_i32_i64(block_id_53503) * segmap_tblock_sizze_51645 + sext_i32_i64(local_tid_53502);\n    slice_53507 = m_47581;\n    gtid_51648 = global_tid_53506;\n    remnant_53508 = global_tid_53506 - gtid_51648;\n    if (slt64(gtid_51648, m_47581)) {\n        int64_t eta_p_51650;\n        bool index_certs_51651;\n        int64_t index_primexp_51652;\n        \n        eta_p_51650 = ((__global int64_t *) mem_52646)[gtid_51648];\n        index_certs_51651 = 0;\n        index_primexp_51652 = add64(offs_29494, eta_p_51650);\n        ((__global int64_t *) mem_52656)[gtid_51648] = index_primexp_51652;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51645\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51750_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51750(__global int *global_failure, int64_t dim_29479, int64_t m_47581, __global unsigned char *grid_part_prefix_sum_mem_52563, __global unsigned char *grid_part_sizze_per_dim_mem_52564, __global unsigned ch", "ar *grid_partitions_per_dim_mem_52565, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52653, __global unsigned char *mem_52663)\n{\n    #define segmap_tblock_sizze_51745 (skyline_slice_and_dice_floatzisegmap_51750zisegmap_tblock_sizze_51745)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53569;\n    int32_t tblock_sizze_53572;\n    int32_t wave_sizze_53571;\n    int32_t block_id_53570;\n    int32_t global_tid_53568;\n    int64_t phys_tid_51750;\n    int64_t global_tid_53573;\n    int64_t slice_53574;\n    int64_t slice_53575;\n    int64_t gtid_51748;\n    int64_t remnant_53576;\n    int64_t gtid_51749;\n    int64_t remnant_53577;\n    \n    local_tid_53569 = get_local_id(0);\n    tblock_sizze_53572 = get_local_size(0);\n    wave_sizze_53571 = LOCKSTEP_WIDTH;\n    block_id_53570 = get_tblock_id(0);\n    global_tid_53568 = block_id_53570 * tblock_sizze_53572 + local_tid_53569;\n    phys_tid_51750 = sext_i32_i64(global_tid_53568);\n    global_tid_53573 = sext_i32_i64(block_id_53570) * segmap_tblock_sizze_51745 + sext_i32_i64(local_tid_53569);\n    slice_53574 = dim_29479;\n    slice_53575 = m_47581 * slice_53574;\n    gtid_51748 = squot64(global_tid_53573, slice_53574);\n    remnant_53576 = global_tid_53573 - gtid_51748 * slice_53574;\n    gtid_51749 = remnant_53576;\n    remnant_53577 = remnant_53576 - gtid_51749;\n    if (slt64(gtid_51748, m_47581) && slt64(gtid_51749, dim_29479)) {\n        float eta_p_51751;\n        float eta_p_51752;\n        float eta_p_51753;\n        int64_t eta_p_51755;\n        float zm_res_51756;\n        float zs_res_51757;\n        int64_t to_i64_res_51758;\n        int64_t max_res_51759;\n        int64_t zm_lhs_51764;\n        int64_t min_arg1_51765;\n        int64_t min_res_51766;\n        int64_t defunc_0_f_res_51767;\n        \n        eta_p_51751 = ((__global float *) mem_52653)[gtid_51748 * dim_29479 + gtid_51749];\n        eta_p_51752 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51749];\n      ",
                                    "  eta_p_51753 = ((__global float *) grid_part_sizze_per_dim_mem_52564)[gtid_51749];\n        eta_p_51755 = ((__global int64_t *) grid_part_prefix_sum_mem_52563)[gtid_51749];\n        zm_res_51756 = eta_p_51751 - eta_p_51752;\n        zs_res_51757 = zm_res_51756 / eta_p_51753;\n        to_i64_res_51758 = fptosi_f32_i64(zs_res_51757);\n        max_res_51759 = smax64((int64_t) 0, to_i64_res_51758);\n        zm_lhs_51764 = ((__global int64_t *) grid_partitions_per_dim_mem_52565)[gtid_51749];\n        min_arg1_51765 = sub64(zm_lhs_51764, (int64_t) 1);\n        min_res_51766 = smin64(max_res_51759, min_arg1_51765);\n        defunc_0_f_res_51767 = mul64(eta_p_51755, min_res_51766);\n        ((__global int64_t *) mem_52663)[gtid_51748 * dim_29479 + gtid_51749] = defunc_0_f_res_51767;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51745\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_51774_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_51774(__global int *global_failure, int64_t dim_29479, int64_t m_47581, __global unsigned char *mem_52674, __global unsigned char *mem_52677)\n{\n    #define segmap_tblock_sizze_51770 (skyline_slice_and_dice_floatzisegmap_51774zisegmap_tblock_sizze_51770)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53580;\n    int32_t tblock_sizze_53583;\n    int32_t wave_sizze_53582;\n    int32_t block_id_53581;\n    int32_t global_tid_53579;\n    int64_t phys_tid_51774;\n    int64_t global_tid_53584;\n    int64_t slice_53585;\n    int64_t gtid_51773;\n    int64_t remnant_53586;\n    \n    local_tid_53580 = get_local_id(0);\n    tblock_sizze_53583 = get_local_size(0);\n    wave_sizze_53582 = LOCKSTEP_WIDTH;\n    block_id_53581 = get_tblock_id(0);\n    global_tid_53579 = block_id_53581 * tblock_sizze_53583 + local_tid_53580;\n    phys_tid_51774 = sext_i32_i64(global_tid_53579);\n    global_tid_53584 = sext_i32_i64(block_id_53581) * segmap_tblock_sizze_51770 + sext_i32_i64(local_tid_53580);\n    slice_53585 = m_47581;\n    gti", "d_51773 = global_tid_53584;\n    remnant_53586 = global_tid_53584 - gtid_51773;\n    if (slt64(gtid_51773, m_47581)) {\n        int64_t defunc_0_foldl_res_51776;\n        int64_t acc_51778 = (int64_t) 0;\n        \n        for (int64_t i_51777 = 0; i_51777 < dim_29479; i_51777++) {\n            int64_t b_51779;\n            int64_t defunc_0_f_res_51780;\n            int64_t acc_tmp_53587;\n            \n            b_51779 = ((__global int64_t *) mem_52674)[gtid_51773 + i_51777 * m_47581];\n            defunc_0_f_res_51780 = add64(acc_51778, b_51779);\n            acc_tmp_53587 = defunc_0_f_res_51780;\n            acc_51778 = acc_tmp_53587;\n        }\n        defunc_0_foldl_res_51776 = acc_51778;\n        ((__global int64_t *) mem_52677)[gtid_51773] = defunc_0_foldl_res_51776;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_51770\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_52034_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_52034(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dz2080U_29480, int64_t total_grid_no_29491, __global unsigned char *mem_52682)\n{\n    #define segmap_tblock_sizze_52030 (skyline_slice_and_dice_floatzisegmap_52034zisegmap_tblock_sizze_52030)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53792;\n    int32_t tblock_sizze_53795;\n    int32_t wave_sizze_53794;\n    int32_t block_id_53793;\n    int32_t global_tid_53791;\n    int64_t phys_tid_52034;\n    int64_t global_tid_53796;\n    int64_t slice_53797;\n    int64_t gtid_52033;\n    int64_t remnant_53798;\n    \n    local_tid_53792 = get_local_id(0);\n    tblock_sizze_53795 = get_local_size(0);\n    wave_sizze_53794 = LOCKSTEP_WIDTH;\n    block_id_53793 = get_tblock_id(0);\n    global_tid_53791 = block_id_53793 * tblock_sizze_53795 + local_tid_53792;\n    phys_tid_52034 = sext_i32_i64(global_tid_53791);\n    global_tid_53796 = sext_i32_i64(block_id_53793) * segmap_tblock_sizze_52030 + sext_i32_i64(local_tid_5", "3792);\n    slice_53797 = total_grid_no_29491;\n    gtid_52033 = global_tid_53796;\n    remnant_53798 = global_tid_53796 - gtid_52033;\n    if (slt64(gtid_52033, total_grid_no_29491)) {\n        bool y_52037;\n        bool index_certs_52039;\n        \n        y_52037 = slt64(gtid_52033, dz2080U_29480);\n        if (!y_52037) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                    global_failure_args[0] = (int64_t) gtid_52033;\n                    global_failure_args[1] = (int64_t) dz2080U_29480;\n                    ;\n                }\n                return;\n            }\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_52030\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_52047_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_52047(__global int *global_failure, int64_t dim_29479, int64_t total_grid_no_29491, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52682, __global unsigned char *mem_52686)\n{\n    #define segmap_tblock_sizze_52042 (skyline_slice_and_dice_floatzisegmap_52047zisegmap_tblock_sizze_52042)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53801;\n    int32_t tblock_sizze_53804;\n    int32_t wave_sizze_53803;\n    int32_t block_id_53802;\n    int32_t global_tid_53800;\n    int64_t phys_tid_52047;\n    int64_t global_tid_53805;\n    int64_t slice_53806;\n    int64_t slice_53807;\n    int64_t gtid_52046;\n    int64_t remnant_53808;\n    int64_t gtid_slice_52045;\n    int64_t remnant_53809;\n    \n    local_tid_53801 = get_local_id(0);\n    tblock_sizze_53804 = get_local_size(0);\n    wave_sizze_53803 = LOCKSTEP_WIDTH;\n    block_id_53802 = get_tblock_id(0);\n    global_tid_53800 = block_id_53802 * tblock_sizze_53804 + local_tid_53801;\n    phys_tid_52047 = sext_i32_i64(global_tid_53800);\n    global_tid_53805 = sext_i32_i64(block_id_53802) * segmap_tblock_sizze_52042 + sext_i32_i64(local_tid_53801);\n    slice_53806 = d",
                                    "im_29479;\n    slice_53807 = total_grid_no_29491 * slice_53806;\n    gtid_52046 = squot64(global_tid_53805, slice_53806);\n    remnant_53808 = global_tid_53805 - gtid_52046 * slice_53806;\n    gtid_slice_52045 = remnant_53808;\n    remnant_53809 = remnant_53808 - gtid_slice_52045;\n    if (slt64(gtid_52046, total_grid_no_29491) && slt64(gtid_slice_52045, dim_29479)) {\n        bool index_certs_52049;\n        float v_52050;\n        \n        index_certs_52049 = 0;\n        v_52050 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_52046 * dim_29479 + gtid_slice_52045];\n        ((__global float *) mem_52686)[gtid_52046 * dim_29479 + gtid_slice_52045] = v_52050;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_52042\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_52128_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_52128(__global int *global_failure, int64_t m_47581, __global unsigned char *mem_52769, __global unsigned char *mem_52771, __global unsigned char *mem_52779, __global unsigned char *mem_52781)\n{\n    #define segmap_tblock_sizze_52123 (skyline_slice_and_dice_floatzisegmap_52128zisegmap_tblock_sizze_52123)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53994;\n    int32_t tblock_sizze_53997;\n    int32_t wave_sizze_53996;\n    int32_t block_id_53995;\n    int32_t global_tid_53993;\n    int64_t phys_tid_52128;\n    int64_t global_tid_53998;\n    int64_t slice_53999;\n    int64_t gtid_52127;\n    int64_t remnant_54000;\n    \n    local_tid_53994 = get_local_id(0);\n    tblock_sizze_53997 = get_local_size(0);\n    wave_sizze_53996 = LOCKSTEP_WIDTH;\n    block_id_53995 = get_tblock_id(0);\n    global_tid_53993 = block_id_53995 * tblock_sizze_53997 + local_tid_53994;\n    phys_tid_52128 = sext_i32_i64(global_tid_53993);\n    global_tid_53998 = sext_i32_i64(block_id_53995) * segmap_tblock_sizze_52123 + sext_i32_i64(local_tid_53994);\n    slice_53999 = m_47581;\n    gtid_52127 = global_tid_53998;\n    remnant_54000 = global_t", "id_53998 - gtid_52127;\n    if (slt64(gtid_52127, m_47581)) {\n        int64_t eta_p_52129;\n        bool cond_52131;\n        int64_t lifted_lambda_res_52132;\n        \n        eta_p_52129 = ((__global int64_t *) mem_52771)[gtid_52127];\n        cond_52131 = eta_p_52129 == (int64_t) 1;\n        if (cond_52131) {\n            int64_t eta_p_52130;\n            int64_t lifted_lambda_res_t_res_52133;\n            \n            eta_p_52130 = ((__global int64_t *) mem_52769)[gtid_52127];\n            lifted_lambda_res_t_res_52133 = sub64(eta_p_52130, (int64_t) 1);\n            lifted_lambda_res_52132 = lifted_lambda_res_t_res_52133;\n        } else {\n            lifted_lambda_res_52132 = (int64_t) -1;\n        }\n        ((__global int64_t *) mem_52779)[gtid_52127] = lifted_lambda_res_52132;\n        ((__global int64_t *) mem_52781)[gtid_52127] = lifted_lambda_res_52132;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_52123\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_52140_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_52140(__global int *global_failure, int64_t dim_29479, int64_t m_47581, int64_t m_47707, int64_t num_tblocks_52146, int32_t virt_num_tblocks_54002, __global unsigned char *mem_52653, __global unsigned char *mem_52774, __global unsigned char *mem_52779)\n{\n    #define segmap_tblock_sizze_52144 (skyline_slice_and_dice_floatzisegmap_52140zisegmap_tblock_sizze_52144)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_54004;\n    int32_t tblock_sizze_54007;\n    int32_t wave_sizze_54006;\n    int32_t block_id_54005;\n    int32_t global_tid_54003;\n    int64_t phys_tid_52140;\n    int32_t phys_tblock_id_54008;\n    int32_t iterations_54009;\n    \n    local_tid_54004 = get_local_id(0);\n    tblock_sizze_54007 = get_local_size(0);\n    wave_sizze_54006 = LOCKSTEP_WIDTH;\n    block_id_54005 = get_tblock_id(0);\n    global_tid_54003 = block_id_54005 * tblock_sizze_54007 + local_tid_54004;\n    phys_tid_52140 = sext_i32_i64(global_tid_5", "4003);\n    phys_tblock_id_54008 = get_tblock_id(0);\n    iterations_54009 = sdiv_up32(virt_num_tblocks_54002 - phys_tblock_id_54008, sext_i64_i32(num_tblocks_52146));\n    for (int32_t i_54010 = 0; i_54010 < iterations_54009; i_54010++) {\n        int32_t virt_tblock_id_54011;\n        int64_t global_tid_54012;\n        int64_t slice_54013;\n        int64_t slice_54014;\n        int64_t write_i_52136;\n        int64_t remnant_54015;\n        int64_t val_i_52137;\n        int64_t remnant_54016;\n        \n        virt_tblock_id_54011 = phys_tblock_id_54008 + i_54010 * sext_i64_i32(num_tblocks_52146);\n        global_tid_54012 = sext_i32_i64(virt_tblock_id_54011) * segmap_tblock_sizze_52144 + sext_i32_i64(local_tid_54004);\n        slice_54013 = dim_29479;\n        slice_54014 = m_47581 * slice_54013;\n        write_i_52136 = squot64(global_tid_54012, slice_54013);\n        remnant_54015 = global_tid_54012 - write_i_52136 * slice_54013;\n        val_i_52137 = remnant_54015;\n        remnant_54016 = remnant_54015 - val_i_52137;\n        if (slt64(write_i_52136, m_47581) && slt64(val_i_52137, dim_29479)) {\n            float scatter_tmp_elem_52138;\n            int64_t scatter_tmp_i_52139;\n            \n            scatter_tmp_elem_52138 = ((__global float *) mem_52653)[write_i_52136 * dim_29479 + val_i_52137];\n            scatter_tmp_i_52139 = ((__global int64_t *) mem_52779)[write_i_52136];\n            if ((sle64((int64_t) 0, scatter_tmp_i_52139) && slt64(scatter_tmp_i_52139, m_47707)) && (sle64((int64_t) 0, val_i_52137) && slt64(val_i_52137, dim_29479))) {\n                ((__global float *) mem_52774)[scatter_tmp_i_52139 * dim_29479 + val_i_52137] = scatter_tmp_elem_52138;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_52144\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_52151_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_52151(__global int *global_failure, int64_t m",
                                    "_47581, int64_t m_47707, int64_t num_tblocks_52156, int32_t virt_num_tblocks_54018, __global unsigned char *mem_52656, __global unsigned char *mem_52776, __global unsigned char *mem_52781)\n{\n    #define segmap_tblock_sizze_52154 (skyline_slice_and_dice_floatzisegmap_52151zisegmap_tblock_sizze_52154)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_54020;\n    int32_t tblock_sizze_54023;\n    int32_t wave_sizze_54022;\n    int32_t block_id_54021;\n    int32_t global_tid_54019;\n    int64_t phys_tid_52151;\n    int32_t phys_tblock_id_54024;\n    int32_t iterations_54025;\n    \n    local_tid_54020 = get_local_id(0);\n    tblock_sizze_54023 = get_local_size(0);\n    wave_sizze_54022 = LOCKSTEP_WIDTH;\n    block_id_54021 = get_tblock_id(0);\n    global_tid_54019 = block_id_54021 * tblock_sizze_54023 + local_tid_54020;\n    phys_tid_52151 = sext_i32_i64(global_tid_54019);\n    phys_tblock_id_54024 = get_tblock_id(0);\n    iterations_54025 = sdiv_up32(virt_num_tblocks_54018 - phys_tblock_id_54024, sext_i64_i32(num_tblocks_52156));\n    for (int32_t i_54026 = 0; i_54026 < iterations_54025; i_54026++) {\n        int32_t virt_tblock_id_54027;\n        int64_t global_tid_54028;\n        int64_t slice_54029;\n        int64_t write_i_52148;\n        int64_t remnant_54030;\n        \n        virt_tblock_id_54027 = phys_tblock_id_54024 + i_54026 * sext_i64_i32(num_tblocks_52156);\n        global_tid_54028 = sext_i32_i64(virt_tblock_id_54027) * segmap_tblock_sizze_52154 + sext_i32_i64(local_tid_54020);\n        slice_54029 = m_47581;\n        write_i_52148 = global_tid_54028;\n        remnant_54030 = global_tid_54028 - write_i_52148;\n        if (slt64(write_i_52148, m_47581)) {\n            int64_t scatter_tmp_elem_52149;\n            int64_t scatter_tmp_i_52150;\n            \n            scatter_tmp_elem_52149 = ((__global int64_t *) mem_52656)[write_i_52148];\n            scatter_tmp_i_52150 = ((__global int64_t *) mem_52781)[write_i_52148];\n            if (sle64((int64_t) 0, scatter_tm", "p_i_52150) && slt64(scatter_tmp_i_52150, m_47707)) {\n                ((__global int64_t *) mem_52776)[scatter_tmp_i_52150] = scatter_tmp_elem_52149;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_52154\n}\nFUTHARK_KERNEL\nvoid skyline_slice_and_dice_floatzisegmap_intrablock_51907(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_29479, int64_t dz2080U_29480, int64_t total_grid_no_29491, unsigned char cond_47437_bits, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52679, __global unsigned char *mem_52726, __global unsigned char *color_52942)\n{\n    bool cond_47437 = cond_47437_bits;\n    volatile __local unsigned char *red_arr_mem_53783_backing_0 = &shared_mem[0];\n    const int64_t red_arr_mem_53783_backing_0_offset = 0 + (total_grid_no_29491 + srem64((int64_t) 8 - srem64(total_grid_no_29491, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53774;\n    int32_t tblock_sizze_53777;\n    int32_t wave_sizze_53776;\n    int32_t block_id_53775;\n    int32_t global_tid_53773;\n    int64_t phys_tblock_id_51907;\n    int64_t slice_53779;\n    int64_t ltid_pre_53778;\n    int64_t remnant_53780;\n    int64_t slice_53781;\n    int64_t gtid_51906;\n    int64_t remnant_53782;\n    bool y_51910;\n    bool index_certs_51912;\n    bool defunc_0_reduce_res_51914;\n    int64_t phys_tid_51916;\n    __local unsigned char *red_arr_mem_53783;\n    int64_t gtid_51915;\n    bool y_51922;\n    bool index_certs_51924;\n    int32_t zg_lhs_51928;\n    bool cond_51929;\n    bool lifted_lambda_res_51930;\n    int32_t offset_53788;\n    int32_t skip_waves_53789;\n    bool eta_p_51917;\n    bool eta", "_p_51918;\n    \n    local_tid_53774 = get_local_id(0);\n    tblock_sizze_53777 = get_local_size(0);\n    wave_sizze_53776 = LOCKSTEP_WIDTH;\n    block_id_53775 = get_tblock_id(0);\n    global_tid_53773 = block_id_53775 * tblock_sizze_53777 + local_tid_53774;\n    phys_tblock_id_51907 = sext_i32_i64(block_id_53775);\n    slice_53779 = total_grid_no_29491;\n    ltid_pre_53778 = sext_i32_i64(local_tid_53774);\n    remnant_53780 = sext_i32_i64(local_tid_53774) - ltid_pre_53778;\n    slice_53781 = total_grid_no_29491;\n    gtid_51906 = sext_i32_i64(block_id_53775);\n    remnant_53782 = sext_i32_i64(block_id_53775) - gtid_51906;\n    y_51910 = slt64(gtid_51906, dz2080U_29480);\n    if (!y_51910) {\n        {\n            if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                global_failure_args[0] = (int64_t) gtid_51906;\n                global_failure_args[1] = (int64_t) dz2080U_29480;\n                ;\n            }\n            local_failure = 1;\n            goto error_0;\n        }\n    }\n    phys_tid_51916 = sext_i32_i64(local_tid_53774);\n    red_arr_mem_53783 = (__local unsigned char *) red_arr_mem_53783_backing_0;\n    gtid_51915 = sext_i32_i64(sext_i64_i32(ltid_pre_53778));\n    y_51922 = slt64(gtid_51915, dz2080U_29480);\n    if (!y_51922) {\n        {\n            if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                global_failure_args[0] = (int64_t) gtid_51915;\n                global_failure_args[1] = (int64_t) dz2080U_29480;\n                ;\n            }\n            local_failure = 1;\n            goto error_0;\n        }\n    }\n    zg_lhs_51928 = ((__global int32_t *) mem_52679)[gtid_51915];\n    cond_51929 = slt32(0, zg_lhs_51928);\n    if (cond_51929) {\n        int64_t binop_x_53201;\n        int64_t ctx_53202;\n        int64_t ctx_53203;\n        bool defunc_0_sm_red_res_51932;\n        \n        binop_x_53201 = total_grid_no_29491 * phys_tblock_id_51907;\n        ctx_53202 = phys_tid_51916 + binop_x_53201;\n        ctx_53203 = total_grid_no",
                                    "_29491 * total_grid_no_29491;\n        if (cond_47437) {\n            bool defunc_0_foldl_res_51938;\n            bool acc_51940;\n            \n            for (int64_t i_52535 = 0; i_52535 < dim_29479; i_52535++) {\n                float eta_p_51935;\n                float eta_p_51936;\n                bool zg_res_51937;\n                \n                eta_p_51935 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51906 * dim_29479 + i_52535];\n                eta_p_51936 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51915 * dim_29479 + i_52535];\n                zg_res_51937 = eta_p_51936 < eta_p_51935;\n                ((__global bool *) color_52942)[ctx_53202 + i_52535 * ctx_53203] = zg_res_51937;\n            }\n            acc_51940 = 1;\n            for (int64_t i_51939 = 0; i_51939 < dim_29479; i_51939++) {\n                bool b_51941;\n                bool x_51942;\n                bool acc_tmp_53786;\n                \n                b_51941 = ((__global bool *) color_52942)[ctx_53202 + i_51939 * ctx_53203];\n                x_51942 = acc_51940 && b_51941;\n                acc_tmp_53786 = x_51942;\n                acc_51940 = acc_tmp_53786;\n            }\n            defunc_0_foldl_res_51938 = acc_51940;\n            defunc_0_sm_red_res_51932 = defunc_0_foldl_res_51938;\n        } else {\n            bool defunc_0_reduce_res_51944;\n            bool redout_52537 = 1;\n            \n            for (int64_t i_52538 = 0; i_52538 < dim_29479; i_52538++) {\n                float eta_p_51945;\n                float eta_p_51946;\n                bool zg_res_51947;\n                bool x_51950;\n                bool redout_tmp_53787;\n                \n                eta_p_51945 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51906 * dim_29479 + i_52538];\n                eta_p_51946 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_51915 * dim_29479 + i_52538];\n                zg_res_51947 = eta_p_51946 < eta_p_51945;\n                x_519", "50 = zg_res_51947 && redout_52537;\n                redout_tmp_53787 = x_51950;\n                redout_52537 = redout_tmp_53787;\n            }\n            defunc_0_reduce_res_51944 = redout_52537;\n            defunc_0_sm_red_res_51932 = defunc_0_reduce_res_51944;\n        }\n        lifted_lambda_res_51930 = defunc_0_sm_red_res_51932;\n    } else {\n        lifted_lambda_res_51930 = 0;\n    }\n    ((__local bool *) red_arr_mem_53783)[gtid_51915] = lifted_lambda_res_51930;\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53789 = 1;\n    offset_53788 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53774, sext_i64_i32(total_grid_no_29491))) {\n            eta_p_51917 = ((__local bool *) red_arr_mem_53783)[sext_i32_i64(local_tid_53774 + offset_53788)];\n        }\n    }\n    offset_53788 = 1;\n    while (slt32(offset_53788, wave_sizze_53776)) {\n        if (slt32(local_tid_53774 + offset_53788, sext_i64_i32(total_grid_no_29491)) && ((local_tid_53774 - squot32(local_tid_53774, wave_sizze_53776) * wave_sizze_53776) & (2 * offset_53788 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_51918 = ((volatile __local bool *) red_arr_mem_53783)[sext_i32_i64(local_tid_53774 + offset_53788)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_51919 = eta_p_51917 || eta_p_51918;\n                \n                eta_p_51917 = defunc_0_op_res_51919;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_mem_53783)[sext_i32_i64(local_tid_53774)] = eta_p_51917;\n            }\n        }\n        offset_53788 *= 2;\n    }\n    while (slt32(skip_waves_53789, squot32(sext_i64_i32(total_grid_no_29491) + wave_sizze_53776 - 1, wave_sizze_53776))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53788 = skip_waves_53789 * w", "ave_sizze_53776;\n        if (slt32(local_tid_53774 + offset_53788, sext_i64_i32(total_grid_no_29491)) && ((local_tid_53774 - squot32(local_tid_53774, wave_sizze_53776) * wave_sizze_53776) == 0 && (squot32(local_tid_53774, wave_sizze_53776) & (2 * skip_waves_53789 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_51918 = ((__local bool *) red_arr_mem_53783)[sext_i32_i64(local_tid_53774 + offset_53788)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_51919 = eta_p_51917 || eta_p_51918;\n                \n                eta_p_51917 = defunc_0_op_res_51919;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_mem_53783)[sext_i32_i64(local_tid_53774)] = eta_p_51917;\n            }\n        }\n        skip_waves_53789 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // Save result of reduction.\n    {\n        defunc_0_reduce_res_51914 = ((__local bool *) red_arr_mem_53783)[(int64_t) 0];\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_tid_53774 == 0) {\n        ((__global bool *) mem_52726)[gtid_51906] = defunc_0_reduce_res_51914;\n    }\n    \n  error_4:\n    return;\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegmap_intrablock_52185_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegmap_intrablock_52185(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_29479, int64_t dz2080U_29480, int64_t total_grid_no_29491, int64_t ldim_52188, int64_t num_whole_tiles_52209, int64_t residual_input_52385, unsigned char cond_52386_bits, int64_t binop_x_52396, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *mem_52679, __global unsigned char *mem_52760, __global unsigned char *color_52939, __global unsigned char *color_52940)\n{\n    bool cond_52386 = cond_52386_bits;\n    \n    #define tile_sizze_52187 (skyline_sli",
                                    "ce_and_dice_floatzisegmap_intrablock_52185zitile_sizze_52187)\n    #define bytes_52734 (skyline_slice_and_dice_floatzisegmap_intrablock_52185zibytes_52734)\n    \n    volatile __local unsigned char *color_52941_backing_0 = &shared_mem[0];\n    const int64_t color_52941_backing_0_offset = 0 + (bytes_52734 + srem64((int64_t) 8 - srem64(bytes_52734, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53751;\n    int32_t tblock_sizze_53754;\n    int32_t wave_sizze_53753;\n    int32_t block_id_53752;\n    int32_t global_tid_53750;\n    int64_t gid_flat_52185;\n    int64_t slice_53756;\n    int64_t ltid_pre_53755;\n    int64_t remnant_53757;\n    int64_t slice_53758;\n    int64_t gid_52184;\n    int64_t remnant_53759;\n    __local unsigned char *color_52941;\n    int64_t binop_x_52197;\n    bool mem_52729[1];\n    int64_t ltid_flat_52190;\n    int64_t ltid_52189;\n    int64_t gtid_52198;\n    bool cond_52199;\n    bool pre_52200;\n    bool mem_52732[1];\n    int64_t ltid_flat_52211;\n    int64_t ltid_52210;\n    bool ext_mem_ext_53180[1];\n    bool mem_param_ext_53168[1];\n    bool mem_52758[1];\n    bool ext_mem_ext_53192[1];\n    \n    local_tid_53751 = get_local_id(0);\n    tblock_sizze_53754 = get_local_size(0);\n    wave_sizze_53753 = LOCKSTEP_WIDTH;\n    block_id_53752 = get_tblock_id(0);\n    global_tid_53750 = block_id_53752 * tblock_sizze_53754 + local_tid_53751;\n    gid_flat_52185 = sext_i32_i64(block_id_53752);\n    slice_53756 = tile_sizze_52187;\n    ltid_pre_53755 = sext_i32_i64(local_tid_53751);\n    remnant_53757 = sext_i32_i64(local_tid_53751) - ltid_pre_53755;\n    slice_53758 = ldim_52188;\n    gid_52184 = sext_i32_i64(block_id_53752);\n    remnant_53759 = sext_i32_i64(block_id_53752) - gid_52184;\n    color_52941 = (__local unsigned char *) color_52941_backing_0;", "\n    binop_x_52197 = gid_52184 * tile_sizze_52187;\n    ltid_flat_52190 = sext_i32_i64(local_tid_53751);\n    ltid_52189 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n    gtid_52198 = ltid_52189 + binop_x_52197;\n    cond_52199 = slt64(gtid_52198, total_grid_no_29491);\n    if (cond_52199) {\n        bool y_52202;\n        bool index_certs_52203;\n        \n        y_52202 = slt64(gtid_52198, dz2080U_29480);\n        if (!y_52202) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                    global_failure_args[0] = (int64_t) gtid_52198;\n                    global_failure_args[1] = (int64_t) dz2080U_29480;\n                    ;\n                }\n                local_failure = 1;\n                goto error_0;\n            }\n        }\n        pre_52200 = index_certs_52203;\n    } else {\n        pre_52200 = 0;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_52211 = sext_i32_i64(local_tid_53751);\n    ltid_52210 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n    mem_52732[(int64_t) 0] = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_1 = 0; i_1 < 1; i_1++)\n        mem_param_ext_53168[i_1] = mem_52732[i_1];\n    for (int64_t tile_id_52217 = 0; tile_id_52217 < num_whole_tiles_52209; tile_id_52217++) {\n        int64_t binop_x_52293;\n        int64_t ltid_flat_52292;\n        int64_t ltid_52291;\n        int64_t j_52294;\n        bool cond_52300;\n        int64_t pre1d_52301;\n        bool mem_52745[1];\n        int64_t ltid_flat_52306;\n        int64_t ltid_52305;\n        int64_t gtid_52308;\n        bool acc_52312;\n        bool cond_52313;\n        bool acc_52314;\n        bool mem_param_ext_tmp_53761[1];\n        \n        binop_x_52293 = tile_sizze_52187 * tile_id_52217;\n        ltid_flat_52292 = sext_i32_i64(local_tid_53751);\n        ltid_52291 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n        j_52294 = l", "tid_52291 + binop_x_52293;\n        cond_52300 = slt64(j_52294, total_grid_no_29491);\n        if (cond_52300) {\n            pre1d_52301 = j_52294;\n        } else {\n            pre1d_52301 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_52941)[ltid_52291] = pre1d_52301;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_52306 = sext_i32_i64(local_tid_53751);\n        ltid_52305 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n        gtid_52308 = binop_x_52197 + ltid_52305;\n        acc_52312 = mem_param_ext_53168[(int64_t) 0];\n        cond_52313 = slt64(gtid_52308, total_grid_no_29491);\n        if (cond_52313) {\n            bool index_certs_52309;\n            bool cond_52327;\n            bool x_52315;\n            bool redout_52517;\n            \n            index_certs_52309 = 0;\n            cond_52327 = slt64(dim_29479, (int64_t) 6);\n            redout_52517 = acc_52312;\n            for (int64_t i_52518 = 0; i_52518 < tile_sizze_52187; i_52518++) {\n                int64_t eta_p_52316;\n                bool x_52317;\n                bool y_52318;\n                bool bounds_check_52319;\n                bool index_certs_52320;\n                bool y_52321;\n                bool bounds_check_52322;\n                bool index_certs_52323;\n                int32_t zg_lhs_52324;\n                bool cond_52325;\n                bool lifted_lambda_res_52326;\n                bool defunc_0_op_res_52349;\n                bool redout_tmp_53762;\n                \n                eta_p_52316 = ((__local int64_t *) color_52941)[i_52518];\n                x_52317 = sle64((int64_t) 0, eta_p_52316);\n                y_52318 = slt64(eta_p_52316, dz2080U_29480);\n                bounds_check_52319 = x_52317 && y_52318;\n                if (!bounds_check_52319) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                            global_failure_args[0] = (int64_t) eta_p_52316;\n                            global_failure",
                                    "_args[1] = (int64_t) dz2080U_29480;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_4;\n                    }\n                }\n                y_52321 = slt64(eta_p_52316, total_grid_no_29491);\n                bounds_check_52322 = x_52317 && y_52321;\n                if (!bounds_check_52322) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 8) == -1) {\n                            global_failure_args[0] = (int64_t) eta_p_52316;\n                            global_failure_args[1] = (int64_t) total_grid_no_29491;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_4;\n                    }\n                }\n                zg_lhs_52324 = ((__global int32_t *) mem_52679)[eta_p_52316];\n                cond_52325 = slt32(0, zg_lhs_52324);\n                if (cond_52325) {\n                    int64_t binop_x_53174;\n                    int64_t ctx_53175;\n                    int64_t ctx_53176;\n                    bool defunc_0_sm_red_res_52328;\n                    \n                    binop_x_53174 = gid_flat_52185 * tile_sizze_52187;\n                    ctx_53175 = ltid_flat_52306 + binop_x_53174;\n                    ctx_53176 = tile_sizze_52187 * ldim_52188;\n                    if (cond_52327) {\n                        bool defunc_0_foldl_res_52334;\n                        bool acc_52336;\n                        \n                        for (int64_t i_52521 = 0; i_52521 < dim_29479; i_52521++) {\n                            float eta_p_52331;\n                            float eta_p_52332;\n                            bool zg_res_52333;\n                            \n                            eta_p_52331 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_52308 * dim_29479 + i_52521];\n                            eta_p_52332 = ((__global float *) start_of_gr", "id_partition_mem_52566)[eta_p_52316 * dim_29479 + i_52521];\n                            zg_res_52333 = eta_p_52332 < eta_p_52331;\n                            ((__global bool *) color_52939)[ctx_53175 + i_52521 * ctx_53176] = zg_res_52333;\n                        }\n                        acc_52336 = 1;\n                        for (int64_t i_52335 = 0; i_52335 < dim_29479; i_52335++) {\n                            bool b_52337;\n                            bool x_52338;\n                            bool acc_tmp_53764;\n                            \n                            b_52337 = ((__global bool *) color_52939)[ctx_53175 + i_52335 * ctx_53176];\n                            x_52338 = acc_52336 && b_52337;\n                            acc_tmp_53764 = x_52338;\n                            acc_52336 = acc_tmp_53764;\n                        }\n                        defunc_0_foldl_res_52334 = acc_52336;\n                        defunc_0_sm_red_res_52328 = defunc_0_foldl_res_52334;\n                    } else {\n                        bool defunc_0_reduce_res_52340;\n                        bool redout_52523 = 1;\n                        \n                        for (int64_t i_52524 = 0; i_52524 < dim_29479; i_52524++) {\n                            float eta_p_52341;\n                            float eta_p_52342;\n                            bool zg_res_52343;\n                            bool x_52346;\n                            bool redout_tmp_53765;\n                            \n                            eta_p_52341 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_52308 * dim_29479 + i_52524];\n                            eta_p_52342 = ((__global float *) start_of_grid_partition_mem_52566)[eta_p_52316 * dim_29479 + i_52524];\n                            zg_res_52343 = eta_p_52342 < eta_p_52341;\n                            x_52346 = zg_res_52343 && redout_52523;\n                            redout_tmp_53765 = x_52346;\n                            redout_52523 = redout_", "tmp_53765;\n                        }\n                        defunc_0_reduce_res_52340 = redout_52523;\n                        defunc_0_sm_red_res_52328 = defunc_0_reduce_res_52340;\n                    }\n                    lifted_lambda_res_52326 = defunc_0_sm_red_res_52328;\n                } else {\n                    lifted_lambda_res_52326 = 0;\n                }\n                defunc_0_op_res_52349 = lifted_lambda_res_52326 || redout_52517;\n                redout_tmp_53762 = defunc_0_op_res_52349;\n                redout_52517 = redout_tmp_53762;\n            }\n            x_52315 = redout_52517;\n            acc_52314 = x_52315;\n        } else {\n            acc_52314 = acc_52312;\n        }\n        mem_52745[(int64_t) 0] = acc_52314;\n        \n      error_4:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_2 = 0; i_2 < 1; i_2++)\n            mem_param_ext_tmp_53761[i_2] = mem_52745[i_2];\n        for (int32_t i_3 = 0; i_3 < 1; i_3++)\n            mem_param_ext_53168[i_3] = mem_param_ext_tmp_53761[i_3];\n    }\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        ext_mem_ext_53180[i_4] = mem_param_ext_53168[i_4];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_52386) {\n        for (int32_t i_5 = 0; i_5 < 1; i_5++)\n            ext_mem_ext_53192[i_5] = ext_mem_ext_53180[i_5];\n    } else {\n        int64_t ltid_flat_52388;\n        int64_t ltid_52387;\n        int64_t j_52397;\n        bool cond_52403;\n        int64_t pre1d_52404;\n        int64_t ltid_flat_52410;\n        int64_t ltid_52409;\n        int64_t gtid_52417;\n        bool acc_52421;\n        bool cond_52422;\n        bool acc_52423;\n        \n        ltid_flat_52388 = sext_i32_i64(local_tid_53751);\n        ltid_52387 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n        j_52397 = ltid_52387 + binop_x_52396;\n        cond_52403 = slt64(j_52397, total_grid_no_29491);\n        if (cond_52403) {\n            pre1d_52404 = j_52397;\n      ",
                                    "  } else {\n            pre1d_52404 = (int64_t) 0;\n        }\n        ((__local int64_t *) color_52941)[ltid_52387] = pre1d_52404;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_52410 = sext_i32_i64(local_tid_53751);\n        ltid_52409 = sext_i32_i64(sext_i64_i32(ltid_pre_53755));\n        gtid_52417 = binop_x_52197 + ltid_52409;\n        acc_52421 = ext_mem_ext_53180[(int64_t) 0];\n        cond_52422 = slt64(gtid_52417, total_grid_no_29491);\n        if (cond_52422) {\n            bool index_certs_52418;\n            bool cond_52436;\n            bool x_52424;\n            bool redout_52525;\n            \n            index_certs_52418 = 0;\n            cond_52436 = slt64(dim_29479, (int64_t) 6);\n            redout_52525 = acc_52421;\n            for (int64_t i_52526 = 0; i_52526 < residual_input_52385; i_52526++) {\n                int64_t eta_p_52425;\n                bool x_52426;\n                bool y_52427;\n                bool bounds_check_52428;\n                bool index_certs_52429;\n                bool y_52430;\n                bool bounds_check_52431;\n                bool index_certs_52432;\n                int32_t zg_lhs_52433;\n                bool cond_52434;\n                bool lifted_lambda_res_52435;\n                bool defunc_0_op_res_52458;\n                bool redout_tmp_53766;\n                \n                eta_p_52425 = ((__local int64_t *) color_52941)[i_52526];\n                x_52426 = sle64((int64_t) 0, eta_p_52425);\n                y_52427 = slt64(eta_p_52425, dz2080U_29480);\n                bounds_check_52428 = x_52426 && y_52427;\n                if (!bounds_check_52428) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                            global_failure_args[0] = (int64_t) eta_p_52425;\n                            global_failure_args[1] = (int64_t) dz2080U_29480;\n                            ;\n                        }\n                        local_failure = 1;\n               ", "         goto error_7;\n                    }\n                }\n                y_52430 = slt64(eta_p_52425, total_grid_no_29491);\n                bounds_check_52431 = x_52426 && y_52430;\n                if (!bounds_check_52431) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                            global_failure_args[0] = (int64_t) eta_p_52425;\n                            global_failure_args[1] = (int64_t) total_grid_no_29491;\n                            ;\n                        }\n                        local_failure = 1;\n                        goto error_7;\n                    }\n                }\n                zg_lhs_52433 = ((__global int32_t *) mem_52679)[eta_p_52425];\n                cond_52434 = slt32(0, zg_lhs_52433);\n                if (cond_52434) {\n                    int64_t binop_x_53186;\n                    int64_t ctx_53187;\n                    int64_t ctx_53188;\n                    bool defunc_0_sm_red_res_52437;\n                    \n                    binop_x_53186 = gid_flat_52185 * tile_sizze_52187;\n                    ctx_53187 = ltid_flat_52410 + binop_x_53186;\n                    ctx_53188 = tile_sizze_52187 * ldim_52188;\n                    if (cond_52436) {\n                        bool defunc_0_foldl_res_52443;\n                        bool acc_52445;\n                        \n                        for (int64_t i_52529 = 0; i_52529 < dim_29479; i_52529++) {\n                            float eta_p_52440;\n                            float eta_p_52441;\n                            bool zg_res_52442;\n                            \n                            eta_p_52440 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_52417 * dim_29479 + i_52529];\n                            eta_p_52441 = ((__global float *) start_of_grid_partition_mem_52566)[eta_p_52425 * dim_29479 + i_52529];\n                            zg_res_52442 = eta_p_52441 < eta_p_52440;\n                   ", "         ((__global bool *) color_52940)[ctx_53187 + i_52529 * ctx_53188] = zg_res_52442;\n                        }\n                        acc_52445 = 1;\n                        for (int64_t i_52444 = 0; i_52444 < dim_29479; i_52444++) {\n                            bool b_52446;\n                            bool x_52447;\n                            bool acc_tmp_53768;\n                            \n                            b_52446 = ((__global bool *) color_52940)[ctx_53187 + i_52444 * ctx_53188];\n                            x_52447 = acc_52445 && b_52446;\n                            acc_tmp_53768 = x_52447;\n                            acc_52445 = acc_tmp_53768;\n                        }\n                        defunc_0_foldl_res_52443 = acc_52445;\n                        defunc_0_sm_red_res_52437 = defunc_0_foldl_res_52443;\n                    } else {\n                        bool defunc_0_reduce_res_52449;\n                        bool redout_52531 = 1;\n                        \n                        for (int64_t i_52532 = 0; i_52532 < dim_29479; i_52532++) {\n                            float eta_p_52450;\n                            float eta_p_52451;\n                            bool zg_res_52452;\n                            bool x_52455;\n                            bool redout_tmp_53769;\n                            \n                            eta_p_52450 = ((__global float *) start_of_grid_partition_mem_52566)[gtid_52417 * dim_29479 + i_52532];\n                            eta_p_52451 = ((__global float *) start_of_grid_partition_mem_52566)[eta_p_52425 * dim_29479 + i_52532];\n                            zg_res_52452 = eta_p_52451 < eta_p_52450;\n                            x_52455 = zg_res_52452 && redout_52531;\n                            redout_tmp_53769 = x_52455;\n                            redout_52531 = redout_tmp_53769;\n                        }\n                        defunc_0_reduce_res_52449 = redout_52531;\n                        defunc_0_sm_red_res_52",
                                    "437 = defunc_0_reduce_res_52449;\n                    }\n                    lifted_lambda_res_52435 = defunc_0_sm_red_res_52437;\n                } else {\n                    lifted_lambda_res_52435 = 0;\n                }\n                defunc_0_op_res_52458 = lifted_lambda_res_52435 || redout_52525;\n                redout_tmp_53766 = defunc_0_op_res_52458;\n                redout_52525 = redout_tmp_53766;\n            }\n            x_52424 = redout_52525;\n            acc_52423 = x_52424;\n        } else {\n            acc_52423 = acc_52421;\n        }\n        mem_52758[(int64_t) 0] = acc_52423;\n        \n      error_7:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            ext_mem_ext_53192[i_6] = mem_52758[i_6];\n    }\n    if (slt64(sext_i32_i64(local_tid_53751) + tile_sizze_52187 * sext_i32_i64(block_id_53752), total_grid_no_29491)) {\n        bool tmp_53770 = ext_mem_ext_53192[(int64_t) 0];\n        \n        ((__global bool *) mem_52760)[sext_i32_i64(local_tid_53751) + tile_sizze_52187 * sext_i32_i64(block_id_53752)] = tmp_53770;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_52187\n    #undef bytes_52734\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_large_52059_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_large_52059(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_29479, int64_t dz2080U_29480, int64_t total_grid_no_29491, unsigned char cond_47437_bits, int64_t num_tblocks_52054, int64_t num_threads_53207, int64_t blocks_per_segment_53842, int64_t q_53843, int64_t num_virtblocks_53844, int64_t threads_per_segment_53845, __global unsigned char *mem_52679, __global unsigned char *mem_52697, __global unsigned char *mem_52708, __global unsigned char *mem_52717, __global unsigned char *color_52943, __global unsigned char *segred_tmp_mem_53846, __global unsigned cha", "r *counters_mem_53848)\n{\n    bool cond_47437 = cond_47437_bits;\n    \n    #define segred_tblock_sizze_52053 (skyline_slice_and_dice_floatzisegred_large_52059zisegred_tblock_sizze_52053)\n    #define chunk_sizze_53810 (skyline_slice_and_dice_floatzisegred_large_52059zichunk_sizze_53810)\n    \n    volatile __local unsigned char *sync_arr_mem_53857_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53857_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_53855_backing_0 = &shared_mem[sync_arr_mem_53857_backing_1_offset];\n    const int64_t red_arr_bool_mem_53855_backing_0_offset = sync_arr_mem_53857_backing_1_offset + (segred_tblock_sizze_52053 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_52053, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53851;\n    int32_t tblock_sizze_53854;\n    int32_t wave_sizze_53853;\n    int32_t block_id_53852;\n    int32_t global_tid_53850;\n    int64_t phys_tid_52059;\n    __local unsigned char *red_arr_bool_mem_53855;\n    __local unsigned char *sync_arr_mem_53857;\n    int32_t phys_tblock_id_53859;\n    int32_t iterations_53860;\n    \n    local_tid_53851 = get_local_id(0);\n    tblock_sizze_53854 = get_local_size(0);\n    wave_sizze_53853 = LOCKSTEP_WIDTH;\n    block_id_53852 = get_tblock_id(0);\n    global_tid_53850 = block_id_53852 * tblock_sizze_53854 + local_tid_53851;\n    phys_tid_52059 = sext_i32_i64(global_tid_53850);\n    red_arr_bool_mem_53855 = (__local unsigned char *) red_arr_bool_mem_53855_backing_0;\n    sync_arr_mem_53857 = (__local unsigned char *) sync_arr_mem_53857_backing_1;\n    phys_tblock_id_53859 = get_tblock_id(0);\n    iterations_53860 = sdiv_up32(sext_i64_i32(num_virtblocks_53844) - phys_tblock_id_53859, sext_i64_i32(num_tblocks_52054));\n    for (int32_t i", "_53861 = 0; i_53861 < iterations_53860; i_53861++) {\n        int32_t virt_tblock_id_53862;\n        int64_t flat_segment_id_53863;\n        int64_t global_tid_53864;\n        int64_t slice_53865;\n        int64_t gtid_52057;\n        int64_t remnant_53866;\n        int64_t gtid_52058;\n        bool eta_p_block_res_acc_53867;\n        bool eta_p_52060;\n        bool eta_p_52061;\n        int64_t tblock_id_in_segment_53871;\n        int64_t block_base_offset_53872;\n        int32_t offset_53878;\n        int32_t skip_waves_53879;\n        bool eta_p_53868;\n        bool eta_p_53869;\n        \n        virt_tblock_id_53862 = phys_tblock_id_53859 + i_53861 * sext_i64_i32(num_tblocks_52054);\n        flat_segment_id_53863 = squot64(sext_i32_i64(virt_tblock_id_53862), blocks_per_segment_53842);\n        global_tid_53864 = srem64(sext_i32_i64(virt_tblock_id_53862) * segred_tblock_sizze_52053 + sext_i32_i64(local_tid_53851), threads_per_segment_53845);\n        slice_53865 = total_grid_no_29491;\n        gtid_52057 = flat_segment_id_53863;\n        remnant_53866 = flat_segment_id_53863 - gtid_52057;\n        // ne-initialise the outer (per-block) accumulator(s)\n        {\n            eta_p_block_res_acc_53867 = 0;\n        }\n        tblock_id_in_segment_53871 = squot64(global_tid_53864, segred_tblock_sizze_52053);\n        block_base_offset_53872 = tblock_id_in_segment_53871 * q_53843 * segred_tblock_sizze_52053;\n        for (int64_t i_53873 = 0; i_53873 < q_53843; i_53873++) {\n            int64_t block_offset_53874 = block_base_offset_53872 + i_53873 * segred_tblock_sizze_52053;\n            \n            gtid_52058 = global_tid_53864 + threads_per_segment_53845 * i_53873;\n            if (slt64(gtid_52058, total_grid_no_29491)) {\n                // apply map function(s)\n                {\n                    // apply map function\n                    {\n                        bool y_52066 = slt64(gtid_52058, dz2080U_29480);\n                        bool index_certs_52068;\n                        \n      ",
                                    "                  if (!y_52066) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                                    global_failure_args[0] = (int64_t) gtid_52058;\n                                    global_failure_args[1] = (int64_t) dz2080U_29480;\n                                    ;\n                                }\n                                local_failure = 1;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int32_t zg_lhs_52072 = ((__global int32_t *) mem_52679)[gtid_52058];\n                        bool cond_52073 = slt32(0, zg_lhs_52072);\n                        bool lifted_lambda_res_52074;\n                        \n                        if (cond_52073) {\n                            bool defunc_0_sm_red_res_52076;\n                            \n                            if (cond_47437) {\n                                for (int64_t i_52541 = 0; i_52541 < dim_29479; i_52541++) {\n                                    float eta_p_52079 = ((__global float *) mem_52697)[gtid_52057 + i_52541 * total_grid_no_29491];\n                                    float eta_p_52080 = ((__global float *) mem_52708)[gtid_52058 + i_52541 * dz2080U_29480];\n                                    bool zg_res_52081 = eta_p_52080 < eta_p_52079;\n                                    \n                                    ((__global bool *) color_52943)[phys_tid_52059 + i_52541 * num_threads_53207] = zg_res_52081;\n                                }\n                                \n                                bool defunc_0_foldl_res_52082;\n                                bool acc_52084 = 1;\n                                \n                                for (int64_t i_52083 = 0; i_52083 < dim_29479; i_52083++) {\n                                    bool b_52085 = ((__global bool *) color_52943)[phys_tid_52059 + ", "i_52083 * num_threads_53207];\n                                    bool x_52086 = acc_52084 && b_52085;\n                                    bool acc_tmp_53876 = x_52086;\n                                    \n                                    acc_52084 = acc_tmp_53876;\n                                }\n                                defunc_0_foldl_res_52082 = acc_52084;\n                                defunc_0_sm_red_res_52076 = defunc_0_foldl_res_52082;\n                            } else {\n                                bool defunc_0_reduce_res_52088;\n                                bool redout_52543 = 1;\n                                \n                                for (int64_t i_52544 = 0; i_52544 < dim_29479; i_52544++) {\n                                    float eta_p_52089 = ((__global float *) mem_52697)[gtid_52057 + i_52544 * total_grid_no_29491];\n                                    float eta_p_52090 = ((__global float *) mem_52708)[gtid_52058 + i_52544 * dz2080U_29480];\n                                    bool zg_res_52091 = eta_p_52090 < eta_p_52089;\n                                    bool x_52094 = zg_res_52091 && redout_52543;\n                                    bool redout_tmp_53877 = x_52094;\n                                    \n                                    redout_52543 = redout_tmp_53877;\n                                }\n                                defunc_0_reduce_res_52088 = redout_52543;\n                                defunc_0_sm_red_res_52076 = defunc_0_reduce_res_52088;\n                            }\n                            lifted_lambda_res_52074 = defunc_0_sm_red_res_52076;\n                        } else {\n                            lifted_lambda_res_52074 = 0;\n                        }\n                        // load accumulator(s)\n                        {\n                            eta_p_52060 = eta_p_block_res_acc_53867;\n                        }\n                        // load next value(s)\n                        {\n ", "                           eta_p_52061 = lifted_lambda_res_52074;\n                        }\n                        // apply reduction operator(s)\n                        {\n                            bool defunc_0_op_res_52062 = eta_p_52060 || eta_p_52061;\n                            \n                            // store in accumulator(s)\n                            {\n                                eta_p_block_res_acc_53867 = defunc_0_op_res_52062;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_block_res_acc_53867;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_53879 = 1;\n        offset_53878 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_53851, sext_i64_i32(segred_tblock_sizze_52053))) {\n                eta_p_53868 = ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53878)];\n            }\n        }\n        offset_53878 = 1;\n        while (slt32(offset_53878, wave_sizze_53853)) {\n            if (slt32(local_tid_53851 + offset_53878, sext_i64_i32(segred_tblock_sizze_52053)) && ((local_tid_53851 - squot32(local_tid_53851, wave_sizze_53853) * wave_sizze_53853) & (2 * offset_53878 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_53869 = ((volatile __local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53878)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_53870 = eta_p_53868 || eta_p_53869;\n                    \n               ",
                                    "     eta_p_53868 = defunc_0_op_res_53870;\n                }\n                // write result of operation\n                {\n                    ((volatile __local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_53868;\n                }\n            }\n            offset_53878 *= 2;\n        }\n        while (slt32(skip_waves_53879, squot32(sext_i64_i32(segred_tblock_sizze_52053) + wave_sizze_53853 - 1, wave_sizze_53853))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_53878 = skip_waves_53879 * wave_sizze_53853;\n            if (slt32(local_tid_53851 + offset_53878, sext_i64_i32(segred_tblock_sizze_52053)) && ((local_tid_53851 - squot32(local_tid_53851, wave_sizze_53853) * wave_sizze_53853) == 0 && (squot32(local_tid_53851, wave_sizze_53853) & (2 * skip_waves_53879 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_53869 = ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53878)];\n                }\n                // apply reduction operation\n                {\n                    bool defunc_0_op_res_53870 = eta_p_53868 || eta_p_53869;\n                    \n                    eta_p_53868 = defunc_0_op_res_53870;\n                }\n                // write result of operation\n                {\n                    ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_53868;\n                }\n            }\n            skip_waves_53879 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_53851) == (int64_t) 0) {\n                eta_p_block_res_acc_53867 = eta_p_53868;\n            } else {\n                eta_p_block_res_acc_53867 = 0;\n            }\n        }\n        if (blocks_per_segment_53842 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            ", "{\n                if (local_tid_53851 == 0) {\n                    ((__global bool *) mem_52717)[gtid_52057] = eta_p_block_res_acc_53867;\n                }\n            }\n        } else {\n            int32_t old_counter_53880;\n            bool is_last_block_53881;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_53851 == 0) {\n                    ((__global bool *) segred_tmp_mem_53846)[sext_i32_i64(virt_tblock_id_53862)] = eta_p_block_res_acc_53867;\n                    mem_fence_global();\n                    old_counter_53880 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53848)[srem64(flat_segment_id_53863, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_53857)[(int64_t) 0] = old_counter_53880 == sext_i64_i32(blocks_per_segment_53842 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_53881 = ((__local bool *) sync_arr_mem_53857)[(int64_t) 0];\n            if (is_last_block_53881) {\n                if (local_tid_53851 == 0) {\n                    old_counter_53880 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53848)[srem64(flat_segment_id_53863, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_53842));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_53882 = sdiv_up64(blocks_per_segment_53842, segred_tblock_sizze_52053);\n                    \n                    eta_p_52060 = 0;\n                    for (int64_t i_53883 = 0; i_53883 < read_per_thread_53882; i_53883++) {\n                        int64_t block_res_id_53884 = sext_i32_i64(local_tid_53851) * read_per_thread_53882 + i_53883;\n                        int64_t index_of_block_res_53885 = flat_segment_id_53863 * blocks_per_segment_53842 + block_res_id_53884;\n                        \n", "                        if (slt64(block_res_id_53884, blocks_per_segment_53842)) {\n                            eta_p_52061 = ((__global bool *) segred_tmp_mem_53846)[index_of_block_res_53885];\n                            \n                            bool defunc_0_op_res_52062 = eta_p_52060 || eta_p_52061;\n                            \n                            eta_p_52060 = defunc_0_op_res_52062;\n                        }\n                    }\n                }\n                ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_52060;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_53886;\n                    int32_t skip_waves_53887 = 1;\n                    bool eta_p_53868;\n                    bool eta_p_53869;\n                    \n                    offset_53886 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_53851, sext_i64_i32(segred_tblock_sizze_52053))) {\n                            eta_p_53868 = ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53886)];\n                        }\n                    }\n                    offset_53886 = 1;\n                    while (slt32(offset_53886, wave_sizze_53853)) {\n                        if (slt32(local_tid_53851 + offset_53886, sext_i64_i32(segred_tblock_sizze_52053)) && ((local_tid_53851 - squot32(local_tid_53851, wave_sizze_53853) * wave_sizze_53853) & (2 * offset_53886 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_53869 = ((volatile __local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53886)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_r",
                                    "es_53870 = eta_p_53868 || eta_p_53869;\n                                \n                                eta_p_53868 = defunc_0_op_res_53870;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_53868;\n                            }\n                        }\n                        offset_53886 *= 2;\n                    }\n                    while (slt32(skip_waves_53887, squot32(sext_i64_i32(segred_tblock_sizze_52053) + wave_sizze_53853 - 1, wave_sizze_53853))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_53886 = skip_waves_53887 * wave_sizze_53853;\n                        if (slt32(local_tid_53851 + offset_53886, sext_i64_i32(segred_tblock_sizze_52053)) && ((local_tid_53851 - squot32(local_tid_53851, wave_sizze_53853) * wave_sizze_53853) == 0 && (squot32(local_tid_53851, wave_sizze_53853) & (2 * skip_waves_53887 - 1)) == 0)) {\n                            // read array element\n                            {\n                                eta_p_53869 = ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851 + offset_53886)];\n                            }\n                            // apply reduction operation\n                            {\n                                bool defunc_0_op_res_53870 = eta_p_53868 || eta_p_53869;\n                                \n                                eta_p_53868 = defunc_0_op_res_53870;\n                            }\n                            // write result of operation\n                            {\n                                ((__local bool *) red_arr_bool_mem_53855)[sext_i32_i64(local_tid_53851)] = eta_p_53868;\n                            }\n                        }\n                        skip_waves_53887 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE)", ";\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_53851 == 0) {\n                            ((__global bool *) mem_52717)[gtid_52057] = eta_p_53868;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef segred_tblock_sizze_52053\n    #undef chunk_sizze_53810\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_large_53674_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_large_53674(__global int *global_failure, int64_t total_grid_no_29491, int64_t num_tblocks_51785, int64_t num_subhistos_53588, int64_t blocks_per_segment_53705, int64_t q_53706, int64_t num_virtblocks_53707, int64_t threads_per_segment_53708, __global unsigned char *mem_52679, __global unsigned char *defunc_0_map_res_subhistos_mem_53589, __global unsigned char *segred_tmp_mem_53709, __global unsigned char *counters_mem_53711)\n{\n    #define seghist_tblock_sizze_51783 (skyline_slice_and_dice_floatzisegred_large_53674ziseghist_tblock_sizze_51783)\n    #define chunk_sizze_53675 (skyline_slice_and_dice_floatzisegred_large_53674zichunk_sizze_53675)\n    \n    volatile __local unsigned char *sync_arr_mem_53720_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53720_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i32_mem_53718_backing_0 = &shared_mem[sync_arr_mem_53720_backing_1_offset];\n    const int64_t red_arr_i32_mem_53718_backing_0_offset = sync_arr_mem_53720_backing_1_offset + ((int64_t) 4 * seghist_tblock_sizze_51783 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51783, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53714;\n    int32_t tblock_sizze_53717;\n    int32_t wave_sizze_53716;\n    int32_t block_id_53715;\n    int32_t global_tid_53713;\n    int64_t flat_gtid_53674;\n   ", " __local unsigned char *red_arr_i32_mem_53718;\n    __local unsigned char *sync_arr_mem_53720;\n    int32_t phys_tblock_id_53722;\n    int32_t iterations_53723;\n    \n    local_tid_53714 = get_local_id(0);\n    tblock_sizze_53717 = get_local_size(0);\n    wave_sizze_53716 = LOCKSTEP_WIDTH;\n    block_id_53715 = get_tblock_id(0);\n    global_tid_53713 = block_id_53715 * tblock_sizze_53717 + local_tid_53714;\n    flat_gtid_53674 = sext_i32_i64(global_tid_53713);\n    red_arr_i32_mem_53718 = (__local unsigned char *) red_arr_i32_mem_53718_backing_0;\n    sync_arr_mem_53720 = (__local unsigned char *) sync_arr_mem_53720_backing_1;\n    phys_tblock_id_53722 = get_tblock_id(0);\n    iterations_53723 = sdiv_up32(sext_i64_i32(num_virtblocks_53707) - phys_tblock_id_53722, sext_i64_i32(num_tblocks_51785));\n    for (int32_t i_53724 = 0; i_53724 < iterations_53723; i_53724++) {\n        int32_t virt_tblock_id_53725;\n        int64_t flat_segment_id_53726;\n        int64_t global_tid_53727;\n        int64_t slice_53728;\n        int64_t bucket_id_53672;\n        int64_t remnant_53729;\n        int64_t subhistogram_id_53673;\n        int32_t eta_p_block_res_acc_53730;\n        int32_t eta_p_51791;\n        int32_t eta_p_51792;\n        int64_t tblock_id_in_segment_53734;\n        int64_t block_base_offset_53735;\n        int32_t offset_53738;\n        int32_t skip_waves_53739;\n        int32_t eta_p_53731;\n        int32_t eta_p_53732;\n        \n        virt_tblock_id_53725 = phys_tblock_id_53722 + i_53724 * sext_i64_i32(num_tblocks_51785);\n        flat_segment_id_53726 = squot64(sext_i32_i64(virt_tblock_id_53725), blocks_per_segment_53705);\n        global_tid_53727 = srem64(sext_i32_i64(virt_tblock_id_53725) * seghist_tblock_sizze_51783 + sext_i32_i64(local_tid_53714), threads_per_segment_53708);\n        slice_53728 = total_grid_no_29491;\n        bucket_id_53672 = flat_segment_id_53726;\n        remnant_53729 = flat_segment_id_53726 - bucket_id_53672;\n        // ne-initialise the outer (per-block) accumulator",
                                    "(s)\n        {\n            eta_p_block_res_acc_53730 = 0;\n        }\n        tblock_id_in_segment_53734 = squot64(global_tid_53727, seghist_tblock_sizze_51783);\n        block_base_offset_53735 = tblock_id_in_segment_53734 * q_53706 * seghist_tblock_sizze_51783;\n        for (int64_t i_53736 = 0; i_53736 < q_53706; i_53736++) {\n            int64_t block_offset_53737 = block_base_offset_53735 + i_53736 * seghist_tblock_sizze_51783;\n            \n            subhistogram_id_53673 = global_tid_53727 + threads_per_segment_53708 * i_53736;\n            if (slt64(subhistogram_id_53673, num_subhistos_53588)) {\n                // apply map function(s)\n                {\n                    // load accumulator(s)\n                    {\n                        eta_p_51791 = eta_p_block_res_acc_53730;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_51792 = ((__global int32_t *) defunc_0_map_res_subhistos_mem_53589)[subhistogram_id_53673 * total_grid_no_29491 + bucket_id_53672];\n                    }\n                    // apply reduction operator(s)\n                    {\n                        int32_t defunc_0_op_res_51793 = add32(eta_p_51791, eta_p_51792);\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53730 = defunc_0_op_res_51793;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // store accs. prims go in lmem; non-prims in params (in global mem)\n        {\n            ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_block_res_acc_53730;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        skip_waves_53739 = 1;\n        offset_53738 = 0;\n        // participating threads read initial accumulator\n        {\n            if (slt32(local_tid_53714, sext_i64_i32(seghist_tblock_sizze_51783))) {\n      ", "          eta_p_53731 = ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53738)];\n            }\n        }\n        offset_53738 = 1;\n        while (slt32(offset_53738, wave_sizze_53716)) {\n            if (slt32(local_tid_53714 + offset_53738, sext_i64_i32(seghist_tblock_sizze_51783)) && ((local_tid_53714 - squot32(local_tid_53714, wave_sizze_53716) * wave_sizze_53716) & (2 * offset_53738 - 1)) == 0) {\n                // read array element\n                {\n                    eta_p_53732 = ((volatile __local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53738)];\n                }\n                // apply reduction operation\n                {\n                    int32_t defunc_0_op_res_53733 = add32(eta_p_53731, eta_p_53732);\n                    \n                    eta_p_53731 = defunc_0_op_res_53733;\n                }\n                // write result of operation\n                {\n                    ((volatile __local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_53731;\n                }\n            }\n            offset_53738 *= 2;\n        }\n        while (slt32(skip_waves_53739, squot32(sext_i64_i32(seghist_tblock_sizze_51783) + wave_sizze_53716 - 1, wave_sizze_53716))) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            offset_53738 = skip_waves_53739 * wave_sizze_53716;\n            if (slt32(local_tid_53714 + offset_53738, sext_i64_i32(seghist_tblock_sizze_51783)) && ((local_tid_53714 - squot32(local_tid_53714, wave_sizze_53716) * wave_sizze_53716) == 0 && (squot32(local_tid_53714, wave_sizze_53716) & (2 * skip_waves_53739 - 1)) == 0)) {\n                // read array element\n                {\n                    eta_p_53732 = ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53738)];\n                }\n                // apply reduction operation\n                {\n                    int32_t defunc_0_op_res_53733 = add32(eta_p_53731, eta_p_5373", "2);\n                    \n                    eta_p_53731 = defunc_0_op_res_53733;\n                }\n                // write result of operation\n                {\n                    ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_53731;\n                }\n            }\n            skip_waves_53739 *= 2;\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // thread 0 updates per-block acc(s); rest reset to ne\n        {\n            if (sext_i32_i64(local_tid_53714) == (int64_t) 0) {\n                eta_p_block_res_acc_53730 = eta_p_53731;\n            } else {\n                eta_p_block_res_acc_53730 = 0;\n            }\n        }\n        if (blocks_per_segment_53705 == (int64_t) 1) {\n            // first thread in block saves final result to memory\n            {\n                if (local_tid_53714 == 0) {\n                    ((__global int32_t *) mem_52679)[bucket_id_53672] = eta_p_block_res_acc_53730;\n                }\n            }\n        } else {\n            int32_t old_counter_53740;\n            bool is_last_block_53741;\n            \n            // first thread in block saves block result to global memory\n            {\n                if (local_tid_53714 == 0) {\n                    ((__global int32_t *) segred_tmp_mem_53709)[sext_i32_i64(virt_tblock_id_53725)] = eta_p_block_res_acc_53730;\n                    mem_fence_global();\n                    old_counter_53740 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53711)[srem64(flat_segment_id_53726, (int64_t) 20480)], (int) 1);\n                    ((__local bool *) sync_arr_mem_53720)[(int64_t) 0] = old_counter_53740 == sext_i64_i32(blocks_per_segment_53705 - (int64_t) 1);\n                }\n            }\n            barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n            is_last_block_53741 = ((__local bool *) sync_arr_mem_53720)[(int64_t) 0];\n            if (is_last_block_53741) {\n                if (local_tid_53",
                                    "714 == 0) {\n                    old_counter_53740 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53711)[srem64(flat_segment_id_53726, (int64_t) 20480)], (int) sext_i64_i32((int64_t) 0 - blocks_per_segment_53705));\n                }\n                // read in the per-block-results\n                {\n                    int64_t read_per_thread_53742 = sdiv_up64(blocks_per_segment_53705, seghist_tblock_sizze_51783);\n                    \n                    eta_p_51791 = 0;\n                    for (int64_t i_53743 = 0; i_53743 < read_per_thread_53742; i_53743++) {\n                        int64_t block_res_id_53744 = sext_i32_i64(local_tid_53714) * read_per_thread_53742 + i_53743;\n                        int64_t index_of_block_res_53745 = flat_segment_id_53726 * blocks_per_segment_53705 + block_res_id_53744;\n                        \n                        if (slt64(block_res_id_53744, blocks_per_segment_53705)) {\n                            eta_p_51792 = ((__global int32_t *) segred_tmp_mem_53709)[index_of_block_res_53745];\n                            \n                            int32_t defunc_0_op_res_51793 = add32(eta_p_51791, eta_p_51792);\n                            \n                            eta_p_51791 = defunc_0_op_res_51793;\n                        }\n                    }\n                }\n                ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_51791;\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // reduce the per-block results\n                {\n                    int32_t offset_53746;\n                    int32_t skip_waves_53747 = 1;\n                    int32_t eta_p_53731;\n                    int32_t eta_p_53732;\n                    \n                    offset_53746 = 0;\n                    // participating threads read initial accumulator\n                    {\n                        if (slt32(local_tid_53714, sext_i64_i32(seghist_tblock_sizze_51783))) {\n                          ", "  eta_p_53731 = ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53746)];\n                        }\n                    }\n                    offset_53746 = 1;\n                    while (slt32(offset_53746, wave_sizze_53716)) {\n                        if (slt32(local_tid_53714 + offset_53746, sext_i64_i32(seghist_tblock_sizze_51783)) && ((local_tid_53714 - squot32(local_tid_53714, wave_sizze_53716) * wave_sizze_53716) & (2 * offset_53746 - 1)) == 0) {\n                            // read array element\n                            {\n                                eta_p_53732 = ((volatile __local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53746)];\n                            }\n                            // apply reduction operation\n                            {\n                                int32_t defunc_0_op_res_53733 = add32(eta_p_53731, eta_p_53732);\n                                \n                                eta_p_53731 = defunc_0_op_res_53733;\n                            }\n                            // write result of operation\n                            {\n                                ((volatile __local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_53731;\n                            }\n                        }\n                        offset_53746 *= 2;\n                    }\n                    while (slt32(skip_waves_53747, squot32(sext_i64_i32(seghist_tblock_sizze_51783) + wave_sizze_53716 - 1, wave_sizze_53716))) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                        offset_53746 = skip_waves_53747 * wave_sizze_53716;\n                        if (slt32(local_tid_53714 + offset_53746, sext_i64_i32(seghist_tblock_sizze_51783)) && ((local_tid_53714 - squot32(local_tid_53714, wave_sizze_53716) * wave_sizze_53716) == 0 && (squot32(local_tid_53714, wave_sizze_53716) & (2 * skip_waves_53747 - 1)) == 0)) {\n                            // read arr", "ay element\n                            {\n                                eta_p_53732 = ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714 + offset_53746)];\n                            }\n                            // apply reduction operation\n                            {\n                                int32_t defunc_0_op_res_53733 = add32(eta_p_53731, eta_p_53732);\n                                \n                                eta_p_53731 = defunc_0_op_res_53733;\n                            }\n                            // write result of operation\n                            {\n                                ((__local int32_t *) red_arr_i32_mem_53718)[sext_i32_i64(local_tid_53714)] = eta_p_53731;\n                            }\n                        }\n                        skip_waves_53747 *= 2;\n                    }\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                    // and back to memory with the final result\n                    {\n                        if (local_tid_53714 == 0) {\n                            ((__global int32_t *) mem_52679)[bucket_id_53672] = eta_p_53731;\n                        }\n                    }\n                }\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_6:\n    return;\n    #undef seghist_tblock_sizze_51783\n    #undef chunk_sizze_53675\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_nonseg_51483_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_nonseg_51483(__global int *global_failure, int64_t dim_29479, int64_t n_29482, unsigned char cond_47437_bits, int64_t num_tblocks_51477, unsigned char x_52551_bits, int64_t num_threads_53122, int64_t num_threads_53250, __global unsigned char *start_of_grid_partition_mem_52566, __global unsigned char *xs_mem_52567, __global unsigned char *mem_52577, __global unsigned char *mem_52578, __global unsigned char *color_52936, __global unsigned char *counters_mem_53224, __global unsign",
                                    "ed char *segred_tmp_mem_53246, __global unsigned char *segred_tmp_mem_53248)\n{\n    bool cond_47437 = cond_47437_bits;\n    bool x_52551 = x_52551_bits;\n    \n    #define segred_tblock_sizze_51475 (skyline_slice_and_dice_floatzisegred_nonseg_51483zisegred_tblock_sizze_51475)\n    #define chunk_sizze_53223 (skyline_slice_and_dice_floatzisegred_nonseg_51483zichunk_sizze_53223)\n    \n    volatile __local unsigned char *sync_arr_mem_53260_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_53260_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f32_mem_53258_backing_1 = &shared_mem[sync_arr_mem_53260_backing_2_offset];\n    const int64_t red_arr_f32_mem_53258_backing_1_offset = sync_arr_mem_53260_backing_2_offset + ((int64_t) 4 * segred_tblock_sizze_51475 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_51475, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_53256_backing_0 = &shared_mem[red_arr_f32_mem_53258_backing_1_offset];\n    const int64_t red_arr_i64_mem_53256_backing_0_offset = red_arr_f32_mem_53258_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_51475 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_51475, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53252;\n    int32_t tblock_sizze_53255;\n    int32_t wave_sizze_53254;\n    int32_t block_id_53253;\n    int32_t global_tid_53251;\n    int64_t phys_tid_51483;\n    __local unsigned char *red_arr_i64_mem_53256;\n    __local unsigned char *red_arr_f32_mem_53258;\n    __local unsigned char *sync_arr_mem_53260;\n    int64_t dummy_51481;\n    int64_t gtid_51482;\n    int64_t q_53262;\n    int64_t eta_p_block_res_acc_53263;\n    float eta_p_block_res_acc_53264;\n    int64_t eta_p_47456;\n    float eta_p_47457;\n    int64_t eta_p_47458;\n    float eta_p_47459;\n    int64_t tblock_id_in_segment_53278;\n    int64_t block_base_offset_53279;\n    int32_t offset_53285;\n    int32_t skip_waves_53286", ";\n    int64_t eta_p_53265;\n    float eta_p_53266;\n    int64_t eta_p_53267;\n    float eta_p_53268;\n    int32_t old_counter_53287;\n    bool is_last_block_53288;\n    \n    local_tid_53252 = get_local_id(0);\n    tblock_sizze_53255 = get_local_size(0);\n    wave_sizze_53254 = LOCKSTEP_WIDTH;\n    block_id_53253 = get_tblock_id(0);\n    global_tid_53251 = block_id_53253 * tblock_sizze_53255 + local_tid_53252;\n    phys_tid_51483 = sext_i32_i64(global_tid_53251);\n    red_arr_i64_mem_53256 = (__local unsigned char *) red_arr_i64_mem_53256_backing_0;\n    red_arr_f32_mem_53258 = (__local unsigned char *) red_arr_f32_mem_53258_backing_1;\n    sync_arr_mem_53260 = (__local unsigned char *) sync_arr_mem_53260_backing_2;\n    dummy_51481 = (int64_t) 0;\n    gtid_51482 = (int64_t) 0;\n    q_53262 = sdiv_up64(n_29482, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_51475 * num_tblocks_51477)) * chunk_sizze_53223);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53263 = n_29482;\n        eta_p_block_res_acc_53264 = INFINITY;\n    }\n    tblock_id_in_segment_53278 = squot64(phys_tid_51483, segred_tblock_sizze_51475);\n    block_base_offset_53279 = tblock_id_in_segment_53278 * q_53262 * segred_tblock_sizze_51475;\n    for (int64_t i_53280 = 0; i_53280 < q_53262; i_53280++) {\n        int64_t block_offset_53281 = block_base_offset_53279 + i_53280 * segred_tblock_sizze_51475;\n        \n        gtid_51482 = phys_tid_51483 + num_threads_53250 * i_53280;\n        if (slt64(gtid_51482, n_29482)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    float defunc_0_reduce_res_49182;\n                    \n                    if (x_52551) {\n                        float x_52553;\n                        float redout_52482 = 0.0F;\n                        \n                        for (int64_t i_52483 = 0; i_52483 < dim_29479; i_52483++) {\n                            float eta_p_48536 = ((__global flo", "at *) xs_mem_52567)[gtid_51482 * dim_29479 + i_52483];\n                            float eta_p_48537 = ((__global float *) start_of_grid_partition_mem_52566)[i_52483];\n                            float zm_res_48538 = eta_p_48536 - eta_p_48537;\n                            float zt_res_48540 = zm_res_48538 * zm_res_48538;\n                            float zp_res_47922 = zt_res_48540 + redout_52482;\n                            float redout_tmp_53282 = zp_res_47922;\n                            \n                            redout_52482 = redout_tmp_53282;\n                        }\n                        x_52553 = redout_52482;\n                        defunc_0_reduce_res_49182 = x_52553;\n                    } else {\n                        defunc_0_reduce_res_49182 = 0.0F;\n                    }\n                    \n                    float defunc_0_f_res_47912;\n                    \n                    if (cond_47437) {\n                        for (int64_t i_52480 = 0; i_52480 < dim_29479; i_52480++) {\n                            float eta_p_49172 = ((__global float *) xs_mem_52567)[gtid_51482 * dim_29479 + i_52480];\n                            float eta_p_49173 = ((__global float *) start_of_grid_partition_mem_52566)[i_52480];\n                            float zm_res_49174 = eta_p_49172 - eta_p_49173;\n                            float zt_res_49175 = zm_res_49174 * zm_res_49174;\n                            \n                            ((__global float *) color_52936)[phys_tid_51483 + i_52480 * num_threads_53122] = zt_res_49175;\n                        }\n                        \n                        float defunc_0_foldl_res_49177;\n                        float acc_49179 = 0.0F;\n                        \n                        for (int64_t i_49178 = 0; i_49178 < dim_29479; i_49178++) {\n                            float b_49180 = ((__global float *) color_52936)[phys_tid_51483 + i_49178 * num_threads_53122];\n                            float zp_res_49181 = acc_49179 + b_",
                                    "49180;\n                            float acc_tmp_53284 = zp_res_49181;\n                            \n                            acc_49179 = acc_tmp_53284;\n                        }\n                        defunc_0_foldl_res_49177 = acc_49179;\n                        defunc_0_f_res_47912 = defunc_0_foldl_res_49177;\n                    } else {\n                        defunc_0_f_res_47912 = defunc_0_reduce_res_49182;\n                    }\n                    // load accumulator(s)\n                    {\n                        eta_p_47456 = eta_p_block_res_acc_53263;\n                        eta_p_47457 = eta_p_block_res_acc_53264;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47458 = gtid_51482;\n                        eta_p_47459 = defunc_0_f_res_47912;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool zl_res_47460 = eta_p_47457 < eta_p_47459;\n                        bool zeze_res_47461 = eta_p_47457 == eta_p_47459;\n                        bool cond_f_res_t_res_47462 = slt64(eta_p_47456, eta_p_47458);\n                        bool x_47463 = zeze_res_47461 && cond_f_res_t_res_47462;\n                        bool x_47464 = !zl_res_47460;\n                        bool y_47465 = x_47463 && x_47464;\n                        bool cond_47466 = zl_res_47460 || y_47465;\n                        int64_t defunc_0_op_res_47467;\n                        \n                        if (cond_47466) {\n                            defunc_0_op_res_47467 = eta_p_47456;\n                        } else {\n                            defunc_0_op_res_47467 = eta_p_47458;\n                        }\n                        \n                        float defunc_0_op_res_47468;\n                        \n                        if (cond_47466) {\n                            defunc_0_op_res_47468 = eta_p_47457;\n                        } else {\n                          ", "  defunc_0_op_res_47468 = eta_p_47459;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53263 = defunc_0_op_res_47467;\n                            eta_p_block_res_acc_53264 = defunc_0_op_res_47468;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_block_res_acc_53263;\n        ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_block_res_acc_53264;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53286 = 1;\n    offset_53285 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_53252, sext_i64_i32(segred_tblock_sizze_51475))) {\n            eta_p_53265 = ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53285)];\n            eta_p_53266 = ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53285)];\n        }\n    }\n    offset_53285 = 1;\n    while (slt32(offset_53285, wave_sizze_53254)) {\n        if (slt32(local_tid_53252 + offset_53285, sext_i64_i32(segred_tblock_sizze_51475)) && ((local_tid_53252 - squot32(local_tid_53252, wave_sizze_53254) * wave_sizze_53254) & (2 * offset_53285 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_53267 = ((volatile __local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53285)];\n                eta_p_53268 = ((volatile __local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53285)];\n            }\n            // apply reduction operation\n            {\n                bool zl_res_53269 = eta_p_53266 < eta_p_53268;\n                bool zeze_res_53270 = eta_p_53266 == eta_p_53268;\n     ", "           bool cond_f_res_t_res_53271 = slt64(eta_p_53265, eta_p_53267);\n                bool x_53272 = zeze_res_53270 && cond_f_res_t_res_53271;\n                bool x_53273 = !zl_res_53269;\n                bool y_53274 = x_53272 && x_53273;\n                bool cond_53275 = zl_res_53269 || y_53274;\n                int64_t defunc_0_op_res_53276;\n                \n                if (cond_53275) {\n                    defunc_0_op_res_53276 = eta_p_53265;\n                } else {\n                    defunc_0_op_res_53276 = eta_p_53267;\n                }\n                \n                float defunc_0_op_res_53277;\n                \n                if (cond_53275) {\n                    defunc_0_op_res_53277 = eta_p_53266;\n                } else {\n                    defunc_0_op_res_53277 = eta_p_53268;\n                }\n                eta_p_53265 = defunc_0_op_res_53276;\n                eta_p_53266 = defunc_0_op_res_53277;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_53265;\n                ((volatile __local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_53266;\n            }\n        }\n        offset_53285 *= 2;\n    }\n    while (slt32(skip_waves_53286, squot32(sext_i64_i32(segred_tblock_sizze_51475) + wave_sizze_53254 - 1, wave_sizze_53254))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53285 = skip_waves_53286 * wave_sizze_53254;\n        if (slt32(local_tid_53252 + offset_53285, sext_i64_i32(segred_tblock_sizze_51475)) && ((local_tid_53252 - squot32(local_tid_53252, wave_sizze_53254) * wave_sizze_53254) == 0 && (squot32(local_tid_53252, wave_sizze_53254) & (2 * skip_waves_53286 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53267 = ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53285)];\n                eta_p_53268 = ((__local float *)",
                                    " red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53285)];\n            }\n            // apply reduction operation\n            {\n                bool zl_res_53269 = eta_p_53266 < eta_p_53268;\n                bool zeze_res_53270 = eta_p_53266 == eta_p_53268;\n                bool cond_f_res_t_res_53271 = slt64(eta_p_53265, eta_p_53267);\n                bool x_53272 = zeze_res_53270 && cond_f_res_t_res_53271;\n                bool x_53273 = !zl_res_53269;\n                bool y_53274 = x_53272 && x_53273;\n                bool cond_53275 = zl_res_53269 || y_53274;\n                int64_t defunc_0_op_res_53276;\n                \n                if (cond_53275) {\n                    defunc_0_op_res_53276 = eta_p_53265;\n                } else {\n                    defunc_0_op_res_53276 = eta_p_53267;\n                }\n                \n                float defunc_0_op_res_53277;\n                \n                if (cond_53275) {\n                    defunc_0_op_res_53277 = eta_p_53266;\n                } else {\n                    defunc_0_op_res_53277 = eta_p_53268;\n                }\n                eta_p_53265 = defunc_0_op_res_53276;\n                eta_p_53266 = defunc_0_op_res_53277;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_53265;\n                ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_53266;\n            }\n        }\n        skip_waves_53286 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53252) == (int64_t) 0) {\n            eta_p_block_res_acc_53263 = eta_p_53265;\n            eta_p_block_res_acc_53264 = eta_p_53266;\n        } else {\n            eta_p_block_res_acc_53263 = n_29482;\n            eta_p_block_res_acc_53264 = INFINITY;\n        }\n    }\n    // first thread i", "n block saves block result to global memory\n    {\n        if (local_tid_53252 == 0) {\n            ((__global int64_t *) segred_tmp_mem_53246)[sext_i32_i64(block_id_53253)] = eta_p_block_res_acc_53263;\n            mem_fence_global();\n            ((__global float *) segred_tmp_mem_53248)[sext_i32_i64(block_id_53253)] = eta_p_block_res_acc_53264;\n            mem_fence_global();\n            old_counter_53287 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53224)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53260)[(int64_t) 0] = old_counter_53287 == sext_i64_i32(num_tblocks_51477 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53288 = ((__local bool *) sync_arr_mem_53260)[(int64_t) 0];\n    if (is_last_block_53288) {\n        if (local_tid_53252 == 0) {\n            old_counter_53287 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53224)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_51477));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53289 = sdiv_up64(num_tblocks_51477, segred_tblock_sizze_51475);\n            \n            eta_p_47456 = n_29482;\n            eta_p_47457 = INFINITY;\n            for (int64_t i_53290 = 0; i_53290 < read_per_thread_53289; i_53290++) {\n                int64_t block_res_id_53291 = sext_i32_i64(local_tid_53252) * read_per_thread_53289 + i_53290;\n                int64_t index_of_block_res_53292 = block_res_id_53291;\n                \n                if (slt64(block_res_id_53291, num_tblocks_51477)) {\n                    eta_p_47458 = ((__global int64_t *) segred_tmp_mem_53246)[index_of_block_res_53292];\n                    eta_p_47459 = ((__global float *) segred_tmp_mem_53248)[index_of_block_res_53292];\n                    \n                    bool zl_res_47460 = eta_p_47457 < eta_p_47459;\n                    bool zeze_res_47461 = eta_p_47457 == eta_p_47459;\n             ", "       bool cond_f_res_t_res_47462 = slt64(eta_p_47456, eta_p_47458);\n                    bool x_47463 = zeze_res_47461 && cond_f_res_t_res_47462;\n                    bool x_47464 = !zl_res_47460;\n                    bool y_47465 = x_47463 && x_47464;\n                    bool cond_47466 = zl_res_47460 || y_47465;\n                    int64_t defunc_0_op_res_47467;\n                    \n                    if (cond_47466) {\n                        defunc_0_op_res_47467 = eta_p_47456;\n                    } else {\n                        defunc_0_op_res_47467 = eta_p_47458;\n                    }\n                    \n                    float defunc_0_op_res_47468;\n                    \n                    if (cond_47466) {\n                        defunc_0_op_res_47468 = eta_p_47457;\n                    } else {\n                        defunc_0_op_res_47468 = eta_p_47459;\n                    }\n                    eta_p_47456 = defunc_0_op_res_47467;\n                    eta_p_47457 = defunc_0_op_res_47468;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_47456;\n        ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_47457;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_53293;\n            int32_t skip_waves_53294 = 1;\n            int64_t eta_p_53265;\n            float eta_p_53266;\n            int64_t eta_p_53267;\n            float eta_p_53268;\n            \n            offset_53293 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_53252, sext_i64_i32(segred_tblock_sizze_51475))) {\n                    eta_p_53265 = ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53293)];\n                    eta_p_53266 = ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53293)];\n    ",
                                    "            }\n            }\n            offset_53293 = 1;\n            while (slt32(offset_53293, wave_sizze_53254)) {\n                if (slt32(local_tid_53252 + offset_53293, sext_i64_i32(segred_tblock_sizze_51475)) && ((local_tid_53252 - squot32(local_tid_53252, wave_sizze_53254) * wave_sizze_53254) & (2 * offset_53293 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53267 = ((volatile __local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53293)];\n                        eta_p_53268 = ((volatile __local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53293)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool zl_res_53269 = eta_p_53266 < eta_p_53268;\n                        bool zeze_res_53270 = eta_p_53266 == eta_p_53268;\n                        bool cond_f_res_t_res_53271 = slt64(eta_p_53265, eta_p_53267);\n                        bool x_53272 = zeze_res_53270 && cond_f_res_t_res_53271;\n                        bool x_53273 = !zl_res_53269;\n                        bool y_53274 = x_53272 && x_53273;\n                        bool cond_53275 = zl_res_53269 || y_53274;\n                        int64_t defunc_0_op_res_53276;\n                        \n                        if (cond_53275) {\n                            defunc_0_op_res_53276 = eta_p_53265;\n                        } else {\n                            defunc_0_op_res_53276 = eta_p_53267;\n                        }\n                        \n                        float defunc_0_op_res_53277;\n                        \n                        if (cond_53275) {\n                            defunc_0_op_res_53277 = eta_p_53266;\n                        } else {\n                            defunc_0_op_res_53277 = eta_p_53268;\n                        }\n                        eta_p_53265 = defunc_0_op_res_53276;\n                        eta_p_532", "66 = defunc_0_op_res_53277;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_53265;\n                        ((volatile __local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_53266;\n                    }\n                }\n                offset_53293 *= 2;\n            }\n            while (slt32(skip_waves_53294, squot32(sext_i64_i32(segred_tblock_sizze_51475) + wave_sizze_53254 - 1, wave_sizze_53254))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53293 = skip_waves_53294 * wave_sizze_53254;\n                if (slt32(local_tid_53252 + offset_53293, sext_i64_i32(segred_tblock_sizze_51475)) && ((local_tid_53252 - squot32(local_tid_53252, wave_sizze_53254) * wave_sizze_53254) == 0 && (squot32(local_tid_53252, wave_sizze_53254) & (2 * skip_waves_53294 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_53267 = ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252 + offset_53293)];\n                        eta_p_53268 = ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252 + offset_53293)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool zl_res_53269 = eta_p_53266 < eta_p_53268;\n                        bool zeze_res_53270 = eta_p_53266 == eta_p_53268;\n                        bool cond_f_res_t_res_53271 = slt64(eta_p_53265, eta_p_53267);\n                        bool x_53272 = zeze_res_53270 && cond_f_res_t_res_53271;\n                        bool x_53273 = !zl_res_53269;\n                        bool y_53274 = x_53272 && x_53273;\n                        bool cond_53275 = zl_res_53269 || y_53274;\n                        int64_t defunc_0_op_res_53276;\n                        \n                        if (cond_", "53275) {\n                            defunc_0_op_res_53276 = eta_p_53265;\n                        } else {\n                            defunc_0_op_res_53276 = eta_p_53267;\n                        }\n                        \n                        float defunc_0_op_res_53277;\n                        \n                        if (cond_53275) {\n                            defunc_0_op_res_53277 = eta_p_53266;\n                        } else {\n                            defunc_0_op_res_53277 = eta_p_53268;\n                        }\n                        eta_p_53265 = defunc_0_op_res_53276;\n                        eta_p_53266 = defunc_0_op_res_53277;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_53256)[sext_i32_i64(local_tid_53252)] = eta_p_53265;\n                        ((__local float *) red_arr_f32_mem_53258)[sext_i32_i64(local_tid_53252)] = eta_p_53266;\n                    }\n                }\n                skip_waves_53294 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53252 == 0) {\n                    ((__global int64_t *) mem_52577)[(int64_t) 0] = eta_p_53265;\n                    ((__global float *) mem_52578)[(int64_t) 0] = eta_p_53266;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_51475\n    #undef chunk_sizze_53223\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_nonseg_51662_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_nonseg_51662(__global int *global_failure, int64_t dim_29479, int64_t num_tblocks_51657, int64_t num_threads_53535, __global unsigned char *grid_partitions_per_dim_mem_52565, __global unsigned char *mem_52659, __global unsigned char *counters_mem_53531, __global unsigned char *segred_tmp_mem_53533)\n{\n    #define segred_tblock_sizze_51655 (skyline_",
                                    "slice_and_dice_floatzisegred_nonseg_51662zisegred_tblock_sizze_51655)\n    #define chunk_sizze_53530 (skyline_slice_and_dice_floatzisegred_nonseg_51662zichunk_sizze_53530)\n    \n    volatile __local unsigned char *sync_arr_mem_53543_backing_1 = &shared_mem[0];\n    const int64_t sync_arr_mem_53543_backing_1_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_bool_mem_53541_backing_0 = &shared_mem[sync_arr_mem_53543_backing_1_offset];\n    const int64_t red_arr_bool_mem_53541_backing_0_offset = sync_arr_mem_53543_backing_1_offset + (segred_tblock_sizze_51655 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_51655, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53537;\n    int32_t tblock_sizze_53540;\n    int32_t wave_sizze_53539;\n    int32_t block_id_53538;\n    int32_t global_tid_53536;\n    int64_t phys_tid_51662;\n    __local unsigned char *red_arr_bool_mem_53541;\n    __local unsigned char *sync_arr_mem_53543;\n    int64_t dummy_51660;\n    int64_t gtid_51661;\n    int64_t q_53545;\n    bool eta_p_block_res_acc_53546;\n    bool eta_p_47618;\n    bool eta_p_47619;\n    int64_t tblock_id_in_segment_53550;\n    int64_t block_base_offset_53551;\n    int32_t offset_53554;\n    int32_t skip_waves_53555;\n    bool eta_p_53547;\n    bool eta_p_53548;\n    int32_t old_counter_53556;\n    bool is_last_block_53557;\n    \n    local_tid_53537 = get_local_id(0);\n    tblock_sizze_53540 = get_local_size(0);\n    wave_sizze_53539 = LOCKSTEP_WIDTH;\n    block_id_53538 = get_tblock_id(0);\n    global_tid_53536 = block_id_53538 * tblock_sizze_53540 + local_tid_53537;\n    phys_tid_51662 = sext_i32_i64(global_tid_53536);\n    red_arr_bool_mem_53541 = (__local unsigned char *) red_arr_bool_mem_53541_backing_0;\n    sync_arr_mem_53543 = (__local unsigned char *) sync_arr_mem_53543_backing_1;\n    dummy_51660 = (int64_t) 0;\n    gtid_51661 = (int64_t) 0;\n    q_53545 = sdiv_up64(dim_29479, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_51655 * num_tblock", "s_51657)) * chunk_sizze_53530);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_53546 = 0;\n    }\n    tblock_id_in_segment_53550 = squot64(phys_tid_51662, segred_tblock_sizze_51655);\n    block_base_offset_53551 = tblock_id_in_segment_53550 * q_53545 * segred_tblock_sizze_51655;\n    for (int64_t i_53552 = 0; i_53552 < q_53545; i_53552++) {\n        int64_t block_offset_53553 = block_base_offset_53551 + i_53552 * segred_tblock_sizze_51655;\n        \n        gtid_51661 = phys_tid_51662 + num_threads_53535 * i_53552;\n        if (slt64(gtid_51661, dim_29479)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t eta_p_47799 = ((__global int64_t *) grid_partitions_per_dim_mem_52565)[gtid_51661];\n                    bool lifted_lambda_res_47800 = eta_p_47799 == (int64_t) 1;\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_47618 = eta_p_block_res_acc_53546;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_47619 = lifted_lambda_res_47800;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_op_res_47620 = eta_p_47618 || eta_p_47619;\n                        \n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_53546 = defunc_0_op_res_47620;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] = eta_p_block_res_acc_53546;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_53555 = 1;\n    offset_53554 = 0;\n    // participating threads read ", "initial accumulator\n    {\n        if (slt32(local_tid_53537, sext_i64_i32(segred_tblock_sizze_51655))) {\n            eta_p_53547 = ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53554)];\n        }\n    }\n    offset_53554 = 1;\n    while (slt32(offset_53554, wave_sizze_53539)) {\n        if (slt32(local_tid_53537 + offset_53554, sext_i64_i32(segred_tblock_sizze_51655)) && ((local_tid_53537 - squot32(local_tid_53537, wave_sizze_53539) * wave_sizze_53539) & (2 * offset_53554 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_53548 = ((volatile __local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53554)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_53549 = eta_p_53547 || eta_p_53548;\n                \n                eta_p_53547 = defunc_0_op_res_53549;\n            }\n            // write result of operation\n            {\n                ((volatile __local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] = eta_p_53547;\n            }\n        }\n        offset_53554 *= 2;\n    }\n    while (slt32(skip_waves_53555, squot32(sext_i64_i32(segred_tblock_sizze_51655) + wave_sizze_53539 - 1, wave_sizze_53539))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_53554 = skip_waves_53555 * wave_sizze_53539;\n        if (slt32(local_tid_53537 + offset_53554, sext_i64_i32(segred_tblock_sizze_51655)) && ((local_tid_53537 - squot32(local_tid_53537, wave_sizze_53539) * wave_sizze_53539) == 0 && (squot32(local_tid_53537, wave_sizze_53539) & (2 * skip_waves_53555 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_53548 = ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53554)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_op_res_53549 = eta_p_53547 || eta_p_53548;\n                \n                eta_p_53547 = d",
                                    "efunc_0_op_res_53549;\n            }\n            // write result of operation\n            {\n                ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] = eta_p_53547;\n            }\n        }\n        skip_waves_53555 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_53537) == (int64_t) 0) {\n            eta_p_block_res_acc_53546 = eta_p_53547;\n        } else {\n            eta_p_block_res_acc_53546 = 0;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_53537 == 0) {\n            ((__global bool *) segred_tmp_mem_53533)[sext_i32_i64(block_id_53538)] = eta_p_block_res_acc_53546;\n            mem_fence_global();\n            old_counter_53556 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53531)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_53543)[(int64_t) 0] = old_counter_53556 == sext_i64_i32(num_tblocks_51657 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_53557 = ((__local bool *) sync_arr_mem_53543)[(int64_t) 0];\n    if (is_last_block_53557) {\n        if (local_tid_53537 == 0) {\n            old_counter_53556 = atomic_add_i32_global(&((volatile __global int *) counters_mem_53531)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_51657));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_53558 = sdiv_up64(num_tblocks_51657, segred_tblock_sizze_51655);\n            \n            eta_p_47618 = 0;\n            for (int64_t i_53559 = 0; i_53559 < read_per_thread_53558; i_53559++) {\n                int64_t block_res_id_53560 = sext_i32_i64(local_tid_53537) * read_per_thread_53558 + i_53559;\n                int64_t index_of_block_res_53561 = block_res_id_53560;\n                \n                if (slt64(block_res_id", "_53560, num_tblocks_51657)) {\n                    eta_p_47619 = ((__global bool *) segred_tmp_mem_53533)[index_of_block_res_53561];\n                    \n                    bool defunc_0_op_res_47620 = eta_p_47618 || eta_p_47619;\n                    \n                    eta_p_47618 = defunc_0_op_res_47620;\n                }\n            }\n        }\n        ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] = eta_p_47618;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_53562;\n            int32_t skip_waves_53563 = 1;\n            bool eta_p_53547;\n            bool eta_p_53548;\n            \n            offset_53562 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_53537, sext_i64_i32(segred_tblock_sizze_51655))) {\n                    eta_p_53547 = ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53562)];\n                }\n            }\n            offset_53562 = 1;\n            while (slt32(offset_53562, wave_sizze_53539)) {\n                if (slt32(local_tid_53537 + offset_53562, sext_i64_i32(segred_tblock_sizze_51655)) && ((local_tid_53537 - squot32(local_tid_53537, wave_sizze_53539) * wave_sizze_53539) & (2 * offset_53562 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_53548 = ((volatile __local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53562)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_op_res_53549 = eta_p_53547 || eta_p_53548;\n                        \n                        eta_p_53547 = defunc_0_op_res_53549;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] =", " eta_p_53547;\n                    }\n                }\n                offset_53562 *= 2;\n            }\n            while (slt32(skip_waves_53563, squot32(sext_i64_i32(segred_tblock_sizze_51655) + wave_sizze_53539 - 1, wave_sizze_53539))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_53562 = skip_waves_53563 * wave_sizze_53539;\n                if (slt32(local_tid_53537 + offset_53562, sext_i64_i32(segred_tblock_sizze_51655)) && ((local_tid_53537 - squot32(local_tid_53537, wave_sizze_53539) * wave_sizze_53539) == 0 && (squot32(local_tid_53537, wave_sizze_53539) & (2 * skip_waves_53563 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_53548 = ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537 + offset_53562)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_op_res_53549 = eta_p_53547 || eta_p_53548;\n                        \n                        eta_p_53547 = defunc_0_op_res_53549;\n                    }\n                    // write result of operation\n                    {\n                        ((__local bool *) red_arr_bool_mem_53541)[sext_i32_i64(local_tid_53537)] = eta_p_53547;\n                    }\n                }\n                skip_waves_53563 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_53537 == 0) {\n                    ((__global bool *) mem_52659)[(int64_t) 0] = eta_p_53547;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_51655\n    #undef chunk_sizze_53530\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_small_52059_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_small_52059(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t dim_",
                                    "29479, int64_t dz2080U_29480, int64_t total_grid_no_29491, unsigned char cond_47437_bits, int64_t num_tblocks_52054, int64_t num_threads_53207, int64_t segment_sizze_nonzzero_53811, __global unsigned char *mem_52679, __global unsigned char *mem_52697, __global unsigned char *mem_52708, __global unsigned char *mem_52717, __global unsigned char *color_52943)\n{\n    bool cond_47437 = cond_47437_bits;\n    \n    #define segred_tblock_sizze_52053 (skyline_slice_and_dice_floatzisegred_small_52059zisegred_tblock_sizze_52053)\n    \n    volatile __local unsigned char *red_arr_bool_mem_53818_backing_0 = &shared_mem[0];\n    const int64_t red_arr_bool_mem_53818_backing_0_offset = 0 + (segred_tblock_sizze_52053 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_52053, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53814;\n    int32_t tblock_sizze_53817;\n    int32_t wave_sizze_53816;\n    int32_t block_id_53815;\n    int32_t global_tid_53813;\n    int64_t phys_tid_52059;\n    __local unsigned char *red_arr_bool_mem_53818;\n    int32_t phys_tblock_id_53820;\n    int32_t iterations_53821;\n    \n    local_tid_53814 = get_local_id(0);\n    tblock_sizze_53817 = get_local_size(0);\n    wave_sizze_53816 = LOCKSTEP_WIDTH;\n    block_id_53815 = get_tblock_id(0);\n    global_tid_53813 = block_id_53815 * tblock_sizze_53817 + local_tid_53814;\n    phys_tid_52059 = sext_i32_i64(global_tid_53813);\n    red_arr_bool_mem_53818 = (__local unsigned char *) red_arr_bool_mem_53818_backing_0;\n    phys_tblock_id_53820 = get_tblock_id(0);\n    iterations_53821 = sdiv_up32(sext_i64_i32(sdiv_up64(total_grid_no_29491, squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811))) - phys_tblock_id_53820, sext_i64_i32(num_tblocks_52054));\n    for (int32_t i_53822 = 0; i_53822 < iteratio", "ns_53821; i_53822++) {\n        int32_t virt_tblock_id_53823;\n        int64_t slice_53824;\n        int64_t gtid_52057;\n        int64_t remnant_53825;\n        int64_t gtid_52058;\n        \n        virt_tblock_id_53823 = phys_tblock_id_53820 + i_53822 * sext_i64_i32(num_tblocks_52054);\n        slice_53824 = total_grid_no_29491;\n        gtid_52057 = squot64(sext_i32_i64(local_tid_53814), segment_sizze_nonzzero_53811) + sext_i32_i64(virt_tblock_id_53823) * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811);\n        remnant_53825 = squot64(sext_i32_i64(local_tid_53814), segment_sizze_nonzzero_53811) + sext_i32_i64(virt_tblock_id_53823) * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811) - gtid_52057;\n        gtid_52058 = srem64(sext_i32_i64(local_tid_53814), total_grid_no_29491);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, total_grid_no_29491) && (slt64(gtid_52057, total_grid_no_29491) && slt64(sext_i32_i64(local_tid_53814), total_grid_no_29491 * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811)))) {\n                // apply map function\n                {\n                    bool y_52066 = slt64(gtid_52058, dz2080U_29480);\n                    bool index_certs_52068;\n                    \n                    if (!y_52066) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                                global_failure_args[0] = (int64_t) gtid_52058;\n                                global_failure_args[1] = (int64_t) dz2080U_29480;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    int32_t zg_lhs_52072 = ((__global int32_t *) mem_52679)[gtid_52058];\n                    bool cond_52073 = slt32(0, zg_lhs_52072);\n                    bool l", "ifted_lambda_res_52074;\n                    \n                    if (cond_52073) {\n                        bool defunc_0_sm_red_res_52076;\n                        \n                        if (cond_47437) {\n                            for (int64_t i_52541 = 0; i_52541 < dim_29479; i_52541++) {\n                                float eta_p_52079 = ((__global float *) mem_52697)[gtid_52057 + i_52541 * total_grid_no_29491];\n                                float eta_p_52080 = ((__global float *) mem_52708)[gtid_52058 + i_52541 * dz2080U_29480];\n                                bool zg_res_52081 = eta_p_52080 < eta_p_52079;\n                                \n                                ((__global bool *) color_52943)[phys_tid_52059 + i_52541 * num_threads_53207] = zg_res_52081;\n                            }\n                            \n                            bool defunc_0_foldl_res_52082;\n                            bool acc_52084 = 1;\n                            \n                            for (int64_t i_52083 = 0; i_52083 < dim_29479; i_52083++) {\n                                bool b_52085 = ((__global bool *) color_52943)[phys_tid_52059 + i_52083 * num_threads_53207];\n                                bool x_52086 = acc_52084 && b_52085;\n                                bool acc_tmp_53827 = x_52086;\n                                \n                                acc_52084 = acc_tmp_53827;\n                            }\n                            defunc_0_foldl_res_52082 = acc_52084;\n                            defunc_0_sm_red_res_52076 = defunc_0_foldl_res_52082;\n                        } else {\n                            bool defunc_0_reduce_res_52088;\n                            bool redout_52543 = 1;\n                            \n                            for (int64_t i_52544 = 0; i_52544 < dim_29479; i_52544++) {\n                                float eta_p_52089 = ((__global float *) mem_52697)[gtid_52057 + i_52544 * total_grid_no_29491];\n                   ",
                                    "             float eta_p_52090 = ((__global float *) mem_52708)[gtid_52058 + i_52544 * dz2080U_29480];\n                                bool zg_res_52091 = eta_p_52090 < eta_p_52089;\n                                bool x_52094 = zg_res_52091 && redout_52543;\n                                bool redout_tmp_53828 = x_52094;\n                                \n                                redout_52543 = redout_tmp_53828;\n                            }\n                            defunc_0_reduce_res_52088 = redout_52543;\n                            defunc_0_sm_red_res_52076 = defunc_0_reduce_res_52088;\n                        }\n                        lifted_lambda_res_52074 = defunc_0_sm_red_res_52076;\n                    } else {\n                        lifted_lambda_res_52074 = 0;\n                    }\n                    // save results to be reduced\n                    {\n                        ((__local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] = lifted_lambda_res_52074;\n                    }\n                }\n            } else {\n                ((__local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] = 0;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, total_grid_no_29491)) {\n            // perform segmented scan to imitate reduction\n            {\n                bool eta_p_52060;\n                bool eta_p_52061;\n                bool eta_p_53829;\n                bool eta_p_53830;\n                bool ltid_in_bounds_53832 = slt64(sext_i32_i64(local_tid_53814), total_grid_no_29491 * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811));\n                int32_t skip_threads_53833;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_53832) {\n                        eta_p_52061 = ((volatile __local ", "bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)];\n                        if ((local_tid_53814 - squot32(local_tid_53814, 32) * 32) == 0) {\n                            eta_p_52060 = eta_p_52061;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53833 = 1;\n                    while (slt32(skip_threads_53833, 32)) {\n                        bool thread_active_53834 = sle32(skip_threads_53833, local_tid_53814 - squot32(local_tid_53814, 32) * 32) && ltid_in_bounds_53832;\n                        \n                        if (thread_active_53834) {\n                            // read operands\n                            {\n                                eta_p_52060 = ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814) - sext_i32_i64(skip_threads_53833)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_53835 = slt64(srem64(sext_i32_i64(local_tid_53814), total_grid_no_29491), sext_i32_i64(local_tid_53814) - sext_i32_i64(local_tid_53814 - skip_threads_53833));\n                            \n                            if (thread_active_53834 && inactive_53835) {\n                                eta_p_52060 = eta_p_52061;\n                            }\n                            if (thread_active_53834) {\n                                if (!inactive_53835) {\n                                    bool defunc_0_op_res_52062 = eta_p_52060 || eta_p_52061;\n                                    \n                                    eta_p_52060 = defunc_0_op_res_52062;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_53816, skip_threads_53833)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n              ", "          }\n                        if (thread_active_53834) {\n                            // write result\n                            {\n                                ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] = eta_p_52060;\n                                eta_p_52061 = eta_p_52060;\n                            }\n                        }\n                        if (sle32(wave_sizze_53816, skip_threads_53833)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53833 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_53814 - squot32(local_tid_53814, 32) * 32) == 31 && ltid_in_bounds_53832) {\n                        ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(squot32(local_tid_53814, 32))] = eta_p_52060;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_53836;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_53814, 32) == 0 && ltid_in_bounds_53832) {\n                            eta_p_53830 = ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)];\n                            if ((local_tid_53814 - squot32(local_tid_53814, 32) * 32) == 0) {\n                                eta_p_53829 = eta_p_53830;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_53836 = 1;\n                        while (slt32(skip_threads_53836, 3",
                                    "2)) {\n                            bool thread_active_53837 = sle32(skip_threads_53836, local_tid_53814 - squot32(local_tid_53814, 32) * 32) && (squot32(local_tid_53814, 32) == 0 && ltid_in_bounds_53832);\n                            \n                            if (thread_active_53837) {\n                                // read operands\n                                {\n                                    eta_p_53829 = ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814) - sext_i32_i64(skip_threads_53836)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_53838 = slt64(srem64(sext_i32_i64(local_tid_53814 * 32 + 32 - 1), total_grid_no_29491), sext_i32_i64(local_tid_53814 * 32 + 32 - 1) - sext_i32_i64((local_tid_53814 - skip_threads_53836) * 32 + 32 - 1));\n                                \n                                if (thread_active_53837 && inactive_53838) {\n                                    eta_p_53829 = eta_p_53830;\n                                }\n                                if (thread_active_53837) {\n                                    if (!inactive_53838) {\n                                        bool defunc_0_op_res_53831 = eta_p_53829 || eta_p_53830;\n                                        \n                                        eta_p_53829 = defunc_0_op_res_53831;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_53816, skip_threads_53836)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_53837) {\n                                // write result\n                                {\n                                    ((volatile __local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] =", " eta_p_53829;\n                                    eta_p_53830 = eta_p_53829;\n                                }\n                            }\n                            if (sle32(wave_sizze_53816, skip_threads_53836)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_53836 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_53839 = squot32(local_tid_53814, 32) == 0 || !ltid_in_bounds_53832;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_53839) {\n                            eta_p_52061 = eta_p_52060;\n                            eta_p_52060 = ((__local bool *) red_arr_bool_mem_53818)[sext_i32_i64(squot32(local_tid_53814, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_53840 = slt64(srem64(sext_i32_i64(local_tid_53814), total_grid_no_29491), sext_i32_i64(local_tid_53814) - sext_i32_i64(squot32(local_tid_53814, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_53839) {\n                            if (inactive_53840) {\n                                eta_p_52060 = eta_p_52061;\n                            }\n                        }\n                        if (!no_carry_in_53839) {\n                            if (!inactive_53840) {\n                                bool defunc_0_op_res_52062 = eta_p_52060 || eta_p_52061;\n                                \n                                eta_p_52060 = defunc_0_op_res_52062;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                   ", "     if (!no_carry_in_53839) {\n                            ((__local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] = eta_p_52060;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_53814, 32) == 0 && ltid_in_bounds_53832) {\n                        ((__local bool *) red_arr_bool_mem_53818)[sext_i32_i64(local_tid_53814)] = eta_p_52061;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_53823) * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811) + sext_i32_i64(local_tid_53814), total_grid_no_29491) && slt64(sext_i32_i64(local_tid_53814), squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811))) {\n                bool tmp_53841 = ((__local bool *) red_arr_bool_mem_53818)[(sext_i32_i64(local_tid_53814) + (int64_t) 1) * segment_sizze_nonzzero_53811 - (int64_t) 1];\n                \n                ((__global bool *) mem_52717)[sext_i32_i64(virt_tblock_id_53823) * squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811) + sext_i32_i64(local_tid_53814)] = tmp_53841;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef segred_tblock_sizze_52053\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegred_small_53674_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegred_small_53674(__global int *global_failure, int64_t total_grid_no_29491, int64_t num_tblocks_51785, int64_t num_subhistos_53588, int64_t segment_sizze_nonzzero_53676, __global unsigned char *mem_52679, __global unsigned char *defunc_0_map_res_subhistos_mem_53589)\n{\n    #define seghist",
                                    "_tblock_sizze_51783 (skyline_slice_and_dice_floatzisegred_small_53674ziseghist_tblock_sizze_51783)\n    \n    volatile __local unsigned char *red_arr_i32_mem_53683_backing_0 = &shared_mem[0];\n    const int64_t red_arr_i32_mem_53683_backing_0_offset = 0 + ((int64_t) 4 * seghist_tblock_sizze_51783 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51783, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53679;\n    int32_t tblock_sizze_53682;\n    int32_t wave_sizze_53681;\n    int32_t block_id_53680;\n    int32_t global_tid_53678;\n    int64_t flat_gtid_53674;\n    __local unsigned char *red_arr_i32_mem_53683;\n    int32_t phys_tblock_id_53685;\n    int32_t iterations_53686;\n    \n    local_tid_53679 = get_local_id(0);\n    tblock_sizze_53682 = get_local_size(0);\n    wave_sizze_53681 = LOCKSTEP_WIDTH;\n    block_id_53680 = get_tblock_id(0);\n    global_tid_53678 = block_id_53680 * tblock_sizze_53682 + local_tid_53679;\n    flat_gtid_53674 = sext_i32_i64(global_tid_53678);\n    red_arr_i32_mem_53683 = (__local unsigned char *) red_arr_i32_mem_53683_backing_0;\n    phys_tblock_id_53685 = get_tblock_id(0);\n    iterations_53686 = sdiv_up32(sext_i64_i32(sdiv_up64(total_grid_no_29491, squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676))) - phys_tblock_id_53685, sext_i64_i32(num_tblocks_51785));\n    for (int32_t i_53687 = 0; i_53687 < iterations_53686; i_53687++) {\n        int32_t virt_tblock_id_53688;\n        int64_t slice_53689;\n        int64_t bucket_id_53672;\n        int64_t remnant_53690;\n        int64_t subhistogram_id_53673;\n        \n        virt_tblock_id_53688 = phys_tblock_id_53685 + i_53687 * sext_i64_i32(num_tblocks_51785);\n        slice_53689 = total_grid_no_29491;\n        bucket_id_53672 = squot64(sext_i32_i64(local_tid_53679), segment_sizze_nonzzero_53676) + sext_i32_i64(virt_tblock_id_53688) * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676);\n        remnant_53690 = squot64(", "sext_i32_i64(local_tid_53679), segment_sizze_nonzzero_53676) + sext_i32_i64(virt_tblock_id_53688) * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676) - bucket_id_53672;\n        subhistogram_id_53673 = srem64(sext_i32_i64(local_tid_53679), num_subhistos_53588);\n        // apply map function if in bounds\n        {\n            if (slt64((int64_t) 0, num_subhistos_53588) && (slt64(bucket_id_53672, total_grid_no_29491) && slt64(sext_i32_i64(local_tid_53679), num_subhistos_53588 * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676)))) {\n                // save results to be reduced\n                {\n                    int32_t tmp_53691 = ((__global int32_t *) defunc_0_map_res_subhistos_mem_53589)[subhistogram_id_53673 * total_grid_no_29491 + bucket_id_53672];\n                    \n                    ((__local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = tmp_53691;\n                }\n            } else {\n                ((__local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = 0;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (slt64((int64_t) 0, num_subhistos_53588)) {\n            // perform segmented scan to imitate reduction\n            {\n                int32_t eta_p_51791;\n                int32_t eta_p_51792;\n                int32_t eta_p_53692;\n                int32_t eta_p_53693;\n                bool ltid_in_bounds_53695 = slt64(sext_i32_i64(local_tid_53679), num_subhistos_53588 * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676));\n                int32_t skip_threads_53696;\n                \n                // read input for in-block scan\n                {\n                    if (ltid_in_bounds_53695) {\n                        eta_p_51792 = ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)];\n                        if ((local_tid_53679 - squot32(local_tid_53679, 32) * 32) == 0) {\n                            eta_p_51791 = et", "a_p_51792;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53696 = 1;\n                    while (slt32(skip_threads_53696, 32)) {\n                        bool thread_active_53697 = sle32(skip_threads_53696, local_tid_53679 - squot32(local_tid_53679, 32) * 32) && ltid_in_bounds_53695;\n                        \n                        if (thread_active_53697) {\n                            // read operands\n                            {\n                                eta_p_51791 = ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679) - sext_i32_i64(skip_threads_53696)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_53698 = slt64(srem64(sext_i32_i64(local_tid_53679), num_subhistos_53588), sext_i32_i64(local_tid_53679) - sext_i32_i64(local_tid_53679 - skip_threads_53696));\n                            \n                            if (thread_active_53697 && inactive_53698) {\n                                eta_p_51791 = eta_p_51792;\n                            }\n                            if (thread_active_53697) {\n                                if (!inactive_53698) {\n                                    int32_t defunc_0_op_res_51793 = add32(eta_p_51791, eta_p_51792);\n                                    \n                                    eta_p_51791 = defunc_0_op_res_51793;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_53681, skip_threads_53696)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53697) {\n                            // write result\n                            {\n                                ((volatile __local ",
                                    "int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = eta_p_51791;\n                                eta_p_51792 = eta_p_51791;\n                            }\n                        }\n                        if (sle32(wave_sizze_53681, skip_threads_53696)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53696 *= 2;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // last thread of block 'i' writes its result to offset 'i'\n                {\n                    if ((local_tid_53679 - squot32(local_tid_53679, 32) * 32) == 31 && ltid_in_bounds_53695) {\n                        ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(squot32(local_tid_53679, 32))] = eta_p_51791;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n                {\n                    int32_t skip_threads_53699;\n                    \n                    // read input for in-block scan\n                    {\n                        if (squot32(local_tid_53679, 32) == 0 && ltid_in_bounds_53695) {\n                            eta_p_53693 = ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)];\n                            if ((local_tid_53679 - squot32(local_tid_53679, 32) * 32) == 0) {\n                                eta_p_53692 = eta_p_53693;\n                            }\n                        }\n                    }\n                    // in-block scan (hopefully no barriers needed)\n                    {\n                        skip_threads_53699 = 1;\n                        while (slt32(skip_threads_53699, 32)) {\n                            bool thread_active_53700 = sle32(skip_threads_53699, local_tid_53679 - squot32(local_tid_53679, 32) * 32) && (squot32(local_tid_53679, 32) == 0 && l", "tid_in_bounds_53695);\n                            \n                            if (thread_active_53700) {\n                                // read operands\n                                {\n                                    eta_p_53692 = ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679) - sext_i32_i64(skip_threads_53699)];\n                                }\n                            }\n                            // perform operation\n                            {\n                                bool inactive_53701 = slt64(srem64(sext_i32_i64(local_tid_53679 * 32 + 32 - 1), num_subhistos_53588), sext_i32_i64(local_tid_53679 * 32 + 32 - 1) - sext_i32_i64((local_tid_53679 - skip_threads_53699) * 32 + 32 - 1));\n                                \n                                if (thread_active_53700 && inactive_53701) {\n                                    eta_p_53692 = eta_p_53693;\n                                }\n                                if (thread_active_53700) {\n                                    if (!inactive_53701) {\n                                        int32_t defunc_0_op_res_53694 = add32(eta_p_53692, eta_p_53693);\n                                        \n                                        eta_p_53692 = defunc_0_op_res_53694;\n                                    }\n                                }\n                            }\n                            if (sle32(wave_sizze_53681, skip_threads_53699)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            if (thread_active_53700) {\n                                // write result\n                                {\n                                    ((volatile __local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = eta_p_53692;\n                                    eta_p_53693 = eta_p_53692;\n                                }\n                            }\n                            i", "f (sle32(wave_sizze_53681, skip_threads_53699)) {\n                                barrier(CLK_LOCAL_MEM_FENCE);\n                            }\n                            skip_threads_53699 *= 2;\n                        }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                \n                bool no_carry_in_53702 = squot32(local_tid_53679, 32) == 0 || !ltid_in_bounds_53695;\n                \n                // carry-in for every block except the first\n                {\n                    // read operands\n                    {\n                        if (!no_carry_in_53702) {\n                            eta_p_51792 = eta_p_51791;\n                            eta_p_51791 = ((__local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(squot32(local_tid_53679, 32)) - (int64_t) 1];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_53703 = slt64(srem64(sext_i32_i64(local_tid_53679), num_subhistos_53588), sext_i32_i64(local_tid_53679) - sext_i32_i64(squot32(local_tid_53679, 32) * 32 - 1));\n                        \n                        if (!no_carry_in_53702) {\n                            if (inactive_53703) {\n                                eta_p_51791 = eta_p_51792;\n                            }\n                        }\n                        if (!no_carry_in_53702) {\n                            if (!inactive_53703) {\n                                int32_t defunc_0_op_res_51793 = add32(eta_p_51791, eta_p_51792);\n                                \n                                eta_p_51791 = defunc_0_op_res_51793;\n                            }\n                        }\n                    }\n                    // write final result\n                    {\n                        if (!no_carry_in_53702) {\n                            ((__local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = eta_p_51791;\n           ",
                                    "             }\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n                // restore correct values for first block\n                {\n                    if (squot32(local_tid_53679, 32) == 0 && ltid_in_bounds_53695) {\n                        ((__local int32_t *) red_arr_i32_mem_53683)[sext_i32_i64(local_tid_53679)] = eta_p_51792;\n                    }\n                }\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // save final values of segments\n        {\n            if (slt64(sext_i32_i64(virt_tblock_id_53688) * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676) + sext_i32_i64(local_tid_53679), total_grid_no_29491) && slt64(sext_i32_i64(local_tid_53679), squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676))) {\n                int32_t tmp_53704 = ((__local int32_t *) red_arr_i32_mem_53683)[(sext_i32_i64(local_tid_53679) + (int64_t) 1) * segment_sizze_nonzzero_53676 - (int64_t) 1];\n                \n                ((__global int32_t *) mem_52679)[sext_i32_i64(virt_tblock_id_53688) * squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676) + sext_i32_i64(local_tid_53679)] = tmp_53704;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_3:\n    return;\n    #undef seghist_tblock_sizze_51783\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegscan_51573_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegscan_51573(__global int *global_failure, int64_t dim_29479, int64_t n_29482, unsigned char cond_47437_bits, int64_t num_fpts_47475, unsigned char cond_47513_bits, int64_t num_tblocks_51570, unsigned char x_52545_bits, unsigned char x_52551_bits, int64_t num_threads_53130, int64_t num_virt_blocks_53317, int64_t num_virt_threads_53318, __global unsigned char *xs_mem_52567, __global unsigned char *mem_52593, __global unsigned char *mem", "_52604, __global unsigned char *mem_52642, __global unsigned char *mem_52644, __global unsigned char *color_52937, __global unsigned char *color_52938, __global unsigned char *status_flags_mem_53319, __global unsigned char *aggregates_mem_53341, __global unsigned char *incprefixes_mem_53343, __global unsigned char *global_dynid_mem_53345)\n{\n    bool cond_47437 = cond_47437_bits;\n    bool cond_47513 = cond_47513_bits;\n    bool x_52545 = x_52545_bits;\n    bool x_52551 = x_52551_bits;\n    \n    #define segscan_tblock_sizze_51568 (skyline_slice_and_dice_floatzisegscan_51573zisegscan_tblock_sizze_51568)\n    #define chunk_sizze_53316 (skyline_slice_and_dice_floatzisegscan_51573zichunk_sizze_53316)\n    \n    volatile __local unsigned char *local_mem_53355_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53355_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51568), chunk_sizze_53316 * segscan_tblock_sizze_51568 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51568), chunk_sizze_53316 * segscan_tblock_sizze_51568 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_53348;\n    int32_t tblock_sizze_53351;\n    int32_t wave_sizze_53350;\n    int32_t block_id_53349;\n    int32_t global_tid_53347;\n    int64_t phys_tid_51573;\n    int32_t chunk_sizze_32b_53352;\n    int64_t byte_offsets_53353;\n    int64_t warp_byte_offset_53354;\n    __local unsigned char *local_mem_53355;\n    int64_t trans_arr_len_53356;\n    int64_t phys_block_id_53362;\n    int64_t virtloop_bound_53363;\n    \n    local_tid_53348 = get_local_id(0);\n    tblock_sizze_53351 = get_local_size(0);\n    wave_sizze_53350 = LOCKSTEP_WIDTH;\n    block_id_53349 = get_tblock_id(0);\n    global_tid_53347 = block_id_53349 * tblock_sizze_53351 + local_tid_53348;\n    phys_tid_51573 = sext_i32_i64(global_tid_53347);\n    chunk_sizze_32b_53352 = sext_i64_i32(chunk_sizze", "_53316);\n    byte_offsets_53353 = segscan_tblock_sizze_51568 * (int64_t) 8;\n    warp_byte_offset_53354 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53355 = (__local unsigned char *) local_mem_53355_backing_0;\n    trans_arr_len_53356 = chunk_sizze_53316 * segscan_tblock_sizze_51568;\n    phys_block_id_53362 = get_tblock_id(0);\n    virtloop_bound_53363 = sdiv_up64(num_virt_blocks_53317 - phys_block_id_53362, num_tblocks_51570);\n    for (int64_t virtloop_i_53364 = 0; virtloop_i_53364 < virtloop_bound_53363; virtloop_i_53364++) {\n        int64_t dynamic_id_53365;\n        int64_t block_offset_53366;\n        int64_t sgm_idx_53367;\n        int32_t boundary_53368;\n        int32_t segsizze_compact_53369;\n        int64_t private_mem_53370[chunk_sizze_53316];\n        int64_t thd_offset_53372;\n        int64_t acc_53403;\n        int64_t prefix_53413;\n        bool block_new_sgm_53414;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53348 == 0) {\n                dynamic_id_53365 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53345)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53355)[(int64_t) 0] = dynamic_id_53365;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_53365 == num_virt_blocks_53317 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53345)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53365 = ((__local int32_t *) local_mem_53355)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53366 = dynamic_id_53365 * chunk_sizze_53316 * segscan_tblock_sizze_51568;\n        sgm_idx_53367 = smod64(block_offset_53366, n_29482);\n     ",
                                    "   boundary_53368 = sext_i64_i32(smin64(chunk_sizze_53316 * segscan_tblock_sizze_51568, n_29482 - sgm_idx_53367));\n        segsizze_compact_53369 = sext_i64_i32(smin64(chunk_sizze_53316 * segscan_tblock_sizze_51568, n_29482));\n        thd_offset_53372 = block_offset_53366 + sext_i32_i64(local_tid_53348);\n        // Load and map\n        {\n            for (int64_t i_53373 = 0; i_53373 < chunk_sizze_53316; i_53373++) {\n                int64_t virt_tid_53374 = thd_offset_53372 + i_53373 * segscan_tblock_sizze_51568;\n                int64_t slice_53375 = n_29482;\n                int64_t gtid_51572 = virt_tid_53374;\n                int64_t remnant_53376 = virt_tid_53374 - gtid_51572;\n                \n                if (slt64(virt_tid_53374, n_29482)) {\n                    bool defunc_0_reduce_res_49323;\n                    \n                    if (x_52545) {\n                        bool x_52890 = !cond_47437;\n                        bool cond_49303 = slt64(dim_29479, (int64_t) 6);\n                        bool x_52547;\n                        bool redout_52503 = 0;\n                        \n                        for (int64_t i_52504 = 0; i_52504 < num_fpts_47475; i_52504++) {\n                            bool defunc_0_reduce_res_49290;\n                            \n                            if (x_52890) {\n                                bool x_52892;\n                                bool redout_52509 = 1;\n                                \n                                for (int64_t i_52510 = 0; i_52510 < dim_29479; i_52510++) {\n                                    float eta_p_48828 = ((__global float *) xs_mem_52567)[gtid_51572 * dim_29479 + i_52510];\n                                    float eta_p_48829 = ((__global float *) mem_52593)[i_52504 + i_52510 * num_fpts_47475];\n                                    bool zgze_res_48830 = eta_p_48829 <= eta_p_48828;\n                                    bool x_48793 = zgze_res_48830 && redout_52509;\n                                  ", "  bool redout_tmp_53378 = x_48793;\n                                    \n                                    redout_52509 = redout_tmp_53378;\n                                }\n                                x_52892 = redout_52509;\n                                defunc_0_reduce_res_49290 = x_52892;\n                            } else {\n                                defunc_0_reduce_res_49290 = 0;\n                            }\n                            \n                            bool defunc_0_sm_red_res_48775;\n                            \n                            if (cond_47437) {\n                                for (int64_t i_52507 = 0; i_52507 < dim_29479; i_52507++) {\n                                    float eta_p_49281 = ((__global float *) xs_mem_52567)[gtid_51572 * dim_29479 + i_52507];\n                                    float eta_p_49282 = ((__global float *) mem_52593)[i_52504 + i_52507 * num_fpts_47475];\n                                    bool zgze_res_49283 = eta_p_49282 <= eta_p_49281;\n                                    \n                                    ((__global bool *) color_52937)[phys_tid_51573 + i_52507 * num_threads_53130] = zgze_res_49283;\n                                }\n                                \n                                bool defunc_0_foldl_res_49285;\n                                bool acc_49287 = 1;\n                                \n                                for (int64_t i_49286 = 0; i_49286 < dim_29479; i_49286++) {\n                                    bool b_49288 = ((__global bool *) color_52937)[phys_tid_51573 + i_49286 * num_threads_53130];\n                                    bool x_49289 = acc_49287 && b_49288;\n                                    bool acc_tmp_53380 = x_49289;\n                                    \n                                    acc_49287 = acc_tmp_53380;\n                                }\n                                defunc_0_foldl_res_49285 = acc_49287;\n                              ", "  defunc_0_sm_red_res_48775 = defunc_0_foldl_res_49285;\n                            } else {\n                                defunc_0_sm_red_res_48775 = defunc_0_reduce_res_49290;\n                            }\n                            \n                            bool lifted_lambda_res_48794;\n                            \n                            if (defunc_0_sm_red_res_48775) {\n                                bool defunc_0_sm_red_res_49304;\n                                \n                                if (cond_49303) {\n                                    for (int64_t i_52513 = 0; i_52513 < dim_29479; i_52513++) {\n                                        float eta_p_49306 = ((__global float *) xs_mem_52567)[gtid_51572 * dim_29479 + i_52513];\n                                        float eta_p_49307 = ((__global float *) mem_52593)[i_52504 + i_52513 * num_fpts_47475];\n                                        bool zg_res_49308 = eta_p_49307 < eta_p_49306;\n                                        \n                                        ((__global bool *) color_52937)[phys_tid_51573 + i_52513 * num_threads_53130] = zg_res_49308;\n                                    }\n                                    \n                                    bool defunc_0_foldl_res_49310;\n                                    bool acc_49312 = 0;\n                                    \n                                    for (int64_t i_49311 = 0; i_49311 < dim_29479; i_49311++) {\n                                        bool b_49313 = ((__global bool *) color_52937)[phys_tid_51573 + i_49311 * num_threads_53130];\n                                        bool defunc_0_f_res_49314 = acc_49312 || b_49313;\n                                        bool acc_tmp_53382 = defunc_0_f_res_49314;\n                                        \n                                        acc_49312 = acc_tmp_53382;\n                                    }\n                                    defunc_0_foldl_res_49310 = acc_",
                                    "49312;\n                                    defunc_0_sm_red_res_49304 = defunc_0_foldl_res_49310;\n                                } else {\n                                    bool defunc_0_reduce_res_49315;\n                                    bool redout_52515 = 0;\n                                    \n                                    for (int64_t i_52516 = 0; i_52516 < dim_29479; i_52516++) {\n                                        float eta_p_49316 = ((__global float *) xs_mem_52567)[gtid_51572 * dim_29479 + i_52516];\n                                        float eta_p_49317 = ((__global float *) mem_52593)[i_52504 + i_52516 * num_fpts_47475];\n                                        bool zg_res_49318 = eta_p_49317 < eta_p_49316;\n                                        bool defunc_0_op_res_49321 = zg_res_49318 || redout_52515;\n                                        bool redout_tmp_53383 = defunc_0_op_res_49321;\n                                        \n                                        redout_52515 = redout_tmp_53383;\n                                    }\n                                    defunc_0_reduce_res_49315 = redout_52515;\n                                    defunc_0_sm_red_res_49304 = defunc_0_reduce_res_49315;\n                                }\n                                lifted_lambda_res_48794 = defunc_0_sm_red_res_49304;\n                            } else {\n                                lifted_lambda_res_48794 = 0;\n                            }\n                            \n                            bool defunc_0_op_res_47861 = lifted_lambda_res_48794 || redout_52503;\n                            bool redout_tmp_53377 = defunc_0_op_res_47861;\n                            \n                            redout_52503 = redout_tmp_53377;\n                        }\n                        x_52547 = redout_52503;\n                        defunc_0_reduce_res_49323 = x_52547;\n                    } else {\n                        defunc_0_reduce_res_4932", "3 = 0;\n                    }\n                    \n                    bool defunc_0_f_res_47851;\n                    \n                    if (cond_47513) {\n                        for (int64_t i_52489 = 0; i_52489 < num_fpts_47475; i_52489++) {\n                            bool defunc_0_reduce_res_49244;\n                            \n                            if (x_52551) {\n                                bool x_52869;\n                                bool redout_52495 = 1;\n                                \n                                for (int64_t i_52496 = 0; i_52496 < dim_29479; i_52496++) {\n                                    float eta_p_49245 = ((__global float *) mem_52604)[gtid_51572 + i_52496 * n_29482];\n                                    float eta_p_49246 = ((__global float *) mem_52593)[i_52489 + i_52496 * num_fpts_47475];\n                                    bool zgze_res_49247 = eta_p_49246 <= eta_p_49245;\n                                    bool x_49250 = zgze_res_49247 && redout_52495;\n                                    bool redout_tmp_53385 = x_49250;\n                                    \n                                    redout_52495 = redout_tmp_53385;\n                                }\n                                x_52869 = redout_52495;\n                                defunc_0_reduce_res_49244 = x_52869;\n                            } else {\n                                defunc_0_reduce_res_49244 = 0;\n                            }\n                            \n                            bool defunc_0_sm_red_res_49233;\n                            \n                            if (cond_47437) {\n                                for (int64_t i_52493 = 0; i_52493 < dim_29479; i_52493++) {\n                                    float eta_p_49235 = ((__global float *) xs_mem_52567)[gtid_51572 * dim_29479 + i_52493];\n                                    float eta_p_49236 = ((__global float *) mem_52593)[i_52489 + i_52493 * num_fpts_47475];\n               ", "                     bool zgze_res_49237 = eta_p_49236 <= eta_p_49235;\n                                    \n                                    ((__global bool *) color_52937)[phys_tid_51573 + i_52493 * num_threads_53130] = zgze_res_49237;\n                                }\n                                \n                                bool defunc_0_foldl_res_49239;\n                                bool acc_49241 = 1;\n                                \n                                for (int64_t i_49240 = 0; i_49240 < dim_29479; i_49240++) {\n                                    bool b_49242 = ((__global bool *) color_52937)[phys_tid_51573 + i_49240 * num_threads_53130];\n                                    bool x_49243 = acc_49241 && b_49242;\n                                    bool acc_tmp_53387 = x_49243;\n                                    \n                                    acc_49241 = acc_tmp_53387;\n                                }\n                                defunc_0_foldl_res_49239 = acc_49241;\n                                defunc_0_sm_red_res_49233 = defunc_0_foldl_res_49239;\n                            } else {\n                                defunc_0_sm_red_res_49233 = defunc_0_reduce_res_49244;\n                            }\n                            \n                            bool lifted_lambda_res_49252;\n                            \n                            if (defunc_0_sm_red_res_49233) {\n                                bool defunc_0_sm_red_res_49254;\n                                \n                                if (cond_47437) {\n                                    for (int64_t i_52499 = 0; i_52499 < dim_29479; i_52499++) {\n                                        float eta_p_49256 = ((__global float *) mem_52604)[gtid_51572 + i_52499 * n_29482];\n                                        float eta_p_49257 = ((__global float *) mem_52593)[i_52489 + i_52499 * num_fpts_47475];\n                                        bool zg_res_49258 = eta_p_49",
                                    "257 < eta_p_49256;\n                                        \n                                        ((__global bool *) color_52937)[phys_tid_51573 + i_52499 * num_threads_53130] = zg_res_49258;\n                                    }\n                                    \n                                    bool defunc_0_foldl_res_49260;\n                                    bool acc_49262 = 0;\n                                    \n                                    for (int64_t i_49261 = 0; i_49261 < dim_29479; i_49261++) {\n                                        bool b_49263 = ((__global bool *) color_52937)[phys_tid_51573 + i_49261 * num_threads_53130];\n                                        bool defunc_0_f_res_49264 = acc_49262 || b_49263;\n                                        bool acc_tmp_53389 = defunc_0_f_res_49264;\n                                        \n                                        acc_49262 = acc_tmp_53389;\n                                    }\n                                    defunc_0_foldl_res_49260 = acc_49262;\n                                    defunc_0_sm_red_res_49254 = defunc_0_foldl_res_49260;\n                                } else {\n                                    bool defunc_0_reduce_res_49265;\n                                    bool redout_52501 = 0;\n                                    \n                                    for (int64_t i_52502 = 0; i_52502 < dim_29479; i_52502++) {\n                                        float eta_p_49266 = ((__global float *) mem_52604)[gtid_51572 + i_52502 * n_29482];\n                                        float eta_p_49267 = ((__global float *) mem_52593)[i_52489 + i_52502 * num_fpts_47475];\n                                        bool zg_res_49268 = eta_p_49267 < eta_p_49266;\n                                        bool defunc_0_op_res_49271 = zg_res_49268 || redout_52501;\n                                        bool redout_tmp_53390 = defunc_0_op_res_49271;\n                                ", "        \n                                        redout_52501 = redout_tmp_53390;\n                                    }\n                                    defunc_0_reduce_res_49265 = redout_52501;\n                                    defunc_0_sm_red_res_49254 = defunc_0_reduce_res_49265;\n                                }\n                                lifted_lambda_res_49252 = defunc_0_sm_red_res_49254;\n                            } else {\n                                lifted_lambda_res_49252 = 0;\n                            }\n                            ((__global bool *) color_52938)[phys_tid_51573 + i_52489 * num_threads_53130] = lifted_lambda_res_49252;\n                        }\n                        \n                        bool defunc_0_foldl_res_49274;\n                        bool acc_49276 = 0;\n                        \n                        for (int64_t i_49275 = 0; i_49275 < num_fpts_47475; i_49275++) {\n                            bool b_49277 = ((__global bool *) color_52938)[phys_tid_51573 + i_49275 * num_threads_53130];\n                            bool defunc_0_f_res_49278 = acc_49276 || b_49277;\n                            bool acc_tmp_53391 = defunc_0_f_res_49278;\n                            \n                            acc_49276 = acc_tmp_53391;\n                        }\n                        defunc_0_foldl_res_49274 = acc_49276;\n                        defunc_0_f_res_47851 = defunc_0_foldl_res_49274;\n                    } else {\n                        defunc_0_f_res_47851 = defunc_0_reduce_res_49323;\n                    }\n                    \n                    bool lifted_lambda_res_47863 = !defunc_0_f_res_47851;\n                    int64_t defunc_0_f_res_47864 = btoi_bool_i64(lifted_lambda_res_47863);\n                    \n                    ((__global int64_t *) mem_52644)[gtid_51572] = defunc_0_f_res_47864;\n                    private_mem_53370[i_53373] = defunc_0_f_res_47864;\n                } else {\n                    private_mem_53", "370[i_53373] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53392 = 0; i_53392 < chunk_sizze_53316; i_53392++) {\n                int64_t sharedIdx_53393 = sext_i32_i64(local_tid_53348) + i_53392 * segscan_tblock_sizze_51568;\n                int64_t tmp_53394 = private_mem_53370[i_53392];\n                \n                ((__local int64_t *) local_mem_53355)[sharedIdx_53393] = tmp_53394;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53395 = 0; i_53395 < chunk_sizze_53316; i_53395++) {\n                int64_t sharedIdx_53396 = sext_i32_i64(local_tid_53348) * chunk_sizze_53316 + i_53395;\n                int64_t tmp_53397 = ((__local int64_t *) local_mem_53355)[sharedIdx_53396];\n                \n                private_mem_53370[i_53395] = tmp_53397;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53398 = 0; i_53398 < chunk_sizze_53316 - (int64_t) 1; i_53398++) {\n                int64_t eta_p_47568;\n                int64_t eta_p_47569;\n                \n                eta_p_47568 = private_mem_53370[i_53398];\n                eta_p_47569 = private_mem_53370[i_53398 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_47570 = add64(eta_p_47568, eta_p_47569);\n                \n                private_mem_53370[i_53398 + (int64_t) 1] = defunc_0_op_res_47570;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53399 = private_mem_53370[chunk_sizze_53316 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = tmp_53399;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53400;\n            int64_t eta_p_53401;\n            int64_t eta_p_53404;\n  ",
                                    "          int64_t eta_p_53405;\n            bool ltid_in_bounds_53407 = slt64(sext_i32_i64(local_tid_53348), num_virt_threads_53318);\n            int32_t skip_threads_53408;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53407) {\n                    eta_p_53401 = ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)];\n                    if ((local_tid_53348 - squot32(local_tid_53348, 32) * 32) == 0) {\n                        eta_p_53400 = eta_p_53401;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53408 = 1;\n                while (slt32(skip_threads_53408, 32)) {\n                    bool thread_active_53409 = sle32(skip_threads_53408, local_tid_53348 - squot32(local_tid_53348, 32) * 32) && ltid_in_bounds_53407;\n                    \n                    if (thread_active_53409) {\n                        // read operands\n                        {\n                            eta_p_53400 = ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348) - sext_i32_i64(skip_threads_53408)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53409) {\n                            int64_t defunc_0_op_res_53402 = add64(eta_p_53400, eta_p_53401);\n                            \n                            eta_p_53400 = defunc_0_op_res_53402;\n                        }\n                    }\n                    if (sle32(wave_sizze_53350, skip_threads_53408)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53409) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = eta_p_53400;\n                  ", "          eta_p_53401 = eta_p_53400;\n                        }\n                    }\n                    if (sle32(wave_sizze_53350, skip_threads_53408)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53408 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53348 - squot32(local_tid_53348, 32) * 32) == 31 && ltid_in_bounds_53407) {\n                    ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(squot32(local_tid_53348, 32))] = eta_p_53400;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53410;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53348, 32) == 0 && ltid_in_bounds_53407) {\n                        eta_p_53405 = ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)];\n                        if ((local_tid_53348 - squot32(local_tid_53348, 32) * 32) == 0) {\n                            eta_p_53404 = eta_p_53405;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53410 = 1;\n                    while (slt32(skip_threads_53410, 32)) {\n                        bool thread_active_53411 = sle32(skip_threads_53410, local_tid_53348 - squot32(local_tid_53348, 32) * 32) && (squot32(local_tid_53348, 32) == 0 && ltid_in_bounds_53407);\n                        \n                        if (thread_active_53411) {\n                            // read operands\n                            {\n                                eta_p_53404 = ((volatile __local int64_t *) l", "ocal_mem_53355)[sext_i32_i64(local_tid_53348) - sext_i32_i64(skip_threads_53410)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53411) {\n                                int64_t defunc_0_op_res_53406 = add64(eta_p_53404, eta_p_53405);\n                                \n                                eta_p_53404 = defunc_0_op_res_53406;\n                            }\n                        }\n                        if (sle32(wave_sizze_53350, skip_threads_53410)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53411) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = eta_p_53404;\n                                eta_p_53405 = eta_p_53404;\n                            }\n                        }\n                        if (sle32(wave_sizze_53350, skip_threads_53410)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_53410 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53412 = squot32(local_tid_53348, 32) == 0 || !ltid_in_bounds_53407;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53412) {\n                        eta_p_53401 = eta_p_53400;\n                        eta_p_53400 = ((__local int64_t *) local_mem_53355)[sext_i32_i64(squot32(local_tid_53348, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53412) {\n                        int64_t de",
                                    "func_0_op_res_53402 = add64(eta_p_53400, eta_p_53401);\n                        \n                        eta_p_53400 = defunc_0_op_res_53402;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53412) {\n                        ((__local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = eta_p_53400;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53348, 32) == 0 && ltid_in_bounds_53407) {\n                    ((__local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = eta_p_53401;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53348 == 0) {\n                acc_53403 = ((__local int64_t *) local_mem_53355)[segscan_tblock_sizze_51568 - (int64_t) 1];\n            } else {\n                acc_53403 = ((__local int64_t *) local_mem_53355)[sext_i32_i64(local_tid_53348) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_53413 = (int64_t) 0;\n        block_new_sgm_53414 = sgm_idx_53367 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53414 && local_tid_53348 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53343)[dynamic_id_53365] = acc_53403;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53319)[dynamic_id_53365] = (int8_t) 2;\n                acc_53403 = (int64_t) 0;\n            }\n            if (!block_new_sgm_53414 && slt32(local_tid_53348, wave_sizze_53350)) {\n                if (local_tid_53348 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53341)[dynamic_id_53365] = acc_53403;\n                    mem_fence_global();\n                    ((volatile __", "global int8_t *) status_flags_mem_53319)[dynamic_id_53365] = (int8_t) 1;\n                    \n                    int8_t tmp_53415 = ((volatile __global int8_t *) status_flags_mem_53319)[dynamic_id_53365 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53355)[(int64_t) 0] = tmp_53415;\n                }\n                mem_fence_local();\n                \n                int8_t status_53416 = ((__local int8_t *) local_mem_53355)[(int64_t) 0];\n                \n                if (status_53416 == (int8_t) 2) {\n                    if (local_tid_53348 == 0) {\n                        prefix_53413 = ((volatile __global int64_t *) incprefixes_mem_53343)[dynamic_id_53365 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53417 = sext_i64_i32(dynamic_id_53365 - sext_i32_i64(wave_sizze_53350));\n                    \n                    while (slt32(wave_sizze_53350 * -1, readOffset_53417)) {\n                        int32_t read_i_53418 = readOffset_53417 + local_tid_53348;\n                        int64_t aggr_53419 = (int64_t) 0;\n                        int8_t flag_53420 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_53418)) {\n                            flag_53420 = ((volatile __global int8_t *) status_flags_mem_53319)[sext_i32_i64(read_i_53418)];\n                            if (flag_53420 == (int8_t) 2) {\n                                aggr_53419 = ((volatile __global int64_t *) incprefixes_mem_53343)[sext_i32_i64(read_i_53418)];\n                            } else if (flag_53420 == (int8_t) 1) {\n                                aggr_53419 = ((volatile __global int64_t *) aggregates_mem_53341)[sext_i32_i64(read_i_53418)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53355)[(int64_t) 4 + sext_i32_i64(local_tid_53348)] = aggr_53419;\n                        ((__local int8_t *) local_m", "em_53355)[sext_i32_i64(local_tid_53348)] = flag_53420;\n                        flag_53420 = ((__local int8_t *) local_mem_53355)[sext_i32_i64(wave_sizze_53350) - (int64_t) 1];\n                        if (slt8(flag_53420, (int8_t) 2)) {\n                            int8_t flg_x_53424;\n                            int8_t flg_y_53425;\n                            int64_t eta_p_53421;\n                            int64_t eta_p_53422;\n                            int32_t skip_threads_53426;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53425 = ((volatile __local int8_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)];\n                                eta_p_53422 = ((volatile __local int64_t *) local_mem_53355)[(int64_t) 4 + sext_i32_i64(local_tid_53348)];\n                                if ((local_tid_53348 - squot32(local_tid_53348, 32) * 32) == 0) {\n                                    eta_p_53421 = eta_p_53422;\n                                    flg_x_53424 = flg_y_53425;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53426 = 1;\n                                while (slt32(skip_threads_53426, 32)) {\n                                    if (sle32(skip_threads_53426, local_tid_53348 - squot32(local_tid_53348, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53424 = ((volatile __local int8_t *) local_mem_53355)[sext_i32_i64(local_tid_53348) - sext_i32_i64(skip_threads_53426)];\n                                            eta_p_53421 = ((volatile __local int64_t *) local_mem_53355)[(int64_t) 4 + (sext_i32_i64(local_tid_53348) - sext_i32_i64(skip_threads_53426))];\n                              ",
                                    "          }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53425 == (int8_t) 2 || flg_y_53425 == (int8_t) 0) {\n                                                flg_x_53424 = flg_y_53425;\n                                                eta_p_53421 = eta_p_53422;\n                                            } else {\n                                                int64_t defunc_0_op_res_53423 = add64(eta_p_53421, eta_p_53422);\n                                                \n                                                eta_p_53421 = defunc_0_op_res_53423;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53355)[sext_i32_i64(local_tid_53348)] = flg_x_53424;\n                                            flg_y_53425 = flg_x_53424;\n                                            ((volatile __local int64_t *) local_mem_53355)[(int64_t) 4 + sext_i32_i64(local_tid_53348)] = eta_p_53421;\n                                            eta_p_53422 = eta_p_53421;\n                                        }\n                                    }\n                                    skip_threads_53426 *= 2;\n                                }\n                            }\n                        }\n                        flag_53420 = ((__local int8_t *) local_mem_53355)[sext_i32_i64(wave_sizze_53350) - (int64_t) 1];\n                        aggr_53419 = ((__local int64_t *) local_mem_53355)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53350) - (int64_t) 1)];\n                        if (flag_53420 == (int8_t) 2) {\n                            readOffset_53417 = wave_sizze_53350 * -1;\n                        } else if (flag_53420 == (int8_t) 1) {\n                            readOff", "set_53417 -= wave_sizze_53350;\n                        }\n                        if (slt8((int8_t) 0, flag_53420)) {\n                            int64_t eta_p_53427 = aggr_53419;\n                            int64_t eta_p_53428 = prefix_53413;\n                            int64_t defunc_0_op_res_53429 = add64(eta_p_53427, eta_p_53428);\n                            \n                            prefix_53413 = defunc_0_op_res_53429;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53348 == 0) {\n                    if (boundary_53368 == sext_i64_i32(segscan_tblock_sizze_51568 * chunk_sizze_53316)) {\n                        int64_t eta_p_53430 = prefix_53413;\n                        int64_t eta_p_53431 = acc_53403;\n                        int64_t defunc_0_op_res_53432 = add64(eta_p_53430, eta_p_53431);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53343)[dynamic_id_53365] = defunc_0_op_res_53432;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53319)[dynamic_id_53365] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53355)[(int64_t) 4] = prefix_53413;\n                    acc_53403 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_53365 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53413 = ((__local int64_t *) local_mem_53355)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53433;\n            int64_t eta_p_53434;\n            int64_t eta_p_53436 = prefix_53413;\n            int64_t eta_p_53437 = acc_53403;\n            \n            if (slt32(local_tid_53348 * chunk_sizze_32b_53352, boundary_53368) && !block_new_sgm_53414) {\n                int64_t defunc_0_op_res_53438 =", " add64(eta_p_53436, eta_p_53437);\n                \n                eta_p_53433 = defunc_0_op_res_53438;\n            } else {\n                eta_p_53433 = acc_53403;\n            }\n            \n            int32_t stopping_point_53439 = segsizze_compact_53369 - srem32(local_tid_53348 * chunk_sizze_32b_53352 - 1 + segsizze_compact_53369 - boundary_53368, segsizze_compact_53369);\n            \n            for (int64_t i_53440 = 0; i_53440 < chunk_sizze_53316; i_53440++) {\n                if (slt32(sext_i64_i32(i_53440), stopping_point_53439 - 1)) {\n                    eta_p_53434 = private_mem_53370[i_53440];\n                    \n                    int64_t defunc_0_op_res_53435 = add64(eta_p_53433, eta_p_53434);\n                    \n                    private_mem_53370[i_53440] = defunc_0_op_res_53435;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53441 = 0; i_53441 < chunk_sizze_53316; i_53441++) {\n                int64_t sharedIdx_53442 = sext_i32_i64(local_tid_53348) * chunk_sizze_53316 + i_53441;\n                int64_t tmp_53443 = private_mem_53370[i_53441];\n                \n                ((__local int64_t *) local_mem_53355)[sharedIdx_53442] = tmp_53443;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53444 = 0; i_53444 < chunk_sizze_53316; i_53444++) {\n                int64_t flat_idx_53445 = thd_offset_53372 + i_53444 * segscan_tblock_sizze_51568;\n                int64_t slice_53446 = n_29482;\n                int64_t gtid_51572 = flat_idx_53445;\n                int64_t remnant_53447 = flat_idx_53445 - gtid_51572;\n                \n                if (slt64(flat_idx_53445, n_29482)) {\n                    int64_t tmp_53448 = ((__local int64_t *) local_mem_53355)[flat_idx_53445 - block_offset_53366];\n                    \n                    ((__global int64_t *) mem_52642)[gtid_51572] = tmp_53448;\n               ",
                                    " }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_51568\n    #undef chunk_sizze_53316\n}\nFUTHARK_KERNEL_SIZED(skyline_slice_and_dice_floatzisegscan_52104_dim1, 1, 1)\nvoid skyline_slice_and_dice_floatzisegscan_52104(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t total_grid_no_29491, int64_t m_47581, int64_t num_tblocks_52101, int64_t num_virt_blocks_53895, int64_t num_virt_threads_53896, __global unsigned char *mem_52677, __global unsigned char *ext_mem_52761, __global unsigned char *mem_52769, __global unsigned char *mem_52771, __global unsigned char *status_flags_mem_53897, __global unsigned char *aggregates_mem_53899, __global unsigned char *incprefixes_mem_53901, __global unsigned char *global_dynid_mem_53903)\n{\n    #define segscan_tblock_sizze_52099 (skyline_slice_and_dice_floatzisegscan_52104zisegscan_tblock_sizze_52099)\n    #define chunk_sizze_53894 (skyline_slice_and_dice_floatzisegscan_52104zichunk_sizze_53894)\n    \n    volatile __local unsigned char *local_mem_53913_backing_0 = &shared_mem[0];\n    const int64_t local_mem_53913_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_52099), chunk_sizze_53894 * segscan_tblock_sizze_52099 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_52099), chunk_sizze_53894 * segscan_tblock_sizze_52099 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_53906;\n    int32_t tblock_sizze_53909;\n    int32_t wave_sizze_53908;\n    int32_t block_id_53907;\n    int32_t global_tid_53905;\n    int64_t phys_tid_52104;\n    int32_t chunk_sizze_32b_53910;\n    int6", "4_t byte_offsets_53911;\n    int64_t warp_byte_offset_53912;\n    __local unsigned char *local_mem_53913;\n    int64_t trans_arr_len_53914;\n    int64_t phys_block_id_53920;\n    int64_t virtloop_bound_53921;\n    \n    local_tid_53906 = get_local_id(0);\n    tblock_sizze_53909 = get_local_size(0);\n    wave_sizze_53908 = LOCKSTEP_WIDTH;\n    block_id_53907 = get_tblock_id(0);\n    global_tid_53905 = block_id_53907 * tblock_sizze_53909 + local_tid_53906;\n    phys_tid_52104 = sext_i32_i64(global_tid_53905);\n    chunk_sizze_32b_53910 = sext_i64_i32(chunk_sizze_53894);\n    byte_offsets_53911 = segscan_tblock_sizze_52099 * (int64_t) 8;\n    warp_byte_offset_53912 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_53913 = (__local unsigned char *) local_mem_53913_backing_0;\n    trans_arr_len_53914 = chunk_sizze_53894 * segscan_tblock_sizze_52099;\n    phys_block_id_53920 = get_tblock_id(0);\n    virtloop_bound_53921 = sdiv_up64(num_virt_blocks_53895 - phys_block_id_53920, num_tblocks_52101);\n    for (int64_t virtloop_i_53922 = 0; virtloop_i_53922 < virtloop_bound_53921; virtloop_i_53922++) {\n        int64_t dynamic_id_53923;\n        int64_t block_offset_53924;\n        int64_t sgm_idx_53925;\n        int32_t boundary_53926;\n        int32_t segsizze_compact_53927;\n        int64_t private_mem_53928[chunk_sizze_53894];\n        int64_t thd_offset_53930;\n        int64_t acc_53946;\n        int64_t prefix_53956;\n        bool block_new_sgm_53957;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_53906 == 0) {\n                dynamic_id_53923 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_53903)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_53913)[(int64_t) 0] = dynamic_id_53923;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {", "\n                    if (dynamic_id_53923 == num_virt_blocks_53895 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_53903)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_53923 = ((__local int32_t *) local_mem_53913)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_53924 = dynamic_id_53923 * chunk_sizze_53894 * segscan_tblock_sizze_52099;\n        sgm_idx_53925 = smod64(block_offset_53924, m_47581);\n        boundary_53926 = sext_i64_i32(smin64(chunk_sizze_53894 * segscan_tblock_sizze_52099, m_47581 - sgm_idx_53925));\n        segsizze_compact_53927 = sext_i64_i32(smin64(chunk_sizze_53894 * segscan_tblock_sizze_52099, m_47581));\n        thd_offset_53930 = block_offset_53924 + sext_i32_i64(local_tid_53906);\n        // Load and map\n        {\n            for (int64_t i_53931 = 0; i_53931 < chunk_sizze_53894; i_53931++) {\n                int64_t virt_tid_53932 = thd_offset_53930 + i_53931 * segscan_tblock_sizze_52099;\n                int64_t slice_53933 = m_47581;\n                int64_t gtid_52103 = virt_tid_53932;\n                int64_t remnant_53934 = virt_tid_53932 - gtid_52103;\n                \n                if (slt64(virt_tid_53932, m_47581)) {\n                    int64_t eta_p_48147 = ((__global int64_t *) mem_52677)[gtid_52103];\n                    bool x_48148 = sle64((int64_t) 0, eta_p_48147);\n                    bool y_48149 = slt64(eta_p_48147, total_grid_no_29491);\n                    bool bounds_check_48150 = x_48148 && y_48149;\n                    bool index_certs_48151;\n                    \n                    if (!bounds_check_48150) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                                global_failure_args[0] = (int64_t) eta_p_48147;\n                                global_failure_args[1] = (int64_t) total_grid_no_2",
                                    "9491;\n                                ;\n                            }\n                            local_failure = 1;\n                            goto error_0;\n                        }\n                    }\n                    \n                    bool tmp_48152 = ((__global bool *) ext_mem_52761)[eta_p_48147];\n                    bool lifted_lambda_res_48154 = !tmp_48152;\n                    int64_t defunc_0_f_res_48155 = btoi_bool_i64(lifted_lambda_res_48154);\n                    \n                    ((__global int64_t *) mem_52771)[gtid_52103] = defunc_0_f_res_48155;\n                    private_mem_53928[i_53931] = defunc_0_f_res_48155;\n                } else {\n                    private_mem_53928[i_53931] = (int64_t) 0;\n                }\n            }\n        }\n        \n      error_0:\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_53935 = 0; i_53935 < chunk_sizze_53894; i_53935++) {\n                int64_t sharedIdx_53936 = sext_i32_i64(local_tid_53906) + i_53935 * segscan_tblock_sizze_52099;\n                int64_t tmp_53937 = private_mem_53928[i_53935];\n                \n                ((__local int64_t *) local_mem_53913)[sharedIdx_53936] = tmp_53937;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53938 = 0; i_53938 < chunk_sizze_53894; i_53938++) {\n                int64_t sharedIdx_53939 = sext_i32_i64(local_tid_53906) * chunk_sizze_53894 + i_53938;\n                int64_t tmp_53940 = ((__local int64_t *) local_mem_53913)[sharedIdx_53939];\n                \n                private_mem_53928[i_53938] = tmp_53940;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_53941 = 0; i_53941 < chunk_sizze_53894 - (int64_t) 1; i_53941++) {\n                int64_t eta_p_47702;\n                int64_t eta_p_47703;\n ", "               \n                eta_p_47702 = private_mem_53928[i_53941];\n                eta_p_47703 = private_mem_53928[i_53941 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_47704 = add64(eta_p_47702, eta_p_47703);\n                \n                private_mem_53928[i_53941 + (int64_t) 1] = defunc_0_op_res_47704;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_53942 = private_mem_53928[chunk_sizze_53894 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = tmp_53942;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_53943;\n            int64_t eta_p_53944;\n            int64_t eta_p_53947;\n            int64_t eta_p_53948;\n            bool ltid_in_bounds_53950 = slt64(sext_i32_i64(local_tid_53906), num_virt_threads_53896);\n            int32_t skip_threads_53951;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_53950) {\n                    eta_p_53944 = ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)];\n                    if ((local_tid_53906 - squot32(local_tid_53906, 32) * 32) == 0) {\n                        eta_p_53943 = eta_p_53944;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_53951 = 1;\n                while (slt32(skip_threads_53951, 32)) {\n                    bool thread_active_53952 = sle32(skip_threads_53951, local_tid_53906 - squot32(local_tid_53906, 32) * 32) && ltid_in_bounds_53950;\n                    \n                    if (thread_active_53952) {\n                        // read operands\n                        {\n                            eta_p_53943 = ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906) - sext_i32_i64(sk", "ip_threads_53951)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_53952) {\n                            int64_t defunc_0_op_res_53945 = add64(eta_p_53943, eta_p_53944);\n                            \n                            eta_p_53943 = defunc_0_op_res_53945;\n                        }\n                    }\n                    if (sle32(wave_sizze_53908, skip_threads_53951)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_53952) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = eta_p_53943;\n                            eta_p_53944 = eta_p_53943;\n                        }\n                    }\n                    if (sle32(wave_sizze_53908, skip_threads_53951)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_53951 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_53906 - squot32(local_tid_53906, 32) * 32) == 31 && ltid_in_bounds_53950) {\n                    ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(squot32(local_tid_53906, 32))] = eta_p_53943;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_53953;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_53906, 32) == 0 && ltid_in_bounds_53950) {\n                        eta_p_53948 = ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)];\n   ",
                                    "                     if ((local_tid_53906 - squot32(local_tid_53906, 32) * 32) == 0) {\n                            eta_p_53947 = eta_p_53948;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_53953 = 1;\n                    while (slt32(skip_threads_53953, 32)) {\n                        bool thread_active_53954 = sle32(skip_threads_53953, local_tid_53906 - squot32(local_tid_53906, 32) * 32) && (squot32(local_tid_53906, 32) == 0 && ltid_in_bounds_53950);\n                        \n                        if (thread_active_53954) {\n                            // read operands\n                            {\n                                eta_p_53947 = ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906) - sext_i32_i64(skip_threads_53953)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_53954) {\n                                int64_t defunc_0_op_res_53949 = add64(eta_p_53947, eta_p_53948);\n                                \n                                eta_p_53947 = defunc_0_op_res_53949;\n                            }\n                        }\n                        if (sle32(wave_sizze_53908, skip_threads_53953)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_53954) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = eta_p_53947;\n                                eta_p_53948 = eta_p_53947;\n                            }\n                        }\n                        if (sle32(wave_sizze_53908, skip_threads_53953)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n       ", "                 }\n                        skip_threads_53953 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_53955 = squot32(local_tid_53906, 32) == 0 || !ltid_in_bounds_53950;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_53955) {\n                        eta_p_53944 = eta_p_53943;\n                        eta_p_53943 = ((__local int64_t *) local_mem_53913)[sext_i32_i64(squot32(local_tid_53906, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_53955) {\n                        int64_t defunc_0_op_res_53945 = add64(eta_p_53943, eta_p_53944);\n                        \n                        eta_p_53943 = defunc_0_op_res_53945;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_53955) {\n                        ((__local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = eta_p_53943;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_53906, 32) == 0 && ltid_in_bounds_53950) {\n                    ((__local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = eta_p_53944;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_53906 == 0) {\n                acc_53946 = ((__local int64_t *) local_mem_53913)[segscan_tblock_sizze_52099 - (int64_t) 1];\n            } else {\n                acc_53946 = ((__local int64_t *) local_mem_53913)[sext_i32_i64(local_tid_53906) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_ME", "M_FENCE);\n        }\n        prefix_53956 = (int64_t) 0;\n        block_new_sgm_53957 = sgm_idx_53925 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_53957 && local_tid_53906 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_53901)[dynamic_id_53923] = acc_53946;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_53897)[dynamic_id_53923] = (int8_t) 2;\n                acc_53946 = (int64_t) 0;\n            }\n            if (!block_new_sgm_53957 && slt32(local_tid_53906, wave_sizze_53908)) {\n                if (local_tid_53906 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_53899)[dynamic_id_53923] = acc_53946;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_53897)[dynamic_id_53923] = (int8_t) 1;\n                    \n                    int8_t tmp_53958 = ((volatile __global int8_t *) status_flags_mem_53897)[dynamic_id_53923 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_53913)[(int64_t) 0] = tmp_53958;\n                }\n                mem_fence_local();\n                \n                int8_t status_53959 = ((__local int8_t *) local_mem_53913)[(int64_t) 0];\n                \n                if (status_53959 == (int8_t) 2) {\n                    if (local_tid_53906 == 0) {\n                        prefix_53956 = ((volatile __global int64_t *) incprefixes_mem_53901)[dynamic_id_53923 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_53960 = sext_i64_i32(dynamic_id_53923 - sext_i32_i64(wave_sizze_53908));\n                    \n                    while (slt32(wave_sizze_53908 * -1, readOffset_53960)) {\n                        int32_t read_i_53961 = readOffset_53960 + local_tid_53906;\n                        int64_t aggr_53962 = (int64_t) 0;\n                        int8_t flag_53963 = (int8_t) ",
                                    "0;\n                        \n                        if (sle32(0, read_i_53961)) {\n                            flag_53963 = ((volatile __global int8_t *) status_flags_mem_53897)[sext_i32_i64(read_i_53961)];\n                            if (flag_53963 == (int8_t) 2) {\n                                aggr_53962 = ((volatile __global int64_t *) incprefixes_mem_53901)[sext_i32_i64(read_i_53961)];\n                            } else if (flag_53963 == (int8_t) 1) {\n                                aggr_53962 = ((volatile __global int64_t *) aggregates_mem_53899)[sext_i32_i64(read_i_53961)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_53913)[(int64_t) 4 + sext_i32_i64(local_tid_53906)] = aggr_53962;\n                        ((__local int8_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = flag_53963;\n                        flag_53963 = ((__local int8_t *) local_mem_53913)[sext_i32_i64(wave_sizze_53908) - (int64_t) 1];\n                        if (slt8(flag_53963, (int8_t) 2)) {\n                            int8_t flg_x_53967;\n                            int8_t flg_y_53968;\n                            int64_t eta_p_53964;\n                            int64_t eta_p_53965;\n                            int32_t skip_threads_53969;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_53968 = ((volatile __local int8_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)];\n                                eta_p_53965 = ((volatile __local int64_t *) local_mem_53913)[(int64_t) 4 + sext_i32_i64(local_tid_53906)];\n                                if ((local_tid_53906 - squot32(local_tid_53906, 32) * 32) == 0) {\n                                    eta_p_53964 = eta_p_53965;\n                                    flg_x_53967 = flg_y_53968;\n                                }\n                            }\n                            ", "// in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_53969 = 1;\n                                while (slt32(skip_threads_53969, 32)) {\n                                    if (sle32(skip_threads_53969, local_tid_53906 - squot32(local_tid_53906, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_53967 = ((volatile __local int8_t *) local_mem_53913)[sext_i32_i64(local_tid_53906) - sext_i32_i64(skip_threads_53969)];\n                                            eta_p_53964 = ((volatile __local int64_t *) local_mem_53913)[(int64_t) 4 + (sext_i32_i64(local_tid_53906) - sext_i32_i64(skip_threads_53969))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_53968 == (int8_t) 2 || flg_y_53968 == (int8_t) 0) {\n                                                flg_x_53967 = flg_y_53968;\n                                                eta_p_53964 = eta_p_53965;\n                                            } else {\n                                                int64_t defunc_0_op_res_53966 = add64(eta_p_53964, eta_p_53965);\n                                                \n                                                eta_p_53964 = defunc_0_op_res_53966;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_53913)[sext_i32_i64(local_tid_53906)] = flg_x_53967;\n                                            flg_y_53968 = flg_x_53967;\n                                            ((volatile __local int64_t *) local_mem_53913)[(int64_t) 4 + sext_i32_i64(lo", "cal_tid_53906)] = eta_p_53964;\n                                            eta_p_53965 = eta_p_53964;\n                                        }\n                                    }\n                                    skip_threads_53969 *= 2;\n                                }\n                            }\n                        }\n                        flag_53963 = ((__local int8_t *) local_mem_53913)[sext_i32_i64(wave_sizze_53908) - (int64_t) 1];\n                        aggr_53962 = ((__local int64_t *) local_mem_53913)[(int64_t) 4 + (sext_i32_i64(wave_sizze_53908) - (int64_t) 1)];\n                        if (flag_53963 == (int8_t) 2) {\n                            readOffset_53960 = wave_sizze_53908 * -1;\n                        } else if (flag_53963 == (int8_t) 1) {\n                            readOffset_53960 -= wave_sizze_53908;\n                        }\n                        if (slt8((int8_t) 0, flag_53963)) {\n                            int64_t eta_p_53970 = aggr_53962;\n                            int64_t eta_p_53971 = prefix_53956;\n                            int64_t defunc_0_op_res_53972 = add64(eta_p_53970, eta_p_53971);\n                            \n                            prefix_53956 = defunc_0_op_res_53972;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_53906 == 0) {\n                    if (boundary_53926 == sext_i64_i32(segscan_tblock_sizze_52099 * chunk_sizze_53894)) {\n                        int64_t eta_p_53973 = prefix_53956;\n                        int64_t eta_p_53974 = acc_53946;\n                        int64_t defunc_0_op_res_53975 = add64(eta_p_53973, eta_p_53974);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_53901)[dynamic_id_53923] = defunc_0_op_res_53975;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_53897)[dynamic_id_53923] = ",
                                    "(int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_53913)[(int64_t) 4] = prefix_53956;\n                    acc_53946 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_53923 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_53956 = ((__local int64_t *) local_mem_53913)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_53976;\n            int64_t eta_p_53977;\n            int64_t eta_p_53979 = prefix_53956;\n            int64_t eta_p_53980 = acc_53946;\n            \n            if (slt32(local_tid_53906 * chunk_sizze_32b_53910, boundary_53926) && !block_new_sgm_53957) {\n                int64_t defunc_0_op_res_53981 = add64(eta_p_53979, eta_p_53980);\n                \n                eta_p_53976 = defunc_0_op_res_53981;\n            } else {\n                eta_p_53976 = acc_53946;\n            }\n            \n            int32_t stopping_point_53982 = segsizze_compact_53927 - srem32(local_tid_53906 * chunk_sizze_32b_53910 - 1 + segsizze_compact_53927 - boundary_53926, segsizze_compact_53927);\n            \n            for (int64_t i_53983 = 0; i_53983 < chunk_sizze_53894; i_53983++) {\n                if (slt32(sext_i64_i32(i_53983), stopping_point_53982 - 1)) {\n                    eta_p_53977 = private_mem_53928[i_53983];\n                    \n                    int64_t defunc_0_op_res_53978 = add64(eta_p_53976, eta_p_53977);\n                    \n                    private_mem_53928[i_53983] = defunc_0_op_res_53978;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_53984 = 0; i_53984 < chunk_sizze_53894; i_53984++) {\n                int64_t sharedIdx_53985 = sext_i32_i64(local_tid_53906) * chunk_sizze_53894 + i_53984;\n                int64_t tmp_53986 = private_mem_53928", "[i_53984];\n                \n                ((__local int64_t *) local_mem_53913)[sharedIdx_53985] = tmp_53986;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_53987 = 0; i_53987 < chunk_sizze_53894; i_53987++) {\n                int64_t flat_idx_53988 = thd_offset_53930 + i_53987 * segscan_tblock_sizze_52099;\n                int64_t slice_53989 = m_47581;\n                int64_t gtid_52103 = flat_idx_53988;\n                int64_t remnant_53990 = flat_idx_53988 - gtid_52103;\n                \n                if (slt64(flat_idx_53988, m_47581)) {\n                    int64_t tmp_53991 = ((__local int64_t *) local_mem_53913)[flat_idx_53988 - block_offset_53924];\n                    \n                    ((__global int64_t *) mem_52769)[gtid_52103] = tmp_53991;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_52099\n    #undef chunk_sizze_53894\n}\n", NULL};
// Start of gpu_prototypes.h

// Constants used for transpositions.  In principle these should be configurable.
#define TR_BLOCK_DIM 16
#define TR_TILE_DIM (TR_BLOCK_DIM*2)
#define TR_ELEMS_PER_THREAD 8

// Config stuff included in every GPU backend.
struct gpu_config {
  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_cache;
  size_t default_shared_memory;
  size_t default_registers;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;
};

// The following are dummy sizes that mean the concrete defaults
// will be set during initialisation via hardware-inspection-based
// heuristics.
struct gpu_config gpu_config_initial = {
  0
};

// Must be defined by the user.
static int gpu_macros(struct futhark_context *ctx, char*** names, int64_t** values);

static void gpu_init_log(struct futhark_context *ctx);
struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);
static int gpu_free_all(struct futhark_context *ctx);

// End of gpu_prototypes.h

// Start of backends/cuda.h.

// Forward declarations.
// Invoked by setup_opencl() after the platform and device has been
// found, but before the program is loaded.  Its intended use is to
// tune constants based on the selected platform and device.
static void set_tuning_params(struct futhark_context* ctx);
static char* get_failure_msg(int failure_idx, int64_t args[]);

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_FATAL(x) nvrtc_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_NONFATAL(x) nvrtc_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
// Take care not to override an existing error.
#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                               \
      if (!ctx->error) {                        \
        ctx->error = serror;                    \
      } else {                                  \
        free(serror);                           \
      }                                         \
      return bad;                               \
    }                                           \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
                                          const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
                                       const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed_fatal(nvrtcResult res, const char *call,
                                           const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* nvrtc_api_succeed_nonfatal(nvrtcResult res, const char *call,
                                        const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    return msgprintf("%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char* cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  char* program;
  int num_nvrtc_opts;
  char* *nvrtc_opts;

  char* preferred_device;
  int preferred_device_num;

  int unified_memory;

  char* dump_ptx_to;
  char* load_ptx_from;

  struct gpu_config gpu;
};

static void backend_context_config_setup(struct futhark_context_config *cfg) {
  cfg->num_nvrtc_opts = 0;
  cfg->nvrtc_opts = (char**) malloc(sizeof(char*));
  cfg->nvrtc_opts[0] = NULL;

  cfg->program = strconcat(gpu_program);

  cfg->preferred_device_num = 0;
  cfg->preferred_device = strdup("");

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->unified_memory = 2;

  cfg->gpu = gpu_config_initial;
  cfg->gpu.default_block_size = 256;
  cfg->gpu.default_tile_size = 32;
  cfg->gpu.default_reg_tile_size = 2;
  cfg->gpu.default_threshold = 32*1024;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  for (int i = 0; i < cfg->num_nvrtc_opts; i++) {
    free(cfg->nvrtc_opts[i]);
  }
  free(cfg->nvrtc_opts);
  free(cfg->dump_ptx_to);
  free(cfg->load_ptx_from);
  free(cfg->preferred_device);
  free(cfg->program);
}

void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt) {
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = strdup(opt);
  cfg->num_nvrtc_opts++;
  cfg->nvrtc_opts = (char **) realloc(cfg->nvrtc_opts, (cfg->num_nvrtc_opts + 1) * sizeof(char *));
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}

void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  free(cfg->preferred_device);
  cfg->preferred_device = strdup(s);
  cfg->preferred_device_num = x;
}

const char* futhark_context_config_get_program(struct futhark_context_config *cfg) {
  return cfg->program;
}

void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s) {
  free(cfg->program);
  cfg->program = strdup(s);
}

void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *path) {
  free(cfg->dump_ptx_to);
  cfg->dump_ptx_to = strdup(path);
}

void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *path) {
  free(cfg->load_ptx_from);
  cfg->load_ptx_from = strdup(path);
}

void futhark_context_config_set_unified_memory(struct futhark_context_config* cfg, int flag) {
  cfg->unified_memory = flag;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  const char *name;
};

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
  // Uniform fields above.

  CUdeviceptr global_failure;
  CUdeviceptr global_failure_args;
  struct tuning_params tuning_params;
  // True if a potentially failing kernel has been enqueued.
  int32_t failure_is_an_option;
  int total_runs;
  long int total_runtime;
  int64_t peak_mem_usage_device;
  int64_t cur_mem_usage_device;

  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;
  CUstream stream;

  struct free_list gpu_free_list;

  size_t max_thread_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;
  size_t max_registers;
  size_t max_cache;

  size_t lockstep_width;

  struct builtin_kernels* kernels;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static int cuda_device_setup(struct futhark_context *ctx) {
  struct futhark_context_config *cfg = ctx->cfg;
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best = 0, cc_minor_best = 0;
  int cc_major = 0, cc_minor = 0;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (cfg->logging) {
      fprintf(ctx->log, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
              i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (cfg->logging) {
        fprintf(ctx->log, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, cfg->preferred_device) != NULL &&
        num_device_matches++ == cfg->preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (cfg->logging) {
    fprintf(ctx->log, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  static struct {
    int major;
    int minor;
    const char *arch_str;
  } const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" },
    { 8, 6, "compute_80" },
    { 8, 7, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  int num_archs = sizeof(x)/sizeof(x[0]);
  for (int i = 0; i < num_archs; i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static void cuda_nvrtc_mk_build_options(struct futhark_context *ctx, const char *extra_opts[],
                                        char*** opts_out, size_t *n_opts) {
  int arch_set = 0, num_extra_opts;
  struct futhark_context_config *cfg = ctx->cfg;

  char** macro_names;
  int64_t* macro_vals;
  int num_macros = gpu_macros(ctx, &macro_names, &macro_vals);

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t i = 0, n_opts_alloc = 20 + num_macros + num_extra_opts + cfg->num_tuning_params;
  char **opts = (char**) malloc(n_opts_alloc * sizeof(char *));
  if (!arch_set) {
    opts[i++] = strdup("-arch");
    opts[i++] = strdup(cuda_nvrtc_get_arch(ctx->dev));
  }
  opts[i++] = strdup("-default-device");
  if (cfg->debugging) {
    opts[i++] = strdup("-G");
    opts[i++] = strdup("-lineinfo");
  } else {
    opts[i++] = strdup("--disable-warnings");
  }
  opts[i++] = msgprintf("-D%s=%d",
                        "max_thread_block_size",
                        (int)ctx->max_thread_block_size);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_shared_memory",
                        (int)ctx->max_shared_memory);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_registers",
                        (int)ctx->max_registers);

  for (int j = 0; j < num_macros; j++) {
    opts[i++] = msgprintf("-D%s=%zu", macro_names[j], macro_vals[j]);
  }

  for (int j = 0; j < cfg->num_tuning_params; j++) {
    opts[i++] = msgprintf("-D%s=%zu", cfg->tuning_param_vars[j],
                          cfg->tuning_params[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_thread_block_size);

  // Time for the best lines of the code in the entire compiler.
  if (getenv("CUDA_HOME") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_HOME"));
  }
  if (getenv("CUDA_ROOT") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_ROOT"));
  }
  if (getenv("CUDA_PATH") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_PATH"));
  }
  opts[i++] = msgprintf("-I/usr/local/cuda/include");
  opts[i++] = msgprintf("-I/usr/include");

  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = strdup(extra_opts[j]);
  }

  opts[i++] = msgprintf("-DTR_BLOCK_DIM=%d", TR_BLOCK_DIM);
  opts[i++] = msgprintf("-DTR_TILE_DIM=%d", TR_TILE_DIM);
  opts[i++] = msgprintf("-DTR_ELEMS_PER_THREAD=%d", TR_ELEMS_PER_THREAD);

  free(macro_names);
  free(macro_vals);

  *n_opts = i;
  *opts_out = opts;
}

static char* cuda_nvrtc_build(const char *src, const char *opts[], size_t n_opts,
                              char **ptx) {
  nvrtcProgram prog;
  char *problem = NULL;

  problem = NVRTC_SUCCEED_NONFATAL(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));

  if (problem) {
    return problem;
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        problem = msgprintf("NVRTC compilation failed.\n\n%s\n", log);
      } else {
        problem = msgprintf("Could not retrieve compilation log\n");
      }
      free(log);
    }
    return problem;
  }

  size_t ptx_size;
  NVRTC_SUCCEED_FATAL(nvrtcGetPTXSize(prog, &ptx_size));
  *ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED_FATAL(nvrtcGetPTX(prog, *ptx));

  NVRTC_SUCCEED_FATAL(nvrtcDestroyProgram(&prog));

  return NULL;
}

static void cuda_load_ptx_from_cache(struct futhark_context_config *cfg,
                                     const char *src,
                                     const char *opts[], size_t n_opts,
                                     struct cache_hash *h, const char *cache_fname,
                                     char **ptx) {
  if (cfg->logging) {
    fprintf(stderr, "Restoring cache from from %s...\n", cache_fname);
  }
  cache_hash_init(h);
  for (size_t i = 0; i < n_opts; i++) {
    cache_hash(h, opts[i], strlen(opts[i]));
  }
  cache_hash(h, src, strlen(src));
  size_t ptxsize;
  errno = 0;
  if (cache_restore(cache_fname, h, (unsigned char**)ptx, &ptxsize) != 0) {
    if (cfg->logging) {
      fprintf(stderr, "Failed to restore cache (errno: %s)\n", strerror(errno));
    }
  }
}

static void cuda_size_setup(struct futhark_context *ctx)
{
  struct futhark_context_config *cfg = ctx->cfg;
  if (cfg->gpu.default_block_size > ctx->max_thread_block_size) {
    if (cfg->gpu.default_block_size_changed) {
      fprintf(stderr,
              "Note: Device limits default block size to %zu (down from %zu).\n",
              ctx->max_thread_block_size, cfg->gpu.default_block_size);
    }
    cfg->gpu.default_block_size = ctx->max_thread_block_size;
  }
  if (cfg->gpu.default_grid_size > ctx->max_grid_size) {
    if (cfg->gpu.default_grid_size_changed) {
      fprintf(stderr,
              "Note: Device limits default grid size to %zu (down from %zu).\n",
              ctx->max_grid_size, cfg->gpu.default_grid_size);
    }
    cfg->gpu.default_grid_size = ctx->max_grid_size;
  }
  if (cfg->gpu.default_tile_size > ctx->max_tile_size) {
    if (cfg->gpu.default_tile_size_changed) {
      fprintf(stderr,
              "Note: Device limits default tile size to %zu (down from %zu).\n",
              ctx->max_tile_size, cfg->gpu.default_tile_size);
    }
    cfg->gpu.default_tile_size = ctx->max_tile_size;
  }

  if (!cfg->gpu.default_grid_size_changed) {
    cfg->gpu.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / cfg->gpu.default_block_size;
  }

  for (int i = 0; i < cfg->num_tuning_params; i++) {
    const char *size_class = cfg->tuning_param_classes[i];
    int64_t *size_value = &cfg->tuning_params[i];
    const char* size_name = cfg->tuning_param_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "thread_block_size") == size_class) {
      max_value = ctx->max_thread_block_size;
      default_value = cfg->gpu.default_block_size;
    } else if (strstr(size_class, "grid_size") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = cfg->gpu.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = cfg->gpu.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = cfg->gpu.default_reg_tile_size;
    } else if (strstr(size_class, "shared_memory") == size_class) {
      max_value = ctx->max_shared_memory;
      default_value = ctx->max_shared_memory;
    } else if (strstr(size_class, "cache") == size_class) {
      max_value = ctx->max_cache;
      default_value = ctx->max_cache;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = cfg->gpu.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static char* cuda_module_setup(struct futhark_context *ctx,
                               const char *src,
                               const char *extra_opts[],
                               const char* cache_fname) {
  char *ptx = NULL;
  struct futhark_context_config *cfg = ctx->cfg;

  if (cfg->load_ptx_from) {
    ptx = slurp_file(cfg->load_ptx_from, NULL);
  }

  char **opts;
  size_t n_opts;
  cuda_nvrtc_mk_build_options(ctx, extra_opts, &opts, &n_opts);

  if (cfg->logging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  struct cache_hash h;
  int loaded_ptx_from_cache = 0;
  if (cache_fname != NULL) {
    cuda_load_ptx_from_cache(cfg, src, (const char**)opts, n_opts, &h, cache_fname, &ptx);

    if (ptx != NULL) {
      if (cfg->logging) {
        fprintf(stderr, "Restored PTX from cache; now loading module...\n");
      }
      if (cuModuleLoadData(&ctx->module, ptx) == CUDA_SUCCESS) {
        if (cfg->logging) {
          fprintf(stderr, "Success!\n");
        }
        loaded_ptx_from_cache = 1;
      } else {
        if (cfg->logging) {
          fprintf(stderr, "Failed!\n");
        }
        free(ptx);
        ptx = NULL;
      }
    }
  }

  if (ptx == NULL) {
    char* problem = cuda_nvrtc_build(src, (const char**)opts, n_opts, &ptx);
    if (problem != NULL) {
      return problem;
    }
  }

  if (cfg->dump_ptx_to != NULL) {
    dump_file(cfg->dump_ptx_to, ptx, strlen(ptx));
  }

  if (!loaded_ptx_from_cache) {
    CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));
  }

  if (cache_fname != NULL && !loaded_ptx_from_cache) {
    if (cfg->logging) {
      fprintf(stderr, "Caching PTX in %s...\n", cache_fname);
    }
    errno = 0;
    if (cache_store(cache_fname, &h, (const unsigned char*)ptx, strlen(ptx)) != 0) {
      fprintf(stderr, "Failed to cache PTX: %s\n", strerror(errno));
    }
  }

  for (size_t i = 0; i < n_opts; i++) {
    free((char *)opts[i]);
  }
  free(opts);
  free(ptx);

  return NULL;
}

struct cuda_event {
  cudaEvent_t start;
  cudaEvent_t end;
};

static struct cuda_event* cuda_event_new(struct futhark_context* ctx) {
  if (ctx->profiling && !ctx->profiling_paused) {
    struct cuda_event* e = malloc(sizeof(struct cuda_event));
    cudaEventCreate(&e->start);
    cudaEventCreate(&e->end);
    return e;
  } else {
    return NULL;
  }
}

static int cuda_event_report(struct str_builder* sb, struct cuda_event* e) {
  float ms;
  CUresult err;
  if ((err = cuEventElapsedTime(&ms, e->start, e->end)) != CUDA_SUCCESS) {
    return err;
  }

  // CUDA provides milisecond resolution, but we want microseconds.
  str_builder(sb, ",\"duration\":%f", ms*1000);

  if ((err = cuEventDestroy(e->start)) != CUDA_SUCCESS) {
    return 1;
  }

  if ((err = cuEventDestroy(e->end)) != CUDA_SUCCESS) {
    return 1;
  }

  free(e);

  return 0;
}

int futhark_context_sync(struct futhark_context* ctx) {
  CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cu_ctx));
  CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
  if (ctx->failure_is_an_option) {
    // Check for any delayed error.
    int32_t failure_idx;
    CUDA_SUCCEED_OR_RETURN(
                           cuMemcpyDtoH(&failure_idx,
                                        ctx->global_failure,
                                        sizeof(int32_t)));
    ctx->failure_is_an_option = 0;

    if (failure_idx >= 0) {
      // We have to clear global_failure so that the next entry point
      // is not considered a failure from the start.
      int32_t no_failure = -1;
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyHtoD(ctx->global_failure,
                                          &no_failure,
                                          sizeof(int32_t)));

      int64_t args[max_failure_args+1];
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyDtoH(&args,
                                          ctx->global_failure_args,
                                          sizeof(args)));

      ctx->error = get_failure_msg(failure_idx, args);

      return FUTHARK_PROGRAM_ERROR;
    }
  }

  CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cu_ctx));
  return 0;
}

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);

int backend_context_setup(struct futhark_context* ctx) {
  ctx->failure_is_an_option = 0;
  ctx->total_runs = 0;
  ctx->total_runtime = 0;
  ctx->peak_mem_usage_device = 0;
  ctx->cur_mem_usage_device = 0;
  ctx->kernels = NULL;

  CUDA_SUCCEED_FATAL(cuInit(0));
  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->gpu_free_list);

  if (ctx->cfg->unified_memory == 2) {
    ctx->cfg->unified_memory = device_query(ctx->dev, MANAGED_MEMORY);
  }

  if (ctx->cfg->logging) {
    if (ctx->cfg->unified_memory) {
      fprintf(ctx->log, "Using managed memory\n");
    } else {
      fprintf(ctx->log, "Using unmanaged memory\n");
    }
  }

  ctx->max_thread_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_thread_block_size);
  ctx->max_threshold = 1U<<31; // No limit.
  ctx->max_bespoke = 1U<<31; // No limit.

  if (ctx->cfg->gpu.default_registers != 0) {
    ctx->max_registers = ctx->cfg->gpu.default_registers;
  } else {
    ctx->max_registers = device_query(ctx->dev, MAX_REGISTERS_PER_BLOCK);
  }

  if (ctx->cfg->gpu.default_shared_memory != 0) {
    ctx->max_shared_memory = ctx->cfg->gpu.default_shared_memory;
  } else {
    // MAX_SHARED_MEMORY_PER_BLOCK gives bogus numbers (48KiB); probably
    // for backwards compatibility.  Add _OPTIN and you seem to get the
    // right number.
    ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK_OPTIN);
#if CUDART_VERSION >= 12000
    ctx->max_shared_memory -= device_query(ctx->dev, RESERVED_SHARED_MEMORY_PER_BLOCK);
#endif
  }

  if (ctx->cfg->gpu.default_cache != 0) {
    ctx->max_cache = ctx->cfg->gpu.default_cache;
  } else {
    ctx->max_cache = device_query(ctx->dev, L2_CACHE_SIZE);
  }

  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);
  CUDA_SUCCEED_FATAL(cuStreamCreate(&ctx->stream, CU_STREAM_DEFAULT));
  cuda_size_setup(ctx);

  gpu_init_log(ctx);

  ctx->error = cuda_module_setup(ctx,
                                 ctx->cfg->program,
                                 (const char**)ctx->cfg->nvrtc_opts,
                                 ctx->cfg->cache_fname);

  if (ctx->error != NULL) {
    futhark_panic(1, "During CUDA initialisation:\n%s\n", ctx->error);
  }

  int32_t no_error = -1;
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
  CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error, sizeof(no_error)));
  // The +1 is to avoid zero-byte allocations.
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t)*(max_failure_args+1)));

  if ((ctx->kernels = init_builtin_kernels(ctx)) == NULL) {
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  if (ctx->kernels != NULL) {
    free_builtin_kernels(ctx, ctx->kernels);
    cuMemFree(ctx->global_failure);
    cuMemFree(ctx->global_failure_args);
    CUDA_SUCCEED_FATAL(gpu_free_all(ctx));
    CUDA_SUCCEED_FATAL(cuStreamDestroy(ctx->stream));
    CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
    CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
  }
  free_list_destroy(&ctx->gpu_free_list);
}

// GPU ABSTRACTION LAYER

// Types.

typedef CUfunction gpu_kernel;
typedef CUdeviceptr gpu_mem;

static void gpu_create_kernel(struct futhark_context *ctx,
                              gpu_kernel* kernel,
                              const char* name) {
  if (ctx->debugging) {
    fprintf(ctx->log, "Creating kernel %s.\n", name);
  }
  CUDA_SUCCEED_FATAL(cuModuleGetFunction(kernel, ctx->module, name));
  // Unless the below is set, the kernel is limited to 48KiB of memory.
  CUDA_SUCCEED_FATAL(cuFuncSetAttribute(*kernel,
                                        cudaFuncAttributeMaxDynamicSharedMemorySize,
                                        ctx->max_shared_memory));
}

static void gpu_free_kernel(struct futhark_context *ctx,
                            gpu_kernel kernel) {
  (void)ctx;
  (void)kernel;
}

static int gpu_scalar_to_device(struct futhark_context* ctx,
                                gpu_mem dst, size_t offset, size_t size,
                                void *src) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(dst + offset, src, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_scalar_from_device(struct futhark_context* ctx,
                                  void *dst,
                                  gpu_mem src, size_t offset, size_t size) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_from_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(dst, src + offset, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_memcpy(struct futhark_context* ctx,
                      gpu_mem dst, int64_t dst_offset,
                      gpu_mem src, int64_t src_offset,
                      int64_t nbytes) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_dev_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyAsync(dst+dst_offset, src+src_offset, nbytes, ctx->stream));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_host2gpu(struct futhark_context* ctx, bool sync,
                           gpu_mem dst, int64_t dst_offset,
                           const unsigned char* src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_host_to_dev",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoD(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoDAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_gpu2host(struct futhark_context* ctx, bool sync,
                           unsigned char* dst, int64_t dst_offset,
                           gpu_mem src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_dev_to_host",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoH(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoHAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
    if (sync &&
        ctx->failure_is_an_option &&
        futhark_context_sync(ctx) != 0) {
      return 1;
    }
  }
  return FUTHARK_SUCCESS;
}

static int gpu_launch_kernel(struct futhark_context* ctx,
                             gpu_kernel kernel, const char *name,
                             const int32_t grid[3],
                             const int32_t block[3],
                             unsigned int shared_mem_bytes,
                             int num_args,
                             void* args[num_args],
                             size_t args_sizes[num_args]) {
  (void) args_sizes;

  if (shared_mem_bytes > ctx->max_shared_memory) {
    set_error(ctx, msgprintf("Kernel %s with %d bytes of memory exceeds device limit of %d\n",
                             name, shared_mem_bytes, (int)ctx->max_shared_memory));
    return 1;
  }

  int64_t time_start = 0, time_end = 0;
  if (ctx->debugging) {
    time_start = get_wall_time();
  }

  struct cuda_event *event = cuda_event_new(ctx);

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    add_event(ctx,
              name,
              msgprintf("Kernel %s with\n"
                        "  grid=(%d,%d,%d)\n"
                        "  block=(%d,%d,%d)\n"
                        "  shared memory=%d",
                        name,
                        grid[0], grid[1], grid[2],
                        block[0], block[1], block[2],
                        shared_mem_bytes),
              event,
              (event_report_fn)cuda_event_report);
  }

  CUDA_SUCCEED_OR_RETURN
    (cuLaunchKernel(kernel,
                    grid[0], grid[1], grid[2],
                    block[0], block[1], block[2],
                    shared_mem_bytes, ctx->stream,
                    args, NULL));

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }

  if (ctx->debugging) {
    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
    time_end = get_wall_time();
    long int time_diff = time_end - time_start;
    fprintf(ctx->log, "  runtime: %ldus\n", time_diff);
  }
  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return FUTHARK_SUCCESS;
}

static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out) {
  CUresult res;
  if (ctx->cfg->unified_memory) {
    res = cuMemAllocManaged(mem_out, size, CU_MEM_ATTACH_GLOBAL);
  } else {
    res = cuMemAlloc(mem_out, size);
  }

  if (res == CUDA_ERROR_OUT_OF_MEMORY) {
    return FUTHARK_OUT_OF_MEMORY;
  }

  CUDA_SUCCEED_OR_RETURN(res);
  return FUTHARK_SUCCESS;
}

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem) {
  (void)ctx;
  CUDA_SUCCEED_OR_RETURN(cuMemFree(mem));
  return FUTHARK_SUCCESS;
}

// End of backends/cuda.h.

// Start of gpu.h

// Generic functions that use our tiny GPU abstraction layer.  The
// entire context must be defined before this header is included.  In
// particular we expect the following functions to be available:

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem);
static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out);
int gpu_launch_kernel(struct futhark_context* ctx,
                      gpu_kernel kernel, const char *name,
                      const int32_t grid[3],
                      const int32_t block[3],
                      unsigned int shared_mem_bytes,
                      int num_args,
                      void* args[num_args],
                      size_t args_sizes[num_args]);
int gpu_memcpy(struct futhark_context* ctx,
               gpu_mem dst, int64_t dst_offset,
               gpu_mem src, int64_t src_offset,
               int64_t nbytes);
int gpu_scalar_from_device(struct futhark_context* ctx,
                           void *dst,
                           gpu_mem src, size_t offset, size_t size);
int gpu_scalar_to_device(struct futhark_context* ctx,
                         gpu_mem dst, size_t offset, size_t size,
                         void *src);
void gpu_create_kernel(struct futhark_context *ctx,
                       gpu_kernel* kernel,
                       const char* name);

static void gpu_init_log(struct futhark_context *ctx) {
  if (ctx->cfg->logging) {
    fprintf(ctx->log, "Default block size: %ld\n", (long)ctx->cfg->gpu.default_block_size);
    fprintf(ctx->log, "Default grid size: %ld\n", (long)ctx->cfg->gpu.default_grid_size);
    fprintf(ctx->log, "Default tile size: %ld\n", (long)ctx->cfg->gpu.default_tile_size);
    fprintf(ctx->log, "Default register tile size: %ld\n", (long)ctx->cfg->gpu.default_reg_tile_size);
    fprintf(ctx->log, "Default cache: %ld\n", (long)ctx->cfg->gpu.default_cache);
    fprintf(ctx->log, "Default registers: %ld\n", (long)ctx->cfg->gpu.default_registers);
    fprintf(ctx->log, "Default threshold: %ld\n", (long)ctx->cfg->gpu.default_threshold);
    fprintf(ctx->log, "Max thread block size: %ld\n", (long)ctx->max_thread_block_size);
    fprintf(ctx->log, "Max grid size: %ld\n", (long)ctx->max_grid_size);
    fprintf(ctx->log, "Max tile size: %ld\n", (long)ctx->max_tile_size);
    fprintf(ctx->log, "Max threshold: %ld\n", (long)ctx->max_threshold);
    fprintf(ctx->log, "Max shared memory: %ld\n", (long)ctx->max_shared_memory);
    fprintf(ctx->log, "Max registers: %ld\n", (long)ctx->max_registers);
    fprintf(ctx->log, "Max cache: %ld\n", (long)ctx->max_cache);
    fprintf(ctx->log, "Lockstep width: %ld\n", (long)ctx->lockstep_width);
  }
}

// Generic GPU command line options.

void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_block_size = size;
  cfg->gpu.default_block_size_changed = 1;
}

void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size) {
  futhark_context_config_set_default_thread_block_size(cfg, size);
}

void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int num) {
  cfg->gpu.default_grid_size = num;
  cfg->gpu.default_grid_size_changed = 1;
}

void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int num) {
  futhark_context_config_set_default_grid_size(cfg, num);
}

void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_tile_size = size;
  cfg->gpu.default_tile_size_changed = 1;
}

void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_reg_tile_size = size;
}

void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_cache = size;
}

void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_registers = size;
}

void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_threshold = size;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t new_value) {
  for (int i = 0; i < cfg->num_tuning_params; i++) {
    if (strcmp(param_name, cfg->tuning_param_names[i]) == 0) {
      cfg->tuning_params[i] = new_value;
      return 0;
    }
  }
  if (strcmp(param_name, "default_thread_block_size") == 0 ||
      strcmp(param_name, "default_group_size") == 0) {
    cfg->gpu.default_block_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_grid_size") == 0 ||
      strcmp(param_name, "default_num_groups") == 0) {
    cfg->gpu.default_grid_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_threshold") == 0) {
    cfg->gpu.default_threshold = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_tile_size") == 0) {
    cfg->gpu.default_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_reg_tile_size") == 0) {
    cfg->gpu.default_reg_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_cache") == 0) {
    cfg->gpu.default_cache = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_shared_memory") == 0) {
    cfg->gpu.default_shared_memory = new_value;
    return 0;
  }

  return 1;
}

// End of GPU command line optiopns.

// Max number of thead blocks we allow along the second or third
// dimension for transpositions.
#define MAX_TR_THREAD_BLOCKS 65535

struct builtin_kernels {
  // We have a lot of ways to transpose arrays.
  gpu_kernel map_transpose_1b;
  gpu_kernel map_transpose_1b_low_height;
  gpu_kernel map_transpose_1b_low_width;
  gpu_kernel map_transpose_1b_small;
  gpu_kernel map_transpose_1b_large;
  gpu_kernel map_transpose_2b;
  gpu_kernel map_transpose_2b_low_height;
  gpu_kernel map_transpose_2b_low_width;
  gpu_kernel map_transpose_2b_small;
  gpu_kernel map_transpose_2b_large;
  gpu_kernel map_transpose_4b;
  gpu_kernel map_transpose_4b_low_height;
  gpu_kernel map_transpose_4b_low_width;
  gpu_kernel map_transpose_4b_small;
  gpu_kernel map_transpose_4b_large;
  gpu_kernel map_transpose_8b;
  gpu_kernel map_transpose_8b_low_height;
  gpu_kernel map_transpose_8b_low_width;
  gpu_kernel map_transpose_8b_small;
  gpu_kernel map_transpose_8b_large;

  // And a few ways of copying.
  gpu_kernel lmad_copy_1b;
  gpu_kernel lmad_copy_2b;
  gpu_kernel lmad_copy_4b;
  gpu_kernel lmad_copy_8b;
};

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx) {
  struct builtin_kernels *kernels = malloc(sizeof(struct builtin_kernels));
  gpu_create_kernel(ctx, &kernels->map_transpose_1b, "map_transpose_1b");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_large, "map_transpose_1b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_height, "map_transpose_1b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_width, "map_transpose_1b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_small, "map_transpose_1b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_2b, "map_transpose_2b");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_large, "map_transpose_2b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_height, "map_transpose_2b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_width, "map_transpose_2b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_small, "map_transpose_2b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_4b, "map_transpose_4b");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_large, "map_transpose_4b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_height, "map_transpose_4b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_width, "map_transpose_4b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_small, "map_transpose_4b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_8b, "map_transpose_8b");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_large, "map_transpose_8b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_height, "map_transpose_8b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_width, "map_transpose_8b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_small, "map_transpose_8b_small");

  gpu_create_kernel(ctx, &kernels->lmad_copy_1b, "lmad_copy_1b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_2b, "lmad_copy_2b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_4b, "lmad_copy_4b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_8b, "lmad_copy_8b");

  return kernels;
}

void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels) {
  gpu_free_kernel(ctx, kernels->map_transpose_1b);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_2b);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_4b);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_8b);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_small);

  gpu_free_kernel(ctx, kernels->lmad_copy_1b);
  gpu_free_kernel(ctx, kernels->lmad_copy_2b);
  gpu_free_kernel(ctx, kernels->lmad_copy_4b);
  gpu_free_kernel(ctx, kernels->lmad_copy_8b);

  free(kernels);
}

static int gpu_alloc(struct futhark_context *ctx, FILE *log,
                     size_t min_size, const char *tag,
                     gpu_mem *mem_out, size_t *size_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  gpu_mem* memptr;
  if (free_list_find(&ctx->gpu_free_list, min_size, tag, size_out, (fl_mem*)&memptr) == 0) {
    // Successfully found a free block.  Is it big enough?
    if (*size_out >= min_size) {
      if (ctx->cfg->debugging) {
        fprintf(log, "No need to allocate: Found a block in the free list.\n");
      }
      *mem_out = *memptr;
      free(memptr);
      return FUTHARK_SUCCESS;
    } else {
      if (ctx->cfg->debugging) {
        fprintf(log, "Found a free block, but it was too small.\n");
      }
      int error = gpu_free_actual(ctx, *memptr);
      free(memptr);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    }
  }

  *size_out = min_size;

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg->debugging) {
    fprintf(log, "Actually allocating the desired block.\n");
  }

  int error = gpu_alloc_actual(ctx, min_size, mem_out);

  while (error == FUTHARK_OUT_OF_MEMORY) {
    if (ctx->cfg->debugging) {
      fprintf(log, "Out of GPU memory: releasing entry from the free list...\n");
    }
    gpu_mem* memptr;
    if (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
      gpu_mem mem = *memptr;
      free(memptr);
      error = gpu_free_actual(ctx, mem);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = gpu_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int gpu_free(struct futhark_context *ctx,
                    gpu_mem mem, size_t size, const char *tag) {
  gpu_mem* memptr = malloc(sizeof(gpu_mem));
  *memptr = mem;
  free_list_insert(&ctx->gpu_free_list, size, (fl_mem)memptr, tag);
  return FUTHARK_SUCCESS;
}

static int gpu_free_all(struct futhark_context *ctx) {
  free_list_pack(&ctx->gpu_free_list);
  gpu_mem* memptr;
  while (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
    gpu_mem mem = *memptr;
    free(memptr);
    int error = gpu_free_actual(ctx, mem);
    if (error != FUTHARK_SUCCESS) {
      return error;
    }
  }

  return FUTHARK_SUCCESS;
}

static int gpu_map_transpose(struct futhark_context* ctx,
                             gpu_kernel kernel_default,
                             gpu_kernel kernel_low_height,
                             gpu_kernel kernel_low_width,
                             gpu_kernel kernel_small,
                             gpu_kernel kernel_large,
                             const char *name, size_t elem_size,
                             gpu_mem dst, int64_t dst_offset,
                             gpu_mem src, int64_t src_offset,
                             int64_t k, int64_t n, int64_t m) {
  int64_t mulx = TR_BLOCK_DIM / n;
  int64_t muly = TR_BLOCK_DIM / m;
  int32_t mulx32 = mulx;
  int32_t muly32 = muly;
  int32_t k32 = k;
  int32_t n32 = n;
  int32_t m32 = m;

  gpu_kernel kernel = kernel_default;
  int32_t grid[3];
  int32_t block[3];

  void* args[11];
  size_t args_sizes[11] = {
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t)
  };

  args[0] = &dst;
  args[1] = &dst_offset;
  args[2] = &src;
  args[3] = &src_offset;
  args[7] = &mulx;
  args[8] = &muly;

  if (dst_offset + k * n * m <= 2147483647L &&
      src_offset + k * n * m <= 2147483647L) {
    if (m <= TR_BLOCK_DIM/2 && n <= TR_BLOCK_DIM/2) {
      if (ctx->logging) { fprintf(ctx->log, "Using small kernel\n"); }
      kernel = kernel_small;
      grid[0] = ((k * n * m) + (TR_BLOCK_DIM*TR_BLOCK_DIM) - 1) / (TR_BLOCK_DIM*TR_BLOCK_DIM);
      grid[1] = 1;
      grid[2] = 1;
      block[0] = TR_BLOCK_DIM*TR_BLOCK_DIM;
      block[1] = 1;
      block[2] = 1;
    } else if (m <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < n) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-width kernel\n"); }
      kernel = kernel_low_width;
      int64_t x_elems = m;
      int64_t y_elems = (n + muly - 1) / muly;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else if (n <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < m) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-height kernel\n"); }
      kernel = kernel_low_height;
      int64_t x_elems = (m + mulx - 1) / mulx;
      int64_t y_elems = n;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else {
      if (ctx->logging) { fprintf(ctx->log, "Using default kernel\n"); }
      kernel = kernel_default;
      grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[2] = k;
      block[0] = TR_TILE_DIM;
      block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
      block[2] = 1;
    }
    args[4] = &k32;
    args[5] = &m32;
    args[6] = &n32;
    args[7] = &mulx32;
    args[8] = &muly32;
  } else {
    if (ctx->logging) { fprintf(ctx->log, "Using large kernel\n"); }
    kernel = kernel_large;
    grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[2] = k;
    block[0] = TR_TILE_DIM;
    block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
    block[2] = 1;
    args[4] = &k;
    args[5] = &m;
    args[6] = &n;
    args[7] = &mulx;
    args[8] = &muly;
    args_sizes[4] = sizeof(int64_t);
    args_sizes[5] = sizeof(int64_t);
    args_sizes[6] = sizeof(int64_t);
    args_sizes[7] = sizeof(int64_t);
    args_sizes[8] = sizeof(int64_t);
  }

  // Cap the number of thead blocks we launch and figure out how many
  // repeats we need alongside each dimension.
  int32_t repeat_1 = grid[1] / MAX_TR_THREAD_BLOCKS;
  int32_t repeat_2 = grid[2] / MAX_TR_THREAD_BLOCKS;
  grid[1] = repeat_1 > 0 ? MAX_TR_THREAD_BLOCKS : grid[1];
  grid[2] = repeat_2 > 0 ? MAX_TR_THREAD_BLOCKS : grid[2];
  args[9] = &repeat_1;
  args[10] = &repeat_2;
  args_sizes[9] = sizeof(repeat_1);
  args_sizes[10] = sizeof(repeat_2);

  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return gpu_launch_kernel(ctx, kernel, name, grid, block,
                           TR_TILE_DIM*(TR_TILE_DIM+1)*elem_size,
                           sizeof(args)/sizeof(args[0]), args, args_sizes);
}

#define GEN_MAP_TRANSPOSE_GPU2GPU(NAME, ELEM_TYPE)                      \
  static int map_transpose_gpu2gpu_##NAME                               \
  (struct futhark_context* ctx,                                         \
   gpu_mem dst, int64_t dst_offset,                                     \
   gpu_mem src, int64_t src_offset,                                     \
   int64_t k, int64_t m, int64_t n)                                     \
  {                                                                     \
    return                                                              \
      gpu_map_transpose                                                 \
      (ctx,                                                             \
       ctx->kernels->map_transpose_##NAME,                              \
       ctx->kernels->map_transpose_##NAME##_low_height,                 \
       ctx->kernels->map_transpose_##NAME##_low_width,                  \
       ctx->kernels->map_transpose_##NAME##_small,                      \
       ctx->kernels->map_transpose_##NAME##_large,                      \
       "map_transpose_" #NAME, sizeof(ELEM_TYPE),                       \
       dst, dst_offset, src, src_offset,                                \
       k, n, m);                                                        \
  }

static int gpu_lmad_copy(struct futhark_context* ctx,
                         gpu_kernel kernel, int r,
                         gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                         gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                         int64_t shape[r]) {
  if (r > 8) {
    set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy array of greater than rank 8.\n"));
    return 1;
  }

  int64_t n = 1;
  for (int i = 0; i < r; i++) { n *= shape[i]; }

  void* args[6+(8*3)];
  size_t args_sizes[6+(8*3)];

  args[0] = &dst;
  args_sizes[0] = sizeof(gpu_mem);
  args[1] = &dst_offset;
  args_sizes[1] = sizeof(dst_offset);
  args[2] = &src;
  args_sizes[2] = sizeof(gpu_mem);
  args[3] = &src_offset;
  args_sizes[3] = sizeof(src_offset);
  args[4] = &n;
  args_sizes[4] = sizeof(n);
  args[5] = &r;
  args_sizes[5] = sizeof(r);

  int64_t zero = 0;

  for (int i = 0; i < 8; i++) {
    args_sizes[6+i*3] = sizeof(int64_t);
    args_sizes[6+i*3+1] = sizeof(int64_t);
    args_sizes[6+i*3+2] = sizeof(int64_t);
    if (i < r) {
      args[6+i*3] = &shape[i];
      args[6+i*3+1] = &dst_strides[i];
      args[6+i*3+2] = &src_strides[i];
    } else {
      args[6+i*3] = &zero;
      args[6+i*3+1] = &zero;
      args[6+i*3+2] = &zero;
    }
  }
  const size_t w = 256; // XXX: hardcoded thread block size.

  return gpu_launch_kernel(ctx, kernel, "copy_lmad_dev_to_dev",
                           (const int32_t[3]) {(n+w-1)/w,1,1},
                           (const int32_t[3]) {w,1,1},
                           0, 6+(8*3), args, args_sizes);
}

#define GEN_LMAD_COPY_ELEMENTS_GPU2GPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return gpu_lmad_copy(ctx, ctx->kernels->lmad_copy_##NAME, r,        \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \

#define GEN_LMAD_COPY_GPU2GPU(NAME, ELEM_TYPE)                          \
  static int lmad_copy_gpu2gpu_##NAME                                   \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "GPU to GPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return FUTHARK_SUCCESS; }                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                       r, dst_strides, src_strides, shape)) {           \
      log_transpose(ctx, k, n, m);                                      \
      return map_transpose_gpu2gpu_##NAME                               \
        (ctx, dst, dst_offset, src, src_offset, k, n, m);               \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}        \
      return gpu_memcpy(ctx,                                            \
                        dst, dst_offset*sizeof(ELEM_TYPE),              \
                        src, src_offset*sizeof(ELEM_TYPE),              \
                        size * sizeof(ELEM_TYPE));                      \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}     \
      return lmad_copy_elements_gpu2gpu_##NAME                          \
        (ctx, r,                                                        \
         dst, dst_offset, dst_strides,                                  \
         src, src_offset, src_strides,                                  \
         shape);                                                        \
    }                                                                   \
  }

static int
lmad_copy_elements_host2gpu(struct futhark_context *ctx, size_t elem_size,
                            int r,
                            gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                            unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                            int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from host to GPU.\n"));
  return 1;
}

static int
lmad_copy_elements_gpu2host (struct futhark_context *ctx, size_t elem_size,
                             int r,
                             unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                             gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                             int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from GPU to host.\n"));
  return 1;
}

#define GEN_LMAD_COPY_ELEMENTS_HOSTGPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return (ctx, ctx->kernels->lmad_copy_##NAME, r,                     \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \


static int lmad_copy_host2gpu(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                              unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_host2gpu(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_host2gpu
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

static int lmad_copy_gpu2host(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                              gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_gpu2host(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_gpu2host
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

GEN_MAP_TRANSPOSE_GPU2GPU(1b, uint8_t)
GEN_MAP_TRANSPOSE_GPU2GPU(2b, uint16_t)
GEN_MAP_TRANSPOSE_GPU2GPU(4b, uint32_t)
GEN_MAP_TRANSPOSE_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_GPU2GPU(8b, uint64_t)

// End of gpu.h

static int gpu_macros(struct futhark_context *ctx, char ***names_out, int64_t **values_out)
{
    int num_macros = 187;
    char **names = malloc(num_macros * sizeof(char *));
    int64_t *values = malloc(num_macros * sizeof(int64_t));
    
    {
        names[0] = "skyline_local_filter_9621zisegmap_51466_dim1";
        values[0] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51468;
    }
    {
        names[1] = "skyline_local_filter_9621zisegmap_51466zisegmap_tblock_sizze_51469";
        values[1] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51468;
    }
    {
        names[2] = "skyline_local_filter_9621zisegmap_51455_dim1";
        values[2] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51458;
    }
    {
        names[3] = "skyline_local_filter_9621zisegmap_51455zisegmap_tblock_sizze_51459";
        values[3] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51458;
    }
    {
        names[4] = "skyline_local_filter_9621zisegmap_51443_dim1";
        values[4] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51427;
    }
    {
        names[5] = "skyline_local_filter_9621zisegmap_51443zisegmap_tblock_sizze_51438";
        values[5] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51427;
    }
    {
        names[6] = "skyline_local_filter_9621zisegscan_51419_dim1";
        values[6] = *ctx->tuning_params.skyline_local_filter_9621zisegscan_tblock_sizze_51413;
    }
    {
        names[7] = "skyline_local_filter_9621zisegscan_51419zisegscan_tblock_sizze_51414";
        values[7] = *ctx->tuning_params.skyline_local_filter_9621zisegscan_tblock_sizze_51413;
    }
    {
        names[8] = "skyline_local_filter_9621zisegscan_51419zichunk_sizze_53643";
        values[8] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[9] = "skyline_local_filter_9621zisegmap_51372_dim1";
        values[9] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51320;
    }
    {
        names[10] = "skyline_local_filter_9621zisegmap_51372zisegmap_tblock_sizze_51367";
        values[10] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51320;
    }
    {
        names[11] = "skyline_local_filter_9621zisegmap_51307_dim1";
        values[11] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51286;
    }
    {
        names[12] = "skyline_local_filter_9621zisegmap_51307zisegmap_tblock_sizze_51302";
        values[12] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51286;
    }
    {
        names[13] = "skyline_local_filter_9621zisegred_large_53500_dim1";
        values[13] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[14] = "skyline_local_filter_9621zisegred_large_53500ziseghist_tblock_sizze_51258";
        values[14] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[15] = "skyline_local_filter_9621zisegred_large_53500zichunk_sizze_53501";
        values[15] = (int64_t) 1;
    }
    {
        names[16] = "skyline_local_filter_9621zisegred_small_53500_dim1";
        values[16] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[17] = "skyline_local_filter_9621zisegred_small_53500ziseghist_tblock_sizze_51258";
        values[17] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[18] = "skyline_local_filter_9621ziseghist_global_51265_dim1";
        values[18] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[19] = "skyline_local_filter_9621ziseghist_global_51265ziseghist_tblock_sizze_51258";
        values[19] = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    }
    {
        names[20] = "skyline_local_filter_9621ziseghist_local_51265_dim1";
        values[20] = ctx->max_thread_block_size;
    }
    {
        names[21] = "skyline_local_filter_9621ziseghist_local_51265zimax_tblock_sizze_53387";
        values[21] = ctx->max_thread_block_size;
    }
    {
        names[22] = "skyline_local_filter_9621zisegmap_51246_dim1";
        values[22] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50757;
    }
    {
        names[23] = "skyline_local_filter_9621zisegmap_51246zisegmap_tblock_sizze_51242";
        values[23] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50757;
    }
    {
        names[24] = "skyline_local_filter_9621zisegmap_51226_dim1";
        values[24] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50785;
    }
    {
        names[25] = "skyline_local_filter_9621zisegmap_51226zisegmap_tblock_sizze_51221";
        values[25] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50785;
    }
    {
        names[26] = "skyline_local_filter_9621zisegmap_51202_dim1";
        values[26] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50837;
    }
    {
        names[27] = "skyline_local_filter_9621zisegmap_51202zisegmap_tblock_sizze_51197";
        values[27] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50837;
    }
    {
        names[28] = "skyline_local_filter_9621zisegmap_51192_dim1";
        values[28] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50868;
    }
    {
        names[29] = "skyline_local_filter_9621zisegmap_51192zisegmap_tblock_sizze_51187";
        values[29] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50868;
    }
    {
        names[30] = "skyline_local_filter_9621zisegmap_51150_dim1";
        values[30] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50923;
    }
    {
        names[31] = "skyline_local_filter_9621zisegmap_51150zisegmap_tblock_sizze_51146";
        values[31] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50923;
    }
    {
        names[32] = "skyline_local_filter_9621zisegmap_51138_dim1";
        values[32] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50949;
    }
    {
        names[33] = "skyline_local_filter_9621zisegmap_51138zisegmap_tblock_sizze_51132";
        values[33] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50949;
    }
    {
        names[34] = "skyline_local_filter_9621zisegmap_51122_dim1";
        values[34] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50979;
    }
    {
        names[35] = "skyline_local_filter_9621zisegmap_51122zisegmap_tblock_sizze_51117";
        values[35] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50979;
    }
    {
        names[36] = "skyline_local_filter_9621zisegmap_51104_dim1";
        values[36] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50992;
    }
    {
        names[37] = "skyline_local_filter_9621zisegmap_51104zisegmap_tblock_sizze_51099";
        values[37] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50992;
    }
    {
        names[38] = "skyline_local_filter_9621zisegmap_51079_dim1";
        values[38] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51020;
    }
    {
        names[39] = "skyline_local_filter_9621zisegmap_51079zisegmap_tblock_sizze_51074";
        values[39] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51020;
    }
    {
        names[40] = "skyline_local_filter_9621zisegmap_50688_dim1";
        values[40] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50670;
    }
    {
        names[41] = "skyline_local_filter_9621zisegmap_50688zisegmap_tblock_sizze_50684";
        values[41] = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50670;
    }
    {
        names[42] = "filter_against_9751zisegmap_50347_dim1";
        values[42] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50284;
    }
    {
        names[43] = "filter_against_9751zisegmap_50347zisegmap_tblock_sizze_50343";
        values[43] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50284;
    }
    {
        names[44] = "filter_against_9751zisegmap_50338_dim1";
        values[44] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50298;
    }
    {
        names[45] = "filter_against_9751zisegmap_50338zisegmap_tblock_sizze_50333";
        values[45] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50298;
    }
    {
        names[46] = "filter_against_9751zisegmap_50325_dim1";
        values[46] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50310;
    }
    {
        names[47] = "filter_against_9751zisegmap_50325zisegmap_tblock_sizze_50321";
        values[47] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50310;
    }
    {
        names[48] = "filter_against_9751zisegmap_50273_dim1";
        values[48] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50275;
    }
    {
        names[49] = "filter_against_9751zisegmap_50273zisegmap_tblock_sizze_50276";
        values[49] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50275;
    }
    {
        names[50] = "filter_against_9751zisegscan_50271_dim1";
        values[50] = *ctx->tuning_params.filter_against_9751zisegscan_tblock_sizze_50265;
    }
    {
        names[51] = "filter_against_9751zisegscan_50271zisegscan_tblock_sizze_50266";
        values[51] = *ctx->tuning_params.filter_against_9751zisegscan_tblock_sizze_50265;
    }
    {
        names[52] = "filter_against_9751zisegscan_50271zichunk_sizze_53398";
        values[52] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[53] = "filter_against_9751zisegmap_50258_dim1";
        values[53] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50141;
    }
    {
        names[54] = "filter_against_9751zisegmap_50258zisegmap_tblock_sizze_50254";
        values[54] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50141;
    }
    {
        names[55] = "filter_against_9751zisegred_large_50211_dim1";
        values[55] = *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152;
    }
    {
        names[56] = "filter_against_9751zisegred_large_50211zisegred_tblock_sizze_50205";
        values[56] = *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152;
    }
    {
        names[57] = "filter_against_9751zisegred_large_50211zichunk_sizze_53278";
        values[57] = (int64_t) 1;
    }
    {
        names[58] = "filter_against_9751zisegred_small_50211_dim1";
        values[58] = *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152;
    }
    {
        names[59] = "filter_against_9751zisegred_small_50211zisegred_tblock_sizze_50205";
        values[59] = *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152;
    }
    {
        names[60] = "filter_against_9751zisegmap_50037_dim1";
        values[60] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_49983;
    }
    {
        names[61] = "filter_against_9751zisegmap_50037zisegmap_tblock_sizze_50033";
        values[61] = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_49983;
    }
    {
        names[62] = "skyline_slice_and_dice_floatzisegmap_52151_dim1";
        values[62] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153;
    }
    {
        names[63] = "skyline_slice_and_dice_floatzisegmap_52151zisegmap_tblock_sizze_52154";
        values[63] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153;
    }
    {
        names[64] = "skyline_slice_and_dice_floatzisegmap_52140_dim1";
        values[64] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143;
    }
    {
        names[65] = "skyline_slice_and_dice_floatzisegmap_52140zisegmap_tblock_sizze_52144";
        values[65] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143;
    }
    {
        names[66] = "skyline_slice_and_dice_floatzisegmap_52128_dim1";
        values[66] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112;
    }
    {
        names[67] = "skyline_slice_and_dice_floatzisegmap_52128zisegmap_tblock_sizze_52123";
        values[67] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112;
    }
    {
        names[68] = "skyline_slice_and_dice_floatzisegscan_52104_dim1";
        values[68] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098;
    }
    {
        names[69] = "skyline_slice_and_dice_floatzisegscan_52104zisegscan_tblock_sizze_52099";
        values[69] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098;
    }
    {
        names[70] = "skyline_slice_and_dice_floatzisegscan_52104zichunk_sizze_53894";
        values[70] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[71] = "skyline_slice_and_dice_floatzisegred_large_52059_dim1";
        values[71] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    }
    {
        names[72] = "skyline_slice_and_dice_floatzisegred_large_52059zisegred_tblock_sizze_52053";
        values[72] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    }
    {
        names[73] = "skyline_slice_and_dice_floatzisegred_large_52059zichunk_sizze_53810";
        values[73] = (int64_t) 1;
    }
    {
        names[74] = "skyline_slice_and_dice_floatzisegred_small_52059_dim1";
        values[74] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    }
    {
        names[75] = "skyline_slice_and_dice_floatzisegred_small_52059zisegred_tblock_sizze_52053";
        values[75] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    }
    {
        names[76] = "skyline_slice_and_dice_floatzisegmap_52047_dim1";
        values[76] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007;
    }
    {
        names[77] = "skyline_slice_and_dice_floatzisegmap_52047zisegmap_tblock_sizze_52042";
        values[77] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007;
    }
    {
        names[78] = "skyline_slice_and_dice_floatzisegmap_52034_dim1";
        values[78] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019;
    }
    {
        names[79] = "skyline_slice_and_dice_floatzisegmap_52034zisegmap_tblock_sizze_52030";
        values[79] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019;
    }
    {
        names[80] = "skyline_slice_and_dice_floatzisegmap_intrablock_52185_dim1";
        values[80] = *ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186;
    }
    {
        names[81] = "skyline_slice_and_dice_floatzisegmap_intrablock_52185zitile_sizze_52187";
        values[81] = *ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186;
    }
    {
        names[82] = "skyline_slice_and_dice_floatzisegmap_intrablock_52185zibytes_52734";
        values[82] = (int64_t) 8 * *ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186;
    }
    {
        names[83] = "skyline_slice_and_dice_floatzisegred_large_53674_dim1";
        values[83] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[84] = "skyline_slice_and_dice_floatzisegred_large_53674ziseghist_tblock_sizze_51783";
        values[84] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[85] = "skyline_slice_and_dice_floatzisegred_large_53674zichunk_sizze_53675";
        values[85] = (int64_t) 1;
    }
    {
        names[86] = "skyline_slice_and_dice_floatzisegred_small_53674_dim1";
        values[86] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[87] = "skyline_slice_and_dice_floatzisegred_small_53674ziseghist_tblock_sizze_51783";
        values[87] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[88] = "skyline_slice_and_dice_floatziseghist_global_51790_dim1";
        values[88] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[89] = "skyline_slice_and_dice_floatziseghist_global_51790ziseghist_tblock_sizze_51783";
        values[89] = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    }
    {
        names[90] = "skyline_slice_and_dice_floatziseghist_local_51790_dim1";
        values[90] = ctx->max_thread_block_size;
    }
    {
        names[91] = "skyline_slice_and_dice_floatziseghist_local_51790zimax_tblock_sizze_53598";
        values[91] = ctx->max_thread_block_size;
    }
    {
        names[92] = "skyline_slice_and_dice_floatzisegmap_51774_dim1";
        values[92] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667;
    }
    {
        names[93] = "skyline_slice_and_dice_floatzisegmap_51774zisegmap_tblock_sizze_51770";
        values[93] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667;
    }
    {
        names[94] = "skyline_slice_and_dice_floatzisegmap_51750_dim1";
        values[94] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691;
    }
    {
        names[95] = "skyline_slice_and_dice_floatzisegmap_51750zisegmap_tblock_sizze_51745";
        values[95] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691;
    }
    {
        names[96] = "skyline_slice_and_dice_floatzisegred_nonseg_51662_dim1";
        values[96] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51654;
    }
    {
        names[97] = "skyline_slice_and_dice_floatzisegred_nonseg_51662zisegred_tblock_sizze_51655";
        values[97] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51654;
    }
    {
        names[98] = "skyline_slice_and_dice_floatzisegred_nonseg_51662zichunk_sizze_53530";
        values[98] = (int64_t) 1;
    }
    {
        names[99] = "skyline_slice_and_dice_floatzisegmap_51649_dim1";
        values[99] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586;
    }
    {
        names[100] = "skyline_slice_and_dice_floatzisegmap_51649zisegmap_tblock_sizze_51645";
        values[100] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586;
    }
    {
        names[101] = "skyline_slice_and_dice_floatzisegmap_51640_dim1";
        values[101] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600;
    }
    {
        names[102] = "skyline_slice_and_dice_floatzisegmap_51640zisegmap_tblock_sizze_51635";
        values[102] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600;
    }
    {
        names[103] = "skyline_slice_and_dice_floatzisegmap_51627_dim1";
        values[103] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612;
    }
    {
        names[104] = "skyline_slice_and_dice_floatzisegmap_51627zisegmap_tblock_sizze_51623";
        values[104] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612;
    }
    {
        names[105] = "skyline_slice_and_dice_floatzisegmap_51575_dim1";
        values[105] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577;
    }
    {
        names[106] = "skyline_slice_and_dice_floatzisegmap_51575zisegmap_tblock_sizze_51578";
        values[106] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577;
    }
    {
        names[107] = "skyline_slice_and_dice_floatzisegscan_51573_dim1";
        values[107] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567;
    }
    {
        names[108] = "skyline_slice_and_dice_floatzisegscan_51573zisegscan_tblock_sizze_51568";
        values[108] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567;
    }
    {
        names[109] = "skyline_slice_and_dice_floatzisegscan_51573zichunk_sizze_53316";
        values[109] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[110] = "skyline_slice_and_dice_floatzisegmap_51533_dim1";
        values[110] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488;
    }
    {
        names[111] = "skyline_slice_and_dice_floatzisegmap_51533zisegmap_tblock_sizze_51528";
        values[111] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488;
    }
    {
        names[112] = "skyline_slice_and_dice_floatzisegred_nonseg_51483_dim1";
        values[112] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51474;
    }
    {
        names[113] = "skyline_slice_and_dice_floatzisegred_nonseg_51483zisegred_tblock_sizze_51475";
        values[113] = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51474;
    }
    {
        names[114] = "skyline_slice_and_dice_floatzisegred_nonseg_51483zichunk_sizze_53223";
        values[114] = (int64_t) 1;
    }
    {
        names[115] = "skyline_merge_5_floatzisegmap_49521_dim1";
        values[115] = *ctx->tuning_params.skyline_merge_5_floatzisegmap_tblock_sizze_49502;
    }
    {
        names[116] = "skyline_merge_5_floatzisegmap_49521zisegmap_tblock_sizze_49517";
        values[116] = *ctx->tuning_params.skyline_merge_5_floatzisegmap_tblock_sizze_49502;
    }
    {
        names[117] = "skyline_merge_4_floatzisegmap_49447_dim1";
        values[117] = *ctx->tuning_params.skyline_merge_4_floatzisegmap_tblock_sizze_49430;
    }
    {
        names[118] = "skyline_merge_4_floatzisegmap_49447zisegmap_tblock_sizze_49443";
        values[118] = *ctx->tuning_params.skyline_merge_4_floatzisegmap_tblock_sizze_49430;
    }
    {
        names[119] = "skyline_merge_3_floatzisegmap_49401_dim1";
        values[119] = *ctx->tuning_params.skyline_merge_3_floatzisegmap_tblock_sizze_49386;
    }
    {
        names[120] = "skyline_merge_3_floatzisegmap_49401zisegmap_tblock_sizze_49397";
        values[120] = *ctx->tuning_params.skyline_merge_3_floatzisegmap_tblock_sizze_49386;
    }
    {
        names[121] = "skyline_merge_2_floatzisegmap_49423_dim1";
        values[121] = *ctx->tuning_params.skyline_merge_2_floatzisegmap_tblock_sizze_49410;
    }
    {
        names[122] = "skyline_merge_2_floatzisegmap_49423zisegmap_tblock_sizze_49419";
        values[122] = *ctx->tuning_params.skyline_merge_2_floatzisegmap_tblock_sizze_49410;
    }
    {
        names[123] = "skyline_mergeFilter_5_floatzisegmap_49581_dim1";
        values[123] = *ctx->tuning_params.skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562;
    }
    {
        names[124] = "skyline_mergeFilter_5_floatzisegmap_49581zisegmap_tblock_sizze_49577";
        values[124] = *ctx->tuning_params.skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562;
    }
    {
        names[125] = "skyline_mergeFilter_4_floatzisegmap_49551_dim1";
        values[125] = *ctx->tuning_params.skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534;
    }
    {
        names[126] = "skyline_mergeFilter_4_floatzisegmap_49551zisegmap_tblock_sizze_49547";
        values[126] = *ctx->tuning_params.skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534;
    }
    {
        names[127] = "skyline_mergeFilter_3_floatzisegmap_49473_dim1";
        values[127] = *ctx->tuning_params.skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458;
    }
    {
        names[128] = "skyline_mergeFilter_3_floatzisegmap_49473zisegmap_tblock_sizze_49469";
        values[128] = *ctx->tuning_params.skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458;
    }
    {
        names[129] = "skyline_mergeFilter_2_floatzisegmap_49495_dim1";
        values[129] = *ctx->tuning_params.skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482;
    }
    {
        names[130] = "skyline_mergeFilter_2_floatzisegmap_49495zisegmap_tblock_sizze_49491";
        values[130] = *ctx->tuning_params.skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482;
    }
    {
        names[131] = "skyline_intermediate_filter_floatzisegmap_50660_dim1";
        values[131] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644;
    }
    {
        names[132] = "skyline_intermediate_filter_floatzisegmap_50660zisegmap_tblock_sizze_50656";
        values[132] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644;
    }
    {
        names[133] = "skyline_intermediate_filter_floatzisegred_nonseg_50595_dim1";
        values[133] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50587;
    }
    {
        names[134] = "skyline_intermediate_filter_floatzisegred_nonseg_50595zisegred_tblock_sizze_50588";
        values[134] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50587;
    }
    {
        names[135] = "skyline_intermediate_filter_floatzisegred_nonseg_50595zichunk_sizze_53594";
        values[135] = (int64_t) 1;
    }
    {
        names[136] = "skyline_intermediate_filter_floatzisegscan_50585_dim1";
        values[136] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579;
    }
    {
        names[137] = "skyline_intermediate_filter_floatzisegscan_50585zisegscan_tblock_sizze_50580";
        values[137] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579;
    }
    {
        names[138] = "skyline_intermediate_filter_floatzisegscan_50585zichunk_sizze_53496";
        values[138] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[139] = "skyline_intermediate_filter_floatzisegmap_50629_dim1";
        values[139] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607;
    }
    {
        names[140] = "skyline_intermediate_filter_floatzisegmap_50629zisegmap_tblock_sizze_50624";
        values[140] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607;
    }
    {
        names[141] = "skyline_intermediate_filter_floatzisegscan_50603_dim1";
        values[141] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597;
    }
    {
        names[142] = "skyline_intermediate_filter_floatzisegscan_50603zisegscan_tblock_sizze_50598";
        values[142] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597;
    }
    {
        names[143] = "skyline_intermediate_filter_floatzisegscan_50603zichunk_sizze_53329";
        values[143] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[144] = "skyline_intermediate_filter_floatzisegmap_50572_dim1";
        values[144] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559;
    }
    {
        names[145] = "skyline_intermediate_filter_floatzisegmap_50572zisegmap_tblock_sizze_50568";
        values[145] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559;
    }
    {
        names[146] = "skyline_intermediate_filter_floatzisegred_nonseg_50555_dim1";
        values[146] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50547;
    }
    {
        names[147] = "skyline_intermediate_filter_floatzisegred_nonseg_50555zisegred_tblock_sizze_50548";
        values[147] = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50547;
    }
    {
        names[148] = "skyline_intermediate_filter_floatzisegred_nonseg_50555zichunk_sizze_53242";
        values[148] = (int64_t) 1;
    }
    {
        names[149] = "make_skylineBase_floatzisegmap_50523_dim1";
        values[149] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50456;
    }
    {
        names[150] = "make_skylineBase_floatzisegmap_50523zisegmap_tblock_sizze_50518";
        values[150] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50456;
    }
    {
        names[151] = "make_skylineBase_floatzisegmap_50436_dim1";
        values[151] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50420;
    }
    {
        names[152] = "make_skylineBase_floatzisegmap_50436zisegmap_tblock_sizze_50432";
        values[152] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50420;
    }
    {
        names[153] = "make_skylineBase_floatzisegmap_50410_dim1";
        values[153] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50394;
    }
    {
        names[154] = "make_skylineBase_floatzisegmap_50410zisegmap_tblock_sizze_50406";
        values[154] = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50394;
    }
    {
        names[155] = "make_skylineBase_floatzisegred_nonseg_50390_dim1";
        values[155] = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50382;
    }
    {
        names[156] = "make_skylineBase_floatzisegred_nonseg_50390zisegred_tblock_sizze_50383";
        values[156] = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50382;
    }
    {
        names[157] = "make_skylineBase_floatzisegred_nonseg_50390zichunk_sizze_53510";
        values[157] = (int64_t) 1;
    }
    {
        names[158] = "make_skylineBase_floatzisegscan_50380_dim1";
        values[158] = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50374;
    }
    {
        names[159] = "make_skylineBase_floatzisegscan_50380zisegscan_tblock_sizze_50375";
        values[159] = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50374;
    }
    {
        names[160] = "make_skylineBase_floatzisegscan_50380zichunk_sizze_53411";
        values[160] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[161] = "make_skylineBase_floatzisegred_nonseg_50370_dim1";
        values[161] = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50362;
    }
    {
        names[162] = "make_skylineBase_floatzisegred_nonseg_50370zisegred_tblock_sizze_50363";
        values[162] = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50362;
    }
    {
        names[163] = "make_skylineBase_floatzisegred_nonseg_50370zichunk_sizze_53372";
        values[163] = (int64_t) 1;
    }
    {
        names[164] = "make_skylineBase_floatzisegscan_50360_dim1";
        values[164] = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50354;
    }
    {
        names[165] = "make_skylineBase_floatzisegscan_50360zisegscan_tblock_sizze_50355";
        values[165] = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50354;
    }
    {
        names[166] = "make_skylineBase_floatzisegscan_50360zichunk_sizze_53233";
        values[166] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[167] = "calc_global_Skyline_9665zisegmap_49967_dim1";
        values[167] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49904;
    }
    {
        names[168] = "calc_global_Skyline_9665zisegmap_49967zisegmap_tblock_sizze_49963";
        values[168] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49904;
    }
    {
        names[169] = "calc_global_Skyline_9665zisegmap_49958_dim1";
        values[169] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49918;
    }
    {
        names[170] = "calc_global_Skyline_9665zisegmap_49958zisegmap_tblock_sizze_49953";
        values[170] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49918;
    }
    {
        names[171] = "calc_global_Skyline_9665zisegmap_49945_dim1";
        values[171] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49930;
    }
    {
        names[172] = "calc_global_Skyline_9665zisegmap_49945zisegmap_tblock_sizze_49941";
        values[172] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49930;
    }
    {
        names[173] = "calc_global_Skyline_9665zisegmap_49893_dim1";
        values[173] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49895;
    }
    {
        names[174] = "calc_global_Skyline_9665zisegmap_49893zisegmap_tblock_sizze_49896";
        values[174] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49895;
    }
    {
        names[175] = "calc_global_Skyline_9665zisegscan_49891_dim1";
        values[175] = *ctx->tuning_params.calc_global_Skyline_9665zisegscan_tblock_sizze_49885;
    }
    {
        names[176] = "calc_global_Skyline_9665zisegscan_49891zisegscan_tblock_sizze_49886";
        values[176] = *ctx->tuning_params.calc_global_Skyline_9665zisegscan_tblock_sizze_49885;
    }
    {
        names[177] = "calc_global_Skyline_9665zisegscan_49891zichunk_sizze_53398";
        values[177] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[178] = "calc_global_Skyline_9665zisegmap_49878_dim1";
        values[178] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49761;
    }
    {
        names[179] = "calc_global_Skyline_9665zisegmap_49878zisegmap_tblock_sizze_49874";
        values[179] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49761;
    }
    {
        names[180] = "calc_global_Skyline_9665zisegred_large_49831_dim1";
        values[180] = *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    }
    {
        names[181] = "calc_global_Skyline_9665zisegred_large_49831zisegred_tblock_sizze_49825";
        values[181] = *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    }
    {
        names[182] = "calc_global_Skyline_9665zisegred_large_49831zichunk_sizze_53278";
        values[182] = (int64_t) 1;
    }
    {
        names[183] = "calc_global_Skyline_9665zisegred_small_49831_dim1";
        values[183] = *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    }
    {
        names[184] = "calc_global_Skyline_9665zisegred_small_49831zisegred_tblock_sizze_49825";
        values[184] = *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    }
    {
        names[185] = "calc_global_Skyline_9665zisegmap_49657_dim1";
        values[185] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49603;
    }
    {
        names[186] = "calc_global_Skyline_9665zisegmap_49657zisegmap_tblock_sizze_49653";
        values[186] = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49603;
    }
    *names_out = names;
    *values_out = values;
    return num_macros;
}
static char *get_failure_msg(int failure_idx, int64_t args[])
{
    (void) args;
    switch (failure_idx) {
        
      case 0:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:355:65-75\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:355:54-76\n", args[0], args[1]);
            break;
        }
        
      case 1:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftSkyline.fut:75:89-97\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:72:52-77:50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftSkyline.fut:70:36-78:34\n   #5  ft_libs/ftSkyline.fut:626:25-627:112\n   #6  ft_libs/ftSkyline.fut:619:17-627:112\n");
            break;
        }
        
      case 2:
        {
            return msgprintf("division by zero\n-> #0  ft_libs/ftSkyline.fut:75:98-105\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:72:52-77:50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftSkyline.fut:70:36-78:34\n   #5  ft_libs/ftSkyline.fut:626:25-627:112\n   #6  ft_libs/ftSkyline.fut:619:17-627:112\n");
            break;
        }
        
      case 3:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:211:75-81\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:211:64-82\n   #3  /prelude/functional.fut:9:44-45\n   #4  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 4:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:212:52-57\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 5:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:227:65-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:227:53-78\n   #3  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 6:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:247:54-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 7:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:250:71-108\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 8:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:252:66-95\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 9:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:250:71-108\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 10:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:252:66-95\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 11:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:247:54-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 12:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:250:71-108\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 13:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:247:54-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 14:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:250:71-108\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 15:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:250:71-108\n   #1  /prelude/soacs.fut:205:28-30\n   #2  /prelude/functional.fut:9:44-45\n   #3  ft_libs/ftSkyline.fut:249:52-255:50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 16:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:259:55-75\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:259:36-80\n   #3  ft_libs/ftSkyline.fut:629:17-635:112\n", args[0], args[1]);
            break;
        }
        
      case 17:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:482:65-76\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:482:54-77\n", args[0], args[1]);
            break;
        }
        
      case 18:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:159:59-89\n   #1  ft_libs/ftSkyline.fut:180:26-183:84\n   #2  ft_libs/ftSkyline.fut:269:26-276:83\n   #3  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
        
      case 19:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:289:55-65\n   #1  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
        
      case 20:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:305:90-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:305:75-97\n   #3  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
        
      case 21:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:307:71-81\n   #1  /prelude/functional.fut:9:44-45\n   #2  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
        
      case 22:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:313:71-85\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:313:52-86\n   #3  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
        
      case 23:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ft_libs/ftSkyline.fut:321:49-78\n   #1  /prelude/functional.fut:9:44-45\n", args[0], args[1]);
            break;
        }
    }
    return strdup("Unknown error.  This is a compiler bug.");
}
struct program {
    int dummy;
    gpu_kernel builtinzhiota_i64ziiota_i64_53454;
    gpu_kernel builtinzhreplicate_boolzireplicate_53514;
    gpu_kernel builtinzhreplicate_f32zireplicate_53288;
    gpu_kernel builtinzhreplicate_i32zireplicate_53231;
    gpu_kernel builtinzhreplicate_i64zireplicate_53359;
    gpu_kernel builtinzhreplicate_i8zireplicate_53326;
    gpu_kernel calc_global_Skyline_9665zisegmap_49657;
    gpu_kernel calc_global_Skyline_9665zisegmap_49878;
    gpu_kernel calc_global_Skyline_9665zisegmap_49893;
    gpu_kernel calc_global_Skyline_9665zisegmap_49945;
    gpu_kernel calc_global_Skyline_9665zisegmap_49958;
    gpu_kernel calc_global_Skyline_9665zisegmap_49967;
    gpu_kernel calc_global_Skyline_9665zisegmap_intrablock_49709;
    gpu_kernel calc_global_Skyline_9665zisegred_large_49831;
    gpu_kernel calc_global_Skyline_9665zisegred_small_49831;
    gpu_kernel calc_global_Skyline_9665zisegscan_49891;
    gpu_kernel filter_against_9751zisegmap_50037;
    gpu_kernel filter_against_9751zisegmap_50258;
    gpu_kernel filter_against_9751zisegmap_50273;
    gpu_kernel filter_against_9751zisegmap_50325;
    gpu_kernel filter_against_9751zisegmap_50338;
    gpu_kernel filter_against_9751zisegmap_50347;
    gpu_kernel filter_against_9751zisegmap_intrablock_50089;
    gpu_kernel filter_against_9751zisegred_large_50211;
    gpu_kernel filter_against_9751zisegred_small_50211;
    gpu_kernel filter_against_9751zisegscan_50271;
    gpu_kernel make_skylineBase_floatzisegmap_50410;
    gpu_kernel make_skylineBase_floatzisegmap_50436;
    gpu_kernel make_skylineBase_floatzisegmap_50523;
    gpu_kernel make_skylineBase_floatzisegred_nonseg_50370;
    gpu_kernel make_skylineBase_floatzisegred_nonseg_50390;
    gpu_kernel make_skylineBase_floatzisegscan_50360;
    gpu_kernel make_skylineBase_floatzisegscan_50380;
    gpu_kernel skyline_intermediate_filter_floatzireplicate_53457;
    gpu_kernel skyline_intermediate_filter_floatzisegmap_50572;
    gpu_kernel skyline_intermediate_filter_floatzisegmap_50629;
    gpu_kernel skyline_intermediate_filter_floatzisegmap_50660;
    gpu_kernel skyline_intermediate_filter_floatzisegred_nonseg_50555;
    gpu_kernel skyline_intermediate_filter_floatzisegred_nonseg_50595;
    gpu_kernel skyline_intermediate_filter_floatzisegscan_50585;
    gpu_kernel skyline_intermediate_filter_floatzisegscan_50603;
    gpu_kernel skyline_local_filter_9621ziseghist_global_51265;
    gpu_kernel skyline_local_filter_9621ziseghist_local_51265;
    gpu_kernel skyline_local_filter_9621zisegmap_50688;
    gpu_kernel skyline_local_filter_9621zisegmap_51079;
    gpu_kernel skyline_local_filter_9621zisegmap_51104;
    gpu_kernel skyline_local_filter_9621zisegmap_51122;
    gpu_kernel skyline_local_filter_9621zisegmap_51138;
    gpu_kernel skyline_local_filter_9621zisegmap_51150;
    gpu_kernel skyline_local_filter_9621zisegmap_51192;
    gpu_kernel skyline_local_filter_9621zisegmap_51202;
    gpu_kernel skyline_local_filter_9621zisegmap_51226;
    gpu_kernel skyline_local_filter_9621zisegmap_51246;
    gpu_kernel skyline_local_filter_9621zisegmap_51307;
    gpu_kernel skyline_local_filter_9621zisegmap_51372;
    gpu_kernel skyline_local_filter_9621zisegmap_51443;
    gpu_kernel skyline_local_filter_9621zisegmap_51455;
    gpu_kernel skyline_local_filter_9621zisegmap_51466;
    gpu_kernel skyline_local_filter_9621zisegred_large_53500;
    gpu_kernel skyline_local_filter_9621zisegred_small_53500;
    gpu_kernel skyline_local_filter_9621zisegscan_51419;
    gpu_kernel skyline_mergeFilter_2_floatzisegmap_49495;
    gpu_kernel skyline_mergeFilter_3_floatzisegmap_49473;
    gpu_kernel skyline_mergeFilter_4_floatzisegmap_49551;
    gpu_kernel skyline_mergeFilter_5_floatzisegmap_49581;
    gpu_kernel skyline_merge_2_floatzisegmap_49423;
    gpu_kernel skyline_merge_3_floatzisegmap_49401;
    gpu_kernel skyline_merge_4_floatzisegmap_49447;
    gpu_kernel skyline_merge_5_floatzisegmap_49521;
    gpu_kernel skyline_slice_and_dice_floatziseghist_global_51790;
    gpu_kernel skyline_slice_and_dice_floatziseghist_local_51790;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51533;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51575;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51627;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51640;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51649;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51750;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_51774;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_52034;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_52047;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_52128;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_52140;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_52151;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_intrablock_51907;
    gpu_kernel skyline_slice_and_dice_floatzisegmap_intrablock_52185;
    gpu_kernel skyline_slice_and_dice_floatzisegred_large_52059;
    gpu_kernel skyline_slice_and_dice_floatzisegred_large_53674;
    gpu_kernel skyline_slice_and_dice_floatzisegred_nonseg_51483;
    gpu_kernel skyline_slice_and_dice_floatzisegred_nonseg_51662;
    gpu_kernel skyline_slice_and_dice_floatzisegred_small_52059;
    gpu_kernel skyline_slice_and_dice_floatzisegred_small_53674;
    gpu_kernel skyline_slice_and_dice_floatzisegscan_51573;
    gpu_kernel skyline_slice_and_dice_floatzisegscan_52104;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    gpu_create_kernel(ctx, &ctx->program->builtinzhiota_i64ziiota_i64_53454, "builtinzhiota_i64ziiota_i64_53454");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_boolzireplicate_53514, "builtinzhreplicate_boolzireplicate_53514");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_f32zireplicate_53288, "builtinzhreplicate_f32zireplicate_53288");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i32zireplicate_53231, "builtinzhreplicate_i32zireplicate_53231");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i64zireplicate_53359, "builtinzhreplicate_i64zireplicate_53359");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i8zireplicate_53326, "builtinzhreplicate_i8zireplicate_53326");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49657, "calc_global_Skyline_9665zisegmap_49657");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49878, "calc_global_Skyline_9665zisegmap_49878");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49893, "calc_global_Skyline_9665zisegmap_49893");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49945, "calc_global_Skyline_9665zisegmap_49945");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49958, "calc_global_Skyline_9665zisegmap_49958");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_49967, "calc_global_Skyline_9665zisegmap_49967");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegmap_intrablock_49709, "calc_global_Skyline_9665zisegmap_intrablock_49709");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegred_large_49831, "calc_global_Skyline_9665zisegred_large_49831");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegred_small_49831, "calc_global_Skyline_9665zisegred_small_49831");
    gpu_create_kernel(ctx, &ctx->program->calc_global_Skyline_9665zisegscan_49891, "calc_global_Skyline_9665zisegscan_49891");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50037, "filter_against_9751zisegmap_50037");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50258, "filter_against_9751zisegmap_50258");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50273, "filter_against_9751zisegmap_50273");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50325, "filter_against_9751zisegmap_50325");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50338, "filter_against_9751zisegmap_50338");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_50347, "filter_against_9751zisegmap_50347");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegmap_intrablock_50089, "filter_against_9751zisegmap_intrablock_50089");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegred_large_50211, "filter_against_9751zisegred_large_50211");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegred_small_50211, "filter_against_9751zisegred_small_50211");
    gpu_create_kernel(ctx, &ctx->program->filter_against_9751zisegscan_50271, "filter_against_9751zisegscan_50271");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegmap_50410, "make_skylineBase_floatzisegmap_50410");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegmap_50436, "make_skylineBase_floatzisegmap_50436");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegmap_50523, "make_skylineBase_floatzisegmap_50523");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegred_nonseg_50370, "make_skylineBase_floatzisegred_nonseg_50370");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegred_nonseg_50390, "make_skylineBase_floatzisegred_nonseg_50390");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegscan_50360, "make_skylineBase_floatzisegscan_50360");
    gpu_create_kernel(ctx, &ctx->program->make_skylineBase_floatzisegscan_50380, "make_skylineBase_floatzisegscan_50380");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzireplicate_53457, "skyline_intermediate_filter_floatzireplicate_53457");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegmap_50572, "skyline_intermediate_filter_floatzisegmap_50572");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegmap_50629, "skyline_intermediate_filter_floatzisegmap_50629");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegmap_50660, "skyline_intermediate_filter_floatzisegmap_50660");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50555, "skyline_intermediate_filter_floatzisegred_nonseg_50555");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50595, "skyline_intermediate_filter_floatzisegred_nonseg_50595");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegscan_50585, "skyline_intermediate_filter_floatzisegscan_50585");
    gpu_create_kernel(ctx, &ctx->program->skyline_intermediate_filter_floatzisegscan_50603, "skyline_intermediate_filter_floatzisegscan_50603");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621ziseghist_global_51265, "skyline_local_filter_9621ziseghist_global_51265");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621ziseghist_local_51265, "skyline_local_filter_9621ziseghist_local_51265");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_50688, "skyline_local_filter_9621zisegmap_50688");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51079, "skyline_local_filter_9621zisegmap_51079");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51104, "skyline_local_filter_9621zisegmap_51104");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51122, "skyline_local_filter_9621zisegmap_51122");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51138, "skyline_local_filter_9621zisegmap_51138");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51150, "skyline_local_filter_9621zisegmap_51150");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51192, "skyline_local_filter_9621zisegmap_51192");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51202, "skyline_local_filter_9621zisegmap_51202");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51226, "skyline_local_filter_9621zisegmap_51226");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51246, "skyline_local_filter_9621zisegmap_51246");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51307, "skyline_local_filter_9621zisegmap_51307");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51372, "skyline_local_filter_9621zisegmap_51372");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51443, "skyline_local_filter_9621zisegmap_51443");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51455, "skyline_local_filter_9621zisegmap_51455");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegmap_51466, "skyline_local_filter_9621zisegmap_51466");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegred_large_53500, "skyline_local_filter_9621zisegred_large_53500");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegred_small_53500, "skyline_local_filter_9621zisegred_small_53500");
    gpu_create_kernel(ctx, &ctx->program->skyline_local_filter_9621zisegscan_51419, "skyline_local_filter_9621zisegscan_51419");
    gpu_create_kernel(ctx, &ctx->program->skyline_mergeFilter_2_floatzisegmap_49495, "skyline_mergeFilter_2_floatzisegmap_49495");
    gpu_create_kernel(ctx, &ctx->program->skyline_mergeFilter_3_floatzisegmap_49473, "skyline_mergeFilter_3_floatzisegmap_49473");
    gpu_create_kernel(ctx, &ctx->program->skyline_mergeFilter_4_floatzisegmap_49551, "skyline_mergeFilter_4_floatzisegmap_49551");
    gpu_create_kernel(ctx, &ctx->program->skyline_mergeFilter_5_floatzisegmap_49581, "skyline_mergeFilter_5_floatzisegmap_49581");
    gpu_create_kernel(ctx, &ctx->program->skyline_merge_2_floatzisegmap_49423, "skyline_merge_2_floatzisegmap_49423");
    gpu_create_kernel(ctx, &ctx->program->skyline_merge_3_floatzisegmap_49401, "skyline_merge_3_floatzisegmap_49401");
    gpu_create_kernel(ctx, &ctx->program->skyline_merge_4_floatzisegmap_49447, "skyline_merge_4_floatzisegmap_49447");
    gpu_create_kernel(ctx, &ctx->program->skyline_merge_5_floatzisegmap_49521, "skyline_merge_5_floatzisegmap_49521");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatziseghist_global_51790, "skyline_slice_and_dice_floatziseghist_global_51790");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatziseghist_local_51790, "skyline_slice_and_dice_floatziseghist_local_51790");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51533, "skyline_slice_and_dice_floatzisegmap_51533");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51575, "skyline_slice_and_dice_floatzisegmap_51575");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51627, "skyline_slice_and_dice_floatzisegmap_51627");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51640, "skyline_slice_and_dice_floatzisegmap_51640");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51649, "skyline_slice_and_dice_floatzisegmap_51649");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51750, "skyline_slice_and_dice_floatzisegmap_51750");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_51774, "skyline_slice_and_dice_floatzisegmap_51774");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_52034, "skyline_slice_and_dice_floatzisegmap_52034");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_52047, "skyline_slice_and_dice_floatzisegmap_52047");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_52128, "skyline_slice_and_dice_floatzisegmap_52128");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_52140, "skyline_slice_and_dice_floatzisegmap_52140");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_52151, "skyline_slice_and_dice_floatzisegmap_52151");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_51907, "skyline_slice_and_dice_floatzisegmap_intrablock_51907");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_52185, "skyline_slice_and_dice_floatzisegmap_intrablock_52185");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_large_52059, "skyline_slice_and_dice_floatzisegred_large_52059");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_large_53674, "skyline_slice_and_dice_floatzisegred_large_53674");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51483, "skyline_slice_and_dice_floatzisegred_nonseg_51483");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51662, "skyline_slice_and_dice_floatzisegred_nonseg_51662");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_small_52059, "skyline_slice_and_dice_floatzisegred_small_52059");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegred_small_53674, "skyline_slice_and_dice_floatzisegred_small_53674");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegscan_51573, "skyline_slice_and_dice_floatzisegscan_51573");
    gpu_create_kernel(ctx, &ctx->program->skyline_slice_and_dice_floatzisegscan_52104, "skyline_slice_and_dice_floatzisegscan_52104");
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    gpu_free_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_53454);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_boolzireplicate_53514);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_53288);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_53231);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_53359);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_53326);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49657);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49878);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49893);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49945);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49958);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49967);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_intrablock_49709);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegred_large_49831);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegred_small_49831);
    gpu_free_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegscan_49891);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50037);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50258);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50273);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50325);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50338);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_50347);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegmap_intrablock_50089);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegred_large_50211);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegred_small_50211);
    gpu_free_kernel(ctx, ctx->program->filter_against_9751zisegscan_50271);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50410);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50436);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50523);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegred_nonseg_50370);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegred_nonseg_50390);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegscan_50360);
    gpu_free_kernel(ctx, ctx->program->make_skylineBase_floatzisegscan_50380);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzireplicate_53457);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50572);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50629);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50660);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50555);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50595);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegscan_50585);
    gpu_free_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegscan_50603);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621ziseghist_global_51265);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621ziseghist_local_51265);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_50688);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51079);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51104);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51122);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51138);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51150);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51192);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51202);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51226);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51246);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51307);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51372);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51443);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51455);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51466);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegred_large_53500);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegred_small_53500);
    gpu_free_kernel(ctx, ctx->program->skyline_local_filter_9621zisegscan_51419);
    gpu_free_kernel(ctx, ctx->program->skyline_mergeFilter_2_floatzisegmap_49495);
    gpu_free_kernel(ctx, ctx->program->skyline_mergeFilter_3_floatzisegmap_49473);
    gpu_free_kernel(ctx, ctx->program->skyline_mergeFilter_4_floatzisegmap_49551);
    gpu_free_kernel(ctx, ctx->program->skyline_mergeFilter_5_floatzisegmap_49581);
    gpu_free_kernel(ctx, ctx->program->skyline_merge_2_floatzisegmap_49423);
    gpu_free_kernel(ctx, ctx->program->skyline_merge_3_floatzisegmap_49401);
    gpu_free_kernel(ctx, ctx->program->skyline_merge_4_floatzisegmap_49447);
    gpu_free_kernel(ctx, ctx->program->skyline_merge_5_floatzisegmap_49521);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatziseghist_global_51790);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatziseghist_local_51790);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51533);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51575);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51627);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51640);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51649);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51750);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51774);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52034);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52047);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52128);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52140);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52151);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_51907);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_52185);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_large_52059);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_large_53674);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51483);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51662);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_small_52059);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_small_53674);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegscan_51573);
    gpu_free_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegscan_52104);
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
    ctx->tuning_params.builtinzhiota_i64zitblock_sizze_53458 = &ctx->cfg->tuning_params[0];
    ctx->tuning_params.builtinzhreplicate_boolzitblock_sizze_53518 = &ctx->cfg->tuning_params[1];
    ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_53292 = &ctx->cfg->tuning_params[2];
    ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_53235 = &ctx->cfg->tuning_params[3];
    ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_53363 = &ctx->cfg->tuning_params[4];
    ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_53330 = &ctx->cfg->tuning_params[5];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_num_tblocks_49897 = &ctx->cfg->tuning_params[6];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49603 = &ctx->cfg->tuning_params[7];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49761 = &ctx->cfg->tuning_params[8];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49895 = &ctx->cfg->tuning_params[9];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49904 = &ctx->cfg->tuning_params[10];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49918 = &ctx->cfg->tuning_params[11];
    ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49930 = &ctx->cfg->tuning_params[12];
    ctx->tuning_params.calc_global_Skyline_9665zisegred_num_tblocks_49774 = &ctx->cfg->tuning_params[13];
    ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772 = &ctx->cfg->tuning_params[14];
    ctx->tuning_params.calc_global_Skyline_9665zisegscan_num_tblocks_49887 = &ctx->cfg->tuning_params[15];
    ctx->tuning_params.calc_global_Skyline_9665zisegscan_tblock_sizze_49885 = &ctx->cfg->tuning_params[16];
    ctx->tuning_params.calc_global_Skyline_9665zisuff_intra_par_1 = &ctx->cfg->tuning_params[17];
    ctx->tuning_params.calc_global_Skyline_9665zisuff_outer_par_0 = &ctx->cfg->tuning_params[18];
    ctx->tuning_params.filter_against_9751zisegmap_num_tblocks_50277 = &ctx->cfg->tuning_params[19];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_49983 = &ctx->cfg->tuning_params[20];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50141 = &ctx->cfg->tuning_params[21];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50275 = &ctx->cfg->tuning_params[22];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50284 = &ctx->cfg->tuning_params[23];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50298 = &ctx->cfg->tuning_params[24];
    ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50310 = &ctx->cfg->tuning_params[25];
    ctx->tuning_params.filter_against_9751zisegred_num_tblocks_50154 = &ctx->cfg->tuning_params[26];
    ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152 = &ctx->cfg->tuning_params[27];
    ctx->tuning_params.filter_against_9751zisegscan_num_tblocks_50267 = &ctx->cfg->tuning_params[28];
    ctx->tuning_params.filter_against_9751zisegscan_tblock_sizze_50265 = &ctx->cfg->tuning_params[29];
    ctx->tuning_params.filter_against_9751zisuff_intra_par_1 = &ctx->cfg->tuning_params[30];
    ctx->tuning_params.filter_against_9751zisuff_outer_par_0 = &ctx->cfg->tuning_params[31];
    ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50394 = &ctx->cfg->tuning_params[32];
    ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50420 = &ctx->cfg->tuning_params[33];
    ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50456 = &ctx->cfg->tuning_params[34];
    ctx->tuning_params.make_skylineBase_floatzisegred_num_tblocks_50364 = &ctx->cfg->tuning_params[35];
    ctx->tuning_params.make_skylineBase_floatzisegred_num_tblocks_50384 = &ctx->cfg->tuning_params[36];
    ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50362 = &ctx->cfg->tuning_params[37];
    ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50382 = &ctx->cfg->tuning_params[38];
    ctx->tuning_params.make_skylineBase_floatzisegscan_num_tblocks_50356 = &ctx->cfg->tuning_params[39];
    ctx->tuning_params.make_skylineBase_floatzisegscan_num_tblocks_50376 = &ctx->cfg->tuning_params[40];
    ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50354 = &ctx->cfg->tuning_params[41];
    ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50374 = &ctx->cfg->tuning_params[42];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559 = &ctx->cfg->tuning_params[43];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607 = &ctx->cfg->tuning_params[44];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644 = &ctx->cfg->tuning_params[45];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegred_num_tblocks_50549 = &ctx->cfg->tuning_params[46];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegred_num_tblocks_50589 = &ctx->cfg->tuning_params[47];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50547 = &ctx->cfg->tuning_params[48];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50587 = &ctx->cfg->tuning_params[49];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_num_tblocks_50581 = &ctx->cfg->tuning_params[50];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_num_tblocks_50599 = &ctx->cfg->tuning_params[51];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579 = &ctx->cfg->tuning_params[52];
    ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597 = &ctx->cfg->tuning_params[53];
    ctx->tuning_params.skyline_intermediate_filter_floatzitblock_sizze_53461 = &ctx->cfg->tuning_params[54];
    ctx->tuning_params.skyline_local_filter_9621zihist_L2_53453 = &ctx->cfg->tuning_params[55];
    ctx->tuning_params.skyline_local_filter_9621zihist_L_53386 = &ctx->cfg->tuning_params[56];
    ctx->tuning_params.skyline_local_filter_9621ziseghist_num_tblocks_51259 = &ctx->cfg->tuning_params[57];
    ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257 = &ctx->cfg->tuning_params[58];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_50839 = &ctx->cfg->tuning_params[59];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51288 = &ctx->cfg->tuning_params[60];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51322 = &ctx->cfg->tuning_params[61];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51460 = &ctx->cfg->tuning_params[62];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51470 = &ctx->cfg->tuning_params[63];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50670 = &ctx->cfg->tuning_params[64];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50757 = &ctx->cfg->tuning_params[65];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50785 = &ctx->cfg->tuning_params[66];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50837 = &ctx->cfg->tuning_params[67];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50868 = &ctx->cfg->tuning_params[68];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50923 = &ctx->cfg->tuning_params[69];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50949 = &ctx->cfg->tuning_params[70];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50979 = &ctx->cfg->tuning_params[71];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50992 = &ctx->cfg->tuning_params[72];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51020 = &ctx->cfg->tuning_params[73];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51286 = &ctx->cfg->tuning_params[74];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51320 = &ctx->cfg->tuning_params[75];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51427 = &ctx->cfg->tuning_params[76];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51458 = &ctx->cfg->tuning_params[77];
    ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51468 = &ctx->cfg->tuning_params[78];
    ctx->tuning_params.skyline_local_filter_9621zisegscan_num_tblocks_51415 = &ctx->cfg->tuning_params[79];
    ctx->tuning_params.skyline_local_filter_9621zisegscan_tblock_sizze_51413 = &ctx->cfg->tuning_params[80];
    ctx->tuning_params.skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482 = &ctx->cfg->tuning_params[81];
    ctx->tuning_params.skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458 = &ctx->cfg->tuning_params[82];
    ctx->tuning_params.skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534 = &ctx->cfg->tuning_params[83];
    ctx->tuning_params.skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562 = &ctx->cfg->tuning_params[84];
    ctx->tuning_params.skyline_merge_2_floatzisegmap_tblock_sizze_49410 = &ctx->cfg->tuning_params[85];
    ctx->tuning_params.skyline_merge_3_floatzisegmap_tblock_sizze_49386 = &ctx->cfg->tuning_params[86];
    ctx->tuning_params.skyline_merge_4_floatzisegmap_tblock_sizze_49430 = &ctx->cfg->tuning_params[87];
    ctx->tuning_params.skyline_merge_5_floatzisegmap_tblock_sizze_49502 = &ctx->cfg->tuning_params[88];
    ctx->tuning_params.skyline_slice_and_dice_floatzihist_L2_53650 = &ctx->cfg->tuning_params[89];
    ctx->tuning_params.skyline_slice_and_dice_floatzihist_L_53597 = &ctx->cfg->tuning_params[90];
    ctx->tuning_params.skyline_slice_and_dice_floatziseghist_num_tblocks_51784 = &ctx->cfg->tuning_params[91];
    ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782 = &ctx->cfg->tuning_params[92];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_51490 = &ctx->cfg->tuning_params[93];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_51579 = &ctx->cfg->tuning_params[94];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_52145 = &ctx->cfg->tuning_params[95];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_52155 = &ctx->cfg->tuning_params[96];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488 = &ctx->cfg->tuning_params[97];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577 = &ctx->cfg->tuning_params[98];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586 = &ctx->cfg->tuning_params[99];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600 = &ctx->cfg->tuning_params[100];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612 = &ctx->cfg->tuning_params[101];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667 = &ctx->cfg->tuning_params[102];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691 = &ctx->cfg->tuning_params[103];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007 = &ctx->cfg->tuning_params[104];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019 = &ctx->cfg->tuning_params[105];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112 = &ctx->cfg->tuning_params[106];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143 = &ctx->cfg->tuning_params[107];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153 = &ctx->cfg->tuning_params[108];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51476 = &ctx->cfg->tuning_params[109];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51656 = &ctx->cfg->tuning_params[110];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51957 = &ctx->cfg->tuning_params[111];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51474 = &ctx->cfg->tuning_params[112];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51654 = &ctx->cfg->tuning_params[113];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955 = &ctx->cfg->tuning_params[114];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_num_tblocks_51569 = &ctx->cfg->tuning_params[115];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_num_tblocks_52100 = &ctx->cfg->tuning_params[116];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567 = &ctx->cfg->tuning_params[117];
    ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098 = &ctx->cfg->tuning_params[118];
    ctx->tuning_params.skyline_slice_and_dice_floatzisuff_intra_par_1 = &ctx->cfg->tuning_params[119];
    ctx->tuning_params.skyline_slice_and_dice_floatzisuff_outer_par_0 = &ctx->cfg->tuning_params[120];
    ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186 = &ctx->cfg->tuning_params[121];
}
int memblock_unref_device(struct futhark_context *ctx, struct memblock_device *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            (void) gpu_free(ctx, block->mem, block->size, desc);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc_device(struct futhark_context *ctx, struct memblock_device *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "space 'device'", ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "space 'device'", (long long) ctx->cur_mem_usage_device);
    (void) gpu_alloc(ctx, ctx->log, (size_t) size, desc, &block->mem, (size_t *) &size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_device + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_device = new_usage;
        if (new_usage > ctx->peak_mem_usage_device) {
            ctx->peak_mem_usage_device = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "space 'device'", (long long) size, (long long) ctx->cur_mem_usage_device, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set_device(struct futhark_context *ctx, struct memblock_device *lhs, struct memblock_device *rhs, const char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"space 'device'\": %lld", (long long) ctx->peak_mem_usage_device);
    str_builder_char(&builder, ',');
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        gpu_free_all(ctx);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_53449, int64_t n_53450, int64_t x_53451, int64_t s_53452);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_bool(struct futhark_context *ctx, struct memblock_device mem_53509, int64_t num_elems_53510, bool val_53511);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_53283, int64_t num_elems_53284, float val_53285);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_53226, int64_t num_elems_53227, int32_t val_53228);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_53354, int64_t num_elems_53355, int64_t val_53356);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_53321, int64_t num_elems_53322, int8_t val_53323);
FUTHARK_FUN_ATTR int futrts_calc_global_Skyline_9665(struct futhark_context *ctx, struct memblock_device *mem_out_p_54031, struct memblock_device *mem_out_p_54032, struct memblock_device *mem_out_p_54033, int64_t *out_prim_out_54034, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_33449, int64_t dz2080U_33450, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33451, int64_t dz2081U_33452, int64_t dz2082U_33453, int64_t m_sizze_33459, int64_t total_angle_no_33461, int64_t total_grid_no_33462, int64_t total_part_no_33463);
FUTHARK_FUN_ATTR int futrts_entry_calc_Global_Skyline_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54036, struct memblock_device *mem_out_p_54037, struct memblock_device *mem_out_p_54038, int64_t *out_prim_out_54039, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_43262, int64_t dz2080U_43263, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264, int64_t dz2081U_43265, int64_t dz2082U_43266, int64_t m_sizze_43272, int64_t total_angle_no_43274, int64_t total_grid_no_43275, int64_t total_part_no_43276);
FUTHARK_FUN_ATTR int futrts_entry_crack_skylineInfo_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54040, struct memblock_device *mem_out_p_54041, int64_t *out_prim_out_54042, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, int64_t dim_43356, int64_t dz2081U_43357, int64_t dz2082U_43358);
FUTHARK_FUN_ATTR int futrts_entry_make_skylineBase_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54043, struct memblock_device *mem_out_p_54044, struct memblock_device *mem_out_p_54045, struct memblock_device *mem_out_p_54046, struct memblock_device *mem_out_p_54047, struct memblock_device *mem_out_p_54048, int64_t *out_prim_out_54049, int64_t *out_prim_out_54050, int64_t *out_prim_out_54051, int64_t *out_prim_out_54052, int64_t *out_prim_out_54053, struct memblock_device min_per_dim_mem_52561, struct memblock_device max_per_dim_mem_52562, struct memblock_device grid_partitions_per_dim_mem_52563, struct memblock_device angle_partitions_per_dim_mem_52564, int64_t dim_26085, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, int64_t m_sizze_26091);
FUTHARK_FUN_ATTR int futrts_entry_skyline_intermediate_filter_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54056, struct memblock_device *mem_out_p_54057, struct memblock_device *mem_out_p_54058, int64_t *out_prim_out_54059, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_33939, int64_t dz2080U_33940, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, int64_t dz2081U_33942, int64_t dz2082U_33943, int64_t m_sizze_33949, int64_t total_angle_no_33951, int64_t total_grid_no_33952, int64_t total_part_no_33953, int64_t max_subdiv_33957, int64_t min_subdiv_33958, int64_t subdiv_step_33959, int64_t sizze_thresh_33960);
FUTHARK_FUN_ATTR int futrts_entry_skyline_local_filter_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54064, struct memblock_device *mem_out_p_54065, struct memblock_device *mem_out_p_54066, int64_t *out_prim_out_54067, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_32683, int64_t dz2080U_32684, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685, int64_t dz2081U_32686, int64_t dz2082U_32687, int64_t m_sizze_32693, int64_t total_angle_no_32695, int64_t total_grid_no_32696, int64_t total_part_no_32697, bool use_many_pts_32701);
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_2_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54068, struct memblock_device *mem_out_p_54069, struct memblock_device *mem_out_p_54070, int64_t *out_prim_out_54071, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_43206, int64_t dz2080U_43207, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, int64_t dz2082U_43209, int64_t dz2081U_43210, int64_t dz2082U_43211, bool self_filter_first_43212, int64_t m_sizze_43218, int64_t total_angle_no_43220, int64_t total_grid_no_43221, int64_t total_part_no_43222);
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_3_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54072, struct memblock_device *mem_out_p_54073, struct memblock_device *mem_out_p_54074, int64_t *out_prim_out_54075, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, int64_t dim_42759, int64_t dz2080U_42760, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, int64_t dz2082U_42762, int64_t dz2081U_42763, int64_t dz2082U_42764, int64_t dz2082U_42765, bool self_filter_first_42766, int64_t m_sizze_42772, int64_t total_angle_no_42774, int64_t total_grid_no_42775, int64_t total_part_no_42776);
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_4_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54076, struct memblock_device *mem_out_p_54077, struct memblock_device *mem_out_p_54078, int64_t *out_prim_out_54079, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, struct memblock_device isPartitionDominated_mem_52576, struct memblock_device xys_mem_52577, struct memblock_device xys_mem_52578, int64_t dim_41602, int64_t dz2080U_41603, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, int64_t dz2082U_41605, int64_t dz2081U_41606, int64_t dz2082U_41607, int64_t dz2082U_41608, int64_t dz2082U_41609, bool self_filter_first_41610, int64_t m_sizze_41616, int64_t total_angle_no_41618, int64_t total_grid_no_41619, int64_t total_part_no_41620);
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_5_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54080, struct memblock_device *mem_out_p_54081, struct memblock_device *mem_out_p_54082, int64_t *out_prim_out_54083, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, struct memblock_device isPartitionDominated_mem_52576, struct memblock_device xys_mem_52577, struct memblock_device xys_mem_52578, struct memblock_device isPartitionDominated_mem_52579, struct memblock_device xys_mem_52580, struct memblock_device xys_mem_52581, int64_t dim_39383, int64_t dz2080U_39384, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, int64_t dz2082U_39386, int64_t dz2081U_39387, int64_t dz2082U_39388, int64_t dz2082U_39389, int64_t dz2082U_39390, int64_t dz2082U_39391, bool self_filter_first_39392, int64_t m_sizze_39398, int64_t total_angle_no_39400, int64_t total_grid_no_39401, int64_t total_part_no_39402);
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_2_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54084, struct memblock_device *mem_out_p_54085, struct memblock_device *mem_out_p_54086, int64_t *out_prim_out_54087, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, int64_t dim_34825, int64_t dz2082U_34826, int64_t dz2081U_34827, int64_t dz2082U_34828);
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_3_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54088, struct memblock_device *mem_out_p_54089, struct memblock_device *mem_out_p_54090, int64_t *out_prim_out_54091, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_34724, int64_t dz2082U_34725, int64_t dz2081U_34726, int64_t dz2082U_34727, int64_t dz2082U_34728);
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_4_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54092, struct memblock_device *mem_out_p_54093, struct memblock_device *mem_out_p_54094, int64_t *out_prim_out_54095, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_34582, int64_t dz2082U_34583, int64_t dz2081U_34584, int64_t dz2082U_34585, int64_t dz2082U_34586, int64_t dz2082U_34587);
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_5_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54096, struct memblock_device *mem_out_p_54097, struct memblock_device *mem_out_p_54098, int64_t *out_prim_out_54099, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, int64_t dim_34395, int64_t dz2082U_34396, int64_t dz2081U_34397, int64_t dz2082U_34398, int64_t dz2082U_34399, int64_t dz2082U_34400, int64_t dz2082U_34401);
FUTHARK_FUN_ATTR int futrts_entry_skyline_slice_and_dice_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54100, struct memblock_device *mem_out_p_54101, struct memblock_device *mem_out_p_54102, int64_t *out_prim_out_54103, int64_t *out_prim_out_54104, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device xs_mem_52567, int64_t dim_29479, int64_t dz2080U_29480, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481, int64_t n_29482, int64_t m_sizze_29488, int64_t total_angle_no_29490, int64_t total_grid_no_29491, int64_t total_part_no_29492, int64_t offs_29494, bool use_many_pts_29495);
FUTHARK_FUN_ATTR int futrts_filter_against_9751(struct futhark_context *ctx, struct memblock_device *mem_out_p_54109, struct memblock_device *mem_out_p_54110, struct memblock_device *mem_out_p_54111, int64_t *out_prim_out_54112, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_35535, int64_t dz2080U_35536, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_35537, int64_t dz2081U_35538, int64_t dz2082U_35539, int64_t dz2081U_35540, int64_t dz2082U_35541, int64_t m_sizze_35547, int64_t total_angle_no_35549, int64_t total_grid_no_35550, int64_t total_part_no_35551);
FUTHARK_FUN_ATTR int futrts_skyline_local_filter_9621(struct futhark_context *ctx, struct memblock_device *mem_out_p_54114, struct memblock_device *mem_out_p_54115, struct memblock_device *mem_out_p_54116, int64_t *out_prim_out_54117, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_32139, int64_t dz2080U_32140, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, int64_t dz2081U_32142, int64_t coercez2081Uz2080Uz2084U_32143, int64_t m_sizze_32149, int64_t total_angle_no_32151, int64_t total_grid_no_32152, int64_t total_part_no_32153, bool use_many_points_32157);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define counters_mem_53224 (ctx->constants->counters_mem_53224)
    #define counters_mem_53243 (ctx->constants->counters_mem_53243)
    #define counters_mem_53319 (ctx->constants->counters_mem_53319)
    #define counters_mem_53373 (ctx->constants->counters_mem_53373)
    #define counters_mem_53511 (ctx->constants->counters_mem_53511)
    #define counters_mem_53531 (ctx->constants->counters_mem_53531)
    #define counters_mem_53553 (ctx->constants->counters_mem_53553)
    #define counters_mem_53595 (ctx->constants->counters_mem_53595)
    #define counters_mem_53711 (ctx->constants->counters_mem_53711)
    #define counters_mem_53848 (ctx->constants->counters_mem_53848)
    #define global_dynid_mem_53262 (ctx->constants->global_dynid_mem_53262)
    #define global_dynid_mem_53345 (ctx->constants->global_dynid_mem_53345)
    #define global_dynid_mem_53358 (ctx->constants->global_dynid_mem_53358)
    #define global_dynid_mem_53420 (ctx->constants->global_dynid_mem_53420)
    #define global_dynid_mem_53427 (ctx->constants->global_dynid_mem_53427)
    #define global_dynid_mem_53505 (ctx->constants->global_dynid_mem_53505)
    #define global_dynid_mem_53672 (ctx->constants->global_dynid_mem_53672)
    #define global_dynid_mem_53903 (ctx->constants->global_dynid_mem_53903)
    #define hist_locks_mem_53461 (ctx->constants->hist_locks_mem_53461)
    counters_mem_53224.references = NULL;
    counters_mem_53243.references = NULL;
    counters_mem_53319.references = NULL;
    counters_mem_53373.references = NULL;
    counters_mem_53511.references = NULL;
    counters_mem_53531.references = NULL;
    counters_mem_53553.references = NULL;
    counters_mem_53595.references = NULL;
    counters_mem_53711.references = NULL;
    counters_mem_53848.references = NULL;
    global_dynid_mem_53262.references = NULL;
    global_dynid_mem_53345.references = NULL;
    global_dynid_mem_53358.references = NULL;
    global_dynid_mem_53420.references = NULL;
    global_dynid_mem_53427.references = NULL;
    global_dynid_mem_53505.references = NULL;
    global_dynid_mem_53672.references = NULL;
    global_dynid_mem_53903.references = NULL;
    hist_locks_mem_53461.references = NULL;
    if (memblock_alloc_device(ctx, &counters_mem_53319, (int64_t) 81920, "counters_mem_53319")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53319, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53427, (int64_t) 4, "global_dynid_mem_53427")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53427, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53319, (int64_t) 81920, "counters_mem_53319")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53319, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53427, (int64_t) 4, "global_dynid_mem_53427")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53427, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53262, (int64_t) 4, "global_dynid_mem_53262")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53262, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53373, (int64_t) 80, "counters_mem_53373")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53373, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53420, (int64_t) 4, "global_dynid_mem_53420")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53420, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53511, (int64_t) 80, "counters_mem_53511")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53511, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53243, (int64_t) 80, "counters_mem_53243")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53243, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53358, (int64_t) 4, "global_dynid_mem_53358")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53358, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53505, (int64_t) 4, "global_dynid_mem_53505")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53505, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53595, (int64_t) 80, "counters_mem_53595")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53595, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &hist_locks_mem_53461, (int64_t) 400604, "hist_locks_mem_53461")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, hist_locks_mem_53461, (int64_t) 100151, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53553, (int64_t) 81920, "counters_mem_53553")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53553, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53672, (int64_t) 4, "global_dynid_mem_53672")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53672, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53224, (int64_t) 80, "counters_mem_53224")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53224, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53345, (int64_t) 4, "global_dynid_mem_53345")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53345, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53531, (int64_t) 80, "counters_mem_53531")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53531, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53711, (int64_t) 81920, "counters_mem_53711")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53711, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_53848, (int64_t) 81920, "counters_mem_53848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_53848, (int64_t) 20480, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_53903, (int64_t) 4, "global_dynid_mem_53903")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_53903, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    #undef counters_mem_53224
    #undef counters_mem_53243
    #undef counters_mem_53319
    #undef counters_mem_53373
    #undef counters_mem_53511
    #undef counters_mem_53531
    #undef counters_mem_53553
    #undef counters_mem_53595
    #undef counters_mem_53711
    #undef counters_mem_53848
    #undef global_dynid_mem_53262
    #undef global_dynid_mem_53345
    #undef global_dynid_mem_53358
    #undef global_dynid_mem_53420
    #undef global_dynid_mem_53427
    #undef global_dynid_mem_53505
    #undef global_dynid_mem_53672
    #undef global_dynid_mem_53903
    #undef hist_locks_mem_53461
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53224, "ctx->constants->counters_mem_53224") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53243, "ctx->constants->counters_mem_53243") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53319, "ctx->constants->counters_mem_53319") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53373, "ctx->constants->counters_mem_53373") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53511, "ctx->constants->counters_mem_53511") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53531, "ctx->constants->counters_mem_53531") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53553, "ctx->constants->counters_mem_53553") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53595, "ctx->constants->counters_mem_53595") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53711, "ctx->constants->counters_mem_53711") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_53848, "ctx->constants->counters_mem_53848") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53262, "ctx->constants->global_dynid_mem_53262") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53345, "ctx->constants->global_dynid_mem_53345") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53358, "ctx->constants->global_dynid_mem_53358") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53420, "ctx->constants->global_dynid_mem_53420") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53427, "ctx->constants->global_dynid_mem_53427") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53505, "ctx->constants->global_dynid_mem_53505") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53672, "ctx->constants->global_dynid_mem_53672") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_53903, "ctx->constants->global_dynid_mem_53903") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->hist_locks_mem_53461, "ctx->constants->hist_locks_mem_53461") != 0)
        return 1;
    return 0;
}
static int gpu_kernel_builtinzhiota_i64ziiota_i64_53454(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_53454, "builtin#iota_i64.iota_i64_53454", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_boolzireplicate_53514(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_boolzireplicate_53514, "builtin#replicate_bool.replicate_53514", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_f32zireplicate_53288(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, float arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_f32zireplicate_53288, "builtin#replicate_f32.replicate_53288", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i32zireplicate_53231(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int32_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_53231, "builtin#replicate_i32.replicate_53231", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i64zireplicate_53359(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i64zireplicate_53359, "builtin#replicate_i64.replicate_53359", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i8zireplicate_53326(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_53326, "builtin#replicate_i8.replicate_53326", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49657(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, bool arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49657, "calc_global_Skyline_9665.segmap_49657", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_intrablock_49709(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, bool arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_intrablock_49709, "calc_global_Skyline_9665.segmap_intrablock_49709", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegred_small_49831(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, bool arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegred_small_49831, "calc_global_Skyline_9665.segred_small_49831", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegred_large_49831(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, int64_t arg5, bool arg6, int64_t arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[18] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[18] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegred_large_49831, "calc_global_Skyline_9665.segred_large_49831", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 18, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49878(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49878, "calc_global_Skyline_9665.segmap_49878", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegscan_49891(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegscan_49891, "calc_global_Skyline_9665.segscan_49891", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49893(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49893, "calc_global_Skyline_9665.segmap_49893", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49945(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49945, "calc_global_Skyline_9665.segmap_49945", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49958(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49958, "calc_global_Skyline_9665.segmap_49958", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_calc_global_Skyline_9665zisegmap_49967(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->calc_global_Skyline_9665zisegmap_49967, "calc_global_Skyline_9665.segmap_49967", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegscan_50360(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegscan_50360, "make_skylineBase_float.segscan_50360", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegred_nonseg_50370(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegred_nonseg_50370, "make_skylineBase_float.segred_nonseg_50370", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegscan_50380(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegscan_50380, "make_skylineBase_float.segscan_50380", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegred_nonseg_50390(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegred_nonseg_50390, "make_skylineBase_float.segred_nonseg_50390", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegmap_50410(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50410, "make_skylineBase_float.segmap_50410", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegmap_50436(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50436, "make_skylineBase_float.segmap_50436", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_make_skylineBase_floatzisegmap_50523(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->make_skylineBase_floatzisegmap_50523, "make_skylineBase_float.segmap_50523", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegred_nonseg_50555(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50555, "skyline_intermediate_filter_float.segred_nonseg_50555", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegmap_50572(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50572, "skyline_intermediate_filter_float.segmap_50572", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegscan_50603(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegscan_50603, "skyline_intermediate_filter_float.segscan_50603", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegmap_50629(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50629, "skyline_intermediate_filter_float.segmap_50629", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzireplicate_53457(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[7] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzireplicate_53457, "skyline_intermediate_filter_float.replicate_53457", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegscan_50585(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegscan_50585, "skyline_intermediate_filter_float.segscan_50585", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegred_nonseg_50595(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegred_nonseg_50595, "skyline_intermediate_filter_float.segred_nonseg_50595", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_intermediate_filter_floatzisegmap_50660(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_intermediate_filter_floatzisegmap_50660, "skyline_intermediate_filter_float.segmap_50660", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_mergeFilter_2_floatzisegmap_49495(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_mergeFilter_2_floatzisegmap_49495, "skyline_mergeFilter_2_float.segmap_49495", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_mergeFilter_3_floatzisegmap_49473(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_mergeFilter_3_floatzisegmap_49473, "skyline_mergeFilter_3_float.segmap_49473", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_mergeFilter_4_floatzisegmap_49551(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_mergeFilter_4_floatzisegmap_49551, "skyline_mergeFilter_4_float.segmap_49551", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_mergeFilter_5_floatzisegmap_49581(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_mergeFilter_5_floatzisegmap_49581, "skyline_mergeFilter_5_float.segmap_49581", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_merge_2_floatzisegmap_49423(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_merge_2_floatzisegmap_49423, "skyline_merge_2_float.segmap_49423", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_merge_3_floatzisegmap_49401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_merge_3_floatzisegmap_49401, "skyline_merge_3_float.segmap_49401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_merge_4_floatzisegmap_49447(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_merge_4_floatzisegmap_49447, "skyline_merge_4_float.segmap_49447", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_merge_5_floatzisegmap_49521(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_merge_5_floatzisegmap_49521, "skyline_merge_5_float.segmap_49521", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_nonseg_51483(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, bool arg2, int64_t arg3, bool arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51483, "skyline_slice_and_dice_float.segred_nonseg_51483", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51533(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51533, "skyline_slice_and_dice_float.segmap_51533", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegscan_51573(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, bool arg2, int64_t arg3, bool arg4, int64_t arg5, bool arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[23] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21};
        size_t args_sizes[23] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegscan_51573, "skyline_slice_and_dice_float.segscan_51573", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 23, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51575(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51575, "skyline_slice_and_dice_float.segmap_51575", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51627(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51627, "skyline_slice_and_dice_float.segmap_51627", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51640(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51640, "skyline_slice_and_dice_float.segmap_51640", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51649(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51649, "skyline_slice_and_dice_float.segmap_51649", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_nonseg_51662(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_nonseg_51662, "skyline_slice_and_dice_float.segred_nonseg_51662", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51750(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51750, "skyline_slice_and_dice_float.segmap_51750", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_51774(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_51774, "skyline_slice_and_dice_float.segmap_51774", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatziseghist_local_51790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatziseghist_local_51790, "skyline_slice_and_dice_float.seghist_local_51790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatziseghist_global_51790(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatziseghist_global_51790, "skyline_slice_and_dice_float.seghist_global_51790", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_small_53674(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_small_53674, "skyline_slice_and_dice_float.segred_small_53674", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_large_53674(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_large_53674, "skyline_slice_and_dice_float.segred_large_53674", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_intrablock_52185(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, bool arg6, int64_t arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_52185, "skyline_slice_and_dice_float.segmap_intrablock_52185", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_intrablock_51907(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_intrablock_51907, "skyline_slice_and_dice_float.segmap_intrablock_51907", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_52034(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52034, "skyline_slice_and_dice_float.segmap_52034", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_52047(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52047, "skyline_slice_and_dice_float.segmap_52047", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_small_52059(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, int64_t arg4, int64_t arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_small_52059, "skyline_slice_and_dice_float.segred_small_52059", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegred_large_52059(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[20] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16};
        size_t args_sizes[20] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegred_large_52059, "skyline_slice_and_dice_float.segred_large_52059", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 20, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegscan_52104(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegscan_52104, "skyline_slice_and_dice_float.segscan_52104", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_52128(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52128, "skyline_slice_and_dice_float.segmap_52128", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_52140(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52140, "skyline_slice_and_dice_float.segmap_52140", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_slice_and_dice_floatzisegmap_52151(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_slice_and_dice_floatzisegmap_52151, "skyline_slice_and_dice_float.segmap_52151", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50037(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, bool arg6, int64_t arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50037, "filter_against_9751.segmap_50037", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_intrablock_50089(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, bool arg4, bool arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_intrablock_50089, "filter_against_9751.segmap_intrablock_50089", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegred_small_50211(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, int64_t arg6, bool arg7, int64_t arg8, int64_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegred_small_50211, "filter_against_9751.segred_small_50211", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegred_large_50211(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, int64_t arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegred_large_50211, "filter_against_9751.segred_large_50211", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50258(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50258, "filter_against_9751.segmap_50258", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegscan_50271(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegscan_50271, "filter_against_9751.segscan_50271", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50273(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50273, "filter_against_9751.segmap_50273", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50325(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50325, "filter_against_9751.segmap_50325", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50338(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50338, "filter_against_9751.segmap_50338", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_filter_against_9751zisegmap_50347(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->filter_against_9751zisegmap_50347, "filter_against_9751.segmap_50347", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_50688(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_50688, "skyline_local_filter_9621.segmap_50688", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51079(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51079, "skyline_local_filter_9621.segmap_51079", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51104(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51104, "skyline_local_filter_9621.segmap_51104", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51122(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51122, "skyline_local_filter_9621.segmap_51122", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51138(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51138, "skyline_local_filter_9621.segmap_51138", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51150(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[5] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3};
        size_t args_sizes[5] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51150, "skyline_local_filter_9621.segmap_51150", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 5, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51192(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51192, "skyline_local_filter_9621.segmap_51192", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51202(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int32_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51202, "skyline_local_filter_9621.segmap_51202", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51226(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51226, "skyline_local_filter_9621.segmap_51226", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51246(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[7] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[7] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51246, "skyline_local_filter_9621.segmap_51246", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 7, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621ziseghist_local_51265(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[15] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13};
        size_t args_sizes[15] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621ziseghist_local_51265, "skyline_local_filter_9621.seghist_local_51265", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 15, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621ziseghist_global_51265(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[12] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10};
        size_t args_sizes[12] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621ziseghist_global_51265, "skyline_local_filter_9621.seghist_global_51265", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 12, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegred_small_53500(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegred_small_53500, "skyline_local_filter_9621.segred_small_53500", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegred_large_53500(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, int64_t arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[16] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14};
        size_t args_sizes[16] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegred_large_53500, "skyline_local_filter_9621.segred_large_53500", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 16, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51307(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51307, "skyline_local_filter_9621.segmap_51307", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51372(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, int64_t arg6, int32_t arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51372, "skyline_local_filter_9621.segmap_51372", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegscan_51419(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, bool arg6, bool arg7, int64_t arg8, bool arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24, gpu_mem arg25)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[29] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24, &arg25};
        size_t args_sizes[29] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24), sizeof(arg25)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegscan_51419, "skyline_local_filter_9621.segscan_51419", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 29, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51443(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4};
        size_t args_sizes[6] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51443, "skyline_local_filter_9621.segmap_51443", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51455(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int32_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51455, "skyline_local_filter_9621.segmap_51455", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_skyline_local_filter_9621zisegmap_51466(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->skyline_local_filter_9621zisegmap_51466, "skyline_local_filter_9621.segmap_51466", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_2d {
    struct memblock_device mem;
    int64_t shape[2];
};
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const float *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * dim1 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) (dim0 * dim1) * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) (arr->shape[0] * arr->shape[1]) * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_2d(struct futhark_context *ctx, float *out, struct futhark_f32_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * arr->shape[1] + i1 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_bool_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 1);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 1);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 1 * (i0 * 1), 1);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_skylineBase_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
    struct futhark_f32_1d *v3;
    struct futhark_i64_1d *v4;
    int64_t v5;
    struct futhark_f32_2d *v6;
    int64_t v7;
    int64_t v8;
    int64_t v9;
};
int futhark_project_opaque_skylineBase_float_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v3, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v4, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_m_size(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v5;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v6, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v7;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v8;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v9;
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f32_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const int64_t f_m_sizze, const struct futhark_f32_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no)
{
    struct futhark_opaque_skylineBase_float *v = malloc(sizeof(struct futhark_opaque_skylineBase_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_angle_part_prefix_sum;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_angle_partitions_per_dim;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_grid_part_prefix_sum;
        (void) (*v->v2->mem.references)++;
    }
    {
        v->v3 = malloc(sizeof(struct futhark_f32_1d));
        *v->v3 = *f_grid_part_sizze_per_dim;
        (void) (*v->v3->mem.references)++;
    }
    {
        v->v4 = malloc(sizeof(struct futhark_i64_1d));
        *v->v4 = *f_grid_partitions_per_dim;
        (void) (*v->v4->mem.references)++;
    }
    v->v5 = f_m_sizze;
    {
        v->v6 = malloc(sizeof(struct futhark_f32_2d));
        *v->v6 = *f_start_of_grid_partition;
        (void) (*v->v6->mem.references)++;
    }
    v->v7 = f_total_angle_no;
    v->v8 = f_total_grid_no;
    v->v9 = f_total_part_no;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
        ret = tmp;
    if (obj->v6 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v6)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineBase_float(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v3)[0] * sizeof(float);
    int64_t size_4 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
    int64_t size_5 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_6 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v6)[0] * futhark_shape_f32_2d(ctx, obj->v6)[1] * sizeof(float);
    int64_t size_7 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_8 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_9 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8 + size_9;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v3)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v4), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v4, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v5, sizeof(obj->v5));
        out += sizeof(obj->v5);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v6), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v6, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v6)[0] * futhark_shape_f32_2d(ctx, obj->v6)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v7, sizeof(obj->v7));
        out += sizeof(obj->v7);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v8, sizeof(obj->v8));
        out += sizeof(obj->v8);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v9, sizeof(obj->v9));
        out += sizeof(obj->v9);
    }
    return ret;
}
struct futhark_opaque_skylineBase_float *futhark_restore_opaque_skylineBase_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineBase_float *obj = malloc(sizeof(struct futhark_opaque_skylineBase_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(float);
    
    int64_t shape_4[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_4, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    obj->v4 = NULL;
    src += shape_4[0] * sizeof(int64_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    src += sizeof(obj->v5);
    
    int64_t shape_6[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_6, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    obj->v6 = NULL;
    src += shape_6[0] * shape_6[1] * sizeof(float);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    src += sizeof(obj->v7);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    src += sizeof(obj->v8);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_9 = src;
    
    src += sizeof(obj->v9);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_f32_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
        obj->v4 = futhark_new_i64_1d(ctx, data_4, shape_4[0]);
        if (obj->v4 == NULL)
            err = 1;
        memcpy(&obj->v5, data_5, sizeof(obj->v5));
        obj->v6 = futhark_new_f32_2d(ctx, data_6, shape_6[0], shape_6[1]);
        if (obj->v6 == NULL)
            err = 1;
        memcpy(&obj->v7, data_7, sizeof(obj->v7));
        memcpy(&obj->v8, data_8, sizeof(obj->v8));
        memcpy(&obj->v9, data_9, sizeof(obj->v9));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
            ret = tmp;
        if (obj->v6 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v6)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup2_arr1d_f32_i64 {
    struct futhark_f32_1d *v0;
    int64_t v1;
};
int futhark_project_opaque_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, const struct futhark_f32_1d *f_0, const int64_t f_1)
{
    struct futhark_opaque_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_arr1d_f32_i64 *futhark_restore_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_arr1d_f32_i64 *obj = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 {
    struct futhark_f32_2d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_f32_2d *f_0, const struct futhark_i64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_f32_2d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
        
        v->v0 = malloc(sizeof(*v->v0));
        v->v0->mem.references = NULL;
        if (memblock_alloc_device(ctx, &v->v0->mem, arr->v0->shape[1] * 4, "v->v0->mem"))
            err = 1;
        v->v0->shape[0] = arr->v0->shape[1];
        err = gpu_memcpy(ctx, v->v0->mem.mem, 0, arr->v0->mem.mem, 4 * (i0 * arr->v0->shape[1]), 4 * arr->v0->shape[1]);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v1, 0, arr->v1->mem.mem, 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(float);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineInfo_float {
    struct futhark_bool_1d *v0;
    struct futhark_f32_2d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_skylineInfo_float_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineInfo_float_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_opaque_skylineInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v1;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v2;
    (void) (*v->v1->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *f_xys)
{
    struct futhark_opaque_skylineInfo_float *v = malloc(sizeof(struct futhark_opaque_skylineInfo_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_bool_1d));
        *v->v0 = *f_isPartitionDominated;
        (void) (*v->v0->mem.references)++;
    }
    {
        {
            v->v1 = malloc(sizeof(*f_xys->v0));
            *v->v1 = *f_xys->v0;
            (void) (*v->v1->mem.references)++;
        }
        {
            v->v2 = malloc(sizeof(*f_xys->v1));
            *v->v2 = *f_xys->v1;
            (void) (*v->v2->mem.references)++;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineInfo_float(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v1)[0] * futhark_shape_f32_2d(ctx, obj->v1)[1] * sizeof(float);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v1)[0] * futhark_shape_f32_2d(ctx, obj->v1)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_skylineInfo_float *futhark_restore_opaque_skylineInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineInfo_float *obj = malloc(sizeof(struct futhark_opaque_skylineInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(bool);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(float);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_bool_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineData_float {
    struct futhark_f32_2d *v0;
    int64_t v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_skylineData_float_dat(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineData_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_float_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_float_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineData_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float **out, const struct futhark_f32_2d *f_dat, const int64_t f_len, const struct futhark_i64_1d *f_pL)
{
    struct futhark_opaque_skylineData_float *v = malloc(sizeof(struct futhark_opaque_skylineData_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_f32_2d));
        *v->v0 = *f_dat;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_len;
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_pL;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineData_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineData_float(struct futhark_context *ctx, const struct futhark_opaque_skylineData_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_skylineData_float *futhark_restore_opaque_skylineData_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineData_float *obj = malloc(sizeof(struct futhark_opaque_skylineData_float));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(float);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_53449, int64_t n_53450, int64_t x_53451, int64_t s_53452)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t tblock_sizze_53458;
    
    tblock_sizze_53458 = *ctx->tuning_params.builtinzhiota_i64zitblock_sizze_53458;
    
    int64_t virt_num_tblocks_53459 = sdiv_up64(n_53450, tblock_sizze_53458);
    int64_t num_tblocks_53460 = smin64(virt_num_tblocks_53459, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhiota_i64ziiota_i64_53454(ctx, num_tblocks_53460, 1, 1, tblock_sizze_53458, 1, 1, (int64_t) 0, n_53450, x_53451, s_53452, virt_num_tblocks_53459, num_tblocks_53460, mem_53449.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_bool(struct futhark_context *ctx, struct memblock_device mem_53509, int64_t num_elems_53510, bool val_53511)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t replicate_n_53513 = num_elems_53510;
    int64_t tblock_sizze_53518;
    
    tblock_sizze_53518 = *ctx->tuning_params.builtinzhreplicate_boolzitblock_sizze_53518;
    
    int64_t virt_num_tblocks_53519 = sdiv_up64(replicate_n_53513, tblock_sizze_53518);
    int64_t num_tblocks_53520 = smin64(virt_num_tblocks_53519, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_boolzireplicate_53514(ctx, num_tblocks_53520, 1, 1, tblock_sizze_53518, 1, 1, (int64_t) 0, num_elems_53510, val_53511, replicate_n_53513, virt_num_tblocks_53519, num_tblocks_53520, mem_53509.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_f32(struct futhark_context *ctx, struct memblock_device mem_53283, int64_t num_elems_53284, float val_53285)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t replicate_n_53287 = num_elems_53284;
    int64_t tblock_sizze_53292;
    
    tblock_sizze_53292 = *ctx->tuning_params.builtinzhreplicate_f32zitblock_sizze_53292;
    
    int64_t virt_num_tblocks_53293 = sdiv_up64(replicate_n_53287, tblock_sizze_53292);
    int64_t num_tblocks_53294 = smin64(virt_num_tblocks_53293, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_f32zireplicate_53288(ctx, num_tblocks_53294, 1, 1, tblock_sizze_53292, 1, 1, (int64_t) 0, num_elems_53284, val_53285, replicate_n_53287, virt_num_tblocks_53293, num_tblocks_53294, mem_53283.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_53226, int64_t num_elems_53227, int32_t val_53228)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t replicate_n_53230 = num_elems_53227;
    int64_t tblock_sizze_53235;
    
    tblock_sizze_53235 = *ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_53235;
    
    int64_t virt_num_tblocks_53236 = sdiv_up64(replicate_n_53230, tblock_sizze_53235);
    int64_t num_tblocks_53237 = smin64(virt_num_tblocks_53236, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i32zireplicate_53231(ctx, num_tblocks_53237, 1, 1, tblock_sizze_53235, 1, 1, (int64_t) 0, num_elems_53227, val_53228, replicate_n_53230, virt_num_tblocks_53236, num_tblocks_53237, mem_53226.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i64(struct futhark_context *ctx, struct memblock_device mem_53354, int64_t num_elems_53355, int64_t val_53356)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t replicate_n_53358 = num_elems_53355;
    int64_t tblock_sizze_53363;
    
    tblock_sizze_53363 = *ctx->tuning_params.builtinzhreplicate_i64zitblock_sizze_53363;
    
    int64_t virt_num_tblocks_53364 = sdiv_up64(replicate_n_53358, tblock_sizze_53363);
    int64_t num_tblocks_53365 = smin64(virt_num_tblocks_53364, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i64zireplicate_53359(ctx, num_tblocks_53365, 1, 1, tblock_sizze_53363, 1, 1, (int64_t) 0, num_elems_53355, val_53356, replicate_n_53358, virt_num_tblocks_53364, num_tblocks_53365, mem_53354.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_53321, int64_t num_elems_53322, int8_t val_53323)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t replicate_n_53325 = num_elems_53322;
    int64_t tblock_sizze_53330;
    
    tblock_sizze_53330 = *ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_53330;
    
    int64_t virt_num_tblocks_53331 = sdiv_up64(replicate_n_53325, tblock_sizze_53330);
    int64_t num_tblocks_53332 = smin64(virt_num_tblocks_53331, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i8zireplicate_53326(ctx, num_tblocks_53332, 1, 1, tblock_sizze_53330, 1, 1, (int64_t) 0, num_elems_53322, val_53323, replicate_n_53325, virt_num_tblocks_53331, num_tblocks_53332, mem_53321.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_calc_global_Skyline_9665(struct futhark_context *ctx, struct memblock_device *mem_out_p_54031, struct memblock_device *mem_out_p_54032, struct memblock_device *mem_out_p_54033, int64_t *out_prim_out_54034, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_33449, int64_t dz2080U_33450, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33451, int64_t dz2081U_33452, int64_t dz2082U_33453, int64_t m_sizze_33459, int64_t total_angle_no_33461, int64_t total_grid_no_33462, int64_t total_part_no_33463)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52671;
    
    mem_52671.references = NULL;
    
    struct memblock_device mem_52668;
    
    mem_52668.references = NULL;
    
    struct memblock_device mem_52664;
    
    mem_52664.references = NULL;
    
    struct memblock_device mem_52661;
    
    mem_52661.references = NULL;
    
    struct memblock_device incprefixes_mem_53425;
    
    incprefixes_mem_53425.references = NULL;
    
    struct memblock_device aggregates_mem_53423;
    
    aggregates_mem_53423.references = NULL;
    
    struct memblock_device status_flags_mem_53401;
    
    status_flags_mem_53401.references = NULL;
    
    struct memblock_device mem_52659;
    
    mem_52659.references = NULL;
    
    struct memblock_device mem_52657;
    
    mem_52657.references = NULL;
    
    struct memblock_device segred_tmp_mem_53317;
    
    segred_tmp_mem_53317.references = NULL;
    
    struct memblock_device color_52938;
    
    color_52938.references = NULL;
    
    struct memblock_device mem_52601;
    
    mem_52601.references = NULL;
    
    struct memblock_device color_52937;
    
    color_52937.references = NULL;
    
    struct memblock_device mem_52585;
    
    mem_52585.references = NULL;
    
    struct memblock_device color_52936;
    
    color_52936.references = NULL;
    
    struct memblock_device mem_52633;
    
    mem_52633.references = NULL;
    
    struct memblock_device mem_52571;
    
    mem_52571.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    bool zzero_33469 = dz2082U_33453 == (int64_t) 0;
    bool nonzzero_33470 = !zzero_33469;
    bool nonzzero_cert_33471;
    
    if (!nonzzero_33470) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftSkyline.fut:333:74-76\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_33472 = sdiv64(m_sizze_33459, dz2082U_33453);
    int64_t max_res_44287 = smax64((int64_t) 1, max_arg1_33472);
    int64_t min_res_44290 = smin64(dz2082U_33453, max_res_44287);
    int64_t zm_lhs_33478 = add64(dz2082U_33453, min_res_44290);
    int64_t zs_lhs_33480 = sub64(zm_lhs_33478, (int64_t) 1);
    bool zzero_33482 = min_res_44290 == (int64_t) 0;
    bool nonzzero_33483 = !zzero_33482;
    bool nonzzero_cert_33484;
    
    if (!nonzzero_33483) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftSkyline.fut:334:56-63\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_iter_33485 = sdiv64(zs_lhs_33480, min_res_44290);
    int64_t bytes_52570 = (int64_t) 8 * dz2082U_33453;
    
    if (memblock_alloc_device(ctx, &mem_52571, bytes_52570, "mem_52571")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_52571, dz2082U_33453, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_43432 = slt64(num_iter_33485, (int64_t) 0);
    bool valid_43433 = !bounds_invalid_upwards_43432;
    bool range_valid_c_43434;
    
    if (!valid_43433) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_iter_33485, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftSkyline.fut:336:76-89\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_46544 = slt64(dim_33449, (int64_t) 6);
    int64_t max_tblock_sizze_49704;
    
    max_tblock_sizze_49704 = ctx->max_thread_block_size;
    
    bool fits_49705 = sle64(dz2082U_33453, max_tblock_sizze_49704);
    bool suff_intra_par_49703;
    
    suff_intra_par_49703 = *ctx->tuning_params.calc_global_Skyline_9665zisuff_intra_par_1 <= dz2082U_33453;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "calc_global_Skyline_9665.suff_intra_par_1", (long) dz2082U_33453, suff_intra_par_49703 ? "true" : "false");
    
    bool intra_suff_and_fits_49706 = suff_intra_par_49703 && fits_49705;
    int64_t segred_tblock_sizze_49825;
    
    segred_tblock_sizze_49825 = *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772;
    
    int64_t segmap_tblock_sizze_49874;
    
    segmap_tblock_sizze_49874 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49761;
    
    int64_t segmap_tblock_sizze_49653;
    
    segmap_tblock_sizze_49653 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49603;
    
    bool x_52545 = !cond_46544;
    int64_t binop_y_52575 = dz2082U_33453 - (int64_t) 1;
    int64_t binop_x_52577 = smax64((int64_t) 0, binop_y_52575);
    int64_t binop_y_52578 = dim_33449 - (int64_t) 1;
    int64_t binop_x_52579 = smax64((int64_t) 0, binop_y_52578);
    int64_t binop_y_52580 = dz2082U_33453 * binop_x_52579;
    int64_t binop_y_52581 = smax64((int64_t) 0, binop_y_52580);
    int64_t binop_y_52582 = binop_x_52577 + binop_y_52581;
    int64_t binop_y_52583 = (int64_t) 1 + binop_y_52582;
    int64_t bytes_52584 = (int64_t) 4 * binop_y_52583;
    
    for (int64_t i_33491 = 0; i_33491 < num_iter_33485; i_33491++) {
        int64_t inf_33494 = mul64(i_33491, min_res_44290);
        int64_t min_arg0_33496 = add64(inf_33494, min_res_44290);
        int64_t min_res_44293 = smin64(dz2082U_33453, min_arg0_33496);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500 = sub64(min_res_44293, inf_33494);
        bool bounds_invalid_upwards_33504 = slt64(min_res_44293, inf_33494);
        bool valid_33509 = !bounds_invalid_upwards_33504;
        bool range_valid_c_33510;
        
        if (!valid_33509) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) inf_33494, "..<", (long long) min_res_44293, " is invalid.", "-> #0  ft_libs/ftSkyline.fut:339:58-67\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool empty_slice_33529 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500 == (int64_t) 0;
        int64_t m_33530 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, (int64_t) 1);
        int64_t i_p_m_t_s_33532 = add64(inf_33494, m_33530);
        bool zzero_leq_i_p_m_t_s_33533 = sle64((int64_t) 0, i_p_m_t_s_33532);
        bool i_p_m_t_s_leq_w_33535 = slt64(i_p_m_t_s_33532, dz2082U_33453);
        bool zzero_lte_i_33536 = sle64((int64_t) 0, inf_33494);
        bool i_lte_j_33537 = sle64(inf_33494, min_res_44293);
        bool y_33538 = i_p_m_t_s_leq_w_33535 && zzero_lte_i_33536;
        bool y_33539 = zzero_leq_i_p_m_t_s_33533 && y_33538;
        bool forwards_ok_33540 = i_lte_j_33537 && y_33539;
        bool ok_or_empty_33547 = empty_slice_33529 || forwards_ok_33540;
        bool index_certs_33549;
        
        if (!ok_or_empty_33547) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_33494, ":", (long long) min_res_44293, "] out of bounds for array of shape [", (long long) dz2082U_33453, "].", "-> #0  ft_libs/ftSkyline.fut:340:55-71\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_49599;
        
        suff_outer_par_49599 = *ctx->tuning_params.calc_global_Skyline_9665zisuff_outer_par_0 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "calc_global_Skyline_9665.suff_outer_par_0", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, suff_outer_par_49599 ? "true" : "false");
        
        int64_t nest_sizze_49824 = dz2082U_33453 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;
        int64_t num_tblocks_49826;
        int64_t max_num_tblocks_53239;
        
        max_num_tblocks_53239 = *ctx->tuning_params.calc_global_Skyline_9665zisegred_num_tblocks_49774;
        num_tblocks_49826 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_49824, segred_tblock_sizze_49825), max_num_tblocks_53239)));
        
        int64_t num_threads_52979 = segred_tblock_sizze_49825 * num_tblocks_49826;
        int64_t total_sizze_52980 = dim_33449 * num_threads_52979;
        int64_t binop_x_52959 = dim_33449 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;
        int64_t total_sizze_52960 = dz2082U_33453 * binop_x_52959;
        int64_t ctx_52966 = dz2082U_33453 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;
        int64_t segmap_usable_groups_49654 = sdiv_up_safe64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, segmap_tblock_sizze_49653);
        int64_t num_threads_52944 = segmap_tblock_sizze_49653 * segmap_usable_groups_49654;
        int64_t total_sizze_52945 = dim_33449 * num_threads_52944;
        int64_t shared_memory_capacity_53392;
        
        shared_memory_capacity_53392 = ctx->max_shared_memory;
        if (suff_outer_par_49599 && sle64((int64_t) 0, shared_memory_capacity_53392)) {
            if (memblock_alloc_device(ctx, &mem_52633, bytes_52584, "mem_52633")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52633.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2082U_33453}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_33449, (int64_t) 1}, (int64_t []) {dz2082U_33453, dim_33449})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &color_52936, total_sizze_52945, "color_52936")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_53240 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, segmap_tblock_sizze_49653));
            
            {
                err = gpu_kernel_calc_global_Skyline_9665zisegmap_49657(ctx, segmap_usable_groups_49654, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49603, 1, 1, (int64_t) 0, dim_33449, dz2082U_33453, inf_33494, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, cond_46544, x_52545, num_threads_52944, xys_mem_52568.mem, mem_52571.mem, mem_52633.mem, color_52936.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_52633, "mem_52633") != 0)
                return 1;
            if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_52585, bytes_52584, "mem_52585")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52585.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2082U_33453}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_33449, (int64_t) 1}, (int64_t []) {dz2082U_33453, dim_33449})) != 0)
                goto cleanup;
            
            int64_t shared_memory_capacity_53391;
            
            shared_memory_capacity_53391 = ctx->max_shared_memory;
            if (intra_suff_and_fits_49706 && sle64(sdiv_up64(dz2082U_33453, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_53391)) {
                if (memblock_alloc_device(ctx, &color_52937, total_sizze_52960, "color_52937")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t num_chunks_53256 = sext_i64_i32(sdiv_up64(dz2082U_33453, dz2082U_33453));
                int32_t virt_num_tblocks_53257 = sext_i64_i32(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500);
                
                {
                    err = gpu_kernel_calc_global_Skyline_9665zisegmap_intrablock_49709(ctx, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, 1, 1, dz2082U_33453, 1, 1, dz2082U_33453 + srem64((int64_t) 8 - srem64(dz2082U_33453, (int64_t) 8), (int64_t) 8), dim_33449, dz2082U_33453, inf_33494, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, cond_46544, x_52545, ctx_52966, xys_mem_52568.mem, mem_52571.mem, color_52937.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &mem_52601, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, "mem_52601")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &color_52938, total_sizze_52980, "color_52938")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                int64_t chunk_sizze_53278 = (int64_t) 1;
                
                if (slt64(dz2082U_33453 * (int64_t) 2, segred_tblock_sizze_49825 * chunk_sizze_53278)) {
                    int64_t segment_sizze_nonzzero_53279 = smax64((int64_t) 1, dz2082U_33453);
                    int64_t num_threads_53280 = segred_tblock_sizze_49825 * segred_tblock_sizze_49825;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-small");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2082U_33453, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279), '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, squot64(segred_tblock_sizze_49825, segment_sizze_nonzzero_53279))), '\n');
                    {
                        err = gpu_kernel_calc_global_Skyline_9665zisegred_small_49831(ctx, num_tblocks_49826, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772, 1, 1, segred_tblock_sizze_49825 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_49825, (int64_t) 8), (int64_t) 8), dim_33449, dz2082U_33453, inf_33494, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, cond_46544, num_tblocks_49826, x_52545, num_threads_52979, segment_sizze_nonzzero_53279, mem_52585.mem, mem_52601.mem, color_52938.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                } else {
                    int64_t blocks_per_segment_53313 = sdiv_up64(num_tblocks_49826, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500));
                    int64_t q_53314 = sdiv_up64(dz2082U_33453, segred_tblock_sizze_49825 * blocks_per_segment_53313 * chunk_sizze_53278);
                    int64_t num_virtblocks_53315 = blocks_per_segment_53313 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500;
                    int64_t threads_per_segment_53316 = blocks_per_segment_53313 * segred_tblock_sizze_49825;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-large");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2082U_33453, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_53315, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_49826, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_49825, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_53314, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_53313, '\n');
                    if (memblock_alloc_device(ctx, &segred_tmp_mem_53317, num_virtblocks_53315, "segred_tmp_mem_53317")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_calc_global_Skyline_9665zisegred_large_49831(ctx, num_tblocks_49826, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegred_tblock_sizze_49772, 1, 1, 8 + (segred_tblock_sizze_49825 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_49825, (int64_t) 8), (int64_t) 8)), dim_33449, dz2082U_33453, inf_33494, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, cond_46544, num_tblocks_49826, x_52545, num_threads_52979, blocks_per_segment_53313, q_53314, num_virtblocks_53315, threads_per_segment_53316, mem_52585.mem, mem_52601.mem, color_52938.mem, segred_tmp_mem_53317.mem, counters_mem_53319.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_49875 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, segmap_tblock_sizze_49874);
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_53382 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, segmap_tblock_sizze_49874));
                
                {
                    err = gpu_kernel_calc_global_Skyline_9665zisegmap_49878(ctx, segmap_usable_groups_49875, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49761, 1, 1, (int64_t) 0, inf_33494, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_33500, mem_52571.mem, mem_52601.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &mem_52601, "mem_52601") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_52585, "mem_52585") != 0)
                return 1;
        }
    }
    
    int64_t segscan_tblock_sizze_49886;
    
    segscan_tblock_sizze_49886 = *ctx->tuning_params.calc_global_Skyline_9665zisegscan_tblock_sizze_49885;
    
    int64_t num_tblocks_49888;
    int64_t max_num_tblocks_53393;
    
    max_num_tblocks_53393 = *ctx->tuning_params.calc_global_Skyline_9665zisegscan_num_tblocks_49887;
    num_tblocks_49888 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_33453, segscan_tblock_sizze_49886), max_num_tblocks_53393)));
    if (memblock_alloc_device(ctx, &mem_52657, bytes_52570, "mem_52657")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52659, bytes_52570, "mem_52659")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dz2082U_33453)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53394;
        
        shared_memory_53394 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53395;
        
        thread_block_sizze_53395 = ctx->max_thread_block_size;
        
        int64_t registers_53396;
        
        registers_53396 = ctx->max_registers;
        
        int64_t thread_block_sizze_53397;
        
        thread_block_sizze_53397 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53398 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53394, thread_block_sizze_53395), (int64_t) 8), squot64(squot64(registers_53396, thread_block_sizze_53397) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53399 = sdiv_up64(dz2082U_33453, segscan_tblock_sizze_49886 * chunk_sizze_53398);
        int64_t num_virt_threads_53400 = num_virt_blocks_53399 * segscan_tblock_sizze_49886;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53398, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53401, num_virt_blocks_53399, "status_flags_mem_53401")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53401, num_virt_blocks_53399, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53423, (int64_t) 8 * num_virt_blocks_53399, "aggregates_mem_53423")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53425, (int64_t) 8 * num_virt_blocks_53399, "incprefixes_mem_53425")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_calc_global_Skyline_9665zisegscan_49891(ctx, num_tblocks_49888, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegscan_tblock_sizze_49885, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_49886), chunk_sizze_53398 * segscan_tblock_sizze_49886 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_49886), chunk_sizze_53398 * segscan_tblock_sizze_49886 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dz2082U_33453, num_tblocks_49888, num_virt_blocks_53399, num_virt_threads_53400, mem_52571.mem, mem_52657.mem, mem_52659.mem, status_flags_mem_53401.mem, aggregates_mem_53423.mem, incprefixes_mem_53425.mem, global_dynid_mem_53427.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool x_45248 = sle64((int64_t) 0, binop_y_52575);
    bool y_45249 = slt64(binop_y_52575, dz2082U_33453);
    bool bounds_check_45250 = x_45248 && y_45249;
    bool protect_assert_disj_45251 = zzero_33469 || bounds_check_45250;
    bool index_certs_45252;
    
    if (!protect_assert_disj_45251) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) binop_y_52575, "] out of bounds for array of shape [", (long long) dz2082U_33453, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_45253;
    
    if (nonzzero_33470) {
        int64_t read_res_54035;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_54035, mem_52657.mem, binop_y_52575 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_48219 = read_res_54035;
        
        m_f_res_45253 = x_48219;
    } else {
        m_f_res_45253 = (int64_t) 0;
    }
    
    int64_t m_45255;
    
    if (zzero_33469) {
        m_45255 = (int64_t) 0;
    } else {
        m_45255 = m_f_res_45253;
    }
    
    int64_t m_45265 = sub64(m_45255, (int64_t) 1);
    bool i_p_m_t_s_leq_w_45267 = slt64(m_45265, dz2082U_33453);
    bool zzero_leq_i_p_m_t_s_45266 = sle64((int64_t) 0, m_45265);
    bool y_45269 = zzero_leq_i_p_m_t_s_45266 && i_p_m_t_s_leq_w_45267;
    bool i_lte_j_45268 = sle64((int64_t) 0, m_45255);
    bool forwards_ok_45270 = i_lte_j_45268 && y_45269;
    bool eq_x_zz_45262 = (int64_t) 0 == m_f_res_45253;
    bool p_and_eq_x_y_45263 = nonzzero_33470 && eq_x_zz_45262;
    bool empty_slice_45264 = zzero_33469 || p_and_eq_x_y_45263;
    bool ok_or_empty_45271 = empty_slice_45264 || forwards_ok_45270;
    bool index_certs_45272;
    
    if (!ok_or_empty_45271) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_45255, "] out of bounds for array of shape [", (long long) dz2082U_33453, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_52660 = (int64_t) 8 * m_45255;
    int64_t binop_x_52666 = (int64_t) 4 * m_45255;
    int64_t bytes_52667 = dim_33449 * binop_x_52666;
    
    if (memblock_alloc_device(ctx, &mem_52661, bytes_52660, "mem_52661")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52661.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52571.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_45255})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_49896;
    
    segmap_tblock_sizze_49896 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49895;
    
    int64_t num_tblocks_49898;
    int64_t max_num_tblocks_53516;
    
    max_num_tblocks_53516 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_num_tblocks_49897;
    num_tblocks_49898 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_33453, segmap_tblock_sizze_49896), max_num_tblocks_53516)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53517 = sext_i64_i32(sdiv_up64(dz2082U_33453, segmap_tblock_sizze_49896));
    
    {
        err = gpu_kernel_calc_global_Skyline_9665zisegmap_49893(ctx, num_tblocks_49898, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49895, 1, 1, (int64_t) 0, dz2082U_33453, m_45255, num_tblocks_49898, virt_num_tblocks_53517, mem_52571.mem, mem_52657.mem, mem_52659.mem, mem_52661.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52571, "mem_52571") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52657, "mem_52657") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52659, "mem_52659") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_49941;
    
    segmap_tblock_sizze_49941 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49930;
    
    int64_t segmap_usable_groups_49942 = sdiv_up64(m_45255, segmap_tblock_sizze_49941);
    
    if (memblock_alloc_device(ctx, &mem_52664, (int64_t) 0, "mem_52664")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53530 = sext_i64_i32(sdiv_up64(m_45255, segmap_tblock_sizze_49941));
    
    {
        err = gpu_kernel_calc_global_Skyline_9665zisegmap_49945(ctx, segmap_usable_groups_49942, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49930, 1, 1, (int64_t) 0, dz2082U_33453, m_45255, mem_52661.mem, mem_52664.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t nest_sizze_49952 = dim_33449 * m_45255;
    int64_t segmap_tblock_sizze_49953;
    
    segmap_tblock_sizze_49953 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49918;
    
    int64_t segmap_usable_groups_49954 = sdiv_up64(nest_sizze_49952, segmap_tblock_sizze_49953);
    
    if (memblock_alloc_device(ctx, &mem_52668, bytes_52667, "mem_52668")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53539 = sext_i64_i32(sdiv_up64(m_45255 * dim_33449, segmap_tblock_sizze_49953));
    
    {
        err = gpu_kernel_calc_global_Skyline_9665zisegmap_49958(ctx, segmap_usable_groups_49954, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49918, 1, 1, (int64_t) 0, dim_33449, m_45255, xys_mem_52568.mem, mem_52661.mem, mem_52664.mem, mem_52668.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_tblock_sizze_49963;
    
    segmap_tblock_sizze_49963 = *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49904;
    
    int64_t segmap_usable_groups_49964 = sdiv_up64(m_45255, segmap_tblock_sizze_49963);
    
    if (memblock_alloc_device(ctx, &mem_52671, bytes_52660, "mem_52671")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53550 = sext_i64_i32(sdiv_up64(m_45255, segmap_tblock_sizze_49963));
    
    {
        err = gpu_kernel_calc_global_Skyline_9665zisegmap_49967(ctx, segmap_usable_groups_49964, 1, 1, *ctx->tuning_params.calc_global_Skyline_9665zisegmap_tblock_sizze_49904, 1, 1, (int64_t) 0, m_45255, xys_mem_52569.mem, mem_52661.mem, mem_52664.mem, mem_52671.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52661, "mem_52661") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52664, "mem_52664") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52668, "mem_52668") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52671, "mem_52671") != 0)
        return 1;
    prim_out_53220 = m_45255;
    if (memblock_set_device(ctx, &*mem_out_p_54031, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54032, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54033, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54034 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52671, "mem_52671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52668, "mem_52668") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52664, "mem_52664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52661, "mem_52661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53425, "incprefixes_mem_53425") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53423, "aggregates_mem_53423") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53401, "status_flags_mem_53401") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52659, "mem_52659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52657, "mem_52657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53317, "segred_tmp_mem_53317") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52601, "mem_52601") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52585, "mem_52585") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52633, "mem_52633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52571, "mem_52571") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_Global_Skyline_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54036, struct memblock_device *mem_out_p_54037, struct memblock_device *mem_out_p_54038, int64_t *out_prim_out_54039, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_43262, int64_t dz2080U_43263, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264, int64_t dz2081U_43265, int64_t dz2082U_43266, int64_t m_sizze_43272, int64_t total_angle_no_43274, int64_t total_grid_no_43275, int64_t total_part_no_43276)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device ext_mem_52570;
    
    ext_mem_52570.references = NULL;
    
    struct memblock_device ext_mem_52571;
    
    ext_mem_52571.references = NULL;
    
    struct memblock_device ext_mem_52572;
    
    ext_mem_52572.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_43440 = sub64(dim_43262, (int64_t) 1);
    bool assert_cond_43441 = arg_43440 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264;
    bool assert_c_43442;
    
    if (!assert_cond_43441) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:718:26-720:58\n   #1  ft_libs/ftSkyline.fut:716:17-720:66\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t calc_Global_Skyline_float_res_43443;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52572, &ext_mem_52571, &ext_mem_52570, &calc_Global_Skyline_float_res_43443, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_43262, dz2080U_43263, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264, dz2081U_43265, dz2082U_43266, m_sizze_43272, total_angle_no_43274, total_grid_no_43275, total_part_no_43276) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_53217, &ext_mem_52572, "ext_mem_52572") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &ext_mem_52571, "ext_mem_52571") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &ext_mem_52570, "ext_mem_52570") != 0)
        return 1;
    prim_out_53220 = calc_Global_Skyline_float_res_43443;
    if (memblock_set_device(ctx, &*mem_out_p_54036, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54037, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54038, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54039 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &ext_mem_52570, "ext_mem_52570") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52571, "ext_mem_52571") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52572, "ext_mem_52572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_crack_skylineInfo_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54040, struct memblock_device *mem_out_p_54041, int64_t *out_prim_out_54042, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, int64_t dim_43356, int64_t dz2081U_43357, int64_t dz2082U_43358)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52568;
    
    mem_52568.references = NULL;
    
    struct memblock_device mem_52566;
    
    mem_52566.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53219;
    int64_t binop_x_52564 = (int64_t) 4 * dz2082U_43358;
    int64_t bytes_52565 = dim_43356 * binop_x_52564;
    int64_t bytes_52567 = (int64_t) 8 * dz2082U_43358;
    
    if (memblock_alloc_device(ctx, &mem_52566, bytes_52565, "mem_52566")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52566.mem, (int64_t) 0, (int64_t []) {dim_43356, (int64_t) 1}, xys_mem_52562.mem, (int64_t) 0, (int64_t []) {dim_43356, (int64_t) 1}, (int64_t []) {dz2082U_43358, dim_43356})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_52568, bytes_52567, "mem_52568")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52568.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xys_mem_52563.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_43358})) != 0)
        goto cleanup;
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52566, "mem_52566") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52568, "mem_52568") != 0)
        return 1;
    prim_out_53219 = dz2082U_43358;
    if (memblock_set_device(ctx, &*mem_out_p_54040, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54041, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    *out_prim_out_54042 = prim_out_53219;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52568, "mem_52568") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52566, "mem_52566") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_make_skylineBase_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54043, struct memblock_device *mem_out_p_54044, struct memblock_device *mem_out_p_54045, struct memblock_device *mem_out_p_54046, struct memblock_device *mem_out_p_54047, struct memblock_device *mem_out_p_54048, int64_t *out_prim_out_54049, int64_t *out_prim_out_54050, int64_t *out_prim_out_54051, int64_t *out_prim_out_54052, int64_t *out_prim_out_54053, struct memblock_device min_per_dim_mem_52561, struct memblock_device max_per_dim_mem_52562, struct memblock_device grid_partitions_per_dim_mem_52563, struct memblock_device angle_partitions_per_dim_mem_52564, int64_t dim_26085, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, int64_t m_sizze_26091)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52590;
    
    mem_52590.references = NULL;
    
    struct memblock_device mem_52586;
    
    mem_52586.references = NULL;
    
    struct memblock_device mem_52583;
    
    mem_52583.references = NULL;
    
    struct memblock_device segred_tmp_mem_53513;
    
    segred_tmp_mem_53513.references = NULL;
    
    struct memblock_device mem_52580;
    
    mem_52580.references = NULL;
    
    struct memblock_device incprefixes_mem_53418;
    
    incprefixes_mem_53418.references = NULL;
    
    struct memblock_device aggregates_mem_53416;
    
    aggregates_mem_53416.references = NULL;
    
    struct memblock_device status_flags_mem_53414;
    
    status_flags_mem_53414.references = NULL;
    
    struct memblock_device mem_52578;
    
    mem_52578.references = NULL;
    
    struct memblock_device mem_52576;
    
    mem_52576.references = NULL;
    
    struct memblock_device segred_tmp_mem_53375;
    
    segred_tmp_mem_53375.references = NULL;
    
    struct memblock_device mem_52573;
    
    mem_52573.references = NULL;
    
    struct memblock_device incprefixes_mem_53260;
    
    incprefixes_mem_53260.references = NULL;
    
    struct memblock_device aggregates_mem_53258;
    
    aggregates_mem_53258.references = NULL;
    
    struct memblock_device status_flags_mem_53236;
    
    status_flags_mem_53236.references = NULL;
    
    struct memblock_device mem_52571;
    
    mem_52571.references = NULL;
    
    struct memblock_device mem_52569;
    
    mem_52569.references = NULL;
    
    struct memblock_device mem_52567;
    
    mem_52567.references = NULL;
    
    struct memblock_device mem_out_53222;
    
    mem_out_53222.references = NULL;
    
    struct memblock_device mem_out_53221;
    
    mem_out_53221.references = NULL;
    
    struct memblock_device mem_out_53220;
    
    mem_out_53220.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53223;
    int64_t prim_out_53224;
    int64_t prim_out_53225;
    int64_t prim_out_53226;
    int64_t prim_out_53227;
    int64_t arg_46393 = sub64(dim_26085, (int64_t) 1);
    bool assert_cond_46394 = arg_46393 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;
    bool assert_c_46395;
    
    if (!assert_cond_46394) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ft_libs/ftSkyline.fut:619:17-627:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_50355;
    
    segscan_tblock_sizze_50355 = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50354;
    
    int64_t num_tblocks_50357;
    int64_t max_num_tblocks_53228;
    
    max_num_tblocks_53228 = *ctx->tuning_params.make_skylineBase_floatzisegscan_num_tblocks_50356;
    num_tblocks_50357 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dim_26085, segscan_tblock_sizze_50355), max_num_tblocks_53228)));
    
    int64_t bytes_52566 = (int64_t) 8 * dim_26085;
    int64_t bytes_52570 = (int64_t) 4 * dim_26085;
    
    if (memblock_alloc_device(ctx, &mem_52567, bytes_52566, "mem_52567")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52569, bytes_52566, "mem_52569")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52571, bytes_52570, "mem_52571")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dim_26085)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53229;
        
        shared_memory_53229 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53230;
        
        thread_block_sizze_53230 = ctx->max_thread_block_size;
        
        int64_t registers_53231;
        
        registers_53231 = ctx->max_registers;
        
        int64_t thread_block_sizze_53232;
        
        thread_block_sizze_53232 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53233 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53229, thread_block_sizze_53230), (int64_t) 8), squot64(squot64(registers_53231, thread_block_sizze_53232) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53234 = sdiv_up64(dim_26085, segscan_tblock_sizze_50355 * chunk_sizze_53233);
        int64_t num_virt_threads_53235 = num_virt_blocks_53234 * segscan_tblock_sizze_50355;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53233, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53236, num_virt_blocks_53234, "status_flags_mem_53236")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53236, num_virt_blocks_53234, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53258, (int64_t) 8 * num_virt_blocks_53234, "aggregates_mem_53258")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53260, (int64_t) 8 * num_virt_blocks_53234, "incprefixes_mem_53260")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_make_skylineBase_floatzisegscan_50360(ctx, num_tblocks_50357, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50354, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50355), chunk_sizze_53233 * segscan_tblock_sizze_50355 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50355), chunk_sizze_53233 * segscan_tblock_sizze_50355 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dim_26085, num_tblocks_50357, num_virt_blocks_53234, num_virt_threads_53235, min_per_dim_mem_52561.mem, max_per_dim_mem_52562.mem, grid_partitions_per_dim_mem_52563.mem, mem_52567.mem, mem_52569.mem, mem_52571.mem, status_flags_mem_53236.mem, aggregates_mem_53258.mem, incprefixes_mem_53260.mem, global_dynid_mem_53262.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segred_tblock_sizze_50363;
    
    segred_tblock_sizze_50363 = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50362;
    
    int64_t num_tblocks_50365;
    int64_t max_num_tblocks_53371;
    
    max_num_tblocks_53371 = *ctx->tuning_params.make_skylineBase_floatzisegred_num_tblocks_50364;
    num_tblocks_50365 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dim_26085, segred_tblock_sizze_50363), max_num_tblocks_53371)));
    if (memblock_alloc_device(ctx, &mem_52573, (int64_t) 8, "mem_52573")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_53372 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_53375, (int64_t) 8 * num_tblocks_50365, "segred_tmp_mem_53375")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53377 = num_tblocks_50365 * segred_tblock_sizze_50363;
    
    {
        err = gpu_kernel_make_skylineBase_floatzisegred_nonseg_50370(ctx, num_tblocks_50365, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50362, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_50363 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50363, (int64_t) 8), (int64_t) 8)), dim_26085, num_tblocks_50365, num_threads_53377, mem_52569.mem, mem_52573.mem, counters_mem_53373.mem, segred_tmp_mem_53375.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52569, "mem_52569") != 0)
        return 1;
    
    int64_t read_res_54054;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_54054, mem_52573.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_res_47853 = read_res_54054;
    
    if (memblock_unref_device(ctx, &mem_52573, "mem_52573") != 0)
        return 1;
    
    int64_t bytes_52575 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;
    bool bounds_invalid_upwards_46440 = slt64(defunc_res_47853, (int64_t) 0);
    bool valid_46441 = !bounds_invalid_upwards_46440;
    bool range_valid_c_46442;
    
    if (!valid_46441) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_res_47853, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftSkyline.fut:69:45-63\n   #2  ft_libs/ftSkyline.fut:626:25-627:112\n   #3  ft_libs/ftSkyline.fut:619:17-627:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_52588 = (int64_t) 4 * defunc_res_47853;
    int64_t bytes_52589 = dim_26085 * binop_x_52588;
    int64_t segscan_tblock_sizze_50375;
    
    segscan_tblock_sizze_50375 = *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50374;
    
    int64_t num_tblocks_50377;
    int64_t max_num_tblocks_53406;
    
    max_num_tblocks_53406 = *ctx->tuning_params.make_skylineBase_floatzisegscan_num_tblocks_50376;
    num_tblocks_50377 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, segscan_tblock_sizze_50375), max_num_tblocks_53406)));
    if (memblock_alloc_device(ctx, &mem_52576, bytes_52575, "mem_52576")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52578, bytes_52575, "mem_52578")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53407;
        
        shared_memory_53407 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53408;
        
        thread_block_sizze_53408 = ctx->max_thread_block_size;
        
        int64_t registers_53409;
        
        registers_53409 = ctx->max_registers;
        
        int64_t thread_block_sizze_53410;
        
        thread_block_sizze_53410 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53411 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53407, thread_block_sizze_53408), (int64_t) 8), squot64(squot64(registers_53409, thread_block_sizze_53410) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53412 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, segscan_tblock_sizze_50375 * chunk_sizze_53411);
        int64_t num_virt_threads_53413 = num_virt_blocks_53412 * segscan_tblock_sizze_50375;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53411, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53414, num_virt_blocks_53412, "status_flags_mem_53414")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53414, num_virt_blocks_53412, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53416, (int64_t) 8 * num_virt_blocks_53412, "aggregates_mem_53416")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53418, (int64_t) 8 * num_virt_blocks_53412, "incprefixes_mem_53418")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_make_skylineBase_floatzisegscan_50380(ctx, num_tblocks_50377, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegscan_tblock_sizze_50374, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50375), chunk_sizze_53411 * segscan_tblock_sizze_50375 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50375), chunk_sizze_53411 * segscan_tblock_sizze_50375 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, num_tblocks_50377, num_virt_blocks_53412, num_virt_threads_53413, angle_partitions_per_dim_mem_52564.mem, mem_52576.mem, mem_52578.mem, status_flags_mem_53414.mem, aggregates_mem_53416.mem, incprefixes_mem_53418.mem, global_dynid_mem_53420.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    int64_t segred_tblock_sizze_50383;
    
    segred_tblock_sizze_50383 = *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50382;
    
    int64_t num_tblocks_50385;
    int64_t max_num_tblocks_53509;
    
    max_num_tblocks_53509 = *ctx->tuning_params.make_skylineBase_floatzisegred_num_tblocks_50384;
    num_tblocks_50385 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, segred_tblock_sizze_50383), max_num_tblocks_53509)));
    if (memblock_alloc_device(ctx, &mem_52580, (int64_t) 8, "mem_52580")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_53510 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_53513, (int64_t) 8 * num_tblocks_50385, "segred_tmp_mem_53513")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53515 = num_tblocks_50385 * segred_tblock_sizze_50383;
    
    {
        err = gpu_kernel_make_skylineBase_floatzisegred_nonseg_50390(ctx, num_tblocks_50385, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegred_tblock_sizze_50382, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_50383 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50383, (int64_t) 8), (int64_t) 8)), dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, num_tblocks_50385, num_threads_53515, mem_52578.mem, mem_52580.mem, counters_mem_53511.mem, segred_tmp_mem_53513.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52578, "mem_52578") != 0)
        return 1;
    
    int64_t read_res_54055;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_54055, mem_52580.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_res_47856 = read_res_54055;
    
    if (memblock_unref_device(ctx, &mem_52580, "mem_52580") != 0)
        return 1;
    
    int64_t total_part_no_46407 = mul64(defunc_res_47853, defunc_res_47856);
    int64_t segmap_tblock_sizze_50406;
    
    segmap_tblock_sizze_50406 = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50394;
    
    int64_t segmap_usable_groups_50407 = sdiv_up64(dim_26085, segmap_tblock_sizze_50406);
    
    if (memblock_alloc_device(ctx, &mem_52583, bytes_52566, "mem_52583")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53544 = sext_i64_i32(sdiv_up64(dim_26085, segmap_tblock_sizze_50406));
    
    {
        err = gpu_kernel_make_skylineBase_floatzisegmap_50410(ctx, segmap_usable_groups_50407, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50394, 1, 1, (int64_t) 0, dim_26085, mem_52567.mem, mem_52583.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52567, "mem_52567") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_50432;
    
    segmap_tblock_sizze_50432 = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50420;
    
    int64_t segmap_usable_groups_50433 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, segmap_tblock_sizze_50432);
    
    if (memblock_alloc_device(ctx, &mem_52586, bytes_52575, "mem_52586")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53553 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, segmap_tblock_sizze_50432));
    
    {
        err = gpu_kernel_make_skylineBase_floatzisegmap_50436(ctx, segmap_usable_groups_50433, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50420, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, mem_52576.mem, mem_52586.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52576, "mem_52576") != 0)
        return 1;
    
    int64_t nest_sizze_50517 = dim_26085 * defunc_res_47853;
    int64_t segmap_tblock_sizze_50518;
    
    segmap_tblock_sizze_50518 = *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50456;
    
    int64_t segmap_usable_groups_50519 = sdiv_up64(nest_sizze_50517, segmap_tblock_sizze_50518);
    
    if (memblock_alloc_device(ctx, &mem_52590, bytes_52589, "mem_52590")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53562 = sext_i64_i32(sdiv_up64(defunc_res_47853 * dim_26085, segmap_tblock_sizze_50518));
    
    {
        err = gpu_kernel_make_skylineBase_floatzisegmap_50523(ctx, segmap_usable_groups_50519, 1, 1, *ctx->tuning_params.make_skylineBase_floatzisegmap_tblock_sizze_50456, 1, 1, (int64_t) 0, dim_26085, defunc_res_47853, min_per_dim_mem_52561.mem, grid_partitions_per_dim_mem_52563.mem, mem_52571.mem, mem_52583.mem, mem_52590.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52586, "mem_52586") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &angle_partitions_per_dim_mem_52564, "angle_partitions_per_dim_mem_52564") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52583, "mem_52583") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53220, &mem_52571, "mem_52571") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53221, &grid_partitions_per_dim_mem_52563, "grid_partitions_per_dim_mem_52563") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53222, &mem_52590, "mem_52590") != 0)
        return 1;
    prim_out_53223 = defunc_res_47853;
    prim_out_53224 = m_sizze_26091;
    prim_out_53225 = defunc_res_47856;
    prim_out_53226 = defunc_res_47853;
    prim_out_53227 = total_part_no_46407;
    if (memblock_set_device(ctx, &*mem_out_p_54043, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54044, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54045, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54046, &mem_out_53220, "mem_out_53220") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54047, &mem_out_53221, "mem_out_53221") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54048, &mem_out_53222, "mem_out_53222") != 0)
        return 1;
    *out_prim_out_54049 = prim_out_53223;
    *out_prim_out_54050 = prim_out_53224;
    *out_prim_out_54051 = prim_out_53225;
    *out_prim_out_54052 = prim_out_53226;
    *out_prim_out_54053 = prim_out_53227;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52590, "mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52586, "mem_52586") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52583, "mem_52583") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53513, "segred_tmp_mem_53513") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52580, "mem_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53418, "incprefixes_mem_53418") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53416, "aggregates_mem_53416") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53414, "status_flags_mem_53414") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52578, "mem_52578") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52576, "mem_52576") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53375, "segred_tmp_mem_53375") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52573, "mem_52573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53260, "incprefixes_mem_53260") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53258, "aggregates_mem_53258") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53236, "status_flags_mem_53236") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52571, "mem_52571") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52569, "mem_52569") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52567, "mem_52567") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53222, "mem_out_53222") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53221, "mem_out_53221") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53220, "mem_out_53220") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_intermediate_filter_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54056, struct memblock_device *mem_out_p_54057, struct memblock_device *mem_out_p_54058, int64_t *out_prim_out_54059, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_33939, int64_t dz2080U_33940, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, int64_t dz2081U_33942, int64_t dz2082U_33943, int64_t m_sizze_33949, int64_t total_angle_no_33951, int64_t total_grid_no_33952, int64_t total_part_no_33953, int64_t max_subdiv_33957, int64_t min_subdiv_33958, int64_t subdiv_step_33959, int64_t sizze_thresh_33960)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52680;
    
    mem_52680.references = NULL;
    
    struct memblock_device mem_52677;
    
    mem_52677.references = NULL;
    
    struct memblock_device mem_param_tmp_53227;
    
    mem_param_tmp_53227.references = NULL;
    
    struct memblock_device mem_param_tmp_53226;
    
    mem_param_tmp_53226.references = NULL;
    
    struct memblock_device mem_param_tmp_53225;
    
    mem_param_tmp_53225.references = NULL;
    
    struct memblock_device mem_param_tmp_53478;
    
    mem_param_tmp_53478.references = NULL;
    
    struct memblock_device mem_param_tmp_53477;
    
    mem_param_tmp_53477.references = NULL;
    
    struct memblock_device mem_param_tmp_53476;
    
    mem_param_tmp_53476.references = NULL;
    
    struct memblock_device ext_mem_52630;
    
    ext_mem_52630.references = NULL;
    
    struct memblock_device ext_mem_52631;
    
    ext_mem_52631.references = NULL;
    
    struct memblock_device ext_mem_52632;
    
    ext_mem_52632.references = NULL;
    
    struct memblock_device mem_52628;
    
    mem_52628.references = NULL;
    
    struct memblock_device mem_52625;
    
    mem_52625.references = NULL;
    
    struct memblock_device segred_tmp_mem_53597;
    
    segred_tmp_mem_53597.references = NULL;
    
    struct memblock_device incprefixes_mem_53503;
    
    incprefixes_mem_53503.references = NULL;
    
    struct memblock_device aggregates_mem_53501;
    
    aggregates_mem_53501.references = NULL;
    
    struct memblock_device status_flags_mem_53499;
    
    status_flags_mem_53499.references = NULL;
    
    struct memblock_device mem_param_52608;
    
    mem_param_52608.references = NULL;
    
    struct memblock_device mem_param_52605;
    
    mem_param_52605.references = NULL;
    
    struct memblock_device mem_param_52601;
    
    mem_param_52601.references = NULL;
    
    struct memblock_device ext_mem_52640;
    
    ext_mem_52640.references = NULL;
    
    struct memblock_device ext_mem_52641;
    
    ext_mem_52641.references = NULL;
    
    struct memblock_device ext_mem_52642;
    
    ext_mem_52642.references = NULL;
    
    struct memblock_device mem_52621;
    
    mem_52621.references = NULL;
    
    struct memblock_device mem_52620;
    
    mem_52620.references = NULL;
    
    struct memblock_device mem_52617;
    
    mem_52617.references = NULL;
    
    struct memblock_device mem_52615;
    
    mem_52615.references = NULL;
    
    struct memblock_device mem_52613;
    
    mem_52613.references = NULL;
    
    struct memblock_device mem_52610;
    
    mem_52610.references = NULL;
    
    struct memblock_device mem_52598;
    
    mem_52598.references = NULL;
    
    struct memblock_device mem_52595;
    
    mem_52595.references = NULL;
    
    struct memblock_device mem_52593;
    
    mem_52593.references = NULL;
    
    struct memblock_device incprefixes_mem_53356;
    
    incprefixes_mem_53356.references = NULL;
    
    struct memblock_device aggregates_mem_53354;
    
    aggregates_mem_53354.references = NULL;
    
    struct memblock_device status_flags_mem_53332;
    
    status_flags_mem_53332.references = NULL;
    
    struct memblock_device mem_52590;
    
    mem_52590.references = NULL;
    
    struct memblock_device mem_52587;
    
    mem_52587.references = NULL;
    
    struct memblock_device mem_52584;
    
    mem_52584.references = NULL;
    
    struct memblock_device ext_mem_52652;
    
    ext_mem_52652.references = NULL;
    
    struct memblock_device ext_mem_52653;
    
    ext_mem_52653.references = NULL;
    
    struct memblock_device ext_mem_52654;
    
    ext_mem_52654.references = NULL;
    
    struct memblock_device mem_52650;
    
    mem_52650.references = NULL;
    
    struct memblock_device mem_52647;
    
    mem_52647.references = NULL;
    
    struct memblock_device mem_52643;
    
    mem_52643.references = NULL;
    
    struct memblock_device ext_mem_52657;
    
    ext_mem_52657.references = NULL;
    
    struct memblock_device ext_mem_52661;
    
    ext_mem_52661.references = NULL;
    
    struct memblock_device ext_mem_52664;
    
    ext_mem_52664.references = NULL;
    
    struct memblock_device segred_tmp_mem_53265;
    
    segred_tmp_mem_53265.references = NULL;
    
    struct memblock_device mem_52582;
    
    mem_52582.references = NULL;
    
    struct memblock_device mem_param_52580;
    
    mem_param_52580.references = NULL;
    
    struct memblock_device mem_param_52577;
    
    mem_param_52577.references = NULL;
    
    struct memblock_device mem_param_52573;
    
    mem_param_52573.references = NULL;
    
    struct memblock_device ext_mem_52672;
    
    ext_mem_52672.references = NULL;
    
    struct memblock_device ext_mem_52673;
    
    ext_mem_52673.references = NULL;
    
    struct memblock_device ext_mem_52674;
    
    ext_mem_52674.references = NULL;
    
    struct memblock_device mem_52570;
    
    mem_52570.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_46552 = sub64(dim_33939, (int64_t) 1);
    bool assert_cond_46553 = arg_46552 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941;
    bool assert_c_46554;
    
    if (!assert_cond_46553) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:652:25-118\n   #1  ft_libs/ftSkyline.fut:644:17-652:118\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52570, (int64_t) 1, "mem_52570")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock skyline_intermediate_filter_floatzistatic_array_53221 = (struct memblock) {NULL, (unsigned char *) skyline_intermediate_filter_floatzistatic_array_realtype_54060, 0, "skyline_intermediate_filter_float.static_array_53221"};
    
    if ((err = lmad_copy_host2gpu(ctx, 1, true, 1, mem_52570.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, skyline_intermediate_filter_floatzistatic_array_53221.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1})) != 0)
        goto cleanup;
    
    bool cond_46556 = slt64(min_subdiv_33958, max_subdiv_33957);
    bool cond_t_res_46557 = slt64((int64_t) 0, max_subdiv_33957);
    bool x_46558 = cond_46556 && cond_t_res_46557;
    bool loop_cond_t_res_46559 = slt64(sizze_thresh_33960, dz2082U_33943);
    bool x_46560 = x_46558 && loop_cond_t_res_46559;
    bool cond_46561 = slt64((int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941);
    bool y_46562 = slt64((int64_t) 0, dz2080U_33940);
    int64_t tmp_46563 = add64((int64_t) 1, dim_33939);
    bool cond_46564 = slt64(tmp_46563, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941);
    int64_t segmap_tblock_sizze_50568;
    
    segmap_tblock_sizze_50568 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559;
    
    int64_t segmap_usable_groups_50569 = sdiv_up_safe64(dim_33939, segmap_tblock_sizze_50568);
    int64_t segscan_tblock_sizze_50580;
    
    segscan_tblock_sizze_50580 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579;
    
    int64_t num_tblocks_50582;
    int64_t max_num_tblocks_53222;
    
    max_num_tblocks_53222 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_num_tblocks_50581;
    num_tblocks_50582 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, segscan_tblock_sizze_50580), max_num_tblocks_53222)));
    
    int64_t segred_tblock_sizze_50588;
    
    segred_tblock_sizze_50588 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50587;
    
    int64_t num_tblocks_50590;
    int64_t max_num_tblocks_53223;
    
    max_num_tblocks_53223 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_num_tblocks_50589;
    num_tblocks_50590 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, segred_tblock_sizze_50588), max_num_tblocks_53223)));
    
    int64_t segscan_tblock_sizze_50598;
    
    segscan_tblock_sizze_50598 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597;
    
    int64_t num_tblocks_50600;
    int64_t max_num_tblocks_53224;
    
    max_num_tblocks_53224 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_num_tblocks_50599;
    num_tblocks_50600 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dim_33939, segscan_tblock_sizze_50598), max_num_tblocks_53224)));
    
    int64_t segmap_tblock_sizze_50624;
    
    segmap_tblock_sizze_50624 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607;
    
    int64_t segmap_usable_groups_50625 = sdiv_up_safe64(dim_33939, segmap_tblock_sizze_50624);
    int64_t segmap_tblock_sizze_50656;
    
    segmap_tblock_sizze_50656 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644;
    
    int64_t segmap_usable_groups_50657 = sdiv_up_safe64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, segmap_tblock_sizze_50656);
    int64_t bytes_52583 = (int64_t) 8 * dim_33939;
    int64_t bytes_52586 = (int64_t) 4 * dim_33939;
    int64_t bytes_52609 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941;
    int64_t ext_52671;
    int64_t ext_52670;
    int64_t ext_52669;
    int64_t ext_52668;
    int64_t ext_52667;
    int64_t ext_52666;
    int64_t ext_52665;
    int64_t calc_intermediate_skyline_res_46565;
    bool calc_intermediate_skyline_res_46566;
    int64_t calc_intermediate_skyline_res_46570;
    int64_t loop_dz2082U_46571;
    bool loop_while_46572;
    int64_t subdiv_46576;
    int64_t ctx_param_ext_52571;
    int64_t ctx_param_ext_52572;
    int64_t ctx_param_ext_52574;
    int64_t ctx_param_ext_52575;
    int64_t ctx_param_ext_52576;
    int64_t ctx_param_ext_52578;
    int64_t ctx_param_ext_52579;
    
    if (memblock_set_device(ctx, &mem_param_52573, &mem_52570, "mem_52570") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_52577, &xys_mem_52568, "xys_mem_52568") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_param_52580, &xys_mem_52569, "xys_mem_52569") != 0)
        return 1;
    ctx_param_ext_52571 = (int64_t) 0;
    ctx_param_ext_52572 = (int64_t) 1;
    ctx_param_ext_52574 = (int64_t) 0;
    ctx_param_ext_52575 = dim_33939;
    ctx_param_ext_52576 = (int64_t) 1;
    ctx_param_ext_52578 = (int64_t) 0;
    ctx_param_ext_52579 = (int64_t) 1;
    loop_dz2082U_46571 = dz2082U_33943;
    loop_while_46572 = x_46560;
    subdiv_46576 = max_subdiv_33957;
    while (loop_while_46572) {
        bool cond_46577 = subdiv_46576 == (int64_t) 1;
        bool loop_cond_t_res_46578 = slt64(sizze_thresh_33960, loop_dz2082U_46571);
        bool x_46579 = cond_46561 && loop_cond_t_res_46578;
        bool loop_not_taken_46580 = !x_46579;
        bool protect_assert_disj_46581 = y_46562 || loop_not_taken_46580;
        bool protect_assert_disj_46582 = cond_46577 || protect_assert_disj_46581;
        bool index_certs_46583;
        
        if (!protect_assert_disj_46582) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_33940, "].", "-> #0  ft_libs/ftSkyline.fut:385:66-96\n   #1  ft_libs/ftSkyline.fut:645:26-652:118\n   #2  ft_libs/ftSkyline.fut:644:17-652:118\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_52162 = !cond_46577;
        bool protect_cond_conj_52164 = x_46579 && x_52162;
        int64_t dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595;
        
        if (protect_cond_conj_52164) {
            int64_t segred_tblock_sizze_50548;
            
            segred_tblock_sizze_50548 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50547;
            
            int64_t num_tblocks_50550;
            int64_t max_num_tblocks_53241;
            
            max_num_tblocks_53241 = *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_num_tblocks_50549;
            num_tblocks_50550 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dim_33939, segred_tblock_sizze_50548), max_num_tblocks_53241)));
            if (memblock_alloc_device(ctx, &mem_52582, (int64_t) 8, "mem_52582")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegRed");
            
            int64_t chunk_sizze_53242 = (int64_t) 1;
            
            if (memblock_alloc_device(ctx, &segred_tmp_mem_53265, (int64_t) 8 * num_tblocks_50550, "segred_tmp_mem_53265")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t num_threads_53267 = num_tblocks_50550 * segred_tblock_sizze_50548;
            
            {
                err = gpu_kernel_skyline_intermediate_filter_floatzisegred_nonseg_50555(ctx, num_tblocks_50550, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50547, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_50548 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50548, (int64_t) 8), (int64_t) 8)), dim_33939, num_tblocks_50550, num_threads_53267, mem_52582.mem, counters_mem_53243.mem, segred_tmp_mem_53265.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            
            int64_t read_res_54061;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_54061, mem_52582.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_res_47899 = read_res_54061;
            
            if (memblock_unref_device(ctx, &mem_52582, "mem_52582") != 0)
                return 1;
            dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595 = defunc_res_47899;
        } else {
            dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595 = (int64_t) 0;
        }
        
        int64_t binop_x_52596 = (int64_t) 4 * dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595;
        int64_t bytes_52597 = dim_33939 * binop_x_52596;
        int64_t binop_x_52645 = (int64_t) 4 * loop_dz2082U_46571;
        int64_t bytes_52646 = dim_33939 * binop_x_52645;
        int64_t bytes_52649 = (int64_t) 8 * loop_dz2082U_46571;
        int64_t ext_52663;
        int64_t ext_52662;
        int64_t ext_52660;
        int64_t ext_52659;
        int64_t ext_52658;
        int64_t ext_52656;
        int64_t ext_52655;
        int64_t loopres_46584;
        int64_t loopres_46585;
        int64_t loopres_46589;
        
        if (cond_46577) {
            if (memblock_alloc_device(ctx, &mem_52643, (int64_t) 1, "mem_52643")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_1b(ctx, 1, mem_52643.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_52573.mem, ctx_param_ext_52571, (int64_t []) {ctx_param_ext_52572}, (int64_t []) {(int64_t) 1})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &mem_52647, bytes_52646, "mem_52647")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52647.mem, (int64_t) 0, (int64_t []) {dim_33939, (int64_t) 1}, mem_param_52577.mem, ctx_param_ext_52574, (int64_t []) {ctx_param_ext_52575, ctx_param_ext_52576}, (int64_t []) {loop_dz2082U_46571, dim_33939})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &mem_52650, bytes_52649, "mem_52650")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52650.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_52580.mem, ctx_param_ext_52578, (int64_t []) {ctx_param_ext_52579}, (int64_t []) {loop_dz2082U_46571})) != 0)
                goto cleanup;
            
            int64_t loopres_t_res_47894;
            
            if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52654, &ext_mem_52653, &ext_mem_52652, &loopres_t_res_47894, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, mem_52643, mem_52647, mem_52650, dim_33939, dz2080U_33940, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, (int64_t) 1, loop_dz2082U_46571, m_sizze_33949, total_angle_no_33951, total_grid_no_33952, total_part_no_33953) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_52643, "mem_52643") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52647, "mem_52647") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52650, "mem_52650") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_52664, &ext_mem_52654, "ext_mem_52654") != 0)
                return 1;
            ext_52663 = (int64_t) 0;
            ext_52662 = (int64_t) 1;
            if (memblock_set_device(ctx, &ext_mem_52661, &ext_mem_52653, "ext_mem_52653") != 0)
                return 1;
            ext_52660 = (int64_t) 0;
            ext_52659 = dim_33939;
            ext_52658 = (int64_t) 1;
            if (memblock_set_device(ctx, &ext_mem_52657, &ext_mem_52652, "ext_mem_52652") != 0)
                return 1;
            ext_52656 = (int64_t) 0;
            ext_52655 = (int64_t) 1;
            loopres_46584 = loopres_t_res_47894;
            loopres_46585 = loopres_t_res_47894;
            loopres_46589 = (int64_t) -1;
        } else {
            if (memblock_alloc_device(ctx, &mem_52584, bytes_52583, "mem_52584")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_52584, dim_33939, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52587, bytes_52586, "mem_52587")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_53316 = sext_i64_i32(sdiv_up64(dim_33939, segmap_tblock_sizze_50568));
            
            {
                err = gpu_kernel_skyline_intermediate_filter_floatzisegmap_50572(ctx, segmap_usable_groups_50569, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50559, 1, 1, (int64_t) 0, dim_33939, start_of_grid_partition_mem_52566.mem, mem_52587.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_alloc_device(ctx, &mem_52590, bytes_52583, "mem_52590")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, dim_33939)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_53325;
                
                shared_memory_53325 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_53326;
                
                thread_block_sizze_53326 = ctx->max_thread_block_size;
                
                int64_t registers_53327;
                
                registers_53327 = ctx->max_registers;
                
                int64_t thread_block_sizze_53328;
                
                thread_block_sizze_53328 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_53329 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53325, thread_block_sizze_53326), (int64_t) 8), squot64(squot64(registers_53327, thread_block_sizze_53328) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
                int64_t num_virt_blocks_53330 = sdiv_up64(dim_33939, segscan_tblock_sizze_50598 * chunk_sizze_53329);
                int64_t num_virt_threads_53331 = num_virt_blocks_53330 * segscan_tblock_sizze_50598;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53329, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_53332, num_virt_blocks_53330, "status_flags_mem_53332")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53332, num_virt_blocks_53330, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_53354, (int64_t) 8 * num_virt_blocks_53330, "aggregates_mem_53354")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_53356, (int64_t) 8 * num_virt_blocks_53330, "incprefixes_mem_53356")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_skyline_intermediate_filter_floatzisegscan_50603(ctx, num_tblocks_50600, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50597, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50598), chunk_sizze_53329 * segscan_tblock_sizze_50598 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50598), chunk_sizze_53329 * segscan_tblock_sizze_50598 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dim_33939, num_tblocks_50600, num_virt_blocks_53330, num_virt_threads_53331, mem_52590.mem, status_flags_mem_53332.mem, aggregates_mem_53354.mem, incprefixes_mem_53356.mem, global_dynid_mem_53358.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_52593, bytes_52586, "mem_52593")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52595, bytes_52583, "mem_52595")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_53447 = sext_i64_i32(sdiv_up64(dim_33939, segmap_tblock_sizze_50624));
            
            {
                err = gpu_kernel_skyline_intermediate_filter_floatzisegmap_50629(ctx, segmap_usable_groups_50625, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50607, 1, 1, (int64_t) 0, dim_33939, start_of_grid_partition_mem_52566.mem, mem_52590.mem, mem_52593.mem, mem_52595.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_52590, "mem_52590") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_52598, bytes_52597, "mem_52598")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t replicate_n_53456 = dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595 * dim_33939;
            int64_t tblock_sizze_53461;
            
            tblock_sizze_53461 = *ctx->tuning_params.skyline_intermediate_filter_floatzitblock_sizze_53461;
            
            int64_t virt_num_tblocks_53462 = sdiv_up64(replicate_n_53456, tblock_sizze_53461);
            int64_t num_tblocks_53463 = smin64(virt_num_tblocks_53462, (int64_t) 1048576);
            
            {
                err = gpu_kernel_skyline_intermediate_filter_floatzireplicate_53457(ctx, num_tblocks_53463, 1, 1, tblock_sizze_53461, 1, 1, (int64_t) 0, dim_33939, dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595, replicate_n_53456, virt_num_tblocks_53462, num_tblocks_53463, mem_52593.mem, mem_52598.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_unref_device(ctx, &mem_52593, "mem_52593") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_52610, bytes_52609, "mem_52610")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52613, bytes_52609, "mem_52613")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52615, bytes_52609, "mem_52615")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52617, (int64_t) 8, "mem_52617")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52620, bytes_52609, "mem_52620")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_52621, (int64_t) 1, "mem_52621")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t ext_52639;
            int64_t ext_52638;
            int64_t ext_52637;
            int64_t ext_52636;
            int64_t ext_52635;
            int64_t ext_52634;
            int64_t ext_52633;
            int64_t loopres_f_res_46599;
            bool loopres_f_res_46600;
            int64_t loopres_f_res_46604;
            int64_t loop_dz2082Uz2084U_46605;
            bool loop_while_46606;
            int64_t curD_46610;
            int64_t ctx_param_ext_52599;
            int64_t ctx_param_ext_52600;
            int64_t ctx_param_ext_52602;
            int64_t ctx_param_ext_52603;
            int64_t ctx_param_ext_52604;
            int64_t ctx_param_ext_52606;
            int64_t ctx_param_ext_52607;
            
            if (memblock_set_device(ctx, &mem_param_52601, &mem_param_52573, "mem_param_52573") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_52605, &mem_param_52577, "mem_param_52577") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_param_52608, &mem_param_52580, "mem_param_52580") != 0)
                return 1;
            ctx_param_ext_52599 = ctx_param_ext_52571;
            ctx_param_ext_52600 = ctx_param_ext_52572;
            ctx_param_ext_52602 = ctx_param_ext_52574;
            ctx_param_ext_52603 = ctx_param_ext_52575;
            ctx_param_ext_52604 = ctx_param_ext_52576;
            ctx_param_ext_52606 = ctx_param_ext_52578;
            ctx_param_ext_52607 = ctx_param_ext_52579;
            loop_dz2082Uz2084U_46605 = loop_dz2082U_46571;
            loop_while_46606 = x_46579;
            curD_46610 = (int64_t) 0;
            while (loop_while_46606) {
                bool x_46612 = sle64((int64_t) 0, curD_46610);
                bool y_46613 = slt64(curD_46610, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941);
                bool bounds_check_46614 = x_46612 && y_46613;
                bool index_certs_46615;
                
                if (!bounds_check_46614) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) curD_46610, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, "].", "-> #0  ft_libs/ftSkyline.fut:387:66-108\n   #1  ft_libs/ftSkyline.fut:645:26-652:118\n   #2  ft_libs/ftSkyline.fut:644:17-652:118\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_52623 = (int64_t) 4 * loop_dz2082Uz2084U_46605;
                int64_t bytes_52624 = dim_33939 * binop_x_52623;
                int64_t bytes_52627 = (int64_t) 8 * loop_dz2082Uz2084U_46605;
                
                if (futrts_builtinzhreplicate_i64(ctx, mem_52610, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, (int64_t) 1) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t write_tmp_54062 = subdiv_46576;
                
                if ((err = gpu_scalar_to_device(ctx, mem_52610.mem, curD_46610 * sizeof(int64_t), sizeof(int64_t), &write_tmp_54062)) != 0)
                    goto cleanup;
                if (slt64((int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941)) {
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "\n# SegScan");
                    
                    int64_t shared_memory_53492;
                    
                    shared_memory_53492 = ctx->max_shared_memory;
                    
                    int64_t thread_block_sizze_53493;
                    
                    thread_block_sizze_53493 = ctx->max_thread_block_size;
                    
                    int64_t registers_53494;
                    
                    registers_53494 = ctx->max_registers;
                    
                    int64_t thread_block_sizze_53495;
                    
                    thread_block_sizze_53495 = ctx->max_thread_block_size;
                    
                    int64_t chunk_sizze_53496 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53492, thread_block_sizze_53493), (int64_t) 8), squot64(squot64(registers_53494, thread_block_sizze_53495) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
                    int64_t num_virt_blocks_53497 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, segscan_tblock_sizze_50580 * chunk_sizze_53496);
                    int64_t num_virt_threads_53498 = num_virt_blocks_53497 * segscan_tblock_sizze_50580;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53496, '\n');
                    if (memblock_alloc_device(ctx, &status_flags_mem_53499, num_virt_blocks_53497, "status_flags_mem_53499")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53499, num_virt_blocks_53497, (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &aggregates_mem_53501, (int64_t) 8 * num_virt_blocks_53497, "aggregates_mem_53501")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc_device(ctx, &incprefixes_mem_53503, (int64_t) 8 * num_virt_blocks_53497, "incprefixes_mem_53503")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_skyline_intermediate_filter_floatzisegscan_50585(ctx, num_tblocks_50582, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegscan_tblock_sizze_50579, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50580), chunk_sizze_53496 * segscan_tblock_sizze_50580 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50580), chunk_sizze_53496 * segscan_tblock_sizze_50580 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, num_tblocks_50582, num_virt_blocks_53497, num_virt_threads_53498, mem_52610.mem, mem_52613.mem, mem_52615.mem, status_flags_mem_53499.mem, aggregates_mem_53501.mem, incprefixes_mem_53503.mem, global_dynid_mem_53505.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "");
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                int64_t chunk_sizze_53594 = (int64_t) 1;
                
                if (memblock_alloc_device(ctx, &segred_tmp_mem_53597, (int64_t) 8 * num_tblocks_50590, "segred_tmp_mem_53597")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t num_threads_53599 = num_tblocks_50590 * segred_tblock_sizze_50588;
                
                {
                    err = gpu_kernel_skyline_intermediate_filter_floatzisegred_nonseg_50595(ctx, num_tblocks_50590, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegred_tblock_sizze_50587, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_50588 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_50588, (int64_t) 8), (int64_t) 8)), dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, num_tblocks_50590, num_threads_53599, mem_52615.mem, mem_52617.mem, counters_mem_53595.mem, segred_tmp_mem_53597.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                
                int64_t read_res_54063;
                
                if ((err = gpu_scalar_from_device(ctx, &read_res_54063, mem_52617.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
                    goto cleanup;
                if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t defunc_res_47912 = read_res_54063;
                int64_t total_part_no_46623 = mul64(dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595, defunc_res_47912);
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_53628 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, segmap_tblock_sizze_50656));
                
                {
                    err = gpu_kernel_skyline_intermediate_filter_floatzisegmap_50660(ctx, segmap_usable_groups_50657, 1, 1, *ctx->tuning_params.skyline_intermediate_filter_floatzisegmap_tblock_sizze_50644, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, mem_52613.mem, mem_52620.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if ((err = lmad_copy_gpu2gpu_1b(ctx, 1, mem_52621.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_52601.mem, ctx_param_ext_52599, (int64_t []) {ctx_param_ext_52600}, (int64_t []) {(int64_t) 1})) != 0)
                    goto cleanup;
                if (memblock_alloc_device(ctx, &mem_52625, bytes_52624, "mem_52625")) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52625.mem, (int64_t) 0, (int64_t []) {dim_33939, (int64_t) 1}, mem_param_52605.mem, ctx_param_ext_52602, (int64_t []) {ctx_param_ext_52603, ctx_param_ext_52604}, (int64_t []) {loop_dz2082Uz2084U_46605, dim_33939})) != 0)
                    goto cleanup;
                if (memblock_alloc_device(ctx, &mem_52628, bytes_52627, "mem_52628")) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52628.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_param_52608.mem, ctx_param_ext_52606, (int64_t []) {ctx_param_ext_52607}, (int64_t []) {loop_dz2082Uz2084U_46605})) != 0)
                    goto cleanup;
                
                int64_t loopres_46662;
                
                if (futrts_skyline_local_filter_9621(ctx, &ext_mem_52632, &ext_mem_52631, &ext_mem_52630, &loopres_46662, mem_52620, mem_52610, mem_52595, mem_52587, mem_52584, mem_52598, mem_52621, mem_52625, mem_52628, dim_33939, dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, (int64_t) 1, loop_dz2082Uz2084U_46605, m_sizze_33949, defunc_res_47912, dzlz7bUproductz20Ugrid_partitions_per_dimz7dUzg_46595, total_part_no_46623, 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_unref_device(ctx, &mem_52625, "mem_52625") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_52628, "mem_52628") != 0)
                    return 1;
                
                bool loop_cond_t_res_46666 = slt64(sizze_thresh_33960, loopres_46662);
                bool x_46667 = cond_46564 && loop_cond_t_res_46666;
                
                if (memblock_set_device(ctx, &mem_param_tmp_53476, &ext_mem_52632, "ext_mem_52632") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_tmp_53477, &ext_mem_52631, "ext_mem_52631") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_tmp_53478, &ext_mem_52630, "ext_mem_52630") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_53479 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_53480 = (int64_t) 1;
                int64_t ctx_param_ext_tmp_53481 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_53482 = dim_33939;
                int64_t ctx_param_ext_tmp_53483 = (int64_t) 1;
                int64_t ctx_param_ext_tmp_53484 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_53485 = (int64_t) 1;
                int64_t loop_dz2082Uz2084U_tmp_53486 = loopres_46662;
                bool loop_while_tmp_53487 = x_46667;
                int64_t curD_tmp_53491 = tmp_46563;
                
                if (memblock_set_device(ctx, &mem_param_52601, &mem_param_tmp_53476, "mem_param_tmp_53476") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_52605, &mem_param_tmp_53477, "mem_param_tmp_53477") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_52608, &mem_param_tmp_53478, "mem_param_tmp_53478") != 0)
                    return 1;
                ctx_param_ext_52599 = ctx_param_ext_tmp_53479;
                ctx_param_ext_52600 = ctx_param_ext_tmp_53480;
                ctx_param_ext_52602 = ctx_param_ext_tmp_53481;
                ctx_param_ext_52603 = ctx_param_ext_tmp_53482;
                ctx_param_ext_52604 = ctx_param_ext_tmp_53483;
                ctx_param_ext_52606 = ctx_param_ext_tmp_53484;
                ctx_param_ext_52607 = ctx_param_ext_tmp_53485;
                loop_dz2082Uz2084U_46605 = loop_dz2082Uz2084U_tmp_53486;
                loop_while_46606 = loop_while_tmp_53487;
                curD_46610 = curD_tmp_53491;
            }
            if (memblock_set_device(ctx, &ext_mem_52642, &mem_param_52601, "mem_param_52601") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_52641, &mem_param_52605, "mem_param_52605") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_52640, &mem_param_52608, "mem_param_52608") != 0)
                return 1;
            ext_52639 = ctx_param_ext_52599;
            ext_52638 = ctx_param_ext_52600;
            ext_52637 = ctx_param_ext_52602;
            ext_52636 = ctx_param_ext_52603;
            ext_52635 = ctx_param_ext_52604;
            ext_52634 = ctx_param_ext_52606;
            ext_52633 = ctx_param_ext_52607;
            loopres_f_res_46599 = loop_dz2082Uz2084U_46605;
            loopres_f_res_46600 = loop_while_46606;
            loopres_f_res_46604 = curD_46610;
            if (memblock_unref_device(ctx, &mem_52584, "mem_52584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52587, "mem_52587") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52595, "mem_52595") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52598, "mem_52598") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52610, "mem_52610") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52613, "mem_52613") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52615, "mem_52615") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52617, "mem_52617") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52620, "mem_52620") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52621, "mem_52621") != 0)
                return 1;
            
            int64_t tmp_46668 = sub64(subdiv_46576, subdiv_step_33959);
            
            if (memblock_set_device(ctx, &ext_mem_52664, &ext_mem_52642, "ext_mem_52642") != 0)
                return 1;
            ext_52663 = ext_52639;
            ext_52662 = ext_52638;
            if (memblock_set_device(ctx, &ext_mem_52661, &ext_mem_52641, "ext_mem_52641") != 0)
                return 1;
            ext_52660 = ext_52637;
            ext_52659 = ext_52636;
            ext_52658 = ext_52635;
            if (memblock_set_device(ctx, &ext_mem_52657, &ext_mem_52640, "ext_mem_52640") != 0)
                return 1;
            ext_52656 = ext_52634;
            ext_52655 = ext_52633;
            loopres_46584 = loopres_f_res_46599;
            loopres_46585 = loopres_f_res_46599;
            loopres_46589 = tmp_46668;
        }
        
        bool dim_match_46674 = loopres_46584 == loopres_46585;
        bool empty_or_match_cert_46675;
        
        if (!dim_match_46674) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "shape of loop result does not match shapes in loop parameter", "-> #0  ft_libs/ftSkyline.fut:374:33-391:86\n   #1  ft_libs/ftSkyline.fut:645:26-652:118\n   #2  ft_libs/ftSkyline.fut:644:17-652:118\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool cond_46669 = slt64(min_subdiv_33958, loopres_46589);
        bool cond_t_res_46670 = slt64((int64_t) 0, loopres_46589);
        bool x_46671 = cond_46669 && cond_t_res_46670;
        bool loop_cond_t_res_46672 = slt64(sizze_thresh_33960, loopres_46584);
        bool x_46673 = x_46671 && loop_cond_t_res_46672;
        
        if (memblock_set_device(ctx, &mem_param_tmp_53225, &ext_mem_52664, "ext_mem_52664") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_53226, &ext_mem_52661, "ext_mem_52661") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_53227, &ext_mem_52657, "ext_mem_52657") != 0)
            return 1;
        
        int64_t ctx_param_ext_tmp_53228 = ext_52663;
        int64_t ctx_param_ext_tmp_53229 = ext_52662;
        int64_t ctx_param_ext_tmp_53230 = ext_52660;
        int64_t ctx_param_ext_tmp_53231 = ext_52659;
        int64_t ctx_param_ext_tmp_53232 = ext_52658;
        int64_t ctx_param_ext_tmp_53233 = ext_52656;
        int64_t ctx_param_ext_tmp_53234 = ext_52655;
        int64_t loop_dz2082U_tmp_53235 = loopres_46584;
        bool loop_while_tmp_53236 = x_46673;
        int64_t subdiv_tmp_53240 = loopres_46589;
        
        if (memblock_set_device(ctx, &mem_param_52573, &mem_param_tmp_53225, "mem_param_tmp_53225") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_52577, &mem_param_tmp_53226, "mem_param_tmp_53226") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_52580, &mem_param_tmp_53227, "mem_param_tmp_53227") != 0)
            return 1;
        ctx_param_ext_52571 = ctx_param_ext_tmp_53228;
        ctx_param_ext_52572 = ctx_param_ext_tmp_53229;
        ctx_param_ext_52574 = ctx_param_ext_tmp_53230;
        ctx_param_ext_52575 = ctx_param_ext_tmp_53231;
        ctx_param_ext_52576 = ctx_param_ext_tmp_53232;
        ctx_param_ext_52578 = ctx_param_ext_tmp_53233;
        ctx_param_ext_52579 = ctx_param_ext_tmp_53234;
        loop_dz2082U_46571 = loop_dz2082U_tmp_53235;
        loop_while_46572 = loop_while_tmp_53236;
        subdiv_46576 = subdiv_tmp_53240;
    }
    if (memblock_set_device(ctx, &ext_mem_52674, &mem_param_52573, "mem_param_52573") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_52673, &mem_param_52577, "mem_param_52577") != 0)
        return 1;
    if (memblock_set_device(ctx, &ext_mem_52672, &mem_param_52580, "mem_param_52580") != 0)
        return 1;
    ext_52671 = ctx_param_ext_52571;
    ext_52670 = ctx_param_ext_52572;
    ext_52669 = ctx_param_ext_52574;
    ext_52668 = ctx_param_ext_52575;
    ext_52667 = ctx_param_ext_52576;
    ext_52666 = ctx_param_ext_52578;
    ext_52665 = ctx_param_ext_52579;
    calc_intermediate_skyline_res_46565 = loop_dz2082U_46571;
    calc_intermediate_skyline_res_46566 = loop_while_46572;
    calc_intermediate_skyline_res_46570 = subdiv_46576;
    if (memblock_unref_device(ctx, &mem_52570, "mem_52570") != 0)
        return 1;
    
    int64_t binop_x_52675 = (int64_t) 4 * calc_intermediate_skyline_res_46565;
    int64_t bytes_52676 = dim_33939 * binop_x_52675;
    int64_t bytes_52679 = (int64_t) 8 * calc_intermediate_skyline_res_46565;
    
    if (memblock_alloc_device(ctx, &mem_52677, bytes_52676, "mem_52677")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52677.mem, (int64_t) 0, (int64_t []) {dim_33939, (int64_t) 1}, ext_mem_52673.mem, ext_52669, (int64_t []) {ext_52668, ext_52667}, (int64_t []) {calc_intermediate_skyline_res_46565, dim_33939})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_52673, "ext_mem_52673") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52680, bytes_52679, "mem_52680")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52680.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, ext_mem_52672.mem, ext_52666, (int64_t []) {ext_52665}, (int64_t []) {calc_intermediate_skyline_res_46565})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &ext_mem_52672, "ext_mem_52672") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52677, "mem_52677") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52680, "mem_52680") != 0)
        return 1;
    prim_out_53220 = calc_intermediate_skyline_res_46565;
    if (memblock_set_device(ctx, &*mem_out_p_54056, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54057, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54058, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54059 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52680, "mem_52680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52677, "mem_52677") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53227, "mem_param_tmp_53227") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53226, "mem_param_tmp_53226") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53225, "mem_param_tmp_53225") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53478, "mem_param_tmp_53478") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53477, "mem_param_tmp_53477") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53476, "mem_param_tmp_53476") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52630, "ext_mem_52630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52631, "ext_mem_52631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52632, "ext_mem_52632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52628, "mem_52628") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52625, "mem_52625") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53597, "segred_tmp_mem_53597") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53503, "incprefixes_mem_53503") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53501, "aggregates_mem_53501") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53499, "status_flags_mem_53499") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52608, "mem_param_52608") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52605, "mem_param_52605") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52601, "mem_param_52601") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52640, "ext_mem_52640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52641, "ext_mem_52641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52642, "ext_mem_52642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52621, "mem_52621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52620, "mem_52620") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52617, "mem_52617") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52615, "mem_52615") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52613, "mem_52613") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52610, "mem_52610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52598, "mem_52598") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52595, "mem_52595") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52593, "mem_52593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53356, "incprefixes_mem_53356") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53354, "aggregates_mem_53354") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53332, "status_flags_mem_53332") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52590, "mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52587, "mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52584, "mem_52584") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52652, "ext_mem_52652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52653, "ext_mem_52653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52654, "ext_mem_52654") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52650, "mem_52650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52647, "mem_52647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52643, "mem_52643") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52657, "ext_mem_52657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52661, "ext_mem_52661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52664, "ext_mem_52664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53265, "segred_tmp_mem_53265") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52582, "mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52580, "mem_param_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52577, "mem_param_52577") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52573, "mem_param_52573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52672, "ext_mem_52672") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52673, "ext_mem_52673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52674, "ext_mem_52674") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52570, "mem_52570") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_local_filter_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54064, struct memblock_device *mem_out_p_54065, struct memblock_device *mem_out_p_54066, int64_t *out_prim_out_54067, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_32683, int64_t dz2080U_32684, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685, int64_t dz2081U_32686, int64_t dz2082U_32687, int64_t m_sizze_32693, int64_t total_angle_no_32695, int64_t total_grid_no_32696, int64_t total_part_no_32697, bool use_many_pts_32701)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device ext_mem_52570;
    
    ext_mem_52570.references = NULL;
    
    struct memblock_device ext_mem_52571;
    
    ext_mem_52571.references = NULL;
    
    struct memblock_device ext_mem_52572;
    
    ext_mem_52572.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_43441 = sub64(dim_32683, (int64_t) 1);
    bool assert_cond_43442 = arg_43441 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685;
    bool assert_c_43443;
    
    if (!assert_cond_43442) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:642:25-80\n   #1  ft_libs/ftSkyline.fut:637:17-642:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t skyline_local_filter_float_res_43444;
    
    if (futrts_skyline_local_filter_9621(ctx, &ext_mem_52572, &ext_mem_52571, &ext_mem_52570, &skyline_local_filter_float_res_43444, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_32683, dz2080U_32684, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685, dz2081U_32686, dz2082U_32687, m_sizze_32693, total_angle_no_32695, total_grid_no_32696, total_part_no_32697, use_many_pts_32701) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_53217, &ext_mem_52572, "ext_mem_52572") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &ext_mem_52571, "ext_mem_52571") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &ext_mem_52570, "ext_mem_52570") != 0)
        return 1;
    prim_out_53220 = skyline_local_filter_float_res_43444;
    if (memblock_set_device(ctx, &*mem_out_p_54064, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54065, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54066, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54067 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &ext_mem_52570, "ext_mem_52570") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52571, "ext_mem_52571") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52572, "ext_mem_52572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_2_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54068, struct memblock_device *mem_out_p_54069, struct memblock_device *mem_out_p_54070, int64_t *out_prim_out_54071, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_43206, int64_t dz2080U_43207, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, int64_t dz2082U_43209, int64_t dz2081U_43210, int64_t dz2082U_43211, bool self_filter_first_43212, int64_t m_sizze_43218, int64_t total_angle_no_43220, int64_t total_grid_no_43221, int64_t total_part_no_43222)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52594;
    
    mem_52594.references = NULL;
    
    struct memblock_device mem_52592;
    
    mem_52592.references = NULL;
    
    struct memblock_device mem_52590;
    
    mem_52590.references = NULL;
    
    struct memblock_device ext_mem_52585;
    
    ext_mem_52585.references = NULL;
    
    struct memblock_device ext_mem_52586;
    
    ext_mem_52586.references = NULL;
    
    struct memblock_device ext_mem_52587;
    
    ext_mem_52587.references = NULL;
    
    struct memblock_device ext_mem_52582;
    
    ext_mem_52582.references = NULL;
    
    struct memblock_device ext_mem_52583;
    
    ext_mem_52583.references = NULL;
    
    struct memblock_device ext_mem_52584;
    
    ext_mem_52584.references = NULL;
    
    struct memblock_device ext_mem_52579;
    
    ext_mem_52579.references = NULL;
    
    struct memblock_device ext_mem_52580;
    
    ext_mem_52580.references = NULL;
    
    struct memblock_device ext_mem_52581;
    
    ext_mem_52581.references = NULL;
    
    struct memblock_device ext_mem_52573;
    
    ext_mem_52573.references = NULL;
    
    struct memblock_device ext_mem_52574;
    
    ext_mem_52574.references = NULL;
    
    struct memblock_device ext_mem_52575;
    
    ext_mem_52575.references = NULL;
    
    struct memblock_device ext_mem_52576;
    
    ext_mem_52576.references = NULL;
    
    struct memblock_device ext_mem_52577;
    
    ext_mem_52577.references = NULL;
    
    struct memblock_device ext_mem_52578;
    
    ext_mem_52578.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_45468 = sub64(dim_43206, (int64_t) 1);
    bool assert_cond_45469 = arg_45468 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208;
    bool assert_c_45470;
    
    if (!assert_cond_45469) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:712:26-714:61\n   #1  ft_libs/ftSkyline.fut:708:17-714:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t mergeFilter_Skylines_2_res_45471;
    int64_t mergeFilter_Skylines_2_res_45472;
    
    if (self_filter_first_43212) {
        int64_t mergeFilter_Skylines_2_res_t_res_47798;
        
        if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52575, &ext_mem_52574, &ext_mem_52573, &mergeFilter_Skylines_2_res_t_res_47798, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_43206, dz2080U_43207, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, dz2081U_43210, dz2082U_43209, m_sizze_43218, total_angle_no_43220, total_grid_no_43221, total_part_no_43222) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_52578, &ext_mem_52575, "ext_mem_52575") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52577, &ext_mem_52574, "ext_mem_52574") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52576, &ext_mem_52573, "ext_mem_52573") != 0)
            return 1;
        mergeFilter_Skylines_2_res_45471 = mergeFilter_Skylines_2_res_t_res_47798;
        mergeFilter_Skylines_2_res_45472 = mergeFilter_Skylines_2_res_t_res_47798;
    } else {
        if (memblock_set_device(ctx, &ext_mem_52578, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52577, &xys_mem_52568, "xys_mem_52568") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52576, &xys_mem_52569, "xys_mem_52569") != 0)
            return 1;
        mergeFilter_Skylines_2_res_45471 = dz2082U_43209;
        mergeFilter_Skylines_2_res_45472 = dz2082U_43209;
    }
    
    int64_t mergeFilter_Skylines_2_res_45480;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52581, &ext_mem_52580, &ext_mem_52579, &mergeFilter_Skylines_2_res_45480, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_43206, dz2080U_43207, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, dz2081U_43210, dz2082U_43211, m_sizze_43218, total_angle_no_43220, total_grid_no_43221, total_part_no_43222) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool dim_match_45484 = mergeFilter_Skylines_2_res_45471 == mergeFilter_Skylines_2_res_45472;
    bool empty_or_match_cert_45485;
    
    if (!dim_match_45484) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftSkyline.fut:593:29-34\n   #1  ft_libs/ftSkyline.fut:710:26-714:79\n   #2  ft_libs/ftSkyline.fut:708:17-714:93\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45487;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52584, &ext_mem_52583, &ext_mem_52582, &defunc_0_f_res_45487, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52578, ext_mem_52577, ext_mem_52576, ext_mem_52581, ext_mem_52580, ext_mem_52579, dim_43206, dz2080U_43207, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, dz2081U_43210, mergeFilter_Skylines_2_res_45471, dz2081U_43210, mergeFilter_Skylines_2_res_45480, m_sizze_43218, total_angle_no_43220, total_grid_no_43221, total_part_no_43222) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52579, "ext_mem_52579") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52580, "ext_mem_52580") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52581, "ext_mem_52581") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45506;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52587, &ext_mem_52586, &ext_mem_52585, &defunc_0_f_res_45506, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52584, ext_mem_52583, ext_mem_52582, ext_mem_52578, ext_mem_52577, ext_mem_52576, dim_43206, dz2080U_43207, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, dz2081U_43210, defunc_0_f_res_45487, dz2081U_43210, mergeFilter_Skylines_2_res_45471, m_sizze_43218, total_angle_no_43220, total_grid_no_43221, total_part_no_43222) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52576, "ext_mem_52576") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52577, "ext_mem_52577") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52578, "ext_mem_52578") != 0)
        return 1;
    
    int64_t conc_tmp_45522 = defunc_0_f_res_45487 + defunc_0_f_res_45506;
    int64_t binop_x_52588 = (int64_t) 4 * conc_tmp_45522;
    int64_t bytes_52589 = dim_43206 * binop_x_52588;
    int64_t bytes_52591 = (int64_t) 8 * conc_tmp_45522;
    
    if (memblock_alloc_device(ctx, &mem_52590, bytes_52589, "mem_52590")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52590.mem, dim_43206 * tmp_offs_53221, (int64_t []) {dim_43206, (int64_t) 1}, ext_mem_52586.mem, (int64_t) 0, (int64_t []) {dim_43206, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45506, dim_43206})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45506;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52590.mem, dim_43206 * tmp_offs_53221, (int64_t []) {dim_43206, (int64_t) 1}, ext_mem_52583.mem, (int64_t) 0, (int64_t []) {dim_43206, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45487, dim_43206})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45487;
    if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52592, bytes_52591, "mem_52592")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52592.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52585.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45506})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45506;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52592.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52582.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45487})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45487;
    if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_49491;
    
    segmap_tblock_sizze_49491 = *ctx->tuning_params.skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482;
    
    int64_t segmap_usable_groups_49492 = sdiv_up64(dz2081U_43210, segmap_tblock_sizze_49491);
    
    if (memblock_alloc_device(ctx, &mem_52594, dz2081U_43210, "mem_52594")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_43210, segmap_tblock_sizze_49491));
    
    {
        err = gpu_kernel_skyline_mergeFilter_2_floatzisegmap_49495(ctx, segmap_usable_groups_49492, 1, 1, *ctx->tuning_params.skyline_mergeFilter_2_floatzisegmap_tblock_sizze_49482, 1, 1, (int64_t) 0, dz2081U_43210, ext_mem_52584.mem, ext_mem_52587.mem, mem_52594.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52594, "mem_52594") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52590, "mem_52590") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52592, "mem_52592") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45522;
    if (memblock_set_device(ctx, &*mem_out_p_54068, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54069, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54070, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54071 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52594, "mem_52594") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52592, "mem_52592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52590, "mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52579, "ext_mem_52579") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52580, "ext_mem_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52581, "ext_mem_52581") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52573, "ext_mem_52573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52574, "ext_mem_52574") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52575, "ext_mem_52575") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52576, "ext_mem_52576") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52577, "ext_mem_52577") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52578, "ext_mem_52578") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_3_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54072, struct memblock_device *mem_out_p_54073, struct memblock_device *mem_out_p_54074, int64_t *out_prim_out_54075, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, int64_t dim_42759, int64_t dz2080U_42760, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, int64_t dz2082U_42762, int64_t dz2081U_42763, int64_t dz2082U_42764, int64_t dz2082U_42765, bool self_filter_first_42766, int64_t m_sizze_42772, int64_t total_angle_no_42774, int64_t total_grid_no_42775, int64_t total_part_no_42776)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52612;
    
    mem_52612.references = NULL;
    
    struct memblock_device mem_52610;
    
    mem_52610.references = NULL;
    
    struct memblock_device mem_52608;
    
    mem_52608.references = NULL;
    
    struct memblock_device ext_mem_52603;
    
    ext_mem_52603.references = NULL;
    
    struct memblock_device ext_mem_52604;
    
    ext_mem_52604.references = NULL;
    
    struct memblock_device ext_mem_52605;
    
    ext_mem_52605.references = NULL;
    
    struct memblock_device ext_mem_52600;
    
    ext_mem_52600.references = NULL;
    
    struct memblock_device ext_mem_52601;
    
    ext_mem_52601.references = NULL;
    
    struct memblock_device ext_mem_52602;
    
    ext_mem_52602.references = NULL;
    
    struct memblock_device ext_mem_52597;
    
    ext_mem_52597.references = NULL;
    
    struct memblock_device ext_mem_52598;
    
    ext_mem_52598.references = NULL;
    
    struct memblock_device ext_mem_52599;
    
    ext_mem_52599.references = NULL;
    
    struct memblock_device ext_mem_52594;
    
    ext_mem_52594.references = NULL;
    
    struct memblock_device ext_mem_52595;
    
    ext_mem_52595.references = NULL;
    
    struct memblock_device ext_mem_52596;
    
    ext_mem_52596.references = NULL;
    
    struct memblock_device ext_mem_52591;
    
    ext_mem_52591.references = NULL;
    
    struct memblock_device ext_mem_52592;
    
    ext_mem_52592.references = NULL;
    
    struct memblock_device ext_mem_52593;
    
    ext_mem_52593.references = NULL;
    
    struct memblock_device ext_mem_52588;
    
    ext_mem_52588.references = NULL;
    
    struct memblock_device ext_mem_52589;
    
    ext_mem_52589.references = NULL;
    
    struct memblock_device ext_mem_52590;
    
    ext_mem_52590.references = NULL;
    
    struct memblock_device ext_mem_52585;
    
    ext_mem_52585.references = NULL;
    
    struct memblock_device ext_mem_52586;
    
    ext_mem_52586.references = NULL;
    
    struct memblock_device ext_mem_52587;
    
    ext_mem_52587.references = NULL;
    
    struct memblock_device ext_mem_52582;
    
    ext_mem_52582.references = NULL;
    
    struct memblock_device ext_mem_52583;
    
    ext_mem_52583.references = NULL;
    
    struct memblock_device ext_mem_52584;
    
    ext_mem_52584.references = NULL;
    
    struct memblock_device ext_mem_52576;
    
    ext_mem_52576.references = NULL;
    
    struct memblock_device ext_mem_52577;
    
    ext_mem_52577.references = NULL;
    
    struct memblock_device ext_mem_52578;
    
    ext_mem_52578.references = NULL;
    
    struct memblock_device ext_mem_52579;
    
    ext_mem_52579.references = NULL;
    
    struct memblock_device ext_mem_52580;
    
    ext_mem_52580.references = NULL;
    
    struct memblock_device ext_mem_52581;
    
    ext_mem_52581.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_45472 = sub64(dim_42759, (int64_t) 1);
    bool assert_cond_45473 = arg_45472 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761;
    bool assert_c_45474;
    
    if (!assert_cond_45473) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:705:26-707:61\n   #1  ft_libs/ftSkyline.fut:700:17-707:98\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t mergeFilter_Skylines_3_res_45475;
    int64_t mergeFilter_Skylines_3_res_45476;
    
    if (self_filter_first_42766) {
        int64_t mergeFilter_Skylines_3_res_t_res_47798;
        
        if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52578, &ext_mem_52577, &ext_mem_52576, &mergeFilter_Skylines_3_res_t_res_47798, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, dz2082U_42762, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_52581, &ext_mem_52578, "ext_mem_52578") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52580, &ext_mem_52577, "ext_mem_52577") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52579, &ext_mem_52576, "ext_mem_52576") != 0)
            return 1;
        mergeFilter_Skylines_3_res_45475 = mergeFilter_Skylines_3_res_t_res_47798;
        mergeFilter_Skylines_3_res_45476 = mergeFilter_Skylines_3_res_t_res_47798;
    } else {
        if (memblock_set_device(ctx, &ext_mem_52581, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52580, &xys_mem_52568, "xys_mem_52568") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52579, &xys_mem_52569, "xys_mem_52569") != 0)
            return 1;
        mergeFilter_Skylines_3_res_45475 = dz2082U_42762;
        mergeFilter_Skylines_3_res_45476 = dz2082U_42762;
    }
    
    int64_t mergeFilter_Skylines_3_res_45484;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52584, &ext_mem_52583, &ext_mem_52582, &mergeFilter_Skylines_3_res_45484, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, dz2082U_42764, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool dim_match_45488 = mergeFilter_Skylines_3_res_45475 == mergeFilter_Skylines_3_res_45476;
    bool empty_or_match_cert_45489;
    
    if (!dim_match_45488) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftSkyline.fut:571:29-34\n   #1  ft_libs/ftSkyline.fut:702:26-707:79\n   #2  ft_libs/ftSkyline.fut:700:17-707:98\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45491;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52587, &ext_mem_52586, &ext_mem_52585, &defunc_0_f_res_45491, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52581, ext_mem_52580, ext_mem_52579, ext_mem_52584, ext_mem_52583, ext_mem_52582, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, mergeFilter_Skylines_3_res_45475, dz2081U_42763, mergeFilter_Skylines_3_res_45484, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_3_res_45501;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52590, &ext_mem_52589, &ext_mem_52588, &mergeFilter_Skylines_3_res_45501, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, dz2082U_42765, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45508;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52593, &ext_mem_52592, &ext_mem_52591, &defunc_0_f_res_45508, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52581, ext_mem_52580, ext_mem_52579, ext_mem_52590, ext_mem_52589, ext_mem_52588, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, mergeFilter_Skylines_3_res_45475, dz2081U_42763, mergeFilter_Skylines_3_res_45501, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45527;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52596, &ext_mem_52595, &ext_mem_52594, &defunc_0_f_res_45527, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52587, ext_mem_52586, ext_mem_52585, ext_mem_52581, ext_mem_52580, ext_mem_52579, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, defunc_0_f_res_45491, dz2081U_42763, mergeFilter_Skylines_3_res_45475, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52579, "ext_mem_52579") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52580, "ext_mem_52580") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52581, "ext_mem_52581") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45558;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52599, &ext_mem_52598, &ext_mem_52597, &defunc_0_f_res_45558, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52593, ext_mem_52592, ext_mem_52591, ext_mem_52596, ext_mem_52595, ext_mem_52594, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, defunc_0_f_res_45508, dz2081U_42763, defunc_0_f_res_45527, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45589;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52602, &ext_mem_52601, &ext_mem_52600, &defunc_0_f_res_45589, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52593, ext_mem_52592, ext_mem_52591, ext_mem_52587, ext_mem_52586, ext_mem_52585, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, defunc_0_f_res_45508, dz2081U_42763, defunc_0_f_res_45491, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45620;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52605, &ext_mem_52604, &ext_mem_52603, &defunc_0_f_res_45620, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52602, ext_mem_52601, ext_mem_52600, ext_mem_52593, ext_mem_52592, ext_mem_52591, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2081U_42763, defunc_0_f_res_45589, dz2081U_42763, defunc_0_f_res_45508, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
        return 1;
    
    int64_t conc_tmp_45642 = defunc_0_f_res_45558 + defunc_0_f_res_45589;
    int64_t conc_tmp_45645 = defunc_0_f_res_45620 + conc_tmp_45642;
    int64_t binop_x_52606 = (int64_t) 4 * conc_tmp_45645;
    int64_t bytes_52607 = dim_42759 * binop_x_52606;
    int64_t bytes_52609 = (int64_t) 8 * conc_tmp_45645;
    
    if (memblock_alloc_device(ctx, &mem_52608, bytes_52607, "mem_52608")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52608.mem, dim_42759 * tmp_offs_53221, (int64_t []) {dim_42759, (int64_t) 1}, ext_mem_52598.mem, (int64_t) 0, (int64_t []) {dim_42759, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45558, dim_42759})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45558;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52608.mem, dim_42759 * tmp_offs_53221, (int64_t []) {dim_42759, (int64_t) 1}, ext_mem_52601.mem, (int64_t) 0, (int64_t []) {dim_42759, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45589, dim_42759})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45589;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52608.mem, dim_42759 * tmp_offs_53221, (int64_t []) {dim_42759, (int64_t) 1}, ext_mem_52604.mem, (int64_t) 0, (int64_t []) {dim_42759, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45620, dim_42759})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45620;
    if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52610, bytes_52609, "mem_52610")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52610.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52597.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45558})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45558;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52610.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52600.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45589})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45589;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52610.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52603.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45620})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45620;
    if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_49469;
    
    segmap_tblock_sizze_49469 = *ctx->tuning_params.skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458;
    
    int64_t segmap_usable_groups_49470 = sdiv_up64(dz2081U_42763, segmap_tblock_sizze_49469);
    
    if (memblock_alloc_device(ctx, &mem_52612, dz2081U_42763, "mem_52612")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_42763, segmap_tblock_sizze_49469));
    
    {
        err = gpu_kernel_skyline_mergeFilter_3_floatzisegmap_49473(ctx, segmap_usable_groups_49470, 1, 1, *ctx->tuning_params.skyline_mergeFilter_3_floatzisegmap_tblock_sizze_49458, 1, 1, (int64_t) 0, dz2081U_42763, ext_mem_52599.mem, ext_mem_52602.mem, ext_mem_52605.mem, mem_52612.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52612, "mem_52612") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52608, "mem_52608") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52610, "mem_52610") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45645;
    if (memblock_set_device(ctx, &*mem_out_p_54072, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54073, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54074, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54075 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52612, "mem_52612") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52610, "mem_52610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52608, "mem_52608") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52576, "ext_mem_52576") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52577, "ext_mem_52577") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52578, "ext_mem_52578") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52579, "ext_mem_52579") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52580, "ext_mem_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52581, "ext_mem_52581") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_4_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54076, struct memblock_device *mem_out_p_54077, struct memblock_device *mem_out_p_54078, int64_t *out_prim_out_54079, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, struct memblock_device isPartitionDominated_mem_52576, struct memblock_device xys_mem_52577, struct memblock_device xys_mem_52578, int64_t dim_41602, int64_t dz2080U_41603, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, int64_t dz2082U_41605, int64_t dz2081U_41606, int64_t dz2082U_41607, int64_t dz2082U_41608, int64_t dz2082U_41609, bool self_filter_first_41610, int64_t m_sizze_41616, int64_t total_angle_no_41618, int64_t total_grid_no_41619, int64_t total_part_no_41620)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52636;
    
    mem_52636.references = NULL;
    
    struct memblock_device mem_52634;
    
    mem_52634.references = NULL;
    
    struct memblock_device mem_52632;
    
    mem_52632.references = NULL;
    
    struct memblock_device ext_mem_52627;
    
    ext_mem_52627.references = NULL;
    
    struct memblock_device ext_mem_52628;
    
    ext_mem_52628.references = NULL;
    
    struct memblock_device ext_mem_52629;
    
    ext_mem_52629.references = NULL;
    
    struct memblock_device ext_mem_52624;
    
    ext_mem_52624.references = NULL;
    
    struct memblock_device ext_mem_52625;
    
    ext_mem_52625.references = NULL;
    
    struct memblock_device ext_mem_52626;
    
    ext_mem_52626.references = NULL;
    
    struct memblock_device ext_mem_52621;
    
    ext_mem_52621.references = NULL;
    
    struct memblock_device ext_mem_52622;
    
    ext_mem_52622.references = NULL;
    
    struct memblock_device ext_mem_52623;
    
    ext_mem_52623.references = NULL;
    
    struct memblock_device ext_mem_52618;
    
    ext_mem_52618.references = NULL;
    
    struct memblock_device ext_mem_52619;
    
    ext_mem_52619.references = NULL;
    
    struct memblock_device ext_mem_52620;
    
    ext_mem_52620.references = NULL;
    
    struct memblock_device ext_mem_52615;
    
    ext_mem_52615.references = NULL;
    
    struct memblock_device ext_mem_52616;
    
    ext_mem_52616.references = NULL;
    
    struct memblock_device ext_mem_52617;
    
    ext_mem_52617.references = NULL;
    
    struct memblock_device ext_mem_52612;
    
    ext_mem_52612.references = NULL;
    
    struct memblock_device ext_mem_52613;
    
    ext_mem_52613.references = NULL;
    
    struct memblock_device ext_mem_52614;
    
    ext_mem_52614.references = NULL;
    
    struct memblock_device ext_mem_52609;
    
    ext_mem_52609.references = NULL;
    
    struct memblock_device ext_mem_52610;
    
    ext_mem_52610.references = NULL;
    
    struct memblock_device ext_mem_52611;
    
    ext_mem_52611.references = NULL;
    
    struct memblock_device ext_mem_52606;
    
    ext_mem_52606.references = NULL;
    
    struct memblock_device ext_mem_52607;
    
    ext_mem_52607.references = NULL;
    
    struct memblock_device ext_mem_52608;
    
    ext_mem_52608.references = NULL;
    
    struct memblock_device ext_mem_52603;
    
    ext_mem_52603.references = NULL;
    
    struct memblock_device ext_mem_52604;
    
    ext_mem_52604.references = NULL;
    
    struct memblock_device ext_mem_52605;
    
    ext_mem_52605.references = NULL;
    
    struct memblock_device ext_mem_52600;
    
    ext_mem_52600.references = NULL;
    
    struct memblock_device ext_mem_52601;
    
    ext_mem_52601.references = NULL;
    
    struct memblock_device ext_mem_52602;
    
    ext_mem_52602.references = NULL;
    
    struct memblock_device ext_mem_52597;
    
    ext_mem_52597.references = NULL;
    
    struct memblock_device ext_mem_52598;
    
    ext_mem_52598.references = NULL;
    
    struct memblock_device ext_mem_52599;
    
    ext_mem_52599.references = NULL;
    
    struct memblock_device ext_mem_52594;
    
    ext_mem_52594.references = NULL;
    
    struct memblock_device ext_mem_52595;
    
    ext_mem_52595.references = NULL;
    
    struct memblock_device ext_mem_52596;
    
    ext_mem_52596.references = NULL;
    
    struct memblock_device ext_mem_52591;
    
    ext_mem_52591.references = NULL;
    
    struct memblock_device ext_mem_52592;
    
    ext_mem_52592.references = NULL;
    
    struct memblock_device ext_mem_52593;
    
    ext_mem_52593.references = NULL;
    
    struct memblock_device ext_mem_52588;
    
    ext_mem_52588.references = NULL;
    
    struct memblock_device ext_mem_52589;
    
    ext_mem_52589.references = NULL;
    
    struct memblock_device ext_mem_52590;
    
    ext_mem_52590.references = NULL;
    
    struct memblock_device ext_mem_52585;
    
    ext_mem_52585.references = NULL;
    
    struct memblock_device ext_mem_52586;
    
    ext_mem_52586.references = NULL;
    
    struct memblock_device ext_mem_52587;
    
    ext_mem_52587.references = NULL;
    
    struct memblock_device ext_mem_52579;
    
    ext_mem_52579.references = NULL;
    
    struct memblock_device ext_mem_52580;
    
    ext_mem_52580.references = NULL;
    
    struct memblock_device ext_mem_52581;
    
    ext_mem_52581.references = NULL;
    
    struct memblock_device ext_mem_52582;
    
    ext_mem_52582.references = NULL;
    
    struct memblock_device ext_mem_52583;
    
    ext_mem_52583.references = NULL;
    
    struct memblock_device ext_mem_52584;
    
    ext_mem_52584.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_45879 = sub64(dim_41602, (int64_t) 1);
    bool assert_cond_45880 = arg_45879 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604;
    bool assert_c_45881;
    
    if (!assert_cond_45880) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:697:26-699:61\n   #1  ft_libs/ftSkyline.fut:691:17-699:103\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t mergeFilter_Skylines_4_res_45882;
    int64_t mergeFilter_Skylines_4_res_45883;
    
    if (self_filter_first_41610) {
        int64_t mergeFilter_Skylines_4_res_t_res_47798;
        
        if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52581, &ext_mem_52580, &ext_mem_52579, &mergeFilter_Skylines_4_res_t_res_47798, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, dz2082U_41605, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_52584, &ext_mem_52581, "ext_mem_52581") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52583, &ext_mem_52580, "ext_mem_52580") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52582, &ext_mem_52579, "ext_mem_52579") != 0)
            return 1;
        mergeFilter_Skylines_4_res_45882 = mergeFilter_Skylines_4_res_t_res_47798;
        mergeFilter_Skylines_4_res_45883 = mergeFilter_Skylines_4_res_t_res_47798;
    } else {
        if (memblock_set_device(ctx, &ext_mem_52584, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52583, &xys_mem_52568, "xys_mem_52568") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52582, &xys_mem_52569, "xys_mem_52569") != 0)
            return 1;
        mergeFilter_Skylines_4_res_45882 = dz2082U_41605;
        mergeFilter_Skylines_4_res_45883 = dz2082U_41605;
    }
    
    int64_t mergeFilter_Skylines_4_res_45891;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52587, &ext_mem_52586, &ext_mem_52585, &mergeFilter_Skylines_4_res_45891, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, dz2082U_41607, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool dim_match_45895 = mergeFilter_Skylines_4_res_45882 == mergeFilter_Skylines_4_res_45883;
    bool empty_or_match_cert_45896;
    
    if (!dim_match_45895) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftSkyline.fut:540:29-34\n   #1  ft_libs/ftSkyline.fut:693:26-699:79\n   #2  ft_libs/ftSkyline.fut:691:17-699:103\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45898;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52590, &ext_mem_52589, &ext_mem_52588, &defunc_0_f_res_45898, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52584, ext_mem_52583, ext_mem_52582, ext_mem_52587, ext_mem_52586, ext_mem_52585, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, mergeFilter_Skylines_4_res_45882, dz2081U_41606, mergeFilter_Skylines_4_res_45891, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_4_res_45902;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52593, &ext_mem_52592, &ext_mem_52591, &mergeFilter_Skylines_4_res_45902, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, dz2082U_41608, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45906;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52596, &ext_mem_52595, &ext_mem_52594, &defunc_0_f_res_45906, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52584, ext_mem_52583, ext_mem_52582, ext_mem_52593, ext_mem_52592, ext_mem_52591, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, mergeFilter_Skylines_4_res_45882, dz2081U_41606, mergeFilter_Skylines_4_res_45902, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_4_res_45910;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52599, &ext_mem_52598, &ext_mem_52597, &mergeFilter_Skylines_4_res_45910, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52576, xys_mem_52577, xys_mem_52578, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, dz2082U_41609, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_45914;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52602, &ext_mem_52601, &ext_mem_52600, &defunc_0_f_res_45914, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52584, ext_mem_52583, ext_mem_52582, ext_mem_52599, ext_mem_52598, ext_mem_52597, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, mergeFilter_Skylines_4_res_45882, dz2081U_41606, mergeFilter_Skylines_4_res_45910, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45918;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52605, &ext_mem_52604, &ext_mem_52603, &defunc_0_f_res_45918, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52590, ext_mem_52589, ext_mem_52588, ext_mem_52584, ext_mem_52583, ext_mem_52582, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45898, dz2081U_41606, mergeFilter_Skylines_4_res_45882, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45922;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52608, &ext_mem_52607, &ext_mem_52606, &defunc_0_f_res_45922, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52596, ext_mem_52595, ext_mem_52594, ext_mem_52605, ext_mem_52604, ext_mem_52603, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45906, dz2081U_41606, defunc_0_f_res_45918, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45926;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52611, &ext_mem_52610, &ext_mem_52609, &defunc_0_f_res_45926, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52602, ext_mem_52601, ext_mem_52600, ext_mem_52608, ext_mem_52607, ext_mem_52606, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45914, dz2081U_41606, defunc_0_f_res_45922, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52606, "ext_mem_52606") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52607, "ext_mem_52607") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52608, "ext_mem_52608") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45930;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52614, &ext_mem_52613, &ext_mem_52612, &defunc_0_f_res_45930, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52596, ext_mem_52595, ext_mem_52594, ext_mem_52590, ext_mem_52589, ext_mem_52588, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45906, dz2081U_41606, defunc_0_f_res_45898, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45934;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52617, &ext_mem_52616, &ext_mem_52615, &defunc_0_f_res_45934, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52602, ext_mem_52601, ext_mem_52600, ext_mem_52614, ext_mem_52613, ext_mem_52612, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45914, dz2081U_41606, defunc_0_f_res_45930, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52612, "ext_mem_52612") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52613, "ext_mem_52613") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52614, "ext_mem_52614") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45938;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52620, &ext_mem_52619, &ext_mem_52618, &defunc_0_f_res_45938, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52617, ext_mem_52616, ext_mem_52615, ext_mem_52596, ext_mem_52595, ext_mem_52594, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45934, dz2081U_41606, defunc_0_f_res_45906, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45942;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52623, &ext_mem_52622, &ext_mem_52621, &defunc_0_f_res_45942, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52602, ext_mem_52601, ext_mem_52600, ext_mem_52620, ext_mem_52619, ext_mem_52618, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45914, dz2081U_41606, defunc_0_f_res_45938, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52618, "ext_mem_52618") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52619, "ext_mem_52619") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52620, "ext_mem_52620") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45946;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52626, &ext_mem_52625, &ext_mem_52624, &defunc_0_f_res_45946, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52617, ext_mem_52616, ext_mem_52615, ext_mem_52602, ext_mem_52601, ext_mem_52600, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45934, dz2081U_41606, defunc_0_f_res_45914, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
        return 1;
    
    int64_t defunc_0_f_res_45950;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52629, &ext_mem_52628, &ext_mem_52627, &defunc_0_f_res_45950, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52623, ext_mem_52622, ext_mem_52621, ext_mem_52626, ext_mem_52625, ext_mem_52624, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2081U_41606, defunc_0_f_res_45942, dz2081U_41606, defunc_0_f_res_45946, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52624, "ext_mem_52624") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52625, "ext_mem_52625") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52626, "ext_mem_52626") != 0)
        return 1;
    
    int64_t conc_tmp_45954 = defunc_0_f_res_45926 + defunc_0_f_res_45934;
    int64_t conc_tmp_45955 = defunc_0_f_res_45942 + conc_tmp_45954;
    int64_t conc_tmp_45956 = defunc_0_f_res_45950 + conc_tmp_45955;
    int64_t binop_x_52630 = (int64_t) 4 * conc_tmp_45956;
    int64_t bytes_52631 = dim_41602 * binop_x_52630;
    int64_t bytes_52633 = (int64_t) 8 * conc_tmp_45956;
    
    if (memblock_alloc_device(ctx, &mem_52632, bytes_52631, "mem_52632")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52632.mem, dim_41602 * tmp_offs_53221, (int64_t []) {dim_41602, (int64_t) 1}, ext_mem_52610.mem, (int64_t) 0, (int64_t []) {dim_41602, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45926, dim_41602})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45926;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52632.mem, dim_41602 * tmp_offs_53221, (int64_t []) {dim_41602, (int64_t) 1}, ext_mem_52616.mem, (int64_t) 0, (int64_t []) {dim_41602, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45934, dim_41602})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45934;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52632.mem, dim_41602 * tmp_offs_53221, (int64_t []) {dim_41602, (int64_t) 1}, ext_mem_52622.mem, (int64_t) 0, (int64_t []) {dim_41602, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45942, dim_41602})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45942;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52632.mem, dim_41602 * tmp_offs_53221, (int64_t []) {dim_41602, (int64_t) 1}, ext_mem_52628.mem, (int64_t) 0, (int64_t []) {dim_41602, (int64_t) 1}, (int64_t []) {defunc_0_f_res_45950, dim_41602})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_45950;
    if (memblock_unref_device(ctx, &ext_mem_52610, "ext_mem_52610") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52616, "ext_mem_52616") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52622, "ext_mem_52622") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52628, "ext_mem_52628") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52634, bytes_52633, "mem_52634")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52634.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52609.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45926})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45926;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52634.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52615.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45934})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45934;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52634.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52621.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45942})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45942;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52634.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52627.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_45950})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_45950;
    if (memblock_unref_device(ctx, &ext_mem_52609, "ext_mem_52609") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52615, "ext_mem_52615") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52621, "ext_mem_52621") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52627, "ext_mem_52627") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_49547;
    
    segmap_tblock_sizze_49547 = *ctx->tuning_params.skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534;
    
    int64_t segmap_usable_groups_49548 = sdiv_up64(dz2081U_41606, segmap_tblock_sizze_49547);
    
    if (memblock_alloc_device(ctx, &mem_52636, dz2081U_41606, "mem_52636")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_41606, segmap_tblock_sizze_49547));
    
    {
        err = gpu_kernel_skyline_mergeFilter_4_floatzisegmap_49551(ctx, segmap_usable_groups_49548, 1, 1, *ctx->tuning_params.skyline_mergeFilter_4_floatzisegmap_tblock_sizze_49534, 1, 1, (int64_t) 0, dz2081U_41606, ext_mem_52611.mem, ext_mem_52617.mem, ext_mem_52623.mem, ext_mem_52629.mem, mem_52636.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_52611, "ext_mem_52611") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52617, "ext_mem_52617") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52623, "ext_mem_52623") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52629, "ext_mem_52629") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52636, "mem_52636") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52632, "mem_52632") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52634, "mem_52634") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45956;
    if (memblock_set_device(ctx, &*mem_out_p_54076, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54077, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54078, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54079 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52636, "mem_52636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52634, "mem_52634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52632, "mem_52632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52627, "ext_mem_52627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52628, "ext_mem_52628") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52629, "ext_mem_52629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52624, "ext_mem_52624") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52625, "ext_mem_52625") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52626, "ext_mem_52626") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52621, "ext_mem_52621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52622, "ext_mem_52622") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52623, "ext_mem_52623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52618, "ext_mem_52618") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52619, "ext_mem_52619") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52620, "ext_mem_52620") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52615, "ext_mem_52615") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52616, "ext_mem_52616") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52617, "ext_mem_52617") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52612, "ext_mem_52612") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52613, "ext_mem_52613") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52614, "ext_mem_52614") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52609, "ext_mem_52609") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52610, "ext_mem_52610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52611, "ext_mem_52611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52606, "ext_mem_52606") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52607, "ext_mem_52607") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52608, "ext_mem_52608") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52579, "ext_mem_52579") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52580, "ext_mem_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52581, "ext_mem_52581") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_mergeFilter_5_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54080, struct memblock_device *mem_out_p_54081, struct memblock_device *mem_out_p_54082, int64_t *out_prim_out_54083, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, struct memblock_device isPartitionDominated_mem_52576, struct memblock_device xys_mem_52577, struct memblock_device xys_mem_52578, struct memblock_device isPartitionDominated_mem_52579, struct memblock_device xys_mem_52580, struct memblock_device xys_mem_52581, int64_t dim_39383, int64_t dz2080U_39384, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, int64_t dz2082U_39386, int64_t dz2081U_39387, int64_t dz2082U_39388, int64_t dz2082U_39389, int64_t dz2082U_39390, int64_t dz2082U_39391, bool self_filter_first_39392, int64_t m_sizze_39398, int64_t total_angle_no_39400, int64_t total_grid_no_39401, int64_t total_part_no_39402)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52666;
    
    mem_52666.references = NULL;
    
    struct memblock_device mem_52664;
    
    mem_52664.references = NULL;
    
    struct memblock_device mem_52662;
    
    mem_52662.references = NULL;
    
    struct memblock_device ext_mem_52657;
    
    ext_mem_52657.references = NULL;
    
    struct memblock_device ext_mem_52658;
    
    ext_mem_52658.references = NULL;
    
    struct memblock_device ext_mem_52659;
    
    ext_mem_52659.references = NULL;
    
    struct memblock_device ext_mem_52654;
    
    ext_mem_52654.references = NULL;
    
    struct memblock_device ext_mem_52655;
    
    ext_mem_52655.references = NULL;
    
    struct memblock_device ext_mem_52656;
    
    ext_mem_52656.references = NULL;
    
    struct memblock_device ext_mem_52651;
    
    ext_mem_52651.references = NULL;
    
    struct memblock_device ext_mem_52652;
    
    ext_mem_52652.references = NULL;
    
    struct memblock_device ext_mem_52653;
    
    ext_mem_52653.references = NULL;
    
    struct memblock_device ext_mem_52648;
    
    ext_mem_52648.references = NULL;
    
    struct memblock_device ext_mem_52649;
    
    ext_mem_52649.references = NULL;
    
    struct memblock_device ext_mem_52650;
    
    ext_mem_52650.references = NULL;
    
    struct memblock_device ext_mem_52645;
    
    ext_mem_52645.references = NULL;
    
    struct memblock_device ext_mem_52646;
    
    ext_mem_52646.references = NULL;
    
    struct memblock_device ext_mem_52647;
    
    ext_mem_52647.references = NULL;
    
    struct memblock_device ext_mem_52642;
    
    ext_mem_52642.references = NULL;
    
    struct memblock_device ext_mem_52643;
    
    ext_mem_52643.references = NULL;
    
    struct memblock_device ext_mem_52644;
    
    ext_mem_52644.references = NULL;
    
    struct memblock_device ext_mem_52639;
    
    ext_mem_52639.references = NULL;
    
    struct memblock_device ext_mem_52640;
    
    ext_mem_52640.references = NULL;
    
    struct memblock_device ext_mem_52641;
    
    ext_mem_52641.references = NULL;
    
    struct memblock_device ext_mem_52636;
    
    ext_mem_52636.references = NULL;
    
    struct memblock_device ext_mem_52637;
    
    ext_mem_52637.references = NULL;
    
    struct memblock_device ext_mem_52638;
    
    ext_mem_52638.references = NULL;
    
    struct memblock_device ext_mem_52633;
    
    ext_mem_52633.references = NULL;
    
    struct memblock_device ext_mem_52634;
    
    ext_mem_52634.references = NULL;
    
    struct memblock_device ext_mem_52635;
    
    ext_mem_52635.references = NULL;
    
    struct memblock_device ext_mem_52630;
    
    ext_mem_52630.references = NULL;
    
    struct memblock_device ext_mem_52631;
    
    ext_mem_52631.references = NULL;
    
    struct memblock_device ext_mem_52632;
    
    ext_mem_52632.references = NULL;
    
    struct memblock_device ext_mem_52627;
    
    ext_mem_52627.references = NULL;
    
    struct memblock_device ext_mem_52628;
    
    ext_mem_52628.references = NULL;
    
    struct memblock_device ext_mem_52629;
    
    ext_mem_52629.references = NULL;
    
    struct memblock_device ext_mem_52624;
    
    ext_mem_52624.references = NULL;
    
    struct memblock_device ext_mem_52625;
    
    ext_mem_52625.references = NULL;
    
    struct memblock_device ext_mem_52626;
    
    ext_mem_52626.references = NULL;
    
    struct memblock_device ext_mem_52621;
    
    ext_mem_52621.references = NULL;
    
    struct memblock_device ext_mem_52622;
    
    ext_mem_52622.references = NULL;
    
    struct memblock_device ext_mem_52623;
    
    ext_mem_52623.references = NULL;
    
    struct memblock_device ext_mem_52618;
    
    ext_mem_52618.references = NULL;
    
    struct memblock_device ext_mem_52619;
    
    ext_mem_52619.references = NULL;
    
    struct memblock_device ext_mem_52620;
    
    ext_mem_52620.references = NULL;
    
    struct memblock_device ext_mem_52615;
    
    ext_mem_52615.references = NULL;
    
    struct memblock_device ext_mem_52616;
    
    ext_mem_52616.references = NULL;
    
    struct memblock_device ext_mem_52617;
    
    ext_mem_52617.references = NULL;
    
    struct memblock_device ext_mem_52612;
    
    ext_mem_52612.references = NULL;
    
    struct memblock_device ext_mem_52613;
    
    ext_mem_52613.references = NULL;
    
    struct memblock_device ext_mem_52614;
    
    ext_mem_52614.references = NULL;
    
    struct memblock_device ext_mem_52609;
    
    ext_mem_52609.references = NULL;
    
    struct memblock_device ext_mem_52610;
    
    ext_mem_52610.references = NULL;
    
    struct memblock_device ext_mem_52611;
    
    ext_mem_52611.references = NULL;
    
    struct memblock_device ext_mem_52606;
    
    ext_mem_52606.references = NULL;
    
    struct memblock_device ext_mem_52607;
    
    ext_mem_52607.references = NULL;
    
    struct memblock_device ext_mem_52608;
    
    ext_mem_52608.references = NULL;
    
    struct memblock_device ext_mem_52603;
    
    ext_mem_52603.references = NULL;
    
    struct memblock_device ext_mem_52604;
    
    ext_mem_52604.references = NULL;
    
    struct memblock_device ext_mem_52605;
    
    ext_mem_52605.references = NULL;
    
    struct memblock_device ext_mem_52600;
    
    ext_mem_52600.references = NULL;
    
    struct memblock_device ext_mem_52601;
    
    ext_mem_52601.references = NULL;
    
    struct memblock_device ext_mem_52602;
    
    ext_mem_52602.references = NULL;
    
    struct memblock_device ext_mem_52597;
    
    ext_mem_52597.references = NULL;
    
    struct memblock_device ext_mem_52598;
    
    ext_mem_52598.references = NULL;
    
    struct memblock_device ext_mem_52599;
    
    ext_mem_52599.references = NULL;
    
    struct memblock_device ext_mem_52594;
    
    ext_mem_52594.references = NULL;
    
    struct memblock_device ext_mem_52595;
    
    ext_mem_52595.references = NULL;
    
    struct memblock_device ext_mem_52596;
    
    ext_mem_52596.references = NULL;
    
    struct memblock_device ext_mem_52591;
    
    ext_mem_52591.references = NULL;
    
    struct memblock_device ext_mem_52592;
    
    ext_mem_52592.references = NULL;
    
    struct memblock_device ext_mem_52593;
    
    ext_mem_52593.references = NULL;
    
    struct memblock_device ext_mem_52588;
    
    ext_mem_52588.references = NULL;
    
    struct memblock_device ext_mem_52589;
    
    ext_mem_52589.references = NULL;
    
    struct memblock_device ext_mem_52590;
    
    ext_mem_52590.references = NULL;
    
    struct memblock_device ext_mem_52582;
    
    ext_mem_52582.references = NULL;
    
    struct memblock_device ext_mem_52583;
    
    ext_mem_52583.references = NULL;
    
    struct memblock_device ext_mem_52584;
    
    ext_mem_52584.references = NULL;
    
    struct memblock_device ext_mem_52585;
    
    ext_mem_52585.references = NULL;
    
    struct memblock_device ext_mem_52586;
    
    ext_mem_52586.references = NULL;
    
    struct memblock_device ext_mem_52587;
    
    ext_mem_52587.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t arg_46042 = sub64(dim_39383, (int64_t) 1);
    bool assert_cond_46043 = arg_46042 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385;
    bool assert_c_46044;
    
    if (!assert_cond_46043) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ft_libs/ftSkyline.fut:688:26-690:61\n   #1  ft_libs/ftSkyline.fut:681:17-690:108\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t mergeFilter_Skylines_5_res_46045;
    int64_t mergeFilter_Skylines_5_res_46046;
    
    if (self_filter_first_39392) {
        int64_t mergeFilter_Skylines_5_res_t_res_47798;
        
        if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52584, &ext_mem_52583, &ext_mem_52582, &mergeFilter_Skylines_5_res_t_res_47798, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, dz2082U_39386, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_set_device(ctx, &ext_mem_52587, &ext_mem_52584, "ext_mem_52584") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52586, &ext_mem_52583, "ext_mem_52583") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52585, &ext_mem_52582, "ext_mem_52582") != 0)
            return 1;
        mergeFilter_Skylines_5_res_46045 = mergeFilter_Skylines_5_res_t_res_47798;
        mergeFilter_Skylines_5_res_46046 = mergeFilter_Skylines_5_res_t_res_47798;
    } else {
        if (memblock_set_device(ctx, &ext_mem_52587, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52586, &xys_mem_52568, "xys_mem_52568") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52585, &xys_mem_52569, "xys_mem_52569") != 0)
            return 1;
        mergeFilter_Skylines_5_res_46045 = dz2082U_39386;
        mergeFilter_Skylines_5_res_46046 = dz2082U_39386;
    }
    
    int64_t mergeFilter_Skylines_5_res_46054;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52590, &ext_mem_52589, &ext_mem_52588, &mergeFilter_Skylines_5_res_46054, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, dz2082U_39388, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool dim_match_46058 = mergeFilter_Skylines_5_res_46045 == mergeFilter_Skylines_5_res_46046;
    bool empty_or_match_cert_46059;
    
    if (!dim_match_46058) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftSkyline.fut:498:29-34\n   #1  ft_libs/ftSkyline.fut:683:26-690:79\n   #2  ft_libs/ftSkyline.fut:681:17-690:108\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_46061;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52593, &ext_mem_52592, &ext_mem_52591, &defunc_0_f_res_46061, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52587, ext_mem_52586, ext_mem_52585, ext_mem_52590, ext_mem_52589, ext_mem_52588, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, mergeFilter_Skylines_5_res_46045, dz2081U_39387, mergeFilter_Skylines_5_res_46054, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_5_res_46065;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52596, &ext_mem_52595, &ext_mem_52594, &mergeFilter_Skylines_5_res_46065, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, dz2082U_39389, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_46069;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52599, &ext_mem_52598, &ext_mem_52597, &defunc_0_f_res_46069, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52587, ext_mem_52586, ext_mem_52585, ext_mem_52596, ext_mem_52595, ext_mem_52594, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, mergeFilter_Skylines_5_res_46045, dz2081U_39387, mergeFilter_Skylines_5_res_46065, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_5_res_46073;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52602, &ext_mem_52601, &ext_mem_52600, &mergeFilter_Skylines_5_res_46073, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52576, xys_mem_52577, xys_mem_52578, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, dz2082U_39390, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_46077;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52605, &ext_mem_52604, &ext_mem_52603, &defunc_0_f_res_46077, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52587, ext_mem_52586, ext_mem_52585, ext_mem_52602, ext_mem_52601, ext_mem_52600, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, mergeFilter_Skylines_5_res_46045, dz2081U_39387, mergeFilter_Skylines_5_res_46073, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
        return 1;
    
    int64_t mergeFilter_Skylines_5_res_46081;
    
    if (futrts_calc_global_Skyline_9665(ctx, &ext_mem_52608, &ext_mem_52607, &ext_mem_52606, &mergeFilter_Skylines_5_res_46081, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52579, xys_mem_52580, xys_mem_52581, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, dz2082U_39391, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_f_res_46085;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52611, &ext_mem_52610, &ext_mem_52609, &defunc_0_f_res_46085, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52587, ext_mem_52586, ext_mem_52585, ext_mem_52608, ext_mem_52607, ext_mem_52606, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, mergeFilter_Skylines_5_res_46045, dz2081U_39387, mergeFilter_Skylines_5_res_46081, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52606, "ext_mem_52606") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52607, "ext_mem_52607") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52608, "ext_mem_52608") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46089;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52614, &ext_mem_52613, &ext_mem_52612, &defunc_0_f_res_46089, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52593, ext_mem_52592, ext_mem_52591, ext_mem_52587, ext_mem_52586, ext_mem_52585, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46061, dz2081U_39387, mergeFilter_Skylines_5_res_46045, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46093;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52617, &ext_mem_52616, &ext_mem_52615, &defunc_0_f_res_46093, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52599, ext_mem_52598, ext_mem_52597, ext_mem_52614, ext_mem_52613, ext_mem_52612, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46069, dz2081U_39387, defunc_0_f_res_46089, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52612, "ext_mem_52612") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52613, "ext_mem_52613") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52614, "ext_mem_52614") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46097;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52620, &ext_mem_52619, &ext_mem_52618, &defunc_0_f_res_46097, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52605, ext_mem_52604, ext_mem_52603, ext_mem_52617, ext_mem_52616, ext_mem_52615, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46077, dz2081U_39387, defunc_0_f_res_46093, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52615, "ext_mem_52615") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52616, "ext_mem_52616") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52617, "ext_mem_52617") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46101;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52623, &ext_mem_52622, &ext_mem_52621, &defunc_0_f_res_46101, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52611, ext_mem_52610, ext_mem_52609, ext_mem_52620, ext_mem_52619, ext_mem_52618, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46085, dz2081U_39387, defunc_0_f_res_46097, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52618, "ext_mem_52618") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52619, "ext_mem_52619") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52620, "ext_mem_52620") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46105;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52626, &ext_mem_52625, &ext_mem_52624, &defunc_0_f_res_46105, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52599, ext_mem_52598, ext_mem_52597, ext_mem_52593, ext_mem_52592, ext_mem_52591, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46069, dz2081U_39387, defunc_0_f_res_46061, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46109;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52629, &ext_mem_52628, &ext_mem_52627, &defunc_0_f_res_46109, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52605, ext_mem_52604, ext_mem_52603, ext_mem_52626, ext_mem_52625, ext_mem_52624, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46077, dz2081U_39387, defunc_0_f_res_46105, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52624, "ext_mem_52624") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52625, "ext_mem_52625") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52626, "ext_mem_52626") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46113;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52632, &ext_mem_52631, &ext_mem_52630, &defunc_0_f_res_46113, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52611, ext_mem_52610, ext_mem_52609, ext_mem_52629, ext_mem_52628, ext_mem_52627, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46085, dz2081U_39387, defunc_0_f_res_46109, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52627, "ext_mem_52627") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52628, "ext_mem_52628") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52629, "ext_mem_52629") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46117;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52635, &ext_mem_52634, &ext_mem_52633, &defunc_0_f_res_46117, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52632, ext_mem_52631, ext_mem_52630, ext_mem_52599, ext_mem_52598, ext_mem_52597, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46113, dz2081U_39387, defunc_0_f_res_46069, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46121;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52638, &ext_mem_52637, &ext_mem_52636, &defunc_0_f_res_46121, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52605, ext_mem_52604, ext_mem_52603, ext_mem_52635, ext_mem_52634, ext_mem_52633, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46077, dz2081U_39387, defunc_0_f_res_46117, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52633, "ext_mem_52633") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52634, "ext_mem_52634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52635, "ext_mem_52635") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46125;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52641, &ext_mem_52640, &ext_mem_52639, &defunc_0_f_res_46125, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52611, ext_mem_52610, ext_mem_52609, ext_mem_52638, ext_mem_52637, ext_mem_52636, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46085, dz2081U_39387, defunc_0_f_res_46121, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52636, "ext_mem_52636") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52637, "ext_mem_52637") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52638, "ext_mem_52638") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46129;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52644, &ext_mem_52643, &ext_mem_52642, &defunc_0_f_res_46129, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52632, ext_mem_52631, ext_mem_52630, ext_mem_52605, ext_mem_52604, ext_mem_52603, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46113, dz2081U_39387, defunc_0_f_res_46077, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46133;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52647, &ext_mem_52646, &ext_mem_52645, &defunc_0_f_res_46133, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52641, ext_mem_52640, ext_mem_52639, ext_mem_52644, ext_mem_52643, ext_mem_52642, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46125, dz2081U_39387, defunc_0_f_res_46129, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52642, "ext_mem_52642") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52643, "ext_mem_52643") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52644, "ext_mem_52644") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46137;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52650, &ext_mem_52649, &ext_mem_52648, &defunc_0_f_res_46137, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52611, ext_mem_52610, ext_mem_52609, ext_mem_52647, ext_mem_52646, ext_mem_52645, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46085, dz2081U_39387, defunc_0_f_res_46133, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52645, "ext_mem_52645") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52646, "ext_mem_52646") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52647, "ext_mem_52647") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46141;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52653, &ext_mem_52652, &ext_mem_52651, &defunc_0_f_res_46141, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52632, ext_mem_52631, ext_mem_52630, ext_mem_52611, ext_mem_52610, ext_mem_52609, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46113, dz2081U_39387, defunc_0_f_res_46085, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52609, "ext_mem_52609") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52610, "ext_mem_52610") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52611, "ext_mem_52611") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46145;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52656, &ext_mem_52655, &ext_mem_52654, &defunc_0_f_res_46145, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52641, ext_mem_52640, ext_mem_52639, ext_mem_52653, ext_mem_52652, ext_mem_52651, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46125, dz2081U_39387, defunc_0_f_res_46141, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52651, "ext_mem_52651") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52652, "ext_mem_52652") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52653, "ext_mem_52653") != 0)
        return 1;
    
    int64_t defunc_0_f_res_46149;
    
    if (futrts_filter_against_9751(ctx, &ext_mem_52659, &ext_mem_52658, &ext_mem_52657, &defunc_0_f_res_46149, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, ext_mem_52650, ext_mem_52649, ext_mem_52648, ext_mem_52656, ext_mem_52655, ext_mem_52654, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2081U_39387, defunc_0_f_res_46137, dz2081U_39387, defunc_0_f_res_46145, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref_device(ctx, &ext_mem_52654, "ext_mem_52654") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52655, "ext_mem_52655") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52656, "ext_mem_52656") != 0)
        return 1;
    
    int64_t conc_tmp_46153 = defunc_0_f_res_46101 + defunc_0_f_res_46113;
    int64_t conc_tmp_46154 = defunc_0_f_res_46125 + conc_tmp_46153;
    int64_t conc_tmp_46155 = defunc_0_f_res_46137 + conc_tmp_46154;
    int64_t conc_tmp_46156 = defunc_0_f_res_46149 + conc_tmp_46155;
    int64_t binop_x_52660 = (int64_t) 4 * conc_tmp_46156;
    int64_t bytes_52661 = dim_39383 * binop_x_52660;
    int64_t bytes_52663 = (int64_t) 8 * conc_tmp_46156;
    
    if (memblock_alloc_device(ctx, &mem_52662, bytes_52661, "mem_52662")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52662.mem, dim_39383 * tmp_offs_53221, (int64_t []) {dim_39383, (int64_t) 1}, ext_mem_52622.mem, (int64_t) 0, (int64_t []) {dim_39383, (int64_t) 1}, (int64_t []) {defunc_0_f_res_46101, dim_39383})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_46101;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52662.mem, dim_39383 * tmp_offs_53221, (int64_t []) {dim_39383, (int64_t) 1}, ext_mem_52631.mem, (int64_t) 0, (int64_t []) {dim_39383, (int64_t) 1}, (int64_t []) {defunc_0_f_res_46113, dim_39383})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_46113;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52662.mem, dim_39383 * tmp_offs_53221, (int64_t []) {dim_39383, (int64_t) 1}, ext_mem_52640.mem, (int64_t) 0, (int64_t []) {dim_39383, (int64_t) 1}, (int64_t []) {defunc_0_f_res_46125, dim_39383})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_46125;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52662.mem, dim_39383 * tmp_offs_53221, (int64_t []) {dim_39383, (int64_t) 1}, ext_mem_52649.mem, (int64_t) 0, (int64_t []) {dim_39383, (int64_t) 1}, (int64_t []) {defunc_0_f_res_46137, dim_39383})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_46137;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52662.mem, dim_39383 * tmp_offs_53221, (int64_t []) {dim_39383, (int64_t) 1}, ext_mem_52658.mem, (int64_t) 0, (int64_t []) {dim_39383, (int64_t) 1}, (int64_t []) {defunc_0_f_res_46149, dim_39383})) != 0)
        goto cleanup;
    tmp_offs_53221 += defunc_0_f_res_46149;
    if (memblock_unref_device(ctx, &ext_mem_52622, "ext_mem_52622") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52631, "ext_mem_52631") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52640, "ext_mem_52640") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52649, "ext_mem_52649") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52658, "ext_mem_52658") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52664, bytes_52663, "mem_52664")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52664.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52621.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_46101})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_46101;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52664.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52630.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_46113})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_46113;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52664.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52639.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_46125})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_46125;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52664.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52648.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_46137})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_46137;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52664.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, ext_mem_52657.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_0_f_res_46149})) != 0)
        goto cleanup;
    tmp_offs_53222 += defunc_0_f_res_46149;
    if (memblock_unref_device(ctx, &ext_mem_52621, "ext_mem_52621") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52630, "ext_mem_52630") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52639, "ext_mem_52639") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52648, "ext_mem_52648") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52657, "ext_mem_52657") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_49577;
    
    segmap_tblock_sizze_49577 = *ctx->tuning_params.skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562;
    
    int64_t segmap_usable_groups_49578 = sdiv_up64(dz2081U_39387, segmap_tblock_sizze_49577);
    
    if (memblock_alloc_device(ctx, &mem_52666, dz2081U_39387, "mem_52666")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_39387, segmap_tblock_sizze_49577));
    
    {
        err = gpu_kernel_skyline_mergeFilter_5_floatzisegmap_49581(ctx, segmap_usable_groups_49578, 1, 1, *ctx->tuning_params.skyline_mergeFilter_5_floatzisegmap_tblock_sizze_49562, 1, 1, (int64_t) 0, dz2081U_39387, ext_mem_52623.mem, ext_mem_52632.mem, ext_mem_52641.mem, ext_mem_52650.mem, ext_mem_52659.mem, mem_52666.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &ext_mem_52623, "ext_mem_52623") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52632, "ext_mem_52632") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52641, "ext_mem_52641") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52650, "ext_mem_52650") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52659, "ext_mem_52659") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52666, "mem_52666") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52662, "mem_52662") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52664, "mem_52664") != 0)
        return 1;
    prim_out_53220 = conc_tmp_46156;
    if (memblock_set_device(ctx, &*mem_out_p_54080, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54081, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54082, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54083 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52666, "mem_52666") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52664, "mem_52664") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52662, "mem_52662") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52657, "ext_mem_52657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52658, "ext_mem_52658") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52659, "ext_mem_52659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52654, "ext_mem_52654") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52655, "ext_mem_52655") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52656, "ext_mem_52656") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52651, "ext_mem_52651") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52652, "ext_mem_52652") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52653, "ext_mem_52653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52648, "ext_mem_52648") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52649, "ext_mem_52649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52650, "ext_mem_52650") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52645, "ext_mem_52645") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52646, "ext_mem_52646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52647, "ext_mem_52647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52642, "ext_mem_52642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52643, "ext_mem_52643") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52644, "ext_mem_52644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52639, "ext_mem_52639") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52640, "ext_mem_52640") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52641, "ext_mem_52641") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52636, "ext_mem_52636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52637, "ext_mem_52637") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52638, "ext_mem_52638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52633, "ext_mem_52633") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52634, "ext_mem_52634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52635, "ext_mem_52635") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52630, "ext_mem_52630") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52631, "ext_mem_52631") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52632, "ext_mem_52632") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52627, "ext_mem_52627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52628, "ext_mem_52628") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52629, "ext_mem_52629") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52624, "ext_mem_52624") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52625, "ext_mem_52625") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52626, "ext_mem_52626") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52621, "ext_mem_52621") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52622, "ext_mem_52622") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52623, "ext_mem_52623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52618, "ext_mem_52618") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52619, "ext_mem_52619") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52620, "ext_mem_52620") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52615, "ext_mem_52615") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52616, "ext_mem_52616") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52617, "ext_mem_52617") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52612, "ext_mem_52612") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52613, "ext_mem_52613") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52614, "ext_mem_52614") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52609, "ext_mem_52609") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52610, "ext_mem_52610") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52611, "ext_mem_52611") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52606, "ext_mem_52606") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52607, "ext_mem_52607") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52608, "ext_mem_52608") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52603, "ext_mem_52603") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52604, "ext_mem_52604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52605, "ext_mem_52605") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52600, "ext_mem_52600") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52601, "ext_mem_52601") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52602, "ext_mem_52602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52597, "ext_mem_52597") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52598, "ext_mem_52598") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52599, "ext_mem_52599") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52594, "ext_mem_52594") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52595, "ext_mem_52595") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52596, "ext_mem_52596") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52591, "ext_mem_52591") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52592, "ext_mem_52592") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52593, "ext_mem_52593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52588, "ext_mem_52588") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52589, "ext_mem_52589") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52590, "ext_mem_52590") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52582, "ext_mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52583, "ext_mem_52583") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52584, "ext_mem_52584") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52585, "ext_mem_52585") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52586, "ext_mem_52586") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52587, "ext_mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_2_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54084, struct memblock_device *mem_out_p_54085, struct memblock_device *mem_out_p_54086, int64_t *out_prim_out_54087, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, int64_t dim_34825, int64_t dz2082U_34826, int64_t dz2081U_34827, int64_t dz2082U_34828)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52573;
    
    mem_52573.references = NULL;
    
    struct memblock_device mem_52571;
    
    mem_52571.references = NULL;
    
    struct memblock_device mem_52569;
    
    mem_52569.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t conc_tmp_45243 = dz2082U_34826 + dz2082U_34828;
    int64_t binop_x_52567 = (int64_t) 4 * conc_tmp_45243;
    int64_t bytes_52568 = dim_34825 * binop_x_52567;
    int64_t bytes_52570 = (int64_t) 8 * conc_tmp_45243;
    
    if (memblock_alloc_device(ctx, &mem_52569, bytes_52568, "mem_52569")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52569.mem, dim_34825 * tmp_offs_53221, (int64_t []) {dim_34825, (int64_t) 1}, xys_mem_52562.mem, (int64_t) 0, (int64_t []) {dim_34825, (int64_t) 1}, (int64_t []) {dz2082U_34826, dim_34825})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34826;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52569.mem, dim_34825 * tmp_offs_53221, (int64_t []) {dim_34825, (int64_t) 1}, xys_mem_52565.mem, (int64_t) 0, (int64_t []) {dim_34825, (int64_t) 1}, (int64_t []) {dz2082U_34828, dim_34825})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34828;
    if (memblock_alloc_device(ctx, &mem_52571, bytes_52570, "mem_52571")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52571.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52563.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34826})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34826;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52571.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52566.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34828})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34828;
    
    int64_t segmap_tblock_sizze_49419;
    
    segmap_tblock_sizze_49419 = *ctx->tuning_params.skyline_merge_2_floatzisegmap_tblock_sizze_49410;
    
    int64_t segmap_usable_groups_49420 = sdiv_up64(dz2081U_34827, segmap_tblock_sizze_49419);
    
    if (memblock_alloc_device(ctx, &mem_52573, dz2081U_34827, "mem_52573")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_34827, segmap_tblock_sizze_49419));
    
    {
        err = gpu_kernel_skyline_merge_2_floatzisegmap_49423(ctx, segmap_usable_groups_49420, 1, 1, *ctx->tuning_params.skyline_merge_2_floatzisegmap_tblock_sizze_49410, 1, 1, (int64_t) 0, dz2081U_34827, isPartitionDominated_mem_52561.mem, isPartitionDominated_mem_52564.mem, mem_52573.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52573, "mem_52573") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52569, "mem_52569") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52571, "mem_52571") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45243;
    if (memblock_set_device(ctx, &*mem_out_p_54084, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54085, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54086, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54087 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52573, "mem_52573") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52571, "mem_52571") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52569, "mem_52569") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_3_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54088, struct memblock_device *mem_out_p_54089, struct memblock_device *mem_out_p_54090, int64_t *out_prim_out_54091, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_34724, int64_t dz2082U_34725, int64_t dz2081U_34726, int64_t dz2082U_34727, int64_t dz2082U_34728)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52576;
    
    mem_52576.references = NULL;
    
    struct memblock_device mem_52574;
    
    mem_52574.references = NULL;
    
    struct memblock_device mem_52572;
    
    mem_52572.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t conc_tmp_45247 = dz2082U_34725 + dz2082U_34727;
    int64_t conc_tmp_45250 = dz2082U_34728 + conc_tmp_45247;
    int64_t binop_x_52570 = (int64_t) 4 * conc_tmp_45250;
    int64_t bytes_52571 = dim_34724 * binop_x_52570;
    int64_t bytes_52573 = (int64_t) 8 * conc_tmp_45250;
    
    if (memblock_alloc_device(ctx, &mem_52572, bytes_52571, "mem_52572")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52572.mem, dim_34724 * tmp_offs_53221, (int64_t []) {dim_34724, (int64_t) 1}, xys_mem_52562.mem, (int64_t) 0, (int64_t []) {dim_34724, (int64_t) 1}, (int64_t []) {dz2082U_34725, dim_34724})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34725;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52572.mem, dim_34724 * tmp_offs_53221, (int64_t []) {dim_34724, (int64_t) 1}, xys_mem_52565.mem, (int64_t) 0, (int64_t []) {dim_34724, (int64_t) 1}, (int64_t []) {dz2082U_34727, dim_34724})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34727;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52572.mem, dim_34724 * tmp_offs_53221, (int64_t []) {dim_34724, (int64_t) 1}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_34724, (int64_t) 1}, (int64_t []) {dz2082U_34728, dim_34724})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34728;
    if (memblock_alloc_device(ctx, &mem_52574, bytes_52573, "mem_52574")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52574.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52563.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34725})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34725;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52574.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52566.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34727})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34727;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52574.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52569.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34728})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34728;
    
    int64_t segmap_tblock_sizze_49397;
    
    segmap_tblock_sizze_49397 = *ctx->tuning_params.skyline_merge_3_floatzisegmap_tblock_sizze_49386;
    
    int64_t segmap_usable_groups_49398 = sdiv_up64(dz2081U_34726, segmap_tblock_sizze_49397);
    
    if (memblock_alloc_device(ctx, &mem_52576, dz2081U_34726, "mem_52576")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_34726, segmap_tblock_sizze_49397));
    
    {
        err = gpu_kernel_skyline_merge_3_floatzisegmap_49401(ctx, segmap_usable_groups_49398, 1, 1, *ctx->tuning_params.skyline_merge_3_floatzisegmap_tblock_sizze_49386, 1, 1, (int64_t) 0, dz2081U_34726, isPartitionDominated_mem_52561.mem, isPartitionDominated_mem_52564.mem, isPartitionDominated_mem_52567.mem, mem_52576.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52576, "mem_52576") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52572, "mem_52572") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52574, "mem_52574") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45250;
    if (memblock_set_device(ctx, &*mem_out_p_54088, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54089, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54090, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54091 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52576, "mem_52576") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52574, "mem_52574") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52572, "mem_52572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_4_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54092, struct memblock_device *mem_out_p_54093, struct memblock_device *mem_out_p_54094, int64_t *out_prim_out_54095, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_34582, int64_t dz2082U_34583, int64_t dz2081U_34584, int64_t dz2082U_34585, int64_t dz2082U_34586, int64_t dz2082U_34587)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52579;
    
    mem_52579.references = NULL;
    
    struct memblock_device mem_52577;
    
    mem_52577.references = NULL;
    
    struct memblock_device mem_52575;
    
    mem_52575.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t conc_tmp_45463 = dz2082U_34583 + dz2082U_34585;
    int64_t conc_tmp_45466 = dz2082U_34586 + conc_tmp_45463;
    int64_t conc_tmp_45469 = dz2082U_34587 + conc_tmp_45466;
    int64_t binop_x_52573 = (int64_t) 4 * conc_tmp_45469;
    int64_t bytes_52574 = dim_34582 * binop_x_52573;
    int64_t bytes_52576 = (int64_t) 8 * conc_tmp_45469;
    
    if (memblock_alloc_device(ctx, &mem_52575, bytes_52574, "mem_52575")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52575.mem, dim_34582 * tmp_offs_53221, (int64_t []) {dim_34582, (int64_t) 1}, xys_mem_52562.mem, (int64_t) 0, (int64_t []) {dim_34582, (int64_t) 1}, (int64_t []) {dz2082U_34583, dim_34582})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34583;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52575.mem, dim_34582 * tmp_offs_53221, (int64_t []) {dim_34582, (int64_t) 1}, xys_mem_52565.mem, (int64_t) 0, (int64_t []) {dim_34582, (int64_t) 1}, (int64_t []) {dz2082U_34585, dim_34582})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34585;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52575.mem, dim_34582 * tmp_offs_53221, (int64_t []) {dim_34582, (int64_t) 1}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_34582, (int64_t) 1}, (int64_t []) {dz2082U_34586, dim_34582})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34586;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52575.mem, dim_34582 * tmp_offs_53221, (int64_t []) {dim_34582, (int64_t) 1}, xys_mem_52571.mem, (int64_t) 0, (int64_t []) {dim_34582, (int64_t) 1}, (int64_t []) {dz2082U_34587, dim_34582})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34587;
    if (memblock_alloc_device(ctx, &mem_52577, bytes_52576, "mem_52577")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52577.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52563.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34583})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34583;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52577.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52566.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34585})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34585;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52577.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52569.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34586})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34586;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52577.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52572.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34587})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34587;
    
    int64_t segmap_tblock_sizze_49443;
    
    segmap_tblock_sizze_49443 = *ctx->tuning_params.skyline_merge_4_floatzisegmap_tblock_sizze_49430;
    
    int64_t segmap_usable_groups_49444 = sdiv_up64(dz2081U_34584, segmap_tblock_sizze_49443);
    
    if (memblock_alloc_device(ctx, &mem_52579, dz2081U_34584, "mem_52579")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_34584, segmap_tblock_sizze_49443));
    
    {
        err = gpu_kernel_skyline_merge_4_floatzisegmap_49447(ctx, segmap_usable_groups_49444, 1, 1, *ctx->tuning_params.skyline_merge_4_floatzisegmap_tblock_sizze_49430, 1, 1, (int64_t) 0, dz2081U_34584, isPartitionDominated_mem_52561.mem, isPartitionDominated_mem_52564.mem, isPartitionDominated_mem_52567.mem, isPartitionDominated_mem_52570.mem, mem_52579.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52579, "mem_52579") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52575, "mem_52575") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52577, "mem_52577") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45469;
    if (memblock_set_device(ctx, &*mem_out_p_54092, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54093, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54094, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54095 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52579, "mem_52579") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52577, "mem_52577") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52575, "mem_52575") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_merge_5_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54096, struct memblock_device *mem_out_p_54097, struct memblock_device *mem_out_p_54098, int64_t *out_prim_out_54099, struct memblock_device isPartitionDominated_mem_52561, struct memblock_device xys_mem_52562, struct memblock_device xys_mem_52563, struct memblock_device isPartitionDominated_mem_52564, struct memblock_device xys_mem_52565, struct memblock_device xys_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, struct memblock_device isPartitionDominated_mem_52573, struct memblock_device xys_mem_52574, struct memblock_device xys_mem_52575, int64_t dim_34395, int64_t dz2082U_34396, int64_t dz2081U_34397, int64_t dz2082U_34398, int64_t dz2082U_34399, int64_t dz2082U_34400, int64_t dz2082U_34401)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52582;
    
    mem_52582.references = NULL;
    
    struct memblock_device mem_52580;
    
    mem_52580.references = NULL;
    
    struct memblock_device mem_52578;
    
    mem_52578.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t conc_tmp_45870 = dz2082U_34396 + dz2082U_34398;
    int64_t conc_tmp_45871 = dz2082U_34399 + conc_tmp_45870;
    int64_t conc_tmp_45872 = dz2082U_34400 + conc_tmp_45871;
    int64_t conc_tmp_45873 = dz2082U_34401 + conc_tmp_45872;
    int64_t binop_x_52576 = (int64_t) 4 * conc_tmp_45873;
    int64_t bytes_52577 = dim_34395 * binop_x_52576;
    int64_t bytes_52579 = (int64_t) 8 * conc_tmp_45873;
    
    if (memblock_alloc_device(ctx, &mem_52578, bytes_52577, "mem_52578")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53221 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52578.mem, dim_34395 * tmp_offs_53221, (int64_t []) {dim_34395, (int64_t) 1}, xys_mem_52562.mem, (int64_t) 0, (int64_t []) {dim_34395, (int64_t) 1}, (int64_t []) {dz2082U_34396, dim_34395})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34396;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52578.mem, dim_34395 * tmp_offs_53221, (int64_t []) {dim_34395, (int64_t) 1}, xys_mem_52565.mem, (int64_t) 0, (int64_t []) {dim_34395, (int64_t) 1}, (int64_t []) {dz2082U_34398, dim_34395})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34398;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52578.mem, dim_34395 * tmp_offs_53221, (int64_t []) {dim_34395, (int64_t) 1}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_34395, (int64_t) 1}, (int64_t []) {dz2082U_34399, dim_34395})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34399;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52578.mem, dim_34395 * tmp_offs_53221, (int64_t []) {dim_34395, (int64_t) 1}, xys_mem_52571.mem, (int64_t) 0, (int64_t []) {dim_34395, (int64_t) 1}, (int64_t []) {dz2082U_34400, dim_34395})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34400;
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52578.mem, dim_34395 * tmp_offs_53221, (int64_t []) {dim_34395, (int64_t) 1}, xys_mem_52574.mem, (int64_t) 0, (int64_t []) {dim_34395, (int64_t) 1}, (int64_t []) {dz2082U_34401, dim_34395})) != 0)
        goto cleanup;
    tmp_offs_53221 += dz2082U_34401;
    if (memblock_alloc_device(ctx, &mem_52580, bytes_52579, "mem_52580")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t tmp_offs_53222 = (int64_t) 0;
    
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52580.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52563.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34396})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34396;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52580.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52566.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34398})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34398;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52580.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52569.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34399})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34399;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52580.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52572.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34400})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34400;
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52580.mem, tmp_offs_53222, (int64_t []) {(int64_t) 1}, xys_mem_52575.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2082U_34401})) != 0)
        goto cleanup;
    tmp_offs_53222 += dz2082U_34401;
    
    int64_t segmap_tblock_sizze_49517;
    
    segmap_tblock_sizze_49517 = *ctx->tuning_params.skyline_merge_5_floatzisegmap_tblock_sizze_49502;
    
    int64_t segmap_usable_groups_49518 = sdiv_up64(dz2081U_34397, segmap_tblock_sizze_49517);
    
    if (memblock_alloc_device(ctx, &mem_52582, dz2081U_34397, "mem_52582")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53223 = sext_i64_i32(sdiv_up64(dz2081U_34397, segmap_tblock_sizze_49517));
    
    {
        err = gpu_kernel_skyline_merge_5_floatzisegmap_49521(ctx, segmap_usable_groups_49518, 1, 1, *ctx->tuning_params.skyline_merge_5_floatzisegmap_tblock_sizze_49502, 1, 1, (int64_t) 0, dz2081U_34397, isPartitionDominated_mem_52561.mem, isPartitionDominated_mem_52564.mem, isPartitionDominated_mem_52567.mem, isPartitionDominated_mem_52570.mem, isPartitionDominated_mem_52573.mem, mem_52582.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_53217, &mem_52582, "mem_52582") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52578, "mem_52578") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52580, "mem_52580") != 0)
        return 1;
    prim_out_53220 = conc_tmp_45873;
    if (memblock_set_device(ctx, &*mem_out_p_54096, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54097, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54098, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54099 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52582, "mem_52582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52580, "mem_52580") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52578, "mem_52578") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_skyline_slice_and_dice_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_54100, struct memblock_device *mem_out_p_54101, struct memblock_device *mem_out_p_54102, int64_t *out_prim_out_54103, int64_t *out_prim_out_54104, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device xs_mem_52567, int64_t dim_29479, int64_t dz2080U_29480, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481, int64_t n_29482, int64_t m_sizze_29488, int64_t total_angle_no_29490, int64_t total_grid_no_29491, int64_t total_part_no_29492, int64_t offs_29494, bool use_many_pts_29495)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52781;
    
    mem_52781.references = NULL;
    
    struct memblock_device mem_52779;
    
    mem_52779.references = NULL;
    
    struct memblock_device mem_52776;
    
    mem_52776.references = NULL;
    
    struct memblock_device mem_52774;
    
    mem_52774.references = NULL;
    
    struct memblock_device mem_52766;
    
    mem_52766.references = NULL;
    
    struct memblock_device mem_52763;
    
    mem_52763.references = NULL;
    
    struct memblock_device incprefixes_mem_53901;
    
    incprefixes_mem_53901.references = NULL;
    
    struct memblock_device aggregates_mem_53899;
    
    aggregates_mem_53899.references = NULL;
    
    struct memblock_device status_flags_mem_53897;
    
    status_flags_mem_53897.references = NULL;
    
    struct memblock_device mem_52771;
    
    mem_52771.references = NULL;
    
    struct memblock_device mem_52769;
    
    mem_52769.references = NULL;
    
    struct memblock_device segred_tmp_mem_53846;
    
    segred_tmp_mem_53846.references = NULL;
    
    struct memblock_device color_52943;
    
    color_52943.references = NULL;
    
    struct memblock_device mem_52717;
    
    mem_52717.references = NULL;
    
    struct memblock_device mem_52708;
    
    mem_52708.references = NULL;
    
    struct memblock_device mem_52697;
    
    mem_52697.references = NULL;
    
    struct memblock_device mem_52686;
    
    mem_52686.references = NULL;
    
    struct memblock_device mem_52682;
    
    mem_52682.references = NULL;
    
    struct memblock_device color_52942;
    
    color_52942.references = NULL;
    
    struct memblock_device mem_52726;
    
    mem_52726.references = NULL;
    
    struct memblock_device ext_mem_52727;
    
    ext_mem_52727.references = NULL;
    
    struct memblock_device color_52940;
    
    color_52940.references = NULL;
    
    struct memblock_device color_52939;
    
    color_52939.references = NULL;
    
    struct memblock_device mem_52760;
    
    mem_52760.references = NULL;
    
    struct memblock_device ext_mem_52761;
    
    ext_mem_52761.references = NULL;
    
    struct memblock_device segred_tmp_mem_53709;
    
    segred_tmp_mem_53709.references = NULL;
    
    struct memblock_device defunc_0_map_res_subhistos_mem_53589;
    
    defunc_0_map_res_subhistos_mem_53589.references = NULL;
    
    struct memblock_device mem_52679;
    
    mem_52679.references = NULL;
    
    struct memblock_device mem_52677;
    
    mem_52677.references = NULL;
    
    struct memblock_device mem_52674;
    
    mem_52674.references = NULL;
    
    struct memblock_device mem_52663;
    
    mem_52663.references = NULL;
    
    struct memblock_device ext_mem_52784;
    
    ext_mem_52784.references = NULL;
    
    struct memblock_device ext_mem_52785;
    
    ext_mem_52785.references = NULL;
    
    struct memblock_device ext_mem_52786;
    
    ext_mem_52786.references = NULL;
    
    struct memblock_device segred_tmp_mem_53533;
    
    segred_tmp_mem_53533.references = NULL;
    
    struct memblock_device mem_52659;
    
    mem_52659.references = NULL;
    
    struct memblock_device mem_52657;
    
    mem_52657.references = NULL;
    
    struct memblock_device mem_52656;
    
    mem_52656.references = NULL;
    
    struct memblock_device mem_52653;
    
    mem_52653.references = NULL;
    
    struct memblock_device mem_52649;
    
    mem_52649.references = NULL;
    
    struct memblock_device mem_52646;
    
    mem_52646.references = NULL;
    
    struct memblock_device incprefixes_mem_53343;
    
    incprefixes_mem_53343.references = NULL;
    
    struct memblock_device aggregates_mem_53341;
    
    aggregates_mem_53341.references = NULL;
    
    struct memblock_device status_flags_mem_53319;
    
    status_flags_mem_53319.references = NULL;
    
    struct memblock_device color_52938;
    
    color_52938.references = NULL;
    
    struct memblock_device color_52937;
    
    color_52937.references = NULL;
    
    struct memblock_device mem_52644;
    
    mem_52644.references = NULL;
    
    struct memblock_device mem_52642;
    
    mem_52642.references = NULL;
    
    struct memblock_device mem_52604;
    
    mem_52604.references = NULL;
    
    struct memblock_device mem_52593;
    
    mem_52593.references = NULL;
    
    struct memblock_device segred_tmp_mem_53248;
    
    segred_tmp_mem_53248.references = NULL;
    
    struct memblock_device segred_tmp_mem_53246;
    
    segred_tmp_mem_53246.references = NULL;
    
    struct memblock_device color_52936;
    
    color_52936.references = NULL;
    
    struct memblock_device mem_52578;
    
    mem_52578.references = NULL;
    
    struct memblock_device mem_52577;
    
    mem_52577.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t prim_out_53221;
    int64_t arg_47420 = sub64(dim_29479, (int64_t) 1);
    bool assert_cond_47421 = arg_47420 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481;
    bool assert_c_47422;
    
    if (!assert_cond_47421) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_47423 = slt64((int64_t) 0, dz2080U_29480);
    bool index_certs_47424;
    
    if (!y_47423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_29480, "].", "-> #0  ft_libs/ftSkyline.fut:195:70-100\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_47437 = slt64(dim_29479, (int64_t) 6);
    int64_t segred_tblock_sizze_51475;
    
    segred_tblock_sizze_51475 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51474;
    
    int64_t num_tblocks_51477;
    int64_t max_num_tblocks_53222;
    
    max_num_tblocks_53222 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51476;
    num_tblocks_51477 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_29482, segred_tblock_sizze_51475), max_num_tblocks_53222)));
    
    bool x_52551 = !cond_47437;
    int64_t bytes_52569 = (int64_t) 4 * dim_29479;
    
    if (memblock_alloc_device(ctx, &mem_52577, (int64_t) 8, "mem_52577")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52578, (int64_t) 4, "mem_52578")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53122 = segred_tblock_sizze_51475 * num_tblocks_51477;
    int64_t total_sizze_53123 = bytes_52569 * num_threads_53122;
    
    if (memblock_alloc_device(ctx, &color_52936, total_sizze_53123, "color_52936")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_53223 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_53246, (int64_t) 8 * num_tblocks_51477, "segred_tmp_mem_53246")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_53248, (int64_t) 4 * num_tblocks_51477, "segred_tmp_mem_53248")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53250 = num_tblocks_51477 * segred_tblock_sizze_51475;
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_nonseg_51483(ctx, num_tblocks_51477, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51474, 1, 1, 8 + ((int64_t) 4 * segred_tblock_sizze_51475 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_51475, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_51475 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_51475, (int64_t) 8), (int64_t) 8)), dim_29479, n_29482, cond_47437, num_tblocks_51477, x_52551, num_threads_53122, num_threads_53250, start_of_grid_partition_mem_52566.mem, xs_mem_52567.mem, mem_52577.mem, mem_52578.mem, color_52936.mem, counters_mem_53224.mem, segred_tmp_mem_53246.mem, segred_tmp_mem_53248.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52578, "mem_52578") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
        return 1;
    
    int64_t read_res_54105;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_54105, mem_52577.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_49374 = read_res_54105;
    
    if (memblock_unref_device(ctx, &mem_52577, "mem_52577") != 0)
        return 1;
    
    bool x_47469 = sle64((int64_t) 0, defunc_0_reduce_comm_res_49374);
    bool y_47470 = slt64(defunc_0_reduce_comm_res_49374, n_29482);
    bool bounds_check_47471 = x_47469 && y_47470;
    bool index_certs_47472;
    
    if (!bounds_check_47471) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_reduce_comm_res_49374, "] out of bounds for array of shape [", (long long) n_29482, "].", "-> #0  ft_libs/ftSkyline.fut:199:36-50\n   #1  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_fpts_t_res_47474 = add64((int64_t) 1, dim_29479);
    int64_t num_fpts_47475;
    
    if (use_many_pts_29495) {
        num_fpts_47475 = num_fpts_t_res_47474;
    } else {
        num_fpts_47475 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_47476 = slt64(num_fpts_47475, (int64_t) 0);
    bool valid_47477 = !bounds_invalid_upwards_47476;
    bool range_valid_c_47478;
    
    if (!valid_47477) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_fpts_47475, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftSkyline.fut:202:49-62\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_51528;
    
    segmap_tblock_sizze_51528 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488;
    
    int64_t num_tblocks_51529;
    int64_t max_num_tblocks_53295;
    
    max_num_tblocks_53295 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_51490;
    num_tblocks_51529 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(num_fpts_47475, segmap_tblock_sizze_51528), max_num_tblocks_53295)));
    
    int64_t binop_y_52583 = num_fpts_47475 - (int64_t) 1;
    int64_t binop_x_52585 = smax64((int64_t) 0, binop_y_52583);
    int64_t binop_x_52587 = smax64((int64_t) 0, arg_47420);
    int64_t binop_y_52588 = num_fpts_47475 * binop_x_52587;
    int64_t binop_y_52589 = smax64((int64_t) 0, binop_y_52588);
    int64_t binop_y_52590 = binop_x_52585 + binop_y_52589;
    int64_t binop_y_52591 = (int64_t) 1 + binop_y_52590;
    int64_t bytes_52592 = (int64_t) 4 * binop_y_52591;
    int64_t lmad_ext_52581 = dim_29479 * defunc_0_reduce_comm_res_49374;
    
    if (memblock_alloc_device(ctx, &mem_52593, bytes_52592, "mem_52593")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53296 = sext_i64_i32(sdiv_up64(num_fpts_47475, segmap_tblock_sizze_51528));
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51533(ctx, num_tblocks_51529, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51488, 1, 1, (int64_t) 0, dim_29479, n_29482, num_fpts_47475, num_tblocks_51529, lmad_ext_52581, virt_num_tblocks_53296, xs_mem_52567.mem, mem_52593.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    bool cond_47513 = slt64(num_fpts_47475, (int64_t) 6);
    int64_t segscan_tblock_sizze_51568;
    
    segscan_tblock_sizze_51568 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567;
    
    int64_t num_tblocks_51570;
    int64_t max_num_tblocks_53311;
    
    max_num_tblocks_53311 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_num_tblocks_51569;
    num_tblocks_51570 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_29482, segscan_tblock_sizze_51568), max_num_tblocks_53311)));
    
    bool x_52545 = !cond_47513;
    int64_t binop_y_52594 = n_29482 - (int64_t) 1;
    int64_t binop_x_52596 = smax64((int64_t) 0, binop_y_52594);
    int64_t binop_y_52599 = n_29482 * binop_x_52587;
    int64_t binop_y_52600 = smax64((int64_t) 0, binop_y_52599);
    int64_t binop_y_52601 = binop_x_52596 + binop_y_52600;
    int64_t binop_y_52602 = (int64_t) 1 + binop_y_52601;
    int64_t bytes_52603 = (int64_t) 4 * binop_y_52602;
    
    if (memblock_alloc_device(ctx, &mem_52604, bytes_52603, "mem_52604")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52604.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, n_29482}, xs_mem_52567.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {n_29482, dim_29479})) != 0)
        goto cleanup;
    
    int64_t bytes_52641 = (int64_t) 8 * n_29482;
    
    if (memblock_alloc_device(ctx, &mem_52642, bytes_52641, "mem_52642")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52644, bytes_52641, "mem_52644")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53130 = segscan_tblock_sizze_51568 * num_tblocks_51570;
    int64_t total_sizze_53131 = dim_29479 * num_threads_53130;
    
    if (memblock_alloc_device(ctx, &color_52937, total_sizze_53131, "color_52937")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t total_sizze_53132 = num_fpts_47475 * num_threads_53130;
    
    if (memblock_alloc_device(ctx, &color_52938, total_sizze_53132, "color_52938")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, n_29482)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53312;
        
        shared_memory_53312 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53313;
        
        thread_block_sizze_53313 = ctx->max_thread_block_size;
        
        int64_t registers_53314;
        
        registers_53314 = ctx->max_registers;
        
        int64_t thread_block_sizze_53315;
        
        thread_block_sizze_53315 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53316 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53312, thread_block_sizze_53313), (int64_t) 8), squot64(squot64(registers_53314, thread_block_sizze_53315) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53317 = sdiv_up64(n_29482, segscan_tblock_sizze_51568 * chunk_sizze_53316);
        int64_t num_virt_threads_53318 = num_virt_blocks_53317 * segscan_tblock_sizze_51568;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53316, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53319, num_virt_blocks_53317, "status_flags_mem_53319")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53319, num_virt_blocks_53317, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53341, (int64_t) 8 * num_virt_blocks_53317, "aggregates_mem_53341")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53343, (int64_t) 8 * num_virt_blocks_53317, "incprefixes_mem_53343")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegscan_51573(ctx, num_tblocks_51570, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_51567, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51568), chunk_sizze_53316 * segscan_tblock_sizze_51568 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51568), chunk_sizze_53316 * segscan_tblock_sizze_51568 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dim_29479, n_29482, cond_47437, num_fpts_47475, cond_47513, num_tblocks_51570, x_52545, x_52551, num_threads_53130, num_virt_blocks_53317, num_virt_threads_53318, xs_mem_52567.mem, mem_52593.mem, mem_52604.mem, mem_52642.mem, mem_52644.mem, color_52937.mem, color_52938.mem, status_flags_mem_53319.mem, aggregates_mem_53341.mem, incprefixes_mem_53343.mem, global_dynid_mem_53345.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &mem_52593, "mem_52593") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52604, "mem_52604") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
        return 1;
    
    bool cond_47571 = n_29482 == (int64_t) 0;
    bool x_47572 = !cond_47571;
    bool x_47574 = sle64((int64_t) 0, binop_y_52594);
    bool y_47575 = slt64(binop_y_52594, n_29482);
    bool bounds_check_47576 = x_47574 && y_47575;
    bool protect_assert_disj_47577 = cond_47571 || bounds_check_47576;
    bool index_certs_47578;
    
    if (!protect_assert_disj_47577) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) binop_y_52594, "] out of bounds for array of shape [", (long long) n_29482, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_47579;
    
    if (x_47572) {
        int64_t read_res_54106;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_54106, mem_52642.mem, binop_y_52594 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_49324 = read_res_54106;
        
        m_f_res_47579 = x_49324;
    } else {
        m_f_res_47579 = (int64_t) 0;
    }
    
    int64_t m_47581;
    
    if (cond_47571) {
        m_47581 = (int64_t) 0;
    } else {
        m_47581 = m_f_res_47579;
    }
    
    int64_t m_47591 = sub64(m_47581, (int64_t) 1);
    bool i_p_m_t_s_leq_w_47593 = slt64(m_47591, n_29482);
    bool zzero_leq_i_p_m_t_s_47592 = sle64((int64_t) 0, m_47591);
    bool y_47595 = zzero_leq_i_p_m_t_s_47592 && i_p_m_t_s_leq_w_47593;
    bool i_lte_j_47594 = sle64((int64_t) 0, m_47581);
    bool forwards_ok_47596 = i_lte_j_47594 && y_47595;
    bool eq_x_zz_47588 = (int64_t) 0 == m_f_res_47579;
    bool p_and_eq_x_y_47589 = x_47572 && eq_x_zz_47588;
    bool empty_slice_47590 = cond_47571 || p_and_eq_x_y_47589;
    bool ok_or_empty_47597 = empty_slice_47590 || forwards_ok_47596;
    bool index_certs_47598;
    
    if (!ok_or_empty_47597) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_47581, "] out of bounds for array of shape [", (long long) n_29482, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_52645 = (int64_t) 8 * m_47581;
    
    if (memblock_alloc_device(ctx, &mem_52646, bytes_52645, "mem_52646")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_52646, m_47581, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_51578;
    
    segmap_tblock_sizze_51578 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577;
    
    int64_t num_tblocks_51580;
    int64_t max_num_tblocks_53466;
    
    max_num_tblocks_53466 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_51579;
    num_tblocks_51580 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_29482, segmap_tblock_sizze_51578), max_num_tblocks_53466)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53467 = sext_i64_i32(sdiv_up64(n_29482, segmap_tblock_sizze_51578));
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51575(ctx, num_tblocks_51580, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51577, 1, 1, (int64_t) 0, n_29482, m_47581, num_tblocks_51580, virt_num_tblocks_53467, mem_52642.mem, mem_52644.mem, mem_52646.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52642, "mem_52642") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52644, "mem_52644") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51623;
    
    segmap_tblock_sizze_51623 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612;
    
    int64_t segmap_usable_groups_51624 = sdiv_up64(m_47581, segmap_tblock_sizze_51623);
    
    if (memblock_alloc_device(ctx, &mem_52649, (int64_t) 0, "mem_52649")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53480 = sext_i64_i32(sdiv_up64(m_47581, segmap_tblock_sizze_51623));
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51627(ctx, segmap_usable_groups_51624, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51612, 1, 1, (int64_t) 0, n_29482, m_47581, mem_52646.mem, mem_52649.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t nest_sizze_51634 = dim_29479 * m_47581;
    int64_t segmap_tblock_sizze_51635;
    
    segmap_tblock_sizze_51635 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600;
    
    int64_t segmap_usable_groups_51636 = sdiv_up64(nest_sizze_51634, segmap_tblock_sizze_51635);
    int64_t binop_x_52651 = (int64_t) 4 * m_47581;
    int64_t bytes_52652 = dim_29479 * binop_x_52651;
    
    if (memblock_alloc_device(ctx, &mem_52653, bytes_52652, "mem_52653")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53489 = sext_i64_i32(sdiv_up64(m_47581 * dim_29479, segmap_tblock_sizze_51635));
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51640(ctx, segmap_usable_groups_51636, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51600, 1, 1, (int64_t) 0, dim_29479, m_47581, xs_mem_52567.mem, mem_52646.mem, mem_52649.mem, mem_52653.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_tblock_sizze_51645;
    
    segmap_tblock_sizze_51645 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586;
    
    int64_t segmap_usable_groups_51646 = sdiv_up64(m_47581, segmap_tblock_sizze_51645);
    
    if (memblock_alloc_device(ctx, &mem_52656, bytes_52645, "mem_52656")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53500 = sext_i64_i32(sdiv_up64(m_47581, segmap_tblock_sizze_51645));
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51649(ctx, segmap_usable_groups_51646, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51586, 1, 1, (int64_t) 0, offs_29494, m_47581, mem_52646.mem, mem_52649.mem, mem_52656.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52646, "mem_52646") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52649, "mem_52649") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52657, total_grid_no_29491, "mem_52657")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_bool(ctx, mem_52657, total_grid_no_29491, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segred_tblock_sizze_51655;
    
    segred_tblock_sizze_51655 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51654;
    
    int64_t num_tblocks_51657;
    int64_t max_num_tblocks_53529;
    
    max_num_tblocks_53529 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51656;
    num_tblocks_51657 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dim_29479, segred_tblock_sizze_51655), max_num_tblocks_53529)));
    if (memblock_alloc_device(ctx, &mem_52659, (int64_t) 1, "mem_52659")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_53530 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_53533, num_tblocks_51657, "segred_tmp_mem_53533")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53535 = num_tblocks_51657 * segred_tblock_sizze_51655;
    
    {
        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_nonseg_51662(ctx, num_tblocks_51657, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51654, 1, 1, 8 + (segred_tblock_sizze_51655 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_51655, (int64_t) 8), (int64_t) 8)), dim_29479, num_tblocks_51657, num_threads_53535, grid_partitions_per_dim_mem_52565.mem, mem_52659.mem, counters_mem_53531.mem, segred_tmp_mem_53533.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    bool read_res_54107;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_54107, mem_52659.mem, (int64_t) 0 * sizeof(bool), sizeof(bool))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool defunc_0_reduce_res_49382 = read_res_54107;
    
    if (memblock_unref_device(ctx, &mem_52659, "mem_52659") != 0)
        return 1;
    
    bool x_47623 = !empty_slice_47590;
    bool y_47624 = slt64(m_47591, m_47581);
    bool bounds_check_47625 = zzero_leq_i_p_m_t_s_47592 && y_47624;
    bool protect_assert_disj_47626 = empty_slice_47590 || bounds_check_47625;
    bool protect_assert_disj_47627 = protect_assert_disj_47626 || defunc_0_reduce_res_49382;
    bool index_certs_47628;
    
    if (!protect_assert_disj_47627) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_47591, "] out of bounds for array of shape [", (long long) m_47581, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_51745;
    
    segmap_tblock_sizze_51745 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691;
    
    int64_t segmap_usable_groups_51746 = sdiv_up_safe64(nest_sizze_51634, segmap_tblock_sizze_51745);
    int64_t segmap_tblock_sizze_51770;
    
    segmap_tblock_sizze_51770 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667;
    
    int64_t segmap_usable_groups_51771 = sdiv_up_safe64(m_47581, segmap_tblock_sizze_51770);
    int64_t seghist_tblock_sizze_51783;
    
    seghist_tblock_sizze_51783 = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782;
    
    int64_t num_tblocks_51785;
    int64_t max_num_tblocks_53564;
    
    max_num_tblocks_53564 = *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_num_tblocks_51784;
    num_tblocks_51785 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_47581, seghist_tblock_sizze_51783), max_num_tblocks_53564)));
    
    bool suff_outer_par_51803;
    
    suff_outer_par_51803 = *ctx->tuning_params.skyline_slice_and_dice_floatzisuff_outer_par_0 <= total_grid_no_29491;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "skyline_slice_and_dice_float.suff_outer_par_0", (long) total_grid_no_29491, suff_outer_par_51803 ? "true" : "false");
    
    int64_t max_tblock_sizze_51902;
    
    max_tblock_sizze_51902 = ctx->max_thread_block_size;
    
    bool fits_51903 = sle64(total_grid_no_29491, max_tblock_sizze_51902);
    bool suff_intra_par_51901;
    
    suff_intra_par_51901 = *ctx->tuning_params.skyline_slice_and_dice_floatzisuff_intra_par_1 <= total_grid_no_29491;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "skyline_slice_and_dice_float.suff_intra_par_1", (long) total_grid_no_29491, suff_intra_par_51901 ? "true" : "false");
    
    bool intra_suff_and_fits_51904 = suff_intra_par_51901 && fits_51903;
    int64_t segmap_tblock_sizze_52030;
    
    segmap_tblock_sizze_52030 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019;
    
    int64_t segmap_usable_groups_52031 = sdiv_up_safe64(total_grid_no_29491, segmap_tblock_sizze_52030);
    int64_t nest_sizze_52041 = dim_29479 * total_grid_no_29491;
    int64_t segmap_tblock_sizze_52042;
    
    segmap_tblock_sizze_52042 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007;
    
    int64_t segmap_usable_groups_52043 = sdiv_up_safe64(nest_sizze_52041, segmap_tblock_sizze_52042);
    int64_t nest_sizze_52052 = total_grid_no_29491 * total_grid_no_29491;
    int64_t segred_tblock_sizze_52053;
    
    segred_tblock_sizze_52053 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955;
    
    int64_t num_tblocks_52054;
    int64_t max_num_tblocks_53565;
    
    max_num_tblocks_53565 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_num_tblocks_51957;
    num_tblocks_52054 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_52052, segred_tblock_sizze_52053), max_num_tblocks_53565)));
    
    int64_t segscan_tblock_sizze_52099;
    
    segscan_tblock_sizze_52099 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098;
    
    int64_t num_tblocks_52101;
    int64_t max_num_tblocks_53566;
    
    max_num_tblocks_53566 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_num_tblocks_52100;
    num_tblocks_52101 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_47581, segscan_tblock_sizze_52099), max_num_tblocks_53566)));
    
    int64_t tile_sizze_52187;
    
    tile_sizze_52187 = *ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186;
    
    int64_t ldim_52188 = sdiv_up_safe64(total_grid_no_29491, tile_sizze_52187);
    int64_t num_whole_tiles_52209 = squot_safe64(total_grid_no_29491, tile_sizze_52187);
    int64_t residual_input_52385 = srem_safe64(total_grid_no_29491, tile_sizze_52187);
    bool cond_52386 = residual_input_52385 == (int64_t) 0;
    int64_t binop_x_52396 = tile_sizze_52187 * num_whole_tiles_52209;
    int64_t bytes_52662 = dim_29479 * bytes_52645;
    int64_t binop_x_52666 = smax64((int64_t) 0, m_47591);
    int64_t binop_y_52669 = m_47581 * binop_x_52587;
    int64_t binop_y_52670 = smax64((int64_t) 0, binop_y_52669);
    int64_t binop_y_52671 = binop_x_52666 + binop_y_52670;
    int64_t binop_y_52672 = (int64_t) 1 + binop_y_52671;
    int64_t bytes_52673 = (int64_t) 8 * binop_y_52672;
    int64_t bytes_52678 = (int64_t) 4 * total_grid_no_29491;
    int64_t bytes_52685 = dim_29479 * bytes_52678;
    int64_t binop_y_52687 = total_grid_no_29491 - (int64_t) 1;
    int64_t binop_x_52689 = smax64((int64_t) 0, binop_y_52687);
    int64_t binop_y_52692 = total_grid_no_29491 * binop_x_52587;
    int64_t binop_y_52693 = smax64((int64_t) 0, binop_y_52692);
    int64_t binop_y_52694 = binop_x_52689 + binop_y_52693;
    int64_t binop_y_52695 = (int64_t) 1 + binop_y_52694;
    int64_t bytes_52696 = (int64_t) 4 * binop_y_52695;
    int64_t binop_y_52698 = dz2080U_29480 - (int64_t) 1;
    int64_t binop_x_52700 = smax64((int64_t) 0, binop_y_52698);
    int64_t binop_y_52703 = dz2080U_29480 * binop_x_52587;
    int64_t binop_y_52704 = smax64((int64_t) 0, binop_y_52703);
    int64_t binop_y_52705 = binop_x_52700 + binop_y_52704;
    int64_t binop_y_52706 = (int64_t) 1 + binop_y_52705;
    int64_t bytes_52707 = (int64_t) 4 * binop_y_52706;
    int64_t bytes_52734 = (int64_t) 8 * tile_sizze_52187;
    int64_t num_threads_53207 = segred_tblock_sizze_52053 * num_tblocks_52054;
    int64_t total_sizze_53208 = dim_29479 * num_threads_53207;
    int64_t binop_x_53196 = dim_29479 * total_grid_no_29491;
    int64_t total_sizze_53197 = total_grid_no_29491 * binop_x_53196;
    int64_t binop_x_53164 = dim_29479 * ldim_52188;
    int64_t total_sizze_53165 = tile_sizze_52187 * binop_x_53164;
    int64_t binop_x_53166 = dim_29479 * ldim_52188;
    int64_t total_sizze_53167 = tile_sizze_52187 * binop_x_53166;
    int64_t skyline_slice_and_dice_res_47629;
    int64_t skyline_slice_and_dice_res_47630;
    
    if (defunc_0_reduce_res_49382) {
        if (memblock_set_device(ctx, &ext_mem_52786, &mem_52657, "mem_52657") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52785, &mem_52653, "mem_52653") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52784, &mem_52656, "mem_52656") != 0)
            return 1;
        skyline_slice_and_dice_res_47629 = m_47581;
        skyline_slice_and_dice_res_47630 = m_47581;
    } else {
        if (memblock_alloc_device(ctx, &mem_52663, bytes_52662, "mem_52663")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_53567 = sext_i64_i32(sdiv_up64(m_47581 * dim_29479, segmap_tblock_sizze_51745));
        
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51750(ctx, segmap_usable_groups_51746, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51691, 1, 1, (int64_t) 0, dim_29479, m_47581, grid_part_prefix_sum_mem_52563.mem, grid_part_sizze_per_dim_mem_52564.mem, grid_partitions_per_dim_mem_52565.mem, start_of_grid_partition_mem_52566.mem, mem_52653.mem, mem_52663.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_alloc_device(ctx, &mem_52674, bytes_52673, "mem_52674")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_52674.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, m_47581}, mem_52663.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {m_47581, dim_29479})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_52663, "mem_52663") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_52677, bytes_52645, "mem_52677")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_53578 = sext_i64_i32(sdiv_up64(m_47581, segmap_tblock_sizze_51770));
        
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_51774(ctx, segmap_usable_groups_51771, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_51667, 1, 1, (int64_t) 0, dim_29479, m_47581, mem_52674.mem, mem_52677.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_52674, "mem_52674") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_52679, bytes_52678, "mem_52679")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i32(ctx, mem_52679, total_grid_no_29491, 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t num_subhistos_53588;
        int64_t h_53591 = (int64_t) 4 * total_grid_no_29491;
        int64_t seg_h_53592 = (int64_t) 4 * total_grid_no_29491;
        
        if (!(seg_h_53592 == (int64_t) 0)) {
            int64_t hist_H_53593 = total_grid_no_29491;
            int64_t hist_el_sizze_53594 = sdiv_up64(h_53591, hist_H_53593);
            int64_t hist_N_53595 = m_47581;
            int32_t hist_RF_53596 = 1;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegHist");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)", (long long) sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783), '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Desired block size (B)", (long long) seghist_tblock_sizze_51783, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_53593, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Input elements per histogram (N)", (long long) hist_N_53595, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of segments", (long long) (int64_t) 1, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Histogram element size (el_size)", (long long) hist_el_sizze_53594, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)", (long long) hist_RF_53596, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms per segment", (long long) h_53591, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms times segments", (long long) seg_h_53592, '\n');
            
            int64_t hist_L_53597;
            
            hist_L_53597 = *ctx->tuning_params.skyline_slice_and_dice_floatzihist_L_53597;
            
            int64_t max_tblock_sizze_53598;
            
            max_tblock_sizze_53598 = ctx->max_thread_block_size;
            
            int64_t num_tblocks_53599 = sdiv_up64(sext_i32_i64(sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783)), max_tblock_sizze_53598);
            double hist_m_prime_53600 = sitofp_i64_f64(smin64(squot64(hist_L_53597, hist_el_sizze_53594), sdiv_up64(hist_N_53595, num_tblocks_53599))) / sitofp_i64_f64(hist_H_53593);
            int64_t hist_M0_53601 = smax64((int64_t) 1, smin64(fptosi_f64_i64(hist_m_prime_53600), max_tblock_sizze_53598));
            int64_t hist_Nout_53602 = (int64_t) 1;
            int64_t hist_Nin_53603 = m_47581;
            int64_t work_asymp_M_max_53604 = squot64(hist_Nout_53602 * hist_N_53595, (int64_t) 2 * num_tblocks_53599 * hist_H_53593);
            int32_t hist_M_53605 = sext_i64_i32(smin64(hist_M0_53601, work_asymp_M_max_53604));
            int64_t hist_C_53606 = sdiv_up64(max_tblock_sizze_53598, sext_i32_i64(smax32(1, hist_M_53605)));
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local hist_M0", (long long) hist_M0_53601, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local work asymp M max", (long long) work_asymp_M_max_53604, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local C", (long long) hist_C_53606, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local B", (long long) max_tblock_sizze_53598, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "local M", (long long) hist_M_53605, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "shared memory needed", (long long) (hist_H_53593 * hist_el_sizze_53594 * sext_i32_i64(hist_M_53605)), '\n');
            
            int64_t local_mem_needed_53607 = hist_el_sizze_53594 * sext_i32_i64(hist_M_53605);
            int32_t hist_S_53608 = sext_i64_i32(sdiv_up64(hist_H_53593 * local_mem_needed_53607 + (int64_t) 1, hist_L_53597));
            
            if (sle64(hist_H_53593, hist_Nin_53603) && (sle64(local_mem_needed_53607, hist_L_53597) && (sle32(hist_S_53608, 3) && (sle64(hist_C_53606, max_tblock_sizze_53598) && slt32(0, hist_M_53605))))) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "## Using shared memory");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_53593, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_53605, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)", (long long) hist_C_53606, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_53608, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of local subhistograms per block", (long long) hist_M_53605, '\n');
                num_subhistos_53588 = num_tblocks_53599;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of subhistograms in global memory per segment", (long long) num_subhistos_53588, '\n');
                if (num_subhistos_53588 == (int64_t) 1) {
                    if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53589, &mem_52679, "mem_52679") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53589, num_subhistos_53588 * total_grid_no_29491 * (int64_t) 4, "defunc_0_map_res_subhistos_mem_53589")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, defunc_0_map_res_subhistos_mem_53589, num_subhistos_53588 * total_grid_no_29491, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, defunc_0_map_res_subhistos_mem_53589.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52679.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_grid_no_29491})) != 0)
                        goto cleanup;
                }
                for (int32_t chk_i_53609 = 0; chk_i_53609 < hist_S_53608; chk_i_53609++) {
                    int64_t num_segments_53610 = (int64_t) 1;
                    int64_t hist_H_chk_53611 = sdiv_up64(total_grid_no_29491, sext_i32_i64(hist_S_53608));
                    int64_t histo_sizze_53612 = hist_H_chk_53611;
                    int32_t init_per_thread_53613 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_53605) * histo_sizze_53612, max_tblock_sizze_53598));
                    
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatziseghist_local_51790(ctx, num_tblocks_53599, 1, 1, ctx->max_thread_block_size, 1, 1, (int64_t) 4 * (hist_M_53605 * hist_H_chk_53611) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53605 * hist_H_chk_53611), (int64_t) 8), (int64_t) 8), total_grid_no_29491, m_47581, num_subhistos_53588, num_tblocks_53599, hist_M_53605, chk_i_53609, num_segments_53610, hist_H_chk_53611, histo_sizze_53612, init_per_thread_53613, mem_52677.mem, defunc_0_map_res_subhistos_mem_53589.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                }
            } else {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "## Using global memory");
                
                int64_t hist_H_53645 = total_grid_no_29491;
                double hist_RF_53646 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
                int32_t hist_el_sizze_53647 = 4;
                double hist_C_max_53648 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783)), sitofp_i32_f64(hist_H_53645) / 2.0);
                int32_t hist_M_min_53649 = smax32(1, sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783)) / hist_C_max_53648)));
                int64_t hist_L2_53650;
                
                hist_L2_53650 = *ctx->tuning_params.skyline_slice_and_dice_floatzihist_L2_53650;
                
                double hist_RACE_exp_53651 = fmax64(1.0, 0.75 * hist_RF_53646 / (64.0 / sitofp_i32_f64(hist_el_sizze_53647)));
                int32_t hist_S_53652;
                
                if (slt64(m_47581, hist_H_53645)) {
                    hist_S_53652 = 1;
                } else {
                    hist_S_53652 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_53649) * hist_H_53645 * sext_i32_i64(hist_el_sizze_53647), fptosi_f64_i64(0.4 * sitofp_i32_f64(hist_L2_53650) * hist_RACE_exp_53651)));
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c", "Race expansion factor (RACE^exp)", (double) hist_RACE_exp_53651, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_53652, '\n');
                
                int64_t hist_H_chk_53653 = sdiv_up64(total_grid_no_29491, sext_i32_i64(hist_S_53652));
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)", (long long) hist_H_chk_53653, '\n');
                
                double hist_k_max_53654 = fmin64(0.4 * (sitofp_i32_f64(hist_L2_53650) / sitofp_i32_f64(4)) * hist_RACE_exp_53651, sitofp_i32_f64(m_47581)) / sitofp_i32_f64(sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783));
                int64_t hist_u_53655 = (int64_t) 2;
                double hist_C_53656 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51785 * seghist_tblock_sizze_51783)), sitofp_i32_f64(hist_u_53655 * hist_H_chk_53653) / hist_k_max_53654);
                int32_t hist_M_53657 = 1;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c", "Elements/thread in L2 cache (k_max)", (double) hist_k_max_53654, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_53657, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)", (double) hist_C_53656, '\n');
                num_subhistos_53588 = sext_i32_i64(hist_M_53657);
                if (hist_M_53657 == 1) {
                    if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53589, &mem_52679, "mem_52679") != 0)
                        return 1;
                } else if (num_subhistos_53588 == (int64_t) 1) {
                    if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53589, &mem_52679, "mem_52679") != 0)
                        return 1;
                } else {
                    if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53589, num_subhistos_53588 * total_grid_no_29491 * (int64_t) 4, "defunc_0_map_res_subhistos_mem_53589")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i32(ctx, defunc_0_map_res_subhistos_mem_53589, num_subhistos_53588 * total_grid_no_29491, 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, defunc_0_map_res_subhistos_mem_53589.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52679.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_grid_no_29491})) != 0)
                        goto cleanup;
                }
                for (int32_t chk_i_53658 = 0; chk_i_53658 < hist_S_53652; chk_i_53658++) {
                    int64_t hist_H_chk_53659 = sdiv_up64(total_grid_no_29491, sext_i32_i64(hist_S_53652));
                    
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatziseghist_global_51790(ctx, num_tblocks_51785, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782, 1, 1, (int64_t) 0, total_grid_no_29491, m_47581, num_tblocks_51785, num_subhistos_53588, chk_i_53658, hist_H_chk_53659, mem_52677.mem, defunc_0_map_res_subhistos_mem_53589.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                }
            }
            if (num_subhistos_53588 == (int64_t) 1) {
                if (memblock_set_device(ctx, &mem_52679, &defunc_0_map_res_subhistos_mem_53589, "defunc_0_map_res_subhistos_mem_53589") != 0)
                    return 1;
            } else {
                int64_t chunk_sizze_53675 = (int64_t) 1;
                
                if (slt64(num_subhistos_53588 * (int64_t) 2, seghist_tblock_sizze_51783 * chunk_sizze_53675)) {
                    int64_t segment_sizze_nonzzero_53676 = smax64((int64_t) 1, num_subhistos_53588);
                    int64_t num_threads_53677 = seghist_tblock_sizze_51783 * seghist_tblock_sizze_51783;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-small");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_53588, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676), '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(total_grid_no_29491, squot64(seghist_tblock_sizze_51783, segment_sizze_nonzzero_53676))), '\n');
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_small_53674(ctx, num_tblocks_51785, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782, 1, 1, (int64_t) 4 * seghist_tblock_sizze_51783 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51783, (int64_t) 8), (int64_t) 8), total_grid_no_29491, num_tblocks_51785, num_subhistos_53588, segment_sizze_nonzzero_53676, mem_52679.mem, defunc_0_map_res_subhistos_mem_53589.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                } else {
                    int64_t blocks_per_segment_53705 = sdiv_up64(num_tblocks_51785, smax64((int64_t) 1, total_grid_no_29491));
                    int64_t q_53706 = sdiv_up64(num_subhistos_53588, seghist_tblock_sizze_51783 * blocks_per_segment_53705 * chunk_sizze_53675);
                    int64_t num_virtblocks_53707 = blocks_per_segment_53705 * total_grid_no_29491;
                    int64_t threads_per_segment_53708 = blocks_per_segment_53705 * seghist_tblock_sizze_51783;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-large");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_53588, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_53707, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_51785, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) seghist_tblock_sizze_51783, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_53706, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_53705, '\n');
                    if (memblock_alloc_device(ctx, &segred_tmp_mem_53709, (int64_t) 4 * num_virtblocks_53707, "segred_tmp_mem_53709")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_large_53674(ctx, num_tblocks_51785, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatziseghist_tblock_sizze_51782, 1, 1, 8 + ((int64_t) 4 * seghist_tblock_sizze_51783 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51783, (int64_t) 8), (int64_t) 8)), total_grid_no_29491, num_tblocks_51785, num_subhistos_53588, blocks_per_segment_53705, q_53706, num_virtblocks_53707, threads_per_segment_53708, mem_52679.mem, defunc_0_map_res_subhistos_mem_53589.mem, segred_tmp_mem_53709.mem, counters_mem_53711.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                }
            }
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t shared_memory_capacity_53889;
        
        shared_memory_capacity_53889 = ctx->max_shared_memory;
        if (suff_outer_par_51803 && sle64(sdiv_up64(bytes_52734, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_53889)) {
            if (memblock_alloc_device(ctx, &mem_52760, total_grid_no_29491, "mem_52760")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &color_52939, total_sizze_53165, "color_52939")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &color_52940, total_sizze_53167, "color_52940")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_53748 = sext_i64_i32(sdiv_up64(tile_sizze_52187, tile_sizze_52187));
            int32_t virt_num_tblocks_53749 = sext_i64_i32(ldim_52188);
            
            {
                err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_intrablock_52185(ctx, ldim_52188, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzitile_sizze_52186, 1, 1, bytes_52734 + srem64((int64_t) 8 - srem64(bytes_52734, (int64_t) 8), (int64_t) 8), dim_29479, dz2080U_29480, total_grid_no_29491, ldim_52188, num_whole_tiles_52209, residual_input_52385, cond_52386, binop_x_52396, start_of_grid_partition_mem_52566.mem, mem_52679.mem, mem_52760.mem, color_52939.mem, color_52940.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &color_52940, "color_52940") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_52761, &mem_52760, "mem_52760") != 0)
                return 1;
        } else {
            int64_t shared_memory_capacity_53888;
            
            shared_memory_capacity_53888 = ctx->max_shared_memory;
            if (intra_suff_and_fits_51904 && sle64(sdiv_up64(total_grid_no_29491, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_53888)) {
                if (memblock_alloc_device(ctx, &mem_52726, total_grid_no_29491, "mem_52726")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &color_52942, total_sizze_53197, "color_52942")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t num_chunks_53771 = sext_i64_i32(sdiv_up64(total_grid_no_29491, total_grid_no_29491));
                int32_t virt_num_tblocks_53772 = sext_i64_i32(total_grid_no_29491);
                
                {
                    err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_intrablock_51907(ctx, total_grid_no_29491, 1, 1, total_grid_no_29491, 1, 1, total_grid_no_29491 + srem64((int64_t) 8 - srem64(total_grid_no_29491, (int64_t) 8), (int64_t) 8), dim_29479, dz2080U_29480, total_grid_no_29491, cond_47437, start_of_grid_partition_mem_52566.mem, mem_52679.mem, mem_52726.mem, color_52942.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &color_52942, "color_52942") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_52727, &mem_52726, "mem_52726") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &mem_52682, (int64_t) 0, "mem_52682")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_53790 = sext_i64_i32(sdiv_up64(total_grid_no_29491, segmap_tblock_sizze_52030));
                
                {
                    err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_52034(ctx, segmap_usable_groups_52031, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52019, 1, 1, (int64_t) 0, dz2080U_29480, total_grid_no_29491, mem_52682.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_alloc_device(ctx, &mem_52686, bytes_52685, "mem_52686")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_53799 = sext_i64_i32(sdiv_up64(total_grid_no_29491 * dim_29479, segmap_tblock_sizze_52042));
                
                {
                    err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_52047(ctx, segmap_usable_groups_52043, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52007, 1, 1, (int64_t) 0, dim_29479, total_grid_no_29491, start_of_grid_partition_mem_52566.mem, mem_52682.mem, mem_52686.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &mem_52682, "mem_52682") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_52697, bytes_52696, "mem_52697")) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52697.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, total_grid_no_29491}, mem_52686.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {total_grid_no_29491, dim_29479})) != 0)
                    goto cleanup;
                if (memblock_unref_device(ctx, &mem_52686, "mem_52686") != 0)
                    return 1;
                if (memblock_alloc_device(ctx, &mem_52708, bytes_52707, "mem_52708")) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52708.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2080U_29480}, start_of_grid_partition_mem_52566.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {dz2080U_29480, dim_29479})) != 0)
                    goto cleanup;
                if (memblock_alloc_device(ctx, &mem_52717, total_grid_no_29491, "mem_52717")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &color_52943, total_sizze_53208, "color_52943")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                int64_t chunk_sizze_53810 = (int64_t) 1;
                
                if (slt64(total_grid_no_29491 * (int64_t) 2, segred_tblock_sizze_52053 * chunk_sizze_53810)) {
                    int64_t segment_sizze_nonzzero_53811 = smax64((int64_t) 1, total_grid_no_29491);
                    int64_t num_threads_53812 = segred_tblock_sizze_52053 * segred_tblock_sizze_52053;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-small");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811), '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(total_grid_no_29491, squot64(segred_tblock_sizze_52053, segment_sizze_nonzzero_53811))), '\n');
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_small_52059(ctx, num_tblocks_52054, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955, 1, 1, segred_tblock_sizze_52053 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_52053, (int64_t) 8), (int64_t) 8), dim_29479, dz2080U_29480, total_grid_no_29491, cond_47437, num_tblocks_52054, num_threads_53207, segment_sizze_nonzzero_53811, mem_52679.mem, mem_52697.mem, mem_52708.mem, mem_52717.mem, color_52943.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                } else {
                    int64_t blocks_per_segment_53842 = sdiv_up64(num_tblocks_52054, smax64((int64_t) 1, total_grid_no_29491));
                    int64_t q_53843 = sdiv_up64(total_grid_no_29491, segred_tblock_sizze_52053 * blocks_per_segment_53842 * chunk_sizze_53810);
                    int64_t num_virtblocks_53844 = blocks_per_segment_53842 * total_grid_no_29491;
                    int64_t threads_per_segment_53845 = blocks_per_segment_53842 * segred_tblock_sizze_52053;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-large");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) total_grid_no_29491, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_53844, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_52054, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_52053, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_53843, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_53842, '\n');
                    if (memblock_alloc_device(ctx, &segred_tmp_mem_53846, num_virtblocks_53844, "segred_tmp_mem_53846")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_skyline_slice_and_dice_floatzisegred_large_52059(ctx, num_tblocks_52054, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegred_tblock_sizze_51955, 1, 1, 8 + (segred_tblock_sizze_52053 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_52053, (int64_t) 8), (int64_t) 8)), dim_29479, dz2080U_29480, total_grid_no_29491, cond_47437, num_tblocks_52054, num_threads_53207, blocks_per_segment_53842, q_53843, num_virtblocks_53844, threads_per_segment_53845, mem_52679.mem, mem_52697.mem, mem_52708.mem, mem_52717.mem, color_52943.mem, segred_tmp_mem_53846.mem, counters_mem_53848.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    ctx->failure_is_an_option = 1;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &mem_52697, "mem_52697") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_52708, "mem_52708") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &color_52943, "color_52943") != 0)
                    return 1;
                if (memblock_set_device(ctx, &ext_mem_52727, &mem_52717, "mem_52717") != 0)
                    return 1;
            }
            if (memblock_set_device(ctx, &ext_mem_52761, &ext_mem_52727, "ext_mem_52727") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_52679, "mem_52679") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_52769, bytes_52645, "mem_52769")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_52771, bytes_52645, "mem_52771")) {
            err = 1;
            goto cleanup;
        }
        if (slt64((int64_t) 0, m_47581)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_53890;
            
            shared_memory_53890 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_53891;
            
            thread_block_sizze_53891 = ctx->max_thread_block_size;
            
            int64_t registers_53892;
            
            registers_53892 = ctx->max_registers;
            
            int64_t thread_block_sizze_53893;
            
            thread_block_sizze_53893 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_53894 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53890, thread_block_sizze_53891), (int64_t) 8), squot64(squot64(registers_53892, thread_block_sizze_53893) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_53895 = sdiv_up64(m_47581, segscan_tblock_sizze_52099 * chunk_sizze_53894);
            int64_t num_virt_threads_53896 = num_virt_blocks_53895 * segscan_tblock_sizze_52099;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53894, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_53897, num_virt_blocks_53895, "status_flags_mem_53897")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53897, num_virt_blocks_53895, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_53899, (int64_t) 8 * num_virt_blocks_53895, "aggregates_mem_53899")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_53901, (int64_t) 8 * num_virt_blocks_53895, "incprefixes_mem_53901")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_skyline_slice_and_dice_floatzisegscan_52104(ctx, num_tblocks_52101, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegscan_tblock_sizze_52098, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_52099), chunk_sizze_53894 * segscan_tblock_sizze_52099 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_52099), chunk_sizze_53894 * segscan_tblock_sizze_52099 * (int64_t) 8), (int64_t) 8), (int64_t) 8), total_grid_no_29491, m_47581, num_tblocks_52101, num_virt_blocks_53895, num_virt_threads_53896, mem_52677.mem, ext_mem_52761.mem, mem_52769.mem, mem_52771.mem, status_flags_mem_53897.mem, aggregates_mem_53899.mem, incprefixes_mem_53901.mem, global_dynid_mem_53903.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &mem_52677, "mem_52677") != 0)
            return 1;
        
        int64_t m_f_res_47705;
        
        if (x_47623) {
            int64_t read_res_54108;
            
            if ((err = gpu_scalar_from_device(ctx, &read_res_54108, mem_52769.mem, m_47591 * sizeof(int64_t), sizeof(int64_t))) != 0)
                goto cleanup;
            if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t x_49365 = read_res_54108;
            
            m_f_res_47705 = x_49365;
        } else {
            m_f_res_47705 = (int64_t) 0;
        }
        
        int64_t m_47707;
        
        if (empty_slice_47590) {
            m_47707 = (int64_t) 0;
        } else {
            m_47707 = m_f_res_47705;
        }
        
        int64_t m_47717 = sub64(m_47707, (int64_t) 1);
        bool i_p_m_t_s_leq_w_47719 = slt64(m_47717, m_47581);
        bool zzero_leq_i_p_m_t_s_47718 = sle64((int64_t) 0, m_47717);
        bool y_47721 = zzero_leq_i_p_m_t_s_47718 && i_p_m_t_s_leq_w_47719;
        bool i_lte_j_47720 = sle64((int64_t) 0, m_47707);
        bool forwards_ok_47722 = i_lte_j_47720 && y_47721;
        bool eq_x_zz_47714 = (int64_t) 0 == m_f_res_47705;
        bool p_and_eq_x_y_47715 = x_47623 && eq_x_zz_47714;
        bool empty_slice_47716 = empty_slice_47590 || p_and_eq_x_y_47715;
        bool ok_or_empty_47723 = empty_slice_47716 || forwards_ok_47722;
        bool index_certs_47724;
        
        if (!ok_or_empty_47723) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_47707, "] out of bounds for array of shape [", (long long) m_47581, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_libs/ftSkyline.fut:629:17-635:112\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t binop_x_52772 = (int64_t) 4 * m_47707;
        int64_t bytes_52773 = dim_29479 * binop_x_52772;
        int64_t bytes_52775 = (int64_t) 8 * m_47707;
        
        if (memblock_alloc_device(ctx, &mem_52763, bytes_52645, "mem_52763")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52763.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52656.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_47581})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_52766, bytes_52652, "mem_52766")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52766.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, mem_52653.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {m_47581, dim_29479})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_52774, bytes_52773, "mem_52774")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52774.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, mem_52766.mem, (int64_t) 0, (int64_t []) {dim_29479, (int64_t) 1}, (int64_t []) {m_47707, dim_29479})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_52766, "mem_52766") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_52776, bytes_52775, "mem_52776")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52776.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52763.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_47707})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_52763, "mem_52763") != 0)
            return 1;
        
        int64_t segmap_tblock_sizze_52123;
        
        segmap_tblock_sizze_52123 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112;
        
        int64_t segmap_usable_groups_52124 = sdiv_up64(m_47581, segmap_tblock_sizze_52123);
        
        if (memblock_alloc_device(ctx, &mem_52779, bytes_52645, "mem_52779")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_52781, bytes_52645, "mem_52781")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_53992 = sext_i64_i32(sdiv_up64(m_47581, segmap_tblock_sizze_52123));
        
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_52128(ctx, segmap_usable_groups_52124, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52112, 1, 1, (int64_t) 0, m_47581, mem_52769.mem, mem_52771.mem, mem_52779.mem, mem_52781.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_52769, "mem_52769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52771, "mem_52771") != 0)
            return 1;
        
        int64_t segmap_tblock_sizze_52144;
        
        segmap_tblock_sizze_52144 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143;
        
        int64_t num_tblocks_52146;
        int64_t max_num_tblocks_54001;
        
        max_num_tblocks_54001 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_52145;
        num_tblocks_52146 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_51634, segmap_tblock_sizze_52144), max_num_tblocks_54001)));
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_54002 = sext_i64_i32(sdiv_up64(m_47581 * dim_29479, segmap_tblock_sizze_52144));
        
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_52140(ctx, num_tblocks_52146, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52143, 1, 1, (int64_t) 0, dim_29479, m_47581, m_47707, num_tblocks_52146, virt_num_tblocks_54002, mem_52653.mem, mem_52774.mem, mem_52779.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_52779, "mem_52779") != 0)
            return 1;
        
        int64_t segmap_tblock_sizze_52154;
        
        segmap_tblock_sizze_52154 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153;
        
        int64_t num_tblocks_52156;
        int64_t max_num_tblocks_54017;
        
        max_num_tblocks_54017 = *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_num_tblocks_52155;
        num_tblocks_52156 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(m_47581, segmap_tblock_sizze_52154), max_num_tblocks_54017)));
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_54018 = sext_i64_i32(sdiv_up64(m_47581, segmap_tblock_sizze_52154));
        
        {
            err = gpu_kernel_skyline_slice_and_dice_floatzisegmap_52151(ctx, num_tblocks_52156, 1, 1, *ctx->tuning_params.skyline_slice_and_dice_floatzisegmap_tblock_sizze_52153, 1, 1, (int64_t) 0, m_47581, m_47707, num_tblocks_52156, virt_num_tblocks_54018, mem_52656.mem, mem_52776.mem, mem_52781.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_52781, "mem_52781") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52786, &ext_mem_52761, "ext_mem_52761") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52785, &mem_52774, "mem_52774") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_52784, &mem_52776, "mem_52776") != 0)
            return 1;
        skyline_slice_and_dice_res_47629 = m_47707;
        skyline_slice_and_dice_res_47630 = m_47707;
    }
    if (memblock_unref_device(ctx, &mem_52653, "mem_52653") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52656, "mem_52656") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52657, "mem_52657") != 0)
        return 1;
    
    bool dim_match_47734 = skyline_slice_and_dice_res_47629 == skyline_slice_and_dice_res_47630;
    bool empty_or_match_cert_47735;
    
    if (!dim_match_47734) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ft_libs/ftSkyline.fut:233:17-265:26\n   #1  ft_libs/ftSkyline.fut:629:17-635:112\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_set_device(ctx, &mem_out_53217, &ext_mem_52786, "ext_mem_52786") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &ext_mem_52785, "ext_mem_52785") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &ext_mem_52784, "ext_mem_52784") != 0)
        return 1;
    prim_out_53220 = total_grid_no_29491;
    prim_out_53221 = skyline_slice_and_dice_res_47629;
    if (memblock_set_device(ctx, &*mem_out_p_54100, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54101, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54102, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54103 = prim_out_53220;
    *out_prim_out_54104 = prim_out_53221;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52781, "mem_52781") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52779, "mem_52779") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52776, "mem_52776") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52774, "mem_52774") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52766, "mem_52766") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52763, "mem_52763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53901, "incprefixes_mem_53901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53899, "aggregates_mem_53899") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53897, "status_flags_mem_53897") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52771, "mem_52771") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52769, "mem_52769") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53846, "segred_tmp_mem_53846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52943, "color_52943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52717, "mem_52717") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52708, "mem_52708") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52697, "mem_52697") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52686, "mem_52686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52682, "mem_52682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52942, "color_52942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52726, "mem_52726") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52727, "ext_mem_52727") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52940, "color_52940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52760, "mem_52760") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52761, "ext_mem_52761") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53709, "segred_tmp_mem_53709") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_map_res_subhistos_mem_53589, "defunc_0_map_res_subhistos_mem_53589") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52679, "mem_52679") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52677, "mem_52677") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52674, "mem_52674") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52663, "mem_52663") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52784, "ext_mem_52784") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52785, "ext_mem_52785") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52786, "ext_mem_52786") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53533, "segred_tmp_mem_53533") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52659, "mem_52659") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52657, "mem_52657") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52656, "mem_52656") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52653, "mem_52653") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52649, "mem_52649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52646, "mem_52646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53343, "incprefixes_mem_53343") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53341, "aggregates_mem_53341") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53319, "status_flags_mem_53319") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52644, "mem_52644") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52642, "mem_52642") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52604, "mem_52604") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52593, "mem_52593") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53248, "segred_tmp_mem_53248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53246, "segred_tmp_mem_53246") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52578, "mem_52578") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52577, "mem_52577") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_filter_against_9751(struct futhark_context *ctx, struct memblock_device *mem_out_p_54109, struct memblock_device *mem_out_p_54110, struct memblock_device *mem_out_p_54111, int64_t *out_prim_out_54112, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, struct memblock_device isPartitionDominated_mem_52570, struct memblock_device xys_mem_52571, struct memblock_device xys_mem_52572, int64_t dim_35535, int64_t dz2080U_35536, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_35537, int64_t dz2081U_35538, int64_t dz2082U_35539, int64_t dz2081U_35540, int64_t dz2082U_35541, int64_t m_sizze_35547, int64_t total_angle_no_35549, int64_t total_grid_no_35550, int64_t total_part_no_35551)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52685;
    
    mem_52685.references = NULL;
    
    struct memblock_device mem_52682;
    
    mem_52682.references = NULL;
    
    struct memblock_device mem_52678;
    
    mem_52678.references = NULL;
    
    struct memblock_device mem_52675;
    
    mem_52675.references = NULL;
    
    struct memblock_device incprefixes_mem_53425;
    
    incprefixes_mem_53425.references = NULL;
    
    struct memblock_device aggregates_mem_53423;
    
    aggregates_mem_53423.references = NULL;
    
    struct memblock_device status_flags_mem_53401;
    
    status_flags_mem_53401.references = NULL;
    
    struct memblock_device mem_52673;
    
    mem_52673.references = NULL;
    
    struct memblock_device mem_52671;
    
    mem_52671.references = NULL;
    
    struct memblock_device segred_tmp_mem_53317;
    
    segred_tmp_mem_53317.references = NULL;
    
    struct memblock_device color_52939;
    
    color_52939.references = NULL;
    
    struct memblock_device color_52938;
    
    color_52938.references = NULL;
    
    struct memblock_device mem_52615;
    
    mem_52615.references = NULL;
    
    struct memblock_device color_52937;
    
    color_52937.references = NULL;
    
    struct memblock_device mem_52599;
    
    mem_52599.references = NULL;
    
    struct memblock_device mem_52588;
    
    mem_52588.references = NULL;
    
    struct memblock_device color_52936;
    
    color_52936.references = NULL;
    
    struct memblock_device mem_52647;
    
    mem_52647.references = NULL;
    
    struct memblock_device mem_52574;
    
    mem_52574.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    bool zzero_35562 = dz2082U_35539 == (int64_t) 0;
    bool nonzzero_35563 = !zzero_35562;
    bool nonzzero_cert_35564;
    
    if (!nonzzero_35563) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftSkyline.fut:460:75-78\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_35565 = sdiv64(m_sizze_35547, dz2082U_35539);
    int64_t max_res_44287 = smax64((int64_t) 1, max_arg1_35565);
    int64_t min_res_44290 = smin64(dz2082U_35541, max_res_44287);
    int64_t zm_lhs_35571 = add64(dz2082U_35541, min_res_44290);
    int64_t zs_lhs_35573 = sub64(zm_lhs_35571, (int64_t) 1);
    bool zzero_35575 = min_res_44290 == (int64_t) 0;
    bool nonzzero_35576 = !zzero_35575;
    bool nonzzero_cert_35577;
    
    if (!nonzzero_35576) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftSkyline.fut:461:57-64\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t num_iter_35578 = sdiv64(zs_lhs_35573, min_res_44290);
    int64_t bytes_52573 = (int64_t) 8 * dz2082U_35541;
    
    if (memblock_alloc_device(ctx, &mem_52574, bytes_52573, "mem_52574")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_52574, dz2082U_35541, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_43436 = slt64(num_iter_35578, (int64_t) 0);
    bool valid_43437 = !bounds_invalid_upwards_43436;
    bool range_valid_c_43438;
    
    if (!valid_43437) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_iter_35578, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftSkyline.fut:463:77-90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_46544 = slt64(dim_35535, (int64_t) 6);
    int64_t max_tblock_sizze_50084;
    
    max_tblock_sizze_50084 = ctx->max_thread_block_size;
    
    bool fits_50085 = sle64(dz2082U_35539, max_tblock_sizze_50084);
    bool suff_intra_par_50083;
    
    suff_intra_par_50083 = *ctx->tuning_params.filter_against_9751zisuff_intra_par_1 <= dz2082U_35539;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "filter_against_9751.suff_intra_par_1", (long) dz2082U_35539, suff_intra_par_50083 ? "true" : "false");
    
    bool intra_suff_and_fits_50086 = suff_intra_par_50083 && fits_50085;
    int64_t segred_tblock_sizze_50205;
    
    segred_tblock_sizze_50205 = *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152;
    
    int64_t segmap_tblock_sizze_50254;
    
    segmap_tblock_sizze_50254 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50141;
    
    int64_t segmap_tblock_sizze_50033;
    
    segmap_tblock_sizze_50033 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_49983;
    
    bool x_52545 = !cond_46544;
    int64_t binop_y_52578 = dz2082U_35541 - (int64_t) 1;
    int64_t binop_x_52580 = smax64((int64_t) 0, binop_y_52578);
    int64_t binop_y_52581 = dim_35535 - (int64_t) 1;
    int64_t binop_x_52582 = smax64((int64_t) 0, binop_y_52581);
    int64_t binop_y_52583 = dz2082U_35541 * binop_x_52582;
    int64_t binop_y_52584 = smax64((int64_t) 0, binop_y_52583);
    int64_t binop_y_52585 = binop_x_52580 + binop_y_52584;
    int64_t binop_y_52586 = (int64_t) 1 + binop_y_52585;
    int64_t bytes_52587 = (int64_t) 4 * binop_y_52586;
    int64_t binop_y_52589 = dz2082U_35539 - (int64_t) 1;
    int64_t binop_x_52591 = smax64((int64_t) 0, binop_y_52589);
    int64_t binop_y_52594 = dz2082U_35539 * binop_x_52582;
    int64_t binop_y_52595 = smax64((int64_t) 0, binop_y_52594);
    int64_t binop_y_52596 = binop_x_52591 + binop_y_52595;
    int64_t binop_y_52597 = (int64_t) 1 + binop_y_52596;
    int64_t bytes_52598 = (int64_t) 4 * binop_y_52597;
    
    for (int64_t i_35584 = 0; i_35584 < num_iter_35578; i_35584++) {
        int64_t inf_35587 = mul64(i_35584, min_res_44290);
        int64_t min_arg0_35589 = add64(inf_35587, min_res_44290);
        int64_t min_res_44293 = smin64(dz2082U_35541, min_arg0_35589);
        int64_t dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593 = sub64(min_res_44293, inf_35587);
        bool bounds_invalid_upwards_35597 = slt64(min_res_44293, inf_35587);
        bool valid_35602 = !bounds_invalid_upwards_35597;
        bool range_valid_c_35603;
        
        if (!valid_35602) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) inf_35587, "..<", (long long) min_res_44293, " is invalid.", "-> #0  ft_libs/ftSkyline.fut:466:58-67\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool empty_slice_35622 = dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593 == (int64_t) 0;
        int64_t m_35623 = sub64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, (int64_t) 1);
        int64_t i_p_m_t_s_35625 = add64(inf_35587, m_35623);
        bool zzero_leq_i_p_m_t_s_35626 = sle64((int64_t) 0, i_p_m_t_s_35625);
        bool i_p_m_t_s_leq_w_35628 = slt64(i_p_m_t_s_35625, dz2082U_35541);
        bool zzero_lte_i_35629 = sle64((int64_t) 0, inf_35587);
        bool i_lte_j_35630 = sle64(inf_35587, min_res_44293);
        bool y_35631 = i_p_m_t_s_leq_w_35628 && zzero_lte_i_35629;
        bool y_35632 = zzero_leq_i_p_m_t_s_35626 && y_35631;
        bool forwards_ok_35633 = i_lte_j_35630 && y_35632;
        bool ok_or_empty_35640 = empty_slice_35622 || forwards_ok_35633;
        bool index_certs_35642;
        
        if (!ok_or_empty_35640) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_35587, ":", (long long) min_res_44293, "] out of bounds for array of shape [", (long long) dz2082U_35541, "].", "-> #0  ft_libs/ftSkyline.fut:467:55-72\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool suff_outer_par_49979;
        
        suff_outer_par_49979 = *ctx->tuning_params.filter_against_9751zisuff_outer_par_0 <= dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;
        if (ctx->logging)
            fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "filter_against_9751.suff_outer_par_0", (long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, suff_outer_par_49979 ? "true" : "false");
        
        int64_t nest_sizze_50204 = dz2082U_35539 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;
        int64_t num_tblocks_50206;
        int64_t max_num_tblocks_53239;
        
        max_num_tblocks_53239 = *ctx->tuning_params.filter_against_9751zisegred_num_tblocks_50154;
        num_tblocks_50206 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_50204, segred_tblock_sizze_50205), max_num_tblocks_53239)));
        
        int64_t num_threads_53028 = segred_tblock_sizze_50205 * num_tblocks_50206;
        int64_t total_sizze_53029 = dim_35535 * num_threads_53028;
        int64_t total_sizze_53030 = dim_35535 * num_threads_53028;
        int64_t binop_x_53008 = dim_35535 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;
        int64_t total_sizze_53009 = dz2082U_35539 * binop_x_53008;
        int64_t ctx_53015 = dz2082U_35539 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;
        int64_t segmap_usable_groups_50034 = sdiv_up_safe64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, segmap_tblock_sizze_50033);
        int64_t num_threads_52993 = segmap_tblock_sizze_50033 * segmap_usable_groups_50034;
        int64_t total_sizze_52994 = dim_35535 * num_threads_52993;
        int64_t shared_memory_capacity_53392;
        
        shared_memory_capacity_53392 = ctx->max_shared_memory;
        if (suff_outer_par_49979 && sle64((int64_t) 0, shared_memory_capacity_53392)) {
            if (memblock_alloc_device(ctx, &mem_52647, bytes_52587, "mem_52647")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52647.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2082U_35541}, xys_mem_52571.mem, (int64_t) 0, (int64_t []) {dim_35535, (int64_t) 1}, (int64_t []) {dz2082U_35541, dim_35535})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &color_52936, total_sizze_52994, "color_52936")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_53240 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, segmap_tblock_sizze_50033));
            
            {
                err = gpu_kernel_filter_against_9751zisegmap_50037(ctx, segmap_usable_groups_50034, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_49983, 1, 1, (int64_t) 0, dim_35535, dz2082U_35539, dz2082U_35541, inf_35587, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, cond_46544, x_52545, num_threads_52993, xys_mem_52568.mem, mem_52574.mem, mem_52647.mem, color_52936.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_52647, "mem_52647") != 0)
                return 1;
            if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_52588, bytes_52587, "mem_52588")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52588.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2082U_35541}, xys_mem_52571.mem, (int64_t) 0, (int64_t []) {dim_35535, (int64_t) 1}, (int64_t []) {dz2082U_35541, dim_35535})) != 0)
                goto cleanup;
            if (memblock_alloc_device(ctx, &mem_52599, bytes_52598, "mem_52599")) {
                err = 1;
                goto cleanup;
            }
            if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52599.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, dz2082U_35539}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_35535, (int64_t) 1}, (int64_t []) {dz2082U_35539, dim_35535})) != 0)
                goto cleanup;
            
            int64_t shared_memory_capacity_53391;
            
            shared_memory_capacity_53391 = ctx->max_shared_memory;
            if (intra_suff_and_fits_50086 && sle64(sdiv_up64(dz2082U_35539, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_53391)) {
                if (memblock_alloc_device(ctx, &color_52937, total_sizze_53009, "color_52937")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t num_chunks_53256 = sext_i64_i32(sdiv_up64(dz2082U_35539, dz2082U_35539));
                int32_t virt_num_tblocks_53257 = sext_i64_i32(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593);
                
                {
                    err = gpu_kernel_filter_against_9751zisegmap_intrablock_50089(ctx, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, 1, 1, dz2082U_35539, 1, 1, dz2082U_35539 + srem64((int64_t) 8 - srem64(dz2082U_35539, (int64_t) 8), (int64_t) 8), dim_35535, dz2082U_35539, inf_35587, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, cond_46544, x_52545, ctx_53015, xys_mem_52568.mem, xys_mem_52571.mem, mem_52574.mem, color_52937.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &mem_52615, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, "mem_52615")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &color_52938, total_sizze_53029, "color_52938")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &color_52939, total_sizze_53030, "color_52939")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegRed");
                
                int64_t chunk_sizze_53278 = (int64_t) 1;
                
                if (slt64(dz2082U_35539 * (int64_t) 2, segred_tblock_sizze_50205 * chunk_sizze_53278)) {
                    int64_t segment_sizze_nonzzero_53279 = smax64((int64_t) 1, dz2082U_35539);
                    int64_t num_threads_53280 = segred_tblock_sizze_50205 * segred_tblock_sizze_50205;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-small");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2082U_35539, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279), '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, squot64(segred_tblock_sizze_50205, segment_sizze_nonzzero_53279))), '\n');
                    {
                        err = gpu_kernel_filter_against_9751zisegred_small_50211(ctx, num_tblocks_50206, 1, 1, *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152, 1, 1, segred_tblock_sizze_50205 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_50205, (int64_t) 8), (int64_t) 8), dim_35535, dz2082U_35539, dz2082U_35541, inf_35587, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, cond_46544, num_tblocks_50206, x_52545, num_threads_53028, segment_sizze_nonzzero_53279, mem_52588.mem, mem_52599.mem, mem_52615.mem, color_52938.mem, color_52939.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                } else {
                    int64_t blocks_per_segment_53313 = sdiv_up64(num_tblocks_50206, smax64((int64_t) 1, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593));
                    int64_t q_53314 = sdiv_up64(dz2082U_35539, segred_tblock_sizze_50205 * blocks_per_segment_53313 * chunk_sizze_53278);
                    int64_t num_virtblocks_53315 = blocks_per_segment_53313 * dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593;
                    int64_t threads_per_segment_53316 = blocks_per_segment_53313 * segred_tblock_sizze_50205;
                    
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s\n", "# SegRed-large");
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) dz2082U_35539, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_53315, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_50206, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) segred_tblock_sizze_50205, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_53314, '\n');
                    if (ctx->debugging)
                        fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_53313, '\n');
                    if (memblock_alloc_device(ctx, &segred_tmp_mem_53317, num_virtblocks_53315, "segred_tmp_mem_53317")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        err = gpu_kernel_filter_against_9751zisegred_large_50211(ctx, num_tblocks_50206, 1, 1, *ctx->tuning_params.filter_against_9751zisegred_tblock_sizze_50152, 1, 1, 8 + (segred_tblock_sizze_50205 + srem64((int64_t) 8 - srem64(segred_tblock_sizze_50205, (int64_t) 8), (int64_t) 8)), dim_35535, dz2082U_35539, dz2082U_35541, inf_35587, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, cond_46544, num_tblocks_50206, x_52545, num_threads_53028, blocks_per_segment_53313, q_53314, num_virtblocks_53315, threads_per_segment_53316, mem_52588.mem, mem_52599.mem, mem_52615.mem, color_52938.mem, color_52939.mem, segred_tmp_mem_53317.mem, counters_mem_53319.mem);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_50255 = sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, segmap_tblock_sizze_50254);
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegMap");
                
                int32_t virt_num_tblocks_53382 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, segmap_tblock_sizze_50254));
                
                {
                    err = gpu_kernel_filter_against_9751zisegmap_50258(ctx, segmap_usable_groups_50255, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50141, 1, 1, (int64_t) 0, inf_35587, dzlz7bUZLzmZRz20Usupz20Uinfz7dUzg_35593, mem_52574.mem, mem_52615.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
                if (memblock_unref_device(ctx, &mem_52615, "mem_52615") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_52588, "mem_52588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_52599, "mem_52599") != 0)
                return 1;
        }
    }
    
    int64_t segscan_tblock_sizze_50266;
    
    segscan_tblock_sizze_50266 = *ctx->tuning_params.filter_against_9751zisegscan_tblock_sizze_50265;
    
    int64_t num_tblocks_50268;
    int64_t max_num_tblocks_53393;
    
    max_num_tblocks_53393 = *ctx->tuning_params.filter_against_9751zisegscan_num_tblocks_50267;
    num_tblocks_50268 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_35541, segscan_tblock_sizze_50266), max_num_tblocks_53393)));
    if (memblock_alloc_device(ctx, &mem_52671, bytes_52573, "mem_52671")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52673, bytes_52573, "mem_52673")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, dz2082U_35541)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53394;
        
        shared_memory_53394 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53395;
        
        thread_block_sizze_53395 = ctx->max_thread_block_size;
        
        int64_t registers_53396;
        
        registers_53396 = ctx->max_registers;
        
        int64_t thread_block_sizze_53397;
        
        thread_block_sizze_53397 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53398 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53394, thread_block_sizze_53395), (int64_t) 8), squot64(squot64(registers_53396, thread_block_sizze_53397) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53399 = sdiv_up64(dz2082U_35541, segscan_tblock_sizze_50266 * chunk_sizze_53398);
        int64_t num_virt_threads_53400 = num_virt_blocks_53399 * segscan_tblock_sizze_50266;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53398, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53401, num_virt_blocks_53399, "status_flags_mem_53401")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53401, num_virt_blocks_53399, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53423, (int64_t) 8 * num_virt_blocks_53399, "aggregates_mem_53423")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53425, (int64_t) 8 * num_virt_blocks_53399, "incprefixes_mem_53425")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_filter_against_9751zisegscan_50271(ctx, num_tblocks_50268, 1, 1, *ctx->tuning_params.filter_against_9751zisegscan_tblock_sizze_50265, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50266), chunk_sizze_53398 * segscan_tblock_sizze_50266 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_50266), chunk_sizze_53398 * segscan_tblock_sizze_50266 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dz2082U_35541, num_tblocks_50268, num_virt_blocks_53399, num_virt_threads_53400, mem_52574.mem, mem_52671.mem, mem_52673.mem, status_flags_mem_53401.mem, aggregates_mem_53423.mem, incprefixes_mem_53425.mem, global_dynid_mem_53427.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    
    bool cond_45245 = dz2082U_35541 == (int64_t) 0;
    bool x_45246 = !cond_45245;
    bool x_45248 = sle64((int64_t) 0, binop_y_52578);
    bool y_45249 = slt64(binop_y_52578, dz2082U_35541);
    bool bounds_check_45250 = x_45248 && y_45249;
    bool protect_assert_disj_45251 = cond_45245 || bounds_check_45250;
    bool index_certs_45252;
    
    if (!protect_assert_disj_45251) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) binop_y_52578, "] out of bounds for array of shape [", (long long) dz2082U_35541, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_45253;
    
    if (x_45246) {
        int64_t read_res_54113;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_54113, mem_52671.mem, binop_y_52578 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_48219 = read_res_54113;
        
        m_f_res_45253 = x_48219;
    } else {
        m_f_res_45253 = (int64_t) 0;
    }
    
    int64_t m_45255;
    
    if (cond_45245) {
        m_45255 = (int64_t) 0;
    } else {
        m_45255 = m_f_res_45253;
    }
    
    int64_t m_45265 = sub64(m_45255, (int64_t) 1);
    bool i_p_m_t_s_leq_w_45267 = slt64(m_45265, dz2082U_35541);
    bool zzero_leq_i_p_m_t_s_45266 = sle64((int64_t) 0, m_45265);
    bool y_45269 = zzero_leq_i_p_m_t_s_45266 && i_p_m_t_s_leq_w_45267;
    bool i_lte_j_45268 = sle64((int64_t) 0, m_45255);
    bool forwards_ok_45270 = i_lte_j_45268 && y_45269;
    bool eq_x_zz_45262 = (int64_t) 0 == m_f_res_45253;
    bool p_and_eq_x_y_45263 = x_45246 && eq_x_zz_45262;
    bool empty_slice_45264 = cond_45245 || p_and_eq_x_y_45263;
    bool ok_or_empty_45271 = empty_slice_45264 || forwards_ok_45270;
    bool index_certs_45272;
    
    if (!ok_or_empty_45271) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_45255, "] out of bounds for array of shape [", (long long) dz2082U_35541, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_52674 = (int64_t) 8 * m_45255;
    int64_t binop_x_52680 = (int64_t) 4 * m_45255;
    int64_t bytes_52681 = dim_35535 * binop_x_52680;
    
    if (memblock_alloc_device(ctx, &mem_52675, bytes_52674, "mem_52675")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52675.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52574.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_45255})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_50276;
    
    segmap_tblock_sizze_50276 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50275;
    
    int64_t num_tblocks_50278;
    int64_t max_num_tblocks_53516;
    
    max_num_tblocks_53516 = *ctx->tuning_params.filter_against_9751zisegmap_num_tblocks_50277;
    num_tblocks_50278 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dz2082U_35541, segmap_tblock_sizze_50276), max_num_tblocks_53516)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53517 = sext_i64_i32(sdiv_up64(dz2082U_35541, segmap_tblock_sizze_50276));
    
    {
        err = gpu_kernel_filter_against_9751zisegmap_50273(ctx, num_tblocks_50278, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50275, 1, 1, (int64_t) 0, dz2082U_35541, m_45255, num_tblocks_50278, virt_num_tblocks_53517, mem_52574.mem, mem_52671.mem, mem_52673.mem, mem_52675.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52574, "mem_52574") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52671, "mem_52671") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52673, "mem_52673") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_50321;
    
    segmap_tblock_sizze_50321 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50310;
    
    int64_t segmap_usable_groups_50322 = sdiv_up64(m_45255, segmap_tblock_sizze_50321);
    
    if (memblock_alloc_device(ctx, &mem_52678, (int64_t) 0, "mem_52678")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53530 = sext_i64_i32(sdiv_up64(m_45255, segmap_tblock_sizze_50321));
    
    {
        err = gpu_kernel_filter_against_9751zisegmap_50325(ctx, segmap_usable_groups_50322, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50310, 1, 1, (int64_t) 0, dz2082U_35541, m_45255, mem_52675.mem, mem_52678.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t nest_sizze_50332 = dim_35535 * m_45255;
    int64_t segmap_tblock_sizze_50333;
    
    segmap_tblock_sizze_50333 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50298;
    
    int64_t segmap_usable_groups_50334 = sdiv_up64(nest_sizze_50332, segmap_tblock_sizze_50333);
    
    if (memblock_alloc_device(ctx, &mem_52682, bytes_52681, "mem_52682")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53539 = sext_i64_i32(sdiv_up64(m_45255 * dim_35535, segmap_tblock_sizze_50333));
    
    {
        err = gpu_kernel_filter_against_9751zisegmap_50338(ctx, segmap_usable_groups_50334, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50298, 1, 1, (int64_t) 0, dim_35535, m_45255, xys_mem_52571.mem, mem_52675.mem, mem_52678.mem, mem_52682.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_tblock_sizze_50343;
    
    segmap_tblock_sizze_50343 = *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50284;
    
    int64_t segmap_usable_groups_50344 = sdiv_up64(m_45255, segmap_tblock_sizze_50343);
    
    if (memblock_alloc_device(ctx, &mem_52685, bytes_52674, "mem_52685")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53550 = sext_i64_i32(sdiv_up64(m_45255, segmap_tblock_sizze_50343));
    
    {
        err = gpu_kernel_filter_against_9751zisegmap_50347(ctx, segmap_usable_groups_50344, 1, 1, *ctx->tuning_params.filter_against_9751zisegmap_tblock_sizze_50284, 1, 1, (int64_t) 0, m_45255, xys_mem_52572.mem, mem_52675.mem, mem_52678.mem, mem_52685.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52675, "mem_52675") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52678, "mem_52678") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &isPartitionDominated_mem_52570, "isPartitionDominated_mem_52570") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52682, "mem_52682") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52685, "mem_52685") != 0)
        return 1;
    prim_out_53220 = m_45255;
    if (memblock_set_device(ctx, &*mem_out_p_54109, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54110, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54111, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54112 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52685, "mem_52685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52682, "mem_52682") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52678, "mem_52678") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52675, "mem_52675") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53425, "incprefixes_mem_53425") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53423, "aggregates_mem_53423") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53401, "status_flags_mem_53401") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52673, "mem_52673") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52671, "mem_52671") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53317, "segred_tmp_mem_53317") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52615, "mem_52615") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52599, "mem_52599") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52588, "mem_52588") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52647, "mem_52647") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52574, "mem_52574") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_skyline_local_filter_9621(struct futhark_context *ctx, struct memblock_device *mem_out_p_54114, struct memblock_device *mem_out_p_54115, struct memblock_device *mem_out_p_54116, int64_t *out_prim_out_54117, struct memblock_device angle_part_prefix_sum_mem_52561, struct memblock_device angle_partitions_per_dim_mem_52562, struct memblock_device grid_part_prefix_sum_mem_52563, struct memblock_device grid_part_sizze_per_dim_mem_52564, struct memblock_device grid_partitions_per_dim_mem_52565, struct memblock_device start_of_grid_partition_mem_52566, struct memblock_device isPartitionDominated_mem_52567, struct memblock_device xys_mem_52568, struct memblock_device xys_mem_52569, int64_t dim_32139, int64_t dz2080U_32140, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, int64_t dz2081U_32142, int64_t coercez2081Uz2080Uz2084U_32143, int64_t m_sizze_32149, int64_t total_angle_no_32151, int64_t total_grid_no_32152, int64_t total_part_no_32153, bool use_many_points_32157)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_52820;
    
    mem_52820.references = NULL;
    
    struct memblock_device mem_52818;
    
    mem_52818.references = NULL;
    
    struct memblock_device mem_52815;
    
    mem_52815.references = NULL;
    
    struct memblock_device mem_52813;
    
    mem_52813.references = NULL;
    
    struct memblock_device incprefixes_mem_53670;
    
    incprefixes_mem_53670.references = NULL;
    
    struct memblock_device aggregates_mem_53668;
    
    aggregates_mem_53668.references = NULL;
    
    struct memblock_device status_flags_mem_53646;
    
    status_flags_mem_53646.references = NULL;
    
    struct memblock_device color_52942;
    
    color_52942.references = NULL;
    
    struct memblock_device color_52941;
    
    color_52941.references = NULL;
    
    struct memblock_device mem_52810;
    
    mem_52810.references = NULL;
    
    struct memblock_device mem_52808;
    
    mem_52808.references = NULL;
    
    struct memblock_device mem_52770;
    
    mem_52770.references = NULL;
    
    struct memblock_device color_52940;
    
    color_52940.references = NULL;
    
    struct memblock_device color_52939;
    
    color_52939.references = NULL;
    
    struct memblock_device color_52938;
    
    color_52938.references = NULL;
    
    struct memblock_device color_52937;
    
    color_52937.references = NULL;
    
    struct memblock_device mem_52759;
    
    mem_52759.references = NULL;
    
    struct memblock_device color_52936;
    
    color_52936.references = NULL;
    
    struct memblock_device mem_52705;
    
    mem_52705.references = NULL;
    
    struct memblock_device segred_tmp_mem_53551;
    
    segred_tmp_mem_53551.references = NULL;
    
    struct memblock_device segred_tmp_mem_53549;
    
    segred_tmp_mem_53549.references = NULL;
    
    struct memblock_device defunc_0_map_res_subhistos_mem_53378;
    
    defunc_0_map_res_subhistos_mem_53378.references = NULL;
    
    struct memblock_device defunc_0_map_res_subhistos_mem_53376;
    
    defunc_0_map_res_subhistos_mem_53376.references = NULL;
    
    struct memblock_device mem_52687;
    
    mem_52687.references = NULL;
    
    struct memblock_device mem_52685;
    
    mem_52685.references = NULL;
    
    struct memblock_device mem_52683;
    
    mem_52683.references = NULL;
    
    struct memblock_device mem_52680;
    
    mem_52680.references = NULL;
    
    struct memblock_device mem_52669;
    
    mem_52669.references = NULL;
    
    struct memblock_device mem_param_tmp_53304;
    
    mem_param_tmp_53304.references = NULL;
    
    struct memblock_device mem_52661;
    
    mem_52661.references = NULL;
    
    struct memblock_device mem_52649;
    
    mem_52649.references = NULL;
    
    struct memblock_device mem_52627;
    
    mem_52627.references = NULL;
    
    struct memblock_device mem_param_52623;
    
    mem_param_52623.references = NULL;
    
    struct memblock_device ext_mem_52665;
    
    ext_mem_52665.references = NULL;
    
    struct memblock_device mem_52638;
    
    mem_52638.references = NULL;
    
    struct memblock_device mem_52619;
    
    mem_52619.references = NULL;
    
    struct memblock_device mem_52616;
    
    mem_52616.references = NULL;
    
    struct memblock_device mem_52613;
    
    mem_52613.references = NULL;
    
    struct memblock_device mem_52602;
    
    mem_52602.references = NULL;
    
    struct memblock_device mem_52599;
    
    mem_52599.references = NULL;
    
    struct memblock_device mem_52595;
    
    mem_52595.references = NULL;
    
    struct memblock_device mem_52591;
    
    mem_52591.references = NULL;
    
    struct memblock_device mem_52589;
    
    mem_52589.references = NULL;
    
    struct memblock_device mem_52587;
    
    mem_52587.references = NULL;
    
    struct memblock_device mem_52576;
    
    mem_52576.references = NULL;
    
    struct memblock_device mem_52572;
    
    mem_52572.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
    struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
    struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
    struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
    struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
    struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
    struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
    struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
    struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
    struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
    struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
    struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
    struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
    struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
    struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
    struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
    struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
    struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
    struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
    int64_t prim_out_53220;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 = sub64(dim_32139, (int64_t) 1);
    int64_t segmap_tblock_sizze_50684;
    
    segmap_tblock_sizze_50684 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50670;
    
    int64_t segmap_usable_groups_50685 = sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, segmap_tblock_sizze_50684);
    int64_t bytes_52571 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141;
    
    if (memblock_alloc_device(ctx, &mem_52572, bytes_52571, "mem_52572")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53221 = sext_i64_i32(sdiv_up64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, segmap_tblock_sizze_50684));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_50688(ctx, segmap_usable_groups_50685, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50670, 1, 1, (int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141, angle_partitions_per_dim_mem_52562.mem, mem_52572.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    bool dim_match_46414 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32141;
    bool empty_or_match_cert_46415;
    
    if (!dim_match_46414) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ft_libs/ftSkyline.fut:172:33-44\n   #1  ft_libs/ftSkyline.fut:180:26-183:84\n   #2  ft_libs/ftSkyline.fut:269:26-276:83\n   #3  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_47751 = slt64((int64_t) 0, dz2080U_32140);
    bool index_certs_47752;
    
    if (!y_47751) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_32140, "].", "-> #0  ft_libs/ftSkyline.fut:143:39-69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t nest_sizze_51073 = dim_32139 * coercez2081Uz2080Uz2084U_32143;
    int64_t segmap_tblock_sizze_51074;
    
    segmap_tblock_sizze_51074 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51020;
    
    int64_t segmap_usable_groups_51075 = sdiv_up64(nest_sizze_51073, segmap_tblock_sizze_51074);
    int64_t binop_x_52574 = (int64_t) 8 * coercez2081Uz2080Uz2084U_32143;
    int64_t bytes_52575 = dim_32139 * binop_x_52574;
    
    if (memblock_alloc_device(ctx, &mem_52576, bytes_52575, "mem_52576")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53230 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dim_32139, segmap_tblock_sizze_51074));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51079(ctx, segmap_usable_groups_51075, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51020, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, grid_part_prefix_sum_mem_52563.mem, grid_part_sizze_per_dim_mem_52564.mem, grid_partitions_per_dim_mem_52565.mem, start_of_grid_partition_mem_52566.mem, xys_mem_52568.mem, mem_52576.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    
    int64_t segmap_tblock_sizze_51099;
    
    segmap_tblock_sizze_51099 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50992;
    
    int64_t segmap_usable_groups_51100 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51099);
    int64_t binop_y_52577 = coercez2081Uz2080Uz2084U_32143 - (int64_t) 1;
    int64_t binop_x_52579 = smax64((int64_t) 0, binop_y_52577);
    int64_t binop_x_52581 = smax64((int64_t) 0, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403);
    int64_t binop_y_52582 = coercez2081Uz2080Uz2084U_32143 * binop_x_52581;
    int64_t binop_y_52583 = smax64((int64_t) 0, binop_y_52582);
    int64_t binop_y_52584 = binop_x_52579 + binop_y_52583;
    int64_t binop_y_52585 = (int64_t) 1 + binop_y_52584;
    int64_t bytes_52586 = (int64_t) 8 * binop_y_52585;
    
    if (memblock_alloc_device(ctx, &mem_52587, bytes_52586, "mem_52587")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_52587.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, mem_52576.mem, (int64_t) 0, (int64_t []) {dim_32139, (int64_t) 1}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dim_32139})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_52576, "mem_52576") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52589, (int64_t) 0, "mem_52589")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52591, binop_x_52574, "mem_52591")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53241 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51099));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51104(ctx, segmap_usable_groups_51100, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50992, 1, 1, (int64_t) 0, dim_32139, dz2080U_32140, coercez2081Uz2080Uz2084U_32143, mem_52587.mem, mem_52589.mem, mem_52591.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52587, "mem_52587") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51117;
    
    segmap_tblock_sizze_51117 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50979;
    
    int64_t segmap_usable_groups_51118 = sdiv_up64(nest_sizze_51073, segmap_tblock_sizze_51117);
    int64_t binop_x_52593 = (int64_t) 4 * coercez2081Uz2080Uz2084U_32143;
    int64_t bytes_52594 = dim_32139 * binop_x_52593;
    
    if (memblock_alloc_device(ctx, &mem_52595, bytes_52594, "mem_52595")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53251 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dim_32139, segmap_tblock_sizze_51117));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51122(ctx, segmap_usable_groups_51118, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50979, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, start_of_grid_partition_mem_52566.mem, mem_52589.mem, mem_52591.mem, mem_52595.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52589, "mem_52589") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51132;
    
    segmap_tblock_sizze_51132 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50949;
    
    int64_t segmap_usable_groups_51133 = sdiv_up64(nest_sizze_51073, segmap_tblock_sizze_51132);
    
    if (memblock_alloc_device(ctx, &mem_52599, bytes_52594, "mem_52599")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52602, bytes_52594, "mem_52602")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53262 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dim_32139, segmap_tblock_sizze_51132));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51138(ctx, segmap_usable_groups_51133, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50949, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, xys_mem_52568.mem, mem_52595.mem, mem_52599.mem, mem_52602.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52595, "mem_52595") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51146;
    
    segmap_tblock_sizze_51146 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50923;
    
    int64_t segmap_usable_groups_51147 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51146);
    int64_t bytes_52612 = (int64_t) 4 * binop_y_52585;
    
    if (memblock_alloc_device(ctx, &mem_52613, bytes_52612, "mem_52613")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52613.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, mem_52599.mem, (int64_t) 0, (int64_t []) {dim_32139, (int64_t) 1}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dim_32139})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_52599, "mem_52599") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52616, binop_x_52593, "mem_52616")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53273 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51146));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51150(ctx, segmap_usable_groups_51147, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50923, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, mem_52613.mem, mem_52616.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52613, "mem_52613") != 0)
        return 1;
    
    int64_t bytes_52618 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 * binop_x_52593;
    
    if (memblock_alloc_device(ctx, &mem_52619, bytes_52618, "mem_52619")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_52619, coercez2081Uz2080Uz2084U_32143 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, 0.0F) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_51187;
    
    segmap_tblock_sizze_51187 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50868;
    
    int64_t segmap_tblock_sizze_51197;
    
    segmap_tblock_sizze_51197 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50837;
    
    int64_t num_tblocks_51198;
    int64_t max_num_tblocks_53303;
    
    max_num_tblocks_53303 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_50839;
    num_tblocks_51198 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51197), max_num_tblocks_53303)));
    
    int64_t binop_y_52631 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 - (int64_t) 1;
    int64_t binop_x_52632 = smax64((int64_t) 0, binop_y_52631);
    int64_t binop_y_52633 = coercez2081Uz2080Uz2084U_32143 * binop_x_52632;
    int64_t binop_y_52634 = smax64((int64_t) 0, binop_y_52633);
    int64_t binop_y_52635 = binop_x_52579 + binop_y_52634;
    int64_t binop_y_52636 = (int64_t) 1 + binop_y_52635;
    int64_t bytes_52637 = (int64_t) 4 * binop_y_52636;
    
    if (memblock_alloc_device(ctx, &mem_52638, bytes_52637, "mem_52638")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t ext_52663;
    int64_t ext_52662;
    int64_t ctx_param_ext_52621;
    int64_t ctx_param_ext_52622;
    
    if (memblock_set_device(ctx, &mem_param_52623, &mem_52619, "mem_52619") != 0)
        return 1;
    ctx_param_ext_52621 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403;
    ctx_param_ext_52622 = (int64_t) 1;
    for (int64_t i_51161 = 0; i_51161 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403; i_51161++) {
        int64_t arg_51163 = add64((int64_t) 1, i_51161);
        int64_t dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164 = sub64(dim_32139, arg_51163);
        bool y_51165 = slt64(i_51161, dim_32139);
        bool index_certs_51166;
        
        if (!y_51165) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_51161, "] out of bounds for array of shape [", (long long) dim_32139, "].", "-> #0  ft_libs/ftSkyline.fut:133:54-63\n   #1  ft_libs/ftSkyline.fut:160:49-79\n   #2  ft_libs/ftSkyline.fut:180:26-183:84\n   #3  ft_libs/ftSkyline.fut:269:26-276:83\n   #4  /prelude/functional.fut:9:44-45\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool empty_slice_51167 = dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164 == (int64_t) 0;
        int64_t m_51168 = sub64(dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, (int64_t) 1);
        int64_t i_p_m_t_s_51169 = add64(arg_51163, m_51168);
        bool zzero_leq_i_p_m_t_s_51170 = sle64((int64_t) 0, i_p_m_t_s_51169);
        bool i_p_m_t_s_leq_w_51171 = slt64(i_p_m_t_s_51169, dim_32139);
        bool zzero_lte_i_51172 = sle64((int64_t) 0, arg_51163);
        bool i_lte_j_51173 = sle64(arg_51163, dim_32139);
        bool y_51174 = i_p_m_t_s_leq_w_51171 && zzero_lte_i_51172;
        bool y_51175 = zzero_leq_i_p_m_t_s_51170 && y_51174;
        bool forwards_ok_51176 = i_lte_j_51173 && y_51175;
        bool ok_or_empty_51177 = empty_slice_51167 || forwards_ok_51176;
        bool index_certs_51178;
        
        if (!ok_or_empty_51177) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_51163, ":", (long long) dim_32139, "] out of bounds for array of shape [", (long long) dim_32139, "].", "-> #0  ft_libs/ftSkyline.fut:134:54-71\n   #1  ft_libs/ftSkyline.fut:160:49-79\n   #2  ft_libs/ftSkyline.fut:180:26-183:84\n   #3  ft_libs/ftSkyline.fut:269:26-276:83\n   #4  /prelude/functional.fut:9:44-45\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_52626 = dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164 * binop_x_52593;
        int64_t binop_x_52643 = smax64((int64_t) 0, m_51168);
        int64_t binop_y_52644 = coercez2081Uz2080Uz2084U_32143 * binop_x_52643;
        int64_t binop_y_52645 = smax64((int64_t) 0, binop_y_52644);
        int64_t binop_y_52646 = binop_x_52579 + binop_y_52645;
        int64_t binop_y_52647 = (int64_t) 1 + binop_y_52646;
        int64_t bytes_52648 = (int64_t) 4 * binop_y_52647;
        int64_t binop_y_52658 = binop_x_52579 + binop_y_52634;
        int64_t binop_y_52659 = (int64_t) 1 + binop_y_52658;
        int64_t bytes_52660 = (int64_t) 4 * binop_y_52659;
        int64_t nest_sizze_51186 = coercez2081Uz2080Uz2084U_32143 * dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164;
        int64_t segmap_usable_groups_51188 = sdiv_up64(nest_sizze_51186, segmap_tblock_sizze_51187);
        
        if (memblock_alloc_device(ctx, &mem_52627, bytes_52626, "mem_52627")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_53308 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, segmap_tblock_sizze_51187));
        
        {
            err = gpu_kernel_skyline_local_filter_9621zisegmap_51192(ctx, segmap_usable_groups_51188, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50868, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, arg_51163, dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, mem_52602.mem, mem_52627.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52638.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, mem_param_52623.mem, (int64_t) 0, (int64_t []) {ctx_param_ext_52621, ctx_param_ext_52622}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403})) != 0)
            goto cleanup;
        if (memblock_alloc_device(ctx, &mem_52649, bytes_52648, "mem_52649")) {
            err = 1;
            goto cleanup;
        }
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52649.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, mem_52627.mem, (int64_t) 0, (int64_t []) {dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, (int64_t) 1}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164})) != 0)
            goto cleanup;
        if (memblock_unref_device(ctx, &mem_52627, "mem_52627") != 0)
            return 1;
        if (memblock_alloc_device(ctx, &mem_52661, bytes_52660, "mem_52661")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_53319 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51197));
        
        {
            err = gpu_kernel_skyline_local_filter_9621zisegmap_51202(ctx, num_tblocks_51198, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50837, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, i_51161, dzlz7bUZLzmZRz20Udimz20UZLZLzpZRz20Ujz20U1ZRz7dUzg_51164, num_tblocks_51198, virt_num_tblocks_53319, mem_52602.mem, mem_52638.mem, mem_52649.mem, mem_52661.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &mem_52649, "mem_52649") != 0)
            return 1;
        if (memblock_set_device(ctx, &mem_param_tmp_53304, &mem_52661, "mem_52661") != 0)
            return 1;
        
        int64_t ctx_param_ext_tmp_53305 = (int64_t) 1;
        int64_t ctx_param_ext_tmp_53306 = coercez2081Uz2080Uz2084U_32143;
        
        if (memblock_set_device(ctx, &mem_param_52623, &mem_param_tmp_53304, "mem_param_tmp_53304") != 0)
            return 1;
        ctx_param_ext_52621 = ctx_param_ext_tmp_53305;
        ctx_param_ext_52622 = ctx_param_ext_tmp_53306;
    }
    if (memblock_set_device(ctx, &ext_mem_52665, &mem_param_52623, "mem_param_52623") != 0)
        return 1;
    ext_52663 = ctx_param_ext_52621;
    ext_52662 = ctx_param_ext_52622;
    if (memblock_unref_device(ctx, &mem_52602, "mem_52602") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52619, "mem_52619") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52638, "mem_52638") != 0)
        return 1;
    
    int64_t nest_sizze_51220 = coercez2081Uz2080Uz2084U_32143 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403;
    int64_t segmap_tblock_sizze_51221;
    
    segmap_tblock_sizze_51221 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50785;
    
    int64_t segmap_usable_groups_51222 = sdiv_up64(nest_sizze_51220, segmap_tblock_sizze_51221);
    int64_t bytes_52668 = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403 * binop_x_52574;
    
    if (memblock_alloc_device(ctx, &mem_52669, bytes_52668, "mem_52669")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53333 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, segmap_tblock_sizze_51221));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51226(ctx, segmap_usable_groups_51222, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50785, 1, 1, (int64_t) 0, coercez2081Uz2080Uz2084U_32143, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, ext_52662, ext_52663, angle_part_prefix_sum_mem_52561.mem, angle_partitions_per_dim_mem_52562.mem, mem_52572.mem, ext_mem_52665.mem, mem_52669.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52572, "mem_52572") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ext_mem_52665, "ext_mem_52665") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51242;
    
    segmap_tblock_sizze_51242 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50757;
    
    int64_t segmap_usable_groups_51243 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51242);
    int64_t bytes_52679 = (int64_t) 8 * binop_y_52636;
    
    if (memblock_alloc_device(ctx, &mem_52680, bytes_52679, "mem_52680")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_52680.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, mem_52669.mem, (int64_t) 0, (int64_t []) {dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, (int64_t) 1}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403})) != 0)
        goto cleanup;
    if (memblock_unref_device(ctx, &mem_52669, "mem_52669") != 0)
        return 1;
    if (memblock_alloc_device(ctx, &mem_52683, binop_x_52574, "mem_52683")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53344 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51242));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51246(ctx, segmap_usable_groups_51243, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_50757, 1, 1, (int64_t) 0, coercez2081Uz2080Uz2084U_32143, total_angle_no_32151, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_46403, mem_52591.mem, mem_52680.mem, mem_52683.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52591, "mem_52591") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52680, "mem_52680") != 0)
        return 1;
    
    bool bounds_invalid_upwards_45147 = slt64(total_part_no_32153, (int64_t) 0);
    bool valid_45148 = !bounds_invalid_upwards_45147;
    bool range_valid_c_45149;
    
    if (!valid_45148) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_32153, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_52684 = (int64_t) 8 * total_part_no_32153;
    
    if (memblock_alloc_device(ctx, &mem_52685, bytes_52684, "mem_52685")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_52685, total_part_no_32153, coercez2081Uz2080Uz2084U_32143) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_52686 = (int64_t) 4 * total_part_no_32153;
    
    if (memblock_alloc_device(ctx, &mem_52687, bytes_52686, "mem_52687")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f32(ctx, mem_52687, total_part_no_32153, INFINITY) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t seghist_tblock_sizze_51258;
    
    seghist_tblock_sizze_51258 = *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257;
    
    int64_t num_tblocks_51260;
    int64_t max_num_tblocks_53374;
    
    max_num_tblocks_53374 = *ctx->tuning_params.skyline_local_filter_9621ziseghist_num_tblocks_51259;
    num_tblocks_51260 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(coercez2081Uz2080Uz2084U_32143, seghist_tblock_sizze_51258), max_num_tblocks_53374)));
    
    int64_t num_subhistos_53375;
    int64_t h_53380 = (int64_t) 8 * total_part_no_32153 + (int64_t) 4 * total_part_no_32153;
    int64_t seg_h_53381 = (int64_t) 8 * total_part_no_32153 + (int64_t) 4 * total_part_no_32153;
    
    if (!(seg_h_53381 == (int64_t) 0)) {
        int64_t hist_H_53382 = total_part_no_32153;
        int64_t hist_el_sizze_53383 = sdiv_up64(h_53380, hist_H_53382) + (int64_t) 4;
        int64_t hist_N_53384 = coercez2081Uz2080Uz2084U_32143;
        int32_t hist_RF_53385 = 1;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegHist");
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Number of threads (T)", (long long) sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258), '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Desired block size (B)", (long long) seghist_tblock_sizze_51258, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_53382, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Input elements per histogram (N)", (long long) hist_N_53384, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Number of segments", (long long) (int64_t) 1, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Histogram element size (el_size)", (long long) hist_el_sizze_53383, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Race factor (RF)", (long long) hist_RF_53385, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms per segment", (long long) h_53380, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Memory per set of subhistograms times segments", (long long) seg_h_53381, '\n');
        
        int64_t hist_L_53386;
        
        hist_L_53386 = *ctx->tuning_params.skyline_local_filter_9621zihist_L_53386;
        
        int64_t max_tblock_sizze_53387;
        
        max_tblock_sizze_53387 = ctx->max_thread_block_size;
        
        int64_t num_tblocks_53388 = sdiv_up64(sext_i32_i64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258)), max_tblock_sizze_53387);
        double hist_m_prime_53389 = sitofp_i64_f64(smin64(squot64(hist_L_53386, hist_el_sizze_53383), sdiv_up64(hist_N_53384, num_tblocks_53388))) / sitofp_i64_f64(hist_H_53382);
        int64_t hist_M0_53390 = smax64((int64_t) 1, smin64(fptosi_f64_i64(hist_m_prime_53389), max_tblock_sizze_53387));
        int64_t hist_Nout_53391 = (int64_t) 1;
        int64_t hist_Nin_53392 = coercez2081Uz2080Uz2084U_32143;
        int64_t work_asymp_M_max_53393 = squot64(hist_Nout_53391 * hist_N_53384, (int64_t) 2 * num_tblocks_53388 * hist_H_53382);
        int32_t hist_M_53394 = sext_i64_i32(smin64(hist_M0_53390, work_asymp_M_max_53393));
        int64_t hist_C_53395 = sdiv_up64(max_tblock_sizze_53387, sext_i32_i64(smax32(1, hist_M_53394)));
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local hist_M0", (long long) hist_M0_53390, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local work asymp M max", (long long) work_asymp_M_max_53393, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local C", (long long) hist_C_53395, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local B", (long long) max_tblock_sizze_53387, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "local M", (long long) hist_M_53394, '\n');
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "shared memory needed", (long long) (hist_H_53382 * hist_el_sizze_53383 * sext_i32_i64(hist_M_53394)), '\n');
        
        int64_t local_mem_needed_53396 = hist_el_sizze_53383 * sext_i32_i64(hist_M_53394);
        int32_t hist_S_53397 = sext_i64_i32(sdiv_up64(hist_H_53382 * local_mem_needed_53396 + (int64_t) 1, hist_L_53386));
        
        if (sle64(hist_H_53382, hist_Nin_53392) && (sle64(local_mem_needed_53396, hist_L_53386) && (sle32(hist_S_53397, 6) && (sle64(hist_C_53395, max_tblock_sizze_53387) && slt32(0, hist_M_53394))))) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "## Using shared memory");
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Histogram size (H)", (long long) hist_H_53382, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_53394, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Cooperation level (C)", (long long) hist_C_53395, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_53397, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of local subhistograms per block", (long long) hist_M_53394, '\n');
            num_subhistos_53375 = num_tblocks_53388;
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of subhistograms in global memory per segment", (long long) num_subhistos_53375, '\n');
            if (num_subhistos_53375 == (int64_t) 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53376, &mem_52685, "mem_52685") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53376, num_subhistos_53375 * total_part_no_32153 * (int64_t) 8, "defunc_0_map_res_subhistos_mem_53376")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, defunc_0_map_res_subhistos_mem_53376, num_subhistos_53375 * total_part_no_32153, coercez2081Uz2080Uz2084U_32143) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, defunc_0_map_res_subhistos_mem_53376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_part_no_32153})) != 0)
                    goto cleanup;
            }
            if (num_subhistos_53375 == (int64_t) 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53378, &mem_52687, "mem_52687") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53378, num_subhistos_53375 * total_part_no_32153 * (int64_t) 4, "defunc_0_map_res_subhistos_mem_53378")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_f32(ctx, defunc_0_map_res_subhistos_mem_53378, num_subhistos_53375 * total_part_no_32153, INFINITY) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, defunc_0_map_res_subhistos_mem_53378.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52687.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_part_no_32153})) != 0)
                    goto cleanup;
            }
            for (int32_t chk_i_53398 = 0; chk_i_53398 < hist_S_53397; chk_i_53398++) {
                int64_t num_segments_53399 = (int64_t) 1;
                int64_t hist_H_chk_53400 = sdiv_up64(total_part_no_32153, sext_i32_i64(hist_S_53397));
                int64_t histo_sizze_53401 = hist_H_chk_53400;
                int32_t init_per_thread_53402 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_53394) * histo_sizze_53401, max_tblock_sizze_53387));
                
                {
                    err = gpu_kernel_skyline_local_filter_9621ziseghist_local_51265(ctx, num_tblocks_53388, 1, 1, ctx->max_thread_block_size, 1, 1, (int64_t) 4 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8) + ((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 4 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * (hist_M_53394 * hist_H_chk_53400) + srem64((int64_t) 8 - srem64((int64_t) 8 * (hist_M_53394 * hist_H_chk_53400), (int64_t) 8), (int64_t) 8)), coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_subhistos_53375, num_tblocks_53388, hist_M_53394, chk_i_53398, num_segments_53399, hist_H_chk_53400, histo_sizze_53401, init_per_thread_53402, mem_52616.mem, mem_52683.mem, defunc_0_map_res_subhistos_mem_53376.mem, defunc_0_map_res_subhistos_mem_53378.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
        } else {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "## Using global memory");
            
            int64_t hist_H_53448 = total_part_no_32153;
            double hist_RF_53449 = (0.0 + sitofp_i32_f64((int64_t) 1)) / 1.0;
            int32_t hist_el_sizze_53450 = 5;
            double hist_C_max_53451 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258)), sitofp_i32_f64(hist_H_53448) / 2.0);
            int32_t hist_M_min_53452 = smax32(1, sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258)) / hist_C_max_53451)));
            int64_t hist_L2_53453;
            
            hist_L2_53453 = *ctx->tuning_params.skyline_local_filter_9621zihist_L2_53453;
            
            double hist_RACE_exp_53454 = fmax64(1.0, 0.75 * hist_RF_53449 / (64.0 / sitofp_i32_f64(hist_el_sizze_53450)));
            int32_t hist_S_53455;
            
            if (slt64(coercez2081Uz2080Uz2084U_32143, hist_H_53448)) {
                hist_S_53455 = 1;
            } else {
                hist_S_53455 = sext_i64_i32(sdiv_up64(sext_i32_i64(hist_M_min_53452) * hist_H_53448 * sext_i32_i64(hist_el_sizze_53450), fptosi_f64_i64(0.4 * sitofp_i32_f64(hist_L2_53453) * hist_RACE_exp_53454)));
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c", "Race expansion factor (RACE^exp)", (double) hist_RACE_exp_53454, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Number of chunks (S)", (long long) hist_S_53455, '\n');
            
            int64_t hist_H_chk_53456 = sdiv_up64(total_part_no_32153, sext_i32_i64(hist_S_53455));
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Chunk size (H_chk)", (long long) hist_H_chk_53456, '\n');
            
            double hist_k_max_53457 = fmin64(0.4 * (sitofp_i32_f64(hist_L2_53453) / sitofp_i32_f64(16)) * hist_RACE_exp_53454, sitofp_i32_f64(coercez2081Uz2080Uz2084U_32143)) / sitofp_i32_f64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258));
            int64_t hist_u_53458 = (int64_t) 1;
            double hist_C_53459 = fmin64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258)), sitofp_i32_f64(hist_u_53458 * hist_H_chk_53456) / hist_k_max_53457);
            int32_t hist_M_53460 = smax32(hist_M_min_53452, sext_i64_i32(fptosi_f64_i64(sitofp_i32_f64(sext_i64_i32(num_tblocks_51260 * seghist_tblock_sizze_51258)) / hist_C_53459)));
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c", "Elements/thread in L2 cache (k_max)", (double) hist_k_max_53457, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Multiplication degree (M)", (long long) hist_M_53460, '\n');
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %f%c", "Cooperation level (C)", (double) hist_C_53459, '\n');
            num_subhistos_53375 = sext_i32_i64(hist_M_53460);
            if (hist_M_53460 == 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53376, &mem_52685, "mem_52685") != 0)
                    return 1;
            } else if (num_subhistos_53375 == (int64_t) 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53376, &mem_52685, "mem_52685") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53376, num_subhistos_53375 * total_part_no_32153 * (int64_t) 8, "defunc_0_map_res_subhistos_mem_53376")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i64(ctx, defunc_0_map_res_subhistos_mem_53376, num_subhistos_53375 * total_part_no_32153, coercez2081Uz2080Uz2084U_32143) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, defunc_0_map_res_subhistos_mem_53376.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52685.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_part_no_32153})) != 0)
                    goto cleanup;
            }
            if (hist_M_53460 == 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53378, &mem_52687, "mem_52687") != 0)
                    return 1;
            } else if (num_subhistos_53375 == (int64_t) 1) {
                if (memblock_set_device(ctx, &defunc_0_map_res_subhistos_mem_53378, &mem_52687, "mem_52687") != 0)
                    return 1;
            } else {
                if (memblock_alloc_device(ctx, &defunc_0_map_res_subhistos_mem_53378, num_subhistos_53375 * total_part_no_32153 * (int64_t) 4, "defunc_0_map_res_subhistos_mem_53378")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_f32(ctx, defunc_0_map_res_subhistos_mem_53378, num_subhistos_53375 * total_part_no_32153, INFINITY) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, defunc_0_map_res_subhistos_mem_53378.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_52687.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {total_part_no_32153})) != 0)
                    goto cleanup;
            }
            for (int32_t chk_i_53483 = 0; chk_i_53483 < hist_S_53455; chk_i_53483++) {
                int64_t hist_H_chk_53484 = sdiv_up64(total_part_no_32153, sext_i32_i64(hist_S_53455));
                
                {
                    err = gpu_kernel_skyline_local_filter_9621ziseghist_global_51265(ctx, num_tblocks_51260, 1, 1, *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257, 1, 1, (int64_t) 0, coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_tblocks_51260, num_subhistos_53375, chk_i_53483, hist_H_chk_53484, mem_52616.mem, mem_52683.mem, defunc_0_map_res_subhistos_mem_53376.mem, defunc_0_map_res_subhistos_mem_53378.mem, hist_locks_mem_53461.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
        }
        if (num_subhistos_53375 == (int64_t) 1) {
            if (memblock_set_device(ctx, &mem_52685, &defunc_0_map_res_subhistos_mem_53376, "defunc_0_map_res_subhistos_mem_53376") != 0)
                return 1;
            if (memblock_set_device(ctx, &mem_52687, &defunc_0_map_res_subhistos_mem_53378, "defunc_0_map_res_subhistos_mem_53378") != 0)
                return 1;
        } else {
            int64_t chunk_sizze_53501 = (int64_t) 1;
            
            if (slt64(num_subhistos_53375 * (int64_t) 2, seghist_tblock_sizze_51258 * chunk_sizze_53501)) {
                int64_t segment_sizze_nonzzero_53502 = smax64((int64_t) 1, num_subhistos_53375);
                int64_t num_threads_53503 = seghist_tblock_sizze_51258 * seghist_tblock_sizze_51258;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-small");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_part_no_32153, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_53375, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segments_per_block", (long long) squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502), '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "required_blocks", (long long) sext_i64_i32(sdiv_up64(total_part_no_32153, squot64(seghist_tblock_sizze_51258, segment_sizze_nonzzero_53502))), '\n');
                {
                    err = gpu_kernel_skyline_local_filter_9621zisegred_small_53500(ctx, num_tblocks_51260, 1, 1, *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257, 1, 1, (int64_t) 4 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8) + ((int64_t) 8 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8)), coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_tblocks_51260, num_subhistos_53375, segment_sizze_nonzzero_53502, mem_52685.mem, mem_52687.mem, defunc_0_map_res_subhistos_mem_53376.mem, defunc_0_map_res_subhistos_mem_53378.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            } else {
                int64_t blocks_per_segment_53545 = sdiv_up64(num_tblocks_51260, smax64((int64_t) 1, total_part_no_32153));
                int64_t q_53546 = sdiv_up64(num_subhistos_53375, seghist_tblock_sizze_51258 * blocks_per_segment_53545 * chunk_sizze_53501);
                int64_t num_virtblocks_53547 = blocks_per_segment_53545 * total_part_no_32153;
                int64_t threads_per_segment_53548 = blocks_per_segment_53545 * seghist_tblock_sizze_51258;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "# SegRed-large");
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_segments", (long long) total_part_no_32153, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "segment_size", (long long) num_subhistos_53375, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_virtblocks", (long long) num_virtblocks_53547, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "num_tblocks", (long long) num_tblocks_51260, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "tblock_size", (long long) seghist_tblock_sizze_51258, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "q", (long long) q_53546, '\n');
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "blocks_per_segment", (long long) blocks_per_segment_53545, '\n');
                if (memblock_alloc_device(ctx, &segred_tmp_mem_53549, (int64_t) 8 * num_virtblocks_53547, "segred_tmp_mem_53549")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &segred_tmp_mem_53551, (int64_t) 4 * num_virtblocks_53547, "segred_tmp_mem_53551")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_skyline_local_filter_9621zisegred_large_53500(ctx, num_tblocks_51260, 1, 1, *ctx->tuning_params.skyline_local_filter_9621ziseghist_tblock_sizze_51257, 1, 1, 8 + ((int64_t) 4 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 4 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * seghist_tblock_sizze_51258 + srem64((int64_t) 8 - srem64((int64_t) 8 * seghist_tblock_sizze_51258, (int64_t) 8), (int64_t) 8)), coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_tblocks_51260, num_subhistos_53375, blocks_per_segment_53545, q_53546, num_virtblocks_53547, threads_per_segment_53548, mem_52685.mem, mem_52687.mem, defunc_0_map_res_subhistos_mem_53376.mem, defunc_0_map_res_subhistos_mem_53378.mem, segred_tmp_mem_53549.mem, segred_tmp_mem_53551.mem, counters_mem_53553.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
            }
        }
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52616, "mem_52616") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52687, "mem_52687") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51302;
    
    segmap_tblock_sizze_51302 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51286;
    
    int64_t num_tblocks_51303;
    int64_t max_num_tblocks_53603;
    
    max_num_tblocks_53603 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51288;
    num_tblocks_51303 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(total_part_no_32153, segmap_tblock_sizze_51302), max_num_tblocks_53603)));
    
    int64_t binop_y_52695 = total_part_no_32153 - (int64_t) 1;
    int64_t binop_x_52697 = smax64((int64_t) 0, binop_y_52695);
    int64_t binop_y_52700 = total_part_no_32153 * binop_x_52581;
    int64_t binop_y_52701 = smax64((int64_t) 0, binop_y_52700);
    int64_t binop_y_52702 = binop_x_52697 + binop_y_52701;
    int64_t binop_y_52703 = (int64_t) 1 + binop_y_52702;
    int64_t bytes_52704 = (int64_t) 4 * binop_y_52703;
    int64_t bytes_52690 = (int64_t) 4 * dim_32139;
    
    if (memblock_alloc_device(ctx, &mem_52705, bytes_52704, "mem_52705")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53043 = segmap_tblock_sizze_51302 * num_tblocks_51303;
    int64_t total_sizze_53044 = bytes_52690 * num_threads_53043;
    
    if (memblock_alloc_device(ctx, &color_52936, total_sizze_53044, "color_52936")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53604 = sext_i64_i32(sdiv_up64(total_part_no_32153, segmap_tblock_sizze_51302));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51307(ctx, num_tblocks_51303, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51286, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_tblocks_51303, num_threads_53043, virt_num_tblocks_53604, xys_mem_52568.mem, mem_52685.mem, mem_52705.mem, color_52936.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52685, "mem_52685") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
        return 1;
    
    int64_t num_fpts_t_res_32340 = add64((int64_t) 1, dim_32139);
    int64_t num_fpts_32339;
    
    if (use_many_points_32157) {
        num_fpts_32339 = num_fpts_t_res_32340;
    } else {
        num_fpts_32339 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_43590 = slt64(num_fpts_32339, (int64_t) 0);
    bool valid_43591 = !bounds_invalid_upwards_43590;
    bool range_valid_c_43592;
    
    if (!valid_43591) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_fpts_32339, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ft_libs/ftSkyline.fut:292:49-62\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segmap_tblock_sizze_51367;
    
    segmap_tblock_sizze_51367 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51320;
    
    int64_t num_tblocks_51368;
    int64_t max_num_tblocks_53618;
    
    max_num_tblocks_53618 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51322;
    num_tblocks_51368 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(num_fpts_32339, segmap_tblock_sizze_51367), max_num_tblocks_53618)));
    
    int64_t binop_y_52743 = num_fpts_32339 - (int64_t) 1;
    int64_t binop_x_52745 = smax64((int64_t) 0, binop_y_52743);
    int64_t binop_y_52748 = dim_32139 * num_fpts_32339;
    int64_t binop_y_52749 = binop_x_52697 * binop_y_52748;
    int64_t binop_y_52750 = smax64((int64_t) 0, binop_y_52749);
    int64_t binop_x_52751 = binop_x_52745 + binop_y_52750;
    int64_t binop_y_52754 = num_fpts_32339 * binop_x_52581;
    int64_t binop_y_52755 = smax64((int64_t) 0, binop_y_52754);
    int64_t binop_y_52756 = binop_x_52751 + binop_y_52755;
    int64_t binop_y_52757 = (int64_t) 1 + binop_y_52756;
    int64_t bytes_52758 = (int64_t) 4 * binop_y_52757;
    int64_t bytes_52724 = dim_32139 * bytes_52686;
    
    if (memblock_alloc_device(ctx, &mem_52759, bytes_52758, "mem_52759")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53049 = segmap_tblock_sizze_51367 * num_tblocks_51368;
    int64_t total_sizze_53050 = bytes_52690 * num_threads_53049;
    
    if (memblock_alloc_device(ctx, &color_52937, total_sizze_53050, "color_52937")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t total_sizze_53051 = bytes_52724 * num_threads_53049;
    
    if (memblock_alloc_device(ctx, &color_52938, total_sizze_53051, "color_52938")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t total_sizze_53052 = bytes_52684 * num_threads_53049;
    
    if (memblock_alloc_device(ctx, &color_52939, total_sizze_53052, "color_52939")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t total_sizze_53053 = bytes_52686 * num_threads_53049;
    
    if (memblock_alloc_device(ctx, &color_52940, total_sizze_53053, "color_52940")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t ctx_53076 = dim_32139 * num_threads_53049;
    
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53619 = sext_i64_i32(sdiv_up64(num_fpts_32339, segmap_tblock_sizze_51367));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51372(ctx, num_tblocks_51368, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51320, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, total_part_no_32153, num_fpts_32339, num_tblocks_51368, num_threads_53049, ctx_53076, virt_num_tblocks_53619, xys_mem_52568.mem, mem_52683.mem, mem_52705.mem, mem_52759.mem, color_52937.mem, color_52938.mem, color_52939.mem, color_52940.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52705, "mem_52705") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52940, "color_52940") != 0)
        return 1;
    
    bool cond_46560 = slt64(dim_32139, (int64_t) 6);
    bool cond_46561 = slt64(num_fpts_32339, (int64_t) 6);
    bool zzero_46562 = total_angle_no_32151 == (int64_t) 0;
    bool nonzzero_46563 = !zzero_46562;
    bool nonzzero_cert_46564;
    
    if (!nonzzero_46563) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ft_libs/ftSkyline.fut:122:47-67\n   #1  ft_libs/ftSkyline.fut:269:26-320:85\n   #2  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_51414;
    
    segscan_tblock_sizze_51414 = *ctx->tuning_params.skyline_local_filter_9621zisegscan_tblock_sizze_51413;
    
    int64_t num_tblocks_51416;
    int64_t max_num_tblocks_53638;
    
    max_num_tblocks_53638 = *ctx->tuning_params.skyline_local_filter_9621zisegscan_num_tblocks_51415;
    num_tblocks_51416 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segscan_tblock_sizze_51414), max_num_tblocks_53638)));
    if (memblock_alloc_device(ctx, &mem_52770, bytes_52612, "mem_52770")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52770.mem, (int64_t) 0, (int64_t []) {(int64_t) 1, coercez2081Uz2080Uz2084U_32143}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_32139, (int64_t) 1}, (int64_t []) {coercez2081Uz2080Uz2084U_32143, dim_32139})) != 0)
        goto cleanup;
    
    bool x_52856 = !cond_46560;
    
    if (memblock_alloc_device(ctx, &mem_52808, binop_x_52574, "mem_52808")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52810, binop_x_52574, "mem_52810")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_53089 = segscan_tblock_sizze_51414 * num_tblocks_51416;
    int64_t total_sizze_53090 = dim_32139 * num_threads_53089;
    
    if (memblock_alloc_device(ctx, &color_52941, total_sizze_53090, "color_52941")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t total_sizze_53091 = num_fpts_32339 * num_threads_53089;
    
    if (memblock_alloc_device(ctx, &color_52942, total_sizze_53091, "color_52942")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, coercez2081Uz2080Uz2084U_32143)) {
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegScan");
        
        int64_t shared_memory_53639;
        
        shared_memory_53639 = ctx->max_shared_memory;
        
        int64_t thread_block_sizze_53640;
        
        thread_block_sizze_53640 = ctx->max_thread_block_size;
        
        int64_t registers_53641;
        
        registers_53641 = ctx->max_registers;
        
        int64_t thread_block_sizze_53642;
        
        thread_block_sizze_53642 = ctx->max_thread_block_size;
        
        int64_t chunk_sizze_53643 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_53639, thread_block_sizze_53640), (int64_t) 8), squot64(squot64(registers_53641, thread_block_sizze_53642) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
        int64_t num_virt_blocks_53644 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, segscan_tblock_sizze_51414 * chunk_sizze_53643);
        int64_t num_virt_threads_53645 = num_virt_blocks_53644 * segscan_tblock_sizze_51414;
        
        if (ctx->debugging)
            fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_53643, '\n');
        if (memblock_alloc_device(ctx, &status_flags_mem_53646, num_virt_blocks_53644, "status_flags_mem_53646")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_53646, num_virt_blocks_53644, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &aggregates_mem_53668, (int64_t) 8 * num_virt_blocks_53644, "aggregates_mem_53668")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &incprefixes_mem_53670, (int64_t) 8 * num_virt_blocks_53644, "incprefixes_mem_53670")) {
            err = 1;
            goto cleanup;
        }
        {
            err = gpu_kernel_skyline_local_filter_9621zisegscan_51419(ctx, num_tblocks_51416, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegscan_tblock_sizze_51413, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51414), chunk_sizze_53643 * segscan_tblock_sizze_51414 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_51414), chunk_sizze_53643 * segscan_tblock_sizze_51414 * (int64_t) 8), (int64_t) 8), (int64_t) 8), dim_32139, dz2081U_32142, coercez2081Uz2080Uz2084U_32143, total_angle_no_32151, total_part_no_32153, num_fpts_32339, cond_46560, cond_46561, num_tblocks_51416, x_52856, num_threads_53089, num_virt_blocks_53644, num_virt_threads_53645, isPartitionDominated_mem_52567.mem, xys_mem_52568.mem, mem_52683.mem, mem_52759.mem, mem_52770.mem, mem_52808.mem, mem_52810.mem, color_52941.mem, color_52942.mem, status_flags_mem_53646.mem, aggregates_mem_53668.mem, incprefixes_mem_53670.mem, global_dynid_mem_53672.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
    }
    if (memblock_unref_device(ctx, &mem_52683, "mem_52683") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52759, "mem_52759") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52770, "mem_52770") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52941, "color_52941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &color_52942, "color_52942") != 0)
        return 1;
    
    bool cond_45249 = coercez2081Uz2080Uz2084U_32143 == (int64_t) 0;
    bool x_45250 = !cond_45249;
    bool x_45252 = sle64((int64_t) 0, binop_y_52577);
    bool y_45253 = slt64(binop_y_52577, coercez2081Uz2080Uz2084U_32143);
    bool bounds_check_45254 = x_45252 && y_45253;
    bool protect_assert_disj_45255 = cond_45249 || bounds_check_45254;
    bool index_certs_45256;
    
    if (!protect_assert_disj_45255) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) binop_y_52577, "] out of bounds for array of shape [", (long long) coercez2081Uz2080Uz2084U_32143, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_45257;
    
    if (x_45250) {
        int64_t read_res_54118;
        
        if ((err = gpu_scalar_from_device(ctx, &read_res_54118, mem_52808.mem, binop_y_52577 * sizeof(int64_t), sizeof(int64_t))) != 0)
            goto cleanup;
        if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t x_48925 = read_res_54118;
        
        m_f_res_45257 = x_48925;
    } else {
        m_f_res_45257 = (int64_t) 0;
    }
    
    int64_t m_45259;
    
    if (cond_45249) {
        m_45259 = (int64_t) 0;
    } else {
        m_45259 = m_f_res_45257;
    }
    
    int64_t m_45269 = sub64(m_45259, (int64_t) 1);
    bool i_p_m_t_s_leq_w_45271 = slt64(m_45269, coercez2081Uz2080Uz2084U_32143);
    bool zzero_leq_i_p_m_t_s_45270 = sle64((int64_t) 0, m_45269);
    bool y_45273 = zzero_leq_i_p_m_t_s_45270 && i_p_m_t_s_leq_w_45271;
    bool i_lte_j_45272 = sle64((int64_t) 0, m_45259);
    bool forwards_ok_45274 = i_lte_j_45272 && y_45273;
    bool eq_x_zz_45266 = (int64_t) 0 == m_f_res_45257;
    bool p_and_eq_x_y_45267 = x_45250 && eq_x_zz_45266;
    bool empty_slice_45268 = cond_45249 || p_and_eq_x_y_45267;
    bool ok_or_empty_45275 = empty_slice_45268 || forwards_ok_45274;
    bool index_certs_45276;
    
    if (!ok_or_empty_45275) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_45259, "] out of bounds for array of shape [", (long long) coercez2081Uz2080Uz2084U_32143, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_52811 = (int64_t) 4 * m_45259;
    int64_t bytes_52812 = dim_32139 * binop_x_52811;
    int64_t bytes_52814 = (int64_t) 8 * m_45259;
    
    if (memblock_alloc_device(ctx, &mem_52813, bytes_52812, "mem_52813")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_52813.mem, (int64_t) 0, (int64_t []) {dim_32139, (int64_t) 1}, xys_mem_52568.mem, (int64_t) 0, (int64_t []) {dim_32139, (int64_t) 1}, (int64_t []) {m_45259, dim_32139})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_52815, bytes_52814, "mem_52815")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_52815.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xys_mem_52569.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_45259})) != 0)
        goto cleanup;
    
    int64_t segmap_tblock_sizze_51438;
    
    segmap_tblock_sizze_51438 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51427;
    
    int64_t segmap_usable_groups_51439 = sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51438);
    
    if (memblock_alloc_device(ctx, &mem_52818, binop_x_52574, "mem_52818")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_52820, binop_x_52574, "mem_52820")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53776 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51438));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51443(ctx, segmap_usable_groups_51439, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51427, 1, 1, (int64_t) 0, coercez2081Uz2080Uz2084U_32143, mem_52808.mem, mem_52810.mem, mem_52818.mem, mem_52820.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52808, "mem_52808") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_52810, "mem_52810") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51459;
    
    segmap_tblock_sizze_51459 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51458;
    
    int64_t num_tblocks_51461;
    int64_t max_num_tblocks_53785;
    
    max_num_tblocks_53785 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51460;
    num_tblocks_51461 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(nest_sizze_51073, segmap_tblock_sizze_51459), max_num_tblocks_53785)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53786 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143 * dim_32139, segmap_tblock_sizze_51459));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51455(ctx, num_tblocks_51461, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51458, 1, 1, (int64_t) 0, dim_32139, coercez2081Uz2080Uz2084U_32143, m_45259, num_tblocks_51461, virt_num_tblocks_53786, xys_mem_52568.mem, mem_52813.mem, mem_52818.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52818, "mem_52818") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_51469;
    
    segmap_tblock_sizze_51469 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51468;
    
    int64_t num_tblocks_51471;
    int64_t max_num_tblocks_53801;
    
    max_num_tblocks_53801 = *ctx->tuning_params.skyline_local_filter_9621zisegmap_num_tblocks_51470;
    num_tblocks_51471 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51469), max_num_tblocks_53801)));
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_53802 = sext_i64_i32(sdiv_up64(coercez2081Uz2080Uz2084U_32143, segmap_tblock_sizze_51469));
    
    {
        err = gpu_kernel_skyline_local_filter_9621zisegmap_51466(ctx, num_tblocks_51471, 1, 1, *ctx->tuning_params.skyline_local_filter_9621zisegmap_tblock_sizze_51468, 1, 1, (int64_t) 0, coercez2081Uz2080Uz2084U_32143, m_45259, num_tblocks_51471, virt_num_tblocks_53802, xys_mem_52569.mem, mem_52815.mem, mem_52820.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_52820, "mem_52820") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53217, &isPartitionDominated_mem_52567, "isPartitionDominated_mem_52567") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53218, &mem_52813, "mem_52813") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_53219, &mem_52815, "mem_52815") != 0)
        return 1;
    prim_out_53220 = m_45259;
    if (memblock_set_device(ctx, &*mem_out_p_54114, &mem_out_53217, "mem_out_53217") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54115, &mem_out_53218, "mem_out_53218") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_54116, &mem_out_53219, "mem_out_53219") != 0)
        return 1;
    *out_prim_out_54117 = prim_out_53220;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_52820, "mem_52820") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52818, "mem_52818") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52815, "mem_52815") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52813, "mem_52813") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_53670, "incprefixes_mem_53670") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_53668, "aggregates_mem_53668") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_53646, "status_flags_mem_53646") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52942, "color_52942") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52941, "color_52941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52810, "mem_52810") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52808, "mem_52808") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52770, "mem_52770") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52940, "color_52940") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52939, "color_52939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52938, "color_52938") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52937, "color_52937") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52759, "mem_52759") != 0)
            return 1;
        if (memblock_unref_device(ctx, &color_52936, "color_52936") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52705, "mem_52705") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53551, "segred_tmp_mem_53551") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_53549, "segred_tmp_mem_53549") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_map_res_subhistos_mem_53378, "defunc_0_map_res_subhistos_mem_53378") != 0)
            return 1;
        if (memblock_unref_device(ctx, &defunc_0_map_res_subhistos_mem_53376, "defunc_0_map_res_subhistos_mem_53376") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52687, "mem_52687") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52685, "mem_52685") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52683, "mem_52683") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52680, "mem_52680") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52669, "mem_52669") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_tmp_53304, "mem_param_tmp_53304") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52661, "mem_52661") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52649, "mem_52649") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52627, "mem_52627") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_param_52623, "mem_param_52623") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_52665, "ext_mem_52665") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52638, "mem_52638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52619, "mem_52619") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52616, "mem_52616") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52613, "mem_52613") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52602, "mem_52602") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52599, "mem_52599") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52595, "mem_52595") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52591, "mem_52591") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52589, "mem_52589") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52587, "mem_52587") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52576, "mem_52576") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_52572, "mem_52572") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53219, "mem_out_53219") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53218, "mem_out_53218") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_53217, "mem_out_53217") != 0)
            return 1;
    }
    return err;
}

int futhark_entry_calc_Global_Skyline_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1)
{
    int64_t dim_43262 = (int64_t) 0;
    int64_t dz2080U_43263 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264 = (int64_t) 0;
    int64_t dz2081U_43265 = (int64_t) 0;
    int64_t dz2082U_43266 = (int64_t) 0;
    int64_t m_sizze_43272 = (int64_t) 0;
    int64_t total_angle_no_43274 = (int64_t) 0;
    int64_t total_grid_no_43275 = (int64_t) 0;
    int64_t total_part_no_43276 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    angle_part_prefix_sum_mem_52561 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in0->v2->mem;
    dim_43262 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in0->v3->mem;
    dim_43262 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in0->v4->mem;
    dim_43262 = in0->v4->shape[0];
    m_sizze_43272 = in0->v5;
    start_of_grid_partition_mem_52566 = in0->v6->mem;
    dz2080U_43263 = in0->v6->shape[0];
    dim_43262 = in0->v6->shape[1];
    total_angle_no_43274 = in0->v7;
    total_grid_no_43275 = in0->v8;
    total_part_no_43276 = in0->v9;
    isPartitionDominated_mem_52567 = in1->v0->mem;
    dz2081U_43265 = in1->v0->shape[0];
    xys_mem_52568 = in1->v1->mem;
    dz2082U_43266 = in1->v1->shape[0];
    dim_43262 = in1->v1->shape[1];
    xys_mem_52569 = in1->v2->mem;
    dz2082U_43266 = in1->v2->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264 == in0->v1->shape[0] && (dim_43262 == in0->v2->shape[0] && (dim_43262 == in0->v3->shape[0] && (dim_43262 == in0->v4->shape[0] && (dz2080U_43263 == in0->v6->shape[0] && dim_43262 == in0->v6->shape[1])))))) && (dz2081U_43265 == in1->v0->shape[0] && (dz2082U_43266 == in1->v1->shape[0] && (dim_43262 == in1->v1->shape[1] && dz2082U_43266 == in1->v2->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_Global_Skyline_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_43262, dz2080U_43263, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43264, dz2081U_43265, dz2082U_43266, m_sizze_43272, total_angle_no_43274, total_grid_no_43275, total_part_no_43276);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_43265;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_43262;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_crack_skylineInfo_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_float **out0, const struct futhark_opaque_skylineInfo_float *in0)
{
    int64_t dim_43356 = (int64_t) 0;
    int64_t dz2081U_43357 = (int64_t) 0;
    int64_t dz2082U_43358 = (int64_t) 0;
    int64_t prim_out_53219 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52563;
    
    xys_mem_52563.references = NULL;
    
    struct memblock_device xys_mem_52562;
    
    xys_mem_52562.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52561;
    
    isPartitionDominated_mem_52561.references = NULL;
    isPartitionDominated_mem_52561 = in0->v0->mem;
    dz2081U_43357 = in0->v0->shape[0];
    xys_mem_52562 = in0->v1->mem;
    dz2082U_43358 = in0->v1->shape[0];
    dim_43356 = in0->v1->shape[1];
    xys_mem_52563 = in0->v2->mem;
    dz2082U_43358 = in0->v2->shape[0];
    if (!(dz2081U_43357 == in0->v0->shape[0] && (dz2082U_43358 == in0->v1->shape[0] && (dim_43356 == in0->v1->shape[1] && dz2082U_43358 == in0->v2->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_crack_skylineInfo_float(ctx, &mem_out_53217, &mem_out_53218, &prim_out_53219, isPartitionDominated_mem_52561, xys_mem_52562, xys_mem_52563, dim_43356, dz2081U_43357, dz2082U_43358);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineData_float *) malloc(sizeof(struct futhark_opaque_skylineData_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2082U_43358;
            (*out0)->v0->shape[1] = dim_43356;
            (*out0)->v1 = prim_out_53219;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53218;
            (*out0)->v2->shape[0] = dz2082U_43358;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_make_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const int64_t in4)
{
    int64_t dim_26085 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086 = (int64_t) 0;
    int64_t m_sizze_26091 = (int64_t) 0;
    int64_t prim_out_53223 = (int64_t) 0;
    int64_t prim_out_53224 = (int64_t) 0;
    int64_t prim_out_53225 = (int64_t) 0;
    int64_t prim_out_53226 = (int64_t) 0;
    int64_t prim_out_53227 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53222;
    
    mem_out_53222.references = NULL;
    
    struct memblock_device mem_out_53221;
    
    mem_out_53221.references = NULL;
    
    struct memblock_device mem_out_53220;
    
    mem_out_53220.references = NULL;
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52564;
    
    angle_partitions_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52563;
    
    grid_partitions_per_dim_mem_52563.references = NULL;
    
    struct memblock_device max_per_dim_mem_52562;
    
    max_per_dim_mem_52562.references = NULL;
    
    struct memblock_device min_per_dim_mem_52561;
    
    min_per_dim_mem_52561.references = NULL;
    min_per_dim_mem_52561 = in0->mem;
    dim_26085 = in0->shape[0];
    max_per_dim_mem_52562 = in1->mem;
    dim_26085 = in1->shape[0];
    grid_partitions_per_dim_mem_52563 = in2->mem;
    dim_26085 = in2->shape[0];
    angle_partitions_per_dim_mem_52564 = in3->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086 = in3->shape[0];
    m_sizze_26091 = in4;
    if (!(dim_26085 == in0->shape[0] && (dim_26085 == in1->shape[0] && (dim_26085 == in2->shape[0] && dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_make_skylineBase_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &mem_out_53220, &mem_out_53221, &mem_out_53222, &prim_out_53223, &prim_out_53224, &prim_out_53225, &prim_out_53226, &prim_out_53227, min_per_dim_mem_52561, max_per_dim_mem_52562, grid_partitions_per_dim_mem_52563, angle_partitions_per_dim_mem_52564, dim_26085, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086, m_sizze_26091);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineBase_float *) malloc(sizeof(struct futhark_opaque_skylineBase_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_26086;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = dim_26085;
            assert(((*out0)->v3 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v3->mem = mem_out_53220;
            (*out0)->v3->shape[0] = dim_26085;
            assert(((*out0)->v4 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v4->mem = mem_out_53221;
            (*out0)->v4->shape[0] = dim_26085;
            (*out0)->v5 = prim_out_53224;
            assert(((*out0)->v6 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v6->mem = mem_out_53222;
            (*out0)->v6->shape[0] = prim_out_53223;
            (*out0)->v6->shape[1] = dim_26085;
            (*out0)->v7 = prim_out_53225;
            (*out0)->v8 = prim_out_53226;
            (*out0)->v9 = prim_out_53227;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_intermediate_filter_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t dim_33939 = (int64_t) 0;
    int64_t dz2080U_33940 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 = (int64_t) 0;
    int64_t dz2081U_33942 = (int64_t) 0;
    int64_t dz2082U_33943 = (int64_t) 0;
    int64_t m_sizze_33949 = (int64_t) 0;
    int64_t total_angle_no_33951 = (int64_t) 0;
    int64_t total_grid_no_33952 = (int64_t) 0;
    int64_t total_part_no_33953 = (int64_t) 0;
    int64_t max_subdiv_33957 = (int64_t) 0;
    int64_t min_subdiv_33958 = (int64_t) 0;
    int64_t subdiv_step_33959 = (int64_t) 0;
    int64_t sizze_thresh_33960 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    angle_part_prefix_sum_mem_52561 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in0->v2->mem;
    dim_33939 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in0->v3->mem;
    dim_33939 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in0->v4->mem;
    dim_33939 = in0->v4->shape[0];
    m_sizze_33949 = in0->v5;
    start_of_grid_partition_mem_52566 = in0->v6->mem;
    dz2080U_33940 = in0->v6->shape[0];
    dim_33939 = in0->v6->shape[1];
    total_angle_no_33951 = in0->v7;
    total_grid_no_33952 = in0->v8;
    total_part_no_33953 = in0->v9;
    isPartitionDominated_mem_52567 = in1->v0->mem;
    dz2081U_33942 = in1->v0->shape[0];
    xys_mem_52568 = in1->v1->mem;
    dz2082U_33943 = in1->v1->shape[0];
    dim_33939 = in1->v1->shape[1];
    xys_mem_52569 = in1->v2->mem;
    dz2082U_33943 = in1->v2->shape[0];
    max_subdiv_33957 = in2;
    min_subdiv_33958 = in3;
    subdiv_step_33959 = in4;
    sizze_thresh_33960 = in5;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941 == in0->v1->shape[0] && (dim_33939 == in0->v2->shape[0] && (dim_33939 == in0->v3->shape[0] && (dim_33939 == in0->v4->shape[0] && (dz2080U_33940 == in0->v6->shape[0] && dim_33939 == in0->v6->shape[1])))))) && (dz2081U_33942 == in1->v0->shape[0] && (dz2082U_33943 == in1->v1->shape[0] && (dim_33939 == in1->v1->shape[1] && dz2082U_33943 == in1->v2->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_intermediate_filter_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_33939, dz2080U_33940, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_33941, dz2081U_33942, dz2082U_33943, m_sizze_33949, total_angle_no_33951, total_grid_no_33952, total_part_no_33953, max_subdiv_33957, min_subdiv_33958, subdiv_step_33959, sizze_thresh_33960);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_33942;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_33939;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_local_filter_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const bool in2)
{
    int64_t dim_32683 = (int64_t) 0;
    int64_t dz2080U_32684 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685 = (int64_t) 0;
    int64_t dz2081U_32686 = (int64_t) 0;
    int64_t dz2082U_32687 = (int64_t) 0;
    int64_t m_sizze_32693 = (int64_t) 0;
    int64_t total_angle_no_32695 = (int64_t) 0;
    int64_t total_grid_no_32696 = (int64_t) 0;
    int64_t total_part_no_32697 = (int64_t) 0;
    bool use_many_pts_32701 = 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    angle_part_prefix_sum_mem_52561 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in0->v2->mem;
    dim_32683 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in0->v3->mem;
    dim_32683 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in0->v4->mem;
    dim_32683 = in0->v4->shape[0];
    m_sizze_32693 = in0->v5;
    start_of_grid_partition_mem_52566 = in0->v6->mem;
    dz2080U_32684 = in0->v6->shape[0];
    dim_32683 = in0->v6->shape[1];
    total_angle_no_32695 = in0->v7;
    total_grid_no_32696 = in0->v8;
    total_part_no_32697 = in0->v9;
    isPartitionDominated_mem_52567 = in1->v0->mem;
    dz2081U_32686 = in1->v0->shape[0];
    xys_mem_52568 = in1->v1->mem;
    dz2082U_32687 = in1->v1->shape[0];
    dim_32683 = in1->v1->shape[1];
    xys_mem_52569 = in1->v2->mem;
    dz2082U_32687 = in1->v2->shape[0];
    use_many_pts_32701 = in2;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685 == in0->v1->shape[0] && (dim_32683 == in0->v2->shape[0] && (dim_32683 == in0->v3->shape[0] && (dim_32683 == in0->v4->shape[0] && (dz2080U_32684 == in0->v6->shape[0] && dim_32683 == in0->v6->shape[1])))))) && (dz2081U_32686 == in1->v0->shape[0] && (dz2082U_32687 == in1->v1->shape[0] && (dim_32683 == in1->v1->shape[1] && dz2082U_32687 == in1->v2->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_local_filter_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_32683, dz2080U_32684, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_32685, dz2081U_32686, dz2082U_32687, m_sizze_32693, total_angle_no_32695, total_grid_no_32696, total_part_no_32697, use_many_pts_32701);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_32686;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_32683;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_mergeFilter_2_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3)
{
    int64_t dim_43206 = (int64_t) 0;
    int64_t dz2080U_43207 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208 = (int64_t) 0;
    int64_t dz2082U_43209 = (int64_t) 0;
    int64_t dz2081U_43210 = (int64_t) 0;
    int64_t dz2082U_43211 = (int64_t) 0;
    bool self_filter_first_43212 = 0;
    int64_t m_sizze_43218 = (int64_t) 0;
    int64_t total_angle_no_43220 = (int64_t) 0;
    int64_t total_grid_no_43221 = (int64_t) 0;
    int64_t total_part_no_43222 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    self_filter_first_43212 = in0;
    angle_part_prefix_sum_mem_52561 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in1->v2->mem;
    dim_43206 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in1->v3->mem;
    dim_43206 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in1->v4->mem;
    dim_43206 = in1->v4->shape[0];
    m_sizze_43218 = in1->v5;
    start_of_grid_partition_mem_52566 = in1->v6->mem;
    dz2080U_43207 = in1->v6->shape[0];
    dim_43206 = in1->v6->shape[1];
    total_angle_no_43220 = in1->v7;
    total_grid_no_43221 = in1->v8;
    total_part_no_43222 = in1->v9;
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_43210 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_43209 = in2->v1->shape[0];
    dim_43206 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_43209 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_43210 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_43211 = in3->v1->shape[0];
    dim_43206 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_43211 = in3->v2->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208 == in1->v1->shape[0] && (dim_43206 == in1->v2->shape[0] && (dim_43206 == in1->v3->shape[0] && (dim_43206 == in1->v4->shape[0] && (dz2080U_43207 == in1->v6->shape[0] && dim_43206 == in1->v6->shape[1])))))) && ((dz2081U_43210 == in2->v0->shape[0] && (dz2082U_43209 == in2->v1->shape[0] && (dim_43206 == in2->v1->shape[1] && dz2082U_43209 == in2->v2->shape[0]))) && (dz2081U_43210 == in3->v0->shape[0] && (dz2082U_43211 == in3->v1->shape[0] && (dim_43206 == in3->v1->shape[1] && dz2082U_43211 == in3->v2->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_mergeFilter_2_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_43206, dz2080U_43207, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_43208, dz2082U_43209, dz2081U_43210, dz2082U_43211, self_filter_first_43212, m_sizze_43218, total_angle_no_43220, total_grid_no_43221, total_part_no_43222);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_43210;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_43206;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_mergeFilter_3_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4)
{
    int64_t dim_42759 = (int64_t) 0;
    int64_t dz2080U_42760 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761 = (int64_t) 0;
    int64_t dz2082U_42762 = (int64_t) 0;
    int64_t dz2081U_42763 = (int64_t) 0;
    int64_t dz2082U_42764 = (int64_t) 0;
    int64_t dz2082U_42765 = (int64_t) 0;
    bool self_filter_first_42766 = 0;
    int64_t m_sizze_42772 = (int64_t) 0;
    int64_t total_angle_no_42774 = (int64_t) 0;
    int64_t total_grid_no_42775 = (int64_t) 0;
    int64_t total_part_no_42776 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52575;
    
    xys_mem_52575.references = NULL;
    
    struct memblock_device xys_mem_52574;
    
    xys_mem_52574.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52573;
    
    isPartitionDominated_mem_52573.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    self_filter_first_42766 = in0;
    angle_part_prefix_sum_mem_52561 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in1->v2->mem;
    dim_42759 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in1->v3->mem;
    dim_42759 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in1->v4->mem;
    dim_42759 = in1->v4->shape[0];
    m_sizze_42772 = in1->v5;
    start_of_grid_partition_mem_52566 = in1->v6->mem;
    dz2080U_42760 = in1->v6->shape[0];
    dim_42759 = in1->v6->shape[1];
    total_angle_no_42774 = in1->v7;
    total_grid_no_42775 = in1->v8;
    total_part_no_42776 = in1->v9;
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_42763 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_42762 = in2->v1->shape[0];
    dim_42759 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_42762 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_42763 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_42764 = in3->v1->shape[0];
    dim_42759 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_42764 = in3->v2->shape[0];
    isPartitionDominated_mem_52573 = in4->v0->mem;
    dz2081U_42763 = in4->v0->shape[0];
    xys_mem_52574 = in4->v1->mem;
    dz2082U_42765 = in4->v1->shape[0];
    dim_42759 = in4->v1->shape[1];
    xys_mem_52575 = in4->v2->mem;
    dz2082U_42765 = in4->v2->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761 == in1->v1->shape[0] && (dim_42759 == in1->v2->shape[0] && (dim_42759 == in1->v3->shape[0] && (dim_42759 == in1->v4->shape[0] && (dz2080U_42760 == in1->v6->shape[0] && dim_42759 == in1->v6->shape[1])))))) && ((dz2081U_42763 == in2->v0->shape[0] && (dz2082U_42762 == in2->v1->shape[0] && (dim_42759 == in2->v1->shape[1] && dz2082U_42762 == in2->v2->shape[0]))) && ((dz2081U_42763 == in3->v0->shape[0] && (dz2082U_42764 == in3->v1->shape[0] && (dim_42759 == in3->v1->shape[1] && dz2082U_42764 == in3->v2->shape[0]))) && (dz2081U_42763 == in4->v0->shape[0] && (dz2082U_42765 == in4->v1->shape[0] && (dim_42759 == in4->v1->shape[1] && dz2082U_42765 == in4->v2->shape[0]))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_mergeFilter_3_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, dim_42759, dz2080U_42760, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_42761, dz2082U_42762, dz2081U_42763, dz2082U_42764, dz2082U_42765, self_filter_first_42766, m_sizze_42772, total_angle_no_42774, total_grid_no_42775, total_part_no_42776);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_42763;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_42759;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_mergeFilter_4_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4, const struct futhark_opaque_skylineInfo_float *in5)
{
    int64_t dim_41602 = (int64_t) 0;
    int64_t dz2080U_41603 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604 = (int64_t) 0;
    int64_t dz2082U_41605 = (int64_t) 0;
    int64_t dz2081U_41606 = (int64_t) 0;
    int64_t dz2082U_41607 = (int64_t) 0;
    int64_t dz2082U_41608 = (int64_t) 0;
    int64_t dz2082U_41609 = (int64_t) 0;
    bool self_filter_first_41610 = 0;
    int64_t m_sizze_41616 = (int64_t) 0;
    int64_t total_angle_no_41618 = (int64_t) 0;
    int64_t total_grid_no_41619 = (int64_t) 0;
    int64_t total_part_no_41620 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52578;
    
    xys_mem_52578.references = NULL;
    
    struct memblock_device xys_mem_52577;
    
    xys_mem_52577.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52576;
    
    isPartitionDominated_mem_52576.references = NULL;
    
    struct memblock_device xys_mem_52575;
    
    xys_mem_52575.references = NULL;
    
    struct memblock_device xys_mem_52574;
    
    xys_mem_52574.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52573;
    
    isPartitionDominated_mem_52573.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    self_filter_first_41610 = in0;
    angle_part_prefix_sum_mem_52561 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in1->v2->mem;
    dim_41602 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in1->v3->mem;
    dim_41602 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in1->v4->mem;
    dim_41602 = in1->v4->shape[0];
    m_sizze_41616 = in1->v5;
    start_of_grid_partition_mem_52566 = in1->v6->mem;
    dz2080U_41603 = in1->v6->shape[0];
    dim_41602 = in1->v6->shape[1];
    total_angle_no_41618 = in1->v7;
    total_grid_no_41619 = in1->v8;
    total_part_no_41620 = in1->v9;
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_41606 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_41605 = in2->v1->shape[0];
    dim_41602 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_41605 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_41606 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_41607 = in3->v1->shape[0];
    dim_41602 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_41607 = in3->v2->shape[0];
    isPartitionDominated_mem_52573 = in4->v0->mem;
    dz2081U_41606 = in4->v0->shape[0];
    xys_mem_52574 = in4->v1->mem;
    dz2082U_41608 = in4->v1->shape[0];
    dim_41602 = in4->v1->shape[1];
    xys_mem_52575 = in4->v2->mem;
    dz2082U_41608 = in4->v2->shape[0];
    isPartitionDominated_mem_52576 = in5->v0->mem;
    dz2081U_41606 = in5->v0->shape[0];
    xys_mem_52577 = in5->v1->mem;
    dz2082U_41609 = in5->v1->shape[0];
    dim_41602 = in5->v1->shape[1];
    xys_mem_52578 = in5->v2->mem;
    dz2082U_41609 = in5->v2->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604 == in1->v1->shape[0] && (dim_41602 == in1->v2->shape[0] && (dim_41602 == in1->v3->shape[0] && (dim_41602 == in1->v4->shape[0] && (dz2080U_41603 == in1->v6->shape[0] && dim_41602 == in1->v6->shape[1])))))) && ((dz2081U_41606 == in2->v0->shape[0] && (dz2082U_41605 == in2->v1->shape[0] && (dim_41602 == in2->v1->shape[1] && dz2082U_41605 == in2->v2->shape[0]))) && ((dz2081U_41606 == in3->v0->shape[0] && (dz2082U_41607 == in3->v1->shape[0] && (dim_41602 == in3->v1->shape[1] && dz2082U_41607 == in3->v2->shape[0]))) && ((dz2081U_41606 == in4->v0->shape[0] && (dz2082U_41608 == in4->v1->shape[0] && (dim_41602 == in4->v1->shape[1] && dz2082U_41608 == in4->v2->shape[0]))) && (dz2081U_41606 == in5->v0->shape[0] && (dz2082U_41609 == in5->v1->shape[0] && (dim_41602 == in5->v1->shape[1] && dz2082U_41609 == in5->v2->shape[0])))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_mergeFilter_4_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, isPartitionDominated_mem_52576, xys_mem_52577, xys_mem_52578, dim_41602, dz2080U_41603, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_41604, dz2082U_41605, dz2081U_41606, dz2082U_41607, dz2082U_41608, dz2082U_41609, self_filter_first_41610, m_sizze_41616, total_angle_no_41618, total_grid_no_41619, total_part_no_41620);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_41606;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_41602;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_mergeFilter_5_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const bool in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4, const struct futhark_opaque_skylineInfo_float *in5, const struct futhark_opaque_skylineInfo_float *in6)
{
    int64_t dim_39383 = (int64_t) 0;
    int64_t dz2080U_39384 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385 = (int64_t) 0;
    int64_t dz2082U_39386 = (int64_t) 0;
    int64_t dz2081U_39387 = (int64_t) 0;
    int64_t dz2082U_39388 = (int64_t) 0;
    int64_t dz2082U_39389 = (int64_t) 0;
    int64_t dz2082U_39390 = (int64_t) 0;
    int64_t dz2082U_39391 = (int64_t) 0;
    bool self_filter_first_39392 = 0;
    int64_t m_sizze_39398 = (int64_t) 0;
    int64_t total_angle_no_39400 = (int64_t) 0;
    int64_t total_grid_no_39401 = (int64_t) 0;
    int64_t total_part_no_39402 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52581;
    
    xys_mem_52581.references = NULL;
    
    struct memblock_device xys_mem_52580;
    
    xys_mem_52580.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52579;
    
    isPartitionDominated_mem_52579.references = NULL;
    
    struct memblock_device xys_mem_52578;
    
    xys_mem_52578.references = NULL;
    
    struct memblock_device xys_mem_52577;
    
    xys_mem_52577.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52576;
    
    isPartitionDominated_mem_52576.references = NULL;
    
    struct memblock_device xys_mem_52575;
    
    xys_mem_52575.references = NULL;
    
    struct memblock_device xys_mem_52574;
    
    xys_mem_52574.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52573;
    
    isPartitionDominated_mem_52573.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    self_filter_first_39392 = in0;
    angle_part_prefix_sum_mem_52561 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in1->v2->mem;
    dim_39383 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in1->v3->mem;
    dim_39383 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in1->v4->mem;
    dim_39383 = in1->v4->shape[0];
    m_sizze_39398 = in1->v5;
    start_of_grid_partition_mem_52566 = in1->v6->mem;
    dz2080U_39384 = in1->v6->shape[0];
    dim_39383 = in1->v6->shape[1];
    total_angle_no_39400 = in1->v7;
    total_grid_no_39401 = in1->v8;
    total_part_no_39402 = in1->v9;
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_39387 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_39386 = in2->v1->shape[0];
    dim_39383 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_39386 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_39387 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_39388 = in3->v1->shape[0];
    dim_39383 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_39388 = in3->v2->shape[0];
    isPartitionDominated_mem_52573 = in4->v0->mem;
    dz2081U_39387 = in4->v0->shape[0];
    xys_mem_52574 = in4->v1->mem;
    dz2082U_39389 = in4->v1->shape[0];
    dim_39383 = in4->v1->shape[1];
    xys_mem_52575 = in4->v2->mem;
    dz2082U_39389 = in4->v2->shape[0];
    isPartitionDominated_mem_52576 = in5->v0->mem;
    dz2081U_39387 = in5->v0->shape[0];
    xys_mem_52577 = in5->v1->mem;
    dz2082U_39390 = in5->v1->shape[0];
    dim_39383 = in5->v1->shape[1];
    xys_mem_52578 = in5->v2->mem;
    dz2082U_39390 = in5->v2->shape[0];
    isPartitionDominated_mem_52579 = in6->v0->mem;
    dz2081U_39387 = in6->v0->shape[0];
    xys_mem_52580 = in6->v1->mem;
    dz2082U_39391 = in6->v1->shape[0];
    dim_39383 = in6->v1->shape[1];
    xys_mem_52581 = in6->v2->mem;
    dz2082U_39391 = in6->v2->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385 == in1->v1->shape[0] && (dim_39383 == in1->v2->shape[0] && (dim_39383 == in1->v3->shape[0] && (dim_39383 == in1->v4->shape[0] && (dz2080U_39384 == in1->v6->shape[0] && dim_39383 == in1->v6->shape[1])))))) && ((dz2081U_39387 == in2->v0->shape[0] && (dz2082U_39386 == in2->v1->shape[0] && (dim_39383 == in2->v1->shape[1] && dz2082U_39386 == in2->v2->shape[0]))) && ((dz2081U_39387 == in3->v0->shape[0] && (dz2082U_39388 == in3->v1->shape[0] && (dim_39383 == in3->v1->shape[1] && dz2082U_39388 == in3->v2->shape[0]))) && ((dz2081U_39387 == in4->v0->shape[0] && (dz2082U_39389 == in4->v1->shape[0] && (dim_39383 == in4->v1->shape[1] && dz2082U_39389 == in4->v2->shape[0]))) && ((dz2081U_39387 == in5->v0->shape[0] && (dz2082U_39390 == in5->v1->shape[0] && (dim_39383 == in5->v1->shape[1] && dz2082U_39390 == in5->v2->shape[0]))) && (dz2081U_39387 == in6->v0->shape[0] && (dz2082U_39391 == in6->v1->shape[0] && (dim_39383 == in6->v1->shape[1] && dz2082U_39391 == in6->v2->shape[0]))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_mergeFilter_5_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, isPartitionDominated_mem_52576, xys_mem_52577, xys_mem_52578, isPartitionDominated_mem_52579, xys_mem_52580, xys_mem_52581, dim_39383, dz2080U_39384, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_39385, dz2082U_39386, dz2081U_39387, dz2082U_39388, dz2082U_39389, dz2082U_39390, dz2082U_39391, self_filter_first_39392, m_sizze_39398, total_angle_no_39400, total_grid_no_39401, total_part_no_39402);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_39387;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_39383;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_merge_2_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1)
{
    int64_t dim_34825 = (int64_t) 0;
    int64_t dz2082U_34826 = (int64_t) 0;
    int64_t dz2081U_34827 = (int64_t) 0;
    int64_t dz2082U_34828 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52566;
    
    xys_mem_52566.references = NULL;
    
    struct memblock_device xys_mem_52565;
    
    xys_mem_52565.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52564;
    
    isPartitionDominated_mem_52564.references = NULL;
    
    struct memblock_device xys_mem_52563;
    
    xys_mem_52563.references = NULL;
    
    struct memblock_device xys_mem_52562;
    
    xys_mem_52562.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52561;
    
    isPartitionDominated_mem_52561.references = NULL;
    isPartitionDominated_mem_52561 = in0->v0->mem;
    dz2081U_34827 = in0->v0->shape[0];
    xys_mem_52562 = in0->v1->mem;
    dz2082U_34826 = in0->v1->shape[0];
    dim_34825 = in0->v1->shape[1];
    xys_mem_52563 = in0->v2->mem;
    dz2082U_34826 = in0->v2->shape[0];
    isPartitionDominated_mem_52564 = in1->v0->mem;
    dz2081U_34827 = in1->v0->shape[0];
    xys_mem_52565 = in1->v1->mem;
    dz2082U_34828 = in1->v1->shape[0];
    dim_34825 = in1->v1->shape[1];
    xys_mem_52566 = in1->v2->mem;
    dz2082U_34828 = in1->v2->shape[0];
    if (!((dz2081U_34827 == in0->v0->shape[0] && (dz2082U_34826 == in0->v1->shape[0] && (dim_34825 == in0->v1->shape[1] && dz2082U_34826 == in0->v2->shape[0]))) && (dz2081U_34827 == in1->v0->shape[0] && (dz2082U_34828 == in1->v1->shape[0] && (dim_34825 == in1->v1->shape[1] && dz2082U_34828 == in1->v2->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_merge_2_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, isPartitionDominated_mem_52561, xys_mem_52562, xys_mem_52563, isPartitionDominated_mem_52564, xys_mem_52565, xys_mem_52566, dim_34825, dz2082U_34826, dz2081U_34827, dz2082U_34828);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_34827;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_34825;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_merge_3_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2)
{
    int64_t dim_34724 = (int64_t) 0;
    int64_t dz2082U_34725 = (int64_t) 0;
    int64_t dz2081U_34726 = (int64_t) 0;
    int64_t dz2082U_34727 = (int64_t) 0;
    int64_t dz2082U_34728 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device xys_mem_52566;
    
    xys_mem_52566.references = NULL;
    
    struct memblock_device xys_mem_52565;
    
    xys_mem_52565.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52564;
    
    isPartitionDominated_mem_52564.references = NULL;
    
    struct memblock_device xys_mem_52563;
    
    xys_mem_52563.references = NULL;
    
    struct memblock_device xys_mem_52562;
    
    xys_mem_52562.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52561;
    
    isPartitionDominated_mem_52561.references = NULL;
    isPartitionDominated_mem_52561 = in0->v0->mem;
    dz2081U_34726 = in0->v0->shape[0];
    xys_mem_52562 = in0->v1->mem;
    dz2082U_34725 = in0->v1->shape[0];
    dim_34724 = in0->v1->shape[1];
    xys_mem_52563 = in0->v2->mem;
    dz2082U_34725 = in0->v2->shape[0];
    isPartitionDominated_mem_52564 = in1->v0->mem;
    dz2081U_34726 = in1->v0->shape[0];
    xys_mem_52565 = in1->v1->mem;
    dz2082U_34727 = in1->v1->shape[0];
    dim_34724 = in1->v1->shape[1];
    xys_mem_52566 = in1->v2->mem;
    dz2082U_34727 = in1->v2->shape[0];
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_34726 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_34728 = in2->v1->shape[0];
    dim_34724 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_34728 = in2->v2->shape[0];
    if (!((dz2081U_34726 == in0->v0->shape[0] && (dz2082U_34725 == in0->v1->shape[0] && (dim_34724 == in0->v1->shape[1] && dz2082U_34725 == in0->v2->shape[0]))) && ((dz2081U_34726 == in1->v0->shape[0] && (dz2082U_34727 == in1->v1->shape[0] && (dim_34724 == in1->v1->shape[1] && dz2082U_34727 == in1->v2->shape[0]))) && (dz2081U_34726 == in2->v0->shape[0] && (dz2082U_34728 == in2->v1->shape[0] && (dim_34724 == in2->v1->shape[1] && dz2082U_34728 == in2->v2->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_merge_3_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, isPartitionDominated_mem_52561, xys_mem_52562, xys_mem_52563, isPartitionDominated_mem_52564, xys_mem_52565, xys_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, dim_34724, dz2082U_34725, dz2081U_34726, dz2082U_34727, dz2082U_34728);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_34726;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_34724;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_merge_4_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3)
{
    int64_t dim_34582 = (int64_t) 0;
    int64_t dz2082U_34583 = (int64_t) 0;
    int64_t dz2081U_34584 = (int64_t) 0;
    int64_t dz2082U_34585 = (int64_t) 0;
    int64_t dz2082U_34586 = (int64_t) 0;
    int64_t dz2082U_34587 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device xys_mem_52566;
    
    xys_mem_52566.references = NULL;
    
    struct memblock_device xys_mem_52565;
    
    xys_mem_52565.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52564;
    
    isPartitionDominated_mem_52564.references = NULL;
    
    struct memblock_device xys_mem_52563;
    
    xys_mem_52563.references = NULL;
    
    struct memblock_device xys_mem_52562;
    
    xys_mem_52562.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52561;
    
    isPartitionDominated_mem_52561.references = NULL;
    isPartitionDominated_mem_52561 = in0->v0->mem;
    dz2081U_34584 = in0->v0->shape[0];
    xys_mem_52562 = in0->v1->mem;
    dz2082U_34583 = in0->v1->shape[0];
    dim_34582 = in0->v1->shape[1];
    xys_mem_52563 = in0->v2->mem;
    dz2082U_34583 = in0->v2->shape[0];
    isPartitionDominated_mem_52564 = in1->v0->mem;
    dz2081U_34584 = in1->v0->shape[0];
    xys_mem_52565 = in1->v1->mem;
    dz2082U_34585 = in1->v1->shape[0];
    dim_34582 = in1->v1->shape[1];
    xys_mem_52566 = in1->v2->mem;
    dz2082U_34585 = in1->v2->shape[0];
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_34584 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_34586 = in2->v1->shape[0];
    dim_34582 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_34586 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_34584 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_34587 = in3->v1->shape[0];
    dim_34582 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_34587 = in3->v2->shape[0];
    if (!((dz2081U_34584 == in0->v0->shape[0] && (dz2082U_34583 == in0->v1->shape[0] && (dim_34582 == in0->v1->shape[1] && dz2082U_34583 == in0->v2->shape[0]))) && ((dz2081U_34584 == in1->v0->shape[0] && (dz2082U_34585 == in1->v1->shape[0] && (dim_34582 == in1->v1->shape[1] && dz2082U_34585 == in1->v2->shape[0]))) && ((dz2081U_34584 == in2->v0->shape[0] && (dz2082U_34586 == in2->v1->shape[0] && (dim_34582 == in2->v1->shape[1] && dz2082U_34586 == in2->v2->shape[0]))) && (dz2081U_34584 == in3->v0->shape[0] && (dz2082U_34587 == in3->v1->shape[0] && (dim_34582 == in3->v1->shape[1] && dz2082U_34587 == in3->v2->shape[0]))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_merge_4_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, isPartitionDominated_mem_52561, xys_mem_52562, xys_mem_52563, isPartitionDominated_mem_52564, xys_mem_52565, xys_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, dim_34582, dz2082U_34583, dz2081U_34584, dz2082U_34585, dz2082U_34586, dz2082U_34587);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_34584;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_34582;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_merge_5_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineInfo_float *in0, const struct futhark_opaque_skylineInfo_float *in1, const struct futhark_opaque_skylineInfo_float *in2, const struct futhark_opaque_skylineInfo_float *in3, const struct futhark_opaque_skylineInfo_float *in4)
{
    int64_t dim_34395 = (int64_t) 0;
    int64_t dz2082U_34396 = (int64_t) 0;
    int64_t dz2081U_34397 = (int64_t) 0;
    int64_t dz2082U_34398 = (int64_t) 0;
    int64_t dz2082U_34399 = (int64_t) 0;
    int64_t dz2082U_34400 = (int64_t) 0;
    int64_t dz2082U_34401 = (int64_t) 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xys_mem_52575;
    
    xys_mem_52575.references = NULL;
    
    struct memblock_device xys_mem_52574;
    
    xys_mem_52574.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52573;
    
    isPartitionDominated_mem_52573.references = NULL;
    
    struct memblock_device xys_mem_52572;
    
    xys_mem_52572.references = NULL;
    
    struct memblock_device xys_mem_52571;
    
    xys_mem_52571.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52570;
    
    isPartitionDominated_mem_52570.references = NULL;
    
    struct memblock_device xys_mem_52569;
    
    xys_mem_52569.references = NULL;
    
    struct memblock_device xys_mem_52568;
    
    xys_mem_52568.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52567;
    
    isPartitionDominated_mem_52567.references = NULL;
    
    struct memblock_device xys_mem_52566;
    
    xys_mem_52566.references = NULL;
    
    struct memblock_device xys_mem_52565;
    
    xys_mem_52565.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52564;
    
    isPartitionDominated_mem_52564.references = NULL;
    
    struct memblock_device xys_mem_52563;
    
    xys_mem_52563.references = NULL;
    
    struct memblock_device xys_mem_52562;
    
    xys_mem_52562.references = NULL;
    
    struct memblock_device isPartitionDominated_mem_52561;
    
    isPartitionDominated_mem_52561.references = NULL;
    isPartitionDominated_mem_52561 = in0->v0->mem;
    dz2081U_34397 = in0->v0->shape[0];
    xys_mem_52562 = in0->v1->mem;
    dz2082U_34396 = in0->v1->shape[0];
    dim_34395 = in0->v1->shape[1];
    xys_mem_52563 = in0->v2->mem;
    dz2082U_34396 = in0->v2->shape[0];
    isPartitionDominated_mem_52564 = in1->v0->mem;
    dz2081U_34397 = in1->v0->shape[0];
    xys_mem_52565 = in1->v1->mem;
    dz2082U_34398 = in1->v1->shape[0];
    dim_34395 = in1->v1->shape[1];
    xys_mem_52566 = in1->v2->mem;
    dz2082U_34398 = in1->v2->shape[0];
    isPartitionDominated_mem_52567 = in2->v0->mem;
    dz2081U_34397 = in2->v0->shape[0];
    xys_mem_52568 = in2->v1->mem;
    dz2082U_34399 = in2->v1->shape[0];
    dim_34395 = in2->v1->shape[1];
    xys_mem_52569 = in2->v2->mem;
    dz2082U_34399 = in2->v2->shape[0];
    isPartitionDominated_mem_52570 = in3->v0->mem;
    dz2081U_34397 = in3->v0->shape[0];
    xys_mem_52571 = in3->v1->mem;
    dz2082U_34400 = in3->v1->shape[0];
    dim_34395 = in3->v1->shape[1];
    xys_mem_52572 = in3->v2->mem;
    dz2082U_34400 = in3->v2->shape[0];
    isPartitionDominated_mem_52573 = in4->v0->mem;
    dz2081U_34397 = in4->v0->shape[0];
    xys_mem_52574 = in4->v1->mem;
    dz2082U_34401 = in4->v1->shape[0];
    dim_34395 = in4->v1->shape[1];
    xys_mem_52575 = in4->v2->mem;
    dz2082U_34401 = in4->v2->shape[0];
    if (!((dz2081U_34397 == in0->v0->shape[0] && (dz2082U_34396 == in0->v1->shape[0] && (dim_34395 == in0->v1->shape[1] && dz2082U_34396 == in0->v2->shape[0]))) && ((dz2081U_34397 == in1->v0->shape[0] && (dz2082U_34398 == in1->v1->shape[0] && (dim_34395 == in1->v1->shape[1] && dz2082U_34398 == in1->v2->shape[0]))) && ((dz2081U_34397 == in2->v0->shape[0] && (dz2082U_34399 == in2->v1->shape[0] && (dim_34395 == in2->v1->shape[1] && dz2082U_34399 == in2->v2->shape[0]))) && ((dz2081U_34397 == in3->v0->shape[0] && (dz2082U_34400 == in3->v1->shape[0] && (dim_34395 == in3->v1->shape[1] && dz2082U_34400 == in3->v2->shape[0]))) && (dz2081U_34397 == in4->v0->shape[0] && (dz2082U_34401 == in4->v1->shape[0] && (dim_34395 == in4->v1->shape[1] && dz2082U_34401 == in4->v2->shape[0])))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_merge_5_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, isPartitionDominated_mem_52561, xys_mem_52562, xys_mem_52563, isPartitionDominated_mem_52564, xys_mem_52565, xys_mem_52566, isPartitionDominated_mem_52567, xys_mem_52568, xys_mem_52569, isPartitionDominated_mem_52570, xys_mem_52571, xys_mem_52572, isPartitionDominated_mem_52573, xys_mem_52574, xys_mem_52575, dim_34395, dz2082U_34396, dz2081U_34397, dz2082U_34398, dz2082U_34399, dz2082U_34400, dz2082U_34401);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = dz2081U_34397;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53220;
            (*out0)->v1->shape[1] = dim_34395;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_skyline_slice_and_dice_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3)
{
    int64_t dim_29479 = (int64_t) 0;
    int64_t dz2080U_29480 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481 = (int64_t) 0;
    int64_t n_29482 = (int64_t) 0;
    int64_t m_sizze_29488 = (int64_t) 0;
    int64_t total_angle_no_29490 = (int64_t) 0;
    int64_t total_grid_no_29491 = (int64_t) 0;
    int64_t total_part_no_29492 = (int64_t) 0;
    int64_t offs_29494 = (int64_t) 0;
    bool use_many_pts_29495 = 0;
    int64_t prim_out_53220 = (int64_t) 0;
    int64_t prim_out_53221 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_53219;
    
    mem_out_53219.references = NULL;
    
    struct memblock_device mem_out_53218;
    
    mem_out_53218.references = NULL;
    
    struct memblock_device mem_out_53217;
    
    mem_out_53217.references = NULL;
    
    struct memblock_device xs_mem_52567;
    
    xs_mem_52567.references = NULL;
    
    struct memblock_device start_of_grid_partition_mem_52566;
    
    start_of_grid_partition_mem_52566.references = NULL;
    
    struct memblock_device grid_partitions_per_dim_mem_52565;
    
    grid_partitions_per_dim_mem_52565.references = NULL;
    
    struct memblock_device grid_part_sizze_per_dim_mem_52564;
    
    grid_part_sizze_per_dim_mem_52564.references = NULL;
    
    struct memblock_device grid_part_prefix_sum_mem_52563;
    
    grid_part_prefix_sum_mem_52563.references = NULL;
    
    struct memblock_device angle_partitions_per_dim_mem_52562;
    
    angle_partitions_per_dim_mem_52562.references = NULL;
    
    struct memblock_device angle_part_prefix_sum_mem_52561;
    
    angle_part_prefix_sum_mem_52561.references = NULL;
    angle_part_prefix_sum_mem_52561 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_52562 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_52563 = in0->v2->mem;
    dim_29479 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_52564 = in0->v3->mem;
    dim_29479 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_52565 = in0->v4->mem;
    dim_29479 = in0->v4->shape[0];
    m_sizze_29488 = in0->v5;
    start_of_grid_partition_mem_52566 = in0->v6->mem;
    dz2080U_29480 = in0->v6->shape[0];
    dim_29479 = in0->v6->shape[1];
    total_angle_no_29490 = in0->v7;
    total_grid_no_29491 = in0->v8;
    total_part_no_29492 = in0->v9;
    xs_mem_52567 = in1->mem;
    n_29482 = in1->shape[0];
    dim_29479 = in1->shape[1];
    offs_29494 = in2;
    use_many_pts_29495 = in3;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481 == in0->v1->shape[0] && (dim_29479 == in0->v2->shape[0] && (dim_29479 == in0->v3->shape[0] && (dim_29479 == in0->v4->shape[0] && (dz2080U_29480 == in0->v6->shape[0] && dim_29479 == in0->v6->shape[1])))))) && (n_29482 == in1->shape[0] && dim_29479 == in1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_skyline_slice_and_dice_float(ctx, &mem_out_53217, &mem_out_53218, &mem_out_53219, &prim_out_53220, &prim_out_53221, angle_part_prefix_sum_mem_52561, angle_partitions_per_dim_mem_52562, grid_part_prefix_sum_mem_52563, grid_part_sizze_per_dim_mem_52564, grid_partitions_per_dim_mem_52565, start_of_grid_partition_mem_52566, xs_mem_52567, dim_29479, dz2080U_29480, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_29481, n_29482, m_sizze_29488, total_angle_no_29490, total_grid_no_29491, total_part_no_29492, offs_29494, use_many_pts_29495);
        if (ret == 0) {
            struct memblock_device counters_mem_53224 = ctx->constants->counters_mem_53224;
            struct memblock_device counters_mem_53243 = ctx->constants->counters_mem_53243;
            struct memblock_device counters_mem_53319 = ctx->constants->counters_mem_53319;
            struct memblock_device counters_mem_53373 = ctx->constants->counters_mem_53373;
            struct memblock_device counters_mem_53511 = ctx->constants->counters_mem_53511;
            struct memblock_device counters_mem_53531 = ctx->constants->counters_mem_53531;
            struct memblock_device counters_mem_53553 = ctx->constants->counters_mem_53553;
            struct memblock_device counters_mem_53595 = ctx->constants->counters_mem_53595;
            struct memblock_device counters_mem_53711 = ctx->constants->counters_mem_53711;
            struct memblock_device counters_mem_53848 = ctx->constants->counters_mem_53848;
            struct memblock_device global_dynid_mem_53262 = ctx->constants->global_dynid_mem_53262;
            struct memblock_device global_dynid_mem_53345 = ctx->constants->global_dynid_mem_53345;
            struct memblock_device global_dynid_mem_53358 = ctx->constants->global_dynid_mem_53358;
            struct memblock_device global_dynid_mem_53420 = ctx->constants->global_dynid_mem_53420;
            struct memblock_device global_dynid_mem_53427 = ctx->constants->global_dynid_mem_53427;
            struct memblock_device global_dynid_mem_53505 = ctx->constants->global_dynid_mem_53505;
            struct memblock_device global_dynid_mem_53672 = ctx->constants->global_dynid_mem_53672;
            struct memblock_device global_dynid_mem_53903 = ctx->constants->global_dynid_mem_53903;
            struct memblock_device hist_locks_mem_53461 = ctx->constants->hist_locks_mem_53461;
            
            assert((*out0 = (struct futhark_opaque_skylineInfo_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_53217;
            (*out0)->v0->shape[0] = prim_out_53220;
            assert(((*out0)->v1 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v1->mem = mem_out_53218;
            (*out0)->v1->shape[0] = prim_out_53221;
            (*out0)->v1->shape[1] = dim_29479;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_53219;
            (*out0)->v2->shape[0] = prim_out_53221;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
  
